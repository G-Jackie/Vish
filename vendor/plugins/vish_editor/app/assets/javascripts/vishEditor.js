var i18n = {"vish":{"es":{"i.walkMenuHelp1a":"Para aprender a utilizar ViSH Editor tienes a tu disposici\u00f3n varios videotutoriales en nuestro", "i.YouTubeChannel":"canal de YouTube", "i.walkMenuHelp1b":"Estos tutoriales cubren desde el uso b\u00e1sico para principiantes hasta funcionalidades avanzadas de la herramienta.", "i.walkMenuHelp2":"El siguiente videotutorial te ense\u00f1ar\u00e1 como empezar a utilizar esta herramienta en unos pocos minutos.", "i.walkMenuHelp3":"Si lo prefieres puedes hacer click aqu\u00ed para ver un tutorial textual que te ense\u00f1ar\u00e1 r\u00e1pidamente los conceptos b\u00e1sicos para empezar a utilizar ViSH Editor.", 
"i.walkWelcome1_1":"\u00a1Bienvenido a ViSH Editor!", "i.walkWelcome1_2":"ViSH Editor es una aplicaci\u00f3n web innovadora que permite crear increibles presentaciones web y recursos educativos novedosos como Excursiones Virtuales.", "i.walkWelcome1_3":"En este tutorial aprender\u00e1s como empezar a utilizar esta herramienta.", "i.walkWelcome2_1":"Panel de diapositivas", "i.walkWelcome2_2":"En este panel aparecen las diapositivas actuales de tu presentaci\u00f3n. Si seleccionas cualquiera de ellas podr\u00e1s visualizarla, editar y borrarla.", 
"i.walkWelcome3_1":"A\u00f1adir una nueva diapositiva", "i.walkWelcome3_2":"Puedes a\u00f1adir una nueva diapositiva a tu presentaci\u00f3n mediante este bot\u00f3n.", "i.walkWelcome3_3":"Despu\u00e9s de pulsarlo, aparecer\u00e1 una nueva pantalla para que elijas la plantilla de tu nueva diapositiva.", "i.walkWelcome4_1":"Importar contenido", "i.walkWelcome4_2":"Este icono mostrar\u00e1 la pantalla de importaci\u00f3n, que te permitir\u00e1 importar diapositivas de diferentes fuentes.", "i.walkWelcome4_3":"Importar diapositivas de una presentaci\u00f3n en formato PDF.", 
"i.walkWelcome4_4":"Importar diapositivas de otras presentaciones creadas con ViSH Editor.", "i.walkWelcome5_1":"Barra de Herramientas de ViSH Editor", "i.walkWelcome5_2":"Esta barra de herramientas ofrece diferentes funcionalidades para gestionar y componer la presentaci\u00f3n.", "i.walkWelcome5_3":"Pulsa en siguiente para ver una explicaci\u00f3n de los diferentes elementos de esta barra de herramientas.", "i.walkWelcome6_1":"Este bot\u00f3n te permite salvar tu presentaci\u00f3n como borrador.", 
"i.walkWelcome7_1":"Este bot\u00f3n te permite publicar tu presentaci\u00f3n en la plataforma ViSH. Si no has terminado tu presentaci\u00f3n, puedes guardarla como borrador para mantenerla privada y terminarla despu\u00e9s.", "i.walkWelcome8_1":"Este bot\u00f3n te permite previsualizar la presentaci\u00f3n. Podr\u00e1s ver la presentaci\u00f3n de la misma forma que lo har\u00e1n los usuarios tras su publicaci\u00f3n.", "i.walkWelcome9_1":"Este bot\u00f3n te permite elegir un tema visual para la presentaci\u00f3n.", 
"i.walkWelcome10_1":"Define un fondo personalizado para la diapositiva actual.", "i.walkWelcome11_1":"Herramientas para Elementos", "i.walkWelcome11_2":"Esta zona contiene herramientas para editar los contenidos o elementos de las diapositivas. Las herramientas mostradas variar\u00e1n dependiendo del tipo de elemento seleccionado (imagen, web, ...).", "i.walkWelcome11_3":"Cada vez que a\u00f1adas o selecciones un elemento en la presentaci\u00f3n, esta zona de la barra de herramientas te mostarar\u00e1 las herramientas disponibles para interactuar con ese elemento.", 
"i.walkWelcome11_4":"A continuaci\u00f3n se listan todas las herramientas disponibles", "i.walkWelcome11_a_1":"Enlazar elemento a una URL", "i.walkWelcome11_a_2":"Redimensionar un elemento", "i.walkWelcome11_a_3":"Zoom", "i.walkWelcome11_a_4":"Barra de herramientas para texto", "i.walkWelcome12_1":"Men\u00fa de ViSH Editor", "i.walkWelcome12_2":"Este bot\u00f3n muestra el men\u00fa de ViSH Editor, donde encontrar\u00e1s todas las funcionalidades de la aplicaci\u00f3n.", "i.walkWelcome12_3":"Muchas de estas opciones tambi\u00e9n se encuentran disponibles en la barra de herramientas de ViSH Editor, pero siempre podr\u00e1s acceder a cualquiera de ellas a trav\u00e9s de este men\u00fa.", 
"i.walkWelcome12_4":"En este men\u00fa puedes guardar y publicar tu presentaci\u00f3n asi como exportarla a un fichero externo, tambi\u00e9n puedes previsualizar la presentaci\u00f3n antes de publicarla o exportarla, a\u00f1adir nuevas diapositivas, importar nuevos contenidos, cambiar la informaci\u00f3n de la presentaci\u00f3n a trav\u00e9s de la opci\u00f3n 'Ajustes', y empezar otra vez este tutorial cuando quieras con la opci\u00f3n 'Ayuda'. ", "i.walkWelcome13_1":"Ayuda Contextual", "i.walkWelcome13_2":'Si tienes cualquier duda, siempre puedes hacer click en cualquiera de los "iconos de ayuda contextual" para ver ayuda e instrucciones adicionales relativas a la pantalla donde te encuentras o al elemento sobre el cual el icono se encuentra situado.', 
"i.walkWelcome13_3":"Icono de Ayuda Contextual", "i.walkSettings1_1":"Bienvenido a la pantalla de Ajustes", "i.walkSettings1_2":"Aqu\u00ed puedes especificar informaci\u00f3n acerca de tu Excursi\u00f3n Virtual.", "i.walkSettings1_3":"El t\u00edtulo y el avatar (una imagen que identifica tu excursi\u00f3n en la plataforma ViSH) son campos obligatorios, de modo que debes rellenarlos antes de publicar la excursi\u00f3n.", "i.walkSettings1_4":"A la izquierda, puedes ver una previsualizaci\u00f3n de como tu excursi\u00f3n ser\u00e1 mostrada en la plataforma ViSH.", 
"i.walkSettings2_1":"Escribe un t\u00edtulo (Obligatorio)", "i.walkSettings2_2":"Escribe el t\u00edtulo de tu excursi\u00f3n en esta caja de texto. Este titulo es importante porque es el que se mostrar\u00e1 en la plataforma ViSH y el que ver\u00e1n el resto de usuarios.", "i.walkSettings3_1":"A\u00f1ade un avatar para tu excursi\u00f3n (Obligatorio)", "i.walkSettings3_2":"Pulsa sobre este bot\u00f3n para elegir una imagen que represente a tu excursi\u00f3n. Esta imagen ser\u00e1 el avatar de tu excursi\u00f3n y es importante porque ser\u00e1 mostrada en la plataforma ViSH, permitiendo a los usuarios identificar la excursi\u00f3n.", 
"i.walkSettings4_1":"Escribe una descripci\u00f3n", "i.walkSettings4_2":"Aqui puedes explicar en detalle sobre qu\u00e9 trata la excursi\u00f3n.", "i.walkSettings4_3":"Esta descripci\u00f3n ser\u00e1 mostrada en la plataforma ViSH en la p\u00e1gina de esta excursi\u00f3n. Por lo tanto, todos los usuarios que accedan a esta excursi\u00f3n podr\u00e1n leerla.", "i.walkSettings5_1":"Selecciona un tema para tu presentaci\u00f3n", "i.walkSettings5_2":"Un tema define la apariencia visual de la presentaci\u00f3n. ViSH Editor ofrece diferentes temas entre los cuales puedes elegir.", 
"i.walkSettings5_3":"Para seleccionar un tema, simplemente pulsa sobre el icono que quieras de esta galer\u00eda.", "i.walkSettings5_4":"Recuerda que puedes cambiar el tema de la presentaci\u00f3n en cualquier momento accediendo a esta pantalla o pulsando sobre el bot\u00f3n 'Estilo' en la barra de herramientas.", "i.walkSettings6_1":"A\u00f1ade etiquetas a tu excursi\u00f3n", "i.walkSettings6_2":"Aqui puedes a\u00f1adir etiquetas (o palabras clave) a tu excursi\u00f3n.", "i.walkSettings6_3":"Estas palabras clave son muy \u00fatiles para categorizar la excursi\u00f3n. Adem\u00e1s, tambi\u00e9n se emplean como t\u00e9rminos de b\u00fasqueda en la plataforma ViSH (asi como en otros repositorios), y por lo tanto a\u00f1adir palabras clave a una excursi\u00f3n facilita su b\u00fasqueda y acceso.", 
"i.walkSettings6_4":"Ejemplos de etiquetas", "i.walkSettings7_1":"Aspectos Pedag\u00f3gicos", "i.walkSettings7_2":"Al pulsar sobre este bot\u00f3n aparecer\u00e1 la pantalla de Aspectos Pedag\u00f3gicos.", "i.walkSettings7_3":"En esta pantalla podr\u00e1s especificar m\u00e1s informaci\u00f3n pedag\u00f3gica acerca de tu excursi\u00f3n.", "i.walkSettings7_4":"Los detalles sobre la informaci\u00f3n que puede ser especificada se explican en la ayuda contextual de la pantalla de Aspectos Pedag\u00f3gicos.", 
"i.walkSettings8_1":"Empezar a utilizar ViSH Editor", "i.walkSettings8_2":"Una vez que hayas rellenado la informaci\u00f3n de tu excursi\u00f3n, por lo menos el t\u00edtulo y el avatar, puedes empezar a crear tu excursi\u00f3n con ViSH Editor pulsando sobre el bot\u00f3n 'Continuar'.", "i.walkSettings8_3":"Si no deseas rellenar la informaci\u00f3n en este momento, tambi\u00e9n puedes empezar a usar ViSH Editor pulsando sobre el bot\u00f3n 'Rellenar despu\u00e9s', en este caso recuerda que deber\u00e1s volver a la pantalla de Ajustes y completar todos los campos obligatorios antes de publicar la excursi\u00f3n.", 
"i.walkPedagogical1_1":"Bienvenido a la pantalla de Aspectos Pedag\u00f3gicos", "i.walkPedagogical1_2_1":"En esta pantalla puedes especificar m\u00e1s informaci\u00f3n pedag\u00f3gica acerca de tu excursi\u00f3n. Estos metadatos est\u00e1n basados y son conformes al est\u00e1ndar LOM (Learning Object Metadata). La \u00faltima especificaci\u00f3n de este est\u00e1ndar, en la cual se explica de una manera detallada todos los campos de esta pantalla, se puede encontrar", "i.walkPedagogical1_2_2":"aqu\u00ed", 
"i.walkPedagogical1_3":"A continuaci\u00f3n se ofrece una breve explicaci\u00f3n de cada uno de los campos que se pueden especificar en esta pantalla.", "i.walkPedagogical1_4":"El idioma de tu excursi\u00f3n.", "i.walkPedagogical1_5":"El entorno principal dentro del cual est\u00e1 destinado a tener lugar el aprendizaje y uso de este objeto de aprendizaje (es decir, la excursi\u00f3n).", "i.walkPedagogical1_6":"Edad del usuario t\u00edpico esperado.", "i.walkPedagogical1_7":"Como de complicado es trabajar con o a trav\u00e9s de este objeto de aprendizaje.", 
"i.walkPedagogical1_8":"Tiempo aproximado o t\u00edpico que se necesita para trabajar con este objeto de aprendizaje.", "i.walkPedagogical1_9":"El tema (o temas) de esta excursi\u00f3n.", "i.walkPedagogical1_10":"Comentarios acerca de como este objeto de aprendizaje puede o va a ser utilizado.", "i.walkSlide1_1":"A\u00f1adiendo contenido a una diapositiva", "i.walkSlide1_2":"Para a\u00f1adir contenido a una diapositiva, primero tienes que pulsar sobre cualquiera de las areas editables disponibles en ella. Estas \u00e1reas tienen un borde punteado y un texto que dice ", 
"i.walkSlide1_3":"Una vez que hayas seleccionado una de estas \u00e1reas, aparecer\u00e1n varios iconos dentro.", "i.walkSlide1_4":"Cada uno de estos iconos permite a\u00f1adir un tipo de contenido diferente. ", "i.walkSlide1_5":"Si seleccionas el icono de texto, una barra de herramientas de texto aparecer\u00e1 en la zona superior, permitiendo definir, entre otras caracter\u00edsticas, la tipograf\u00eda, el estilo y el tama\u00f1o del texto.", "i.walkSlide1_6":"Si seleccionas el icono de quizzes (cuestionarios), aparecer\u00e1 una nueva pantalla para que elijas el tipo de cuestionario (respuesta m\u00faltiple, verdadero/falso) a a\u00f1adir.", 
"i.walkSlide1_7":"En cualquier otro caso (im\u00e1genes, v\u00eddeos, ...), una nueva pantalla aparecer\u00e1 para que elijas el contenido a a\u00f1adir. Puedes a\u00f1adir un recurso mediante su URL, subiendo un archivo propio o buscando en proveedores externos de contenidos como Flickr o YouTube.", "i.walkSlide1_8":'Una vez que hayas a\u00f1adido contenido a un \u00e1rea, puedes borrarlo empleando el icono de "borrar contenido"', "i.walkSlide1_9":'Finalmente, si quieres borrar la diapositiva entera, puedes hacerlo usando el icono de "borrar diapositiva"', 
"i.walkImagesMain_1":"A\u00f1adiendo im\u00e1genes", "i.walkImagesMain_2":"Esta pantalla te permite a\u00f1adir im\u00e1genes a la diapositiva. Puedes seleccionar la imagen a a\u00f1adir de diferentes fuentes:", "i.walkImagesMain_Url":"a\u00f1adir una imagen pegando un enlace (url)", "i.walkImagesMain_Upload":"sube una imagen propia de tu ordenador", "i.walkImagesMain_ViSH":"busca im\u00e1genes en el repositorio del ViSH", "i.walkImagesMain_Flickr":"busca im\u00e1genes en Flickr", "i.walkImagesMain_LRE":"busca im\u00e1genes en el repositorio del LRE", 
"i.walkImagesUrl1_1":'Ahora te encuentras en la pesta\u00f1a de enlace, haz click en "Siguiente" para continuar.', "i.walkImagesUrl2_1":"A\u00f1adiendo im\u00e1genes por enlace (url)", "i.walkImagesUrl2_2":"Si quieres a\u00f1adir una imagen mediante su url, debes escribir o pegar la url de la imagen en esta caja de texto, por ejemplo:", "i.walkImagesUrl2_3":"Practicamente todos los formatos de im\u00e1genes (jpg, png, gif, tiff, bmp, ...) est\u00e1n soportados.", "i.walkImagesUrl3_1":"Previsualizar la imagen antes de a\u00f1adirla", 
"i.walkImagesUrl3_2":'Despu\u00e9s de escribir o pegar el enlace (url) de la imagen deseada debes de hacer click en este bot\u00f3n de "Vista previa". Despu\u00e9s de eso, se mostrar\u00e1 una previsualizaci\u00f3n de la imagen y aparecer\u00e1 un nuevo bot\u00f3n "A\u00f1adir Contenido". Para terminar y a\u00f1adir la imagen a la diapositiva, debes hacer click en el bot\u00f3n "A\u00f1adir Contenido".', "i.walkImagesUpload1_1":'Ahora te encuentras en la pesta\u00f1a de subida de im\u00e1genes, haz click en "Siguiente" para continuar.', 
"i.walkImagesUpload2_1":"Subiendo im\u00e1genes", "i.walkImagesUpload2_2":'Aqu\u00ed puedes a\u00f1adir una imagen propia de tu dispositivo. Para ello, en primer lugar debes seleccionar la imagen que quieras empleando el selector de ficheros. Opcionalmente, puedes escribir etiquetas para clasificar la imagen seleccionada. Despu\u00e9s debes de hacer click en el bot\u00f3n "subir" para subir la imagen a la plataforma ViSH. Cuando la imagen se haya subido, se mostrar\u00e1 una vista previa de la misma en la parte inferior. Finalmente, para a\u00f1adir la imagen a la diapositiva debes de pulsar sobre el bot\u00f3n "A\u00f1adir Contenido".', 
"i.walkImagesViSH1_1":'Ahora te encuentras en la pesta\u00f1a de ViSH, haz click en "Siguiente" para continuar.', "i.walkImagesViSH2_1":"Buscar im\u00e1genes en el repositorio del ViSH", "i.walkImagesViSH2_2":"Esta pantalla te permite buscar im\u00e1genes en el repositorio del ViSH (http://vishub.org).", "i.walkSearch1":"Escribe el nombre que quieras buscar dentro de la caja de texto, por ejemplo", "i.nature":"nature", "i.walkImagesSearch2":"y pulsa la tecla 'intro' para comenzar la b\u00fasqueda. Cuando termine la b\u00fasqueda, las im\u00e1genes encontradas ser\u00e1n mostradas en esta pantalla. Para a\u00f1adir cualquiera de ellas a la diapositiva, simplemente haz click sobre la que desees.", 
"i.walkImagesFlickr1_1":'Ahora te encuentras en la pesta\u00f1a de Flickr, haz click en "Siguiente" para continuar.', "i.walkImagesFlickr2_1":"Buscar im\u00e1genes en Flickr", "i.walkImagesFlickr2_2":"Esta pantalla te permite buscar im\u00e1genes en Flickr.", "i.walkImagesLRE1_1":'Ahora te encuentras en la pesta\u00f1a del repositorio del LRE, haz click en "Siguiente" para continuar.', "i.walkImagesLRE2_1":"Buscar im\u00e1genes en el repositorio del LRE", "i.walkImagesLRE2_2":"Esta pantalla te permite buscar im\u00e1genes en el repositorio del LRE.", 
"i.walkObjectsMain_1":"A\u00f1adiendo objetos", "i.walkObjectsMain_2":"Esta pantalla te permite a\u00f1adir diferentes tipos de objetos a las diapositivas. Puedes seleccionar el objeto a insertar de diferentes fuentes.", "i.walkObjectsMain_Web":"a\u00f1adir una web pegando su enlace (url)", "i.walkObjectsMain_WebSnapshot":'un "web snapshot" es un fragmento de una p\u00e1gina web. Este fragmento aparecer\u00e1 sin barras de desplazamiento (barras de scroll) y te permitir\u00e1 insertar un \u00e1rea o zona espec\u00edfica de una p\u00e1gina web en lugar de la p\u00e1gina completa', 
"i.walkObjectsMain_Embed":"a\u00f1ade un objeto embedido. Puedes escribir o pegar tanto el c\u00f3digo HTML del objeto como su enlace o url", "i.walkObjectsMain_Upload":"sube un fichero propio en formato PDF o SWF (flash) de tu ordenador", "i.walkObjectsMain_ViSH":"busca objetos en el repositorio del ViSH", "i.walkObjectsMain_LRE":"busca objetos en el repositorio del LRE", "i.walkVideosMain_1":"A\u00f1adiendo videos", "i.walkVideosMain_2":"Esta pantalla te permite a\u00f1adir videos a las diapositivas. Puedes seleccionar el video a a\u00f1adir de diferentes fuentes:", 
"i.walkVideosMain_Url":"a\u00f1ade un video pegando su enlace (url). Solo est\u00e1n admitidos videos HTML5 y de YouTube", "i.walkVideosMain_ViSH":"busca videos HTML5 en el repositorio del ViSH", "i.walkVideosMain_YouTube":"busca videos en YouTube", "i.walkVideosMain_Upload":"Haz click aqu\u00ed para aprender como subir v\u00eddeos", "i.walkVideosUpload_1":"Subiendo v\u00eddeos", "i.walkVideosUpload_2":"Puedes subir un video propio de tu ordenador. Para hacer esto, vete a", "i.walkVideosUpload_3":"y sube tu archivo de video al repositorio del ViSH. Varios formatos de video (mp4, flv, mpg, avi, ...) est\u00e1n soportados. Cuando termines de subir el video al ViSH tu video ser\u00e1 convertido a un formato compatible con HTML5. Este proceso puede llevar varios minutos. Una vez que el proceso haya finalizado, tienes dos formas de a\u00f1adir un v\u00eddeo", 
"i.walkVideosUpload_4":"Buscar tu video en el repositorio del ViSH en la pesta\u00f1a 'ViSH'. En este caso tendr\u00e1s que esperar varias horas hasta que el motor de b\u00fasqueda del ViSH haya indexado el nuevo v\u00eddeo. Esta es la manera recomendada de insertar los videos, porque de este modo los v\u00eddeos estar\u00e1n disponibles en varios formatos y funcionar\u00e1n en casi todos los dispositivos.", "i.walkVideosUpload_5":"Otra forma es acceder a la p\u00e1gina del v\u00eddeo en ViSH, por ejemplo http://vishub.org/videos/325, y a\u00f1adir la extensi\u00f3n deseada (webm, mp4) a la url, por ejemplo, http://vishub.org/videos/325.webm. En esta p\u00e1gina ser\u00e1s capaz de ver el v\u00eddeo en tu navegador web. Finalmente, solamente tienes que ir a la pesta\u00f1a 'enlace' y pegar esta url para insertar el v\u00eddeo de forma inmediata.", 
"i.walkQuiz_1":"A\u00f1adiendo cuestionarios (Quizzes)", "i.walkQuiz_2":"Puedes a\u00f1adir diferentes tipos de cuestionarios o quizzes a tu presentaci\u00f3n. Los cuestionarios actualmente disponibles se muestran a continuaci\u00f3n", "i.walkQuiz_MC1":"Respuesta m\u00faltiple", "i.walkQuiz_MC2":"Los cuestionarios de respuesta m\u00faltiple son una forma de evaluaci\u00f3n en la que se les solicita a los encuestados que seleccionen la mejor respuesta posible  (o respuestas) de una lista de posibles opciones.", 
"i.walkQuiz_TF1":"Verdadero / Falso", "i.walkQuiz_TF2":"Un cuestionario de verdadero/falso es una forma de evaluaci\u00f3n en la que se solicita a los encuestados que seleccionen, para cada afirmaci\u00f3n o sentencia, si esta es verdadera o falsa.", "i.walkQuiz_3":"Ademas de los contenidos, tambi\u00e9n puedes definir las respuestas correctas del cuestionario o quiz, permitiendo de esta manera la autoevaluaci\u00f3n y el seguimiento autom\u00e1tico del progreso de los estudiantes en plataformas de aprendizaje como Moodle.", 
"i.walkLive_1":"A\u00f1adiendo contenidos en directo", "i.walkLive_2":"ViSH (Virtual Science Hub) ofrece recursos especiales como webcams en vivo, microscopios o laboratorios virtuales provistos por determinadas ciberinfraestructuras.", "i.walkLive_3":"En esta pantalla podr\u00e1s buscar recursos de este tipo en el repositorio del ViSH.", "i.walkLive_4":"Si quieres descubrir m\u00e1s recursos de ciberinfraestructuras o atender a eventos de ciencia en directo puedes visitar", "i.walkAddSlide_1":"A\u00f1adiendo Diapositivas", 
"i.walkAddSlide_2":"Aqu\u00ed puedes a\u00f1adir a tu presentaci\u00f3n una nueva diapositiva vac\u00eda con una plantilla espec\u00edfica. Para esto, simplemente selecciona la plantilla que quieras de las disponibles en el panel 'Plantillas'. Ten en cuenta que la plantilla define la posici\u00f3n y tama\u00f1o de las zonas en las cuales podr\u00e1s a\u00f1adir contenidos en la nueva diapositiva.", "i.walkAddSlide_3":"Adem\u00e1s de diapositivas normales, tambi\u00e9n puedes a\u00f1adir a tu presentaci\u00f3n elementos m\u00e1s interactivos llamados 'Smartcards'. Para insertar cualquiera de estos elementos, simplemente haz click en el que desees dentro del panel de 'Smartcards'. Una vez que hayas insertado una Smartcard podr\u00e1s personalizarla con el contenido que quieras.", 
"i.walkAddSlide_4":"Haz click aqu\u00ed para ver m\u00e1s informaci\u00f3n sobre los tipos disponibles de Smartcards y para aprender c\u00f3mo crearlas.", "i.walkSmartcards_1":"Las Smartcards son elementos interactivos que pueden ser insertados en la presentaci\u00f3n como si fueran diapositivas normales.", "i.walkSmartcards_2":"Los siguientes tipos de Smartcards est\u00e1n disponibles", "i.flashcardDef":"Las Flashcards son recursos presentados como una imagen de fondo con 'zonas calientes' se\u00f1aladas por flechas sobre las que el usuario puede hacer click para ver contenidos adicionales que han sido previamente etiquetados.", 
"i.vtDef":"Los Tours Virtuales son similares a las Flashcards, pero en lugar de ser presentados como im\u00e1genes de fondo est\u00e1ticas, se presentan como mapas interactivos donde las 'zonas calientes' son lugares se\u00f1alados por pines en el mapa. De esta forma, cuando los usuarios hacen click sobre un pin en el mapa (sobre una localizaci\u00f3n marcada) ven contenidos adicionales.", "i.flashcardLearHow":"Haz click aqu\u00ed para aprender como crear una Flashcard.", "i.vtLearHow":"Haz click aqu\u00ed para aprender como crear un Tour Virtual.", 
"i.walkPdf2ex_1":"Insertar una presentaci\u00f3n PDF", "i.walkPdf2ex_2":"Selecciona una presentaci\u00f3n en formato PDF y sube el archivo. \u00danicamente se admiten archivos en formato PDF. Si quieres insertar una presentaci\u00f3n en otro formato como PowerPoint (.ppt) debes de convertir el archivo a PDF primero.", "i.walkPdf2ex_3":"Una vez que la subida del fichero PDF haya finalizado, aparecer\u00e1 una nueva ventana para que elijas las diapositivas que quieres insertar de la presentaci\u00f3n que has subido.", 
"i.walkPdf2ex_4":"Esta funcionalidad convertir\u00e1 la presentaci\u00f3n PDF en una presentaci\u00f3n de ViSH Editor, esto quiere decir que cada una de las diapositivas seleccionadas de la presentaci\u00f3n PDF ser\u00e1 insertada en la presentaci\u00f3n actual como una diapositiva nueva.", "i.walkPdf2ex_5":"Si lo que quiere es insertar un documento PDF entero en la misma diapositiva para que pueda ser leido como un libro, debe de subir el archivo PDF desde el panel 'Objectos'.", "i.walkInsertingViSHPres_1":"A\u00f1adiendo Diapositivas de Excursiones Virtuales", 
"i.walkInsertingViSHPres_2":"Aqu\u00ed puedes buscar Excursiones Virtuales en la plataforma ViSH para a\u00f1adirlas (o a\u00f1adir determinadas diapositivas de ellas) a tu presentaci\u00f3n.", "i.walkInsertingViSHPres_3":"Haz click en cualquiera de las Excursiones Virtuales para seleccionarla. Despu\u00e9s, se mostrar\u00e1 un nuevo bot\u00f3n 'Vista Previa'. Cuando pulses este bot\u00f3n, aparecer\u00e1 una nueva ventana para que elijas las diapositivas que quieres insertar en tu presentaci\u00f3n.", 
"i.walkPresSearch2":"y pulsa la tecla 'intro' para comenzar la b\u00fasqueda. Cuando termine la b\u00fasqueda, las Excursiones Virtuales encontradas ser\u00e1n mostradas en esta pantalla.", "i.walkInsertingViSHSmart_1":"A\u00f1adiendo Smartcards", "i.walkInsertingViSHSmart_2":"Aqu\u00ed puedes buscar Smartcards en la plataforma ViSH para a\u00f1adirlas a tu presentaci\u00f3n.", "i.walkInsertingViSHSmart_3":"Haz click en cualquiera de las Smartcards para seleccionarla. Despu\u00e9s, se mostrar\u00e1 un nuevo bot\u00f3n 'Vista Previa'. Cuando pulses este bot\u00f3n, aparecer\u00e1 una nueva ventana para que puedas ver la Smartcard antes de insertarla en tu presentaci\u00f3n.", 
"i.walkSmartSearch2":"y pulsa la tecla 'intro' para comenzar la b\u00fasqueda. Cuando termine la b\u00fasqueda, las Smartcards encontradas ser\u00e1n mostradas en esta pantalla.", "i.walkLearnMoreSmartcards":"Pulsa aqu\u00ed para aprender m\u00e1s sobre las Smartcards.", "i.walkInsertJSONfile_1":"A\u00f1adir una presentaci\u00f3n de ViSH Editor de un fichero JSON", "i.walkInsertJSONfile_2":"Selecciona el archivo en formato JSON (.json) en el cual est\u00e1 guardada la presentaci\u00f3n que quieres insertar. A continuaci\u00f3n, pulsa sobre el bot\u00f3n 'Vista Previa'. Aparecer\u00e1 una nueva pantalla para que elijas las diapositivas a importar.", 
"i.walkInsertJSONfile_3":"Puedes salvar tu presentaci\u00f3n en formato JSON haciendo click en 'Men\u00fa -> Exportar -> a JSON'. Se descargar\u00e1 a tu dispositivo un fichero JSON conteniendo tu presentaci\u00f3n. De esta forma puedes compartir tu presentaci\u00f3n mediante un archivo (por ejemplo envi\u00e1ndolo por email) y almacenarla donde quieras.", "i.walkThemes_1":"Temas de ViSH Editor", "i.walkThemes_4":"Recuerda que puedes cambiar el tema de la presentaci\u00f3n en cualquier momento accediendo a esta pantalla o seleccionando la opci\u00f3n 'Ajustes' en el menu.", 
"i.walkAnimations_1":"Animaciones de Vish Editor", "i.walkAnimations_2":"Una animaci\u00f3n define las transiciones visuales entre las slides de la presentaci\u00f3n.Vish Editor ofrece diferentes animaciones entre las cuales puedes escojer.", "i.walkAnimations_3":"Para escojer una animaci\u00f3n, solamente debes pasar con el cursor por encima de los iconos para previsualizar la animaci\u00f3n que te gustar\u00eda a\u00f1adir dentro de esta galer\u00eda.", "i.walkAnimations_4":"Recuerda que puedes cambiar la animaci\u00f3n entre las slides en cualquier momento accediendo a esta pantalla desde el icono superior.", 
"i.CreatingFlashcards":"Creando Flashcards", "i.walkFlashcard_1":"Para empezar a crear una Flashcard debes hacer click en el bot\u00f3n 'A\u00f1adir' situado a la izquierda (el bot\u00f3n utilizado para a\u00f1adir nuevas diapositivas), y a continuaci\u00f3n debes pulsar sobre el icono de Flashcard en el panel 'Smartcards'. Despu\u00e9s de esto, se mostrar\u00e1 una Flashcard vacia en la pantalla.", "i.FlashcardIcon":"Icono de Flashcard", "i.walkFlashcard_2":"Para seleccionar la imagen de fondo de la Flashcard debes pulsar sobre el siguiente bot\u00f3n", 
"i.walkFlashcard_3":"Puedes cambiar el fondo seleccionado en cualquier momento haciendo click en el bot\u00f3n 'Fondo' de la barra de herramientas.", "i.walkContinueWalkthrough":"Haz click en 'Siguiente' para continuar con este tutorial.", "i.walkFlashcard_4":"Cuando est\u00e1s creando una Flashcard, se muestra un nuevo panel en la parte inferior de la pantalla. Nos referiremos a este panel como el 'panel de Flashcard'.", "i.walkFlashcard_5":"Para a\u00f1adir una nueva diapositiva a la Flashcard pulsa sobre el bot\u00f3n 'A\u00f1adir' situado en el 'panel de Flashcard' y contin\u00faa con el procedimiento habitual para a\u00f1adir una diapositiva. Despu\u00e9s de a\u00f1adirla, la miniatura de la nueva diapositiva aparecer\u00e1 en el panel y se mostrar\u00e1 la diapositiva en la pantalla.", 
"i.walkFlashcard_6":"Cuando la diapositiva est\u00e1 seleccionada, se muestra en la pantalla y puedes editarla y borrarla de la misma forma que las diapositivas normales. Para seleccionar una diapositiva simplemente pulsa sobre ella en el 'panel de Flashcard'. Si quieres seleccionar la Flashcard nuevamente para editarla, debes hacer click en el icono de Flashcard situado a la izquierda del 'panel de Flashcard'.", "i.walkFlashcard_7":"Las diapositivas tienen flechas arrastrables en su parte superior. Puedes arrastrar cualquiera de ellas a la imagen de fondo de la Flashcard para crear una nueva 'zona caliente'. De este modo, cuando los usuarios hagan click sobre una flecha ver\u00e1n la diapositiva asociada. ", 
"i.walkRememberPreview":"Recuerda que puedes previsualizar el objeto que est\u00e1s creando en cualquier momento haciendo click sobre el bot\u00f3n 'Vista Previa' situado en la barra de herramientas", "i.CreatingVirtualTours":"Creando Tours Virtuales", "i.walkVirtualTour_1":"Para empezar a crear un Tour Virtual debes hacer click en el bot\u00f3n 'A\u00f1adir' situado a la izquierda (el bot\u00f3n utilizado para a\u00f1adir nuevas diapositivas), y a continuaci\u00f3n debes pulsar sobre el icono de Tour Virtual en el panel 'Smartcards'. Despu\u00e9s de esto, se mostrar\u00e1 un Tour Virtual vacio en la pantalla.", 
"i.VirtualTourIcon":"Icono de Tour Virtual", "i.walkVirtualTour_2a":"Cuando estas creando un Tour Virtual, se muestra un mapa interactivo con una caja de b\u00fasqueda en su parte superior. Puedes usar esta caja de texto para buscar lugares y localizaciones. Escribe la localizaci\u00f3n que quieras buscar, por ejemplo", "i.walkVirtualTour_2b":"Se mostrar\u00e1 una lista de resultados en la parte inferior de la caja de b\u00fasqueda. Puedes elegir cualquier de ellos o  pulsar la tecla 'intro' para seleccionar autom\u00e1ticamente el primero. El mapa mostrar\u00e1 la localizaci\u00f3n seleccionada.", 
"i.walkVirtualTour_3":"Cuando est\u00e1s creando un Tour Virtual, se muestra un nuevo panel en la parte inferior de la pantalla. Nos referiremos a este panel como el 'panel de Tour Virtual'.", "i.walkVirtualTour_4":"Para a\u00f1adir una nueva diapositiva al Tour Virtual pulsa sobre el bot\u00f3n 'A\u00f1adir' situado en el 'panel de Tour Virtual' y contin\u00faa con el procedimiento habitual para a\u00f1adir una diapositiva. Despu\u00e9s de a\u00f1adirla, la miniatura de la nueva diapositiva aparecer\u00e1 en el panel y se mostrar\u00e1 la diapositiva en la pantalla.", 
"i.walkVirtualTour_5":"Cuando la diapositiva est\u00e1 seleccionada, se muestra en la pantalla y puedes editarla y borrarla de la misma forma que las diapositivas normales. Para seleccionar una diapositiva simplemente pulsa sobre ella en el 'panel de Tour Virtual'. Si quieres seleccionar el Tour Virtual nuevamente para editarlo, debes hacer click en el icono de Tour Virtual situado a la izquierda del 'panel de Tour Virtual'.", "i.walkVirtualTour_6":"Las diapositivas tienen flechas arrastrables en su parte superior. Puedes arrastrar cualquiera de ellas dentro del mapa para crear una nueva localizaci\u00f3n. Cuando arrastres una flecha dentro del mapa, un nuevo 'pin' aparecer\u00e1 en la localizaci\u00f3n seleccionada. De esta forma, cuando los usuarios hagan click sobre un 'pin' en el mapa ver\u00e1n la diapositiva asociada. Los 'pins' tambi\u00e9n son arrastrables, de modo que puedes moverlos a lo largo del mapa. Para eliminar un 'pin' en el mapa, simplemente haz click sobre \u00e9l.", 
"i.walkSelectSlides_1":"A\u00f1adiendo diapositivas externas a tu presentaci\u00f3n", "i.walkSelectSlides_2":"Aqu\u00ed puedes previsualizar la presentaci\u00f3n que has decidido importar. Puedes insertar todas las diapositivas de la presentaci\u00f3n o seleccionar solo aquellas que quieras insertar.", "i.walkSelectSlides_3":"Teniendo en cuenta que por defecto se seleccionan todas las diapositivas, si quieres insertar la presentaci\u00f3m completa solamente tienes que hacer click sobre el bot\u00f3n 'A\u00f1adir Diapositivas' situado en la zona inferior derecha de la pantalla.", 
"i.walkSelectSlides_4":"Si quieres seleccionar de forma espec\u00edfica las diapositivas a importar, las siguientes instrucciones te servir\u00e1n de ayuda", "i.walkSelectSlides_5a":"Utiliza las flechas", "i.walkSelectSlides_5b":"situadas en la zona inferior para recorrer las diapositivas de la presentaci\u00f3n.", "i.walkSelectSlides_6a":"Las diapositivas seleccionadas tienen un borde verde", "i.walkSelectSlides_6b":"mientras que las diapositivas no seleccionadas tienen un borde rojo.", "i.walkSelectSlides_7":"Para seleccionar o deseleccionar la diapositiva actual que est\u00e1s viendo, pulsa sobre el bot\u00f3n 'Seleccionar/Deseleccionar Diapositiva' situado en el centro de la zona inferior.", 
"i.walkSelectSlides_8":"Adem\u00e1s, puedes hacer uso de los siguientes botones para seleccionar o deseleccionar de golpe todas las diapositivas.", "i.walkSelectSlides_9":"Finalmente, para insertar todas las diapositivas que has seleccionado debes de hacer click en el bot\u00f3n 'A\u00f1adir Diapositivas' situado en la zona inferior derecha de la pantalla. La cantidad de diapositivas a insertar se indica a la izquierda de este bot\u00f3n.", "i.walkQuizzes_1":"Cuestionarios en Vivo", "i.walkQuizzes_2":"Los Cuestionarios en Vivo permiten lanzar cuestionarios y sondeos en tiempo real para obtener respuestas de forma inmediata.", 
"i.walkQuizzes_3":"Para lanzar un 'Cuestionario en Vivo' tienes que acceder a una presentaci\u00f3n y hacer click en el bot\u00f3n 'Lanzar' situado en la parte inferior del cuestionario que quieras usar. Ten en cuenta que el bot\u00f3n 'Lanzar' no se muestra cuando previsualizas una presentaci\u00f3n con el editor. Cuando lanzas un cuestionario en vivo, se crea una 'sesi\u00f3n de cuestionario' en la plataforma ViSH, la cual almacenar\u00e1 todos los resultados y estad\u00edsticas del cuestionario. Una vez que una 'sesi\u00f3n de cuestionario' haya sido creada, podr\u00e1s acceder a ella (y por tanto ver los resultados y estad\u00edsticas) en cualquier momento en la plataforma ViSH.", 
"i.walkQuizzes_4":"Despu\u00e9s de que lances un cuestionario en vivo usando el bot\u00f3n 'Lanzar' situado en la parte inferior del cuestionario, una nueva pantalla aparecer\u00e1 ('pantalla de cuestionario en vivo') mostrando diversos elementos", "i.walkQuizzes_5a":"Un hiperenlace al cuestionario en vivo, por ejemplo", "i.walkQuizzes_5b":"Este hiperenlace es utilizado para responder al cuestionario. Cualquier persona que acceda a esta direcci\u00f3n de internet podr\u00e1 responder al cuestionario en vivo. Por lo tanto puedes compartir tu cuestionario en vivo mediante este hiperenlace, por ejemplo envi\u00e1ndolo por correo electr\u00f3nico o peg\u00e1ndolo en un foro.", 
"i.walkQuizzes_6":"Algunos logos de redes sociales populares (Twitter, Facebook, Google+, ...). Puedes compartir el hiperenalce del cuestionario en vivo en cualquiera de estas redes sociales pulsando sobre el logo correspondiente.", "i.walkQuizzes_7":"Un c\u00f3digo QR para dispositivos m\u00f3viles. Cualquier dispositivo puede obtener autom\u00e1ticamente el hiperenlace del cuestionario en vivo escaneando este c\u00f3digo QR.", "i.walkQuizzes_8":"Una pesta\u00f1a 'Resultados' situada en la parte superior, que permite ver en tiempo real los resultados del cuestionario. Dependiendo del tipo de cuestionario, la representaci\u00f3n de los resultados ser\u00e1 diferente (gr\u00e1fico circular, de barras, etc.).", 
"i.walkQuizzes_9":"Si quieres 'cerrar' el cuestionario en vivo debes hacer click en el bot\u00f3n 'Detener' situado en la parte inferior derecha. Despu\u00e9s de cerrar un cuestionario, no se admitir\u00e1n ni guardar\u00e1n m\u00e1s respuestas. Tambi\u00e9n puedes cerrar un cuestionario en cualquier momento desde la plataforma ViSH. Cuando cierras un cuestionario en vivo, puedes, opcionalmente, especificar un nombre para facilitar su b\u00fasqueda posterior en el ViSH.", "i.walkQuizzes_10":"Si sales de la pantalla de cuestionarios en vivo, puedes regresar en cualquier momento haciendo click sobre el bot\u00f3n 'Opciones' situado en la parte inferior del cuestionario. Tenga en cuenta que si un cuestionario ha sido lanzado, el bot\u00f3n 'Lanzar' es reemplazado por un bot\u00f3n 'Opciones'. Cuando se cierre el cuestionario, el bot\u00f3n 'Lanzar' volver\u00e1 a aparecer. Finalmente, tenga en cuenta que no puede lanzar m\u00e1s de un cuestionario en vivo a la vez.", 
"i.vtTitle_GStarted":"Introducci\u00f3n a ViSH Editor", "i.About2":"C\u00f3digo disponible en", "i.About3":"visita nuestro canal de YouTube", "i.About4":"Desarrollado por", "i.VESurvey1":"Ay\u00fadanos a mejorar ViSH Editor", "i.VESurvey2":"Por favor, rellena", "i.VESurvey3":"esta encuesta", "i.VESurvey4":"\u00a1Gracias por tu colaboraci\u00f3n", "i.VESurveyURL":"https://docs.google.com/forms/d/1b_Ml2iua0oDNKkJqc7eT1W2CDlRhIZR__w2AlicfwjA/viewform", "i.walkCompetitions1_1":"Estamos organizando una competici\u00f3n", 
"i.walkCompetitions1_2":"Para participar s\u00f3lo tienes que a\u00f1adir el tag ViSHCompetition2013 a tu excursi\u00f3n y uno o m\u00e1s de los siguientes tags:", "i.walkCompetitions1_3":"Maths, Physics, Chemistry, Biology, EnvironmentalStudies, Geography, Engineering, Humanities, NaturalScience o ComputerScience.", "i.walkCompetitions1_4":"Para m\u00e1s informaci\u00f3n ve a", "i.walkCompetitions1_5":"la p\u00e1gina de informaci\u00f3n", "i.walkCompetitions1_6":"o a la", "i.walkCompetitions1_7":"secci\u00f3n de preguntas frecuentes", 
"i.accept":"aceptar", "i.add":"a\u00f1adir", "i.Add":"A\u00f1adir", "i.Addanavatar":"A\u00f1adir avatar *", "i.addatitle":"a\u00f1ade un t\u00edtulo", "i.AddContent":"A\u00f1adir Contenido", "i.addembeddedobject":"a\u00f1adir objeto embebido", "i.AddFromJSONfile":"A\u00f1adir una presentaci\u00f3n de ViSH Editor de un fichero JSON", "i.addpicurl":"a\u00f1adir URL de imagen", "i.AddSlide":"A\u00f1adir diapositiva", "i.AddSlideMin":"A\u00f1adir", "i.AddSlides":"A\u00f1adir Diapositivas", "i.AddslideshowPDF":"A\u00f1adir presentaci\u00f3n de un fichero PDF", 
"i.AddTags":"A\u00f1adir etiquetas", "i.addvideourl":"a\u00f1adir URL de video (YouTube, HTML5)", "i.Age range":"Rango de edad", "i.areyousureNotification":"\u00bfest\u00e1s seguro?", "i.Animations":"Animaciones", "i.Horizontal":"Horizontal", "i.Vertical":"Vertical", "i.Opacity":"Opacidad", "i.Elements":"Elementos", "i.Rotate":"Rotar", "i.Diagonal1":"Diagonal #1", "i.Diagonal2":"Diagonal #2", "i.Inside":"Dentro", "i.Zoom":"Ampliar", "i.Flip1":"Vuelta #1", "i.Flip2":"Vuelta #2", "i.3D":"3D", "i.Art":"Arte", 
"i.Astronomy":"Astronom\u00eda", "i.Author":"Autor", "i.Background":"Fondo", "i.biology":"biolog\u00eda", "i.Biology":"Biolog\u00eda", "i.browserrequirements":"El navegador que estas utilizando no cumple los requisitos minimos para utilizar esta aplicaci\u00f3n. Por favor, actualiza tu navegador", "i.by":"por", "i.cancel":"cancelar", "i.Cancel":"Cancelar", "i.Chemistry":"Qu\u00edmica", "i.Citizenship":"Educaci\u00f3n para la Ciudadan\u00eda", "i.ClassicalLanguages":"Lenguas Cl\u00e1sicas", "i.close":"cerrar", 
"i.Close":"Cerrar", "i.CloseWSaving":"cerrar sin guardar", "i.Competitions":"Competici\u00f3n", "i.content":"contenido", "i.Content":"Contenido", "i.Context":"Contexto", "i.continue":"continuar", "i.Continue":"Continuar", "i.CrossCurricularEducation":"Educaci\u00f3n Multidisciplinar", "i.ComputerScience":"Inform\u00e1tica", "i.delete":"borrar", "i.Description":"Descripci\u00f3n", "i.difficult":"dif\u00edcil", "i.Difficulty":"Dificultad", "i.Documentation":"Documentaci\u00f3n", "i.done":"hecho", "i.Done":"Hecho", 
"i.draft":"borrador", "i.easy":"f\u00e1cil", "i.Economics":"Econom\u00eda", "i.edit":"editar", "i.Education":"Educaci\u00f3n", "i.EducationalObjectives":"Objetivos educativos", "i.EducationalObjectivesPlaceholder":"Describa los objetivos educativos que pretende cumplir con esta excursi\u00f3n...", "i.Electronics":"Electr\u00f3nica", "i.embedwebsite":"embeber web", "i.embedWebSnapshot":"embeber Web Snapshot", "i.EnvironmentalEducation":"Educaci\u00f3n Ambiental", "i.errorFlickrConnection":"Error conectando con Flickr", 
"i.errorLREConnection":"Error al conectarse con el repositorio del LRE", "i.errorViSHConnection":"Error al conectarse con el servidor de ViSH", "i.errorYoutubeConnection":"Error conectando con YouTube", "i.Ethics":"\u00c9tica", "i.ExcursionDetails":"Informaci\u00f3n de la Excursi\u00f3n", "i.Excursions":"Excursiones", "i.Exit":"Salir", "i.exitConfirmation":"Vas a abandonar ViSH Editor. Se perder\u00e1n todos los cambios que no hayas salvado.", "i.exitConfirmation2":"\u00bfSeguro que quieres abandonar esta p\u00e1gina?", 
"i.exitConfirmationMenu":"La Excursi\u00f3n Virtual se ha modificado. Si la cierra sin guardar perder\u00e1 todos los cambios. \u00bfQu\u00e9 desea hacer?", "i.ExitWSaving":"salir sin guardar", "i.Export":"Exportar", "i.exportPresToJSONerrorNotification":"Ha ocurrido un error. No es posible exportar la presentaci\u00f3n a un fichero JSON.", "i.Filllater":"Rellenar despu\u00e9s", "i.Finish":"Terminar", "i.Flashcard":"Flashcard", "i.Flashcards":"Flashcards", "i.ForeignLanguages":"Idiomas", "i.Game":"Juego", 
"i.GeneralCulture":"Cultura General", "i.Geography":"Geograf\u00eda", "i.Geology":"Geolog\u00eda", "i.GotoSettings":"Ir a Ajustes", "i.HealthEducation":"Educaci\u00f3n para la Salud", "i.Help":"Ayuda", "i.HigherEducation":"Educaci\u00f3n Secundaria", "i.History":"Histor\u00eda", "i.HomeEconomics":"Econom\u00eda Dom\u00e9stica", "i.Hours":"Horas", "i.Image":"Imagen", "i.Images":"Im\u00e1genes", "i.Import":"Importar", "i.Insert":"Insertar", "i.invalidvalue":"valor inv\u00e1lido", "i.Language":"Idioma", 
"i.Languageindependent":"Independiente del idioma", "i.Law":"Derecho", "i.License":"Licencia", "i.limitReached":"limite alcanzado", "i.link":"enlace", "i.Literature":"Literatura", "i.LiveQuiz":"Cuestionario en Vivo", "i.LiveResources":"Contenidos en directo", "i.MandatoryFieldsNotification":"Tienes que escribir un t\u00edtulo y escoger un avatar para la excursi\u00f3n antes de publicarla.", "i.math":"matem\u00e1ticas", "i.Mathematics":"Matem\u00e1ticas", "i.medium":"medio", "i.Minutes":"Minutos", 
"i.Music":"M\u00fasica", "i.nanoscience":"nanociencia", "i.NaturalSciences":"Ciencias Naturales", "i.next":"siguiente", "i.Next":"Siguiente", "i.no":"no", "i.No":"No", "i.NoCompetitions1":"\u00bfQuieres participar en la competici\u00f3n? Puedes ganar un gran premio. Lee la guia de c\u00f3mo hacerlo <a href='http://vishub.org/competitions' target='_blank'>aqu\u00ed</a>", "i.NoCompetitions2":"A\u00f1ade una o m\u00e1s de las siguientes tags para participar:", "i.NoCompetitions3":"Se a\u00f1adir\u00e1n a las tags de la excursi\u00f3n. Las puedes revisar o cambiar en la p\u00e1gina de ajustes", 
"i.NoJSONFileError":"Tienes que seleccionar un archivo para importar en formato JSON", "i.Noresultsfound":"No se encontraron resultados", "i.NoSlidesOnSaveNotification":"Antes de guardar tienes que crear por lo menos una diapositiva.", "i.NoThanks":"No gracias", "i.Object":"Objeto", "i.Objects":"Objetos", "i.Ok":"Ok", "i.OK":"OK", "i.or":"o", "i.Other":"Otro", "i.Others":"Otros", "i.pasteEmbedObject":"pega la URL de un archivo SWF o PDF", "i.pasteImageURL":"pega la URL de una imagen", "i.pasteVideoURL":"pega la URL de un video HTML5 o de YouTube", 
"i.pasteWeb":"pega la URL de una p\u00e1gina web", "i.pdfErrorNotification":"Ha ocurrido un error. Asegurese de que el fichero PDF es v\u00e1lido.", "i.PDFNotValid":"Se ha producido un error. Aseg\u00farese de que el fichero PDF seleccionado es correcto.", "i.PDFSlideshow":"Presentaci\u00f3n PDF", "i.PedagogicalAspects":"Aspectos Pedag\u00f3gicos", "i.Philosophy":"Filosof\u00eda", "i.PhysicalEducation":"Educaci\u00f3n F\u00edsica", "i.Physics":"F\u00edsica", "i.pNotValid":"Este recurso no puede ser abierto porque est\u00e1 da\u00f1ado o no es compatible con la versi\u00f3n actual de ViSH Editor.", 
"i.Politics":"Ciencias Pol\u00edticas", "i.Preschool":"Preescolar", "i.Presentation":"Presentaci\u00f3n", "i.presDescriptionPlaceHolder":"Describa brevemente sobre qu\u00e9 trata la excursi\u00f3n", "i.presTitle":"T\u00edtulo de la excursi\u00f3n", "i.Preview":"Vista previa", "i.Psychology":"Psicolog\u00eda", "i.publish":"publicar", "i.Publish":"Publicar", "i.publishing":"Publicando", "i.Publishing":"Publicando", "i.Publish_confirmation":"Vas a guardar y publicar esta Excursi\u00f3n Virtual en la plataforma ViSH. Despu\u00e9s de esto, la excursi\u00f3n ser\u00e1 p\u00fablica y cualquiera podr\u00e1 acceder a ella. \u00bfQu\u00e9 deseas hacer?", 
"i.Quiz":"Quiz", "i.QuizButtonAnswer":"Responder", "i.QuizButtonLaunch":"Lanzar", "i.QuizButtonOptions":"Opciones", "i.QuizButtonRetry":"Reintentar", "i.QuizCreateSessionError":"Lo sentimos, ha ocurrido un error al crear un nuevo cuestionario en vivo", "i.QuizEmptyAnswerAlert":"Por favor, responde el cuestionario antes de enviar tu respuesta", "i.QuizLaunch":"Lanzar", "i.QuizMultipleLaunchAlert":"Por favor, det\u00e9n todos los cuestionarios en vivo antes de lanzar uno nuevo", "i.QuizNotSubmittedAlert":"Lo sentimos, tu respuesta no ha podido ser enviada", 
"i.QuizResults":"Resultados", "i.QuizRetry":"Reintentar", "i.QuizSaveConfirmation":"\u00bfQuieres guardar los resultados del cuestionario?", "i.QuizSessionName":"Nombre del Cuestionario en Vivo", "i.QuizStop":"Detener", "i.QuizSubmittedAlert":"Tu respuesta ha sido enviada", "i.Quizzes":"Quizzes (Cuestionarios)", "i.readJSONfileError":"Error al leer el fichero JSON", "i.Religion":"Religi\u00f3n", "i.Remove":"Borrar", "i.resourceNonCompatibleNotification":"El recurso no puede ser abierto porque est\u00e1 corrupto o no es compatible con la versi\u00f3n actual de ViSH Editor", 
"i.save":"guardar", "i.Save":"Guardar", "i.SaveAndExit":"guardar y salir", "i.Saved":"Guardado", "i.Saving":"Guardando", "i.School":"Colegio", "i.SearchContent":"Buscar contenido", "i.Searchplaces":"Buscar lugares", "i.Seconds":"Segundos", "i.SelectAll":"Seleccionar Todas", "i.selectObjectUpload":"Selecciona un archivo para subir", "i.selectObjectUpload2":"Formatos soportados: SWF (flash), PDF", "i.selectPicture":"Seleccionar imagen para subir", "i.SelectSlide":"Seleccionar Diapositiva", "i.SelectTheme":"Seleccionar Tema", 
"i.Settings":"Ajustes", "i.Slides":"Diapositivas", "i.Smartcards":"Smartcards", "i.SocialSciences":"Ciencias Sociales", "i.SoftwareEngineering":"Ingenier\u00eda del Software", "i.Style":"Estilo", "i.Subject":"Tema", "i.Tags":"Etiquetas", "i.Technology":"Tecnolog\u00eda", "i.Templates":"Plantillas", "i.text":"texto", "i.Text":"Texto", "i.Telecommunications":"Telecomunicaciones", "i.Title":"T\u00edtulo *", "i.toJSON":"a JSON", "i.Training":"Formaci\u00f3n Laboral", "i.Typicallearningtime":"Tiempo de aprendizaje t\u00edpico", 
"i.University":"Universidad", "i.unpublish":"retirar publicaci\u00f3n", "i.Unpublish":"Retirar", "i.unpublishing":"retirando", "i.Unpublishing":"Retirando", "i.Unpublish_confirmation":"Vas a retirar la publicaci\u00f3n de esta Excursi\u00f3n Virtual de la plataforma ViSH.  Despu\u00e9s de esto la excursi\u00f3n ser\u00e1 privada y solo t\u00fa podras acceder a ella. \u00bfQu\u00e9 deseas hacer?", "i.UnselectAll":"Deseleccionar Todas", "i.UnselectSlide":"Deseleccionar Diapositiva", "i.unspecified":"sin especificar", 
"i.Unspecified":"Sin especificar", "i.upload":"subir", "i.Upload":"Subir", "i.url":"enlace", "i.Url":"Enlace", "i.Version":"Versi\u00f3n", "i.veryeasy":"muy f\u00e1cil", "i.verydifficult":"muy dif\u00edcil", "i.video":"v\u00eddeo", "i.videos":"v\u00eddeos", "i.VirtualTour":"Tour Virtual", "i.yes":"si", "i.Yes":"Si", "i.ZoneTooltip":"Haz click aqu\u00ed para a\u00f1adir contenido", "i.img.tut_menu":"tutorial/tut_menu_es.png", "i.img.tut_selects":"tutorial/tut_selects_es.png", "i.img.tut_unselects":"tutorial/tut_unselects_es.png", 
"i.img.tut_selectAll":"tutorial/tut_selectall_es.png", "i.img.tut_unselectAll":"tutorial/tut_unselectall_es.png", "i.tooltip.QSInput":"Introduce un nombre para el cuestionario en vivo", "i.last":"\u00faltimo"}, "default":{"i.add":"add", "i.Add":"Add", "i.AddTags":"Add tags", "i.areyousureNotification":"are you sure?", "i.Author":"Author", "i.cancel":"cancel", "i.Cancel":"Cancel", "i.close":"close", "i.Close":"Close", "i.CloseWSaving":"close without saving", "i.delete":"delete", "i.Description":"Description", 
"i.difficult":"difficult", "i.Done":"Done", "i.draft":"draft", "i.easy":"easy", "i.errorFlickrConnection":"Error connecting to Flickr", "i.errorLREConnection":"Error connecting to the LRE repository", "i.errorViSHConnection":"Error connecting to ViSH server", "i.errorYoutubeConnection":"Error connecting to YouTube", "i.Exit":"Exit", "i.exitConfirmation":"You are about to leave ViSH Editor. You will lose any changes you have not saved.", "i.exitConfirmation2":"Are you sure you want to leave this page?", 
"i.exitConfirmationMenu":"The Virtual Excursion has been modified. If you close without saving you will lose all changes. What would you like to do?", "i.ExitWSaving":"exit without saving", "i.exportPresToJSONerrorNotification":"An error has ocurred. Is not possible to export the presentation to a JSON file.", "i.GotoSettings":"Go to Settings", "i.invalidvalue":"invalid value", "i.limitReached":"limit reached", "i.MandatoryFieldsNotification":"You need to write a title for the excursion and select an avatar before publish the excursion", 
"i.medium":"medium", "i.no":"no", "i.No":"No", "i.NoCompetitions1":"Do you want to participate in the competition? You can win great prizes. Read the guide about how participate <a href='http://vishub.org/competitions' target='_blank'>here</a>", "i.NoCompetitions2":"Add one or more of the following tags to participate:", "i.NoCompetitions3":"They will be added to the tags of the excursion. You can review them in the settings page", "i.NoJSONFileError":"You have to select a file to import in JSON format", 
"i.Noresultsfound":"No results found", "i.NoSlidesOnSaveNotification":"Create at least one slide before saving.", "i.NoThanks":"No thanks", "i.Ok":"Ok", "i.OK":"OK", "i.pasteEmbedObject":"paste SWF or PDF file URL", "i.pasteImageURL":"paste image URL", "i.pasteVideoURL":"paste HTML5 or YouTube video URL", "i.pasteWeb":"paste website URL", "i.pdfErrorNotification":"An error has occurred. Ensure that the PDF file is valid.", "i.publish":"publish", "i.Publish":"Publish", "i.publishing":"publishing", 
"i.Publishing":"Publishing", "i.Publish_confirmation":"You are going to save and publish this Virtual Excursion on the ViSH Platform. After this, the excursion will be public and anyone will be able to access it. What would you like to do?", "i.QuizButtonAnswer":"Answer", "i.QuizButtonLaunch":"Launch", "i.QuizButtonOptions":"Options", "i.QuizButtonRetry":"Retry", "i.QuizCreateSessionError":"Sorry, an error occurred while creating the new Live Quiz", "i.QuizEmptyAnswerAlert":"Please, answer the quiz before send", 
"i.QuizLaunch":"Launch", "i.QuizMultipleLaunchAlert":"Please stop all live quizzes before launch another one", "i.QuizNotSubmittedAlert":"Sorry, your answer couldn't be sent", "i.QuizResults":"Results", "i.QuizRetry":"Retry", "i.QuizSaveConfirmation":"Do you want to save the quiz results?", "i.QuizSessionName":"Live Quiz Name", "i.QuizStop":"Stop", "i.QuizSubmittedAlert":"Your answer has been submitted", "i.readJSONfileError":"Error reading JSON file", "i.resourceNonCompatibleNotification":"This resource is corrupt or is not compatible with the current version of ViSH Editor and cannot be opened.", 
"i.save":"save", "i.Save":"Save", "i.SaveAndExit":"save and exit", "i.Saved":"Saved", "i.Saving":"Saving", "i.SearchContent":"Search Content", "i.Searchplaces":"Search places", "i.SelectSlide":"Select Slide", "i.Title":"Title *", "i.unpublish":"unpublish", "i.Unpublish":"Unpublish", "i.unpublishing":"unpublishing", "i.Unpublishing":"Unpublishing", "i.Unpublish_confirmation":"You are going to unpublish this Virtual Excursion from the ViSH Platform. After this, the excursion will be private and only you will be able to access it. What would you like to do?", 
"i.UnselectSlide":"Unselect Slide", "i.unspecified":"unspecified", "i.Unspecified":"Unspecified", "i.verydifficult":"very difficult", "i.veryeasy":"very easy", "i.yes":"yes", "i.Yes":"Yes", "i.ZoneTooltip":"Click here to add content", "i.VESurveyURL":"https://docs.google.com/forms/d/1jqgQsQ84sBsETRt0qY-vAz7dWk9hT3ouWH1dN0vGzQA/viewform", "i.tooltip.QSInput":"Enter a name for the live quiz", "i.last":"last"}}, "standalone":{"es":{"i.save":"Standalone"}, "default":{"i.save":"Standalone"}}};
var VISH = VISH || {};
VISH.VERSION = "0.8";
VISH.AUTHORS = "GING";
VISH.URL = "http://github.com/ging/vish_editor";
VISH.Constant = VISH.Constant || {};
VISH.Constant.Edit = "Editor";
VISH.Constant.Viewer = "Viewer";
VISH.Constant.AnyMode = "Both";
VISH.Constant.NOSERVER = "noserver";
VISH.Constant.VISH = "vish";
VISH.Constant.STANDALONE = "node";
VISH.Constant.UA_IE = "Microsoft Internet Explorer";
VISH.Constant.UA_NETSCAPE = "Netscape";
VISH.Constant.IE = "Internet Explorer";
VISH.Constant.FIREFOX = "Mozilla Firefox";
VISH.Constant.CHROME = "Google Chrome";
VISH.Constant.SAFARI = "Safari";
VISH.Constant.ANDROID_BROWSER = "Android Browser";
VISH.Constant.EXTRA_SMALL = "extra-small";
VISH.Constant.SMALL = "small";
VISH.Constant.MEDIUM = "medium";
VISH.Constant.LARGE = "large";
VISH.Constant.THUMBNAIL = "thumbnail";
VISH.Constant.NONE = "none";
VISH.Constant.UNKNOWN = "Unknown";
VISH.Constant.AGE_RANGE_MIN = 4;
VISH.Constant.AGE_RANGE_MAX = 20;
VISH.Constant.AGE_RANGE = VISH.Constant.AGE_RANGE_MIN + " - " + VISH.Constant.AGE_RANGE_MAX;
VISH.Constant.DIFFICULTY = 0;
VISH.Constant.PRESENTATION = "presentation";
VISH.Constant.QUIZ_SIMPLE = "quiz_simple";
VISH.Constant.STANDARD = "standard";
VISH.Constant.SLIDESET = "slideset";
VISH.Constant.FLASHCARD = "flashcard";
VISH.Constant.VTOUR = "VirtualTour";
VISH.Constant.GAME = "game";
VISH.Constant.TEXT = "text";
VISH.Constant.IMAGE = "image";
VISH.Constant.VIDEO = "video";
VISH.Constant.OBJECT = "object";
VISH.Constant.SNAPSHOT = "snapshot";
VISH.Constant.APPLET = "applet";
VISH.Constant.QUIZ = "quiz";
VISH.Constant.MEDIA = {};
VISH.Constant.MEDIA.IMAGE = "image";
VISH.Constant.MEDIA.FLASH = "swf";
VISH.Constant.MEDIA.PDF = "pdf";
VISH.Constant.MEDIA.YOUTUBE_VIDEO = "youtube";
VISH.Constant.MEDIA.HTML5_VIDEO = "HTML5";
VISH.Constant.MEDIA.WEB = "web";
VISH.Constant.MEDIA.JSON = "json";
VISH.Constant.MEDIA.DOC = "doc";
VISH.Constant.MEDIA.PPT = "ppt";
VISH.Constant.WRAPPER = {};
VISH.Constant.WRAPPER.EMBED = "EMBED";
VISH.Constant.WRAPPER.OBJECT = "OBJECT";
VISH.Constant.WRAPPER.IFRAME = "IFRAME";
VISH.Constant.QZ_TYPE = {};
VISH.Constant.QZ_TYPE.OPEN = "open";
VISH.Constant.QZ_TYPE.MCHOICE = "multiplechoice";
VISH.Constant.QZ_TYPE.TF = "truefalse";
VISH.Constant.QZ_MODE = {};
VISH.Constant.QZ_MODE.SELFA = "selfA";
VISH.Constant.QZ_MODE.RT = "realTime";
VISH.Constant.TextDefault = 12;
VISH.Constant.TextBase = 12;
VISH.Constant.Video = {};
VISH.Constant.Video.HTML5 = "HTML5";
VISH.Constant.Video.Youtube = "Youtube";
VISH.Constant.Clipboard = {};
VISH.Constant.Clipboard.Slide = "slide";
VISH.Constant.Clipboard.LocalStorageStack = "VishEditorClipboardStack";
VISH.Constant.Themes = {};
VISH.Constant.Themes.Default = "theme1";
VISH.Constant.Animations = {};
VISH.Constant.Animations.Default = "animation1";
VISH.Constant.Event = {};
VISH.Constant.Event.onMessage = "onMessage";
VISH.Constant.Event.onGoToSlide = "onGoToSlide";
VISH.Constant.Event.onPlayVideo = "onPlayVideo";
VISH.Constant.Event.onPauseVideo = "onPauseVideo";
VISH.Constant.Event.onSeekVideo = "onSeekVideo";
VISH.Constant.Event.onFlashcardPointClicked = "onFlashcardPointClicked";
VISH.Constant.Event.onFlashcardSlideClosed = "onFlashcardSlideClosed";
VISH.Constant.Event.onSetSlave = "onSetSlave";
VISH.Constant.Event.onPreventDefault = "onPreventDefault";
VISH.Constant.Event.allowExitWithoutConfirmation = "allowExitWithoutConfirmation";
VISH.Constant.Event.onSelectedSlides = "onSelectedSlides";
VISH.Constant.Event.onVEFocusChange = "onVEFocusChange";
VISH.Constant.Storage = {};
VISH.Constant.Storage.Device = "Device";
VISH.Constant.VTour = {};
VISH.Constant.VTour.DEFAULT_MAP = "roadmap";
VISH.Constant.VTour.ROADMAP = "roadmap";
VISH.Constant.VTour.SERVICES = {};
VISH.Constant.VTour.SERVICES.GMaps = "Google Maps";
VISH.Constant.INTRO = 13;
window.Chart = function(context) {
  var chart = this;
  var animationOptions = {linear:function(t) {
    return t
  }, easeInQuad:function(t) {
    return t * t
  }, easeOutQuad:function(t) {
    return-1 * t * (t - 2)
  }, easeInOutQuad:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t
    }
    return-1 / 2 * (--t * (t - 2) - 1)
  }, easeInCubic:function(t) {
    return t * t * t
  }, easeOutCubic:function(t) {
    return 1 * ((t = t / 1 - 1) * t * t + 1)
  }, easeInOutCubic:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t
    }
    return 1 / 2 * ((t -= 2) * t * t + 2)
  }, easeInQuart:function(t) {
    return t * t * t * t
  }, easeOutQuart:function(t) {
    return-1 * ((t = t / 1 - 1) * t * t * t - 1)
  }, easeInOutQuart:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t * t
    }
    return-1 / 2 * ((t -= 2) * t * t * t - 2)
  }, easeInQuint:function(t) {
    return 1 * (t /= 1) * t * t * t * t
  }, easeOutQuint:function(t) {
    return 1 * ((t = t / 1 - 1) * t * t * t * t + 1)
  }, easeInOutQuint:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t * t * t
    }
    return 1 / 2 * ((t -= 2) * t * t * t * t + 2)
  }, easeInSine:function(t) {
    return-1 * Math.cos(t / 1 * (Math.PI / 2)) + 1
  }, easeOutSine:function(t) {
    return 1 * Math.sin(t / 1 * (Math.PI / 2))
  }, easeInOutSine:function(t) {
    return-1 / 2 * (Math.cos(Math.PI * t / 1) - 1)
  }, easeInExpo:function(t) {
    return t == 0 ? 1 : 1 * Math.pow(2, 10 * (t / 1 - 1))
  }, easeOutExpo:function(t) {
    return t == 1 ? 1 : 1 * (-Math.pow(2, -10 * t / 1) + 1)
  }, easeInOutExpo:function(t) {
    if(t == 0) {
      return 0
    }
    if(t == 1) {
      return 1
    }
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * Math.pow(2, 10 * (t - 1))
    }
    return 1 / 2 * (-Math.pow(2, -10 * --t) + 2)
  }, easeInCirc:function(t) {
    if(t >= 1) {
      return t
    }
    return-1 * (Math.sqrt(1 - (t /= 1) * t) - 1)
  }, easeOutCirc:function(t) {
    return 1 * Math.sqrt(1 - (t = t / 1 - 1) * t)
  }, easeInOutCirc:function(t) {
    if((t /= 1 / 2) < 1) {
      return-1 / 2 * (Math.sqrt(1 - t * t) - 1)
    }
    return 1 / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1)
  }, easeInElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1) == 1) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    return-(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * 2 * Math.PI / p))
  }, easeOutElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1) == 1) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    return a * Math.pow(2, -10 * t) * Math.sin((t * 1 - s) * 2 * Math.PI / p) + 1
  }, easeInOutElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1 / 2) == 2) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3 * 1.5
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    if(t < 1) {
      return-0.5 * a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * 2 * Math.PI / p)
    }
    return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * 1 - s) * 2 * Math.PI / p) * 0.5 + 1
  }, easeInBack:function(t) {
    var s = 1.70158;
    return 1 * (t /= 1) * t * ((s + 1) * t - s)
  }, easeOutBack:function(t) {
    var s = 1.70158;
    return 1 * ((t = t / 1 - 1) * t * ((s + 1) * t + s) + 1)
  }, easeInOutBack:function(t) {
    var s = 1.70158;
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * (((s *= 1.525) + 1) * t - s)
    }
    return 1 / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2)
  }, easeInBounce:function(t) {
    return 1 - animationOptions.easeOutBounce(1 - t)
  }, easeOutBounce:function(t) {
    if((t /= 1) < 1 / 2.75) {
      return 1 * 7.5625 * t * t
    }else {
      if(t < 2 / 2.75) {
        return 1 * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75)
      }else {
        if(t < 2.5 / 2.75) {
          return 1 * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375)
        }else {
          return 1 * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375)
        }
      }
    }
  }, easeInOutBounce:function(t) {
    if(t < 1 / 2) {
      return animationOptions.easeInBounce(t * 2) * 0.5
    }
    return animationOptions.easeOutBounce(t * 2 - 1) * 0.5 + 1 * 0.5
  }};
  var width = context.canvas.width;
  var height = context.canvas.height;
  if(window.devicePixelRatio) {
    context.canvas.style.width = width + "px";
    context.canvas.style.height = height + "px";
    context.canvas.height = height * window.devicePixelRatio;
    context.canvas.width = width * window.devicePixelRatio;
    context.scale(window.devicePixelRatio, window.devicePixelRatio)
  }
  this.PolarArea = function(data, options) {
    chart.PolarArea.defaults = {scaleOverlay:true, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleShowLine:true, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowLabelBackdrop:true, scaleBackdropColor:"rgba(255,255,255,0.75)", scaleBackdropPaddingY:2, scaleBackdropPaddingX:2, segmentShowStroke:true, segmentStrokeColor:"#fff", 
    segmentStrokeWidth:2, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null};
    var config = options ? mergeChartConfig(chart.PolarArea.defaults, options) : chart.PolarArea.defaults;
    return new PolarArea(data, config, context)
  };
  this.Radar = function(data, options) {
    chart.Radar.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleShowLine:true, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:false, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowLabelBackdrop:true, scaleBackdropColor:"rgba(255,255,255,0.75)", scaleBackdropPaddingY:2, scaleBackdropPaddingX:2, angleShowLineOut:true, angleLineColor:"rgba(0,0,0,.1)", 
    angleLineWidth:1, pointLabelFontFamily:"'Arial'", pointLabelFontStyle:"normal", pointLabelFontSize:12, pointLabelFontColor:"#666", pointDot:true, pointDotRadius:3, pointDotStrokeWidth:1, datasetStroke:true, datasetStrokeWidth:2, datasetFill:true, animation:true, animationSteps:60, animationEasing:"easeOutQuart", onAnimationComplete:null};
    var config = options ? mergeChartConfig(chart.Radar.defaults, options) : chart.Radar.defaults;
    return new Radar(data, config, context)
  };
  this.Pie = function(data, options) {
    chart.Pie.defaults = {segmentShowStroke:true, segmentStrokeColor:"#fff", segmentStrokeWidth:2, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null};
    var config = options ? mergeChartConfig(chart.Pie.defaults, options) : chart.Pie.defaults;
    return new Pie(data, config, context)
  };
  this.Doughnut = function(data, options) {
    chart.Doughnut.defaults = {segmentShowStroke:true, segmentStrokeColor:"#fff", segmentStrokeWidth:2, percentageInnerCutout:50, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null};
    var config = options ? mergeChartConfig(chart.Doughnut.defaults, options) : chart.Doughnut.defaults;
    return new Doughnut(data, config, context)
  };
  this.Line = function(data, options) {
    chart.Line.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowGridLines:true, scaleGridLineColor:"rgba(0,0,0,.05)", scaleGridLineWidth:1, bezierCurve:true, pointDot:true, pointDotRadius:4, pointDotStrokeWidth:2, datasetStroke:true, datasetStrokeWidth:2, 
    datasetFill:true, animation:true, animationSteps:60, animationEasing:"easeOutQuart", onAnimationComplete:null};
    var config = options ? mergeChartConfig(chart.Line.defaults, options) : chart.Line.defaults;
    return new Line(data, config, context)
  };
  this.Bar = function(data, options) {
    chart.Bar.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowGridLines:true, scaleGridLineColor:"rgba(0,0,0,.05)", scaleGridLineWidth:1, barShowStroke:true, barStrokeWidth:2, barValueSpacing:5, barDatasetSpacing:1, animation:true, animationSteps:60, 
    animationEasing:"easeOutQuart", onAnimationComplete:null};
    var config = options ? mergeChartConfig(chart.Bar.defaults, options) : chart.Bar.defaults;
    return new Bar(data, config, context)
  };
  var clear = function(c) {
    c.clearRect(0, 0, width, height)
  };
  var PolarArea = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : null;
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = maxSize / calculatedScale.steps;
    animationLoop(config, drawScale, drawAllSegments, ctx);
    function calculateDrawingSizes() {
      maxSize = Min([width, height]) / 2;
      maxSize -= Max([config.scaleFontSize * 0.5, config.scaleLineWidth * 0.5]);
      labelHeight = config.scaleFontSize * 2;
      if(config.scaleShowLabelBackdrop) {
        labelHeight += 2 * config.scaleBackdropPaddingY;
        maxSize -= config.scaleBackdropPaddingY * 1.5
      }
      scaleHeight = maxSize;
      labelHeight = Default(labelHeight, 5)
    }
    function drawScale() {
      for(var i = 0;i < calculatedScale.steps;i++) {
        if(config.scaleShowLine) {
          ctx.beginPath();
          ctx.arc(width / 2, height / 2, scaleHop * (i + 1), 0, Math.PI * 2, true);
          ctx.strokeStyle = config.scaleLineColor;
          ctx.lineWidth = config.scaleLineWidth;
          ctx.stroke()
        }
        if(config.scaleShowLabels) {
          ctx.textAlign = "center";
          ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
          var label = calculatedScale.labels[i];
          if(config.scaleShowLabelBackdrop) {
            var textWidth = ctx.measureText(label).width;
            ctx.fillStyle = config.scaleBackdropColor;
            ctx.beginPath();
            ctx.rect(Math.round(width / 2 - textWidth / 2 - config.scaleBackdropPaddingX), Math.round(height / 2 - scaleHop * (i + 1) - config.scaleFontSize * 0.5 - config.scaleBackdropPaddingY), Math.round(textWidth + config.scaleBackdropPaddingX * 2), Math.round(config.scaleFontSize + config.scaleBackdropPaddingY * 2));
            ctx.fill()
          }
          ctx.textBaseline = "middle";
          ctx.fillStyle = config.scaleFontColor;
          ctx.fillText(label, width / 2, height / 2 - scaleHop * (i + 1))
        }
      }
    }
    function drawAllSegments(animationDecimal) {
      var startAngle = -Math.PI / 2, angleStep = Math.PI * 2 / data.length, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * calculateOffset(data[i].value, calculatedScale, scaleHop), startAngle, startAngle + rotateAnimation * angleStep, false);
        ctx.lineTo(width / 2, height / 2);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(config.segmentShowStroke) {
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.stroke()
        }
        startAngle += rotateAnimation * angleStep
      }
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.length;i++) {
        if(data[i].value > upperValue) {
          upperValue = data[i].value
        }
        if(data[i].value < lowerValue) {
          lowerValue = data[i].value
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Radar = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString;
    if(!data.labels) {
      data.labels = []
    }
    calculateDrawingSizes();
    var valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : null;
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = maxSize / calculatedScale.steps;
    animationLoop(config, drawScale, drawAllDataPoints, ctx);
    function drawAllDataPoints(animationDecimal) {
      var rotationDegree = 2 * Math.PI / data.datasets[0].data.length;
      ctx.save();
      ctx.translate(width / 2, height / 2);
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.beginPath();
        ctx.moveTo(0, animationDecimal * -1 * calculateOffset(data.datasets[i].data[0], calculatedScale, scaleHop));
        for(var j = 1;j < data.datasets[i].data.length;j++) {
          ctx.rotate(rotationDegree);
          ctx.lineTo(0, animationDecimal * -1 * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop))
        }
        ctx.closePath();
        ctx.fillStyle = data.datasets[i].fillColor;
        ctx.strokeStyle = data.datasets[i].strokeColor;
        ctx.lineWidth = config.datasetStrokeWidth;
        ctx.fill();
        ctx.stroke();
        if(config.pointDot) {
          ctx.fillStyle = data.datasets[i].pointColor;
          ctx.strokeStyle = data.datasets[i].pointStrokeColor;
          ctx.lineWidth = config.pointDotStrokeWidth;
          for(var k = 0;k < data.datasets[i].data.length;k++) {
            ctx.rotate(rotationDegree);
            ctx.beginPath();
            ctx.arc(0, animationDecimal * -1 * calculateOffset(data.datasets[i].data[k], calculatedScale, scaleHop), config.pointDotRadius, 2 * Math.PI, false);
            ctx.fill();
            ctx.stroke()
          }
        }
        ctx.rotate(rotationDegree)
      }
      ctx.restore()
    }
    function drawScale() {
      var rotationDegree = 2 * Math.PI / data.datasets[0].data.length;
      ctx.save();
      ctx.translate(width / 2, height / 2);
      if(config.angleShowLineOut) {
        ctx.strokeStyle = config.angleLineColor;
        ctx.lineWidth = config.angleLineWidth;
        for(var h = 0;h < data.datasets[0].data.length;h++) {
          ctx.rotate(rotationDegree);
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, -maxSize);
          ctx.stroke()
        }
      }
      for(var i = 0;i < calculatedScale.steps;i++) {
        ctx.beginPath();
        if(config.scaleShowLine) {
          ctx.strokeStyle = config.scaleLineColor;
          ctx.lineWidth = config.scaleLineWidth;
          ctx.moveTo(0, -scaleHop * (i + 1));
          for(var j = 0;j < data.datasets[0].data.length;j++) {
            ctx.rotate(rotationDegree);
            ctx.lineTo(0, -scaleHop * (i + 1))
          }
          ctx.closePath();
          ctx.stroke()
        }
        if(config.scaleShowLabels) {
          ctx.textAlign = "center";
          ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
          ctx.textBaseline = "middle";
          if(config.scaleShowLabelBackdrop) {
            var textWidth = ctx.measureText(calculatedScale.labels[i]).width;
            ctx.fillStyle = config.scaleBackdropColor;
            ctx.beginPath();
            ctx.rect(Math.round(-textWidth / 2 - config.scaleBackdropPaddingX), Math.round(-scaleHop * (i + 1) - config.scaleFontSize * 0.5 - config.scaleBackdropPaddingY), Math.round(textWidth + config.scaleBackdropPaddingX * 2), Math.round(config.scaleFontSize + config.scaleBackdropPaddingY * 2));
            ctx.fill()
          }
          ctx.fillStyle = config.scaleFontColor;
          ctx.fillText(calculatedScale.labels[i], 0, -scaleHop * (i + 1))
        }
      }
      for(var k = 0;k < data.labels.length;k++) {
        ctx.font = config.pointLabelFontStyle + " " + config.pointLabelFontSize + "px " + config.pointLabelFontFamily;
        ctx.fillStyle = config.pointLabelFontColor;
        var opposite = Math.sin(rotationDegree * k) * (maxSize + config.pointLabelFontSize);
        var adjacent = Math.cos(rotationDegree * k) * (maxSize + config.pointLabelFontSize);
        if(rotationDegree * k == Math.PI || rotationDegree * k == 0) {
          ctx.textAlign = "center"
        }else {
          if(rotationDegree * k > Math.PI) {
            ctx.textAlign = "right"
          }else {
            ctx.textAlign = "left"
          }
        }
        ctx.textBaseline = "middle";
        ctx.fillText(data.labels[k], opposite, -adjacent)
      }
      ctx.restore()
    }
    function calculateDrawingSizes() {
      maxSize = Min([width, height]) / 2;
      labelHeight = config.scaleFontSize * 2;
      var labelLength = 0;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.font = config.pointLabelFontStyle + " " + config.pointLabelFontSize + "px " + config.pointLabelFontFamily;
        var textMeasurement = ctx.measureText(data.labels[i]).width;
        if(textMeasurement > labelLength) {
          labelLength = textMeasurement
        }
      }
      maxSize -= Max([labelLength, config.pointLabelFontSize / 2 * 1.5]);
      maxSize -= config.pointLabelFontSize;
      maxSize = CapValue(maxSize, null, 0);
      scaleHeight = maxSize;
      labelHeight = Default(labelHeight, 5)
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Pie = function(data, config, ctx) {
    var segmentTotal = 0;
    var pieRadius = Min([height / 2, width / 2]) - 5;
    for(var i = 0;i < data.length;i++) {
      segmentTotal += data[i].value
    }
    animationLoop(config, null, drawPieSegments, ctx);
    function drawPieSegments(animationDecimal) {
      var cumulativeAngle = -Math.PI / 2, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        var segmentAngle = rotateAnimation * data[i].value / segmentTotal * Math.PI * 2;
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * pieRadius, cumulativeAngle, cumulativeAngle + segmentAngle);
        ctx.lineTo(width / 2, height / 2);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(config.segmentShowStroke) {
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.stroke()
        }
        cumulativeAngle += segmentAngle
      }
    }
  };
  var Doughnut = function(data, config, ctx) {
    var segmentTotal = 0;
    var doughnutRadius = Min([height / 2, width / 2]) - 5;
    var cutoutRadius = doughnutRadius * (config.percentageInnerCutout / 100);
    for(var i = 0;i < data.length;i++) {
      segmentTotal += data[i].value
    }
    animationLoop(config, null, drawPieSegments, ctx);
    function drawPieSegments(animationDecimal) {
      var cumulativeAngle = -Math.PI / 2, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        var segmentAngle = rotateAnimation * data[i].value / segmentTotal * Math.PI * 2;
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * doughnutRadius, cumulativeAngle, cumulativeAngle + segmentAngle, false);
        ctx.arc(width / 2, height / 2, scaleAnimation * cutoutRadius, cumulativeAngle + segmentAngle, cumulativeAngle, true);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(config.segmentShowStroke) {
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.stroke()
        }
        cumulativeAngle += segmentAngle
      }
    }
  };
  var Line = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString, valueHop, widestXLabel, xAxisLength, yAxisPosX, xAxisPosY, rotateLabels = 0;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : "";
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = Math.floor(scaleHeight / calculatedScale.steps);
    calculateXAxisSize();
    animationLoop(config, drawScale, drawLines, ctx);
    function drawLines(animPc) {
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.strokeStyle = data.datasets[i].strokeColor;
        ctx.lineWidth = config.datasetStrokeWidth;
        ctx.beginPath();
        ctx.moveTo(yAxisPosX, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[0], calculatedScale, scaleHop));
        for(var j = 1;j < data.datasets[i].data.length;j++) {
          if(config.bezierCurve) {
            ctx.bezierCurveTo(xPos(j - 0.5), yPos(i, j - 1), xPos(j - 0.5), yPos(i, j), xPos(j), yPos(i, j))
          }else {
            ctx.lineTo(xPos(j), yPos(i, j))
          }
        }
        ctx.stroke();
        if(config.datasetFill) {
          ctx.lineTo(yAxisPosX + valueHop * (data.datasets[i].data.length - 1), xAxisPosY);
          ctx.lineTo(yAxisPosX, xAxisPosY);
          ctx.closePath();
          ctx.fillStyle = data.datasets[i].fillColor;
          ctx.fill()
        }else {
          ctx.closePath()
        }
        if(config.pointDot) {
          ctx.fillStyle = data.datasets[i].pointColor;
          ctx.strokeStyle = data.datasets[i].pointStrokeColor;
          ctx.lineWidth = config.pointDotStrokeWidth;
          for(var k = 0;k < data.datasets[i].data.length;k++) {
            ctx.beginPath();
            ctx.arc(yAxisPosX + valueHop * k, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[k], calculatedScale, scaleHop), config.pointDotRadius, 0, Math.PI * 2, true);
            ctx.fill();
            ctx.stroke()
          }
        }
      }
      function yPos(dataSet, iteration) {
        return xAxisPosY - animPc * calculateOffset(data.datasets[dataSet].data[iteration], calculatedScale, scaleHop)
      }
      function xPos(iteration) {
        return yAxisPosX + valueHop * iteration
      }
    }
    function drawScale() {
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(width - widestXLabel / 2 + 5, xAxisPosY);
      ctx.lineTo(width - widestXLabel / 2 - xAxisLength - 5, xAxisPosY);
      ctx.stroke();
      if(rotateLabels > 0) {
        ctx.save();
        ctx.textAlign = "right"
      }else {
        ctx.textAlign = "center"
      }
      ctx.fillStyle = config.scaleFontColor;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.save();
        if(rotateLabels > 0) {
          ctx.translate(yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize);
          ctx.rotate(-(rotateLabels * (Math.PI / 180)));
          ctx.fillText(data.labels[i], 0, 0);
          ctx.restore()
        }else {
          ctx.fillText(data.labels[i], yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize + 3)
        }
        ctx.beginPath();
        ctx.moveTo(yAxisPosX + i * valueHop, xAxisPosY + 3);
        if(config.scaleShowGridLines && i > 0) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + i * valueHop, 5)
        }else {
          ctx.lineTo(yAxisPosX + i * valueHop, xAxisPosY + 3)
        }
        ctx.stroke()
      }
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(yAxisPosX, xAxisPosY + 5);
      ctx.lineTo(yAxisPosX, 5);
      ctx.stroke();
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(var j = 0;j < calculatedScale.steps;j++) {
        ctx.beginPath();
        ctx.moveTo(yAxisPosX - 3, xAxisPosY - (j + 1) * scaleHop);
        if(config.scaleShowGridLines) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + xAxisLength + 5, xAxisPosY - (j + 1) * scaleHop)
        }else {
          ctx.lineTo(yAxisPosX - 0.5, xAxisPosY - (j + 1) * scaleHop)
        }
        ctx.stroke();
        if(config.scaleShowLabels) {
          ctx.fillText(calculatedScale.labels[j], yAxisPosX - 8, xAxisPosY - (j + 1) * scaleHop)
        }
      }
    }
    function calculateXAxisSize() {
      var longestText = 1;
      if(config.scaleShowLabels) {
        ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
        for(var i = 0;i < calculatedScale.labels.length;i++) {
          var measuredText = ctx.measureText(calculatedScale.labels[i]).width;
          longestText = measuredText > longestText ? measuredText : longestText
        }
        longestText += 10
      }
      xAxisLength = width - longestText - widestXLabel;
      valueHop = Math.floor(xAxisLength / (data.labels.length - 1));
      yAxisPosX = width - widestXLabel / 2 - xAxisLength;
      xAxisPosY = scaleHeight + config.scaleFontSize / 2
    }
    function calculateDrawingSizes() {
      maxSize = height;
      ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
      widestXLabel = 1;
      for(var i = 0;i < data.labels.length;i++) {
        var textLength = ctx.measureText(data.labels[i]).width;
        widestXLabel = textLength > widestXLabel ? textLength : widestXLabel
      }
      if(width / data.labels.length < widestXLabel) {
        rotateLabels = 45;
        if(width / data.labels.length < Math.cos(rotateLabels) * widestXLabel) {
          rotateLabels = 90;
          maxSize -= widestXLabel
        }else {
          maxSize -= Math.sin(rotateLabels) * widestXLabel
        }
      }else {
        maxSize -= config.scaleFontSize
      }
      maxSize -= 5;
      labelHeight = config.scaleFontSize;
      maxSize -= labelHeight;
      scaleHeight = maxSize
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Bar = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString, valueHop, widestXLabel, xAxisLength, yAxisPosX, xAxisPosY, barWidth, rotateLabels = 0;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : "";
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = Math.floor(scaleHeight / calculatedScale.steps);
    calculateXAxisSize();
    animationLoop(config, drawScale, drawBars, ctx);
    function drawBars(animPc) {
      ctx.lineWidth = config.barStrokeWidth;
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.fillStyle = data.datasets[i].fillColor;
        ctx.strokeStyle = data.datasets[i].strokeColor;
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          var barOffset = yAxisPosX + config.barValueSpacing + valueHop * j + barWidth * i + config.barDatasetSpacing * i + config.barStrokeWidth * i;
          ctx.beginPath();
          ctx.moveTo(barOffset, xAxisPosY);
          ctx.lineTo(barOffset, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop) + config.barStrokeWidth / 2);
          ctx.lineTo(barOffset + barWidth, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop) + config.barStrokeWidth / 2);
          ctx.lineTo(barOffset + barWidth, xAxisPosY);
          if(config.barShowStroke) {
            ctx.stroke()
          }
          ctx.closePath();
          ctx.fill()
        }
      }
    }
    function drawScale() {
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(width - widestXLabel / 2 + 5, xAxisPosY);
      ctx.lineTo(width - widestXLabel / 2 - xAxisLength - 5, xAxisPosY);
      ctx.stroke();
      if(rotateLabels > 0) {
        ctx.save();
        ctx.textAlign = "right"
      }else {
        ctx.textAlign = "center"
      }
      ctx.fillStyle = config.scaleFontColor;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.save();
        if(rotateLabels > 0) {
          ctx.translate(yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize);
          ctx.rotate(-(rotateLabels * (Math.PI / 180)));
          ctx.fillText(data.labels[i], 0, 0);
          ctx.restore()
        }else {
          ctx.fillText(data.labels[i], yAxisPosX + i * valueHop + valueHop / 2, xAxisPosY + config.scaleFontSize + 3)
        }
        ctx.beginPath();
        ctx.moveTo(yAxisPosX + (i + 1) * valueHop, xAxisPosY + 3);
        ctx.lineWidth = config.scaleGridLineWidth;
        ctx.strokeStyle = config.scaleGridLineColor;
        ctx.lineTo(yAxisPosX + (i + 1) * valueHop, 5);
        ctx.stroke()
      }
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(yAxisPosX, xAxisPosY + 5);
      ctx.lineTo(yAxisPosX, 5);
      ctx.stroke();
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(var j = 0;j < calculatedScale.steps;j++) {
        ctx.beginPath();
        ctx.moveTo(yAxisPosX - 3, xAxisPosY - (j + 1) * scaleHop);
        if(config.scaleShowGridLines) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + xAxisLength + 5, xAxisPosY - (j + 1) * scaleHop)
        }else {
          ctx.lineTo(yAxisPosX - 0.5, xAxisPosY - (j + 1) * scaleHop)
        }
        ctx.stroke();
        if(config.scaleShowLabels) {
          ctx.fillText(calculatedScale.labels[j], yAxisPosX - 8, xAxisPosY - (j + 1) * scaleHop)
        }
      }
    }
    function calculateXAxisSize() {
      var longestText = 1;
      if(config.scaleShowLabels) {
        ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
        for(var i = 0;i < calculatedScale.labels.length;i++) {
          var measuredText = ctx.measureText(calculatedScale.labels[i]).width;
          longestText = measuredText > longestText ? measuredText : longestText
        }
        longestText += 10
      }
      xAxisLength = width - longestText - widestXLabel;
      valueHop = Math.floor(xAxisLength / data.labels.length);
      barWidth = (valueHop - config.scaleGridLineWidth * 2 - config.barValueSpacing * 2 - (config.barDatasetSpacing * data.datasets.length - 1) - (config.barStrokeWidth / 2 * data.datasets.length - 1)) / data.datasets.length;
      yAxisPosX = width - widestXLabel / 2 - xAxisLength;
      xAxisPosY = scaleHeight + config.scaleFontSize / 2
    }
    function calculateDrawingSizes() {
      maxSize = height;
      ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
      widestXLabel = 1;
      for(var i = 0;i < data.labels.length;i++) {
        var textLength = ctx.measureText(data.labels[i]).width;
        widestXLabel = textLength > widestXLabel ? textLength : widestXLabel
      }
      if(width / data.labels.length < widestXLabel) {
        rotateLabels = 45;
        if(width / data.labels.length < Math.cos(rotateLabels) * widestXLabel) {
          rotateLabels = 90;
          maxSize -= widestXLabel
        }else {
          maxSize -= Math.sin(rotateLabels) * widestXLabel
        }
      }else {
        maxSize -= config.scaleFontSize
      }
      maxSize -= 5;
      labelHeight = config.scaleFontSize;
      maxSize -= labelHeight;
      scaleHeight = maxSize
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  function calculateOffset(val, calculatedScale, scaleHop) {
    var outerValue = calculatedScale.steps * calculatedScale.stepValue;
    var adjustedValue = val - calculatedScale.graphMin;
    var scalingFactor = CapValue(adjustedValue / outerValue, 1, 0);
    return scaleHop * calculatedScale.steps * scalingFactor
  }
  function animationLoop(config, drawScale, drawData, ctx) {
    var animFrameAmount = config.animation ? 1 / CapValue(config.animationSteps, Number.MAX_VALUE, 1) : 1, easingFunction = animationOptions[config.animationEasing], percentAnimComplete = config.animation ? 0 : 1;
    if(typeof drawScale !== "function") {
      drawScale = function() {
      }
    }
    requestAnimFrame(animLoop);
    function animateFrame() {
      var easeAdjustedAnimationPercent = config.animation ? CapValue(easingFunction(percentAnimComplete), null, 0) : 1;
      clear(ctx);
      if(config.scaleOverlay) {
        drawData(easeAdjustedAnimationPercent);
        drawScale()
      }else {
        drawScale();
        drawData(easeAdjustedAnimationPercent)
      }
    }
    function animLoop() {
      percentAnimComplete += animFrameAmount;
      animateFrame();
      if(percentAnimComplete <= 1) {
        requestAnimFrame(animLoop)
      }else {
        if(typeof config.onAnimationComplete == "function") {
          config.onAnimationComplete()
        }
      }
    }
  }
  var requestAnimFrame = function() {
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(callback) {
      window.setTimeout(callback, 1E3 / 60)
    }
  }();
  function calculateScale(drawingHeight, maxSteps, minSteps, maxValue, minValue, labelTemplateString) {
    var graphMin, graphMax, graphRange, stepValue, numberOfSteps, valueRange, rangeOrderOfMagnitude, decimalNum;
    valueRange = maxValue - minValue;
    rangeOrderOfMagnitude = calculateOrderOfMagnitude(valueRange);
    graphMin = Math.floor(minValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude);
    graphMax = Math.ceil(maxValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude);
    graphRange = graphMax - graphMin;
    stepValue = Math.pow(10, rangeOrderOfMagnitude);
    numberOfSteps = Math.round(graphRange / stepValue);
    while(numberOfSteps < minSteps || numberOfSteps > maxSteps) {
      if(numberOfSteps < minSteps) {
        stepValue /= 2;
        numberOfSteps = Math.round(graphRange / stepValue)
      }else {
        stepValue *= 2;
        numberOfSteps = Math.round(graphRange / stepValue)
      }
    }
    var labels = [];
    populateLabels(labelTemplateString, labels, numberOfSteps, graphMin, stepValue);
    return{steps:numberOfSteps, stepValue:stepValue, graphMin:graphMin, labels:labels};
    function calculateOrderOfMagnitude(val) {
      return Math.floor(Math.log(val) / Math.LN10)
    }
  }
  function populateLabels(labelTemplateString, labels, numberOfSteps, graphMin, stepValue) {
    if(labelTemplateString) {
      for(var i = 1;i < numberOfSteps + 1;i++) {
        labels.push(tmpl(labelTemplateString, {value:(graphMin + stepValue * i).toFixed(getDecimalPlaces(stepValue))}))
      }
    }
  }
  function Max(array) {
    return Math.max.apply(Math, array)
  }
  function Min(array) {
    return Math.min.apply(Math, array)
  }
  function Default(userDeclared, valueIfFalse) {
    if(!userDeclared) {
      return valueIfFalse
    }else {
      return userDeclared
    }
  }
  function isNumber(n) {
    return!isNaN(parseFloat(n)) && isFinite(n)
  }
  function CapValue(valueToCap, maxValue, minValue) {
    if(isNumber(maxValue)) {
      if(valueToCap > maxValue) {
        return maxValue
      }
    }
    if(isNumber(minValue)) {
      if(valueToCap < minValue) {
        return minValue
      }
    }
    return valueToCap
  }
  function getDecimalPlaces(num) {
    var numberOfDecimalPlaces;
    if(num % 1 != 0) {
      return num.toString().split(".")[1].length
    }else {
      return 0
    }
  }
  function mergeChartConfig(defaults, userDefined) {
    var returnObj = {};
    for(var attrname in defaults) {
      returnObj[attrname] = defaults[attrname]
    }
    for(var attrname in userDefined) {
      returnObj[attrname] = userDefined[attrname]
    }
    return returnObj
  }
  var cache = {};
  function tmpl(str, data) {
    var fn = !/\W/.test(str) ? cache[str] = cache[str] || tmpl(document.getElementById(str).innerHTML) : new Function("obj", "var p=[],print=function(){p.push.apply(p,arguments);};" + "with(obj){p.push('" + str.replace(/[\r\t\n]/g, " ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g, "$1\r").replace(/\t=(.*?)%>/g, "',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'") + "');}return p.join('');");
    return data ? fn(data) : fn
  }
};
window.Chart = function(context, options) {
  var chart = this;
  var animationOptions = {linear:function(t) {
    return t
  }, easeInQuad:function(t) {
    return t * t
  }, easeOutQuad:function(t) {
    return-1 * t * (t - 2)
  }, easeInOutQuad:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t
    }
    return-1 / 2 * (--t * (t - 2) - 1)
  }, easeInCubic:function(t) {
    return t * t * t
  }, easeOutCubic:function(t) {
    return 1 * ((t = t / 1 - 1) * t * t + 1)
  }, easeInOutCubic:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t
    }
    return 1 / 2 * ((t -= 2) * t * t + 2)
  }, easeInQuart:function(t) {
    return t * t * t * t
  }, easeOutQuart:function(t) {
    return-1 * ((t = t / 1 - 1) * t * t * t - 1)
  }, easeInOutQuart:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t * t
    }
    return-1 / 2 * ((t -= 2) * t * t * t - 2)
  }, easeInQuint:function(t) {
    return 1 * (t /= 1) * t * t * t * t
  }, easeOutQuint:function(t) {
    return 1 * ((t = t / 1 - 1) * t * t * t * t + 1)
  }, easeInOutQuint:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t * t * t
    }
    return 1 / 2 * ((t -= 2) * t * t * t * t + 2)
  }, easeInSine:function(t) {
    return-1 * Math.cos(t / 1 * (Math.PI / 2)) + 1
  }, easeOutSine:function(t) {
    return 1 * Math.sin(t / 1 * (Math.PI / 2))
  }, easeInOutSine:function(t) {
    return-1 / 2 * (Math.cos(Math.PI * t / 1) - 1)
  }, easeInExpo:function(t) {
    return t == 0 ? 1 : 1 * Math.pow(2, 10 * (t / 1 - 1))
  }, easeOutExpo:function(t) {
    return t == 1 ? 1 : 1 * (-Math.pow(2, -10 * t / 1) + 1)
  }, easeInOutExpo:function(t) {
    if(t == 0) {
      return 0
    }
    if(t == 1) {
      return 1
    }
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * Math.pow(2, 10 * (t - 1))
    }
    return 1 / 2 * (-Math.pow(2, -10 * --t) + 2)
  }, easeInCirc:function(t) {
    if(t >= 1) {
      return t
    }
    return-1 * (Math.sqrt(1 - (t /= 1) * t) - 1)
  }, easeOutCirc:function(t) {
    return 1 * Math.sqrt(1 - (t = t / 1 - 1) * t)
  }, easeInOutCirc:function(t) {
    if((t /= 1 / 2) < 1) {
      return-1 / 2 * (Math.sqrt(1 - t * t) - 1)
    }
    return 1 / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1)
  }, easeInElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1) == 1) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    return-(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * 2 * Math.PI / p))
  }, easeOutElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1) == 1) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    return a * Math.pow(2, -10 * t) * Math.sin((t * 1 - s) * 2 * Math.PI / p) + 1
  }, easeInOutElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1 / 2) == 2) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3 * 1.5
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    if(t < 1) {
      return-0.5 * a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * 2 * Math.PI / p)
    }
    return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * 1 - s) * 2 * Math.PI / p) * 0.5 + 1
  }, easeInBack:function(t) {
    var s = 1.70158;
    return 1 * (t /= 1) * t * ((s + 1) * t - s)
  }, easeOutBack:function(t) {
    var s = 1.70158;
    return 1 * ((t = t / 1 - 1) * t * ((s + 1) * t + s) + 1)
  }, easeInOutBack:function(t) {
    var s = 1.70158;
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * (((s *= 1.525) + 1) * t - s)
    }
    return 1 / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2)
  }, easeInBounce:function(t) {
    return 1 - animationOptions.easeOutBounce(1 - t)
  }, easeOutBounce:function(t) {
    if((t /= 1) < 1 / 2.75) {
      return 1 * 7.5625 * t * t
    }else {
      if(t < 2 / 2.75) {
        return 1 * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75)
      }else {
        if(t < 2.5 / 2.75) {
          return 1 * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375)
        }else {
          return 1 * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375)
        }
      }
    }
  }, easeInOutBounce:function(t) {
    if(t < 1 / 2) {
      return animationOptions.easeInBounce(t * 2) * 0.5
    }
    return animationOptions.easeOutBounce(t * 2 - 1) * 0.5 + 1 * 0.5
  }};
  this.tooltips = [], defaults = {tooltips:{background:"rgba(0,0,0,0.6)", fontFamily:"'Arial'", fontStyle:"normal", fontColor:"white", fontSize:"12px", labelTemplate:"<%=label%>: <%=value%>", padding:{top:10, right:10, bottom:10, left:10}, offset:{left:0, top:0}, border:{width:0, color:"#000"}, showHighlight:true, highlight:{stroke:{width:1, color:"rgba(230,230,230,0.25)"}, fill:"rgba(255,255,255,0.25)"}}}, options = options ? mergeChartConfig(defaults, options) : defaults;
  function registerTooltip(ctx, areaObj, data, type) {
    chart.tooltips.push(new Tooltip(ctx, areaObj, data, type))
  }
  var Tooltip = function(ctx, areaObj, data, type) {
    this.ctx = ctx;
    this.areaObj = areaObj;
    this.data = data;
    this.savedState = null;
    this.highlightState = null;
    this.x = null;
    this.y = null;
    this.inRange = function(x, y) {
      if(this.areaObj.type) {
        switch(this.areaObj.type) {
          case "rect":
            return x >= this.areaObj.x && x <= this.areaObj.x + this.areaObj.width && y >= this.areaObj.y && y <= this.areaObj.y + this.areaObj.height;
            break;
          case "circle":
            return Math.pow(x - this.areaObj.x, 2) + Math.pow(y - this.areaObj.y, 2) < Math.pow(this.areaObj.r, 2);
            break;
          case "shape":
            var poly = this.areaObj.points;
            for(var c = false, i = -1, l = poly.length, j = l - 1;++i < l;j = i) {
              (poly[i].y <= y && y < poly[j].y || poly[j].y <= y && y < poly[i].y) && x < (poly[j].x - poly[i].x) * (y - poly[i].y) / (poly[j].y - poly[i].y) + poly[i].x && (c = !c)
            }
            return c;
            break
        }
      }
    };
    this.render = function(x, y) {
      if(this.savedState == null) {
        this.ctx.putImageData(chart.savedState, 0, 0);
        this.savedState = this.ctx.getImageData(0, 0, this.ctx.canvas.width, this.ctx.canvas.height)
      }
      this.ctx.putImageData(this.savedState, 0, 0);
      if(options.tooltips.showHighlight) {
        if(this.highlightState == null) {
          this.ctx.strokeStyle = options.tooltips.highlight.stroke.color;
          this.ctx.lineWidth = options.tooltips.highlight.stroke.width;
          this.ctx.fillStyle = options.tooltips.highlight.fill;
          switch(this.areaObj.type) {
            case "rect":
              this.ctx.strokeRect(this.areaObj.x, this.areaObj.y, this.areaObj.width, this.areaObj.height);
              this.ctx.fillStyle = options.tooltips.highlight.fill;
              this.ctx.fillRect(this.areaObj.x, this.areaObj.y, this.areaObj.width, this.areaObj.height);
              break;
            case "circle":
              this.ctx.beginPath();
              this.ctx.arc(this.areaObj.x, this.areaObj.y, this.areaObj.r, 0, 2 * Math.PI, false);
              this.ctx.stroke();
              this.ctx.fill();
              break;
            case "shape":
              this.ctx.beginPath();
              this.ctx.moveTo(this.areaObj.points[0].x, this.areaObj.points[0].y);
              for(var p in this.areaObj.points) {
                this.ctx.lineTo(this.areaObj.points[p].x, this.areaObj.points[p].y)
              }
              this.ctx.stroke();
              this.ctx.fill();
              break
          }
          this.highlightState = this.ctx.getImageData(0, 0, this.ctx.canvas.width, this.ctx.canvas.height)
        }else {
          this.ctx.putImageData(this.highlightState, 0, 0)
        }
      }
      var posX = x + options.tooltips.offset.left, posY = y + options.tooltips.offset.top, tpl = tmpl(options.tooltips.labelTemplate, this.data), rectWidth = options.tooltips.padding.left + this.ctx.measureText(tpl).width + options.tooltips.padding.right;
      if(posX + rectWidth > ctx.canvas.width) {
        posX -= posX - rectWidth < 0 ? posX : rectWidth
      }
      if(posY + 24 > ctx.canvas.height) {
        posY -= 24
      }
      this.ctx.fillStyle = options.tooltips.background;
      this.ctx.fillRect(posX, posY, rectWidth, 24);
      if(options.tooltips.border.width > 0) {
        this.ctx.fillStyle = options.tooltips.order.color;
        this.ctx.lineWidth = options.tooltips.border.width;
        this.ctx.strokeRect(posX, posY, rectWidth, 24)
      }
      this.ctx.font = options.tooltips.fontStyle + " " + options.tooltips.fontSize + " " + options.tooltips.fontFamily;
      this.ctx.fillStyle = options.tooltips.fontColor;
      this.ctx.textAlign = "center";
      this.ctx.textBaseline = "middle";
      this.ctx.fillText(tpl, posX + rectWidth / 2, posY + 12);
      this.x = x;
      this.y = y
    }
  };
  var width = context.canvas.width, height = context.canvas.height;
  this.savedState = null;
  function getPosition(e) {
    var xPosition = 0;
    var yPosition = 0;
    while(e) {
      xPosition += e.offsetLeft + e.clientLeft;
      yPosition += e.offsetTop + e.clientTop;
      e = e.offsetParent
    }
    if(window.pageXOffset > 0 || window.pageYOffset > 0) {
      xPosition -= window.pageXOffset;
      yPosition -= window.pageYOffset
    }else {
      if(document.body.scrollLeft > 0 || document.body.scrollTop > 0) {
        xPosition -= document.body.scrollLeft;
        yPosition -= document.body.scrollTop
      }
    }
    return{x:xPosition, y:yPosition}
  }
  function tooltipEventHandler(e) {
    if(chart.tooltips.length > 0) {
      chart.savedState = chart.savedState == null ? context.getImageData(0, 0, context.canvas.width, context.canvas.height) : chart.savedState;
      var rendered = 0;
      for(var i in chart.tooltips) {
        var position = getPosition(context.canvas), mx = e.clientX - position.x, my = e.clientY - position.y;
        if(chart.tooltips[i].inRange(mx, my)) {
          chart.tooltips[i].render(mx, my);
          rendered++
        }
      }
      if(rendered == 0) {
        context.putImageData(chart.savedState, 0, 0)
      }
    }
  }
  context.canvas.onmousemove = function(e) {
    tooltipEventHandler(e)
  };
  context.canvas.onmouseout = function(e) {
    if(chart.savedState != null) {
      context.putImageData(chart.savedState, 0, 0)
    }
  };
  if(window.devicePixelRatio) {
    context.canvas.style.width = width + "px";
    context.canvas.style.height = height + "px";
    context.canvas.height = height * window.devicePixelRatio;
    context.canvas.width = width * window.devicePixelRatio;
    context.scale(window.devicePixelRatio, window.devicePixelRatio)
  }
  this.PolarArea = function(data, options) {
    chart.PolarArea.defaults = {scaleOverlay:true, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleShowLine:true, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowLabelBackdrop:true, scaleBackdropColor:"rgba(255,255,255,0.75)", scaleBackdropPaddingY:2, scaleBackdropPaddingX:2, segmentShowStroke:true, segmentStrokeColor:"#fff", 
    segmentStrokeWidth:2, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.PolarArea.defaults, options) : chart.PolarArea.defaults;
    return new PolarArea(data, config, context)
  };
  this.Radar = function(data, options) {
    chart.Radar.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleShowLine:true, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:false, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowLabelBackdrop:true, scaleBackdropColor:"rgba(255,255,255,0.75)", scaleBackdropPaddingY:2, scaleBackdropPaddingX:2, angleShowLineOut:true, angleLineColor:"rgba(0,0,0,.1)", 
    angleLineWidth:1, pointLabelFontFamily:"'Arial'", pointLabelFontStyle:"normal", pointLabelFontSize:12, pointLabelFontColor:"#666", pointDot:true, pointDotRadius:3, pointDotStrokeWidth:1, datasetStroke:true, datasetStrokeWidth:2, datasetFill:true, animation:true, animationSteps:60, animationEasing:"easeOutQuart", onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Radar.defaults, options) : chart.Radar.defaults;
    return new Radar(data, config, context)
  };
  this.Pie = function(data, options) {
    chart.Pie.defaults = {segmentShowStroke:true, segmentStrokeColor:"#fff", segmentStrokeWidth:2, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null, labelFontFamily:"'Arial'", labelFontStyle:"normal", labelFontSize:12, labelFontColor:"#666", labelAlign:"right", showTooltips:true};
    var config = options ? mergeChartConfig(chart.Pie.defaults, options) : chart.Pie.defaults;
    return new Pie(data, config, context)
  };
  this.Doughnut = function(data, options) {
    chart.Doughnut.defaults = {segmentShowStroke:true, segmentStrokeColor:"#fff", segmentStrokeWidth:2, percentageInnerCutout:50, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Doughnut.defaults, options) : chart.Doughnut.defaults;
    return new Doughnut(data, config, context)
  };
  this.Line = function(data, options) {
    chart.Line.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowGridLines:true, scaleGridLineColor:"rgba(0,0,0,.05)", scaleGridLineWidth:1, bezierCurve:true, pointDot:true, pointDotRadius:4, pointDotStrokeWidth:2, datasetStroke:true, datasetStrokeWidth:2, 
    datasetFill:true, animation:true, animationSteps:60, animationEasing:"easeOutQuart", onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Line.defaults, options) : chart.Line.defaults;
    return new Line(data, config, context)
  };
  this.Bar = function(data, options) {
    chart.Bar.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowGridLines:true, scaleGridLineColor:"rgba(0,0,0,.05)", scaleGridLineWidth:1, barShowStroke:true, barStrokeWidth:2, barValueSpacing:5, barDatasetSpacing:1, animation:true, animationSteps:60, 
    animationEasing:"easeOutQuart", onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Bar.defaults, options) : chart.Bar.defaults;
    return new Bar(data, config, context)
  };
  var clear = function(c) {
    c.clearRect(0, 0, width, height)
  };
  var PolarArea = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : null;
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = maxSize / calculatedScale.steps;
    animationLoop(config, drawScale, drawAllSegments, ctx);
    function calculateDrawingSizes() {
      maxSize = Min([width, height]) / 2;
      maxSize -= Max([config.scaleFontSize * 0.5, config.scaleLineWidth * 0.5]);
      labelHeight = config.scaleFontSize * 2;
      if(config.scaleShowLabelBackdrop) {
        labelHeight += 2 * config.scaleBackdropPaddingY;
        maxSize -= config.scaleBackdropPaddingY * 1.5
      }
      scaleHeight = maxSize;
      labelHeight = Default(labelHeight, 5)
    }
    function drawScale() {
      for(var i = 0;i < calculatedScale.steps;i++) {
        if(config.scaleShowLine) {
          ctx.beginPath();
          ctx.arc(width / 2, height / 2, scaleHop * (i + 1), 0, Math.PI * 2, true);
          ctx.strokeStyle = config.scaleLineColor;
          ctx.lineWidth = config.scaleLineWidth;
          ctx.stroke()
        }
        if(config.scaleShowLabels) {
          ctx.textAlign = "center";
          ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
          var label = calculatedScale.labels[i];
          if(config.scaleShowLabelBackdrop) {
            var textWidth = ctx.measureText(label).width;
            ctx.fillStyle = config.scaleBackdropColor;
            ctx.beginPath();
            ctx.rect(Math.round(width / 2 - textWidth / 2 - config.scaleBackdropPaddingX), Math.round(height / 2 - scaleHop * (i + 1) - config.scaleFontSize * 0.5 - config.scaleBackdropPaddingY), Math.round(textWidth + config.scaleBackdropPaddingX * 2), Math.round(config.scaleFontSize + config.scaleBackdropPaddingY * 2));
            ctx.fill()
          }
          ctx.textBaseline = "middle";
          ctx.fillStyle = config.scaleFontColor;
          ctx.fillText(label, width / 2, height / 2 - scaleHop * (i + 1))
        }
      }
    }
    function drawAllSegments(animationDecimal) {
      var startAngle = -Math.PI / 2, angleStep = Math.PI * 2 / data.length, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * calculateOffset(data[i].value, calculatedScale, scaleHop), startAngle, startAngle + rotateAnimation * angleStep, false);
        ctx.lineTo(width / 2, height / 2);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(animationDecimal >= 1 && config.showTooltips) {
          var points = [{x:width / 2, y:height / 2}], pAmount = 50, radius = calculateOffset(data[i].value, calculatedScale, scaleHop);
          points.push({x:width / 2 + radius * Math.cos(startAngle), y:height / 2 + radius * Math.sin(startAngle)});
          for(var p = 0;p <= pAmount;p++) {
            points.push({x:width / 2 + radius * Math.cos(startAngle + p / pAmount * rotateAnimation * angleStep), y:height / 2 + radius * Math.sin(startAngle + p / pAmount * rotateAnimation * angleStep)})
          }
          registerTooltip(ctx, {type:"shape", points:points}, {label:data[i].tooltipLabel, value:data[i].tooltipLabel}, "PolarArea")
        }
        if(config.segmentShowStroke) {
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.stroke()
        }
        startAngle += rotateAnimation * angleStep
      }
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.length;i++) {
        if(data[i].value > upperValue) {
          upperValue = data[i].value
        }
        if(data[i].value < lowerValue) {
          lowerValue = data[i].value
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Radar = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString;
    if(!data.labels) {
      data.labels = []
    }
    calculateDrawingSizes();
    var valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : null;
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = maxSize / calculatedScale.steps;
    animationLoop(config, drawScale, drawAllDataPoints, ctx);
    function drawAllDataPoints(animationDecimal) {
      var rotationDegree = 2 * Math.PI / data.datasets[0].data.length;
      ctx.save();
      ctx.translate(width / 2, height / 2);
      for(var i = 0;i < data.datasets.length;i++) {
        var offset = calculateOffset(data.datasets[i].data[0], calculatedScale, scaleHop);
        ctx.beginPath();
        ctx.moveTo(0, animationDecimal * -1 * offset);
        if(animationDecimal >= 1 && config.showTooltips) {
          var curX = width / 2 + offset * Math.cos(0 - Math.PI / 2), curY = height / 2 + offset * Math.sin(0 - Math.PI / 2), pointRadius = config.pointDot ? config.pointDotRadius + config.pointDotStrokeWidth : 10, ttData = data.labels[0].trim() != "" ? data.labels[0] + ": " + data.datasets[i].data[0] : data.datasets[i].data[0];
          registerTooltip(ctx, {type:"circle", x:curX, y:curY, r:pointRadius}, {label:data.labels[0], value:data.datasets[i].data[0]}, "Radar")
        }
        for(var j = 1;j < data.datasets[i].data.length;j++) {
          offset = calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop);
          ctx.rotate(rotationDegree);
          ctx.lineTo(0, animationDecimal * -1 * offset);
          if(animationDecimal >= 1 && config.showTooltips) {
            var curX = width / 2 + offset * Math.cos(j * rotationDegree - Math.PI / 2), curY = height / 2 + offset * Math.sin(j * rotationDegree - Math.PI / 2), pointRadius = config.pointDot ? config.pointDotRadius + config.pointDotStrokeWidth : 10, ttData = data.labels[j].trim() != "" ? data.labels[j] + ": " + data.datasets[i].data[j] : data.datasets[i].data[j];
            registerTooltip(ctx, {type:"circle", x:curX, y:curY, r:pointRadius}, {label:data.labels[j], value:data.datasets[i].data[j]}, "Radar")
          }
        }
        ctx.closePath();
        ctx.fillStyle = data.datasets[i].fillColor;
        ctx.strokeStyle = data.datasets[i].strokeColor;
        ctx.lineWidth = config.datasetStrokeWidth;
        ctx.fill();
        ctx.stroke();
        if(config.pointDot) {
          ctx.fillStyle = data.datasets[i].pointColor;
          ctx.strokeStyle = data.datasets[i].pointStrokeColor;
          ctx.lineWidth = config.pointDotStrokeWidth;
          for(var k = 0;k < data.datasets[i].data.length;k++) {
            ctx.rotate(rotationDegree);
            ctx.beginPath();
            ctx.arc(0, animationDecimal * -1 * calculateOffset(data.datasets[i].data[k], calculatedScale, scaleHop), config.pointDotRadius, 2 * Math.PI, false);
            ctx.fill();
            ctx.stroke()
          }
        }
        ctx.rotate(rotationDegree)
      }
      ctx.restore()
    }
    function drawScale() {
      var rotationDegree = 2 * Math.PI / data.datasets[0].data.length;
      ctx.save();
      ctx.translate(width / 2, height / 2);
      if(config.angleShowLineOut) {
        ctx.strokeStyle = config.angleLineColor;
        ctx.lineWidth = config.angleLineWidth;
        for(var h = 0;h < data.datasets[0].data.length;h++) {
          ctx.rotate(rotationDegree);
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, -maxSize);
          ctx.stroke()
        }
      }
      for(var i = 0;i < calculatedScale.steps;i++) {
        ctx.beginPath();
        if(config.scaleShowLine) {
          ctx.strokeStyle = config.scaleLineColor;
          ctx.lineWidth = config.scaleLineWidth;
          ctx.moveTo(0, -scaleHop * (i + 1));
          for(var j = 0;j < data.datasets[0].data.length;j++) {
            ctx.rotate(rotationDegree);
            ctx.lineTo(0, -scaleHop * (i + 1))
          }
          ctx.closePath();
          ctx.stroke()
        }
        if(config.scaleShowLabels) {
          ctx.textAlign = "center";
          ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
          ctx.textBaseline = "middle";
          if(config.scaleShowLabelBackdrop) {
            var textWidth = ctx.measureText(calculatedScale.labels[i]).width;
            ctx.fillStyle = config.scaleBackdropColor;
            ctx.beginPath();
            ctx.rect(Math.round(-textWidth / 2 - config.scaleBackdropPaddingX), Math.round(-scaleHop * (i + 1) - config.scaleFontSize * 0.5 - config.scaleBackdropPaddingY), Math.round(textWidth + config.scaleBackdropPaddingX * 2), Math.round(config.scaleFontSize + config.scaleBackdropPaddingY * 2));
            ctx.fill()
          }
          ctx.fillStyle = config.scaleFontColor;
          ctx.fillText(calculatedScale.labels[i], 0, -scaleHop * (i + 1))
        }
      }
      for(var k = 0;k < data.labels.length;k++) {
        ctx.font = config.pointLabelFontStyle + " " + config.pointLabelFontSize + "px " + config.pointLabelFontFamily;
        ctx.fillStyle = config.pointLabelFontColor;
        var opposite = Math.sin(rotationDegree * k) * (maxSize + config.pointLabelFontSize);
        var adjacent = Math.cos(rotationDegree * k) * (maxSize + config.pointLabelFontSize);
        if(rotationDegree * k == Math.PI || rotationDegree * k == 0) {
          ctx.textAlign = "center"
        }else {
          if(rotationDegree * k > Math.PI) {
            ctx.textAlign = "right"
          }else {
            ctx.textAlign = "left"
          }
        }
        ctx.textBaseline = "middle";
        ctx.fillText(data.labels[k], opposite, -adjacent)
      }
      ctx.restore()
    }
    function calculateDrawingSizes() {
      maxSize = Min([width, height]) / 2;
      labelHeight = config.scaleFontSize * 2;
      var labelLength = 0;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.font = config.pointLabelFontStyle + " " + config.pointLabelFontSize + "px " + config.pointLabelFontFamily;
        var textMeasurement = ctx.measureText(data.labels[i]).width;
        if(textMeasurement > labelLength) {
          labelLength = textMeasurement
        }
      }
      maxSize -= Max([labelLength, config.pointLabelFontSize / 2 * 1.5]);
      maxSize -= config.pointLabelFontSize;
      maxSize = CapValue(maxSize, null, 0);
      scaleHeight = maxSize;
      labelHeight = Default(labelHeight, 5)
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Pie = function(data, config, ctx) {
    var segmentTotal = 0;
    var pieRadius = Min([height / 2, width / 2]) - 5;
    for(var i = 0;i < data.length;i++) {
      segmentTotal += data[i].value
    }
    ctx.fillStyle = "black";
    ctx.textBaseline = "base";
    animationLoop(config, null, drawPieSegments, ctx);
    function drawPieSegments(animationDecimal) {
      var cumulativeAngle = -Math.PI / 2, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        var segmentAngle = rotateAnimation * data[i].value / segmentTotal * Math.PI * 2;
        segmentAngle = Math.min(Math.PI * 1.99999, segmentAngle);
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * pieRadius, cumulativeAngle, cumulativeAngle + segmentAngle);
        ctx.lineTo(width / 2, height / 2);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(data[i].label && scaleAnimation * pieRadius * 2 * segmentAngle / (2 * Math.PI) > config.labelFontSize) {
          function getPieLabelX(align, r) {
            switch(align) {
              case "left":
                return-r + 20;
                break;
              case "center":
                return-r / 2;
                break
            }
            return-10
          }
          function reversePieLabelAlign(align) {
            switch(align) {
              case "left":
                return"right";
                break;
              case "right":
                return"left";
                break;
              case "center":
                return align;
                break
            }
          }
          var fontSize = data[i].labelFontSize || config.labelFontSize + "px";
          if(fontSize.match(/^[0-9]+$/g) != null) {
            fontSize = fontSize + "px"
          }
          ctx.font = config.labelFontStyle + " " + fontSize + " " + config.labelFontFamily;
          ctx.fillStyle = getFadeColor(animationDecimal, data[i].labelColor || "black", data[i].color);
          ctx.textBaseline = "middle";
          var textRotation = -(cumulativeAngle + segmentAngle) + segmentAngle / 2, tX = width / 2 + scaleAnimation * pieRadius * Math.cos(textRotation), tY = height / 2 - scaleAnimation * pieRadius * Math.sin(textRotation);
          ctx.textAlign = data[i].labelAlign || config.labelAlign;
          textX = getPieLabelX(ctx.textAlign, scaleAnimation * pieRadius);
          if(textRotation < -Math.PI / 2) {
            textRotation -= Math.PI;
            ctx.textAlign = reversePieLabelAlign(ctx.textAlign);
            textX = -textX
          }
          ctx.translate(tX, tY);
          ctx.rotate(-textRotation);
          ctx.fillText(data[i].label, textX, 0);
          ctx.rotate(textRotation);
          ctx.translate(-tX, -tY)
        }
        if(animationDecimal >= 1 && config.showTooltips) {
          var points = [{x:width / 2, y:height / 2}], pAmount = 50;
          points.push({x:width / 2 + pieRadius * Math.cos(cumulativeAngle), y:height / 2 + pieRadius * Math.sin(cumulativeAngle)});
          for(var p = 0;p <= pAmount;p++) {
            points.push({x:width / 2 + pieRadius * Math.cos(cumulativeAngle + p / pAmount * segmentAngle), y:height / 2 + pieRadius * Math.sin(cumulativeAngle + p / pAmount * segmentAngle)})
          }
          registerTooltip(ctx, {type:"shape", points:points}, {label:data[i].tooltipLabel, value:data[i].value}, "Pie")
        }
        if(config.segmentShowStroke) {
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.stroke()
        }
        cumulativeAngle += segmentAngle
      }
    }
  };
  var Doughnut = function(data, config, ctx) {
    var segmentTotal = 0;
    var doughnutRadius = Min([height / 2, width / 2]) - 5;
    var cutoutRadius = doughnutRadius * (config.percentageInnerCutout / 100);
    for(var i = 0;i < data.length;i++) {
      segmentTotal += data[i].value
    }
    animationLoop(config, null, drawPieSegments, ctx);
    function drawPieSegments(animationDecimal) {
      var cumulativeAngle = -Math.PI / 2, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        var segmentAngle = rotateAnimation * data[i].value / segmentTotal * Math.PI * 2;
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * doughnutRadius, cumulativeAngle, cumulativeAngle + segmentAngle, false);
        ctx.arc(width / 2, height / 2, scaleAnimation * cutoutRadius, cumulativeAngle + segmentAngle, cumulativeAngle, true);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(animationDecimal >= 1 && config.showTooltips) {
          var points = [], pAmount = 50;
          points.push({x:width / 2 + doughnutRadius * Math.cos(cumulativeAngle), y:height / 2 + doughnutRadius * Math.sin(cumulativeAngle)});
          for(var p = 0;p <= pAmount;p++) {
            points.push({x:width / 2 + doughnutRadius * Math.cos(cumulativeAngle + p / pAmount * segmentAngle), y:height / 2 + doughnutRadius * Math.sin(cumulativeAngle + p / pAmount * segmentAngle)})
          }
          points.push({x:width / 2 + cutoutRadius * Math.cos(cumulativeAngle + segmentAngle), y:height / 2 + cutoutRadius * Math.sin(cumulativeAngle + segmentAngle)});
          for(var p = pAmount;p >= 0;p--) {
            points.push({x:width / 2 + cutoutRadius * Math.cos(cumulativeAngle + p / pAmount * segmentAngle), y:height / 2 + cutoutRadius * Math.sin(cumulativeAngle + p / pAmount * segmentAngle)})
          }
          registerTooltip(ctx, {type:"shape", points:points}, {label:data[i].tooltipLabel, value:data[i].value}, "Doughnut")
        }
        if(config.segmentShowStroke) {
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.stroke()
        }
        cumulativeAngle += segmentAngle
      }
    }
  };
  var Line = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString, valueHop, widestXLabel, xAxisLength, yAxisPosX, xAxisPosY, rotateLabels = 0;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : "";
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = Math.floor(scaleHeight / calculatedScale.steps);
    calculateXAxisSize();
    animationLoop(config, drawScale, drawLines, ctx);
    function drawLines(animPc) {
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.strokeStyle = data.datasets[i].strokeColor;
        ctx.lineWidth = config.datasetStrokeWidth;
        ctx.beginPath();
        ctx.moveTo(yAxisPosX, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[0], calculatedScale, scaleHop));
        for(var j = 1;j < data.datasets[i].data.length;j++) {
          if(config.bezierCurve) {
            ctx.bezierCurveTo(xPos(j - 0.5), yPos(i, j - 1), xPos(j - 0.5), yPos(i, j), xPos(j), yPos(i, j))
          }else {
            ctx.lineTo(xPos(j), yPos(i, j))
          }
        }
        var pointRadius = config.pointDot ? config.pointDotRadius + config.pointDotStrokeWidth : 10;
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(animPc >= 1 && config.showTooltips) {
            registerTooltip(ctx, {type:"circle", x:xPos(j), y:yPos(i, j), r:pointRadius}, {label:data.tooltipLabels[j], value:data.datasets[i].data[j]}, "Line")
          }
        }
        ctx.stroke();
        if(config.datasetFill) {
          ctx.lineTo(yAxisPosX + valueHop * (data.datasets[i].data.length - 1), xAxisPosY);
          ctx.lineTo(yAxisPosX, xAxisPosY);
          ctx.closePath();
          ctx.fillStyle = data.datasets[i].fillColor;
          ctx.fill()
        }else {
          ctx.closePath()
        }
        if(config.pointDot) {
          ctx.fillStyle = data.datasets[i].pointColor;
          ctx.strokeStyle = data.datasets[i].pointStrokeColor;
          ctx.lineWidth = config.pointDotStrokeWidth;
          for(var k = 0;k < data.datasets[i].data.length;k++) {
            ctx.beginPath();
            ctx.arc(yAxisPosX + valueHop * k, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[k], calculatedScale, scaleHop), config.pointDotRadius, 0, Math.PI * 2, true);
            ctx.fill();
            ctx.stroke()
          }
        }
      }
      function yPos(dataSet, iteration) {
        return xAxisPosY - animPc * calculateOffset(data.datasets[dataSet].data[iteration], calculatedScale, scaleHop)
      }
      function xPos(iteration) {
        return yAxisPosX + valueHop * iteration
      }
    }
    function drawScale() {
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(width - widestXLabel / 2 + 5, xAxisPosY);
      ctx.lineTo(width - widestXLabel / 2 - xAxisLength - 5, xAxisPosY);
      ctx.stroke();
      if(rotateLabels > 0) {
        ctx.save();
        ctx.textAlign = "right"
      }else {
        ctx.textAlign = "center"
      }
      ctx.fillStyle = config.scaleFontColor;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.save();
        if(rotateLabels > 0) {
          ctx.translate(yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize);
          ctx.rotate(-(rotateLabels * (Math.PI / 180)));
          ctx.fillText(data.labels[i], 0, 0);
          ctx.restore()
        }else {
          ctx.fillText(data.labels[i], yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize + 3)
        }
        ctx.beginPath();
        ctx.moveTo(yAxisPosX + i * valueHop, xAxisPosY + 3);
        if(config.scaleShowGridLines && i > 0) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + i * valueHop, 5)
        }else {
          ctx.lineTo(yAxisPosX + i * valueHop, xAxisPosY + 3)
        }
        ctx.stroke()
      }
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(yAxisPosX, xAxisPosY + 5);
      ctx.lineTo(yAxisPosX, 5);
      ctx.stroke();
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(var j = 0;j < calculatedScale.steps;j++) {
        ctx.beginPath();
        ctx.moveTo(yAxisPosX - 3, xAxisPosY - (j + 1) * scaleHop);
        if(config.scaleShowGridLines) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + xAxisLength + 5, xAxisPosY - (j + 1) * scaleHop)
        }else {
          ctx.lineTo(yAxisPosX - 0.5, xAxisPosY - (j + 1) * scaleHop)
        }
        ctx.stroke();
        if(config.scaleShowLabels) {
          ctx.fillText(calculatedScale.labels[j], yAxisPosX - 8, xAxisPosY - (j + 1) * scaleHop)
        }
      }
    }
    function calculateXAxisSize() {
      var longestText = 1;
      if(config.scaleShowLabels) {
        ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
        for(var i = 0;i < calculatedScale.labels.length;i++) {
          var measuredText = ctx.measureText(calculatedScale.labels[i]).width;
          longestText = measuredText > longestText ? measuredText : longestText
        }
        longestText += 10
      }
      xAxisLength = width - longestText - widestXLabel;
      valueHop = Math.floor(xAxisLength / (data.labels.length - 1));
      yAxisPosX = width - widestXLabel / 2 - xAxisLength;
      xAxisPosY = scaleHeight + config.scaleFontSize / 2
    }
    function calculateDrawingSizes() {
      maxSize = height;
      ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
      widestXLabel = 1;
      for(var i = 0;i < data.labels.length;i++) {
        var textLength = ctx.measureText(data.labels[i]).width;
        widestXLabel = textLength > widestXLabel ? textLength : widestXLabel
      }
      if(width / data.labels.length < widestXLabel) {
        rotateLabels = 45;
        if(width / data.labels.length < Math.cos(rotateLabels) * widestXLabel) {
          rotateLabels = 90;
          maxSize -= widestXLabel
        }else {
          maxSize -= Math.sin(rotateLabels) * widestXLabel
        }
      }else {
        maxSize -= config.scaleFontSize
      }
      maxSize -= 5;
      labelHeight = config.scaleFontSize;
      maxSize -= labelHeight;
      scaleHeight = maxSize
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Bar = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString, valueHop, widestXLabel, xAxisLength, yAxisPosX, xAxisPosY, barWidth, rotateLabels = 0;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : "";
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = Math.floor(scaleHeight / calculatedScale.steps);
    calculateXAxisSize();
    animationLoop(config, drawScale, drawBars, ctx);
    function drawBars(animPc) {
      ctx.lineWidth = config.barStrokeWidth;
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.fillStyle = data.datasets[i].fillColor;
        ctx.strokeStyle = data.datasets[i].strokeColor;
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          var barOffset = yAxisPosX + config.barValueSpacing + valueHop * j + barWidth * i + config.barDatasetSpacing * i + config.barStrokeWidth * i;
          ctx.beginPath();
          ctx.moveTo(barOffset, xAxisPosY);
          ctx.lineTo(barOffset, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop) + config.barStrokeWidth / 2);
          ctx.lineTo(barOffset + barWidth, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop) + config.barStrokeWidth / 2);
          ctx.lineTo(barOffset + barWidth, xAxisPosY);
          if(config.barShowStroke) {
            ctx.stroke()
          }
          ctx.closePath();
          ctx.fill();
          if(animPc >= 1 && config.showTooltips) {
            var x = barOffset, height = calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop), y = xAxisPosY - height, width = barWidth;
            registerTooltip(ctx, {type:"rect", x:x, y:y, width:width, height:height}, {label:data.tooltipLabels[j], value:data.datasets[i].data[j]}, "Bar")
          }
        }
      }
    }
    function drawScale() {
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(width - widestXLabel / 2 + 5, xAxisPosY);
      ctx.lineTo(width - widestXLabel / 2 - xAxisLength - 5, xAxisPosY);
      ctx.stroke();
      if(rotateLabels > 0) {
        ctx.save();
        ctx.textAlign = "right"
      }else {
        ctx.textAlign = "center"
      }
      ctx.fillStyle = config.scaleFontColor;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.save();
        if(rotateLabels > 0) {
          ctx.translate(yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize);
          ctx.rotate(-(rotateLabels * (Math.PI / 180)));
          ctx.fillText(data.labels[i], 0, 0);
          ctx.restore()
        }else {
          ctx.fillText(data.labels[i], yAxisPosX + i * valueHop + valueHop / 2, xAxisPosY + config.scaleFontSize + 3)
        }
        ctx.beginPath();
        ctx.moveTo(yAxisPosX + (i + 1) * valueHop, xAxisPosY + 3);
        ctx.lineWidth = config.scaleGridLineWidth;
        ctx.strokeStyle = config.scaleGridLineColor;
        ctx.lineTo(yAxisPosX + (i + 1) * valueHop, 5);
        ctx.stroke()
      }
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(yAxisPosX, xAxisPosY + 5);
      ctx.lineTo(yAxisPosX, 5);
      ctx.stroke();
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(var j = 0;j < calculatedScale.steps;j++) {
        ctx.beginPath();
        ctx.moveTo(yAxisPosX - 3, xAxisPosY - (j + 1) * scaleHop);
        if(config.scaleShowGridLines) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + xAxisLength + 5, xAxisPosY - (j + 1) * scaleHop)
        }else {
          ctx.lineTo(yAxisPosX - 0.5, xAxisPosY - (j + 1) * scaleHop)
        }
        ctx.stroke();
        if(config.scaleShowLabels) {
          ctx.fillText(calculatedScale.labels[j], yAxisPosX - 8, xAxisPosY - (j + 1) * scaleHop)
        }
      }
    }
    function calculateXAxisSize() {
      var longestText = 1;
      if(config.scaleShowLabels) {
        ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
        for(var i = 0;i < calculatedScale.labels.length;i++) {
          var measuredText = ctx.measureText(calculatedScale.labels[i]).width;
          longestText = measuredText > longestText ? measuredText : longestText
        }
        longestText += 10
      }
      xAxisLength = width - longestText - widestXLabel;
      valueHop = Math.floor(xAxisLength / data.labels.length);
      barWidth = (valueHop - config.scaleGridLineWidth * 2 - config.barValueSpacing * 2 - (config.barDatasetSpacing * data.datasets.length - 1) - (config.barStrokeWidth / 2 * data.datasets.length - 1)) / data.datasets.length;
      yAxisPosX = width - widestXLabel / 2 - xAxisLength;
      xAxisPosY = scaleHeight + config.scaleFontSize / 2
    }
    function calculateDrawingSizes() {
      maxSize = height;
      ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
      widestXLabel = 1;
      for(var i = 0;i < data.labels.length;i++) {
        var textLength = ctx.measureText(data.labels[i]).width;
        widestXLabel = textLength > widestXLabel ? textLength : widestXLabel
      }
      if(width / data.labels.length < widestXLabel) {
        rotateLabels = 45;
        if(width / data.labels.length < Math.cos(rotateLabels) * widestXLabel) {
          rotateLabels = 90;
          maxSize -= widestXLabel
        }else {
          maxSize -= Math.sin(rotateLabels) * widestXLabel
        }
      }else {
        maxSize -= config.scaleFontSize
      }
      maxSize -= 5;
      labelHeight = config.scaleFontSize;
      maxSize -= labelHeight;
      scaleHeight = maxSize
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  function calculateOffset(val, calculatedScale, scaleHop) {
    var outerValue = calculatedScale.steps * calculatedScale.stepValue;
    var adjustedValue = val - calculatedScale.graphMin;
    var scalingFactor = CapValue(adjustedValue / outerValue, 1, 0);
    return scaleHop * calculatedScale.steps * scalingFactor
  }
  function animationLoop(config, drawScale, drawData, ctx) {
    var animFrameAmount = config.animation ? 1 / CapValue(config.animationSteps, Number.MAX_VALUE, 1) : 1, easingFunction = animationOptions[config.animationEasing], percentAnimComplete = config.animation ? 0 : 1;
    if(typeof drawScale !== "function") {
      drawScale = function() {
      }
    }
    requestAnimFrame(animLoop);
    function animateFrame() {
      var easeAdjustedAnimationPercent = config.animation ? CapValue(easingFunction(percentAnimComplete), null, 0) : 1;
      clear(ctx);
      if(config.scaleOverlay) {
        drawData(easeAdjustedAnimationPercent);
        drawScale()
      }else {
        drawScale();
        drawData(easeAdjustedAnimationPercent)
      }
    }
    function animLoop() {
      percentAnimComplete += animFrameAmount;
      animateFrame();
      if(percentAnimComplete <= 1) {
        requestAnimFrame(animLoop)
      }else {
        if(typeof config.onAnimationComplete == "function") {
          config.onAnimationComplete()
        }
      }
    }
  }
  var requestAnimFrame = function() {
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(callback) {
      window.setTimeout(callback, 1E3 / 60)
    }
  }();
  function calculateScale(drawingHeight, maxSteps, minSteps, maxValue, minValue, labelTemplateString) {
    var graphMin, graphMax, graphRange, stepValue, numberOfSteps, valueRange, rangeOrderOfMagnitude, decimalNum;
    valueRange = maxValue - minValue;
    rangeOrderOfMagnitude = calculateOrderOfMagnitude(valueRange);
    graphMin = Math.floor(minValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude);
    graphMax = Math.ceil(maxValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude);
    graphRange = graphMax - graphMin;
    stepValue = Math.pow(10, rangeOrderOfMagnitude);
    numberOfSteps = Math.round(graphRange / stepValue);
    while(numberOfSteps < minSteps || numberOfSteps > maxSteps) {
      if(numberOfSteps < minSteps) {
        stepValue /= 2;
        numberOfSteps = Math.round(graphRange / stepValue)
      }else {
        stepValue *= 2;
        numberOfSteps = Math.round(graphRange / stepValue)
      }
    }
    var labels = [];
    populateLabels(labelTemplateString, labels, numberOfSteps, graphMin, stepValue);
    return{steps:numberOfSteps, stepValue:stepValue, graphMin:graphMin, labels:labels};
    function calculateOrderOfMagnitude(val) {
      return Math.floor(Math.log(val) / Math.LN10)
    }
  }
  function populateLabels(labelTemplateString, labels, numberOfSteps, graphMin, stepValue) {
    if(labelTemplateString) {
      for(var i = 1;i < numberOfSteps + 1;i++) {
        labels.push(tmpl(labelTemplateString, {value:(graphMin + stepValue * i).toFixed(getDecimalPlaces(stepValue))}))
      }
    }
  }
  function Max(array) {
    return Math.max.apply(Math, array)
  }
  function Min(array) {
    return Math.min.apply(Math, array)
  }
  function Default(userDeclared, valueIfFalse) {
    if(!userDeclared) {
      return valueIfFalse
    }else {
      return userDeclared
    }
  }
  function isNumber(n) {
    return!isNaN(parseFloat(n)) && isFinite(n)
  }
  function CapValue(valueToCap, maxValue, minValue) {
    if(isNumber(maxValue)) {
      if(valueToCap > maxValue) {
        return maxValue
      }
    }
    if(isNumber(minValue)) {
      if(valueToCap < minValue) {
        return minValue
      }
    }
    return valueToCap
  }
  function getDecimalPlaces(num) {
    var numberOfDecimalPlaces;
    if(num % 1 != 0) {
      return num.toString().split(".")[1].length
    }else {
      return 0
    }
  }
  function mergeChartConfig(defaults, userDefined) {
    var returnObj = {};
    for(var attrname in defaults) {
      returnObj[attrname] = defaults[attrname]
    }
    for(var attrname in userDefined) {
      if(typeof userDefined[attrname] === "object" && defaults[attrname]) {
        returnObj[attrname] = mergeChartConfig(defaults[attrname], userDefined[attrname])
      }else {
        returnObj[attrname] = userDefined[attrname]
      }
    }
    return returnObj
  }
  var cache = {};
  function tmpl(str, data) {
    var fn = !/\W/.test(str) ? cache[str] = cache[str] || tmpl(document.getElementById(str).innerHTML) : new Function("obj", "var p=[],print=function(){p.push.apply(p,arguments);};" + "with(obj){p.push('" + str.replace(/[\r\t\n]/g, " ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g, "$1\r").replace(/\t=(.*?)%>/g, "',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'") + "');}return p.join('');");
    return data ? fn(data) : fn
  }
  function getFadeColor(percent, primColor, secColor) {
    var pseudoEl = document.createElement("div"), rgbPrim, rgbSec;
    pseudoEl.style.color = primColor;
    document.body.appendChild(pseudoEl);
    rgbPrim = window.getComputedStyle(pseudoEl).color;
    pseudoEl.style.color = secColor;
    rgbSec = window.getComputedStyle(pseudoEl).color;
    var regex = /rgb *\( *([0-9]{1,3}) *, *([0-9]{1,3}) *, *([0-9]{1,3}) *\)/, valuesP = regex.exec(rgbPrim), valuesS = regex.exec(rgbSec), rP = Math.round(parseFloat(valuesP[1])), gP = Math.round(parseFloat(valuesP[2])), bP = Math.round(parseFloat(valuesP[3])), rS = Math.round(parseFloat(valuesS[1])), gS = Math.round(parseFloat(valuesS[2])), bS = Math.round(parseFloat(valuesS[3])), rCur = parseInt((rP - rS) * percent + rS), gCur = parseInt((gP - gS) * percent + gS), bCur = parseInt((bP - bS) * percent + 
    bS);
    pseudoEl.parentNode.removeChild(pseudoEl);
    return"rgb(" + rCur + "," + gCur + "," + bCur + ")"
  }
};
(function(a, b) {
  function cy(a) {
    return f.isWindow(a) ? a : a.nodeType === 9 ? a.defaultView || a.parentWindow : !1
  }
  function cu(a) {
    if(!cj[a]) {
      var b = c.body, d = f("<" + a + ">").appendTo(b), e = d.css("display");
      d.remove();
      if(e === "none" || e === "") {
        ck || (ck = c.createElement("iframe"), ck.frameBorder = ck.width = ck.height = 0), b.appendChild(ck);
        if(!cl || !ck.createElement) {
          cl = (ck.contentWindow || ck.contentDocument).document, cl.write((f.support.boxModel ? "<!doctype html>" : "") + "<html><body>"), cl.close()
        }
        d = cl.createElement(a), cl.body.appendChild(d), e = f.css(d, "display"), b.removeChild(ck)
      }
      cj[a] = e
    }
    return cj[a]
  }
  function ct(a, b) {
    var c = {};
    f.each(cp.concat.apply([], cp.slice(0, b)), function() {
      c[this] = a
    });
    return c
  }
  function cs() {
    cq = b
  }
  function cr() {
    setTimeout(cs, 0);
    return cq = f.now()
  }
  function ci() {
    try {
      return new a.ActiveXObject("Microsoft.XMLHTTP")
    }catch(b) {
    }
  }
  function ch() {
    try {
      return new a.XMLHttpRequest
    }catch(b) {
    }
  }
  function cb(a, c) {
    a.dataFilter && (c = a.dataFilter(c, a.dataType));
    var d = a.dataTypes, e = {}, g, h, i = d.length, j, k = d[0], l, m, n, o, p;
    for(g = 1;g < i;g++) {
      if(g === 1) {
        for(h in a.converters) {
          typeof h == "string" && (e[h.toLowerCase()] = a.converters[h])
        }
      }
      l = k, k = d[g];
      if(k === "*") {
        k = l
      }else {
        if(l !== "*" && l !== k) {
          m = l + " " + k, n = e[m] || e["* " + k];
          if(!n) {
            p = b;
            for(o in e) {
              j = o.split(" ");
              if(j[0] === l || j[0] === "*") {
                p = e[j[1] + " " + k];
                if(p) {
                  o = e[o], o === !0 ? n = p : p === !0 && (n = o);
                  break
                }
              }
            }
          }
          !n && !p && f.error("No conversion from " + m.replace(" ", " to ")), n !== !0 && (c = n ? n(c) : p(o(c)))
        }
      }
    }
    return c
  }
  function ca(a, c, d) {
    var e = a.contents, f = a.dataTypes, g = a.responseFields, h, i, j, k;
    for(i in g) {
      i in d && (c[g[i]] = d[i])
    }
    while(f[0] === "*") {
      f.shift(), h === b && (h = a.mimeType || c.getResponseHeader("content-type"))
    }
    if(h) {
      for(i in e) {
        if(e[i] && e[i].test(h)) {
          f.unshift(i);
          break
        }
      }
    }
    if(f[0] in d) {
      j = f[0]
    }else {
      for(i in d) {
        if(!f[0] || a.converters[i + " " + f[0]]) {
          j = i;
          break
        }
        k || (k = i)
      }
      j = j || k
    }
    if(j) {
      j !== f[0] && f.unshift(j);
      return d[j]
    }
  }
  function b_(a, b, c, d) {
    if(f.isArray(b)) {
      f.each(b, function(b, e) {
        c || bD.test(a) ? d(a, e) : b_(a + "[" + (typeof e == "object" ? b : "") + "]", e, c, d)
      })
    }else {
      if(!c && f.type(b) === "object") {
        for(var e in b) {
          b_(a + "[" + e + "]", b[e], c, d)
        }
      }else {
        d(a, b)
      }
    }
  }
  function b$(a, c) {
    var d, e, g = f.ajaxSettings.flatOptions || {};
    for(d in c) {
      c[d] !== b && ((g[d] ? a : e || (e = {}))[d] = c[d])
    }
    e && f.extend(!0, a, e)
  }
  function bZ(a, c, d, e, f, g) {
    f = f || c.dataTypes[0], g = g || {}, g[f] = !0;
    var h = a[f], i = 0, j = h ? h.length : 0, k = a === bS, l;
    for(;i < j && (k || !l);i++) {
      l = h[i](c, d, e), typeof l == "string" && (!k || g[l] ? l = b : (c.dataTypes.unshift(l), l = bZ(a, c, d, e, l, g)))
    }
    (k || !l) && !g["*"] && (l = bZ(a, c, d, e, "*", g));
    return l
  }
  function bY(a) {
    return function(b, c) {
      typeof b != "string" && (c = b, b = "*");
      if(f.isFunction(c)) {
        var d = b.toLowerCase().split(bO), e = 0, g = d.length, h, i, j;
        for(;e < g;e++) {
          h = d[e], j = /^\+/.test(h), j && (h = h.substr(1) || "*"), i = a[h] = a[h] || [], i[j ? "unshift" : "push"](c)
        }
      }
    }
  }
  function bB(a, b, c) {
    var d = b === "width" ? a.offsetWidth : a.offsetHeight, e = b === "width" ? 1 : 0, g = 4;
    if(d > 0) {
      if(c !== "border") {
        for(;e < g;e += 2) {
          c || (d -= parseFloat(f.css(a, "padding" + bx[e])) || 0), c === "margin" ? d += parseFloat(f.css(a, c + bx[e])) || 0 : d -= parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0
        }
      }
      return d + "px"
    }
    d = by(a, b);
    if(d < 0 || d == null) {
      d = a.style[b]
    }
    if(bt.test(d)) {
      return d
    }
    d = parseFloat(d) || 0;
    if(c) {
      for(;e < g;e += 2) {
        d += parseFloat(f.css(a, "padding" + bx[e])) || 0, c !== "padding" && (d += parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0), c === "margin" && (d += parseFloat(f.css(a, c + bx[e])) || 0)
      }
    }
    return d + "px"
  }
  function bo(a) {
    var b = c.createElement("div");
    bh.appendChild(b), b.innerHTML = a.outerHTML;
    return b.firstChild
  }
  function bn(a) {
    var b = (a.nodeName || "").toLowerCase();
    b === "input" ? bm(a) : b !== "script" && typeof a.getElementsByTagName != "undefined" && f.grep(a.getElementsByTagName("input"), bm)
  }
  function bm(a) {
    if(a.type === "checkbox" || a.type === "radio") {
      a.defaultChecked = a.checked
    }
  }
  function bl(a) {
    return typeof a.getElementsByTagName != "undefined" ? a.getElementsByTagName("*") : typeof a.querySelectorAll != "undefined" ? a.querySelectorAll("*") : []
  }
  function bk(a, b) {
    var c;
    b.nodeType === 1 && (b.clearAttributes && b.clearAttributes(), b.mergeAttributes && b.mergeAttributes(a), c = b.nodeName.toLowerCase(), c === "object" ? b.outerHTML = a.outerHTML : c !== "input" || a.type !== "checkbox" && a.type !== "radio" ? c === "option" ? b.selected = a.defaultSelected : c === "input" || c === "textarea" ? b.defaultValue = a.defaultValue : c === "script" && b.text !== a.text && (b.text = a.text) : (a.checked && (b.defaultChecked = b.checked = a.checked), b.value !== a.value && 
    (b.value = a.value)), b.removeAttribute(f.expando), b.removeAttribute("_submit_attached"), b.removeAttribute("_change_attached"))
  }
  function bj(a, b) {
    if(b.nodeType === 1 && !!f.hasData(a)) {
      var c, d, e, g = f._data(a), h = f._data(b, g), i = g.events;
      if(i) {
        delete h.handle, h.events = {};
        for(c in i) {
          for(d = 0, e = i[c].length;d < e;d++) {
            f.event.add(b, c, i[c][d])
          }
        }
      }
      h.data && (h.data = f.extend({}, h.data))
    }
  }
  function bi(a, b) {
    return f.nodeName(a, "table") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
  }
  function U(a) {
    var b = V.split("|"), c = a.createDocumentFragment();
    if(c.createElement) {
      while(b.length) {
        c.createElement(b.pop())
      }
    }
    return c
  }
  function T(a, b, c) {
    b = b || 0;
    if(f.isFunction(b)) {
      return f.grep(a, function(a, d) {
        var e = !!b.call(a, d, a);
        return e === c
      })
    }
    if(b.nodeType) {
      return f.grep(a, function(a, d) {
        return a === b === c
      })
    }
    if(typeof b == "string") {
      var d = f.grep(a, function(a) {
        return a.nodeType === 1
      });
      if(O.test(b)) {
        return f.filter(b, d, !c)
      }
      b = f.filter(b, d)
    }
    return f.grep(a, function(a, d) {
      return f.inArray(a, b) >= 0 === c
    })
  }
  function S(a) {
    return!a || !a.parentNode || a.parentNode.nodeType === 11
  }
  function K() {
    return!0
  }
  function J() {
    return!1
  }
  function n(a, b, c) {
    var d = b + "defer", e = b + "queue", g = b + "mark", h = f._data(a, d);
    h && (c === "queue" || !f._data(a, e)) && (c === "mark" || !f._data(a, g)) && setTimeout(function() {
      !f._data(a, e) && !f._data(a, g) && (f.removeData(a, d, !0), h.fire())
    }, 0)
  }
  function m(a) {
    for(var b in a) {
      if(b === "data" && f.isEmptyObject(a[b])) {
        continue
      }
      if(b !== "toJSON") {
        return!1
      }
    }
    return!0
  }
  function l(a, c, d) {
    if(d === b && a.nodeType === 1) {
      var e = "data-" + c.replace(k, "-$1").toLowerCase();
      d = a.getAttribute(e);
      if(typeof d == "string") {
        try {
          d = d === "true" ? !0 : d === "false" ? !1 : d === "null" ? null : f.isNumeric(d) ? +d : j.test(d) ? f.parseJSON(d) : d
        }catch(g) {
        }
        f.data(a, c, d)
      }else {
        d = b
      }
    }
    return d
  }
  function h(a) {
    var b = g[a] = {}, c, d;
    a = a.split(/\s+/);
    for(c = 0, d = a.length;c < d;c++) {
      b[a[c]] = !0
    }
    return b
  }
  var c = a.document, d = a.navigator, e = a.location, f = function() {
    function J() {
      if(!e.isReady) {
        try {
          c.documentElement.doScroll("left")
        }catch(a) {
          setTimeout(J, 1);
          return
        }
        e.ready()
      }
    }
    var e = function(a, b) {
      return new e.fn.init(a, b, h)
    }, f = a.jQuery, g = a.$, h, i = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, j = /\S/, k = /^\s+/, l = /\s+$/, m = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, n = /^[\],:{}\s]*$/, o = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, p = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, q = /(?:^|:|,)(?:\s*\[)+/g, r = /(webkit)[ \/]([\w.]+)/, s = /(opera)(?:.*version)?[ \/]([\w.]+)/, t = /(msie) ([\w.]+)/, u = /(mozilla)(?:.*? rv:([\w.]+))?/, v = /-([a-z]|[0-9])/ig, w = /^-ms-/, x = function(a, b) {
      return(b + "").toUpperCase()
    }, y = d.userAgent, z, A, B, C = Object.prototype.toString, D = Object.prototype.hasOwnProperty, E = Array.prototype.push, F = Array.prototype.slice, G = String.prototype.trim, H = Array.prototype.indexOf, I = {};
    e.fn = e.prototype = {constructor:e, init:function(a, d, f) {
      var g, h, j, k;
      if(!a) {
        return this
      }
      if(a.nodeType) {
        this.context = this[0] = a, this.length = 1;
        return this
      }
      if(a === "body" && !d && c.body) {
        this.context = c, this[0] = c.body, this.selector = a, this.length = 1;
        return this
      }
      if(typeof a == "string") {
        a.charAt(0) !== "<" || a.charAt(a.length - 1) !== ">" || a.length < 3 ? g = i.exec(a) : g = [null, a, null];
        if(g && (g[1] || !d)) {
          if(g[1]) {
            d = d instanceof e ? d[0] : d, k = d ? d.ownerDocument || d : c, j = m.exec(a), j ? e.isPlainObject(d) ? (a = [c.createElement(j[1])], e.fn.attr.call(a, d, !0)) : a = [k.createElement(j[1])] : (j = e.buildFragment([g[1]], [k]), a = (j.cacheable ? e.clone(j.fragment) : j.fragment).childNodes);
            return e.merge(this, a)
          }
          h = c.getElementById(g[2]);
          if(h && h.parentNode) {
            if(h.id !== g[2]) {
              return f.find(a)
            }
            this.length = 1, this[0] = h
          }
          this.context = c, this.selector = a;
          return this
        }
        return!d || d.jquery ? (d || f).find(a) : this.constructor(d).find(a)
      }
      if(e.isFunction(a)) {
        return f.ready(a)
      }
      a.selector !== b && (this.selector = a.selector, this.context = a.context);
      return e.makeArray(a, this)
    }, selector:"", jquery:"1.7.2", length:0, size:function() {
      return this.length
    }, toArray:function() {
      return F.call(this, 0)
    }, get:function(a) {
      return a == null ? this.toArray() : a < 0 ? this[this.length + a] : this[a]
    }, pushStack:function(a, b, c) {
      var d = this.constructor();
      e.isArray(a) ? E.apply(d, a) : e.merge(d, a), d.prevObject = this, d.context = this.context, b === "find" ? d.selector = this.selector + (this.selector ? " " : "") + c : b && (d.selector = this.selector + "." + b + "(" + c + ")");
      return d
    }, each:function(a, b) {
      return e.each(this, a, b)
    }, ready:function(a) {
      e.bindReady(), A.add(a);
      return this
    }, eq:function(a) {
      a = +a;
      return a === -1 ? this.slice(a) : this.slice(a, a + 1)
    }, first:function() {
      return this.eq(0)
    }, last:function() {
      return this.eq(-1)
    }, slice:function() {
      return this.pushStack(F.apply(this, arguments), "slice", F.call(arguments).join(","))
    }, map:function(a) {
      return this.pushStack(e.map(this, function(b, c) {
        return a.call(b, c, b)
      }))
    }, end:function() {
      return this.prevObject || this.constructor(null)
    }, push:E, sort:[].sort, splice:[].splice}, e.fn.init.prototype = e.fn, e.extend = e.fn.extend = function() {
      var a, c, d, f, g, h, i = arguments[0] || {}, j = 1, k = arguments.length, l = !1;
      typeof i == "boolean" && (l = i, i = arguments[1] || {}, j = 2), typeof i != "object" && !e.isFunction(i) && (i = {}), k === j && (i = this, --j);
      for(;j < k;j++) {
        if((a = arguments[j]) != null) {
          for(c in a) {
            d = i[c], f = a[c];
            if(i === f) {
              continue
            }
            l && f && (e.isPlainObject(f) || (g = e.isArray(f))) ? (g ? (g = !1, h = d && e.isArray(d) ? d : []) : h = d && e.isPlainObject(d) ? d : {}, i[c] = e.extend(l, h, f)) : f !== b && (i[c] = f)
          }
        }
      }
      return i
    }, e.extend({noConflict:function(b) {
      a.$ === e && (a.$ = g), b && a.jQuery === e && (a.jQuery = f);
      return e
    }, isReady:!1, readyWait:1, holdReady:function(a) {
      a ? e.readyWait++ : e.ready(!0)
    }, ready:function(a) {
      if(a === !0 && !--e.readyWait || a !== !0 && !e.isReady) {
        if(!c.body) {
          return setTimeout(e.ready, 1)
        }
        e.isReady = !0;
        if(a !== !0 && --e.readyWait > 0) {
          return
        }
        A.fireWith(c, [e]), e.fn.trigger && e(c).trigger("ready").off("ready")
      }
    }, bindReady:function() {
      if(!A) {
        A = e.Callbacks("once memory");
        if(c.readyState === "complete") {
          return setTimeout(e.ready, 1)
        }
        if(c.addEventListener) {
          c.addEventListener("DOMContentLoaded", B, !1), a.addEventListener("load", e.ready, !1)
        }else {
          if(c.attachEvent) {
            c.attachEvent("onreadystatechange", B), a.attachEvent("onload", e.ready);
            var b = !1;
            try {
              b = a.frameElement == null
            }catch(d) {
            }
            c.documentElement.doScroll && b && J()
          }
        }
      }
    }, isFunction:function(a) {
      return e.type(a) === "function"
    }, isArray:Array.isArray || function(a) {
      return e.type(a) === "array"
    }, isWindow:function(a) {
      return a != null && a == a.window
    }, isNumeric:function(a) {
      return!isNaN(parseFloat(a)) && isFinite(a)
    }, type:function(a) {
      return a == null ? String(a) : I[C.call(a)] || "object"
    }, isPlainObject:function(a) {
      if(!a || e.type(a) !== "object" || a.nodeType || e.isWindow(a)) {
        return!1
      }
      try {
        if(a.constructor && !D.call(a, "constructor") && !D.call(a.constructor.prototype, "isPrototypeOf")) {
          return!1
        }
      }catch(c) {
        return!1
      }
      var d;
      for(d in a) {
      }
      return d === b || D.call(a, d)
    }, isEmptyObject:function(a) {
      for(var b in a) {
        return!1
      }
      return!0
    }, error:function(a) {
      throw new Error(a);
    }, parseJSON:function(b) {
      if(typeof b != "string" || !b) {
        return null
      }
      b = e.trim(b);
      if(a.JSON && a.JSON.parse) {
        return a.JSON.parse(b)
      }
      if(n.test(b.replace(o, "@").replace(p, "]").replace(q, ""))) {
        return(new Function("return " + b))()
      }
      e.error("Invalid JSON: " + b)
    }, parseXML:function(c) {
      if(typeof c != "string" || !c) {
        return null
      }
      var d, f;
      try {
        a.DOMParser ? (f = new DOMParser, d = f.parseFromString(c, "text/xml")) : (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(c))
      }catch(g) {
        d = b
      }
      (!d || !d.documentElement || d.getElementsByTagName("parsererror").length) && e.error("Invalid XML: " + c);
      return d
    }, noop:function() {
    }, globalEval:function(b) {
      b && j.test(b) && (a.execScript || function(b) {
        a.eval.call(a, b)
      })(b)
    }, camelCase:function(a) {
      return a.replace(w, "ms-").replace(v, x)
    }, nodeName:function(a, b) {
      return a.nodeName && a.nodeName.toUpperCase() === b.toUpperCase()
    }, each:function(a, c, d) {
      var f, g = 0, h = a.length, i = h === b || e.isFunction(a);
      if(d) {
        if(i) {
          for(f in a) {
            if(c.apply(a[f], d) === !1) {
              break
            }
          }
        }else {
          for(;g < h;) {
            if(c.apply(a[g++], d) === !1) {
              break
            }
          }
        }
      }else {
        if(i) {
          for(f in a) {
            if(c.call(a[f], f, a[f]) === !1) {
              break
            }
          }
        }else {
          for(;g < h;) {
            if(c.call(a[g], g, a[g++]) === !1) {
              break
            }
          }
        }
      }
      return a
    }, trim:G ? function(a) {
      return a == null ? "" : G.call(a)
    } : function(a) {
      return a == null ? "" : (a + "").replace(k, "").replace(l, "")
    }, makeArray:function(a, b) {
      var c = b || [];
      if(a != null) {
        var d = e.type(a);
        a.length == null || d === "string" || d === "function" || d === "regexp" || e.isWindow(a) ? E.call(c, a) : e.merge(c, a)
      }
      return c
    }, inArray:function(a, b, c) {
      var d;
      if(b) {
        if(H) {
          return H.call(b, a, c)
        }
        d = b.length, c = c ? c < 0 ? Math.max(0, d + c) : c : 0;
        for(;c < d;c++) {
          if(c in b && b[c] === a) {
            return c
          }
        }
      }
      return-1
    }, merge:function(a, c) {
      var d = a.length, e = 0;
      if(typeof c.length == "number") {
        for(var f = c.length;e < f;e++) {
          a[d++] = c[e]
        }
      }else {
        while(c[e] !== b) {
          a[d++] = c[e++]
        }
      }
      a.length = d;
      return a
    }, grep:function(a, b, c) {
      var d = [], e;
      c = !!c;
      for(var f = 0, g = a.length;f < g;f++) {
        e = !!b(a[f], f), c !== e && d.push(a[f])
      }
      return d
    }, map:function(a, c, d) {
      var f, g, h = [], i = 0, j = a.length, k = a instanceof e || j !== b && typeof j == "number" && (j > 0 && a[0] && a[j - 1] || j === 0 || e.isArray(a));
      if(k) {
        for(;i < j;i++) {
          f = c(a[i], i, d), f != null && (h[h.length] = f)
        }
      }else {
        for(g in a) {
          f = c(a[g], g, d), f != null && (h[h.length] = f)
        }
      }
      return h.concat.apply([], h)
    }, guid:1, proxy:function(a, c) {
      if(typeof c == "string") {
        var d = a[c];
        c = a, a = d
      }
      if(!e.isFunction(a)) {
        return b
      }
      var f = F.call(arguments, 2), g = function() {
        return a.apply(c, f.concat(F.call(arguments)))
      };
      g.guid = a.guid = a.guid || g.guid || e.guid++;
      return g
    }, access:function(a, c, d, f, g, h, i) {
      var j, k = d == null, l = 0, m = a.length;
      if(d && typeof d == "object") {
        for(l in d) {
          e.access(a, c, l, d[l], 1, h, f)
        }
        g = 1
      }else {
        if(f !== b) {
          j = i === b && e.isFunction(f), k && (j ? (j = c, c = function(a, b, c) {
            return j.call(e(a), c)
          }) : (c.call(a, f), c = null));
          if(c) {
            for(;l < m;l++) {
              c(a[l], d, j ? f.call(a[l], l, c(a[l], d)) : f, i)
            }
          }
          g = 1
        }
      }
      return g ? a : k ? c.call(a) : m ? c(a[0], d) : h
    }, now:function() {
      return(new Date).getTime()
    }, uaMatch:function(a) {
      a = a.toLowerCase();
      var b = r.exec(a) || s.exec(a) || t.exec(a) || a.indexOf("compatible") < 0 && u.exec(a) || [];
      return{browser:b[1] || "", version:b[2] || "0"}
    }, sub:function() {
      function a(b, c) {
        return new a.fn.init(b, c)
      }
      e.extend(!0, a, this), a.superclass = this, a.fn = a.prototype = this(), a.fn.constructor = a, a.sub = this.sub, a.fn.init = function(d, f) {
        f && f instanceof e && !(f instanceof a) && (f = a(f));
        return e.fn.init.call(this, d, f, b)
      }, a.fn.init.prototype = a.fn;
      var b = a(c);
      return a
    }, browser:{}}), e.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(a, b) {
      I["[object " + b + "]"] = b.toLowerCase()
    }), z = e.uaMatch(y), z.browser && (e.browser[z.browser] = !0, e.browser.version = z.version), e.browser.webkit && (e.browser.safari = !0), j.test("\u00a0") && (k = /^[\s\xA0]+/, l = /[\s\xA0]+$/), h = e(c), c.addEventListener ? B = function() {
      c.removeEventListener("DOMContentLoaded", B, !1), e.ready()
    } : c.attachEvent && (B = function() {
      c.readyState === "complete" && (c.detachEvent("onreadystatechange", B), e.ready())
    });
    return e
  }(), g = {};
  f.Callbacks = function(a) {
    a = a ? g[a] || h(a) : {};
    var c = [], d = [], e, i, j, k, l, m, n = function(b) {
      var d, e, g, h, i;
      for(d = 0, e = b.length;d < e;d++) {
        g = b[d], h = f.type(g), h === "array" ? n(g) : h === "function" && (!a.unique || !p.has(g)) && c.push(g)
      }
    }, o = function(b, f) {
      f = f || [], e = !a.memory || [b, f], i = !0, j = !0, m = k || 0, k = 0, l = c.length;
      for(;c && m < l;m++) {
        if(c[m].apply(b, f) === !1 && a.stopOnFalse) {
          e = !0;
          break
        }
      }
      j = !1, c && (a.once ? e === !0 ? p.disable() : c = [] : d && d.length && (e = d.shift(), p.fireWith(e[0], e[1])))
    }, p = {add:function() {
      if(c) {
        var a = c.length;
        n(arguments), j ? l = c.length : e && e !== !0 && (k = a, o(e[0], e[1]))
      }
      return this
    }, remove:function() {
      if(c) {
        var b = arguments, d = 0, e = b.length;
        for(;d < e;d++) {
          for(var f = 0;f < c.length;f++) {
            if(b[d] === c[f]) {
              j && f <= l && (l--, f <= m && m--), c.splice(f--, 1);
              if(a.unique) {
                break
              }
            }
          }
        }
      }
      return this
    }, has:function(a) {
      if(c) {
        var b = 0, d = c.length;
        for(;b < d;b++) {
          if(a === c[b]) {
            return!0
          }
        }
      }
      return!1
    }, empty:function() {
      c = [];
      return this
    }, disable:function() {
      c = d = e = b;
      return this
    }, disabled:function() {
      return!c
    }, lock:function() {
      d = b, (!e || e === !0) && p.disable();
      return this
    }, locked:function() {
      return!d
    }, fireWith:function(b, c) {
      d && (j ? a.once || d.push([b, c]) : (!a.once || !e) && o(b, c));
      return this
    }, fire:function() {
      p.fireWith(this, arguments);
      return this
    }, fired:function() {
      return!!i
    }};
    return p
  };
  var i = [].slice;
  f.extend({Deferred:function(a) {
    var b = f.Callbacks("once memory"), c = f.Callbacks("once memory"), d = f.Callbacks("memory"), e = "pending", g = {resolve:b, reject:c, notify:d}, h = {done:b.add, fail:c.add, progress:d.add, state:function() {
      return e
    }, isResolved:b.fired, isRejected:c.fired, then:function(a, b, c) {
      i.done(a).fail(b).progress(c);
      return this
    }, always:function() {
      i.done.apply(i, arguments).fail.apply(i, arguments);
      return this
    }, pipe:function(a, b, c) {
      return f.Deferred(function(d) {
        f.each({done:[a, "resolve"], fail:[b, "reject"], progress:[c, "notify"]}, function(a, b) {
          var c = b[0], e = b[1], g;
          f.isFunction(c) ? i[a](function() {
            g = c.apply(this, arguments), g && f.isFunction(g.promise) ? g.promise().then(d.resolve, d.reject, d.notify) : d[e + "With"](this === i ? d : this, [g])
          }) : i[a](d[e])
        })
      }).promise()
    }, promise:function(a) {
      if(a == null) {
        a = h
      }else {
        for(var b in h) {
          a[b] = h[b]
        }
      }
      return a
    }}, i = h.promise({}), j;
    for(j in g) {
      i[j] = g[j].fire, i[j + "With"] = g[j].fireWith
    }
    i.done(function() {
      e = "resolved"
    }, c.disable, d.lock).fail(function() {
      e = "rejected"
    }, b.disable, d.lock), a && a.call(i, i);
    return i
  }, when:function(a) {
    function m(a) {
      return function(b) {
        e[a] = arguments.length > 1 ? i.call(arguments, 0) : b, j.notifyWith(k, e)
      }
    }
    function l(a) {
      return function(c) {
        b[a] = arguments.length > 1 ? i.call(arguments, 0) : c, --g || j.resolveWith(j, b)
      }
    }
    var b = i.call(arguments, 0), c = 0, d = b.length, e = Array(d), g = d, h = d, j = d <= 1 && a && f.isFunction(a.promise) ? a : f.Deferred(), k = j.promise();
    if(d > 1) {
      for(;c < d;c++) {
        b[c] && b[c].promise && f.isFunction(b[c].promise) ? b[c].promise().then(l(c), j.reject, m(c)) : --g
      }
      g || j.resolveWith(j, b)
    }else {
      j !== a && j.resolveWith(j, d ? [a] : [])
    }
    return k
  }}), f.support = function() {
    var b, d, e, g, h, i, j, k, l, m, n, o, p = c.createElement("div"), q = c.documentElement;
    p.setAttribute("className", "t"), p.innerHTML = "   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>", d = p.getElementsByTagName("*"), e = p.getElementsByTagName("a")[0];
    if(!d || !d.length || !e) {
      return{}
    }
    g = c.createElement("select"), h = g.appendChild(c.createElement("option")), i = p.getElementsByTagName("input")[0], b = {leadingWhitespace:p.firstChild.nodeType === 3, tbody:!p.getElementsByTagName("tbody").length, htmlSerialize:!!p.getElementsByTagName("link").length, style:/top/.test(e.getAttribute("style")), hrefNormalized:e.getAttribute("href") === "/a", opacity:/^0.55/.test(e.style.opacity), cssFloat:!!e.style.cssFloat, checkOn:i.value === "on", optSelected:h.selected, getSetAttribute:p.className !== 
    "t", enctype:!!c.createElement("form").enctype, html5Clone:c.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>", submitBubbles:!0, changeBubbles:!0, focusinBubbles:!1, deleteExpando:!0, noCloneEvent:!0, inlineBlockNeedsLayout:!1, shrinkWrapBlocks:!1, reliableMarginRight:!0, pixelMargin:!0}, f.boxModel = b.boxModel = c.compatMode === "CSS1Compat", i.checked = !0, b.noCloneChecked = i.cloneNode(!0).checked, g.disabled = !0, b.optDisabled = !h.disabled;
    try {
      delete p.test
    }catch(r) {
      b.deleteExpando = !1
    }
    !p.addEventListener && p.attachEvent && p.fireEvent && (p.attachEvent("onclick", function() {
      b.noCloneEvent = !1
    }), p.cloneNode(!0).fireEvent("onclick")), i = c.createElement("input"), i.value = "t", i.setAttribute("type", "radio"), b.radioValue = i.value === "t", i.setAttribute("checked", "checked"), i.setAttribute("name", "t"), p.appendChild(i), j = c.createDocumentFragment(), j.appendChild(p.lastChild), b.checkClone = j.cloneNode(!0).cloneNode(!0).lastChild.checked, b.appendChecked = i.checked, j.removeChild(i), j.appendChild(p);
    if(p.attachEvent) {
      for(n in{submit:1, change:1, focusin:1}) {
        m = "on" + n, o = m in p, o || (p.setAttribute(m, "return;"), o = typeof p[m] == "function"), b[n + "Bubbles"] = o
      }
    }
    j.removeChild(p), j = g = h = p = i = null, f(function() {
      var d, e, g, h, i, j, l, m, n, q, r, s, t, u = c.getElementsByTagName("body")[0];
      !u || (m = 1, t = "padding:0;margin:0;border:", r = "position:absolute;top:0;left:0;width:1px;height:1px;", s = t + "0;visibility:hidden;", n = "style='" + r + t + "5px solid #000;", q = "<div " + n + "display:block;'><div style='" + t + "0;display:block;overflow:hidden;'></div></div>" + "<table " + n + "' cellpadding='0' cellspacing='0'>" + "<tr><td></td></tr></table>", d = c.createElement("div"), d.style.cssText = s + "width:0;height:0;position:static;top:0;margin-top:" + m + "px", u.insertBefore(d, 
      u.firstChild), p = c.createElement("div"), d.appendChild(p), p.innerHTML = "<table><tr><td style='" + t + "0;display:none'></td><td>t</td></tr></table>", k = p.getElementsByTagName("td"), o = k[0].offsetHeight === 0, k[0].style.display = "", k[1].style.display = "none", b.reliableHiddenOffsets = o && k[0].offsetHeight === 0, a.getComputedStyle && (p.innerHTML = "", l = c.createElement("div"), l.style.width = "0", l.style.marginRight = "0", p.style.width = "2px", p.appendChild(l), b.reliableMarginRight = 
      (parseInt((a.getComputedStyle(l, null) || {marginRight:0}).marginRight, 10) || 0) === 0), typeof p.style.zoom != "undefined" && (p.innerHTML = "", p.style.width = p.style.padding = "1px", p.style.border = 0, p.style.overflow = "hidden", p.style.display = "inline", p.style.zoom = 1, b.inlineBlockNeedsLayout = p.offsetWidth === 3, p.style.display = "block", p.style.overflow = "visible", p.innerHTML = "<div style='width:5px;'></div>", b.shrinkWrapBlocks = p.offsetWidth !== 3), p.style.cssText = 
      r + s, p.innerHTML = q, e = p.firstChild, g = e.firstChild, i = e.nextSibling.firstChild.firstChild, j = {doesNotAddBorder:g.offsetTop !== 5, doesAddBorderForTableAndCells:i.offsetTop === 5}, g.style.position = "fixed", g.style.top = "20px", j.fixedPosition = g.offsetTop === 20 || g.offsetTop === 15, g.style.position = g.style.top = "", e.style.overflow = "hidden", e.style.position = "relative", j.subtractsBorderForOverflowNotVisible = g.offsetTop === -5, j.doesNotIncludeMarginInBodyOffset = 
      u.offsetTop !== m, a.getComputedStyle && (p.style.marginTop = "1%", b.pixelMargin = (a.getComputedStyle(p, null) || {marginTop:0}).marginTop !== "1%"), typeof d.style.zoom != "undefined" && (d.style.zoom = 1), u.removeChild(d), l = p = d = null, f.extend(b, j))
    });
    return b
  }();
  var j = /^(?:\{.*\}|\[.*\])$/, k = /([A-Z])/g;
  f.extend({cache:{}, uuid:0, expando:"jQuery" + (f.fn.jquery + Math.random()).replace(/\D/g, ""), noData:{embed:!0, object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000", applet:!0}, hasData:function(a) {
    a = a.nodeType ? f.cache[a[f.expando]] : a[f.expando];
    return!!a && !m(a)
  }, data:function(a, c, d, e) {
    if(!!f.acceptData(a)) {
      var g, h, i, j = f.expando, k = typeof c == "string", l = a.nodeType, m = l ? f.cache : a, n = l ? a[j] : a[j] && j, o = c === "events";
      if((!n || !m[n] || !o && !e && !m[n].data) && k && d === b) {
        return
      }
      n || (l ? a[j] = n = ++f.uuid : n = j), m[n] || (m[n] = {}, l || (m[n].toJSON = f.noop));
      if(typeof c == "object" || typeof c == "function") {
        e ? m[n] = f.extend(m[n], c) : m[n].data = f.extend(m[n].data, c)
      }
      g = h = m[n], e || (h.data || (h.data = {}), h = h.data), d !== b && (h[f.camelCase(c)] = d);
      if(o && !h[c]) {
        return g.events
      }
      k ? (i = h[c], i == null && (i = h[f.camelCase(c)])) : i = h;
      return i
    }
  }, removeData:function(a, b, c) {
    if(!!f.acceptData(a)) {
      var d, e, g, h = f.expando, i = a.nodeType, j = i ? f.cache : a, k = i ? a[h] : h;
      if(!j[k]) {
        return
      }
      if(b) {
        d = c ? j[k] : j[k].data;
        if(d) {
          f.isArray(b) || (b in d ? b = [b] : (b = f.camelCase(b), b in d ? b = [b] : b = b.split(" ")));
          for(e = 0, g = b.length;e < g;e++) {
            delete d[b[e]]
          }
          if(!(c ? m : f.isEmptyObject)(d)) {
            return
          }
        }
      }
      if(!c) {
        delete j[k].data;
        if(!m(j[k])) {
          return
        }
      }
      f.support.deleteExpando || !j.setInterval ? delete j[k] : j[k] = null, i && (f.support.deleteExpando ? delete a[h] : a.removeAttribute ? a.removeAttribute(h) : a[h] = null)
    }
  }, _data:function(a, b, c) {
    return f.data(a, b, c, !0)
  }, acceptData:function(a) {
    if(a.nodeName) {
      var b = f.noData[a.nodeName.toLowerCase()];
      if(b) {
        return b !== !0 && a.getAttribute("classid") === b
      }
    }
    return!0
  }}), f.fn.extend({data:function(a, c) {
    var d, e, g, h, i, j = this[0], k = 0, m = null;
    if(a === b) {
      if(this.length) {
        m = f.data(j);
        if(j.nodeType === 1 && !f._data(j, "parsedAttrs")) {
          g = j.attributes;
          for(i = g.length;k < i;k++) {
            h = g[k].name, h.indexOf("data-") === 0 && (h = f.camelCase(h.substring(5)), l(j, h, m[h]))
          }
          f._data(j, "parsedAttrs", !0)
        }
      }
      return m
    }
    if(typeof a == "object") {
      return this.each(function() {
        f.data(this, a)
      })
    }
    d = a.split(".", 2), d[1] = d[1] ? "." + d[1] : "", e = d[1] + "!";
    return f.access(this, function(c) {
      if(c === b) {
        m = this.triggerHandler("getData" + e, [d[0]]), m === b && j && (m = f.data(j, a), m = l(j, a, m));
        return m === b && d[1] ? this.data(d[0]) : m
      }
      d[1] = c, this.each(function() {
        var b = f(this);
        b.triggerHandler("setData" + e, d), f.data(this, a, c), b.triggerHandler("changeData" + e, d)
      })
    }, null, c, arguments.length > 1, null, !1)
  }, removeData:function(a) {
    return this.each(function() {
      f.removeData(this, a)
    })
  }}), f.extend({_mark:function(a, b) {
    a && (b = (b || "fx") + "mark", f._data(a, b, (f._data(a, b) || 0) + 1))
  }, _unmark:function(a, b, c) {
    a !== !0 && (c = b, b = a, a = !1);
    if(b) {
      c = c || "fx";
      var d = c + "mark", e = a ? 0 : (f._data(b, d) || 1) - 1;
      e ? f._data(b, d, e) : (f.removeData(b, d, !0), n(b, c, "mark"))
    }
  }, queue:function(a, b, c) {
    var d;
    if(a) {
      b = (b || "fx") + "queue", d = f._data(a, b), c && (!d || f.isArray(c) ? d = f._data(a, b, f.makeArray(c)) : d.push(c));
      return d || []
    }
  }, dequeue:function(a, b) {
    b = b || "fx";
    var c = f.queue(a, b), d = c.shift(), e = {};
    d === "inprogress" && (d = c.shift()), d && (b === "fx" && c.unshift("inprogress"), f._data(a, b + ".run", e), d.call(a, function() {
      f.dequeue(a, b)
    }, e)), c.length || (f.removeData(a, b + "queue " + b + ".run", !0), n(a, b, "queue"))
  }}), f.fn.extend({queue:function(a, c) {
    var d = 2;
    typeof a != "string" && (c = a, a = "fx", d--);
    if(arguments.length < d) {
      return f.queue(this[0], a)
    }
    return c === b ? this : this.each(function() {
      var b = f.queue(this, a, c);
      a === "fx" && b[0] !== "inprogress" && f.dequeue(this, a)
    })
  }, dequeue:function(a) {
    return this.each(function() {
      f.dequeue(this, a)
    })
  }, delay:function(a, b) {
    a = f.fx ? f.fx.speeds[a] || a : a, b = b || "fx";
    return this.queue(b, function(b, c) {
      var d = setTimeout(b, a);
      c.stop = function() {
        clearTimeout(d)
      }
    })
  }, clearQueue:function(a) {
    return this.queue(a || "fx", [])
  }, promise:function(a, c) {
    function m() {
      --h || d.resolveWith(e, [e])
    }
    typeof a != "string" && (c = a, a = b), a = a || "fx";
    var d = f.Deferred(), e = this, g = e.length, h = 1, i = a + "defer", j = a + "queue", k = a + "mark", l;
    while(g--) {
      if(l = f.data(e[g], i, b, !0) || (f.data(e[g], j, b, !0) || f.data(e[g], k, b, !0)) && f.data(e[g], i, f.Callbacks("once memory"), !0)) {
        h++, l.add(m)
      }
    }
    m();
    return d.promise(c)
  }});
  var o = /[\n\t\r]/g, p = /\s+/, q = /\r/g, r = /^(?:button|input)$/i, s = /^(?:button|input|object|select|textarea)$/i, t = /^a(?:rea)?$/i, u = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, v = f.support.getSetAttribute, w, x, y;
  f.fn.extend({attr:function(a, b) {
    return f.access(this, f.attr, a, b, arguments.length > 1)
  }, removeAttr:function(a) {
    return this.each(function() {
      f.removeAttr(this, a)
    })
  }, prop:function(a, b) {
    return f.access(this, f.prop, a, b, arguments.length > 1)
  }, removeProp:function(a) {
    a = f.propFix[a] || a;
    return this.each(function() {
      try {
        this[a] = b, delete this[a]
      }catch(c) {
      }
    })
  }, addClass:function(a) {
    var b, c, d, e, g, h, i;
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).addClass(a.call(this, b, this.className))
      })
    }
    if(a && typeof a == "string") {
      b = a.split(p);
      for(c = 0, d = this.length;c < d;c++) {
        e = this[c];
        if(e.nodeType === 1) {
          if(!e.className && b.length === 1) {
            e.className = a
          }else {
            g = " " + e.className + " ";
            for(h = 0, i = b.length;h < i;h++) {
              ~g.indexOf(" " + b[h] + " ") || (g += b[h] + " ")
            }
            e.className = f.trim(g)
          }
        }
      }
    }
    return this
  }, removeClass:function(a) {
    var c, d, e, g, h, i, j;
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).removeClass(a.call(this, b, this.className))
      })
    }
    if(a && typeof a == "string" || a === b) {
      c = (a || "").split(p);
      for(d = 0, e = this.length;d < e;d++) {
        g = this[d];
        if(g.nodeType === 1 && g.className) {
          if(a) {
            h = (" " + g.className + " ").replace(o, " ");
            for(i = 0, j = c.length;i < j;i++) {
              h = h.replace(" " + c[i] + " ", " ")
            }
            g.className = f.trim(h)
          }else {
            g.className = ""
          }
        }
      }
    }
    return this
  }, toggleClass:function(a, b) {
    var c = typeof a, d = typeof b == "boolean";
    if(f.isFunction(a)) {
      return this.each(function(c) {
        f(this).toggleClass(a.call(this, c, this.className, b), b)
      })
    }
    return this.each(function() {
      if(c === "string") {
        var e, g = 0, h = f(this), i = b, j = a.split(p);
        while(e = j[g++]) {
          i = d ? i : !h.hasClass(e), h[i ? "addClass" : "removeClass"](e)
        }
      }else {
        if(c === "undefined" || c === "boolean") {
          this.className && f._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : f._data(this, "__className__") || ""
        }
      }
    })
  }, hasClass:function(a) {
    var b = " " + a + " ", c = 0, d = this.length;
    for(;c < d;c++) {
      if(this[c].nodeType === 1 && (" " + this[c].className + " ").replace(o, " ").indexOf(b) > -1) {
        return!0
      }
    }
    return!1
  }, val:function(a) {
    var c, d, e, g = this[0];
    if(!!arguments.length) {
      e = f.isFunction(a);
      return this.each(function(d) {
        var g = f(this), h;
        if(this.nodeType === 1) {
          e ? h = a.call(this, d, g.val()) : h = a, h == null ? h = "" : typeof h == "number" ? h += "" : f.isArray(h) && (h = f.map(h, function(a) {
            return a == null ? "" : a + ""
          })), c = f.valHooks[this.type] || f.valHooks[this.nodeName.toLowerCase()];
          if(!c || !("set" in c) || c.set(this, h, "value") === b) {
            this.value = h
          }
        }
      })
    }
    if(g) {
      c = f.valHooks[g.type] || f.valHooks[g.nodeName.toLowerCase()];
      if(c && "get" in c && (d = c.get(g, "value")) !== b) {
        return d
      }
      d = g.value;
      return typeof d == "string" ? d.replace(q, "") : d == null ? "" : d
    }
  }}), f.extend({valHooks:{option:{get:function(a) {
    var b = a.attributes.value;
    return!b || b.specified ? a.value : a.text
  }}, select:{get:function(a) {
    var b, c, d, e, g = a.selectedIndex, h = [], i = a.options, j = a.type === "select-one";
    if(g < 0) {
      return null
    }
    c = j ? g : 0, d = j ? g + 1 : i.length;
    for(;c < d;c++) {
      e = i[c];
      if(e.selected && (f.support.optDisabled ? !e.disabled : e.getAttribute("disabled") === null) && (!e.parentNode.disabled || !f.nodeName(e.parentNode, "optgroup"))) {
        b = f(e).val();
        if(j) {
          return b
        }
        h.push(b)
      }
    }
    if(j && !h.length && i.length) {
      return f(i[g]).val()
    }
    return h
  }, set:function(a, b) {
    var c = f.makeArray(b);
    f(a).find("option").each(function() {
      this.selected = f.inArray(f(this).val(), c) >= 0
    }), c.length || (a.selectedIndex = -1);
    return c
  }}}, attrFn:{val:!0, css:!0, html:!0, text:!0, data:!0, width:!0, height:!0, offset:!0}, attr:function(a, c, d, e) {
    var g, h, i, j = a.nodeType;
    if(!!a && j !== 3 && j !== 8 && j !== 2) {
      if(e && c in f.attrFn) {
        return f(a)[c](d)
      }
      if(typeof a.getAttribute == "undefined") {
        return f.prop(a, c, d)
      }
      i = j !== 1 || !f.isXMLDoc(a), i && (c = c.toLowerCase(), h = f.attrHooks[c] || (u.test(c) ? x : w));
      if(d !== b) {
        if(d === null) {
          f.removeAttr(a, c);
          return
        }
        if(h && "set" in h && i && (g = h.set(a, d, c)) !== b) {
          return g
        }
        a.setAttribute(c, "" + d);
        return d
      }
      if(h && "get" in h && i && (g = h.get(a, c)) !== null) {
        return g
      }
      g = a.getAttribute(c);
      return g === null ? b : g
    }
  }, removeAttr:function(a, b) {
    var c, d, e, g, h, i = 0;
    if(b && a.nodeType === 1) {
      d = b.toLowerCase().split(p), g = d.length;
      for(;i < g;i++) {
        e = d[i], e && (c = f.propFix[e] || e, h = u.test(e), h || f.attr(a, e, ""), a.removeAttribute(v ? e : c), h && c in a && (a[c] = !1))
      }
    }
  }, attrHooks:{type:{set:function(a, b) {
    if(r.test(a.nodeName) && a.parentNode) {
      f.error("type property can't be changed")
    }else {
      if(!f.support.radioValue && b === "radio" && f.nodeName(a, "input")) {
        var c = a.value;
        a.setAttribute("type", b), c && (a.value = c);
        return b
      }
    }
  }}, value:{get:function(a, b) {
    if(w && f.nodeName(a, "button")) {
      return w.get(a, b)
    }
    return b in a ? a.value : null
  }, set:function(a, b, c) {
    if(w && f.nodeName(a, "button")) {
      return w.set(a, b, c)
    }
    a.value = b
  }}}, propFix:{tabindex:"tabIndex", readonly:"readOnly", "for":"htmlFor", "class":"className", maxlength:"maxLength", cellspacing:"cellSpacing", cellpadding:"cellPadding", rowspan:"rowSpan", colspan:"colSpan", usemap:"useMap", frameborder:"frameBorder", contenteditable:"contentEditable"}, prop:function(a, c, d) {
    var e, g, h, i = a.nodeType;
    if(!!a && i !== 3 && i !== 8 && i !== 2) {
      h = i !== 1 || !f.isXMLDoc(a), h && (c = f.propFix[c] || c, g = f.propHooks[c]);
      return d !== b ? g && "set" in g && (e = g.set(a, d, c)) !== b ? e : a[c] = d : g && "get" in g && (e = g.get(a, c)) !== null ? e : a[c]
    }
  }, propHooks:{tabIndex:{get:function(a) {
    var c = a.getAttributeNode("tabindex");
    return c && c.specified ? parseInt(c.value, 10) : s.test(a.nodeName) || t.test(a.nodeName) && a.href ? 0 : b
  }}}}), f.attrHooks.tabindex = f.propHooks.tabIndex, x = {get:function(a, c) {
    var d, e = f.prop(a, c);
    return e === !0 || typeof e != "boolean" && (d = a.getAttributeNode(c)) && d.nodeValue !== !1 ? c.toLowerCase() : b
  }, set:function(a, b, c) {
    var d;
    b === !1 ? f.removeAttr(a, c) : (d = f.propFix[c] || c, d in a && (a[d] = !0), a.setAttribute(c, c.toLowerCase()));
    return c
  }}, v || (y = {name:!0, id:!0, coords:!0}, w = f.valHooks.button = {get:function(a, c) {
    var d;
    d = a.getAttributeNode(c);
    return d && (y[c] ? d.nodeValue !== "" : d.specified) ? d.nodeValue : b
  }, set:function(a, b, d) {
    var e = a.getAttributeNode(d);
    e || (e = c.createAttribute(d), a.setAttributeNode(e));
    return e.nodeValue = b + ""
  }}, f.attrHooks.tabindex.set = w.set, f.each(["width", "height"], function(a, b) {
    f.attrHooks[b] = f.extend(f.attrHooks[b], {set:function(a, c) {
      if(c === "") {
        a.setAttribute(b, "auto");
        return c
      }
    }})
  }), f.attrHooks.contenteditable = {get:w.get, set:function(a, b, c) {
    b === "" && (b = "false"), w.set(a, b, c)
  }}), f.support.hrefNormalized || f.each(["href", "src", "width", "height"], function(a, c) {
    f.attrHooks[c] = f.extend(f.attrHooks[c], {get:function(a) {
      var d = a.getAttribute(c, 2);
      return d === null ? b : d
    }})
  }), f.support.style || (f.attrHooks.style = {get:function(a) {
    return a.style.cssText.toLowerCase() || b
  }, set:function(a, b) {
    return a.style.cssText = "" + b
  }}), f.support.optSelected || (f.propHooks.selected = f.extend(f.propHooks.selected, {get:function(a) {
    var b = a.parentNode;
    b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex);
    return null
  }})), f.support.enctype || (f.propFix.enctype = "encoding"), f.support.checkOn || f.each(["radio", "checkbox"], function() {
    f.valHooks[this] = {get:function(a) {
      return a.getAttribute("value") === null ? "on" : a.value
    }}
  }), f.each(["radio", "checkbox"], function() {
    f.valHooks[this] = f.extend(f.valHooks[this], {set:function(a, b) {
      if(f.isArray(b)) {
        return a.checked = f.inArray(f(a).val(), b) >= 0
      }
    }})
  });
  var z = /^(?:textarea|input|select)$/i, A = /^([^\.]*)?(?:\.(.+))?$/, B = /(?:^|\s)hover(\.\S+)?\b/, C = /^key/, D = /^(?:mouse|contextmenu)|click/, E = /^(?:focusinfocus|focusoutblur)$/, F = /^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/, G = function(a) {
    var b = F.exec(a);
    b && (b[1] = (b[1] || "").toLowerCase(), b[3] = b[3] && new RegExp("(?:^|\\s)" + b[3] + "(?:\\s|$)"));
    return b
  }, H = function(a, b) {
    var c = a.attributes || {};
    return(!b[1] || a.nodeName.toLowerCase() === b[1]) && (!b[2] || (c.id || {}).value === b[2]) && (!b[3] || b[3].test((c["class"] || {}).value))
  }, I = function(a) {
    return f.event.special.hover ? a : a.replace(B, "mouseenter$1 mouseleave$1")
  };
  f.event = {add:function(a, c, d, e, g) {
    var h, i, j, k, l, m, n, o, p, q, r, s;
    if(!(a.nodeType === 3 || a.nodeType === 8 || !c || !d || !(h = f._data(a)))) {
      d.handler && (p = d, d = p.handler, g = p.selector), d.guid || (d.guid = f.guid++), j = h.events, j || (h.events = j = {}), i = h.handle, i || (h.handle = i = function(a) {
        return typeof f != "undefined" && (!a || f.event.triggered !== a.type) ? f.event.dispatch.apply(i.elem, arguments) : b
      }, i.elem = a), c = f.trim(I(c)).split(" ");
      for(k = 0;k < c.length;k++) {
        l = A.exec(c[k]) || [], m = l[1], n = (l[2] || "").split(".").sort(), s = f.event.special[m] || {}, m = (g ? s.delegateType : s.bindType) || m, s = f.event.special[m] || {}, o = f.extend({type:m, origType:l[1], data:e, handler:d, guid:d.guid, selector:g, quick:g && G(g), namespace:n.join(".")}, p), r = j[m];
        if(!r) {
          r = j[m] = [], r.delegateCount = 0;
          if(!s.setup || s.setup.call(a, e, n, i) === !1) {
            a.addEventListener ? a.addEventListener(m, i, !1) : a.attachEvent && a.attachEvent("on" + m, i)
          }
        }
        s.add && (s.add.call(a, o), o.handler.guid || (o.handler.guid = d.guid)), g ? r.splice(r.delegateCount++, 0, o) : r.push(o), f.event.global[m] = !0
      }
      a = null
    }
  }, global:{}, remove:function(a, b, c, d, e) {
    var g = f.hasData(a) && f._data(a), h, i, j, k, l, m, n, o, p, q, r, s;
    if(!!g && !!(o = g.events)) {
      b = f.trim(I(b || "")).split(" ");
      for(h = 0;h < b.length;h++) {
        i = A.exec(b[h]) || [], j = k = i[1], l = i[2];
        if(!j) {
          for(j in o) {
            f.event.remove(a, j + b[h], c, d, !0)
          }
          continue
        }
        p = f.event.special[j] || {}, j = (d ? p.delegateType : p.bindType) || j, r = o[j] || [], m = r.length, l = l ? new RegExp("(^|\\.)" + l.split(".").sort().join("\\.(?:.*\\.)?") + "(\\.|$)") : null;
        for(n = 0;n < r.length;n++) {
          s = r[n], (e || k === s.origType) && (!c || c.guid === s.guid) && (!l || l.test(s.namespace)) && (!d || d === s.selector || d === "**" && s.selector) && (r.splice(n--, 1), s.selector && r.delegateCount--, p.remove && p.remove.call(a, s))
        }
        r.length === 0 && m !== r.length && ((!p.teardown || p.teardown.call(a, l) === !1) && f.removeEvent(a, j, g.handle), delete o[j])
      }
      f.isEmptyObject(o) && (q = g.handle, q && (q.elem = null), f.removeData(a, ["events", "handle"], !0))
    }
  }, customEvent:{getData:!0, setData:!0, changeData:!0}, trigger:function(c, d, e, g) {
    if(!e || e.nodeType !== 3 && e.nodeType !== 8) {
      var h = c.type || c, i = [], j, k, l, m, n, o, p, q, r, s;
      if(E.test(h + f.event.triggered)) {
        return
      }
      h.indexOf("!") >= 0 && (h = h.slice(0, -1), k = !0), h.indexOf(".") >= 0 && (i = h.split("."), h = i.shift(), i.sort());
      if((!e || f.event.customEvent[h]) && !f.event.global[h]) {
        return
      }
      c = typeof c == "object" ? c[f.expando] ? c : new f.Event(h, c) : new f.Event(h), c.type = h, c.isTrigger = !0, c.exclusive = k, c.namespace = i.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + i.join("\\.(?:.*\\.)?") + "(\\.|$)") : null, o = h.indexOf(":") < 0 ? "on" + h : "";
      if(!e) {
        j = f.cache;
        for(l in j) {
          j[l].events && j[l].events[h] && f.event.trigger(c, d, j[l].handle.elem, !0)
        }
        return
      }
      c.result = b, c.target || (c.target = e), d = d != null ? f.makeArray(d) : [], d.unshift(c), p = f.event.special[h] || {};
      if(p.trigger && p.trigger.apply(e, d) === !1) {
        return
      }
      r = [[e, p.bindType || h]];
      if(!g && !p.noBubble && !f.isWindow(e)) {
        s = p.delegateType || h, m = E.test(s + h) ? e : e.parentNode, n = null;
        for(;m;m = m.parentNode) {
          r.push([m, s]), n = m
        }
        n && n === e.ownerDocument && r.push([n.defaultView || n.parentWindow || a, s])
      }
      for(l = 0;l < r.length && !c.isPropagationStopped();l++) {
        m = r[l][0], c.type = r[l][1], q = (f._data(m, "events") || {})[c.type] && f._data(m, "handle"), q && q.apply(m, d), q = o && m[o], q && f.acceptData(m) && q.apply(m, d) === !1 && c.preventDefault()
      }
      c.type = h, !g && !c.isDefaultPrevented() && (!p._default || p._default.apply(e.ownerDocument, d) === !1) && (h !== "click" || !f.nodeName(e, "a")) && f.acceptData(e) && o && e[h] && (h !== "focus" && h !== "blur" || c.target.offsetWidth !== 0) && !f.isWindow(e) && (n = e[o], n && (e[o] = null), f.event.triggered = h, e[h](), f.event.triggered = b, n && (e[o] = n));
      return c.result
    }
  }, dispatch:function(c) {
    c = f.event.fix(c || a.event);
    var d = (f._data(this, "events") || {})[c.type] || [], e = d.delegateCount, g = [].slice.call(arguments, 0), h = !c.exclusive && !c.namespace, i = f.event.special[c.type] || {}, j = [], k, l, m, n, o, p, q, r, s, t, u;
    g[0] = c, c.delegateTarget = this;
    if(!i.preDispatch || i.preDispatch.call(this, c) !== !1) {
      if(e && (!c.button || c.type !== "click")) {
        n = f(this), n.context = this.ownerDocument || this;
        for(m = c.target;m != this;m = m.parentNode || this) {
          if(m.disabled !== !0) {
            p = {}, r = [], n[0] = m;
            for(k = 0;k < e;k++) {
              s = d[k], t = s.selector, p[t] === b && (p[t] = s.quick ? H(m, s.quick) : n.is(t)), p[t] && r.push(s)
            }
            r.length && j.push({elem:m, matches:r})
          }
        }
      }
      d.length > e && j.push({elem:this, matches:d.slice(e)});
      for(k = 0;k < j.length && !c.isPropagationStopped();k++) {
        q = j[k], c.currentTarget = q.elem;
        for(l = 0;l < q.matches.length && !c.isImmediatePropagationStopped();l++) {
          s = q.matches[l];
          if(h || !c.namespace && !s.namespace || c.namespace_re && c.namespace_re.test(s.namespace)) {
            c.data = s.data, c.handleObj = s, o = ((f.event.special[s.origType] || {}).handle || s.handler).apply(q.elem, g), o !== b && (c.result = o, o === !1 && (c.preventDefault(), c.stopPropagation()))
          }
        }
      }
      i.postDispatch && i.postDispatch.call(this, c);
      return c.result
    }
  }, props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks:{}, keyHooks:{props:"char charCode key keyCode".split(" "), filter:function(a, b) {
    a.which == null && (a.which = b.charCode != null ? b.charCode : b.keyCode);
    return a
  }}, mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter:function(a, d) {
    var e, f, g, h = d.button, i = d.fromElement;
    a.pageX == null && d.clientX != null && (e = a.target.ownerDocument || c, f = e.documentElement, g = e.body, a.pageX = d.clientX + (f && f.scrollLeft || g && g.scrollLeft || 0) - (f && f.clientLeft || g && g.clientLeft || 0), a.pageY = d.clientY + (f && f.scrollTop || g && g.scrollTop || 0) - (f && f.clientTop || g && g.clientTop || 0)), !a.relatedTarget && i && (a.relatedTarget = i === a.target ? d.toElement : i), !a.which && h !== b && (a.which = h & 1 ? 1 : h & 2 ? 3 : h & 4 ? 2 : 0);
    return a
  }}, fix:function(a) {
    if(a[f.expando]) {
      return a
    }
    var d, e, g = a, h = f.event.fixHooks[a.type] || {}, i = h.props ? this.props.concat(h.props) : this.props;
    a = f.Event(g);
    for(d = i.length;d;) {
      e = i[--d], a[e] = g[e]
    }
    a.target || (a.target = g.srcElement || c), a.target.nodeType === 3 && (a.target = a.target.parentNode), a.metaKey === b && (a.metaKey = a.ctrlKey);
    return h.filter ? h.filter(a, g) : a
  }, special:{ready:{setup:f.bindReady}, load:{noBubble:!0}, focus:{delegateType:"focusin"}, blur:{delegateType:"focusout"}, beforeunload:{setup:function(a, b, c) {
    f.isWindow(this) && (this.onbeforeunload = c)
  }, teardown:function(a, b) {
    this.onbeforeunload === b && (this.onbeforeunload = null)
  }}}, simulate:function(a, b, c, d) {
    var e = f.extend(new f.Event, c, {type:a, isSimulated:!0, originalEvent:{}});
    d ? f.event.trigger(e, null, b) : f.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
  }}, f.event.handle = f.event.dispatch, f.removeEvent = c.removeEventListener ? function(a, b, c) {
    a.removeEventListener && a.removeEventListener(b, c, !1)
  } : function(a, b, c) {
    a.detachEvent && a.detachEvent("on" + b, c)
  }, f.Event = function(a, b) {
    if(!(this instanceof f.Event)) {
      return new f.Event(a, b)
    }
    a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault() ? K : J) : this.type = a, b && f.extend(this, b), this.timeStamp = a && a.timeStamp || f.now(), this[f.expando] = !0
  }, f.Event.prototype = {preventDefault:function() {
    this.isDefaultPrevented = K;
    var a = this.originalEvent;
    !a || (a.preventDefault ? a.preventDefault() : a.returnValue = !1)
  }, stopPropagation:function() {
    this.isPropagationStopped = K;
    var a = this.originalEvent;
    !a || (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0)
  }, stopImmediatePropagation:function() {
    this.isImmediatePropagationStopped = K, this.stopPropagation()
  }, isDefaultPrevented:J, isPropagationStopped:J, isImmediatePropagationStopped:J}, f.each({mouseenter:"mouseover", mouseleave:"mouseout"}, function(a, b) {
    f.event.special[a] = {delegateType:b, bindType:b, handle:function(a) {
      var c = this, d = a.relatedTarget, e = a.handleObj, g = e.selector, h;
      if(!d || d !== c && !f.contains(c, d)) {
        a.type = e.origType, h = e.handler.apply(this, arguments), a.type = b
      }
      return h
    }}
  }), f.support.submitBubbles || (f.event.special.submit = {setup:function() {
    if(f.nodeName(this, "form")) {
      return!1
    }
    f.event.add(this, "click._submit keypress._submit", function(a) {
      var c = a.target, d = f.nodeName(c, "input") || f.nodeName(c, "button") ? c.form : b;
      d && !d._submit_attached && (f.event.add(d, "submit._submit", function(a) {
        a._submit_bubble = !0
      }), d._submit_attached = !0)
    })
  }, postDispatch:function(a) {
    a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && f.event.simulate("submit", this.parentNode, a, !0))
  }, teardown:function() {
    if(f.nodeName(this, "form")) {
      return!1
    }
    f.event.remove(this, "._submit")
  }}), f.support.changeBubbles || (f.event.special.change = {setup:function() {
    if(z.test(this.nodeName)) {
      if(this.type === "checkbox" || this.type === "radio") {
        f.event.add(this, "propertychange._change", function(a) {
          a.originalEvent.propertyName === "checked" && (this._just_changed = !0)
        }), f.event.add(this, "click._change", function(a) {
          this._just_changed && !a.isTrigger && (this._just_changed = !1, f.event.simulate("change", this, a, !0))
        })
      }
      return!1
    }
    f.event.add(this, "beforeactivate._change", function(a) {
      var b = a.target;
      z.test(b.nodeName) && !b._change_attached && (f.event.add(b, "change._change", function(a) {
        this.parentNode && !a.isSimulated && !a.isTrigger && f.event.simulate("change", this.parentNode, a, !0)
      }), b._change_attached = !0)
    })
  }, handle:function(a) {
    var b = a.target;
    if(this !== b || a.isSimulated || a.isTrigger || b.type !== "radio" && b.type !== "checkbox") {
      return a.handleObj.handler.apply(this, arguments)
    }
  }, teardown:function() {
    f.event.remove(this, "._change");
    return z.test(this.nodeName)
  }}), f.support.focusinBubbles || f.each({focus:"focusin", blur:"focusout"}, function(a, b) {
    var d = 0, e = function(a) {
      f.event.simulate(b, a.target, f.event.fix(a), !0)
    };
    f.event.special[b] = {setup:function() {
      d++ === 0 && c.addEventListener(a, e, !0)
    }, teardown:function() {
      --d === 0 && c.removeEventListener(a, e, !0)
    }}
  }), f.fn.extend({on:function(a, c, d, e, g) {
    var h, i;
    if(typeof a == "object") {
      typeof c != "string" && (d = d || c, c = b);
      for(i in a) {
        this.on(i, c, d, a[i], g)
      }
      return this
    }
    d == null && e == null ? (e = c, d = c = b) : e == null && (typeof c == "string" ? (e = d, d = b) : (e = d, d = c, c = b));
    if(e === !1) {
      e = J
    }else {
      if(!e) {
        return this
      }
    }
    g === 1 && (h = e, e = function(a) {
      f().off(a);
      return h.apply(this, arguments)
    }, e.guid = h.guid || (h.guid = f.guid++));
    return this.each(function() {
      f.event.add(this, a, e, d, c)
    })
  }, one:function(a, b, c, d) {
    return this.on(a, b, c, d, 1)
  }, off:function(a, c, d) {
    if(a && a.preventDefault && a.handleObj) {
      var e = a.handleObj;
      f(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace : e.origType, e.selector, e.handler);
      return this
    }
    if(typeof a == "object") {
      for(var g in a) {
        this.off(g, c, a[g])
      }
      return this
    }
    if(c === !1 || typeof c == "function") {
      d = c, c = b
    }
    d === !1 && (d = J);
    return this.each(function() {
      f.event.remove(this, a, d, c)
    })
  }, bind:function(a, b, c) {
    return this.on(a, null, b, c)
  }, unbind:function(a, b) {
    return this.off(a, null, b)
  }, live:function(a, b, c) {
    f(this.context).on(a, this.selector, b, c);
    return this
  }, die:function(a, b) {
    f(this.context).off(a, this.selector || "**", b);
    return this
  }, delegate:function(a, b, c, d) {
    return this.on(b, a, c, d)
  }, undelegate:function(a, b, c) {
    return arguments.length == 1 ? this.off(a, "**") : this.off(b, a, c)
  }, trigger:function(a, b) {
    return this.each(function() {
      f.event.trigger(a, b, this)
    })
  }, triggerHandler:function(a, b) {
    if(this[0]) {
      return f.event.trigger(a, b, this[0], !0)
    }
  }, toggle:function(a) {
    var b = arguments, c = a.guid || f.guid++, d = 0, e = function(c) {
      var e = (f._data(this, "lastToggle" + a.guid) || 0) % d;
      f._data(this, "lastToggle" + a.guid, e + 1), c.preventDefault();
      return b[e].apply(this, arguments) || !1
    };
    e.guid = c;
    while(d < b.length) {
      b[d++].guid = c
    }
    return this.click(e)
  }, hover:function(a, b) {
    return this.mouseenter(a).mouseleave(b || a)
  }}), f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
    f.fn[b] = function(a, c) {
      c == null && (c = a, a = null);
      return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
    }, f.attrFn && (f.attrFn[b] = !0), C.test(b) && (f.event.fixHooks[b] = f.event.keyHooks), D.test(b) && (f.event.fixHooks[b] = f.event.mouseHooks)
  }), function() {
    function x(a, b, c, e, f, g) {
      for(var h = 0, i = e.length;h < i;h++) {
        var j = e[h];
        if(j) {
          var k = !1;
          j = j[a];
          while(j) {
            if(j[d] === c) {
              k = e[j.sizset];
              break
            }
            if(j.nodeType === 1) {
              g || (j[d] = c, j.sizset = h);
              if(typeof b != "string") {
                if(j === b) {
                  k = !0;
                  break
                }
              }else {
                if(m.filter(b, [j]).length > 0) {
                  k = j;
                  break
                }
              }
            }
            j = j[a]
          }
          e[h] = k
        }
      }
    }
    function w(a, b, c, e, f, g) {
      for(var h = 0, i = e.length;h < i;h++) {
        var j = e[h];
        if(j) {
          var k = !1;
          j = j[a];
          while(j) {
            if(j[d] === c) {
              k = e[j.sizset];
              break
            }
            j.nodeType === 1 && !g && (j[d] = c, j.sizset = h);
            if(j.nodeName.toLowerCase() === b) {
              k = j;
              break
            }
            j = j[a]
          }
          e[h] = k
        }
      }
    }
    var a = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, d = "sizcache" + (Math.random() + "").replace(".", ""), e = 0, g = Object.prototype.toString, h = !1, i = !0, j = /\\/g, k = /\r\n/g, l = /\W/;
    [0, 0].sort(function() {
      i = !1;
      return 0
    });
    var m = function(b, d, e, f) {
      e = e || [], d = d || c;
      var h = d;
      if(d.nodeType !== 1 && d.nodeType !== 9) {
        return[]
      }
      if(!b || typeof b != "string") {
        return e
      }
      var i, j, k, l, n, q, r, t, u = !0, v = m.isXML(d), w = [], x = b;
      do {
        a.exec(""), i = a.exec(x);
        if(i) {
          x = i[3], w.push(i[1]);
          if(i[2]) {
            l = i[3];
            break
          }
        }
      }while(i);
      if(w.length > 1 && p.exec(b)) {
        if(w.length === 2 && o.relative[w[0]]) {
          j = y(w[0] + w[1], d, f)
        }else {
          j = o.relative[w[0]] ? [d] : m(w.shift(), d);
          while(w.length) {
            b = w.shift(), o.relative[b] && (b += w.shift()), j = y(b, j, f)
          }
        }
      }else {
        !f && w.length > 1 && d.nodeType === 9 && !v && o.match.ID.test(w[0]) && !o.match.ID.test(w[w.length - 1]) && (n = m.find(w.shift(), d, v), d = n.expr ? m.filter(n.expr, n.set)[0] : n.set[0]);
        if(d) {
          n = f ? {expr:w.pop(), set:s(f)} : m.find(w.pop(), w.length === 1 && (w[0] === "~" || w[0] === "+") && d.parentNode ? d.parentNode : d, v), j = n.expr ? m.filter(n.expr, n.set) : n.set, w.length > 0 ? k = s(j) : u = !1;
          while(w.length) {
            q = w.pop(), r = q, o.relative[q] ? r = w.pop() : q = "", r == null && (r = d), o.relative[q](k, r, v)
          }
        }else {
          k = w = []
        }
      }
      k || (k = j), k || m.error(q || b);
      if(g.call(k) === "[object Array]") {
        if(!u) {
          e.push.apply(e, k)
        }else {
          if(d && d.nodeType === 1) {
            for(t = 0;k[t] != null;t++) {
              k[t] && (k[t] === !0 || k[t].nodeType === 1 && m.contains(d, k[t])) && e.push(j[t])
            }
          }else {
            for(t = 0;k[t] != null;t++) {
              k[t] && k[t].nodeType === 1 && e.push(j[t])
            }
          }
        }
      }else {
        s(k, e)
      }
      l && (m(l, h, e, f), m.uniqueSort(e));
      return e
    };
    m.uniqueSort = function(a) {
      if(u) {
        h = i, a.sort(u);
        if(h) {
          for(var b = 1;b < a.length;b++) {
            a[b] === a[b - 1] && a.splice(b--, 1)
          }
        }
      }
      return a
    }, m.matches = function(a, b) {
      return m(a, null, null, b)
    }, m.matchesSelector = function(a, b) {
      return m(b, null, null, [a]).length > 0
    }, m.find = function(a, b, c) {
      var d, e, f, g, h, i;
      if(!a) {
        return[]
      }
      for(e = 0, f = o.order.length;e < f;e++) {
        h = o.order[e];
        if(g = o.leftMatch[h].exec(a)) {
          i = g[1], g.splice(1, 1);
          if(i.substr(i.length - 1) !== "\\") {
            g[1] = (g[1] || "").replace(j, ""), d = o.find[h](g, b, c);
            if(d != null) {
              a = a.replace(o.match[h], "");
              break
            }
          }
        }
      }
      d || (d = typeof b.getElementsByTagName != "undefined" ? b.getElementsByTagName("*") : []);
      return{set:d, expr:a}
    }, m.filter = function(a, c, d, e) {
      var f, g, h, i, j, k, l, n, p, q = a, r = [], s = c, t = c && c[0] && m.isXML(c[0]);
      while(a && c.length) {
        for(h in o.filter) {
          if((f = o.leftMatch[h].exec(a)) != null && f[2]) {
            k = o.filter[h], l = f[1], g = !1, f.splice(1, 1);
            if(l.substr(l.length - 1) === "\\") {
              continue
            }
            s === r && (r = []);
            if(o.preFilter[h]) {
              f = o.preFilter[h](f, s, d, r, e, t);
              if(!f) {
                g = i = !0
              }else {
                if(f === !0) {
                  continue
                }
              }
            }
            if(f) {
              for(n = 0;(j = s[n]) != null;n++) {
                j && (i = k(j, f, n, s), p = e ^ i, d && i != null ? p ? g = !0 : s[n] = !1 : p && (r.push(j), g = !0))
              }
            }
            if(i !== b) {
              d || (s = r), a = a.replace(o.match[h], "");
              if(!g) {
                return[]
              }
              break
            }
          }
        }
        if(a === q) {
          if(g == null) {
            m.error(a)
          }else {
            break
          }
        }
        q = a
      }
      return s
    }, m.error = function(a) {
      throw new Error("Syntax error, unrecognized expression: " + a);
    };
    var n = m.getText = function(a) {
      var b, c, d = a.nodeType, e = "";
      if(d) {
        if(d === 1 || d === 9 || d === 11) {
          if(typeof a.textContent == "string") {
            return a.textContent
          }
          if(typeof a.innerText == "string") {
            return a.innerText.replace(k, "")
          }
          for(a = a.firstChild;a;a = a.nextSibling) {
            e += n(a)
          }
        }else {
          if(d === 3 || d === 4) {
            return a.nodeValue
          }
        }
      }else {
        for(b = 0;c = a[b];b++) {
          c.nodeType !== 8 && (e += n(c))
        }
      }
      return e
    }, o = m.selectors = {order:["ID", "NAME", "TAG"], match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/, ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/, TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/, CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/, POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/, 
    PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/}, leftMatch:{}, attrMap:{"class":"className", "for":"htmlFor"}, attrHandle:{href:function(a) {
      return a.getAttribute("href")
    }, type:function(a) {
      return a.getAttribute("type")
    }}, relative:{"+":function(a, b) {
      var c = typeof b == "string", d = c && !l.test(b), e = c && !d;
      d && (b = b.toLowerCase());
      for(var f = 0, g = a.length, h;f < g;f++) {
        if(h = a[f]) {
          while((h = h.previousSibling) && h.nodeType !== 1) {
          }
          a[f] = e || h && h.nodeName.toLowerCase() === b ? h || !1 : h === b
        }
      }
      e && m.filter(b, a, !0)
    }, ">":function(a, b) {
      var c, d = typeof b == "string", e = 0, f = a.length;
      if(d && !l.test(b)) {
        b = b.toLowerCase();
        for(;e < f;e++) {
          c = a[e];
          if(c) {
            var g = c.parentNode;
            a[e] = g.nodeName.toLowerCase() === b ? g : !1
          }
        }
      }else {
        for(;e < f;e++) {
          c = a[e], c && (a[e] = d ? c.parentNode : c.parentNode === b)
        }
        d && m.filter(b, a, !0)
      }
    }, "":function(a, b, c) {
      var d, f = e++, g = x;
      typeof b == "string" && !l.test(b) && (b = b.toLowerCase(), d = b, g = w), g("parentNode", b, f, a, d, c)
    }, "~":function(a, b, c) {
      var d, f = e++, g = x;
      typeof b == "string" && !l.test(b) && (b = b.toLowerCase(), d = b, g = w), g("previousSibling", b, f, a, d, c)
    }}, find:{ID:function(a, b, c) {
      if(typeof b.getElementById != "undefined" && !c) {
        var d = b.getElementById(a[1]);
        return d && d.parentNode ? [d] : []
      }
    }, NAME:function(a, b) {
      if(typeof b.getElementsByName != "undefined") {
        var c = [], d = b.getElementsByName(a[1]);
        for(var e = 0, f = d.length;e < f;e++) {
          d[e].getAttribute("name") === a[1] && c.push(d[e])
        }
        return c.length === 0 ? null : c
      }
    }, TAG:function(a, b) {
      if(typeof b.getElementsByTagName != "undefined") {
        return b.getElementsByTagName(a[1])
      }
    }}, preFilter:{CLASS:function(a, b, c, d, e, f) {
      a = " " + a[1].replace(j, "") + " ";
      if(f) {
        return a
      }
      for(var g = 0, h;(h = b[g]) != null;g++) {
        h && (e ^ (h.className && (" " + h.className + " ").replace(/[\t\n\r]/g, " ").indexOf(a) >= 0) ? c || d.push(h) : c && (b[g] = !1))
      }
      return!1
    }, ID:function(a) {
      return a[1].replace(j, "")
    }, TAG:function(a, b) {
      return a[1].replace(j, "").toLowerCase()
    }, CHILD:function(a) {
      if(a[1] === "nth") {
        a[2] || m.error(a[0]), a[2] = a[2].replace(/^\+|\s*/g, "");
        var b = /(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2] === "even" && "2n" || a[2] === "odd" && "2n+1" || !/\D/.test(a[2]) && "0n+" + a[2] || a[2]);
        a[2] = b[1] + (b[2] || 1) - 0, a[3] = b[3] - 0
      }else {
        a[2] && m.error(a[0])
      }
      a[0] = e++;
      return a
    }, ATTR:function(a, b, c, d, e, f) {
      var g = a[1] = a[1].replace(j, "");
      !f && o.attrMap[g] && (a[1] = o.attrMap[g]), a[4] = (a[4] || a[5] || "").replace(j, ""), a[2] === "~=" && (a[4] = " " + a[4] + " ");
      return a
    }, PSEUDO:function(b, c, d, e, f) {
      if(b[1] === "not") {
        if((a.exec(b[3]) || "").length > 1 || /^\w/.test(b[3])) {
          b[3] = m(b[3], null, null, c)
        }else {
          var g = m.filter(b[3], c, d, !0 ^ f);
          d || e.push.apply(e, g);
          return!1
        }
      }else {
        if(o.match.POS.test(b[0]) || o.match.CHILD.test(b[0])) {
          return!0
        }
      }
      return b
    }, POS:function(a) {
      a.unshift(!0);
      return a
    }}, filters:{enabled:function(a) {
      return a.disabled === !1 && a.type !== "hidden"
    }, disabled:function(a) {
      return a.disabled === !0
    }, checked:function(a) {
      return a.checked === !0
    }, selected:function(a) {
      a.parentNode && a.parentNode.selectedIndex;
      return a.selected === !0
    }, parent:function(a) {
      return!!a.firstChild
    }, empty:function(a) {
      return!a.firstChild
    }, has:function(a, b, c) {
      return!!m(c[3], a).length
    }, header:function(a) {
      return/h\d/i.test(a.nodeName)
    }, text:function(a) {
      var b = a.getAttribute("type"), c = a.type;
      return a.nodeName.toLowerCase() === "input" && "text" === c && (b === c || b === null)
    }, radio:function(a) {
      return a.nodeName.toLowerCase() === "input" && "radio" === a.type
    }, checkbox:function(a) {
      return a.nodeName.toLowerCase() === "input" && "checkbox" === a.type
    }, file:function(a) {
      return a.nodeName.toLowerCase() === "input" && "file" === a.type
    }, password:function(a) {
      return a.nodeName.toLowerCase() === "input" && "password" === a.type
    }, submit:function(a) {
      var b = a.nodeName.toLowerCase();
      return(b === "input" || b === "button") && "submit" === a.type
    }, image:function(a) {
      return a.nodeName.toLowerCase() === "input" && "image" === a.type
    }, reset:function(a) {
      var b = a.nodeName.toLowerCase();
      return(b === "input" || b === "button") && "reset" === a.type
    }, button:function(a) {
      var b = a.nodeName.toLowerCase();
      return b === "input" && "button" === a.type || b === "button"
    }, input:function(a) {
      return/input|select|textarea|button/i.test(a.nodeName)
    }, focus:function(a) {
      return a === a.ownerDocument.activeElement
    }}, setFilters:{first:function(a, b) {
      return b === 0
    }, last:function(a, b, c, d) {
      return b === d.length - 1
    }, even:function(a, b) {
      return b % 2 === 0
    }, odd:function(a, b) {
      return b % 2 === 1
    }, lt:function(a, b, c) {
      return b < c[3] - 0
    }, gt:function(a, b, c) {
      return b > c[3] - 0
    }, nth:function(a, b, c) {
      return c[3] - 0 === b
    }, eq:function(a, b, c) {
      return c[3] - 0 === b
    }}, filter:{PSEUDO:function(a, b, c, d) {
      var e = b[1], f = o.filters[e];
      if(f) {
        return f(a, c, b, d)
      }
      if(e === "contains") {
        return(a.textContent || a.innerText || n([a]) || "").indexOf(b[3]) >= 0
      }
      if(e === "not") {
        var g = b[3];
        for(var h = 0, i = g.length;h < i;h++) {
          if(g[h] === a) {
            return!1
          }
        }
        return!0
      }
      m.error(e)
    }, CHILD:function(a, b) {
      var c, e, f, g, h, i, j, k = b[1], l = a;
      switch(k) {
        case "only":
        ;
        case "first":
          while(l = l.previousSibling) {
            if(l.nodeType === 1) {
              return!1
            }
          }
          if(k === "first") {
            return!0
          }
          l = a;
        case "last":
          while(l = l.nextSibling) {
            if(l.nodeType === 1) {
              return!1
            }
          }
          return!0;
        case "nth":
          c = b[2], e = b[3];
          if(c === 1 && e === 0) {
            return!0
          }
          f = b[0], g = a.parentNode;
          if(g && (g[d] !== f || !a.nodeIndex)) {
            i = 0;
            for(l = g.firstChild;l;l = l.nextSibling) {
              l.nodeType === 1 && (l.nodeIndex = ++i)
            }
            g[d] = f
          }
          j = a.nodeIndex - e;
          return c === 0 ? j === 0 : j % c === 0 && j / c >= 0
      }
    }, ID:function(a, b) {
      return a.nodeType === 1 && a.getAttribute("id") === b
    }, TAG:function(a, b) {
      return b === "*" && a.nodeType === 1 || !!a.nodeName && a.nodeName.toLowerCase() === b
    }, CLASS:function(a, b) {
      return(" " + (a.className || a.getAttribute("class")) + " ").indexOf(b) > -1
    }, ATTR:function(a, b) {
      var c = b[1], d = m.attr ? m.attr(a, c) : o.attrHandle[c] ? o.attrHandle[c](a) : a[c] != null ? a[c] : a.getAttribute(c), e = d + "", f = b[2], g = b[4];
      return d == null ? f === "!=" : !f && m.attr ? d != null : f === "=" ? e === g : f === "*=" ? e.indexOf(g) >= 0 : f === "~=" ? (" " + e + " ").indexOf(g) >= 0 : g ? f === "!=" ? e !== g : f === "^=" ? e.indexOf(g) === 0 : f === "$=" ? e.substr(e.length - g.length) === g : f === "|=" ? e === g || e.substr(0, g.length + 1) === g + "-" : !1 : e && d !== !1
    }, POS:function(a, b, c, d) {
      var e = b[2], f = o.setFilters[e];
      if(f) {
        return f(a, c, b, d)
      }
    }}}, p = o.match.POS, q = function(a, b) {
      return"\\" + (b - 0 + 1)
    };
    for(var r in o.match) {
      o.match[r] = new RegExp(o.match[r].source + /(?![^\[]*\])(?![^\(]*\))/.source), o.leftMatch[r] = new RegExp(/(^(?:.|\r|\n)*?)/.source + o.match[r].source.replace(/\\(\d+)/g, q))
    }
    o.match.globalPOS = p;
    var s = function(a, b) {
      a = Array.prototype.slice.call(a, 0);
      if(b) {
        b.push.apply(b, a);
        return b
      }
      return a
    };
    try {
      Array.prototype.slice.call(c.documentElement.childNodes, 0)[0].nodeType
    }catch(t) {
      s = function(a, b) {
        var c = 0, d = b || [];
        if(g.call(a) === "[object Array]") {
          Array.prototype.push.apply(d, a)
        }else {
          if(typeof a.length == "number") {
            for(var e = a.length;c < e;c++) {
              d.push(a[c])
            }
          }else {
            for(;a[c];c++) {
              d.push(a[c])
            }
          }
        }
        return d
      }
    }
    var u, v;
    c.documentElement.compareDocumentPosition ? u = function(a, b) {
      if(a === b) {
        h = !0;
        return 0
      }
      if(!a.compareDocumentPosition || !b.compareDocumentPosition) {
        return a.compareDocumentPosition ? -1 : 1
      }
      return a.compareDocumentPosition(b) & 4 ? -1 : 1
    } : (u = function(a, b) {
      if(a === b) {
        h = !0;
        return 0
      }
      if(a.sourceIndex && b.sourceIndex) {
        return a.sourceIndex - b.sourceIndex
      }
      var c, d, e = [], f = [], g = a.parentNode, i = b.parentNode, j = g;
      if(g === i) {
        return v(a, b)
      }
      if(!g) {
        return-1
      }
      if(!i) {
        return 1
      }
      while(j) {
        e.unshift(j), j = j.parentNode
      }
      j = i;
      while(j) {
        f.unshift(j), j = j.parentNode
      }
      c = e.length, d = f.length;
      for(var k = 0;k < c && k < d;k++) {
        if(e[k] !== f[k]) {
          return v(e[k], f[k])
        }
      }
      return k === c ? v(a, f[k], -1) : v(e[k], b, 1)
    }, v = function(a, b, c) {
      if(a === b) {
        return c
      }
      var d = a.nextSibling;
      while(d) {
        if(d === b) {
          return-1
        }
        d = d.nextSibling
      }
      return 1
    }), function() {
      var a = c.createElement("div"), d = "script" + (new Date).getTime(), e = c.documentElement;
      a.innerHTML = "<a name='" + d + "'/>", e.insertBefore(a, e.firstChild), c.getElementById(d) && (o.find.ID = function(a, c, d) {
        if(typeof c.getElementById != "undefined" && !d) {
          var e = c.getElementById(a[1]);
          return e ? e.id === a[1] || typeof e.getAttributeNode != "undefined" && e.getAttributeNode("id").nodeValue === a[1] ? [e] : b : []
        }
      }, o.filter.ID = function(a, b) {
        var c = typeof a.getAttributeNode != "undefined" && a.getAttributeNode("id");
        return a.nodeType === 1 && c && c.nodeValue === b
      }), e.removeChild(a), e = a = null
    }(), function() {
      var a = c.createElement("div");
      a.appendChild(c.createComment("")), a.getElementsByTagName("*").length > 0 && (o.find.TAG = function(a, b) {
        var c = b.getElementsByTagName(a[1]);
        if(a[1] === "*") {
          var d = [];
          for(var e = 0;c[e];e++) {
            c[e].nodeType === 1 && d.push(c[e])
          }
          c = d
        }
        return c
      }), a.innerHTML = "<a href='#'></a>", a.firstChild && typeof a.firstChild.getAttribute != "undefined" && a.firstChild.getAttribute("href") !== "#" && (o.attrHandle.href = function(a) {
        return a.getAttribute("href", 2)
      }), a = null
    }(), c.querySelectorAll && function() {
      var a = m, b = c.createElement("div"), d = "__sizzle__";
      b.innerHTML = "<p class='TEST'></p>";
      if(!b.querySelectorAll || b.querySelectorAll(".TEST").length !== 0) {
        m = function(b, e, f, g) {
          e = e || c;
          if(!g && !m.isXML(e)) {
            var h = /^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);
            if(h && (e.nodeType === 1 || e.nodeType === 9)) {
              if(h[1]) {
                return s(e.getElementsByTagName(b), f)
              }
              if(h[2] && o.find.CLASS && e.getElementsByClassName) {
                return s(e.getElementsByClassName(h[2]), f)
              }
            }
            if(e.nodeType === 9) {
              if(b === "body" && e.body) {
                return s([e.body], f)
              }
              if(h && h[3]) {
                var i = e.getElementById(h[3]);
                if(!i || !i.parentNode) {
                  return s([], f)
                }
                if(i.id === h[3]) {
                  return s([i], f)
                }
              }
              try {
                return s(e.querySelectorAll(b), f)
              }catch(j) {
              }
            }else {
              if(e.nodeType === 1 && e.nodeName.toLowerCase() !== "object") {
                var k = e, l = e.getAttribute("id"), n = l || d, p = e.parentNode, q = /^\s*[+~]/.test(b);
                l ? n = n.replace(/'/g, "\\$&") : e.setAttribute("id", n), q && p && (e = e.parentNode);
                try {
                  if(!q || p) {
                    return s(e.querySelectorAll("[id='" + n + "'] " + b), f)
                  }
                }catch(r) {
                }finally {
                  l || k.removeAttribute("id")
                }
              }
            }
          }
          return a(b, e, f, g)
        };
        for(var e in a) {
          m[e] = a[e]
        }
        b = null
      }
    }(), function() {
      var a = c.documentElement, b = a.matchesSelector || a.mozMatchesSelector || a.webkitMatchesSelector || a.msMatchesSelector;
      if(b) {
        var d = !b.call(c.createElement("div"), "div"), e = !1;
        try {
          b.call(c.documentElement, "[test!='']:sizzle")
        }catch(f) {
          e = !0
        }
        m.matchesSelector = function(a, c) {
          c = c.replace(/\=\s*([^'"\]]*)\s*\]/g, "='$1']");
          if(!m.isXML(a)) {
            try {
              if(e || !o.match.PSEUDO.test(c) && !/!=/.test(c)) {
                var f = b.call(a, c);
                if(f || !d || a.document && a.document.nodeType !== 11) {
                  return f
                }
              }
            }catch(g) {
            }
          }
          return m(c, null, null, [a]).length > 0
        }
      }
    }(), function() {
      var a = c.createElement("div");
      a.innerHTML = "<div class='test e'></div><div class='test'></div>";
      if(!!a.getElementsByClassName && a.getElementsByClassName("e").length !== 0) {
        a.lastChild.className = "e";
        if(a.getElementsByClassName("e").length === 1) {
          return
        }
        o.order.splice(1, 0, "CLASS"), o.find.CLASS = function(a, b, c) {
          if(typeof b.getElementsByClassName != "undefined" && !c) {
            return b.getElementsByClassName(a[1])
          }
        }, a = null
      }
    }(), c.documentElement.contains ? m.contains = function(a, b) {
      return a !== b && (a.contains ? a.contains(b) : !0)
    } : c.documentElement.compareDocumentPosition ? m.contains = function(a, b) {
      return!!(a.compareDocumentPosition(b) & 16)
    } : m.contains = function() {
      return!1
    }, m.isXML = function(a) {
      var b = (a ? a.ownerDocument || a : 0).documentElement;
      return b ? b.nodeName !== "HTML" : !1
    };
    var y = function(a, b, c) {
      var d, e = [], f = "", g = b.nodeType ? [b] : b;
      while(d = o.match.PSEUDO.exec(a)) {
        f += d[0], a = a.replace(o.match.PSEUDO, "")
      }
      a = o.relative[a] ? a + "*" : a;
      for(var h = 0, i = g.length;h < i;h++) {
        m(a, g[h], e, c)
      }
      return m.filter(f, e)
    };
    m.attr = f.attr, m.selectors.attrMap = {}, f.find = m, f.expr = m.selectors, f.expr[":"] = f.expr.filters, f.unique = m.uniqueSort, f.text = m.getText, f.isXMLDoc = m.isXML, f.contains = m.contains
  }();
  var L = /Until$/, M = /^(?:parents|prevUntil|prevAll)/, N = /,/, O = /^.[^:#\[\.,]*$/, P = Array.prototype.slice, Q = f.expr.match.globalPOS, R = {children:!0, contents:!0, next:!0, prev:!0};
  f.fn.extend({find:function(a) {
    var b = this, c, d;
    if(typeof a != "string") {
      return f(a).filter(function() {
        for(c = 0, d = b.length;c < d;c++) {
          if(f.contains(b[c], this)) {
            return!0
          }
        }
      })
    }
    var e = this.pushStack("", "find", a), g, h, i;
    for(c = 0, d = this.length;c < d;c++) {
      g = e.length, f.find(a, this[c], e);
      if(c > 0) {
        for(h = g;h < e.length;h++) {
          for(i = 0;i < g;i++) {
            if(e[i] === e[h]) {
              e.splice(h--, 1);
              break
            }
          }
        }
      }
    }
    return e
  }, has:function(a) {
    var b = f(a);
    return this.filter(function() {
      for(var a = 0, c = b.length;a < c;a++) {
        if(f.contains(this, b[a])) {
          return!0
        }
      }
    })
  }, not:function(a) {
    return this.pushStack(T(this, a, !1), "not", a)
  }, filter:function(a) {
    return this.pushStack(T(this, a, !0), "filter", a)
  }, is:function(a) {
    return!!a && (typeof a == "string" ? Q.test(a) ? f(a, this.context).index(this[0]) >= 0 : f.filter(a, this).length > 0 : this.filter(a).length > 0)
  }, closest:function(a, b) {
    var c = [], d, e, g = this[0];
    if(f.isArray(a)) {
      var h = 1;
      while(g && g.ownerDocument && g !== b) {
        for(d = 0;d < a.length;d++) {
          f(g).is(a[d]) && c.push({selector:a[d], elem:g, level:h})
        }
        g = g.parentNode, h++
      }
      return c
    }
    var i = Q.test(a) || typeof a != "string" ? f(a, b || this.context) : 0;
    for(d = 0, e = this.length;d < e;d++) {
      g = this[d];
      while(g) {
        if(i ? i.index(g) > -1 : f.find.matchesSelector(g, a)) {
          c.push(g);
          break
        }
        g = g.parentNode;
        if(!g || !g.ownerDocument || g === b || g.nodeType === 11) {
          break
        }
      }
    }
    c = c.length > 1 ? f.unique(c) : c;
    return this.pushStack(c, "closest", a)
  }, index:function(a) {
    if(!a) {
      return this[0] && this[0].parentNode ? this.prevAll().length : -1
    }
    if(typeof a == "string") {
      return f.inArray(this[0], f(a))
    }
    return f.inArray(a.jquery ? a[0] : a, this)
  }, add:function(a, b) {
    var c = typeof a == "string" ? f(a, b) : f.makeArray(a && a.nodeType ? [a] : a), d = f.merge(this.get(), c);
    return this.pushStack(S(c[0]) || S(d[0]) ? d : f.unique(d))
  }, andSelf:function() {
    return this.add(this.prevObject)
  }}), f.each({parent:function(a) {
    var b = a.parentNode;
    return b && b.nodeType !== 11 ? b : null
  }, parents:function(a) {
    return f.dir(a, "parentNode")
  }, parentsUntil:function(a, b, c) {
    return f.dir(a, "parentNode", c)
  }, next:function(a) {
    return f.nth(a, 2, "nextSibling")
  }, prev:function(a) {
    return f.nth(a, 2, "previousSibling")
  }, nextAll:function(a) {
    return f.dir(a, "nextSibling")
  }, prevAll:function(a) {
    return f.dir(a, "previousSibling")
  }, nextUntil:function(a, b, c) {
    return f.dir(a, "nextSibling", c)
  }, prevUntil:function(a, b, c) {
    return f.dir(a, "previousSibling", c)
  }, siblings:function(a) {
    return f.sibling((a.parentNode || {}).firstChild, a)
  }, children:function(a) {
    return f.sibling(a.firstChild)
  }, contents:function(a) {
    return f.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : f.makeArray(a.childNodes)
  }}, function(a, b) {
    f.fn[a] = function(c, d) {
      var e = f.map(this, b, c);
      L.test(a) || (d = c), d && typeof d == "string" && (e = f.filter(d, e)), e = this.length > 1 && !R[a] ? f.unique(e) : e, (this.length > 1 || N.test(d)) && M.test(a) && (e = e.reverse());
      return this.pushStack(e, a, P.call(arguments).join(","))
    }
  }), f.extend({filter:function(a, b, c) {
    c && (a = ":not(" + a + ")");
    return b.length === 1 ? f.find.matchesSelector(b[0], a) ? [b[0]] : [] : f.find.matches(a, b)
  }, dir:function(a, c, d) {
    var e = [], g = a[c];
    while(g && g.nodeType !== 9 && (d === b || g.nodeType !== 1 || !f(g).is(d))) {
      g.nodeType === 1 && e.push(g), g = g[c]
    }
    return e
  }, nth:function(a, b, c, d) {
    b = b || 1;
    var e = 0;
    for(;a;a = a[c]) {
      if(a.nodeType === 1 && ++e === b) {
        break
      }
    }
    return a
  }, sibling:function(a, b) {
    var c = [];
    for(;a;a = a.nextSibling) {
      a.nodeType === 1 && a !== b && c.push(a)
    }
    return c
  }});
  var V = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", W = / jQuery\d+="(?:\d+|null)"/g, X = /^\s+/, Y = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig, Z = /<([\w:]+)/, $ = /<tbody/i, _ = /<|&#?\w+;/, ba = /<(?:script|style)/i, bb = /<(?:script|object|embed|option|style)/i, bc = new RegExp("<(?:" + V + ")[\\s/>]", "i"), bd = /checked\s*(?:[^=]|=\s*.checked.)/i, 
  be = /\/(java|ecma)script/i, bf = /^\s*<!(?:\[CDATA\[|\-\-)/, bg = {option:[1, "<select multiple='multiple'>", "</select>"], legend:[1, "<fieldset>", "</fieldset>"], thead:[1, "<table>", "</table>"], tr:[2, "<table><tbody>", "</tbody></table>"], td:[3, "<table><tbody><tr>", "</tr></tbody></table>"], col:[2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"], area:[1, "<map>", "</map>"], _default:[0, "", ""]}, bh = U(c);
  bg.optgroup = bg.option, bg.tbody = bg.tfoot = bg.colgroup = bg.caption = bg.thead, bg.th = bg.td, f.support.htmlSerialize || (bg._default = [1, "div<div>", "</div>"]), f.fn.extend({text:function(a) {
    return f.access(this, function(a) {
      return a === b ? f.text(this) : this.empty().append((this[0] && this[0].ownerDocument || c).createTextNode(a))
    }, null, a, arguments.length)
  }, wrapAll:function(a) {
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).wrapAll(a.call(this, b))
      })
    }
    if(this[0]) {
      var b = f(a, this[0].ownerDocument).eq(0).clone(!0);
      this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
        var a = this;
        while(a.firstChild && a.firstChild.nodeType === 1) {
          a = a.firstChild
        }
        return a
      }).append(this)
    }
    return this
  }, wrapInner:function(a) {
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).wrapInner(a.call(this, b))
      })
    }
    return this.each(function() {
      var b = f(this), c = b.contents();
      c.length ? c.wrapAll(a) : b.append(a)
    })
  }, wrap:function(a) {
    var b = f.isFunction(a);
    return this.each(function(c) {
      f(this).wrapAll(b ? a.call(this, c) : a)
    })
  }, unwrap:function() {
    return this.parent().each(function() {
      f.nodeName(this, "body") || f(this).replaceWith(this.childNodes)
    }).end()
  }, append:function() {
    return this.domManip(arguments, !0, function(a) {
      this.nodeType === 1 && this.appendChild(a)
    })
  }, prepend:function() {
    return this.domManip(arguments, !0, function(a) {
      this.nodeType === 1 && this.insertBefore(a, this.firstChild)
    })
  }, before:function() {
    if(this[0] && this[0].parentNode) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this)
      })
    }
    if(arguments.length) {
      var a = f.clean(arguments);
      a.push.apply(a, this.toArray());
      return this.pushStack(a, "before", arguments)
    }
  }, after:function() {
    if(this[0] && this[0].parentNode) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this.nextSibling)
      })
    }
    if(arguments.length) {
      var a = this.pushStack(this, "after", arguments);
      a.push.apply(a, f.clean(arguments));
      return a
    }
  }, remove:function(a, b) {
    for(var c = 0, d;(d = this[c]) != null;c++) {
      if(!a || f.filter(a, [d]).length) {
        !b && d.nodeType === 1 && (f.cleanData(d.getElementsByTagName("*")), f.cleanData([d])), d.parentNode && d.parentNode.removeChild(d)
      }
    }
    return this
  }, empty:function() {
    for(var a = 0, b;(b = this[a]) != null;a++) {
      b.nodeType === 1 && f.cleanData(b.getElementsByTagName("*"));
      while(b.firstChild) {
        b.removeChild(b.firstChild)
      }
    }
    return this
  }, clone:function(a, b) {
    a = a == null ? !1 : a, b = b == null ? a : b;
    return this.map(function() {
      return f.clone(this, a, b)
    })
  }, html:function(a) {
    return f.access(this, function(a) {
      var c = this[0] || {}, d = 0, e = this.length;
      if(a === b) {
        return c.nodeType === 1 ? c.innerHTML.replace(W, "") : null
      }
      if(typeof a == "string" && !ba.test(a) && (f.support.leadingWhitespace || !X.test(a)) && !bg[(Z.exec(a) || ["", ""])[1].toLowerCase()]) {
        a = a.replace(Y, "<$1></$2>");
        try {
          for(;d < e;d++) {
            c = this[d] || {}, c.nodeType === 1 && (f.cleanData(c.getElementsByTagName("*")), c.innerHTML = a)
          }
          c = 0
        }catch(g) {
        }
      }
      c && this.empty().append(a)
    }, null, a, arguments.length)
  }, replaceWith:function(a) {
    if(this[0] && this[0].parentNode) {
      if(f.isFunction(a)) {
        return this.each(function(b) {
          var c = f(this), d = c.html();
          c.replaceWith(a.call(this, b, d))
        })
      }
      typeof a != "string" && (a = f(a).detach());
      return this.each(function() {
        var b = this.nextSibling, c = this.parentNode;
        f(this).remove(), b ? f(b).before(a) : f(c).append(a)
      })
    }
    return this.length ? this.pushStack(f(f.isFunction(a) ? a() : a), "replaceWith", a) : this
  }, detach:function(a) {
    return this.remove(a, !0)
  }, domManip:function(a, c, d) {
    var e, g, h, i, j = a[0], k = [];
    if(!f.support.checkClone && arguments.length === 3 && typeof j == "string" && bd.test(j)) {
      return this.each(function() {
        f(this).domManip(a, c, d, !0)
      })
    }
    if(f.isFunction(j)) {
      return this.each(function(e) {
        var g = f(this);
        a[0] = j.call(this, e, c ? g.html() : b), g.domManip(a, c, d)
      })
    }
    if(this[0]) {
      i = j && j.parentNode, f.support.parentNode && i && i.nodeType === 11 && i.childNodes.length === this.length ? e = {fragment:i} : e = f.buildFragment(a, this, k), h = e.fragment, h.childNodes.length === 1 ? g = h = h.firstChild : g = h.firstChild;
      if(g) {
        c = c && f.nodeName(g, "tr");
        for(var l = 0, m = this.length, n = m - 1;l < m;l++) {
          d.call(c ? bi(this[l], g) : this[l], e.cacheable || m > 1 && l < n ? f.clone(h, !0, !0) : h)
        }
      }
      k.length && f.each(k, function(a, b) {
        b.src ? f.ajax({type:"GET", global:!1, url:b.src, async:!1, dataType:"script"}) : f.globalEval((b.text || b.textContent || b.innerHTML || "").replace(bf, "/*$0*/")), b.parentNode && b.parentNode.removeChild(b)
      })
    }
    return this
  }}), f.buildFragment = function(a, b, d) {
    var e, g, h, i, j = a[0];
    b && b[0] && (i = b[0].ownerDocument || b[0]), i.createDocumentFragment || (i = c), a.length === 1 && typeof j == "string" && j.length < 512 && i === c && j.charAt(0) === "<" && !bb.test(j) && (f.support.checkClone || !bd.test(j)) && (f.support.html5Clone || !bc.test(j)) && (g = !0, h = f.fragments[j], h && h !== 1 && (e = h)), e || (e = i.createDocumentFragment(), f.clean(a, i, e, d)), g && (f.fragments[j] = h ? e : 1);
    return{fragment:e, cacheable:g}
  }, f.fragments = {}, f.each({appendTo:"append", prependTo:"prepend", insertBefore:"before", insertAfter:"after", replaceAll:"replaceWith"}, function(a, b) {
    f.fn[a] = function(c) {
      var d = [], e = f(c), g = this.length === 1 && this[0].parentNode;
      if(g && g.nodeType === 11 && g.childNodes.length === 1 && e.length === 1) {
        e[b](this[0]);
        return this
      }
      for(var h = 0, i = e.length;h < i;h++) {
        var j = (h > 0 ? this.clone(!0) : this).get();
        f(e[h])[b](j), d = d.concat(j)
      }
      return this.pushStack(d, a, e.selector)
    }
  }), f.extend({clone:function(a, b, c) {
    var d, e, g, h = f.support.html5Clone || f.isXMLDoc(a) || !bc.test("<" + a.nodeName + ">") ? a.cloneNode(!0) : bo(a);
    if((!f.support.noCloneEvent || !f.support.noCloneChecked) && (a.nodeType === 1 || a.nodeType === 11) && !f.isXMLDoc(a)) {
      bk(a, h), d = bl(a), e = bl(h);
      for(g = 0;d[g];++g) {
        e[g] && bk(d[g], e[g])
      }
    }
    if(b) {
      bj(a, h);
      if(c) {
        d = bl(a), e = bl(h);
        for(g = 0;d[g];++g) {
          bj(d[g], e[g])
        }
      }
    }
    d = e = null;
    return h
  }, clean:function(a, b, d, e) {
    var g, h, i, j = [];
    b = b || c, typeof b.createElement == "undefined" && (b = b.ownerDocument || b[0] && b[0].ownerDocument || c);
    for(var k = 0, l;(l = a[k]) != null;k++) {
      typeof l == "number" && (l += "");
      if(!l) {
        continue
      }
      if(typeof l == "string") {
        if(!_.test(l)) {
          l = b.createTextNode(l)
        }else {
          l = l.replace(Y, "<$1></$2>");
          var m = (Z.exec(l) || ["", ""])[1].toLowerCase(), n = bg[m] || bg._default, o = n[0], p = b.createElement("div"), q = bh.childNodes, r;
          b === c ? bh.appendChild(p) : U(b).appendChild(p), p.innerHTML = n[1] + l + n[2];
          while(o--) {
            p = p.lastChild
          }
          if(!f.support.tbody) {
            var s = $.test(l), t = m === "table" && !s ? p.firstChild && p.firstChild.childNodes : n[1] === "<table>" && !s ? p.childNodes : [];
            for(i = t.length - 1;i >= 0;--i) {
              f.nodeName(t[i], "tbody") && !t[i].childNodes.length && t[i].parentNode.removeChild(t[i])
            }
          }
          !f.support.leadingWhitespace && X.test(l) && p.insertBefore(b.createTextNode(X.exec(l)[0]), p.firstChild), l = p.childNodes, p && (p.parentNode.removeChild(p), q.length > 0 && (r = q[q.length - 1], r && r.parentNode && r.parentNode.removeChild(r)))
        }
      }
      var u;
      if(!f.support.appendChecked) {
        if(l[0] && typeof(u = l.length) == "number") {
          for(i = 0;i < u;i++) {
            bn(l[i])
          }
        }else {
          bn(l)
        }
      }
      l.nodeType ? j.push(l) : j = f.merge(j, l)
    }
    if(d) {
      g = function(a) {
        return!a.type || be.test(a.type)
      };
      for(k = 0;j[k];k++) {
        h = j[k];
        if(e && f.nodeName(h, "script") && (!h.type || be.test(h.type))) {
          e.push(h.parentNode ? h.parentNode.removeChild(h) : h)
        }else {
          if(h.nodeType === 1) {
            var v = f.grep(h.getElementsByTagName("script"), g);
            j.splice.apply(j, [k + 1, 0].concat(v))
          }
          d.appendChild(h)
        }
      }
    }
    return j
  }, cleanData:function(a) {
    var b, c, d = f.cache, e = f.event.special, g = f.support.deleteExpando;
    for(var h = 0, i;(i = a[h]) != null;h++) {
      if(i.nodeName && f.noData[i.nodeName.toLowerCase()]) {
        continue
      }
      c = i[f.expando];
      if(c) {
        b = d[c];
        if(b && b.events) {
          for(var j in b.events) {
            e[j] ? f.event.remove(i, j) : f.removeEvent(i, j, b.handle)
          }
          b.handle && (b.handle.elem = null)
        }
        g ? delete i[f.expando] : i.removeAttribute && i.removeAttribute(f.expando), delete d[c]
      }
    }
  }});
  var bp = /alpha\([^)]*\)/i, bq = /opacity=([^)]*)/, br = /([A-Z]|^ms)/g, bs = /^[\-+]?(?:\d*\.)?\d+$/i, bt = /^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i, bu = /^([\-+])=([\-+.\de]+)/, bv = /^margin/, bw = {position:"absolute", visibility:"hidden", display:"block"}, bx = ["Top", "Right", "Bottom", "Left"], by, bz, bA;
  f.fn.css = function(a, c) {
    return f.access(this, function(a, c, d) {
      return d !== b ? f.style(a, c, d) : f.css(a, c)
    }, a, c, arguments.length > 1)
  }, f.extend({cssHooks:{opacity:{get:function(a, b) {
    if(b) {
      var c = by(a, "opacity");
      return c === "" ? "1" : c
    }
    return a.style.opacity
  }}}, cssNumber:{fillOpacity:!0, fontWeight:!0, lineHeight:!0, opacity:!0, orphans:!0, widows:!0, zIndex:!0, zoom:!0}, cssProps:{"float":f.support.cssFloat ? "cssFloat" : "styleFloat"}, style:function(a, c, d, e) {
    if(!!a && a.nodeType !== 3 && a.nodeType !== 8 && !!a.style) {
      var g, h, i = f.camelCase(c), j = a.style, k = f.cssHooks[i];
      c = f.cssProps[i] || i;
      if(d === b) {
        if(k && "get" in k && (g = k.get(a, !1, e)) !== b) {
          return g
        }
        return j[c]
      }
      h = typeof d, h === "string" && (g = bu.exec(d)) && (d = +(g[1] + 1) * +g[2] + parseFloat(f.css(a, c)), h = "number");
      if(d == null || h === "number" && isNaN(d)) {
        return
      }
      h === "number" && !f.cssNumber[i] && (d += "px");
      if(!k || !("set" in k) || (d = k.set(a, d)) !== b) {
        try {
          j[c] = d
        }catch(l) {
        }
      }
    }
  }, css:function(a, c, d) {
    var e, g;
    c = f.camelCase(c), g = f.cssHooks[c], c = f.cssProps[c] || c, c === "cssFloat" && (c = "float");
    if(g && "get" in g && (e = g.get(a, !0, d)) !== b) {
      return e
    }
    if(by) {
      return by(a, c)
    }
  }, swap:function(a, b, c) {
    var d = {}, e, f;
    for(f in b) {
      d[f] = a.style[f], a.style[f] = b[f]
    }
    e = c.call(a);
    for(f in b) {
      a.style[f] = d[f]
    }
    return e
  }}), f.curCSS = f.css, c.defaultView && c.defaultView.getComputedStyle && (bz = function(a, b) {
    var c, d, e, g, h = a.style;
    b = b.replace(br, "-$1").toLowerCase(), (d = a.ownerDocument.defaultView) && (e = d.getComputedStyle(a, null)) && (c = e.getPropertyValue(b), c === "" && !f.contains(a.ownerDocument.documentElement, a) && (c = f.style(a, b))), !f.support.pixelMargin && e && bv.test(b) && bt.test(c) && (g = h.width, h.width = c, c = e.width, h.width = g);
    return c
  }), c.documentElement.currentStyle && (bA = function(a, b) {
    var c, d, e, f = a.currentStyle && a.currentStyle[b], g = a.style;
    f == null && g && (e = g[b]) && (f = e), bt.test(f) && (c = g.left, d = a.runtimeStyle && a.runtimeStyle.left, d && (a.runtimeStyle.left = a.currentStyle.left), g.left = b === "fontSize" ? "1em" : f, f = g.pixelLeft + "px", g.left = c, d && (a.runtimeStyle.left = d));
    return f === "" ? "auto" : f
  }), by = bz || bA, f.each(["height", "width"], function(a, b) {
    f.cssHooks[b] = {get:function(a, c, d) {
      if(c) {
        return a.offsetWidth !== 0 ? bB(a, b, d) : f.swap(a, bw, function() {
          return bB(a, b, d)
        })
      }
    }, set:function(a, b) {
      return bs.test(b) ? b + "px" : b
    }}
  }), f.support.opacity || (f.cssHooks.opacity = {get:function(a, b) {
    return bq.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? parseFloat(RegExp.$1) / 100 + "" : b ? "1" : ""
  }, set:function(a, b) {
    var c = a.style, d = a.currentStyle, e = f.isNumeric(b) ? "alpha(opacity=" + b * 100 + ")" : "", g = d && d.filter || c.filter || "";
    c.zoom = 1;
    if(b >= 1 && f.trim(g.replace(bp, "")) === "") {
      c.removeAttribute("filter");
      if(d && !d.filter) {
        return
      }
    }
    c.filter = bp.test(g) ? g.replace(bp, e) : g + " " + e
  }}), f(function() {
    f.support.reliableMarginRight || (f.cssHooks.marginRight = {get:function(a, b) {
      return f.swap(a, {display:"inline-block"}, function() {
        return b ? by(a, "margin-right") : a.style.marginRight
      })
    }})
  }), f.expr && f.expr.filters && (f.expr.filters.hidden = function(a) {
    var b = a.offsetWidth, c = a.offsetHeight;
    return b === 0 && c === 0 || !f.support.reliableHiddenOffsets && (a.style && a.style.display || f.css(a, "display")) === "none"
  }, f.expr.filters.visible = function(a) {
    return!f.expr.filters.hidden(a)
  }), f.each({margin:"", padding:"", border:"Width"}, function(a, b) {
    f.cssHooks[a + b] = {expand:function(c) {
      var d, e = typeof c == "string" ? c.split(" ") : [c], f = {};
      for(d = 0;d < 4;d++) {
        f[a + bx[d] + b] = e[d] || e[d - 2] || e[0]
      }
      return f
    }}
  });
  var bC = /%20/g, bD = /\[\]$/, bE = /\r?\n/g, bF = /#.*$/, bG = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg, bH = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i, bI = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/, bJ = /^(?:GET|HEAD)$/, bK = /^\/\//, bL = /\?/, bM = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, bN = /^(?:select|textarea)/i, bO = /\s+/, bP = /([?&])_=[^&]*/, bQ = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/, 
  bR = f.fn.load, bS = {}, bT = {}, bU, bV, bW = ["*/"] + ["*"];
  try {
    bU = e.href
  }catch(bX) {
    bU = c.createElement("a"), bU.href = "", bU = bU.href
  }
  bV = bQ.exec(bU.toLowerCase()) || [], f.fn.extend({load:function(a, c, d) {
    if(typeof a != "string" && bR) {
      return bR.apply(this, arguments)
    }
    if(!this.length) {
      return this
    }
    var e = a.indexOf(" ");
    if(e >= 0) {
      var g = a.slice(e, a.length);
      a = a.slice(0, e)
    }
    var h = "GET";
    c && (f.isFunction(c) ? (d = c, c = b) : typeof c == "object" && (c = f.param(c, f.ajaxSettings.traditional), h = "POST"));
    var i = this;
    f.ajax({url:a, type:h, dataType:"html", data:c, complete:function(a, b, c) {
      c = a.responseText, a.isResolved() && (a.done(function(a) {
        c = a
      }), i.html(g ? f("<div>").append(c.replace(bM, "")).find(g) : c)), d && i.each(d, [c, b, a])
    }});
    return this
  }, serialize:function() {
    return f.param(this.serializeArray())
  }, serializeArray:function() {
    return this.map(function() {
      return this.elements ? f.makeArray(this.elements) : this
    }).filter(function() {
      return this.name && !this.disabled && (this.checked || bN.test(this.nodeName) || bH.test(this.type))
    }).map(function(a, b) {
      var c = f(this).val();
      return c == null ? null : f.isArray(c) ? f.map(c, function(a, c) {
        return{name:b.name, value:a.replace(bE, "\r\n")}
      }) : {name:b.name, value:c.replace(bE, "\r\n")}
    }).get()
  }}), f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function(a, b) {
    f.fn[b] = function(a) {
      return this.on(b, a)
    }
  }), f.each(["get", "post"], function(a, c) {
    f[c] = function(a, d, e, g) {
      f.isFunction(d) && (g = g || e, e = d, d = b);
      return f.ajax({type:c, url:a, data:d, success:e, dataType:g})
    }
  }), f.extend({getScript:function(a, c) {
    return f.get(a, b, c, "script")
  }, getJSON:function(a, b, c) {
    return f.get(a, b, c, "json")
  }, ajaxSetup:function(a, b) {
    b ? b$(a, f.ajaxSettings) : (b = a, a = f.ajaxSettings), b$(a, b);
    return a
  }, ajaxSettings:{url:bU, isLocal:bI.test(bV[1]), global:!0, type:"GET", contentType:"application/x-www-form-urlencoded; charset=UTF-8", processData:!0, async:!0, accepts:{xml:"application/xml, text/xml", html:"text/html", text:"text/plain", json:"application/json, text/javascript", "*":bW}, contents:{xml:/xml/, html:/html/, json:/json/}, responseFields:{xml:"responseXML", text:"responseText"}, converters:{"* text":a.String, "text html":!0, "text json":f.parseJSON, "text xml":f.parseXML}, flatOptions:{context:!0, 
  url:!0}}, ajaxPrefilter:bY(bS), ajaxTransport:bY(bT), ajax:function(a, c) {
    function w(a, c, l, m) {
      if(s !== 2) {
        s = 2, q && clearTimeout(q), p = b, n = m || "", v.readyState = a > 0 ? 4 : 0;
        var o, r, u, w = c, x = l ? ca(d, v, l) : b, y, z;
        if(a >= 200 && a < 300 || a === 304) {
          if(d.ifModified) {
            if(y = v.getResponseHeader("Last-Modified")) {
              f.lastModified[k] = y
            }
            if(z = v.getResponseHeader("Etag")) {
              f.etag[k] = z
            }
          }
          if(a === 304) {
            w = "notmodified", o = !0
          }else {
            try {
              r = cb(d, x), w = "success", o = !0
            }catch(A) {
              w = "parsererror", u = A
            }
          }
        }else {
          u = w;
          if(!w || a) {
            w = "error", a < 0 && (a = 0)
          }
        }
        v.status = a, v.statusText = "" + (c || w), o ? h.resolveWith(e, [r, w, v]) : h.rejectWith(e, [v, w, u]), v.statusCode(j), j = b, t && g.trigger("ajax" + (o ? "Success" : "Error"), [v, d, o ? r : u]), i.fireWith(e, [v, w]), t && (g.trigger("ajaxComplete", [v, d]), --f.active || f.event.trigger("ajaxStop"))
      }
    }
    typeof a == "object" && (c = a, a = b), c = c || {};
    var d = f.ajaxSetup({}, c), e = d.context || d, g = e !== d && (e.nodeType || e instanceof f) ? f(e) : f.event, h = f.Deferred(), i = f.Callbacks("once memory"), j = d.statusCode || {}, k, l = {}, m = {}, n, o, p, q, r, s = 0, t, u, v = {readyState:0, setRequestHeader:function(a, b) {
      if(!s) {
        var c = a.toLowerCase();
        a = m[c] = m[c] || a, l[a] = b
      }
      return this
    }, getAllResponseHeaders:function() {
      return s === 2 ? n : null
    }, getResponseHeader:function(a) {
      var c;
      if(s === 2) {
        if(!o) {
          o = {};
          while(c = bG.exec(n)) {
            o[c[1].toLowerCase()] = c[2]
          }
        }
        c = o[a.toLowerCase()]
      }
      return c === b ? null : c
    }, overrideMimeType:function(a) {
      s || (d.mimeType = a);
      return this
    }, abort:function(a) {
      a = a || "abort", p && p.abort(a), w(0, a);
      return this
    }};
    h.promise(v), v.success = v.done, v.error = v.fail, v.complete = i.add, v.statusCode = function(a) {
      if(a) {
        var b;
        if(s < 2) {
          for(b in a) {
            j[b] = [j[b], a[b]]
          }
        }else {
          b = a[v.status], v.then(b, b)
        }
      }
      return this
    }, d.url = ((a || d.url) + "").replace(bF, "").replace(bK, bV[1] + "//"), d.dataTypes = f.trim(d.dataType || "*").toLowerCase().split(bO), d.crossDomain == null && (r = bQ.exec(d.url.toLowerCase()), d.crossDomain = !(!r || r[1] == bV[1] && r[2] == bV[2] && (r[3] || (r[1] === "http:" ? 80 : 443)) == (bV[3] || (bV[1] === "http:" ? 80 : 443)))), d.data && d.processData && typeof d.data != "string" && (d.data = f.param(d.data, d.traditional)), bZ(bS, d, c, v);
    if(s === 2) {
      return!1
    }
    t = d.global, d.type = d.type.toUpperCase(), d.hasContent = !bJ.test(d.type), t && f.active++ === 0 && f.event.trigger("ajaxStart");
    if(!d.hasContent) {
      d.data && (d.url += (bL.test(d.url) ? "&" : "?") + d.data, delete d.data), k = d.url;
      if(d.cache === !1) {
        var x = f.now(), y = d.url.replace(bP, "$1_=" + x);
        d.url = y + (y === d.url ? (bL.test(d.url) ? "&" : "?") + "_=" + x : "")
      }
    }
    (d.data && d.hasContent && d.contentType !== !1 || c.contentType) && v.setRequestHeader("Content-Type", d.contentType), d.ifModified && (k = k || d.url, f.lastModified[k] && v.setRequestHeader("If-Modified-Since", f.lastModified[k]), f.etag[k] && v.setRequestHeader("If-None-Match", f.etag[k])), v.setRequestHeader("Accept", d.dataTypes[0] && d.accepts[d.dataTypes[0]] ? d.accepts[d.dataTypes[0]] + (d.dataTypes[0] !== "*" ? ", " + bW + "; q=0.01" : "") : d.accepts["*"]);
    for(u in d.headers) {
      v.setRequestHeader(u, d.headers[u])
    }
    if(d.beforeSend && (d.beforeSend.call(e, v, d) === !1 || s === 2)) {
      v.abort();
      return!1
    }
    for(u in{success:1, error:1, complete:1}) {
      v[u](d[u])
    }
    p = bZ(bT, d, c, v);
    if(!p) {
      w(-1, "No Transport")
    }else {
      v.readyState = 1, t && g.trigger("ajaxSend", [v, d]), d.async && d.timeout > 0 && (q = setTimeout(function() {
        v.abort("timeout")
      }, d.timeout));
      try {
        s = 1, p.send(l, w)
      }catch(z) {
        if(s < 2) {
          w(-1, z)
        }else {
          throw z;
        }
      }
    }
    return v
  }, param:function(a, c) {
    var d = [], e = function(a, b) {
      b = f.isFunction(b) ? b() : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
    };
    c === b && (c = f.ajaxSettings.traditional);
    if(f.isArray(a) || a.jquery && !f.isPlainObject(a)) {
      f.each(a, function() {
        e(this.name, this.value)
      })
    }else {
      for(var g in a) {
        b_(g, a[g], c, e)
      }
    }
    return d.join("&").replace(bC, "+")
  }}), f.extend({active:0, lastModified:{}, etag:{}});
  var cc = f.now(), cd = /(\=)\?(&|$)|\?\?/i;
  f.ajaxSetup({jsonp:"callback", jsonpCallback:function() {
    return f.expando + "_" + cc++
  }}), f.ajaxPrefilter("json jsonp", function(b, c, d) {
    var e = typeof b.data == "string" && /^application\/x\-www\-form\-urlencoded/.test(b.contentType);
    if(b.dataTypes[0] === "jsonp" || b.jsonp !== !1 && (cd.test(b.url) || e && cd.test(b.data))) {
      var g, h = b.jsonpCallback = f.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, i = a[h], j = b.url, k = b.data, l = "$1" + h + "$2";
      b.jsonp !== !1 && (j = j.replace(cd, l), b.url === j && (e && (k = k.replace(cd, l)), b.data === k && (j += (/\?/.test(j) ? "&" : "?") + b.jsonp + "=" + h))), b.url = j, b.data = k, a[h] = function(a) {
        g = [a]
      }, d.always(function() {
        a[h] = i, g && f.isFunction(i) && a[h](g[0])
      }), b.converters["script json"] = function() {
        g || f.error(h + " was not called");
        return g[0]
      }, b.dataTypes[0] = "json";
      return"script"
    }
  }), f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents:{script:/javascript|ecmascript/}, converters:{"text script":function(a) {
    f.globalEval(a);
    return a
  }}}), f.ajaxPrefilter("script", function(a) {
    a.cache === b && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1)
  }), f.ajaxTransport("script", function(a) {
    if(a.crossDomain) {
      var d, e = c.head || c.getElementsByTagName("head")[0] || c.documentElement;
      return{send:function(f, g) {
        d = c.createElement("script"), d.async = "async", a.scriptCharset && (d.charset = a.scriptCharset), d.src = a.url, d.onload = d.onreadystatechange = function(a, c) {
          if(c || !d.readyState || /loaded|complete/.test(d.readyState)) {
            d.onload = d.onreadystatechange = null, e && d.parentNode && e.removeChild(d), d = b, c || g(200, "success")
          }
        }, e.insertBefore(d, e.firstChild)
      }, abort:function() {
        d && d.onload(0, 1)
      }}
    }
  });
  var ce = a.ActiveXObject ? function() {
    for(var a in cg) {
      cg[a](0, 1)
    }
  } : !1, cf = 0, cg;
  f.ajaxSettings.xhr = a.ActiveXObject ? function() {
    return!this.isLocal && ch() || ci()
  } : ch, function(a) {
    f.extend(f.support, {ajax:!!a, cors:!!a && "withCredentials" in a})
  }(f.ajaxSettings.xhr()), f.support.ajax && f.ajaxTransport(function(c) {
    if(!c.crossDomain || f.support.cors) {
      var d;
      return{send:function(e, g) {
        var h = c.xhr(), i, j;
        c.username ? h.open(c.type, c.url, c.async, c.username, c.password) : h.open(c.type, c.url, c.async);
        if(c.xhrFields) {
          for(j in c.xhrFields) {
            h[j] = c.xhrFields[j]
          }
        }
        c.mimeType && h.overrideMimeType && h.overrideMimeType(c.mimeType), !c.crossDomain && !e["X-Requested-With"] && (e["X-Requested-With"] = "XMLHttpRequest");
        try {
          for(j in e) {
            h.setRequestHeader(j, e[j])
          }
        }catch(k) {
        }
        h.send(c.hasContent && c.data || null), d = function(a, e) {
          var j, k, l, m, n;
          try {
            if(d && (e || h.readyState === 4)) {
              d = b, i && (h.onreadystatechange = f.noop, ce && delete cg[i]);
              if(e) {
                h.readyState !== 4 && h.abort()
              }else {
                j = h.status, l = h.getAllResponseHeaders(), m = {}, n = h.responseXML, n && n.documentElement && (m.xml = n);
                try {
                  m.text = h.responseText
                }catch(a) {
                }
                try {
                  k = h.statusText
                }catch(o) {
                  k = ""
                }
                !j && c.isLocal && !c.crossDomain ? j = m.text ? 200 : 404 : j === 1223 && (j = 204)
              }
            }
          }catch(p) {
            e || g(-1, p)
          }
          m && g(j, k, m, l)
        }, !c.async || h.readyState === 4 ? d() : (i = ++cf, ce && (cg || (cg = {}, f(a).unload(ce)), cg[i] = d), h.onreadystatechange = d)
      }, abort:function() {
        d && d(0, 1)
      }}
    }
  });
  var cj = {}, ck, cl, cm = /^(?:toggle|show|hide)$/, cn = /^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i, co, cp = [["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"], ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"], ["opacity"]], cq;
  f.fn.extend({show:function(a, b, c) {
    var d, e;
    if(a || a === 0) {
      return this.animate(ct("show", 3), a, b, c)
    }
    for(var g = 0, h = this.length;g < h;g++) {
      d = this[g], d.style && (e = d.style.display, !f._data(d, "olddisplay") && e === "none" && (e = d.style.display = ""), (e === "" && f.css(d, "display") === "none" || !f.contains(d.ownerDocument.documentElement, d)) && f._data(d, "olddisplay", cu(d.nodeName)))
    }
    for(g = 0;g < h;g++) {
      d = this[g];
      if(d.style) {
        e = d.style.display;
        if(e === "" || e === "none") {
          d.style.display = f._data(d, "olddisplay") || ""
        }
      }
    }
    return this
  }, hide:function(a, b, c) {
    if(a || a === 0) {
      return this.animate(ct("hide", 3), a, b, c)
    }
    var d, e, g = 0, h = this.length;
    for(;g < h;g++) {
      d = this[g], d.style && (e = f.css(d, "display"), e !== "none" && !f._data(d, "olddisplay") && f._data(d, "olddisplay", e))
    }
    for(g = 0;g < h;g++) {
      this[g].style && (this[g].style.display = "none")
    }
    return this
  }, _toggle:f.fn.toggle, toggle:function(a, b, c) {
    var d = typeof a == "boolean";
    f.isFunction(a) && f.isFunction(b) ? this._toggle.apply(this, arguments) : a == null || d ? this.each(function() {
      var b = d ? a : f(this).is(":hidden");
      f(this)[b ? "show" : "hide"]()
    }) : this.animate(ct("toggle", 3), a, b, c);
    return this
  }, fadeTo:function(a, b, c, d) {
    return this.filter(":hidden").css("opacity", 0).show().end().animate({opacity:b}, a, c, d)
  }, animate:function(a, b, c, d) {
    function g() {
      e.queue === !1 && f._mark(this);
      var b = f.extend({}, e), c = this.nodeType === 1, d = c && f(this).is(":hidden"), g, h, i, j, k, l, m, n, o, p, q;
      b.animatedProperties = {};
      for(i in a) {
        g = f.camelCase(i), i !== g && (a[g] = a[i], delete a[i]);
        if((k = f.cssHooks[g]) && "expand" in k) {
          l = k.expand(a[g]), delete a[g];
          for(i in l) {
            i in a || (a[i] = l[i])
          }
        }
      }
      for(g in a) {
        h = a[g], f.isArray(h) ? (b.animatedProperties[g] = h[1], h = a[g] = h[0]) : b.animatedProperties[g] = b.specialEasing && b.specialEasing[g] || b.easing || "swing";
        if(h === "hide" && d || h === "show" && !d) {
          return b.complete.call(this)
        }
        c && (g === "height" || g === "width") && (b.overflow = [this.style.overflow, this.style.overflowX, this.style.overflowY], f.css(this, "display") === "inline" && f.css(this, "float") === "none" && (!f.support.inlineBlockNeedsLayout || cu(this.nodeName) === "inline" ? this.style.display = "inline-block" : this.style.zoom = 1))
      }
      b.overflow != null && (this.style.overflow = "hidden");
      for(i in a) {
        j = new f.fx(this, b, i), h = a[i], cm.test(h) ? (q = f._data(this, "toggle" + i) || (h === "toggle" ? d ? "show" : "hide" : 0), q ? (f._data(this, "toggle" + i, q === "show" ? "hide" : "show"), j[q]()) : j[h]()) : (m = cn.exec(h), n = j.cur(), m ? (o = parseFloat(m[2]), p = m[3] || (f.cssNumber[i] ? "" : "px"), p !== "px" && (f.style(this, i, (o || 1) + p), n = (o || 1) / j.cur() * n, f.style(this, i, n + p)), m[1] && (o = (m[1] === "-=" ? -1 : 1) * o + n), j.custom(n, o, p)) : j.custom(n, 
        h, ""))
      }
      return!0
    }
    var e = f.speed(b, c, d);
    if(f.isEmptyObject(a)) {
      return this.each(e.complete, [!1])
    }
    a = f.extend({}, a);
    return e.queue === !1 ? this.each(g) : this.queue(e.queue, g)
  }, stop:function(a, c, d) {
    typeof a != "string" && (d = c, c = a, a = b), c && a !== !1 && this.queue(a || "fx", []);
    return this.each(function() {
      function h(a, b, c) {
        var e = b[c];
        f.removeData(a, c, !0), e.stop(d)
      }
      var b, c = !1, e = f.timers, g = f._data(this);
      d || f._unmark(!0, this);
      if(a == null) {
        for(b in g) {
          g[b] && g[b].stop && b.indexOf(".run") === b.length - 4 && h(this, g, b)
        }
      }else {
        g[b = a + ".run"] && g[b].stop && h(this, g, b)
      }
      for(b = e.length;b--;) {
        e[b].elem === this && (a == null || e[b].queue === a) && (d ? e[b](!0) : e[b].saveState(), c = !0, e.splice(b, 1))
      }
      (!d || !c) && f.dequeue(this, a)
    })
  }}), f.each({slideDown:ct("show", 1), slideUp:ct("hide", 1), slideToggle:ct("toggle", 1), fadeIn:{opacity:"show"}, fadeOut:{opacity:"hide"}, fadeToggle:{opacity:"toggle"}}, function(a, b) {
    f.fn[a] = function(a, c, d) {
      return this.animate(b, a, c, d)
    }
  }), f.extend({speed:function(a, b, c) {
    var d = a && typeof a == "object" ? f.extend({}, a) : {complete:c || !c && b || f.isFunction(a) && a, duration:a, easing:c && b || b && !f.isFunction(b) && b};
    d.duration = f.fx.off ? 0 : typeof d.duration == "number" ? d.duration : d.duration in f.fx.speeds ? f.fx.speeds[d.duration] : f.fx.speeds._default;
    if(d.queue == null || d.queue === !0) {
      d.queue = "fx"
    }
    d.old = d.complete, d.complete = function(a) {
      f.isFunction(d.old) && d.old.call(this), d.queue ? f.dequeue(this, d.queue) : a !== !1 && f._unmark(this)
    };
    return d
  }, easing:{linear:function(a) {
    return a
  }, swing:function(a) {
    return-Math.cos(a * Math.PI) / 2 + 0.5
  }}, timers:[], fx:function(a, b, c) {
    this.options = b, this.elem = a, this.prop = c, b.orig = b.orig || {}
  }}), f.fx.prototype = {update:function() {
    this.options.step && this.options.step.call(this.elem, this.now, this), (f.fx.step[this.prop] || f.fx.step._default)(this)
  }, cur:function() {
    if(this.elem[this.prop] != null && (!this.elem.style || this.elem.style[this.prop] == null)) {
      return this.elem[this.prop]
    }
    var a, b = f.css(this.elem, this.prop);
    return isNaN(a = parseFloat(b)) ? !b || b === "auto" ? 0 : b : a
  }, custom:function(a, c, d) {
    function h(a) {
      return e.step(a)
    }
    var e = this, g = f.fx;
    this.startTime = cq || cr(), this.end = c, this.now = this.start = a, this.pos = this.state = 0, this.unit = d || this.unit || (f.cssNumber[this.prop] ? "" : "px"), h.queue = this.options.queue, h.elem = this.elem, h.saveState = function() {
      f._data(e.elem, "fxshow" + e.prop) === b && (e.options.hide ? f._data(e.elem, "fxshow" + e.prop, e.start) : e.options.show && f._data(e.elem, "fxshow" + e.prop, e.end))
    }, h() && f.timers.push(h) && !co && (co = setInterval(g.tick, g.interval))
  }, show:function() {
    var a = f._data(this.elem, "fxshow" + this.prop);
    this.options.orig[this.prop] = a || f.style(this.elem, this.prop), this.options.show = !0, a !== b ? this.custom(this.cur(), a) : this.custom(this.prop === "width" || this.prop === "height" ? 1 : 0, this.cur()), f(this.elem).show()
  }, hide:function() {
    this.options.orig[this.prop] = f._data(this.elem, "fxshow" + this.prop) || f.style(this.elem, this.prop), this.options.hide = !0, this.custom(this.cur(), 0)
  }, step:function(a) {
    var b, c, d, e = cq || cr(), g = !0, h = this.elem, i = this.options;
    if(a || e >= i.duration + this.startTime) {
      this.now = this.end, this.pos = this.state = 1, this.update(), i.animatedProperties[this.prop] = !0;
      for(b in i.animatedProperties) {
        i.animatedProperties[b] !== !0 && (g = !1)
      }
      if(g) {
        i.overflow != null && !f.support.shrinkWrapBlocks && f.each(["", "X", "Y"], function(a, b) {
          h.style["overflow" + b] = i.overflow[a]
        }), i.hide && f(h).hide();
        if(i.hide || i.show) {
          for(b in i.animatedProperties) {
            f.style(h, b, i.orig[b]), f.removeData(h, "fxshow" + b, !0), f.removeData(h, "toggle" + b, !0)
          }
        }
        d = i.complete, d && (i.complete = !1, d.call(h))
      }
      return!1
    }
    i.duration == Infinity ? this.now = e : (c = e - this.startTime, this.state = c / i.duration, this.pos = f.easing[i.animatedProperties[this.prop]](this.state, c, 0, 1, i.duration), this.now = this.start + (this.end - this.start) * this.pos), this.update();
    return!0
  }}, f.extend(f.fx, {tick:function() {
    var a, b = f.timers, c = 0;
    for(;c < b.length;c++) {
      a = b[c], !a() && b[c] === a && b.splice(c--, 1)
    }
    b.length || f.fx.stop()
  }, interval:13, stop:function() {
    clearInterval(co), co = null
  }, speeds:{slow:600, fast:200, _default:400}, step:{opacity:function(a) {
    f.style(a.elem, "opacity", a.now)
  }, _default:function(a) {
    a.elem.style && a.elem.style[a.prop] != null ? a.elem.style[a.prop] = a.now + a.unit : a.elem[a.prop] = a.now
  }}}), f.each(cp.concat.apply([], cp), function(a, b) {
    b.indexOf("margin") && (f.fx.step[b] = function(a) {
      f.style(a.elem, b, Math.max(0, a.now) + a.unit)
    })
  }), f.expr && f.expr.filters && (f.expr.filters.animated = function(a) {
    return f.grep(f.timers, function(b) {
      return a === b.elem
    }).length
  });
  var cv, cw = /^t(?:able|d|h)$/i, cx = /^(?:body|html)$/i;
  "getBoundingClientRect" in c.documentElement ? cv = function(a, b, c, d) {
    try {
      d = a.getBoundingClientRect()
    }catch(e) {
    }
    if(!d || !f.contains(c, a)) {
      return d ? {top:d.top, left:d.left} : {top:0, left:0}
    }
    var g = b.body, h = cy(b), i = c.clientTop || g.clientTop || 0, j = c.clientLeft || g.clientLeft || 0, k = h.pageYOffset || f.support.boxModel && c.scrollTop || g.scrollTop, l = h.pageXOffset || f.support.boxModel && c.scrollLeft || g.scrollLeft, m = d.top + k - i, n = d.left + l - j;
    return{top:m, left:n}
  } : cv = function(a, b, c) {
    var d, e = a.offsetParent, g = a, h = b.body, i = b.defaultView, j = i ? i.getComputedStyle(a, null) : a.currentStyle, k = a.offsetTop, l = a.offsetLeft;
    while((a = a.parentNode) && a !== h && a !== c) {
      if(f.support.fixedPosition && j.position === "fixed") {
        break
      }
      d = i ? i.getComputedStyle(a, null) : a.currentStyle, k -= a.scrollTop, l -= a.scrollLeft, a === e && (k += a.offsetTop, l += a.offsetLeft, f.support.doesNotAddBorder && (!f.support.doesAddBorderForTableAndCells || !cw.test(a.nodeName)) && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 0), g = e, e = a.offsetParent), f.support.subtractsBorderForOverflowNotVisible && d.overflow !== "visible" && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 
      0), j = d
    }
    if(j.position === "relative" || j.position === "static") {
      k += h.offsetTop, l += h.offsetLeft
    }
    f.support.fixedPosition && j.position === "fixed" && (k += Math.max(c.scrollTop, h.scrollTop), l += Math.max(c.scrollLeft, h.scrollLeft));
    return{top:k, left:l}
  }, f.fn.offset = function(a) {
    if(arguments.length) {
      return a === b ? this : this.each(function(b) {
        f.offset.setOffset(this, a, b)
      })
    }
    var c = this[0], d = c && c.ownerDocument;
    if(!d) {
      return null
    }
    if(c === d.body) {
      return f.offset.bodyOffset(c)
    }
    return cv(c, d, d.documentElement)
  }, f.offset = {bodyOffset:function(a) {
    var b = a.offsetTop, c = a.offsetLeft;
    f.support.doesNotIncludeMarginInBodyOffset && (b += parseFloat(f.css(a, "marginTop")) || 0, c += parseFloat(f.css(a, "marginLeft")) || 0);
    return{top:b, left:c}
  }, setOffset:function(a, b, c) {
    var d = f.css(a, "position");
    d === "static" && (a.style.position = "relative");
    var e = f(a), g = e.offset(), h = f.css(a, "top"), i = f.css(a, "left"), j = (d === "absolute" || d === "fixed") && f.inArray("auto", [h, i]) > -1, k = {}, l = {}, m, n;
    j ? (l = e.position(), m = l.top, n = l.left) : (m = parseFloat(h) || 0, n = parseFloat(i) || 0), f.isFunction(b) && (b = b.call(a, c, g)), b.top != null && (k.top = b.top - g.top + m), b.left != null && (k.left = b.left - g.left + n), "using" in b ? b.using.call(a, k) : e.css(k)
  }}, f.fn.extend({position:function() {
    if(!this[0]) {
      return null
    }
    var a = this[0], b = this.offsetParent(), c = this.offset(), d = cx.test(b[0].nodeName) ? {top:0, left:0} : b.offset();
    c.top -= parseFloat(f.css(a, "marginTop")) || 0, c.left -= parseFloat(f.css(a, "marginLeft")) || 0, d.top += parseFloat(f.css(b[0], "borderTopWidth")) || 0, d.left += parseFloat(f.css(b[0], "borderLeftWidth")) || 0;
    return{top:c.top - d.top, left:c.left - d.left}
  }, offsetParent:function() {
    return this.map(function() {
      var a = this.offsetParent || c.body;
      while(a && !cx.test(a.nodeName) && f.css(a, "position") === "static") {
        a = a.offsetParent
      }
      return a
    })
  }}), f.each({scrollLeft:"pageXOffset", scrollTop:"pageYOffset"}, function(a, c) {
    var d = /Y/.test(c);
    f.fn[a] = function(e) {
      return f.access(this, function(a, e, g) {
        var h = cy(a);
        if(g === b) {
          return h ? c in h ? h[c] : f.support.boxModel && h.document.documentElement[e] || h.document.body[e] : a[e]
        }
        h ? h.scrollTo(d ? f(h).scrollLeft() : g, d ? g : f(h).scrollTop()) : a[e] = g
      }, a, e, arguments.length, null)
    }
  }), f.each({Height:"height", Width:"width"}, function(a, c) {
    var d = "client" + a, e = "scroll" + a, g = "offset" + a;
    f.fn["inner" + a] = function() {
      var a = this[0];
      return a ? a.style ? parseFloat(f.css(a, c, "padding")) : this[c]() : null
    }, f.fn["outer" + a] = function(a) {
      var b = this[0];
      return b ? b.style ? parseFloat(f.css(b, c, a ? "margin" : "border")) : this[c]() : null
    }, f.fn[c] = function(a) {
      return f.access(this, function(a, c, h) {
        var i, j, k, l;
        if(f.isWindow(a)) {
          i = a.document, j = i.documentElement[d];
          return f.support.boxModel && j || i.body && i.body[d] || j
        }
        if(a.nodeType === 9) {
          i = a.documentElement;
          if(i[d] >= i[e]) {
            return i[d]
          }
          return Math.max(a.body[e], i[e], a.body[g], i[g])
        }
        if(h === b) {
          k = f.css(a, c), l = parseFloat(k);
          return f.isNumeric(l) ? l : k
        }
        f(a).css(c, h)
      }, c, a, arguments.length, null)
    }
  }), a.jQuery = a.$ = f, typeof define == "function" && define.amd && define.amd.jQuery && define("jquery", [], function() {
    return f
  })
})(window);
(function(e, t) {
  function i(t, n) {
    var r, i, o, u = t.nodeName.toLowerCase();
    return"area" === u ? (r = t.parentNode, i = r.name, !t.href || !i || r.nodeName.toLowerCase() !== "map" ? !1 : (o = e("img[usemap=#" + i + "]")[0], !!o && s(o))) : (/input|select|textarea|button|object/.test(u) ? !t.disabled : "a" === u ? t.href || n : n) && s(t)
  }
  function s(t) {
    return e.expr.filters.visible(t) && !e(t).parents().andSelf().filter(function() {
      return e.css(this, "visibility") === "hidden"
    }).length
  }
  var n = 0, r = /^ui-id-\d+$/;
  e.ui = e.ui || {};
  if(e.ui.version) {
    return
  }
  e.extend(e.ui, {version:"1.9.2", keyCode:{BACKSPACE:8, COMMA:188, DELETE:46, DOWN:40, END:35, ENTER:13, ESCAPE:27, HOME:36, LEFT:37, NUMPAD_ADD:107, NUMPAD_DECIMAL:110, NUMPAD_DIVIDE:111, NUMPAD_ENTER:108, NUMPAD_MULTIPLY:106, NUMPAD_SUBTRACT:109, PAGE_DOWN:34, PAGE_UP:33, PERIOD:190, RIGHT:39, SPACE:32, TAB:9, UP:38}}), e.fn.extend({_focus:e.fn.focus, focus:function(t, n) {
    return typeof t == "number" ? this.each(function() {
      var r = this;
      setTimeout(function() {
        e(r).focus(), n && n.call(r)
      }, t)
    }) : this._focus.apply(this, arguments)
  }, scrollParent:function() {
    var t;
    return e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? t = this.parents().filter(function() {
      return/(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
    }).eq(0) : t = this.parents().filter(function() {
      return/(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
    }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
  }, zIndex:function(n) {
    if(n !== t) {
      return this.css("zIndex", n)
    }
    if(this.length) {
      var r = e(this[0]), i, s;
      while(r.length && r[0] !== document) {
        i = r.css("position");
        if(i === "absolute" || i === "relative" || i === "fixed") {
          s = parseInt(r.css("zIndex"), 10);
          if(!isNaN(s) && s !== 0) {
            return s
          }
        }
        r = r.parent()
      }
    }
    return 0
  }, uniqueId:function() {
    return this.each(function() {
      this.id || (this.id = "ui-id-" + ++n)
    })
  }, removeUniqueId:function() {
    return this.each(function() {
      r.test(this.id) && e(this).removeAttr("id")
    })
  }}), e.extend(e.expr[":"], {data:e.expr.createPseudo ? e.expr.createPseudo(function(t) {
    return function(n) {
      return!!e.data(n, t)
    }
  }) : function(t, n, r) {
    return!!e.data(t, r[3])
  }, focusable:function(t) {
    return i(t, !isNaN(e.attr(t, "tabindex")))
  }, tabbable:function(t) {
    var n = e.attr(t, "tabindex"), r = isNaN(n);
    return(r || n >= 0) && i(t, !r)
  }}), e(function() {
    var t = document.body, n = t.appendChild(n = document.createElement("div"));
    n.offsetHeight, e.extend(n.style, {minHeight:"100px", height:"auto", padding:0, borderWidth:0}), e.support.minHeight = n.offsetHeight === 100, e.support.selectstart = "onselectstart" in n, t.removeChild(n).style.display = "none"
  }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function(n, r) {
    function u(t, n, r, s) {
      return e.each(i, function() {
        n -= parseFloat(e.css(t, "padding" + this)) || 0, r && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (n -= parseFloat(e.css(t, "margin" + this)) || 0)
      }), n
    }
    var i = r === "Width" ? ["Left", "Right"] : ["Top", "Bottom"], s = r.toLowerCase(), o = {innerWidth:e.fn.innerWidth, innerHeight:e.fn.innerHeight, outerWidth:e.fn.outerWidth, outerHeight:e.fn.outerHeight};
    e.fn["inner" + r] = function(n) {
      return n === t ? o["inner" + r].call(this) : this.each(function() {
        e(this).css(s, u(this, n) + "px")
      })
    }, e.fn["outer" + r] = function(t, n) {
      return typeof t != "number" ? o["outer" + r].call(this, t) : this.each(function() {
        e(this).css(s, u(this, t, !0, n) + "px")
      })
    }
  }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
    return function(n) {
      return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this)
    }
  }(e.fn.removeData)), function() {
    var t = /msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) || [];
    e.ui.ie = t.length ? !0 : !1, e.ui.ie6 = parseFloat(t[1], 10) === 6
  }(), e.fn.extend({disableSelection:function() {
    return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(e) {
      e.preventDefault()
    })
  }, enableSelection:function() {
    return this.unbind(".ui-disableSelection")
  }}), e.extend(e.ui, {plugin:{add:function(t, n, r) {
    var i, s = e.ui[t].prototype;
    for(i in r) {
      s.plugins[i] = s.plugins[i] || [], s.plugins[i].push([n, r[i]])
    }
  }, call:function(e, t, n) {
    var r, i = e.plugins[t];
    if(!i || !e.element[0].parentNode || e.element[0].parentNode.nodeType === 11) {
      return
    }
    for(r = 0;r < i.length;r++) {
      e.options[i[r][0]] && i[r][1].apply(e.element, n)
    }
  }}, contains:e.contains, hasScroll:function(t, n) {
    if(e(t).css("overflow") === "hidden") {
      return!1
    }
    var r = n && n === "left" ? "scrollLeft" : "scrollTop", i = !1;
    return t[r] > 0 ? !0 : (t[r] = 1, i = t[r] > 0, t[r] = 0, i)
  }, isOverAxis:function(e, t, n) {
    return e > t && e < t + n
  }, isOver:function(t, n, r, i, s, o) {
    return e.ui.isOverAxis(t, r, s) && e.ui.isOverAxis(n, i, o)
  }})
})(jQuery);
(function(e, t) {
  var n = 0, r = Array.prototype.slice, i = e.cleanData;
  e.cleanData = function(t) {
    for(var n = 0, r;(r = t[n]) != null;n++) {
      try {
        e(r).triggerHandler("remove")
      }catch(s) {
      }
    }
    i(t)
  }, e.widget = function(t, n, r) {
    var i, s, o, u, a = t.split(".")[0];
    t = t.split(".")[1], i = a + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][i.toLowerCase()] = function(t) {
      return!!e.data(t, i)
    }, e[a] = e[a] || {}, s = e[a][t], o = e[a][t] = function(e, t) {
      if(!this._createWidget) {
        return new o(e, t)
      }
      arguments.length && this._createWidget(e, t)
    }, e.extend(o, s, {version:r.version, _proto:e.extend({}, r), _childConstructors:[]}), u = new n, u.options = e.widget.extend({}, u.options), e.each(r, function(t, i) {
      e.isFunction(i) && (r[t] = function() {
        var e = function() {
          return n.prototype[t].apply(this, arguments)
        }, r = function(e) {
          return n.prototype[t].apply(this, e)
        };
        return function() {
          var t = this._super, n = this._superApply, s;
          return this._super = e, this._superApply = r, s = i.apply(this, arguments), this._super = t, this._superApply = n, s
        }
      }())
    }), o.prototype = e.widget.extend(u, {widgetEventPrefix:s ? u.widgetEventPrefix : t}, r, {constructor:o, namespace:a, widgetName:t, widgetBaseClass:i, widgetFullName:i}), s ? (e.each(s._childConstructors, function(t, n) {
      var r = n.prototype;
      e.widget(r.namespace + "." + r.widgetName, o, n._proto)
    }), delete s._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o)
  }, e.widget.extend = function(n) {
    var i = r.call(arguments, 1), s = 0, o = i.length, u, a;
    for(;s < o;s++) {
      for(u in i[s]) {
        a = i[s][u], i[s].hasOwnProperty(u) && a !== t && (e.isPlainObject(a) ? n[u] = e.isPlainObject(n[u]) ? e.widget.extend({}, n[u], a) : e.widget.extend({}, a) : n[u] = a)
      }
    }
    return n
  }, e.widget.bridge = function(n, i) {
    var s = i.prototype.widgetFullName || n;
    e.fn[n] = function(o) {
      var u = typeof o == "string", a = r.call(arguments, 1), f = this;
      return o = !u && a.length ? e.widget.extend.apply(null, [o].concat(a)) : o, u ? this.each(function() {
        var r, i = e.data(this, s);
        if(!i) {
          return e.error("cannot call methods on " + n + " prior to initialization; " + "attempted to call method '" + o + "'")
        }
        if(!e.isFunction(i[o]) || o.charAt(0) === "_") {
          return e.error("no such method '" + o + "' for " + n + " widget instance")
        }
        r = i[o].apply(i, a);
        if(r !== i && r !== t) {
          return f = r && r.jquery ? f.pushStack(r.get()) : r, !1
        }
      }) : this.each(function() {
        var t = e.data(this, s);
        t ? t.option(o || {})._init() : e.data(this, s, new i(o, this))
      }), f
    }
  }, e.Widget = function() {
  }, e.Widget._childConstructors = [], e.Widget.prototype = {widgetName:"widget", widgetEventPrefix:"", defaultElement:"<div>", options:{disabled:!1, create:null}, _createWidget:function(t, r) {
    r = e(r || this.defaultElement || this)[0], this.element = e(r), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), r !== this && (e.data(r, this.widgetName, this), e.data(r, this.widgetFullName, this), this._on(!0, this.element, {remove:function(e) {
      e.target === r && this.destroy()
    }}), this.document = e(r.style ? r.ownerDocument : r.document || r), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
  }, _getCreateOptions:e.noop, _getCreateEventData:e.noop, _create:e.noop, _init:e.noop, destroy:function() {
    this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
  }, _destroy:e.noop, widget:function() {
    return this.element
  }, option:function(n, r) {
    var i = n, s, o, u;
    if(arguments.length === 0) {
      return e.widget.extend({}, this.options)
    }
    if(typeof n == "string") {
      i = {}, s = n.split("."), n = s.shift();
      if(s.length) {
        o = i[n] = e.widget.extend({}, this.options[n]);
        for(u = 0;u < s.length - 1;u++) {
          o[s[u]] = o[s[u]] || {}, o = o[s[u]]
        }
        n = s.pop();
        if(r === t) {
          return o[n] === t ? null : o[n]
        }
        o[n] = r
      }else {
        if(r === t) {
          return this.options[n] === t ? null : this.options[n]
        }
        i[n] = r
      }
    }
    return this._setOptions(i), this
  }, _setOptions:function(e) {
    var t;
    for(t in e) {
      this._setOption(t, e[t])
    }
    return this
  }, _setOption:function(e, t) {
    return this.options[e] = t, e === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
  }, enable:function() {
    return this._setOption("disabled", !1)
  }, disable:function() {
    return this._setOption("disabled", !0)
  }, _on:function(t, n, r) {
    var i, s = this;
    typeof t != "boolean" && (r = n, n = t, t = !1), r ? (n = i = e(n), this.bindings = this.bindings.add(n)) : (r = n, n = this.element, i = this.widget()), e.each(r, function(r, o) {
      function u() {
        if(!t && (s.options.disabled === !0 || e(this).hasClass("ui-state-disabled"))) {
          return
        }
        return(typeof o == "string" ? s[o] : o).apply(s, arguments)
      }
      typeof o != "string" && (u.guid = o.guid = o.guid || u.guid || e.guid++);
      var a = r.match(/^(\w+)\s*(.*)$/), f = a[1] + s.eventNamespace, l = a[2];
      l ? i.delegate(l, f, u) : n.bind(f, u)
    })
  }, _off:function(e, t) {
    t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
  }, _delay:function(e, t) {
    function n() {
      return(typeof e == "string" ? r[e] : e).apply(r, arguments)
    }
    var r = this;
    return setTimeout(n, t || 0)
  }, _hoverable:function(t) {
    this.hoverable = this.hoverable.add(t), this._on(t, {mouseenter:function(t) {
      e(t.currentTarget).addClass("ui-state-hover")
    }, mouseleave:function(t) {
      e(t.currentTarget).removeClass("ui-state-hover")
    }})
  }, _focusable:function(t) {
    this.focusable = this.focusable.add(t), this._on(t, {focusin:function(t) {
      e(t.currentTarget).addClass("ui-state-focus")
    }, focusout:function(t) {
      e(t.currentTarget).removeClass("ui-state-focus")
    }})
  }, _trigger:function(t, n, r) {
    var i, s, o = this.options[t];
    r = r || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], s = n.originalEvent;
    if(s) {
      for(i in s) {
        i in n || (n[i] = s[i])
      }
    }
    return this.element.trigger(n, r), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(r)) === !1 || n.isDefaultPrevented())
  }}, e.each({show:"fadeIn", hide:"fadeOut"}, function(t, n) {
    e.Widget.prototype["_" + t] = function(r, i, s) {
      typeof i == "string" && (i = {effect:i});
      var o, u = i ? i === !0 || typeof i == "number" ? n : i.effect || n : t;
      i = i || {}, typeof i == "number" && (i = {duration:i}), o = !e.isEmptyObject(i), i.complete = s, i.delay && r.delay(i.delay), o && e.effects && (e.effects.effect[u] || e.uiBackCompat !== !1 && e.effects[u]) ? r[t](i) : u !== t && r[u] ? r[u](i.duration, i.easing, s) : r.queue(function(n) {
        e(this)[t](), s && s.call(r[0]), n()
      })
    }
  }), e.uiBackCompat !== !1 && (e.Widget.prototype._getCreateOptions = function() {
    return e.metadata && e.metadata.get(this.element[0])[this.widgetName]
  })
})(jQuery);
(function(e, t) {
  var n = !1;
  e(document).mouseup(function(e) {
    n = !1
  }), e.widget("ui.mouse", {version:"1.9.2", options:{cancel:"input,textarea,button,select,option", distance:1, delay:0}, _mouseInit:function() {
    var t = this;
    this.element.bind("mousedown." + this.widgetName, function(e) {
      return t._mouseDown(e)
    }).bind("click." + this.widgetName, function(n) {
      if(!0 === e.data(n.target, t.widgetName + ".preventClickEvent")) {
        return e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1
      }
    }), this.started = !1
  }, _mouseDestroy:function() {
    this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
  }, _mouseDown:function(t) {
    if(n) {
      return
    }
    this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t;
    var r = this, i = t.which === 1, s = typeof this.options.cancel == "string" && t.target.nodeName ? e(t.target).closest(this.options.cancel).length : !1;
    if(!i || s || !this._mouseCapture(t)) {
      return!0
    }
    this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
      r.mouseDelayMet = !0
    }, this.options.delay));
    if(this._mouseDistanceMet(t) && this._mouseDelayMet(t)) {
      this._mouseStarted = this._mouseStart(t) !== !1;
      if(!this._mouseStarted) {
        return t.preventDefault(), !0
      }
    }
    return!0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
      return r._mouseMove(e)
    }, this._mouseUpDelegate = function(e) {
      return r._mouseUp(e)
    }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), n = !0, !0
  }, _mouseMove:function(t) {
    return!e.ui.ie || document.documentMode >= 9 || !!t.button ? this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted) : this._mouseUp(t)
  }, _mouseUp:function(t) {
    return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
  }, _mouseDistanceMet:function(e) {
    return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
  }, _mouseDelayMet:function(e) {
    return this.mouseDelayMet
  }, _mouseStart:function(e) {
  }, _mouseDrag:function(e) {
  }, _mouseStop:function(e) {
  }, _mouseCapture:function(e) {
    return!0
  }})
})(jQuery);
(function(e, t) {
  function h(e, t, n) {
    return[parseInt(e[0], 10) * (l.test(e[0]) ? t / 100 : 1), parseInt(e[1], 10) * (l.test(e[1]) ? n / 100 : 1)]
  }
  function p(t, n) {
    return parseInt(e.css(t, n), 10) || 0
  }
  e.ui = e.ui || {};
  var n, r = Math.max, i = Math.abs, s = Math.round, o = /left|center|right/, u = /top|center|bottom/, a = /[\+\-]\d+%?/, f = /^\w+/, l = /%$/, c = e.fn.position;
  e.position = {scrollbarWidth:function() {
    if(n !== t) {
      return n
    }
    var r, i, s = e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"), o = s.children()[0];
    return e("body").append(s), r = o.offsetWidth, s.css("overflow", "scroll"), i = o.offsetWidth, r === i && (i = s[0].clientWidth), s.remove(), n = r - i
  }, getScrollInfo:function(t) {
    var n = t.isWindow ? "" : t.element.css("overflow-x"), r = t.isWindow ? "" : t.element.css("overflow-y"), i = n === "scroll" || n === "auto" && t.width < t.element[0].scrollWidth, s = r === "scroll" || r === "auto" && t.height < t.element[0].scrollHeight;
    return{width:i ? e.position.scrollbarWidth() : 0, height:s ? e.position.scrollbarWidth() : 0}
  }, getWithinInfo:function(t) {
    var n = e(t || window), r = e.isWindow(n[0]);
    return{element:n, isWindow:r, offset:n.offset() || {left:0, top:0}, scrollLeft:n.scrollLeft(), scrollTop:n.scrollTop(), width:r ? n.width() : n.outerWidth(), height:r ? n.height() : n.outerHeight()}
  }}, e.fn.position = function(t) {
    if(!t || !t.of) {
      return c.apply(this, arguments)
    }
    t = e.extend({}, t);
    var n, l, d, v, m, g = e(t.of), y = e.position.getWithinInfo(t.within), b = e.position.getScrollInfo(y), w = g[0], E = (t.collision || "flip").split(" "), S = {};
    return w.nodeType === 9 ? (l = g.width(), d = g.height(), v = {top:0, left:0}) : e.isWindow(w) ? (l = g.width(), d = g.height(), v = {top:g.scrollTop(), left:g.scrollLeft()}) : w.preventDefault ? (t.at = "left top", l = d = 0, v = {top:w.pageY, left:w.pageX}) : (l = g.outerWidth(), d = g.outerHeight(), v = g.offset()), m = e.extend({}, v), e.each(["my", "at"], function() {
      var e = (t[this] || "").split(" "), n, r;
      e.length === 1 && (e = o.test(e[0]) ? e.concat(["center"]) : u.test(e[0]) ? ["center"].concat(e) : ["center", "center"]), e[0] = o.test(e[0]) ? e[0] : "center", e[1] = u.test(e[1]) ? e[1] : "center", n = a.exec(e[0]), r = a.exec(e[1]), S[this] = [n ? n[0] : 0, r ? r[0] : 0], t[this] = [f.exec(e[0])[0], f.exec(e[1])[0]]
    }), E.length === 1 && (E[1] = E[0]), t.at[0] === "right" ? m.left += l : t.at[0] === "center" && (m.left += l / 2), t.at[1] === "bottom" ? m.top += d : t.at[1] === "center" && (m.top += d / 2), n = h(S.at, l, d), m.left += n[0], m.top += n[1], this.each(function() {
      var o, u, a = e(this), f = a.outerWidth(), c = a.outerHeight(), w = p(this, "marginLeft"), x = p(this, "marginTop"), T = f + w + p(this, "marginRight") + b.width, N = c + x + p(this, "marginBottom") + b.height, C = e.extend({}, m), k = h(S.my, a.outerWidth(), a.outerHeight());
      t.my[0] === "right" ? C.left -= f : t.my[0] === "center" && (C.left -= f / 2), t.my[1] === "bottom" ? C.top -= c : t.my[1] === "center" && (C.top -= c / 2), C.left += k[0], C.top += k[1], e.support.offsetFractions || (C.left = s(C.left), C.top = s(C.top)), o = {marginLeft:w, marginTop:x}, e.each(["left", "top"], function(r, i) {
        e.ui.position[E[r]] && e.ui.position[E[r]][i](C, {targetWidth:l, targetHeight:d, elemWidth:f, elemHeight:c, collisionPosition:o, collisionWidth:T, collisionHeight:N, offset:[n[0] + k[0], n[1] + k[1]], my:t.my, at:t.at, within:y, elem:a})
      }), e.fn.bgiframe && a.bgiframe(), t.using && (u = function(e) {
        var n = v.left - C.left, s = n + l - f, o = v.top - C.top, u = o + d - c, h = {target:{element:g, left:v.left, top:v.top, width:l, height:d}, element:{element:a, left:C.left, top:C.top, width:f, height:c}, horizontal:s < 0 ? "left" : n > 0 ? "right" : "center", vertical:u < 0 ? "top" : o > 0 ? "bottom" : "middle"};
        l < f && i(n + s) < l && (h.horizontal = "center"), d < c && i(o + u) < d && (h.vertical = "middle"), r(i(n), i(s)) > r(i(o), i(u)) ? h.important = "horizontal" : h.important = "vertical", t.using.call(this, e, h)
      }), a.offset(e.extend(C, {using:u}))
    })
  }, e.ui.position = {fit:{left:function(e, t) {
    var n = t.within, i = n.isWindow ? n.scrollLeft : n.offset.left, s = n.width, o = e.left - t.collisionPosition.marginLeft, u = i - o, a = o + t.collisionWidth - s - i, f;
    t.collisionWidth > s ? u > 0 && a <= 0 ? (f = e.left + u + t.collisionWidth - s - i, e.left += u - f) : a > 0 && u <= 0 ? e.left = i : u > a ? e.left = i + s - t.collisionWidth : e.left = i : u > 0 ? e.left += u : a > 0 ? e.left -= a : e.left = r(e.left - o, e.left)
  }, top:function(e, t) {
    var n = t.within, i = n.isWindow ? n.scrollTop : n.offset.top, s = t.within.height, o = e.top - t.collisionPosition.marginTop, u = i - o, a = o + t.collisionHeight - s - i, f;
    t.collisionHeight > s ? u > 0 && a <= 0 ? (f = e.top + u + t.collisionHeight - s - i, e.top += u - f) : a > 0 && u <= 0 ? e.top = i : u > a ? e.top = i + s - t.collisionHeight : e.top = i : u > 0 ? e.top += u : a > 0 ? e.top -= a : e.top = r(e.top - o, e.top)
  }}, flip:{left:function(e, t) {
    var n = t.within, r = n.offset.left + n.scrollLeft, s = n.width, o = n.isWindow ? n.scrollLeft : n.offset.left, u = e.left - t.collisionPosition.marginLeft, a = u - o, f = u + t.collisionWidth - s - o, l = t.my[0] === "left" ? -t.elemWidth : t.my[0] === "right" ? t.elemWidth : 0, c = t.at[0] === "left" ? t.targetWidth : t.at[0] === "right" ? -t.targetWidth : 0, h = -2 * t.offset[0], p, d;
    if(a < 0) {
      p = e.left + l + c + h + t.collisionWidth - s - r;
      if(p < 0 || p < i(a)) {
        e.left += l + c + h
      }
    }else {
      if(f > 0) {
        d = e.left - t.collisionPosition.marginLeft + l + c + h - o;
        if(d > 0 || i(d) < f) {
          e.left += l + c + h
        }
      }
    }
  }, top:function(e, t) {
    var n = t.within, r = n.offset.top + n.scrollTop, s = n.height, o = n.isWindow ? n.scrollTop : n.offset.top, u = e.top - t.collisionPosition.marginTop, a = u - o, f = u + t.collisionHeight - s - o, l = t.my[1] === "top", c = l ? -t.elemHeight : t.my[1] === "bottom" ? t.elemHeight : 0, h = t.at[1] === "top" ? t.targetHeight : t.at[1] === "bottom" ? -t.targetHeight : 0, p = -2 * t.offset[1], d, v;
    a < 0 ? (v = e.top + c + h + p + t.collisionHeight - s - r, e.top + c + h + p > a && (v < 0 || v < i(a)) && (e.top += c + h + p)) : f > 0 && (d = e.top - t.collisionPosition.marginTop + c + h + p - o, e.top + c + h + p > f && (d > 0 || i(d) < f) && (e.top += c + h + p))
  }}, flipfit:{left:function() {
    e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments)
  }, top:function() {
    e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments)
  }}}, function() {
    var t, n, r, i, s, o = document.getElementsByTagName("body")[0], u = document.createElement("div");
    t = document.createElement(o ? "div" : "body"), r = {visibility:"hidden", width:0, height:0, border:0, margin:0, background:"none"}, o && e.extend(r, {position:"absolute", left:"-1000px", top:"-1000px"});
    for(s in r) {
      t.style[s] = r[s]
    }
    t.appendChild(u), n = o || document.documentElement, n.insertBefore(t, n.firstChild), u.style.cssText = "position: absolute; left: 10.7432222px;", i = e(u).offset().left, e.support.offsetFractions = i > 10 && i < 11, t.innerHTML = "", n.removeChild(t)
  }(), e.uiBackCompat !== !1 && function(e) {
    var n = e.fn.position;
    e.fn.position = function(r) {
      if(!r || !r.offset) {
        return n.call(this, r)
      }
      var i = r.offset.split(" "), s = r.at.split(" ");
      return i.length === 1 && (i[1] = i[0]), /^\d/.test(i[0]) && (i[0] = "+" + i[0]), /^\d/.test(i[1]) && (i[1] = "+" + i[1]), s.length === 1 && (/left|center|right/.test(s[0]) ? s[1] = "center" : (s[1] = s[0], s[0] = "center")), n.call(this, e.extend(r, {at:s[0] + i[0] + " " + s[1] + i[1], offset:t}))
    }
  }(jQuery)
})(jQuery);
(function(e, t) {
  e.widget("ui.draggable", e.ui.mouse, {version:"1.9.2", widgetEventPrefix:"drag", options:{addClasses:!0, appendTo:"parent", axis:!1, connectToSortable:!1, containment:!1, cursor:"auto", cursorAt:!1, grid:!1, handle:!1, helper:"original", iframeFix:!1, opacity:!1, refreshPositions:!1, revert:!1, revertDuration:500, scope:"default", scroll:!0, scrollSensitivity:20, scrollSpeed:20, snap:!1, snapMode:"both", snapTolerance:20, stack:!1, zIndex:!1}, _create:function() {
    this.options.helper == "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
  }, _destroy:function() {
    this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
  }, _mouseCapture:function(t) {
    var n = this.options;
    return this.helper || n.disabled || e(t.target).is(".ui-resizable-handle") ? !1 : (this.handle = this._getHandle(t), this.handle ? (e(n.iframeFix === !0 ? "iframe" : n.iframeFix).each(function() {
      e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth + "px", height:this.offsetHeight + "px", position:"absolute", opacity:"0.001", zIndex:1E3}).css(e(this).offset()).appendTo("body")
    }), !0) : !1)
  }, _mouseStart:function(t) {
    var n = this.options;
    return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, e.extend(this.offset, {click:{left:t.pageX - this.offset.left, 
    top:t.pageY - this.offset.top}, parent:this._getParentOffset(), relative:this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, n.cursorAt && this._adjustOffsetFromHelper(n.cursorAt), n.containment && this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, 
    !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
  }, _mouseDrag:function(t, n) {
    this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute");
    if(!n) {
      var r = this._uiHash();
      if(this._trigger("drag", t, r) === !1) {
        return this._mouseUp({}), !1
      }
      this.position = r.position
    }
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    return e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1
  }, _mouseStop:function(t) {
    var n = !1;
    e.ui.ddmanager && !this.options.dropBehaviour && (n = e.ui.ddmanager.drop(this, t)), this.dropped && (n = this.dropped, this.dropped = !1);
    var r = this.element[0], i = !1;
    while(r && (r = r.parentNode)) {
      r == document && (i = !0)
    }
    if(!i && this.options.helper === "original") {
      return!1
    }
    if(this.options.revert == "invalid" && !n || this.options.revert == "valid" && n || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, n)) {
      var s = this;
      e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
        s._trigger("stop", t) !== !1 && s._clear()
      })
    }else {
      this._trigger("stop", t) !== !1 && this._clear()
    }
    return!1
  }, _mouseUp:function(t) {
    return e("div.ui-draggable-iframeFix").each(function() {
      this.parentNode.removeChild(this)
    }), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t)
  }, cancel:function() {
    return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
  }, _getHandle:function(t) {
    var n = !this.options.handle || !e(this.options.handle, this.element).length ? !0 : !1;
    return e(this.options.handle, this.element).find("*").andSelf().each(function() {
      this == t.target && (n = !0)
    }), n
  }, _createHelper:function(t) {
    var n = this.options, r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t])) : n.helper == "clone" ? this.element.clone().removeAttr("id") : this.element;
    return r.parents("body").length || r.appendTo(n.appendTo == "parent" ? this.element[0].parentNode : n.appendTo), r[0] != this.element[0] && !/(fixed|absolute)/.test(r.css("position")) && r.css("position", "absolute"), r
  }, _adjustOffsetFromHelper:function(t) {
    typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {left:+t[0], top:+t[1] || 0}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var t = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && e.ui.ie) {
      t = {top:0, left:0}
    }
    return{top:t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var e = this.element.position();
      return{top:e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.element.css("marginLeft"), 10) || 0, top:parseInt(this.element.css("marginTop"), 10) || 0, right:parseInt(this.element.css("marginRight"), 10) || 0, bottom:parseInt(this.element.css("marginBottom"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var t = this.options;
    t.containment == "parent" && (t.containment = this.helper[0].parentNode);
    if(t.containment == "document" || t.containment == "window") {
      this.containment = [t.containment == "document" ? 0 : e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, t.containment == "document" ? 0 : e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (t.containment == "document" ? 0 : e(window).scrollLeft()) + e(t.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (t.containment == "document" ? 0 : e(window).scrollTop()) + (e(t.containment == "document" ? 
      document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(t.containment) && t.containment.constructor != Array) {
      var n = e(t.containment), r = n[0];
      if(!r) {
        return
      }
      var i = n.offset(), s = e(r).css("overflow") != "hidden";
      this.containment = [(parseInt(e(r).css("borderLeftWidth"), 10) || 0) + (parseInt(e(r).css("paddingLeft"), 10) || 0), (parseInt(e(r).css("borderTopWidth"), 10) || 0) + (parseInt(e(r).css("paddingTop"), 10) || 0), (s ? Math.max(r.scrollWidth, r.offsetWidth) : r.offsetWidth) - (parseInt(e(r).css("borderLeftWidth"), 10) || 0) - (parseInt(e(r).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (s ? Math.max(r.scrollHeight, r.offsetHeight) : r.offsetHeight) - 
      (parseInt(e(r).css("borderTopWidth"), 10) || 0) - (parseInt(e(r).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = n
    }else {
      t.containment.constructor == Array && (this.containment = t.containment)
    }
  }, _convertPositionTo:function(t, n) {
    n || (n = this.position);
    var r = t == "absolute" ? 1 : -1, i = this.options, s = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, o = /(html|body)/i.test(s[0].tagName);
    return{top:n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : o ? 0 : s.scrollTop()) * r, left:n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : o ? 0 : s.scrollLeft()) * r}
  }, _generatePosition:function(t) {
    var n = this.options, r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName), s = t.pageX, o = t.pageY;
    if(this.originalPosition) {
      var u;
      if(this.containment) {
        if(this.relative_container) {
          var a = this.relative_container.offset();
          u = [this.containment[0] + a.left, this.containment[1] + a.top, this.containment[2] + a.left, this.containment[3] + a.top]
        }else {
          u = this.containment
        }
        t.pageX - this.offset.click.left < u[0] && (s = u[0] + this.offset.click.left), t.pageY - this.offset.click.top < u[1] && (o = u[1] + this.offset.click.top), t.pageX - this.offset.click.left > u[2] && (s = u[2] + this.offset.click.left), t.pageY - this.offset.click.top > u[3] && (o = u[3] + this.offset.click.top)
      }
      if(n.grid) {
        var f = n.grid[1] ? this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1] : this.originalPageY;
        o = u ? f - this.offset.click.top < u[1] || f - this.offset.click.top > u[3] ? f - this.offset.click.top < u[1] ? f + n.grid[1] : f - n.grid[1] : f : f;
        var l = n.grid[0] ? this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0] : this.originalPageX;
        s = u ? l - this.offset.click.left < u[0] || l - this.offset.click.left > u[2] ? l - this.offset.click.left < u[0] ? l + n.grid[0] : l - n.grid[0] : l : l
      }
    }
    return{top:o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()), left:s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft())}
  }, _clear:function() {
    this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
  }, _trigger:function(t, n, r) {
    return r = r || this._uiHash(), e.ui.plugin.call(this, t, [n, r]), t == "drag" && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, n, r)
  }, plugins:{}, _uiHash:function(e) {
    return{helper:this.helper, position:this.position, originalPosition:this.originalPosition, offset:this.positionAbs}
  }}), e.ui.plugin.add("draggable", "connectToSortable", {start:function(t, n) {
    var r = e(this).data("draggable"), i = r.options, s = e.extend({}, n, {item:r.element});
    r.sortables = [], e(i.connectToSortable).each(function() {
      var n = e.data(this, "sortable");
      n && !n.options.disabled && (r.sortables.push({instance:n, shouldRevert:n.options.revert}), n.refreshPositions(), n._trigger("activate", t, s))
    })
  }, stop:function(t, n) {
    var r = e(this).data("draggable"), i = e.extend({}, n, {item:r.element});
    e.each(r.sortables, function() {
      this.instance.isOver ? (this.instance.isOver = 0, r.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, r.options.helper == "original" && this.instance.currentItem.css({top:"auto", left:"auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, i))
    })
  }, drag:function(t, n) {
    var r = e(this).data("draggable"), i = this, s = function(t) {
      var n = this.offset.click.top, r = this.offset.click.left, i = this.positionAbs.top, s = this.positionAbs.left, o = t.height, u = t.width, a = t.top, f = t.left;
      return e.ui.isOver(i + n, s + r, a, f, o, u)
    };
    e.each(r.sortables, function(s) {
      var o = !1, u = this;
      this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (o = !0, e.each(r.sortables, function() {
        return this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this != u && this.instance._intersectsWith(this.instance.containerCache) && e.ui.contains(u.instance.element[0], this.instance.element[0]) && (o = !1), o
      })), o ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
        return n.helper[0]
      }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = r.offset.click.top, this.instance.offset.click.left = r.offset.click.left, this.instance.offset.parent.left -= r.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= r.offset.parent.top - this.instance.offset.parent.top, r._trigger("toSortable", t), r.dropped = this.instance.element, r.currentItem = r.element, 
      this.instance.fromOutside = r), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), r._trigger("fromSortable", 
      t), r.dropped = !1)
    })
  }}), e.ui.plugin.add("draggable", "cursor", {start:function(t, n) {
    var r = e("body"), i = e(this).data("draggable").options;
    r.css("cursor") && (i._cursor = r.css("cursor")), r.css("cursor", i.cursor)
  }, stop:function(t, n) {
    var r = e(this).data("draggable").options;
    r._cursor && e("body").css("cursor", r._cursor)
  }}), e.ui.plugin.add("draggable", "opacity", {start:function(t, n) {
    var r = e(n.helper), i = e(this).data("draggable").options;
    r.css("opacity") && (i._opacity = r.css("opacity")), r.css("opacity", i.opacity)
  }, stop:function(t, n) {
    var r = e(this).data("draggable").options;
    r._opacity && e(n.helper).css("opacity", r._opacity)
  }}), e.ui.plugin.add("draggable", "scroll", {start:function(t, n) {
    var r = e(this).data("draggable");
    r.scrollParent[0] != document && r.scrollParent[0].tagName != "HTML" && (r.overflowOffset = r.scrollParent.offset())
  }, drag:function(t, n) {
    var r = e(this).data("draggable"), i = r.options, s = !1;
    if(r.scrollParent[0] != document && r.scrollParent[0].tagName != "HTML") {
      if(!i.axis || i.axis != "x") {
        r.overflowOffset.top + r.scrollParent[0].offsetHeight - t.pageY < i.scrollSensitivity ? r.scrollParent[0].scrollTop = s = r.scrollParent[0].scrollTop + i.scrollSpeed : t.pageY - r.overflowOffset.top < i.scrollSensitivity && (r.scrollParent[0].scrollTop = s = r.scrollParent[0].scrollTop - i.scrollSpeed)
      }
      if(!i.axis || i.axis != "y") {
        r.overflowOffset.left + r.scrollParent[0].offsetWidth - t.pageX < i.scrollSensitivity ? r.scrollParent[0].scrollLeft = s = r.scrollParent[0].scrollLeft + i.scrollSpeed : t.pageX - r.overflowOffset.left < i.scrollSensitivity && (r.scrollParent[0].scrollLeft = s = r.scrollParent[0].scrollLeft - i.scrollSpeed)
      }
    }else {
      if(!i.axis || i.axis != "x") {
        t.pageY - e(document).scrollTop() < i.scrollSensitivity ? s = e(document).scrollTop(e(document).scrollTop() - i.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < i.scrollSensitivity && (s = e(document).scrollTop(e(document).scrollTop() + i.scrollSpeed))
      }
      if(!i.axis || i.axis != "y") {
        t.pageX - e(document).scrollLeft() < i.scrollSensitivity ? s = e(document).scrollLeft(e(document).scrollLeft() - i.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < i.scrollSensitivity && (s = e(document).scrollLeft(e(document).scrollLeft() + i.scrollSpeed))
      }
    }
    s !== !1 && e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(r, t)
  }}), e.ui.plugin.add("draggable", "snap", {start:function(t, n) {
    var r = e(this).data("draggable"), i = r.options;
    r.snapElements = [], e(i.snap.constructor != String ? i.snap.items || ":data(draggable)" : i.snap).each(function() {
      var t = e(this), n = t.offset();
      this != r.element[0] && r.snapElements.push({item:this, width:t.outerWidth(), height:t.outerHeight(), top:n.top, left:n.left})
    })
  }, drag:function(t, n) {
    var r = e(this).data("draggable"), i = r.options, s = i.snapTolerance, o = n.offset.left, u = o + r.helperProportions.width, a = n.offset.top, f = a + r.helperProportions.height;
    for(var l = r.snapElements.length - 1;l >= 0;l--) {
      var c = r.snapElements[l].left, h = c + r.snapElements[l].width, p = r.snapElements[l].top, d = p + r.snapElements[l].height;
      if(!(c - s < o && o < h + s && p - s < a && a < d + s || c - s < o && o < h + s && p - s < f && f < d + s || c - s < u && u < h + s && p - s < a && a < d + s || c - s < u && u < h + s && p - s < f && f < d + s)) {
        r.snapElements[l].snapping && r.options.snap.release && r.options.snap.release.call(r.element, t, e.extend(r._uiHash(), {snapItem:r.snapElements[l].item})), r.snapElements[l].snapping = !1;
        continue
      }
      if(i.snapMode != "inner") {
        var v = Math.abs(p - f) <= s, m = Math.abs(d - a) <= s, g = Math.abs(c - u) <= s, y = Math.abs(h - o) <= s;
        v && (n.position.top = r._convertPositionTo("relative", {top:p - r.helperProportions.height, left:0}).top - r.margins.top), m && (n.position.top = r._convertPositionTo("relative", {top:d, left:0}).top - r.margins.top), g && (n.position.left = r._convertPositionTo("relative", {top:0, left:c - r.helperProportions.width}).left - r.margins.left), y && (n.position.left = r._convertPositionTo("relative", {top:0, left:h}).left - r.margins.left)
      }
      var b = v || m || g || y;
      if(i.snapMode != "outer") {
        var v = Math.abs(p - a) <= s, m = Math.abs(d - f) <= s, g = Math.abs(c - o) <= s, y = Math.abs(h - u) <= s;
        v && (n.position.top = r._convertPositionTo("relative", {top:p, left:0}).top - r.margins.top), m && (n.position.top = r._convertPositionTo("relative", {top:d - r.helperProportions.height, left:0}).top - r.margins.top), g && (n.position.left = r._convertPositionTo("relative", {top:0, left:c}).left - r.margins.left), y && (n.position.left = r._convertPositionTo("relative", {top:0, left:h - r.helperProportions.width}).left - r.margins.left)
      }
      !r.snapElements[l].snapping && (v || m || g || y || b) && r.options.snap.snap && r.options.snap.snap.call(r.element, t, e.extend(r._uiHash(), {snapItem:r.snapElements[l].item})), r.snapElements[l].snapping = v || m || g || y || b
    }
  }}), e.ui.plugin.add("draggable", "stack", {start:function(t, n) {
    var r = e(this).data("draggable").options, i = e.makeArray(e(r.stack)).sort(function(t, n) {
      return(parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(n).css("zIndex"), 10) || 0)
    });
    if(!i.length) {
      return
    }
    var s = parseInt(i[0].style.zIndex) || 0;
    e(i).each(function(e) {
      this.style.zIndex = s + e
    }), this[0].style.zIndex = s + i.length
  }}), e.ui.plugin.add("draggable", "zIndex", {start:function(t, n) {
    var r = e(n.helper), i = e(this).data("draggable").options;
    r.css("zIndex") && (i._zIndex = r.css("zIndex")), r.css("zIndex", i.zIndex)
  }, stop:function(t, n) {
    var r = e(this).data("draggable").options;
    r._zIndex && e(n.helper).css("zIndex", r._zIndex)
  }})
})(jQuery);
(function(e, t) {
  e.widget("ui.droppable", {version:"1.9.2", widgetEventPrefix:"drop", options:{accept:"*", activeClass:!1, addClasses:!0, greedy:!1, hoverClass:!1, scope:"default", tolerance:"intersect"}, _create:function() {
    var t = this.options, n = t.accept;
    this.isover = 0, this.isout = 1, this.accept = e.isFunction(n) ? n : function(e) {
      return e.is(n)
    }, this.proportions = {width:this.element[0].offsetWidth, height:this.element[0].offsetHeight}, e.ui.ddmanager.droppables[t.scope] = e.ui.ddmanager.droppables[t.scope] || [], e.ui.ddmanager.droppables[t.scope].push(this), t.addClasses && this.element.addClass("ui-droppable")
  }, _destroy:function() {
    var t = e.ui.ddmanager.droppables[this.options.scope];
    for(var n = 0;n < t.length;n++) {
      t[n] == this && t.splice(n, 1)
    }
    this.element.removeClass("ui-droppable ui-droppable-disabled")
  }, _setOption:function(t, n) {
    t == "accept" && (this.accept = e.isFunction(n) ? n : function(e) {
      return e.is(n)
    }), e.Widget.prototype._setOption.apply(this, arguments)
  }, _activate:function(t) {
    var n = e.ui.ddmanager.current;
    this.options.activeClass && this.element.addClass(this.options.activeClass), n && this._trigger("activate", t, this.ui(n))
  }, _deactivate:function(t) {
    var n = e.ui.ddmanager.current;
    this.options.activeClass && this.element.removeClass(this.options.activeClass), n && this._trigger("deactivate", t, this.ui(n))
  }, _over:function(t) {
    var n = e.ui.ddmanager.current;
    if(!n || (n.currentItem || n.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(n)))
  }, _out:function(t) {
    var n = e.ui.ddmanager.current;
    if(!n || (n.currentItem || n.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(n)))
  }, _drop:function(t, n) {
    var r = n || e.ui.ddmanager.current;
    if(!r || (r.currentItem || r.element)[0] == this.element[0]) {
      return!1
    }
    var i = !1;
    return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function() {
      var t = e.data(this, "droppable");
      if(t.options.greedy && !t.options.disabled && t.options.scope == r.options.scope && t.accept.call(t.element[0], r.currentItem || r.element) && e.ui.intersect(r, e.extend(t, {offset:t.element.offset()}), t.options.tolerance)) {
        return i = !0, !1
      }
    }), i ? !1 : this.accept.call(this.element[0], r.currentItem || r.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(r)), this.element) : !1
  }, ui:function(e) {
    return{draggable:e.currentItem || e.element, helper:e.helper, position:e.position, offset:e.positionAbs}
  }}), e.ui.intersect = function(t, n, r) {
    if(!n.offset) {
      return!1
    }
    var i = (t.positionAbs || t.position.absolute).left, s = i + t.helperProportions.width, o = (t.positionAbs || t.position.absolute).top, u = o + t.helperProportions.height, a = n.offset.left, f = a + n.proportions.width, l = n.offset.top, c = l + n.proportions.height;
    switch(r) {
      case "fit":
        return a <= i && s <= f && l <= o && u <= c;
      case "intersect":
        return a < i + t.helperProportions.width / 2 && s - t.helperProportions.width / 2 < f && l < o + t.helperProportions.height / 2 && u - t.helperProportions.height / 2 < c;
      case "pointer":
        var h = (t.positionAbs || t.position.absolute).left + (t.clickOffset || t.offset.click).left, p = (t.positionAbs || t.position.absolute).top + (t.clickOffset || t.offset.click).top, d = e.ui.isOver(p, h, l, a, n.proportions.height, n.proportions.width);
        return d;
      case "touch":
        return(o >= l && o <= c || u >= l && u <= c || o < l && u > c) && (i >= a && i <= f || s >= a && s <= f || i < a && s > f);
      default:
        return!1
    }
  }, e.ui.ddmanager = {current:null, droppables:{"default":[]}, prepareOffsets:function(t, n) {
    var r = e.ui.ddmanager.droppables[t.options.scope] || [], i = n ? n.type : null, s = (t.currentItem || t.element).find(":data(droppable)").andSelf();
    e:for(var o = 0;o < r.length;o++) {
      if(r[o].options.disabled || t && !r[o].accept.call(r[o].element[0], t.currentItem || t.element)) {
        continue
      }
      for(var u = 0;u < s.length;u++) {
        if(s[u] == r[o].element[0]) {
          r[o].proportions.height = 0;
          continue e
        }
      }
      r[o].visible = r[o].element.css("display") != "none";
      if(!r[o].visible) {
        continue
      }
      i == "mousedown" && r[o]._activate.call(r[o], n), r[o].offset = r[o].element.offset(), r[o].proportions = {width:r[o].element[0].offsetWidth, height:r[o].element[0].offsetHeight}
    }
  }, drop:function(t, n) {
    var r = !1;
    return e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
      if(!this.options) {
        return
      }
      !this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance) && (r = this._drop.call(this, n) || r), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = 1, this.isover = 0, this._deactivate.call(this, n))
    }), r
  }, dragStart:function(t, n) {
    t.element.parentsUntil("body").bind("scroll.droppable", function() {
      t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
    })
  }, drag:function(t, n) {
    t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, n), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
      if(this.options.disabled || this.greedyChild || !this.visible) {
        return
      }
      var r = e.ui.intersect(t, this, this.options.tolerance), i = !r && this.isover == 1 ? "isout" : r && this.isover == 0 ? "isover" : null;
      if(!i) {
        return
      }
      var s;
      if(this.options.greedy) {
        var o = this.options.scope, u = this.element.parents(":data(droppable)").filter(function() {
          return e.data(this, "droppable").options.scope === o
        });
        u.length && (s = e.data(u[0], "droppable"), s.greedyChild = i == "isover" ? 1 : 0)
      }
      s && i == "isover" && (s.isover = 0, s.isout = 1, s._out.call(s, n)), this[i] = 1, this[i == "isout" ? "isover" : "isout"] = 0, this[i == "isover" ? "_over" : "_out"].call(this, n), s && i == "isout" && (s.isout = 0, s.isover = 1, s._over.call(s, n))
    })
  }, dragStop:function(t, n) {
    t.element.parentsUntil("body").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
  }}
})(jQuery);
(function(e, t) {
  e.widget("ui.sortable", e.ui.mouse, {version:"1.9.2", widgetEventPrefix:"sort", ready:!1, options:{appendTo:"parent", axis:!1, connectWith:!1, containment:!1, cursor:"auto", cursorAt:!1, dropOnEmpty:!0, forcePlaceholderSize:!1, forceHelperSize:!1, grid:!1, handle:!1, helper:"original", items:"> *", opacity:!1, placeholder:!1, revert:!1, scroll:!0, scrollSensitivity:20, scrollSpeed:20, scope:"default", tolerance:"intersect", zIndex:1E3}, _create:function() {
    var e = this.options;
    this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? e.axis === "x" || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
  }, _destroy:function() {
    this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
    for(var e = this.items.length - 1;e >= 0;e--) {
      this.items[e].item.removeData(this.widgetName + "-item")
    }
    return this
  }, _setOption:function(t, n) {
    t === "disabled" ? (this.options[t] = n, this.widget().toggleClass("ui-sortable-disabled", !!n)) : e.Widget.prototype._setOption.apply(this, arguments)
  }, _mouseCapture:function(t, n) {
    var r = this;
    if(this.reverting) {
      return!1
    }
    if(this.options.disabled || this.options.type == "static") {
      return!1
    }
    this._refreshItems(t);
    var i = null, s = e(t.target).parents().each(function() {
      if(e.data(this, r.widgetName + "-item") == r) {
        return i = e(this), !1
      }
    });
    e.data(t.target, r.widgetName + "-item") == r && (i = e(t.target));
    if(!i) {
      return!1
    }
    if(this.options.handle && !n) {
      var o = !1;
      e(this.options.handle, i).find("*").andSelf().each(function() {
        this == t.target && (o = !0)
      });
      if(!o) {
        return!1
      }
    }
    return this.currentItem = i, this._removeCurrentsFromItems(), !0
  }, _mouseStart:function(t, n, r) {
    var i = this.options;
    this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, e.extend(this.offset, {click:{left:t.pageX - this.offset.left, top:t.pageY - this.offset.top}, parent:this._getParentOffset(), relative:this._getRelativeOffset()}), 
    this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), this.domPosition = {prev:this.currentItem.prev()[0], parent:this.currentItem.parent()[0]}, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), i.containment && this._setContainment(), i.cursor && (e("body").css("cursor") && 
    (this._storedCursor = e("body").css("cursor")), e("body").css("cursor", i.cursor)), i.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", i.opacity)), i.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", i.zIndex)), this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", 
    t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
    if(!r) {
      for(var s = this.containers.length - 1;s >= 0;s--) {
        this.containers[s]._trigger("activate", t, this._uiHash(this))
      }
    }
    return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
  }, _mouseDrag:function(t) {
    this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
    if(this.options.scroll) {
      var n = this.options, r = !1;
      this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < n.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + n.scrollSpeed : t.pageY - this.overflowOffset.top < n.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - n.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < n.scrollSensitivity ? 
      this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + n.scrollSpeed : t.pageX - this.overflowOffset.left < n.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - n.scrollSpeed)) : (t.pageY - e(document).scrollTop() < n.scrollSensitivity ? r = e(document).scrollTop(e(document).scrollTop() - n.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < n.scrollSensitivity && (r = e(document).scrollTop(e(document).scrollTop() + 
      n.scrollSpeed)), t.pageX - e(document).scrollLeft() < n.scrollSensitivity ? r = e(document).scrollLeft(e(document).scrollLeft() - n.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < n.scrollSensitivity && (r = e(document).scrollLeft(e(document).scrollLeft() + n.scrollSpeed))), r !== !1 && e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)
    }
    this.positionAbs = this._convertPositionTo("absolute");
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    for(var i = this.items.length - 1;i >= 0;i--) {
      var s = this.items[i], o = s.item[0], u = this._intersectsWithPointer(s);
      if(!u) {
        continue
      }
      if(s.instance !== this.currentContainer) {
        continue
      }
      if(o != this.currentItem[0] && this.placeholder[u == 1 ? "next" : "prev"]()[0] != o && !e.contains(this.placeholder[0], o) && (this.options.type == "semi-dynamic" ? !e.contains(this.element[0], o) : !0)) {
        this.direction = u == 1 ? "down" : "up";
        if(this.options.tolerance != "pointer" && !this._intersectsWithSides(s)) {
          break
        }
        this._rearrange(t, s), this._trigger("change", t, this._uiHash());
        break
      }
    }
    return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
  }, _mouseStop:function(t, n) {
    if(!t) {
      return
    }
    e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t);
    if(this.options.revert) {
      var r = this, i = this.placeholder.offset();
      this.reverting = !0, e(this.helper).animate({left:i.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft), top:i.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function() {
        r._clear(t)
      })
    }else {
      this._clear(t, n)
    }
    return!1
  }, cancel:function() {
    if(this.dragging) {
      this._mouseUp({target:null}), this.options.helper == "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
      for(var t = this.containers.length - 1;t >= 0;t--) {
        this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
      }
    }
    return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper != "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {helper:null, dragging:!1, reverting:!1, _noFinalSort:null}), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
  }, serialize:function(t) {
    var n = this._getItemsAsjQuery(t && t.connected), r = [];
    return t = t || {}, e(n).each(function() {
      var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[-=_](.+)/);
      n && r.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]))
    }), !r.length && t.key && r.push(t.key + "="), r.join("&")
  }, toArray:function(t) {
    var n = this._getItemsAsjQuery(t && t.connected), r = [];
    return t = t || {}, n.each(function() {
      r.push(e(t.item || this).attr(t.attribute || "id") || "")
    }), r
  }, _intersectsWith:function(e) {
    var t = this.positionAbs.left, n = t + this.helperProportions.width, r = this.positionAbs.top, i = r + this.helperProportions.height, s = e.left, o = s + e.width, u = e.top, a = u + e.height, f = this.offset.click.top, l = this.offset.click.left, c = r + f > u && r + f < a && t + l > s && t + l < o;
    return this.options.tolerance == "pointer" || this.options.forcePointerForContainers || this.options.tolerance != "pointer" && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? c : s < t + this.helperProportions.width / 2 && n - this.helperProportions.width / 2 < o && u < r + this.helperProportions.height / 2 && i - this.helperProportions.height / 2 < a
  }, _intersectsWithPointer:function(t) {
    var n = this.options.axis === "x" || e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top, t.height), r = this.options.axis === "y" || e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left, t.width), i = n && r, s = this._getDragVerticalDirection(), o = this._getDragHorizontalDirection();
    return i ? this.floating ? o && o == "right" || s == "down" ? 2 : 1 : s && (s == "down" ? 2 : 1) : !1
  }, _intersectsWithSides:function(t) {
    var n = e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top + t.height / 2, t.height), r = e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left + t.width / 2, t.width), i = this._getDragVerticalDirection(), s = this._getDragHorizontalDirection();
    return this.floating && s ? s == "right" && r || s == "left" && !r : i && (i == "down" && n || i == "up" && !n)
  }, _getDragVerticalDirection:function() {
    var e = this.positionAbs.top - this.lastPositionAbs.top;
    return e != 0 && (e > 0 ? "down" : "up")
  }, _getDragHorizontalDirection:function() {
    var e = this.positionAbs.left - this.lastPositionAbs.left;
    return e != 0 && (e > 0 ? "right" : "left")
  }, refresh:function(e) {
    return this._refreshItems(e), this.refreshPositions(), this
  }, _connectWith:function() {
    var e = this.options;
    return e.connectWith.constructor == String ? [e.connectWith] : e.connectWith
  }, _getItemsAsjQuery:function(t) {
    var n = [], r = [], i = this._connectWith();
    if(i && t) {
      for(var s = i.length - 1;s >= 0;s--) {
        var o = e(i[s]);
        for(var u = o.length - 1;u >= 0;u--) {
          var a = e.data(o[u], this.widgetName);
          a && a != this && !a.options.disabled && r.push([e.isFunction(a.options.items) ? a.options.items.call(a.element) : e(a.options.items, a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), a])
        }
      }
    }
    r.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options:this.options, item:this.currentItem}) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
    for(var s = r.length - 1;s >= 0;s--) {
      r[s][0].each(function() {
        n.push(this)
      })
    }
    return e(n)
  }, _removeCurrentsFromItems:function() {
    var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
    this.items = e.grep(this.items, function(e) {
      for(var n = 0;n < t.length;n++) {
        if(t[n] == e.item[0]) {
          return!1
        }
      }
      return!0
    })
  }, _refreshItems:function(t) {
    this.items = [], this.containers = [this];
    var n = this.items, r = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {item:this.currentItem}) : e(this.options.items, this.element), this]], i = this._connectWith();
    if(i && this.ready) {
      for(var s = i.length - 1;s >= 0;s--) {
        var o = e(i[s]);
        for(var u = o.length - 1;u >= 0;u--) {
          var a = e.data(o[u], this.widgetName);
          a && a != this && !a.options.disabled && (r.push([e.isFunction(a.options.items) ? a.options.items.call(a.element[0], t, {item:this.currentItem}) : e(a.options.items, a.element), a]), this.containers.push(a))
        }
      }
    }
    for(var s = r.length - 1;s >= 0;s--) {
      var f = r[s][1], l = r[s][0];
      for(var u = 0, c = l.length;u < c;u++) {
        var h = e(l[u]);
        h.data(this.widgetName + "-item", f), n.push({item:h, instance:f, width:0, height:0, left:0, top:0})
      }
    }
  }, refreshPositions:function(t) {
    this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
    for(var n = this.items.length - 1;n >= 0;n--) {
      var r = this.items[n];
      if(r.instance != this.currentContainer && this.currentContainer && r.item[0] != this.currentItem[0]) {
        continue
      }
      var i = this.options.toleranceElement ? e(this.options.toleranceElement, r.item) : r.item;
      t || (r.width = i.outerWidth(), r.height = i.outerHeight());
      var s = i.offset();
      r.left = s.left, r.top = s.top
    }
    if(this.options.custom && this.options.custom.refreshContainers) {
      this.options.custom.refreshContainers.call(this)
    }else {
      for(var n = this.containers.length - 1;n >= 0;n--) {
        var s = this.containers[n].element.offset();
        this.containers[n].containerCache.left = s.left, this.containers[n].containerCache.top = s.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight()
      }
    }
    return this
  }, _createPlaceholder:function(t) {
    t = t || this;
    var n = t.options;
    if(!n.placeholder || n.placeholder.constructor == String) {
      var r = n.placeholder;
      n.placeholder = {element:function() {
        var n = e(document.createElement(t.currentItem[0].nodeName)).addClass(r || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
        return r || (n.style.visibility = "hidden"), n
      }, update:function(e, i) {
        if(r && !n.forcePlaceholderSize) {
          return
        }
        i.height() || i.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), i.width() || i.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10))
      }}
    }
    t.placeholder = e(n.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), n.placeholder.update(t, t.placeholder)
  }, _contactContainers:function(t) {
    var n = null, r = null;
    for(var i = this.containers.length - 1;i >= 0;i--) {
      if(e.contains(this.currentItem[0], this.containers[i].element[0])) {
        continue
      }
      if(this._intersectsWith(this.containers[i].containerCache)) {
        if(n && e.contains(this.containers[i].element[0], n.element[0])) {
          continue
        }
        n = this.containers[i], r = i
      }else {
        this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), this.containers[i].containerCache.over = 0)
      }
    }
    if(!n) {
      return
    }
    if(this.containers.length === 1) {
      this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1
    }else {
      var s = 1E4, o = null, u = this.containers[r].floating ? "left" : "top", a = this.containers[r].floating ? "width" : "height", f = this.positionAbs[u] + this.offset.click[u];
      for(var l = this.items.length - 1;l >= 0;l--) {
        if(!e.contains(this.containers[r].element[0], this.items[l].item[0])) {
          continue
        }
        if(this.items[l].item[0] == this.currentItem[0]) {
          continue
        }
        var c = this.items[l].item.offset()[u], h = !1;
        Math.abs(c - f) > Math.abs(c + this.items[l][a] - f) && (h = !0, c += this.items[l][a]), Math.abs(c - f) < s && (s = Math.abs(c - f), o = this.items[l], this.direction = h ? "up" : "down")
      }
      if(!o && !this.options.dropOnEmpty) {
        return
      }
      this.currentContainer = this.containers[r], o ? this._rearrange(t, o, null, !0) : this._rearrange(t, null, this.containers[r].element, !0), this._trigger("change", t, this._uiHash()), this.containers[r]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1
    }
  }, _createHelper:function(t) {
    var n = this.options, r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : n.helper == "clone" ? this.currentItem.clone() : this.currentItem;
    return r.parents("body").length || e(n.appendTo != "parent" ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(r[0]), r[0] == this.currentItem[0] && (this._storedCSS = {width:this.currentItem[0].style.width, height:this.currentItem[0].style.height, position:this.currentItem.css("position"), top:this.currentItem.css("top"), left:this.currentItem.css("left")}), (r[0].style.width == "" || n.forceHelperSize) && r.width(this.currentItem.width()), (r[0].style.height == "" || n.forceHelperSize) && 
    r.height(this.currentItem.height()), r
  }, _adjustOffsetFromHelper:function(t) {
    typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {left:+t[0], top:+t[1] || 0}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var t = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && e.ui.ie) {
      t = {top:0, left:0}
    }
    return{top:t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var e = this.currentItem.position();
      return{top:e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.currentItem.css("marginLeft"), 10) || 0, top:parseInt(this.currentItem.css("marginTop"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var t = this.options;
    t.containment == "parent" && (t.containment = this.helper[0].parentNode);
    if(t.containment == "document" || t.containment == "window") {
      this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e(t.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (e(t.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(t.containment)) {
      var n = e(t.containment)[0], r = e(t.containment).offset(), i = e(n).css("overflow") != "hidden";
      this.containment = [r.left + (parseInt(e(n).css("borderLeftWidth"), 10) || 0) + (parseInt(e(n).css("paddingLeft"), 10) || 0) - this.margins.left, r.top + (parseInt(e(n).css("borderTopWidth"), 10) || 0) + (parseInt(e(n).css("paddingTop"), 10) || 0) - this.margins.top, r.left + (i ? Math.max(n.scrollWidth, n.offsetWidth) : n.offsetWidth) - (parseInt(e(n).css("borderLeftWidth"), 10) || 0) - (parseInt(e(n).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, r.top + 
      (i ? Math.max(n.scrollHeight, n.offsetHeight) : n.offsetHeight) - (parseInt(e(n).css("borderTopWidth"), 10) || 0) - (parseInt(e(n).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
    }
  }, _convertPositionTo:function(t, n) {
    n || (n = this.position);
    var r = t == "absolute" ? 1 : -1, i = this.options, s = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, o = /(html|body)/i.test(s[0].tagName);
    return{top:n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : o ? 0 : s.scrollTop()) * r, left:n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : o ? 0 : s.scrollLeft()) * r}
  }, _generatePosition:function(t) {
    var n = this.options, r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName);
    this.cssPosition == "relative" && (this.scrollParent[0] == document || this.scrollParent[0] == this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset());
    var s = t.pageX, o = t.pageY;
    if(this.originalPosition) {
      this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top));
      if(n.grid) {
        var u = this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1];
        o = this.containment ? u - this.offset.click.top < this.containment[1] || u - this.offset.click.top > this.containment[3] ? u - this.offset.click.top < this.containment[1] ? u + n.grid[1] : u - n.grid[1] : u : u;
        var a = this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0];
        s = this.containment ? a - this.offset.click.left < this.containment[0] || a - this.offset.click.left > this.containment[2] ? a - this.offset.click.left < this.containment[0] ? a + n.grid[0] : a - n.grid[0] : a : a
      }
    }
    return{top:o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()), left:s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft())}
  }, _rearrange:function(e, t, n, r) {
    n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], this.direction == "down" ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
    var i = this.counter;
    this._delay(function() {
      i == this.counter && this.refreshPositions(!r)
    })
  }, _clear:function(t, n) {
    this.reverting = !1;
    var r = [];
    !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;
    if(this.helper[0] == this.currentItem[0]) {
      for(var i in this._storedCSS) {
        if(this._storedCSS[i] == "auto" || this._storedCSS[i] == "static") {
          this._storedCSS[i] = ""
        }
      }
      this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
    }else {
      this.currentItem.show()
    }
    this.fromOutside && !n && r.push(function(e) {
      this._trigger("receive", e, this._uiHash(this.fromOutside))
    }), (this.fromOutside || this.domPosition.prev != this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent != this.currentItem.parent()[0]) && !n && r.push(function(e) {
      this._trigger("update", e, this._uiHash())
    }), this !== this.currentContainer && (n || (r.push(function(e) {
      this._trigger("remove", e, this._uiHash())
    }), r.push(function(e) {
      return function(t) {
        e._trigger("receive", t, this._uiHash(this))
      }
    }.call(this, this.currentContainer)), r.push(function(e) {
      return function(t) {
        e._trigger("update", t, this._uiHash(this))
      }
    }.call(this, this.currentContainer))));
    for(var i = this.containers.length - 1;i >= 0;i--) {
      n || r.push(function(e) {
        return function(t) {
          e._trigger("deactivate", t, this._uiHash(this))
        }
      }.call(this, this.containers[i])), this.containers[i].containerCache.over && (r.push(function(e) {
        return function(t) {
          e._trigger("out", t, this._uiHash(this))
        }
      }.call(this, this.containers[i])), this.containers[i].containerCache.over = 0)
    }
    this._storedCursor && e("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex == "auto" ? "" : this._storedZIndex), this.dragging = !1;
    if(this.cancelHelperRemoval) {
      if(!n) {
        this._trigger("beforeStop", t, this._uiHash());
        for(var i = 0;i < r.length;i++) {
          r[i].call(this, t)
        }
        this._trigger("stop", t, this._uiHash())
      }
      return this.fromOutside = !1, !1
    }
    n || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null;
    if(!n) {
      for(var i = 0;i < r.length;i++) {
        r[i].call(this, t)
      }
      this._trigger("stop", t, this._uiHash())
    }
    return this.fromOutside = !1, !0
  }, _trigger:function() {
    e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
  }, _uiHash:function(t) {
    var n = t || this;
    return{helper:n.helper, placeholder:n.placeholder || e([]), position:n.position, originalPosition:n.originalPosition, offset:n.positionAbs, item:n.currentItem, sender:t ? t.element : null}
  }})
})(jQuery);
(function(e, t) {
  var n = 0;
  e.widget("ui.autocomplete", {version:"1.9.2", defaultElement:"<input>", options:{appendTo:"body", autoFocus:!1, delay:300, minLength:1, position:{my:"left top", at:"left bottom", collision:"none"}, source:null, change:null, close:null, focus:null, open:null, response:null, search:null, select:null}, pending:0, _create:function() {
    var t, n, r;
    this.isMultiLine = this._isMultiLine(), this.valueMethod = this.element[this.element.is("input,textarea") ? "val" : "text"], this.isNewMenu = !0, this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"), this._on(this.element, {keydown:function(i) {
      if(this.element.prop("readOnly")) {
        t = !0, r = !0, n = !0;
        return
      }
      t = !1, r = !1, n = !1;
      var s = e.ui.keyCode;
      switch(i.keyCode) {
        case s.PAGE_UP:
          t = !0, this._move("previousPage", i);
          break;
        case s.PAGE_DOWN:
          t = !0, this._move("nextPage", i);
          break;
        case s.UP:
          t = !0, this._keyEvent("previous", i);
          break;
        case s.DOWN:
          t = !0, this._keyEvent("next", i);
          break;
        case s.ENTER:
        ;
        case s.NUMPAD_ENTER:
          this.menu.active && (t = !0, i.preventDefault(), this.menu.select(i));
          break;
        case s.TAB:
          this.menu.active && this.menu.select(i);
          break;
        case s.ESCAPE:
          this.menu.element.is(":visible") && (this._value(this.term), this.close(i), i.preventDefault());
          break;
        default:
          n = !0, this._searchTimeout(i)
      }
    }, keypress:function(r) {
      if(t) {
        t = !1, r.preventDefault();
        return
      }
      if(n) {
        return
      }
      var i = e.ui.keyCode;
      switch(r.keyCode) {
        case i.PAGE_UP:
          this._move("previousPage", r);
          break;
        case i.PAGE_DOWN:
          this._move("nextPage", r);
          break;
        case i.UP:
          this._keyEvent("previous", r);
          break;
        case i.DOWN:
          this._keyEvent("next", r)
      }
    }, input:function(e) {
      if(r) {
        r = !1, e.preventDefault();
        return
      }
      this._searchTimeout(e)
    }, focus:function() {
      this.selectedItem = null, this.previous = this._value()
    }, blur:function(e) {
      if(this.cancelBlur) {
        delete this.cancelBlur;
        return
      }
      clearTimeout(this.searching), this.close(e), this._change(e)
    }}), this._initSource(), this.menu = e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo || "body")[0]).menu({input:e(), role:null}).zIndex(this.element.zIndex() + 1).hide().data("menu"), this._on(this.menu.element, {mousedown:function(t) {
      t.preventDefault(), this.cancelBlur = !0, this._delay(function() {
        delete this.cancelBlur
      });
      var n = this.menu.element[0];
      e(t.target).closest(".ui-menu-item").length || this._delay(function() {
        var t = this;
        this.document.one("mousedown", function(r) {
          r.target !== t.element[0] && r.target !== n && !e.contains(n, r.target) && t.close()
        })
      })
    }, menufocus:function(t, n) {
      if(this.isNewMenu) {
        this.isNewMenu = !1;
        if(t.originalEvent && /^mouse/.test(t.originalEvent.type)) {
          this.menu.blur(), this.document.one("mousemove", function() {
            e(t.target).trigger(t.originalEvent)
          });
          return
        }
      }
      var r = n.item.data("ui-autocomplete-item") || n.item.data("item.autocomplete");
      !1 !== this._trigger("focus", t, {item:r}) ? t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(r.value) : this.liveRegion.text(r.value)
    }, menuselect:function(e, t) {
      var n = t.item.data("ui-autocomplete-item") || t.item.data("item.autocomplete"), r = this.previous;
      this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = r, this._delay(function() {
        this.previous = r, this.selectedItem = n
      })), !1 !== this._trigger("select", e, {item:n}) && this._value(n.value), this.term = this._value(), this.close(e), this.selectedItem = n
    }}), this.liveRegion = e("<span>", {role:"status", "aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element), e.fn.bgiframe && this.menu.element.bgiframe(), this._on(this.window, {beforeunload:function() {
      this.element.removeAttr("autocomplete")
    }})
  }, _destroy:function() {
    clearTimeout(this.searching), this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove()
  }, _setOption:function(e, t) {
    this._super(e, t), e === "source" && this._initSource(), e === "appendTo" && this.menu.element.appendTo(this.document.find(t || "body")[0]), e === "disabled" && t && this.xhr && this.xhr.abort()
  }, _isMultiLine:function() {
    return this.element.is("textarea") ? !0 : this.element.is("input") ? !1 : this.element.prop("isContentEditable")
  }, _initSource:function() {
    var t, n, r = this;
    e.isArray(this.options.source) ? (t = this.options.source, this.source = function(n, r) {
      r(e.ui.autocomplete.filter(t, n.term))
    }) : typeof this.options.source == "string" ? (n = this.options.source, this.source = function(t, i) {
      r.xhr && r.xhr.abort(), r.xhr = e.ajax({url:n, data:t, dataType:"json", success:function(e) {
        i(e)
      }, error:function() {
        i([])
      }})
    }) : this.source = this.options.source
  }, _searchTimeout:function(e) {
    clearTimeout(this.searching), this.searching = this._delay(function() {
      this.term !== this._value() && (this.selectedItem = null, this.search(null, e))
    }, this.options.delay)
  }, search:function(e, t) {
    e = e != null ? e : this._value(), this.term = this._value();
    if(e.length < this.options.minLength) {
      return this.close(t)
    }
    if(this._trigger("search", t) === !1) {
      return
    }
    return this._search(e)
  }, _search:function(e) {
    this.pending++, this.element.addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({term:e}, this._response())
  }, _response:function() {
    var e = this, t = ++n;
    return function(r) {
      t === n && e.__response(r), e.pending--, e.pending || e.element.removeClass("ui-autocomplete-loading")
    }
  }, __response:function(e) {
    e && (e = this._normalize(e)), this._trigger("response", null, {content:e}), !this.options.disabled && e && e.length && !this.cancelSearch ? (this._suggest(e), this._trigger("open")) : this._close()
  }, close:function(e) {
    this.cancelSearch = !0, this._close(e)
  }, _close:function(e) {
    this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e))
  }, _change:function(e) {
    this.previous !== this._value() && this._trigger("change", e, {item:this.selectedItem})
  }, _normalize:function(t) {
    return t.length && t[0].label && t[0].value ? t : e.map(t, function(t) {
      return typeof t == "string" ? {label:t, value:t} : e.extend({label:t.label || t.value, value:t.value || t.label}, t)
    })
  }, _suggest:function(t) {
    var n = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
    this._renderMenu(n, t), this.menu.refresh(), n.show(), this._resizeMenu(), n.position(e.extend({of:this.element}, this.options.position)), this.options.autoFocus && this.menu.next()
  }, _resizeMenu:function() {
    var e = this.menu.element;
    e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth()))
  }, _renderMenu:function(t, n) {
    var r = this;
    e.each(n, function(e, n) {
      r._renderItemData(t, n)
    })
  }, _renderItemData:function(e, t) {
    return this._renderItem(e, t).data("ui-autocomplete-item", t)
  }, _renderItem:function(t, n) {
    return e("<li>").append(e("<a>").text(n.label)).appendTo(t)
  }, _move:function(e, t) {
    if(!this.menu.element.is(":visible")) {
      this.search(null, t);
      return
    }
    if(this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e)) {
      this._value(this.term), this.menu.blur();
      return
    }
    this.menu[e](t)
  }, widget:function() {
    return this.menu.element
  }, _value:function() {
    return this.valueMethod.apply(this.element, arguments)
  }, _keyEvent:function(e, t) {
    if(!this.isMultiLine || this.menu.element.is(":visible")) {
      this._move(e, t), t.preventDefault()
    }
  }}), e.extend(e.ui.autocomplete, {escapeRegex:function(e) {
    return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
  }, filter:function(t, n) {
    var r = new RegExp(e.ui.autocomplete.escapeRegex(n), "i");
    return e.grep(t, function(e) {
      return r.test(e.label || e.value || e)
    })
  }}), e.widget("ui.autocomplete", e.ui.autocomplete, {options:{messages:{noResults:"No search results.", results:function(e) {
    return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
  }}}, __response:function(e) {
    var t;
    this._superApply(arguments);
    if(this.options.disabled || this.cancelSearch) {
      return
    }
    e && e.length ? t = this.options.messages.results(e.length) : t = this.options.messages.noResults, this.liveRegion.text(t)
  }})
})(jQuery);
(function(e, t) {
  var n = !1;
  e.widget("ui.menu", {version:"1.9.2", defaultElement:"<ul>", delay:300, options:{icons:{submenu:"ui-icon-carat-1-e"}, menus:"ul", position:{my:"left top", at:"right top"}, role:"menu", blur:null, focus:null, select:null}, _create:function() {
    this.activeMenu = this.element, this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({role:this.options.role, tabIndex:0}).bind("click" + this.eventNamespace, e.proxy(function(e) {
      this.options.disabled && e.preventDefault()
    }, this)), this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"), this._on({"mousedown .ui-menu-item > a":function(e) {
      e.preventDefault()
    }, "click .ui-state-disabled > a":function(e) {
      e.preventDefault()
    }, "click .ui-menu-item:has(a)":function(t) {
      var r = e(t.target).closest(".ui-menu-item");
      !n && r.not(".ui-state-disabled").length && (n = !0, this.select(t), r.has(".ui-menu").length ? this.expand(t) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && this.active.parents(".ui-menu").length === 1 && clearTimeout(this.timer)))
    }, "mouseenter .ui-menu-item":function(t) {
      var n = e(t.currentTarget);
      n.siblings().children(".ui-state-active").removeClass("ui-state-active"), this.focus(t, n)
    }, mouseleave:"collapseAll", "mouseleave .ui-menu":"collapseAll", focus:function(e, t) {
      var n = this.active || this.element.children(".ui-menu-item").eq(0);
      t || this.focus(e, n)
    }, blur:function(t) {
      this._delay(function() {
        e.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t)
      })
    }, keydown:"_keydown"}), this.refresh(), this._on(this.document, {click:function(t) {
      e(t.target).closest(".ui-menu").length || this.collapseAll(t), n = !1
    }})
  }, _destroy:function() {
    this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(), this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function() {
      var t = e(this);
      t.data("ui-menu-submenu-carat") && t.remove()
    }), this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
  }, _keydown:function(t) {
    function a(e) {
      return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
    }
    var n, r, i, s, o, u = !0;
    switch(t.keyCode) {
      case e.ui.keyCode.PAGE_UP:
        this.previousPage(t);
        break;
      case e.ui.keyCode.PAGE_DOWN:
        this.nextPage(t);
        break;
      case e.ui.keyCode.HOME:
        this._move("first", "first", t);
        break;
      case e.ui.keyCode.END:
        this._move("last", "last", t);
        break;
      case e.ui.keyCode.UP:
        this.previous(t);
        break;
      case e.ui.keyCode.DOWN:
        this.next(t);
        break;
      case e.ui.keyCode.LEFT:
        this.collapse(t);
        break;
      case e.ui.keyCode.RIGHT:
        this.active && !this.active.is(".ui-state-disabled") && this.expand(t);
        break;
      case e.ui.keyCode.ENTER:
      ;
      case e.ui.keyCode.SPACE:
        this._activate(t);
        break;
      case e.ui.keyCode.ESCAPE:
        this.collapse(t);
        break;
      default:
        u = !1, r = this.previousFilter || "", i = String.fromCharCode(t.keyCode), s = !1, clearTimeout(this.filterTimer), i === r ? s = !0 : i = r + i, o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function() {
          return o.test(e(this).children("a").text())
        }), n = s && n.index(this.active.next()) !== -1 ? this.active.nextAll(".ui-menu-item") : n, n.length || (i = String.fromCharCode(t.keyCode), o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function() {
          return o.test(e(this).children("a").text())
        })), n.length ? (this.focus(t, n), n.length > 1 ? (this.previousFilter = i, this.filterTimer = this._delay(function() {
          delete this.previousFilter
        }, 1E3)) : delete this.previousFilter) : delete this.previousFilter
    }
    u && t.preventDefault()
  }, _activate:function(e) {
    this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(e) : this.select(e))
  }, refresh:function() {
    var t, n = this.options.icons.submenu, r = this.element.find(this.options.menus);
    r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role, "aria-hidden":"true", "aria-expanded":"false"}).each(function() {
      var t = e(this), r = t.prev("a"), i = e("<span>").addClass("ui-menu-icon ui-icon " + n).data("ui-menu-submenu-carat", !0);
      r.attr("aria-haspopup", "true").prepend(i), t.attr("aria-labelledby", r.attr("id"))
    }), t = r.add(this.element), t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1, role:this._itemRole()}), t.children(":not(.ui-menu-item)").each(function() {
      var t = e(this);
      /[^\-\u2014\u2013\s]/.test(t.text()) || t.addClass("ui-widget-content ui-menu-divider")
    }), t.children(".ui-state-disabled").attr("aria-disabled", "true"), this.active && !e.contains(this.element[0], this.active[0]) && this.blur()
  }, _itemRole:function() {
    return{menu:"menuitem", listbox:"option"}[this.options.role]
  }, focus:function(e, t) {
    var n, r;
    this.blur(e, e && e.type === "focus"), this._scrollIntoView(t), this.active = t.first(), r = this.active.children("a").addClass("ui-state-focus"), this.options.role && this.element.attr("aria-activedescendant", r.attr("id")), this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"), e && e.type === "keydown" ? this._close() : this.timer = this._delay(function() {
      this._close()
    }, this.delay), n = t.children(".ui-menu"), n.length && /^mouse/.test(e.type) && this._startOpening(n), this.activeMenu = t.parent(), this._trigger("focus", e, {item:t})
  }, _scrollIntoView:function(t) {
    var n, r, i, s, o, u;
    this._hasScroll() && (n = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, r = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, i = t.offset().top - this.activeMenu.offset().top - n - r, s = this.activeMenu.scrollTop(), o = this.activeMenu.height(), u = t.height(), i < 0 ? this.activeMenu.scrollTop(s + i) : i + u > o && this.activeMenu.scrollTop(s + i - o + u))
  }, blur:function(e, t) {
    t || clearTimeout(this.timer);
    if(!this.active) {
      return
    }
    this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", e, {item:this.active})
  }, _startOpening:function(e) {
    clearTimeout(this.timer);
    if(e.attr("aria-hidden") !== "true") {
      return
    }
    this.timer = this._delay(function() {
      this._close(), this._open(e)
    }, this.delay)
  }, _open:function(t) {
    var n = e.extend({of:this.active}, this.options.position);
    clearTimeout(this.timer), this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"), t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(n)
  }, collapseAll:function(t, n) {
    clearTimeout(this.timer), this.timer = this._delay(function() {
      var r = n ? this.element : e(t && t.target).closest(this.element.find(".ui-menu"));
      r.length || (r = this.element), this._close(r), this.blur(t), this.activeMenu = r
    }, this.delay)
  }, _close:function(e) {
    e || (e = this.active ? this.active.parent() : this.element), e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
  }, collapse:function(e) {
    var t = this.active && this.active.parent().closest(".ui-menu-item", this.element);
    t && t.length && (this._close(), this.focus(e, t))
  }, expand:function(e) {
    var t = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
    t && t.length && (this._open(t.parent()), this._delay(function() {
      this.focus(e, t)
    }))
  }, next:function(e) {
    this._move("next", "first", e)
  }, previous:function(e) {
    this._move("prev", "last", e)
  }, isFirstItem:function() {
    return this.active && !this.active.prevAll(".ui-menu-item").length
  }, isLastItem:function() {
    return this.active && !this.active.nextAll(".ui-menu-item").length
  }, _move:function(e, t, n) {
    var r;
    this.active && (e === "first" || e === "last" ? r = this.active[e === "first" ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : r = this.active[e + "All"](".ui-menu-item").eq(0));
    if(!r || !r.length || !this.active) {
      r = this.activeMenu.children(".ui-menu-item")[t]()
    }
    this.focus(n, r)
  }, nextPage:function(t) {
    var n, r, i;
    if(!this.active) {
      this.next(t);
      return
    }
    if(this.isLastItem()) {
      return
    }
    this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.nextAll(".ui-menu-item").each(function() {
      return n = e(this), n.offset().top - r - i < 0
    }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())
  }, previousPage:function(t) {
    var n, r, i;
    if(!this.active) {
      this.next(t);
      return
    }
    if(this.isFirstItem()) {
      return
    }
    this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.prevAll(".ui-menu-item").each(function() {
      return n = e(this), n.offset().top - r + i > 0
    }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item").first())
  }, _hasScroll:function() {
    return this.element.outerHeight() < this.element.prop("scrollHeight")
  }, select:function(t) {
    this.active = this.active || e(t.target).closest(".ui-menu-item");
    var n = {item:this.active};
    this.active.has(".ui-menu").length || this.collapseAll(t, !0), this._trigger("select", t, n)
  }})
})(jQuery);
(function(e, t) {
  var n = 5;
  e.widget("ui.slider", e.ui.mouse, {version:"1.9.2", widgetEventPrefix:"slide", options:{animate:!1, distance:0, max:100, min:0, orientation:"horizontal", range:!1, step:1, value:0, values:null}, _create:function() {
    var t, r, i = this.options, s = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"), o = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>", u = [];
    this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget" + " ui-widget-content" + " ui-corner-all" + (i.disabled ? " ui-slider-disabled ui-disabled" : "")), this.range = e([]), i.range && (i.range === !0 && (i.values || (i.values = [this._valueMin(), this._valueMin()]), i.values.length && i.values.length !== 2 && (i.values = [i.values[0], 
    i.values[0]])), this.range = e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header" + (i.range === "min" || i.range === "max" ? " ui-slider-range-" + i.range : ""))), r = i.values && i.values.length || 1;
    for(t = s.length;t < r;t++) {
      u.push(o)
    }
    this.handles = s.add(e(u.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.add(this.range).filter("a").click(function(e) {
      e.preventDefault()
    }).mouseenter(function() {
      i.disabled || e(this).addClass("ui-state-hover")
    }).mouseleave(function() {
      e(this).removeClass("ui-state-hover")
    }).focus(function() {
      i.disabled ? e(this).blur() : (e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), e(this).addClass("ui-state-focus"))
    }).blur(function() {
      e(this).removeClass("ui-state-focus")
    }), this.handles.each(function(t) {
      e(this).data("ui-slider-handle-index", t)
    }), this._on(this.handles, {keydown:function(t) {
      var r, i, s, o, u = e(t.target).data("ui-slider-handle-index");
      switch(t.keyCode) {
        case e.ui.keyCode.HOME:
        ;
        case e.ui.keyCode.END:
        ;
        case e.ui.keyCode.PAGE_UP:
        ;
        case e.ui.keyCode.PAGE_DOWN:
        ;
        case e.ui.keyCode.UP:
        ;
        case e.ui.keyCode.RIGHT:
        ;
        case e.ui.keyCode.DOWN:
        ;
        case e.ui.keyCode.LEFT:
          t.preventDefault();
          if(!this._keySliding) {
            this._keySliding = !0, e(t.target).addClass("ui-state-active"), r = this._start(t, u);
            if(r === !1) {
              return
            }
          }
      }
      o = this.options.step, this.options.values && this.options.values.length ? i = s = this.values(u) : i = s = this.value();
      switch(t.keyCode) {
        case e.ui.keyCode.HOME:
          s = this._valueMin();
          break;
        case e.ui.keyCode.END:
          s = this._valueMax();
          break;
        case e.ui.keyCode.PAGE_UP:
          s = this._trimAlignValue(i + (this._valueMax() - this._valueMin()) / n);
          break;
        case e.ui.keyCode.PAGE_DOWN:
          s = this._trimAlignValue(i - (this._valueMax() - this._valueMin()) / n);
          break;
        case e.ui.keyCode.UP:
        ;
        case e.ui.keyCode.RIGHT:
          if(i === this._valueMax()) {
            return
          }
          s = this._trimAlignValue(i + o);
          break;
        case e.ui.keyCode.DOWN:
        ;
        case e.ui.keyCode.LEFT:
          if(i === this._valueMin()) {
            return
          }
          s = this._trimAlignValue(i - o)
      }
      this._slide(t, u, s)
    }, keyup:function(t) {
      var n = e(t.target).data("ui-slider-handle-index");
      this._keySliding && (this._keySliding = !1, this._stop(t, n), this._change(t, n), e(t.target).removeClass("ui-state-active"))
    }}), this._refreshValue(), this._animateOff = !1
  }, _destroy:function() {
    this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy()
  }, _mouseCapture:function(t) {
    var n, r, i, s, o, u, a, f, l = this, c = this.options;
    return c.disabled ? !1 : (this.elementSize = {width:this.element.outerWidth(), height:this.element.outerHeight()}, this.elementOffset = this.element.offset(), n = {x:t.pageX, y:t.pageY}, r = this._normValueFromMouse(n), i = this._valueMax() - this._valueMin() + 1, this.handles.each(function(t) {
      var n = Math.abs(r - l.values(t));
      i > n && (i = n, s = e(this), o = t)
    }), c.range === !0 && this.values(1) === c.min && (o += 1, s = e(this.handles[o])), u = this._start(t, o), u === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = o, s.addClass("ui-state-active").focus(), a = s.offset(), f = !e(t.target).parents().andSelf().is(".ui-slider-handle"), this._clickOffset = f ? {left:0, top:0} : {left:t.pageX - a.left - s.width() / 2, top:t.pageY - a.top - s.height() / 2 - (parseInt(s.css("borderTopWidth"), 10) || 0) - (parseInt(s.css("borderBottomWidth"), 10) || 
    0) + (parseInt(s.css("marginTop"), 10) || 0)}, this.handles.hasClass("ui-state-hover") || this._slide(t, o, r), this._animateOff = !0, !0))
  }, _mouseStart:function() {
    return!0
  }, _mouseDrag:function(e) {
    var t = {x:e.pageX, y:e.pageY}, n = this._normValueFromMouse(t);
    return this._slide(e, this._handleIndex, n), !1
  }, _mouseStop:function(e) {
    return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
  }, _detectOrientation:function() {
    this.orientation = this.options.orientation === "vertical" ? "vertical" : "horizontal"
  }, _normValueFromMouse:function(e) {
    var t, n, r, i, s;
    return this.orientation === "horizontal" ? (t = this.elementSize.width, n = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, n = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), r = n / t, r > 1 && (r = 1), r < 0 && (r = 0), this.orientation === "vertical" && (r = 1 - r), i = this._valueMax() - this._valueMin(), s = this._valueMin() + r * i, this._trimAlignValue(s)
  }, _start:function(e, t) {
    var n = {handle:this.handles[t], value:this.value()};
    return this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("start", e, n)
  }, _slide:function(e, t, n) {
    var r, i, s;
    this.options.values && this.options.values.length ? (r = this.values(t ? 0 : 1), this.options.values.length === 2 && this.options.range === !0 && (t === 0 && n > r || t === 1 && n < r) && (n = r), n !== this.values(t) && (i = this.values(), i[t] = n, s = this._trigger("slide", e, {handle:this.handles[t], value:n, values:i}), r = this.values(t ? 0 : 1), s !== !1 && this.values(t, n, !0))) : n !== this.value() && (s = this._trigger("slide", e, {handle:this.handles[t], value:n}), s !== !1 && this.value(n))
  }, _stop:function(e, t) {
    var n = {handle:this.handles[t], value:this.value()};
    this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("stop", e, n)
  }, _change:function(e, t) {
    if(!this._keySliding && !this._mouseSliding) {
      var n = {handle:this.handles[t], value:this.value()};
      this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("change", e, n)
    }
  }, value:function(e) {
    if(arguments.length) {
      this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0);
      return
    }
    return this._value()
  }, values:function(t, n) {
    var r, i, s;
    if(arguments.length > 1) {
      this.options.values[t] = this._trimAlignValue(n), this._refreshValue(), this._change(null, t);
      return
    }
    if(!arguments.length) {
      return this._values()
    }
    if(!e.isArray(arguments[0])) {
      return this.options.values && this.options.values.length ? this._values(t) : this.value()
    }
    r = this.options.values, i = arguments[0];
    for(s = 0;s < r.length;s += 1) {
      r[s] = this._trimAlignValue(i[s]), this._change(null, s)
    }
    this._refreshValue()
  }, _setOption:function(t, n) {
    var r, i = 0;
    e.isArray(this.options.values) && (i = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments);
    switch(t) {
      case "disabled":
        n ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.prop("disabled", !0), this.element.addClass("ui-disabled")) : (this.handles.prop("disabled", !1), this.element.removeClass("ui-disabled"));
        break;
      case "orientation":
        this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
        break;
      case "value":
        this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
        break;
      case "values":
        this._animateOff = !0, this._refreshValue();
        for(r = 0;r < i;r += 1) {
          this._change(null, r)
        }
        this._animateOff = !1;
        break;
      case "min":
      ;
      case "max":
        this._animateOff = !0, this._refreshValue(), this._animateOff = !1
    }
  }, _value:function() {
    var e = this.options.value;
    return e = this._trimAlignValue(e), e
  }, _values:function(e) {
    var t, n, r;
    if(arguments.length) {
      return t = this.options.values[e], t = this._trimAlignValue(t), t
    }
    n = this.options.values.slice();
    for(r = 0;r < n.length;r += 1) {
      n[r] = this._trimAlignValue(n[r])
    }
    return n
  }, _trimAlignValue:function(e) {
    if(e <= this._valueMin()) {
      return this._valueMin()
    }
    if(e >= this._valueMax()) {
      return this._valueMax()
    }
    var t = this.options.step > 0 ? this.options.step : 1, n = (e - this._valueMin()) % t, r = e - n;
    return Math.abs(n) * 2 >= t && (r += n > 0 ? t : -t), parseFloat(r.toFixed(5))
  }, _valueMin:function() {
    return this.options.min
  }, _valueMax:function() {
    return this.options.max
  }, _refreshValue:function() {
    var t, n, r, i, s, o = this.options.range, u = this.options, a = this, f = this._animateOff ? !1 : u.animate, l = {};
    this.options.values && this.options.values.length ? this.handles.each(function(r) {
      n = (a.values(r) - a._valueMin()) / (a._valueMax() - a._valueMin()) * 100, l[a.orientation === "horizontal" ? "left" : "bottom"] = n + "%", e(this).stop(1, 1)[f ? "animate" : "css"](l, u.animate), a.options.range === !0 && (a.orientation === "horizontal" ? (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({left:n + "%"}, u.animate), r === 1 && a.range[f ? "animate" : "css"]({width:n - t + "%"}, {queue:!1, duration:u.animate})) : (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({bottom:n + 
      "%"}, u.animate), r === 1 && a.range[f ? "animate" : "css"]({height:n - t + "%"}, {queue:!1, duration:u.animate}))), t = n
    }) : (r = this.value(), i = this._valueMin(), s = this._valueMax(), n = s !== i ? (r - i) / (s - i) * 100 : 0, l[this.orientation === "horizontal" ? "left" : "bottom"] = n + "%", this.handle.stop(1, 1)[f ? "animate" : "css"](l, u.animate), o === "min" && this.orientation === "horizontal" && this.range.stop(1, 1)[f ? "animate" : "css"]({width:n + "%"}, u.animate), o === "max" && this.orientation === "horizontal" && this.range[f ? "animate" : "css"]({width:100 - n + "%"}, {queue:!1, duration:u.animate}), 
    o === "min" && this.orientation === "vertical" && this.range.stop(1, 1)[f ? "animate" : "css"]({height:n + "%"}, u.animate), o === "max" && this.orientation === "vertical" && this.range[f ? "animate" : "css"]({height:100 - n + "%"}, {queue:!1, duration:u.animate}))
  }})
})(jQuery);
eval(function(p, a, c, k, e, r) {
  e = function(c) {
    return(c < a ? "" : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36))
  };
  if(!"".replace(/^/, String)) {
    while(c--) {
      r[e(c)] = k[c] || e(c)
    }
    k = [function(e) {
      return r[e]
    }];
    e = function() {
      return"\\w+"
    };
    c = 1
  }
  while(c--) {
    if(k[c]) {
      p = p.replace(new RegExp("\\b" + e(c) + "\\b", "g"), k[c])
    }
  }
  return p
}("(D($){8($.1s.1v){H}$.1s.6i=$.1s.1v=D(u,w){8(1l.S==0){18(J,'6j 55 6k 1j \"'+1l.4o+'\".');H 1l}8(1l.S>1){H 1l.1W(D(){$(1l).1v(u,w)})}F y=1l,$12=1l[0],56=L;8(y.1q('57')){56=y.1P('3o','4p');y.T('3o',['4q',J])}F z={};z.59=D(o,a,b){o=3S($12,o);o.E=6l($12,o.E);o.1K=6m($12,o.1K);o.N=6n($12,o.N);o.14=5a($12,o.14);o.16=5a($12,o.16);o.1b=6o($12,o.1b);o.1r=6p($12,o.1r);o.1Q=6q($12,o.1Q);8(a){31=$.1L(J,{},$.1s.1v.5b,o)}7=$.1L(J,{},$.1s.1v.5b,o);7.d=6r(7);A.2l=(7.2l=='5c'||7.2l=='1m')?'16':'14';F c=y.13(),2m=5d($1n,7,'P');8(3p(7.25)){7.25='7Q'+G.3T}7.3U=5e(7,2m);7.E=6s(7.E,7,c,b);7[7.d['P']]=6t(7[7.d['P']],7,c);7[7.d['1e']]=6u(7[7.d['1e']],7,c);8(7.2H){8(!3V(7[7.d['P']])){7[7.d['P']]='2I%'}}8(3V(7[7.d['P']])){A.6v=J;A.4r=7[7.d['P']];7[7.d['P']]=4s(2m,A.4r);8(!7.E.M){7.E.U.1d=J}}8(7.2H){7.1R=L;7.1i=[0,0,0,0];7.1B=L;7.E.U.1d=L}O{8(!7.E.M){7=6w(7,2m)}8(!7[7.d['P']]){8(!7.E.U.1d&&Y(7.E[7.d['P']])&&7.E.1t=='*'){7[7.d['P']]=7.E.M*7.E[7.d['P']];7.1B=L}O{7[7.d['P']]='1d'}}8(1z(7.1B)){7.1B=(Y(7[7.d['P']]))?'5f':L}8(7.E.U.1d){7.E.M=32(c,7,0)}}8(7.E.1t!='*'&&!7.E.U.1d){7.E.U.4t=7.E.M;7.E.M=3W(c,7,0)}7.E.M=2x(7.E.M,7,7.E.U.2c,$12);7.E.U.20=7.E.M;8(7.2H){8(!7.E.U.34){7.E.U.34=7.E.M}8(!7.E.U.1X){7.E.U.1X=7.E.M}7=5g(7,c,2m)}O{7.1i=6x(7.1i);8(7.1B=='3q'){7.1B='1m'}O 8(7.1B=='5h'){7.1B='35'}1F(7.1B){R'5f':R'1m':R'35':8(7[7.d['P']]!='1d'){7=5i(7,c);7.1R=J}17;2J:7.1B=L;7.1R=(7.1i[0]==0&&7.1i[1]==0&&7.1i[2]==0&&7.1i[3]==0)?L:J;17}}8(!Y(7.1K.1M)){7.1K.1M=6y}8(1z(7.1K.E)){7.1K.E=(7.2H||7.E.U.1d||7.E.1t!='*')?'M':7.E.M}7.N=$.1L(J,{},7.1K,7.N);7.14=$.1L(J,{},7.1K,7.14);7.16=$.1L(J,{},7.1K,7.16);7.1b=$.1L(J,{},7.1K,7.1b);7.N=6z($12,7.N);7.14=5j($12,7.14);7.16=5j($12,7.16);7.1b=6A($12,7.1b);7.1r=6B($12,7.1r);7.1Q=6C($12,7.1Q);8(7.2n){7.2n=5k(7.2n)}8(7.N.5l){7.N.4u=7.N.5l;3X('N.5l','N.4u')}8(7.N.5m){7.N.4v=7.N.5m;3X('N.5m','N.4v')}8(7.N.5n){7.N.4w=7.N.5n;3X('N.5n','N.4w')}8(7.N.5o){7.N.2K=7.N.5o;3X('N.5o','N.2K')}};z.6D=D(){y.1q('57',J);F a=y.13(),3Y=6E(y,['6F','6G','3r','3q','35','5h','1m','3Z','P','1e','6H','1S','5p','6I']),5q='7R';1F(3Y.3r){R'6J':R'7S':5q=3Y.3r;17}8(G.3s=='36'){41($1n)}O{$1n.Z(3Y)}$1n.Z({'7T':'3t','3r':5q});41(y);y.1q('6K',3Y.3Z);y.Z({'6F':'1m','6G':'42','3r':'6J','3q':0,'35':'N','5h':'N','1m':0,'6H':0,'1S':0,'5p':0,'6I':0});4x(a,7);41(a);8(7.2H){5r(7,a)}};z.6L=D(){z.5s();y.11(I('6M',G),D(e,a){e.1g();8(!A.2d){8(7.N.W){7.N.W.3a(2y('4y',G))}}A.2d=J;8(7.N.1G){7.N.1G=L;y.T(I('3b',G),a)}H J});y.11(I('5t',G),D(e){e.1g();8(A.26){43(V)}H J});y.11(I('3b',G),D(e,a,b){e.1g();1u=3u(1u);8(a&&A.26){V.2d=J;F c=2o()-V.2L;V.1M-=c;8(V.4z){V.4z.1M-=c}8(V.4A){V.4A.1M-=c}43(V,L)}8(!A.27&&!A.26){8(b){1u.3v+=2o()-1u.2L}}8(!A.27){8(7.N.W){7.N.W.3a(2y('6N',G))}}A.27=J;8(7.N.4v){F d=7.N.2K-1u.3v,3c=2I-1H.2z(d*2I/7.N.2K);7.N.4v.1h($12,3c,d)}H J});y.11(I('1G',G),D(e,b,c,d){e.1g();1u=3u(1u);F v=[b,c,d],t=['2M','28','3d'],a=3e(v,t);b=a[0];c=a[1];d=a[2];8(b!='14'&&b!='16'){b=A.2l}8(!Y(c)){c=0}8(!1k(d)){d=L}8(d){A.2d=L;7.N.1G=J}8(!7.N.1G){e.2e();H 18(G,'3w 4y: 2p 3f.')}8(A.27){8(7.N.W){7.N.W.2N(2y('4y',G));7.N.W.2N(2y('6N',G))}}A.27=L;1u.2L=2o();F f=7.N.2K+c;44=f-1u.3v;3c=2I-1H.2z(44*2I/f);8(7.N.1f){1u.1f=7U(D(){F a=2o()-1u.2L+1u.3v,3c=1H.2z(a*2I/f);7.N.1f.4B.1h(7.N.1f.2q[0],3c)},7.N.1f.5u)}1u.N=7V(D(){8(7.N.1f){7.N.1f.4B.1h(7.N.1f.2q[0],2I)}8(7.N.4w){7.N.4w.1h($12,3c,44)}8(A.26){y.T(I('1G',G),b)}O{y.T(I(b,G),7.N)}},44);8(7.N.4u){7.N.4u.1h($12,3c,44)}H J});y.11(I('3g',G),D(e){e.1g();8(V.2d){V.2d=L;A.27=L;A.26=J;V.2L=2o();3x(V,G)}O{y.T(I('1G',G))}H J});y.11(I('14',G)+' '+I('16',G),D(e,b,f,g,h){e.1g();8(A.2d||y.2f(':3t')){e.2e();H 18(G,'3w 4y 7W 3t: 2p 3f.')}F i=(Y(7.E.4C))?7.E.4C:7.E.M+1;8(i>K.Q){e.2e();H 18(G,'2p 6O E ('+K.Q+' Q, '+i+' 6P): 2p 3f.')}F v=[b,f,g,h],t=['2A','28/2M','D','3d'],a=3e(v,t);b=a[0];f=a[1];g=a[2];h=a[3];F k=e.5v.19(G.3y.45.S);8(!1T(b)){b={}}8(1o(g)){b.3h=g}8(1k(h)){b.2O=h}b=$.1L(J,{},7[k],b);8(b.5w&&!b.5w.1h($12,k)){e.2e();H 18(G,'7X \"5w\" 7Y L.')}8(!Y(f)){8(7.E.1t!='*'){f='M'}O{F m=[f,b.E,7[k].E];1j(F a=0,l=m.S;a<l;a++){8(Y(m[a])||m[a]=='6Q'||m[a]=='M'){f=m[a];17}}}1F(f){R'6Q':e.2e();H y.1P(I(k+'7Z',G),[b,g]);17;R'M':8(!7.E.U.1d&&7.E.1t=='*'){f=7.E.M}17}}8(V.2d){y.T(I('3g',G));y.T(I('2O',G),[k,[b,f,g]]);e.2e();H 18(G,'3w 80 3f.')}8(b.1M>0){8(A.26){8(b.2O){8(b.2O=='2P'){2g=[]}8(b.2O!='X'||2g.S==0){y.T(I('2O',G),[k,[b,f,g]])}}e.2e();H 18(G,'3w 81 3f.')}}1u.3v=0;y.T(I('6R'+k,G),[b,f]);8(7.2n){F s=7.2n,c=[b,f];1j(F j=0,l=s.S;j<l;j++){F d=k;8(!s[j][2]){d=(d=='14')?'16':'14'}8(!s[j][1]){c[0]=s[j][0].1P('3o',['6S',d])}c[1]=f+s[j][3];s[j][0].T('3o',['6R'+d,c])}}H J});y.11(I('82',G),D(e,b,c){e.1g();F d=y.13();8(!7.1U){8(K.X==0){8(7.3z){y.T(I('16',G),K.Q-1)}H e.2e()}}1Y(d,7);8(!Y(c)){8(7.E.U.1d){c=4D(d,7,K.Q-1)}O 8(7.E.1t!='*'){F f=(Y(b.E))?b.E:5x(y,7);c=6T(d,7,K.Q-1,f)}O{c=7.E.M}c=4E(c,7,b.E,$12)}8(!7.1U){8(K.Q-c<K.X){c=K.Q-K.X}}7.E.U.20=7.E.M;8(7.E.U.1d){F g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12);8(7.E.M+c<=g&&c<K.Q){c++;g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12)}7.E.M=g}O 8(7.E.1t!='*'){F g=3W(d,7,K.Q-c);7.E.M=2x(g,7,7.E.U.2c,$12)}1Y(d,7,J);8(c==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+c+' E 5y.');K.X+=c;2h(K.X>=K.Q){K.X-=K.Q}8(!7.1U){8(K.X==0&&b.4F){b.4F.1h($12,'14')}8(!7.3z){3A(7,K.X,G)}}y.13().19(K.Q-c,K.Q).83(y);8(K.Q<7.E.M+c){y.13().19(0,(7.E.M+c)-K.Q).4G(J).47(y)}F d=y.13(),3i=6V(d,7,c),2i=6W(d,7),1Z=d.1N(c-1),21=3i.2P(),2r=2i.2P();1Y(d,7);F h=0,2B=0;8(7.1B){F p=4H(2i,7);h=p[0];2B=p[1]}F i=(h<0)?7.1i[7.d[3]]:0;F j=L,2Q=$();8(7.E.M<c){2Q=d.19(7.E.U.20,c);8(b.1V=='6X'){F k=7.E[7.d['P']];j=2Q;1Z=2r;5z(j);7.E[7.d['P']]='1d'}}F l=L,3B=2R(d.19(0,c),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4K={},2s={},2S={},4L={},2T={},5A={},2U=5B(b,7,c,3B);1F(b.1V){R'1I':R'1I-1w':3C=2R(d.19(0,7.E.M),7,'P');17}8(j){7.E[7.d['P']]=k}1Y(d,7,J);8(2B>=0){1Y(21,7,7.1i[7.d[1]])}8(h>=0){1Y(1Z,7,7.1i[7.d[3]])}8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=h}2T[7.d['1m']]=-(3B-i);5A[7.d['1m']]=-(3C-i);4K[7.d['1m']]=2j[7.d['P']];F m=D(){},1O=D(){},1C=D(){},3D=D(){},2C=D(){},5C=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(b.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':l=y.4G(J).47($1n);17}1F(b.1V){R'3j':R'22':R'22-1w':l.13().19(0,c).2t();l.13().19(7.E.U.20).2t();17;R'1I':R'1I-1w':l.13().19(7.E.M).2t();l.Z(5A);17}y.Z(2T);V=48(2U,b.2u,G);29[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){m=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){8(2r.4M(1Z).S){2s[7.d['1S']]=1Z.1q('2a');8(h<0){1Z.Z(2s)}O{1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}}1F(b.1V){R'1I':R'1I-1w':l.13().1N(c-1).Z(2s);17}8(2r.4M(21).S){2S[7.d['1S']]=21.1q('2a');1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])}}8(2B>=0){4L[7.d['1S']]=2r.1q('2a')+7.1i[7.d[1]];2C=D(){2r.Z(4L)};5C=D(){V.1a.1c([2r,4L])}}}1J=D(){y.Z(29)};F n=7.E.M+c-K.Q;1y=D(){8(n>0){y.13().19(K.Q).2t();3i=$(y.13().19(K.Q-(7.E.M-n)).3F().6Y(y.13().19(0,n).3F()))}5D(j);8(7.1R){F a=y.13().1N(7.E.M+c-1);a.Z(7.d['1S'],a.1q('2a'))}};F o=5E(3i,2Q,2i,c,'14',2U,2j);1x=D(){5F(y,l,b);A.26=L;2b.3h=4a($12,b,'3h',o,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,b,'3G',o,2b);1F(b.1V){R'42':y.Z(29);m();1C();2C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){m();1C();2C();1D();1J();1y();V=48(2U,b.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([l,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();2C();1D();1J();1y();17;R'1I':V.1a.1c([l,29,D(){1C();2C();1D();1J();1y();1x()}]);1O();17;R'1I-1w':V.1a.1c([y,{'1E':0}]);V.1a.1c([l,29,D(){y.Z({'1E':1});1C();2C();1D();1J();1y();1x()}]);1O();17;R'22':V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1y();1x()}]);1O();3D();5C();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('84',G),D(e,c,d){e.1g();F f=y.13();8(!7.1U){8(K.X==7.E.M){8(7.3z){y.T(I('14',G),K.Q-1)}H e.2e()}}1Y(f,7);8(!Y(d)){8(7.E.1t!='*'){F g=(Y(c.E))?c.E:5x(y,7);d=6Z(f,7,0,g)}O{d=7.E.M}d=4E(d,7,c.E,$12)}F h=(K.X==0)?K.Q:K.X;8(!7.1U){8(7.E.U.1d){F i=32(f,7,d),g=4D(f,7,h-1)}O{F i=7.E.M,g=7.E.M}8(d+i>h){d=h-g}}7.E.U.20=7.E.M;8(7.E.U.1d){F i=2x(5I(f,7,d,h),7,7.E.U.2c,$12);2h(7.E.M-d>=i&&d<K.Q){d++;i=2x(5I(f,7,d,h),7,7.E.U.2c,$12)}7.E.M=i}O 8(7.E.1t!='*'){F i=3W(f,7,d);7.E.M=2x(i,7,7.E.U.2c,$12)}1Y(f,7,J);8(d==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+d+' E 70.');K.X-=d;2h(K.X<0){K.X+=K.Q}8(!7.1U){8(K.X==7.E.M&&c.4F){c.4F.1h($12,'16')}8(!7.3z){3A(7,K.X,G)}}8(K.Q<7.E.M+d){y.13().19(0,(7.E.M+d)-K.Q).4G(J).47(y)}F f=y.13(),3i=71(f,7),2i=72(f,7,d),1Z=f.1N(d-1),21=3i.2P(),2r=2i.2P();1Y(f,7);F j=0,2B=0;8(7.1B){F p=4H(2i,7);j=p[0];2B=p[1]}F k=L,2Q=$();8(7.E.U.20<d){2Q=f.19(7.E.U.20,d);8(c.1V=='6X'){F l=7.E[7.d['P']];k=2Q;1Z=21;5z(k);7.E[7.d['P']]='1d'}}F m=L,3B=2R(f.19(0,d),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4N={},2s={},2S={},2T={},2U=5B(c,7,d,3B);1F(c.1V){R'22':R'22-1w':3C=2R(f.19(0,7.E.U.20),7,'P');17}8(k){7.E[7.d['P']]=l}8(7.1B){8(7.1i[7.d[1]]<0){7.1i[7.d[1]]=0}}1Y(f,7,J);1Y(21,7,7.1i[7.d[1]]);8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=j}2T[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;F n=D(){},1O=D(){},1C=D(){},3D=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(c.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':m=y.4G(J).47($1n);m.13().19(7.E.U.20).2t();17}1F(c.1V){R'3j':R'1I':R'1I-1w':y.Z('3Z',1);m.Z('3Z',0);17}V=48(2U,c.2u,G);29[7.d['1m']]=-3B;4N[7.d['1m']]=-3C;8(j<0){29[7.d['1m']]+=j}8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){n=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){F o=2r.1q('2a');8(2B>=0){o+=7.1i[7.d[1]]}2r.Z(7.d['1S'],o);8(1Z.4M(21).S){2S[7.d['1S']]=21.1q('2a')}1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])};F q=1Z.1q('2a');8(j>0){q+=7.1i[7.d[3]]}2s[7.d['1S']]=q;1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}1J=D(){y.Z(2T)};F r=7.E.M+d-K.Q;1y=D(){8(r>0){y.13().19(K.Q).2t()}F a=y.13().19(0,d).47(y).2P();8(r>0){2i=3I(f,7)}5D(k);8(7.1R){8(K.Q<7.E.M+d){F b=y.13().1N(7.E.M-1);b.Z(7.d['1S'],b.1q('2a')+7.1i[7.d[1]])}a.Z(7.d['1S'],a.1q('2a'))}};F s=5E(3i,2Q,2i,d,'16',2U,2j);1x=D(){y.Z('3Z',y.1q('6K'));5F(y,m,c);A.26=L;2b.3h=4a($12,c,'3h',s,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,c,'3G',s,2b);1F(c.1V){R'42':y.Z(29);n();1C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){n();1C();1D();1J();1y();V=48(2U,c.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([m,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();1D();1J();1y();17;R'1I':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'1I-1w':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([m,{'1E':0}]);V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'22':V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1J();1y();1x()}]);1O();3D();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('3k',G),D(e,b,c,d,f,g,h){e.1g();F v=[b,c,d,f,g,h],t=['2M/28/2A','28','3d','2A','2M','D'],a=3e(v,t);f=a[3];g=a[4];h=a[5];b=3J(a[0],a[1],a[2],K,y);8(b==0){H L}8(!1T(f)){f=L}8(g!='14'&&g!='16'){8(7.1U){g=(b<=K.Q/2)?'16':'14'}O{g=(K.X==0||K.X>b)?'16':'14'}}8(g=='14'){b=K.Q-b}y.T(I(g,G),[f,b,h]);H J});y.11(I('85',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c-1,a,'14',b])});y.11(I('86',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c+1,a,'16',b])});y.11(I('5J',G),D(e,a,b,c,d){e.1g();8(!Y(a)){a=y.1P(I('4b',G))}F f=7.1b.E||7.E.M,1X=1H.2z(K.Q/f)-1;8(a<0){a=1X}8(a>1X){a=0}H y.1P(I('3k',G),[a*f,0,J,b,c,d])});y.11(I('73',G),D(e,s){e.1g();8(s){s=3J(s,0,J,K,y)}O{s=0}s+=K.X;8(s!=0){8(K.Q>0){2h(s>K.Q){s-=K.Q}}y.87(y.13().19(s,K.Q))}H J});y.11(I('2n',G),D(e,s){e.1g();8(s){s=5k(s)}O 8(7.2n){s=7.2n}O{H 18(G,'6j 88 46 2n.')}F n=y.1P(I('4p',G)),x=J;1j(F j=0,l=s.S;j<l;j++){8(!s[j][0].1P(I('3k',G),[n,s[j][3],J])){x=L}}H x});y.11(I('2O',G),D(e,a,b){e.1g();8(1o(a)){a.1h($12,2g)}O 8(2V(a)){2g=a}O 8(!1z(a)){2g.1c([a,b])}H 2g});y.11(I('89',G),D(e,b,c,d,f){e.1g();F v=[b,c,d,f],t=['2M/2A','2M/28/2A','3d','28'],a=3e(v,t);b=a[0];c=a[1];d=a[2];f=a[3];8(1T(b)&&!2v(b)){b=$(b)}O 8(1p(b)){b=$(b)}8(!2v(b)||b.S==0){H 18(G,'2p a 5K 2A.')}8(1z(c)){c='4c'}4x(b,7);41(b);F g=c,4d='4d';8(c=='4c'){8(d){8(K.X==0){c=K.Q-1;4d='74'}O{c=K.X;K.X+=b.S}8(c<0){c=0}}O{c=K.Q-1;4d='74'}}O{c=3J(c,f,d,K,y)}F h=y.13().1N(c);8(h.S){h[4d](b)}O{18(G,'8a 8b-3r 4M 6k! 8c 8d 46 75 4c.');y.76(b)}8(g!='4c'&&!d){8(c<K.X){K.X+=b.S}}K.Q=y.13().S;8(K.X>=K.Q){K.X-=K.Q}y.T(I('4O',G));y.T(I('5L',G));H J});y.11(I('77',G),D(e,c,d,f){e.1g();F v=[c,d,f],t=['2M/28/2A','3d','28'],a=3e(v,t);c=a[0];d=a[1];f=a[2];F g=L;8(c 2W $&&c.S>1){h=$();c.1W(D(i,a){F b=y.T(I('77',G),[$(1l),d,f]);8(b){h=h.8e(b)}});H h}8(1z(c)||c=='4c'){h=y.13().2P()}O{c=3J(c,f,d,K,y);F h=y.13().1N(c);8(h.S){8(c<K.X){K.X-=h.S}}}8(h&&h.S){h.8f();K.Q=y.13().S;y.T(I('4O',G))}H h});y.11(I('3G',G)+' '+I('3h',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S);8(2V(a)){2b[b]=a}8(1o(a)){2b[b].1c(a)}H 2b[b]});y.11(I('4p',G),D(e,a){e.1g();8(K.X==0){F b=0}O{F b=K.Q-K.X}8(1o(a)){a.1h($12,b)}H b});y.11(I('4b',G),D(e,a){e.1g();F b=7.1b.E||7.E.M,1X=1H.2z(K.Q/b-1),2k;8(K.X==0){2k=0}O 8(K.X<K.Q%b){2k=0}O 8(K.X==b&&!7.1U){2k=1X}O{2k=1H.78((K.Q-K.X)/b)}8(2k<0){2k=0}8(2k>1X){2k=1X}8(1o(a)){a.1h($12,2k)}H 2k});y.11(I('8g',G),D(e,a){e.1g();F b=3I(y.13(),7);8(1o(a)){a.1h($12,b)}H b});y.11(I('19',G),D(e,f,l,b){e.1g();8(K.Q==0){H L}F v=[f,l,b],t=['28','28','D'],a=3e(v,t);f=(Y(a[0]))?a[0]:0;l=(Y(a[1]))?a[1]:K.Q;b=a[2];f+=K.X;l+=K.X;8(E.Q>0){2h(f>K.Q){f-=K.Q}2h(l>K.Q){l-=K.Q}2h(f<0){f+=K.Q}2h(l<0){l+=K.Q}}F c=y.13(),$i;8(l>f){$i=c.19(f,l)}O{$i=$(c.19(f,K.Q).3F().6Y(c.19(0,l).3F()))}8(1o(b)){b.1h($12,$i)}H $i});y.11(I('27',G)+' '+I('2d',G)+' '+I('26',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S),5M=A[b];8(1o(a)){a.1h($12,5M)}H 5M});y.11(I('6S',G),D(e,a,b,c){e.1g();F d=L;8(1o(a)){a.1h($12,7)}O 8(1T(a)){31=$.1L(J,{},31,a);8(b!==L)d=J;O 7=$.1L(J,{},7,a)}O 8(!1z(a)){8(1o(b)){F f=4P('7.'+a);8(1z(f)){f=''}b.1h($12,f)}O 8(!1z(b)){8(2X c!=='3d')c=J;4P('31.'+a+' = b');8(c!==L)d=J;O 4P('7.'+a+' = b')}O{H 4P('7.'+a)}}8(d){1Y(y.13(),7);z.59(31);z.5N();F g=4Q(y,7);y.T(I('3H',G),[J,g])}H 7});y.11(I('5L',G),D(e,a,b){e.1g();8(1z(a)){a=$('8h')}O 8(1p(a)){a=$(a)}8(!2v(a)||a.S==0){H 18(G,'2p a 5K 2A.')}8(!1p(b)){b='a.6i'}a.8i(b).1W(D(){F h=1l.79||'';8(h.S>0&&y.13().7a($(h))!=-1){$(1l).23('5O').5O(D(e){e.2D();y.T(I('3k',G),h)})}});H J});y.11(I('3H',G),D(e,b,c){e.1g();8(!7.1b.1A){H}F d=7.1b.E||7.E.M,4R=1H.2z(K.Q/d);8(b){8(7.1b.3K){7.1b.1A.13().2t();7.1b.1A.1W(D(){1j(F a=0;a<4R;a++){F i=y.13().1N(3J(a*d,0,J,K,y));$(1l).76(7.1b.3K.1h(i[0],a+1))}})}7.1b.1A.1W(D(){$(1l).13().23(7.1b.3L).1W(D(a){$(1l).11(7.1b.3L,D(e){e.2D();y.T(I('3k',G),[a*d,-7.1b.4S,J,7.1b])})})})}F f=y.1P(I('4b',G))+7.1b.4S;8(f>=4R){f=0}8(f<0){f=4R-1}7.1b.1A.1W(D(){$(1l).13().2N(2y('7b',G)).1N(f).3a(2y('7b',G))});H J});y.11(I('4O',G),D(e){F a=7.E.M,2E=y.13(),2m=5d($1n,7,'P');K.Q=2E.S;8(A.4r){7.3U=2m;7[7.d['P']]=4s(2m,A.4r)}O{7.3U=5e(7,2m)}8(7.2H){7.E.P=7.E.3M.P;7.E.1e=7.E.3M.1e;7=5g(7,2E,2m);a=7.E.M;5r(7,2E)}O 8(7.E.U.1d){a=32(2E,7,0)}O 8(7.E.1t!='*'){a=3W(2E,7,0)}8(!7.1U&&K.X!=0&&a>K.X){8(7.E.U.1d){F b=4D(2E,7,K.X)-K.X}O 8(7.E.1t!='*'){F b=7c(2E,7,K.X)-K.X}O{F b=7.E.M-K.X}18(G,'8j 8k-1U: 8l '+b+' E 5y.');y.T(I('14',G),b)}7.E.M=2x(a,7,7.E.U.2c,$12);7.E.U.20=7.E.M;7=5i(7,2E);F c=4Q(y,7);y.T(I('3H',G),[J,c]);4T(7,K.Q,G);3A(7,K.X,G);H c});y.11(I('4q',G),D(e,a){e.1g();1u=3u(1u);y.1q('57',L);y.T(I('5t',G));8(a){y.T(I('73',G))}4U(y.13());4U(y);z.5s();z.5P();8(G.3s=='36'){4U($1n)}O{$1n.8m(y)}H J});y.11(I('18',G),D(e){18(G,'3w P: '+7.P);18(G,'3w 1e: '+7.1e);18(G,'7d 8n: '+7.E.P);18(G,'7d 8o: '+7.E.1e);18(G,'4e 4f E M: '+7.E.M);8(7.N.1G){18(G,'4e 4f E 5Q 8p: '+7.N.E)}8(7.14.W){18(G,'4e 4f E 5Q 5y: '+7.14.E)}8(7.16.W){18(G,'4e 4f E 5Q 70: '+7.16.E)}H G.18});y.11('3o',D(e,n,o){e.1g();H y.1P(I(n,G),o)})};z.5s=D(){y.23(I('',G));y.23(I('',G,L));y.23('3o')};z.5N=D(){z.5P();4T(7,K.Q,G);3A(7,K.X,G);8(7.N.2F){F b=3N(7.N.2F);$1n.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}8(7.N.W){7.N.W.11(I(7.N.3L,G,L),D(e){e.2D();F a=L,b=3O;8(A.27){a='1G'}O 8(7.N.4X){a='3b';b=3N(7.N.4X)}8(a){y.T(I(a,G),b)}})}8(7.14.W){7.14.W.11(I(7.14.3L,G,L),D(e){e.2D();y.T(I('14',G))});8(7.14.2F){F b=3N(7.14.2F);7.14.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.16.W){7.16.W.11(I(7.16.3L,G,L),D(e){e.2D();y.T(I('16',G))});8(7.16.2F){F b=3N(7.16.2F);7.16.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.1b.1A){8(7.1b.2F){F b=3N(7.1b.2F);7.1b.1A.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.14.2Y||7.16.2Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k==7.16.2Y){e.2D();y.T(I('16',G))}8(k==7.14.2Y){e.2D();y.T(I('14',G))}})}8(7.1b.4Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k>=49&&k<58){k=(k-49)*7.E.M;8(k<=K.Q){e.2D();y.T(I('3k',G),[k,0,J,7.1b])}}})}8($.1s.1r){F c='8q'8r 3l;8((c&&7.1r.4h)||(!c&&7.1r.5R)){F d=$.1L(J,{},7.14,7.1r),7g=$.1L(J,{},7.16,7.1r),5S=D(){y.T(I('14',G),[d])},5T=D(){y.T(I('16',G),[7g])};1F(7.2l){R'5c':R'7h':7.1r.2G.8s=5T;7.1r.2G.8t=5S;17;2J:7.1r.2G.8u=5T;7.1r.2G.8v=5S}8(A.1r){y.1r('4q')}$1n.1r(7.1r.2G);$1n.Z('7i','8w');A.1r=J}}8($.1s.1Q){8(7.1Q){F f=$.1L(J,{},7.14,7.1Q),7j=$.1L(J,{},7.16,7.1Q);8(A.1Q){$1n.23(I('1Q',G,L))}$1n.11(I('1Q',G,L),D(e,a){e.2D();8(a>0){y.T(I('14',G),[f])}O{y.T(I('16',G),[7j])}});A.1Q=J}}8(7.N.1G){y.T(I('1G',G),7.N.5U)}8(A.6v){F g=D(e){y.T(I('5t',G));8(7.N.5V&&!A.27){y.T(I('1G',G))}1Y(y.13(),7);y.T(I('4O',G))};F h=$(3l),4i=3O;8($.5W&&G.5X=='5W'){4i=$.5W(8x,g)}O 8($.4Z&&G.5X=='4Z'){4i=$.4Z(8y,g)}O{F i=0,5Y=0;4i=D(){F a=h.P(),5Z=h.1e();8(a!=i||5Z!=5Y){g();i=a;5Y=5Z}}}h.11(I('8z',G,L,J,J),4i)}};z.5P=D(){F a=I('',G),3P=I('',G,L);61=I('',G,L,J,J);$(4g).23(61);$(3l).23(61);$1n.23(3P);8(7.N.W){7.N.W.23(3P)}8(7.14.W){7.14.W.23(3P)}8(7.16.W){7.16.W.23(3P)}8(7.1b.1A){7.1b.1A.23(3P);8(7.1b.3K){7.1b.1A.13().2t()}}8(A.1r){y.1r('4q');$1n.Z('7i','2J');A.1r=L}8(A.1Q){A.1Q=L}4T(7,'4j',G);3A(7,'2N',G)};8(1k(w)){w={'18':w}}F A={'2l':'16','27':J,'26':L,'2d':L,'1Q':L,'1r':L},K={'Q':y.13().S,'X':0},1u={'N':3O,'1f':3O,'2L':2o(),'3v':0},V={'2d':L,'1M':0,'2L':0,'2u':'','1a':[]},2b={'3G':[],'3h':[]},2g=[],G=$.1L(J,{},$.1s.1v.7k,w),7={},31=$.1L(J,{},u),$1n=(G.3s=='36')?y.36():y.8A('<'+G.3s.55+' 8B=\"'+G.3s.7l+'\" />').36();G.4o=y.4o;G.3T=$.1s.1v.3T++;G.2Z=(G.2Z&&$.1s.2Z)?'2Z':'8C';z.59(31,J,56);z.6D();z.6L();z.5N();8(2V(7.E.3m)){F B=7.E.3m}O{F B=[];8(7.E.3m!=0){B.1c(7.E.3m)}}8(7.25){B.8D(4k(7m(7.25),10))}8(B.S>0){1j(F a=0,l=B.S;a<l;a++){F s=B[a];8(s==0){62}8(s===J){s=3l.8E.79;8(s.S<1){62}}O 8(s==='7n'){s=1H.4l(1H.7n()*K.Q)}8(y.1P(I('3k',G),[s,0,J,{1V:'42'}])){17}}}F C=4Q(y,7),7o=3I(y.13(),7);8(7.7p){7.7p.1h($12,{'P':C.P,'1e':C.1e,'E':7o})}y.T(I('3H',G),[J,C]);y.T(I('5L',G));8(G.18){y.T(I('18',G))}H y};$.1s.1v.3T=1;$.1s.1v.5b={'2n':L,'3z':J,'1U':J,'2H':L,'2l':'1m','E':{'3m':0},'1K':{'2u':'7q','1M':6y,'2F':L,'3L':'5O','2O':L}};$.1s.1v.7k={'18':L,'2Z':L,'5X':'4Z','3y':{'45':'','7r':'8F'},'3s':{'55':'8G','7l':'8H'},'63':{}};$.1s.1v.7s=D(a){H'<a 8I=\"#\"><7t>'+a+'</7t></a>'};$.1s.1v.7u=D(a){$(1l).Z('P',a+'%')};$.1s.1v.25={3F:D(n){n+='=';F b=4g.25.3Q(';');1j(F a=0,l=b.S;a<l;a++){F c=b[a];2h(c.8J(0)==' '){c=c.19(1)}8(c.3R(n)==0){H c.19(n.S)}}H 0},64:D(n,v,d){F e=\"\";8(d){F a=7v 7w();a.8K(a.2o()+(d*24*60*60*8L));e=\"; 8M=\"+a.8N()}4g.25=n+'='+v+e+'; 8O=/'},2t:D(n){$.1s.1v.25.64(n,\"\",-1)}};D 48(d,e,c){8(c.2Z=='2Z'){8(e=='7q'){e='8P'}}H{1a:[],1M:d,8Q:d,2u:e,2L:2o()}}D 3x(s,c){1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];8(!b){62}b[0][c.2Z](b[1],s.1M,s.2u,b[2])}}D 43(s,c){8(!1k(c)){c=J}8(1T(s.4z)){43(s.4z,c)}1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];b[0].6M(J);8(c){b[0].Z(b[1]);8(1o(b[2])){b[2]()}}}8(1T(s.4A)){43(s.4A,c)}}D 5F(a,b,o){8(b){b.2t()}1F(o.1V){R'1w':R'3j':R'1I-1w':R'22-1w':a.Z('1t','');a.Z('1E',1);17}}D 4a(d,o,b,a,c){8(o[b]){o[b].1h(d,a)}8(c[b].S){1j(F i=0,l=c[b].S;i<l;i++){c[b][i].1h(d,a)}}H[]}D 5G(a,q,c){8(q.S){a.T(I(q[0][0],c),q[0][1]);q.8R()}H q}D 5z(b){b.1W(D(){F a=$(1l);a.1q('7x',a.2f(':3t')).4j()})}D 5D(b){8(b){b.1W(D(){F a=$(1l);8(!a.1q('7x')){a.4m()}})}}D 3u(t){8(t.N){8S(t.N)}8(t.1f){8T(t.1f)}H t}D 5E(a,b,c,d,e,f,g){H{'P':g.P,'1e':g.1e,'E':{'20':a,'8U':b,'M':c},'1K':{'E':d,'2l':e,'1M':f}}}D 5B(a,o,b,c){F d=a.1M;8(a.1V=='42'){H 0}8(d=='N'){d=o.1K.1M/o.1K.E*b}O 8(d<10){d=c/d}8(d<1){H 0}8(a.1V=='1w'){d=d/2}H 1H.78(d)}D 4T(o,t,c){F a=(Y(o.E.4C))?o.E.4C:o.E.M+1;8(t=='4m'||t=='4j'){F f=t}O 8(a>t){18(c,'2p 6O E ('+t+' Q, '+a+' 6P): 8V 8W.');F f='4j'}O{F f='4m'}F s=(f=='4m')?'2N':'3a',h=2y('3t',c);8(o.N.W){o.N.W[f]()[s](h)}8(o.14.W){o.14.W[f]()[s](h)}8(o.16.W){o.16.W[f]()[s](h)}8(o.1b.1A){o.1b.1A[f]()[s](h)}}D 3A(o,f,c){8(o.1U||o.3z)H;F a=(f=='2N'||f=='3a')?f:L,51=2y('8X',c);8(o.N.W&&a){o.N.W[a](51)}8(o.14.W){F b=a||(f==0)?'3a':'2N';o.14.W[b](51)}8(o.16.W){F b=a||(f==o.E.M)?'3a':'2N';o.16.W[b](51)}}D 3S(a,b){8(1o(b)){b=b.1h(a)}O 8(1z(b)){b={}}H b}D 6l(a,b){b=3S(a,b);8(Y(b)){b={'M':b}}O 8(b=='1d'){b={'M':b,'P':b,'1e':b}}O 8(!1T(b)){b={}}H b}D 6m(a,b){b=3S(a,b);8(Y(b)){8(b<=50){b={'E':b}}O{b={'1M':b}}}O 8(1p(b)){b={'2u':b}}O 8(!1T(b)){b={}}H b}D 52(a,b){b=3S(a,b);8(1p(b)){F c=65(b);8(c==-1){b=$(b)}O{b=c}}H b}D 6n(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(1k(b)){b={'1G':b}}O 8(Y(b)){b={'2K':b}}8(b.1f){8(1p(b.1f)||2v(b.1f)){b.1f={'2q':b.1f}}}H b}D 6z(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(!1k(b.1G)){b.1G=J}8(!Y(b.5U)){b.5U=0}8(1z(b.4X)){b.4X=J}8(!1k(b.5V)){b.5V=J}8(!Y(b.2K)){b.2K=(b.1M<10)?8Y:b.1M*5}8(b.1f){8(1o(b.1f.2q)){b.1f.2q=b.1f.2q.1h(a)}8(1p(b.1f.2q)){b.1f.2q=$(b.1f.2q)}8(b.1f.2q){8(!1o(b.1f.4B)){b.1f.4B=$.1s.1v.7u}8(!Y(b.1f.5u)){b.1f.5u=50}}O{b.1f=L}}H b}D 5a(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(Y(b)){b={'2Y':b}}H b}D 5j(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(1p(b.2Y)){b.2Y=65(b.2Y)}H b}D 6o(a,b){b=52(a,b);8(2v(b)){b={'1A':b}}O 8(1k(b)){b={'4Y':b}}H b}D 6A(a,b){8(1o(b.1A)){b.1A=b.1A.1h(a)}8(1p(b.1A)){b.1A=$(b.1A)}8(!Y(b.E)){b.E=L}8(!1k(b.4Y)){b.4Y=L}8(!1o(b.3K)&&!53(b.3K)){b.3K=$.1s.1v.7s}8(!Y(b.4S)){b.4S=0}H b}D 6p(a,b){8(1o(b)){b=b.1h(a)}8(1z(b)){b={'4h':L}}8(3p(b)){b={'4h':b}}O 8(Y(b)){b={'E':b}}H b}D 6B(a,b){8(!1k(b.4h)){b.4h=J}8(!1k(b.5R)){b.5R=L}8(!1T(b.2G)){b.2G={}}8(!1k(b.2G.7y)){b.2G.7y=L}H b}D 6q(a,b){8(1o(b)){b=b.1h(a)}8(3p(b)){b={}}O 8(Y(b)){b={'E':b}}O 8(1z(b)){b=L}H b}D 6C(a,b){H b}D 3J(a,b,c,d,e){8(1p(a)){a=$(a,e)}8(1T(a)){a=$(a,e)}8(2v(a)){a=e.13().7a(a);8(!1k(c)){c=L}}O{8(!1k(c)){c=J}}8(!Y(a)){a=0}8(!Y(b)){b=0}8(c){a+=d.X}a+=b;8(d.Q>0){2h(a>=d.Q){a-=d.Q}2h(a<0){a+=d.Q}}H a}D 4D(i,o,s){F t=0,x=0;1j(F a=s;a>=0;a--){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}8(a==0){a=i.S}x++}}D 7c(i,o,s){H 66(i,o.E.1t,o.E.U.4t,s)}D 6T(i,o,s,m){H 66(i,o.E.1t,m,s)}D 66(i,f,m,s){F t=0,x=0;1j(F a=s,l=i.S;a>=0;a--){x++;8(x==l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==0){a=l}}}D 5x(a,o){H o.E.U.4t||a.13().19(0,o.E.M).1t(o.E.1t).S}D 32(i,o,s){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}x++;8(x==l+1){H x}8(a==l){a=-1}}}D 5I(i,o,s,l){F v=32(i,o,s);8(!o.1U){8(s+v>l){v=l-s}}H v}D 3W(i,o,s){H 68(i,o.E.1t,o.E.U.4t,s,o.1U)}D 6Z(i,o,s,m){H 68(i,o.E.1t,m+1,s,o.1U)-1}D 68(i,f,m,s,c){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){x++;8(x>=l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==l){a=-1}}}D 3I(i,o){H i.19(0,o.E.M)}D 6V(i,o,n){H i.19(n,o.E.U.20+n)}D 6W(i,o){H i.19(0,o.E.M)}D 71(i,o){H i.19(0,o.E.U.20)}D 72(i,o,n){H i.19(n,o.E.M+n)}D 4x(i,o,d){8(o.1R){8(!1p(d)){d='2a'}i.1W(D(){F j=$(1l),m=4k(j.Z(o.d['1S']),10);8(!Y(m)){m=0}j.1q(d,m)})}}D 1Y(i,o,m){8(o.1R){F x=(1k(m))?m:L;8(!Y(m)){m=0}4x(i,o,'7z');i.1W(D(){F j=$(1l);j.Z(o.d['1S'],((x)?j.1q('7z'):m+j.1q('2a')))})}}D 41(i){i.1W(D(){F j=$(1l);j.1q('7A',j.7B('7C')||'')})}D 4U(i){i.1W(D(){F j=$(1l);j.7B('7C',j.1q('7A')||'')})}D 5r(o,b){F c=o.E.M,7D=o.E[o.d['P']],69=o[o.d['1e']],7E=3V(69);b.1W(D(){F a=$(1l),6a=7D-7F(a,o,'8Z');a[o.d['P']](6a);8(7E){a[o.d['1e']](4s(6a,69))}})}D 4Q(a,o){F b=a.36(),$i=a.13(),$v=3I($i,o),54=4I(4J($v,o,J),o,L);b.Z(54);8(o.1R){F p=o.1i,r=p[o.d[1]];8(o.1B&&r<0){r=0}F c=$v.2P();c.Z(o.d['1S'],c.1q('2a')+r);a.Z(o.d['3q'],p[o.d[0]]);a.Z(o.d['1m'],p[o.d[3]])}a.Z(o.d['P'],54[o.d['P']]+(2R($i,o,'P')*2));a.Z(o.d['1e'],6b($i,o,'1e'));H 54}D 4J(i,o,a){H[2R(i,o,'P',a),6b(i,o,'1e',a)]}D 6b(i,o,a,b){8(!1k(b)){b=L}8(Y(o[o.d[a]])&&b){H o[o.d[a]]}8(Y(o.E[o.d[a]])){H o.E[o.d[a]]}a=(a.6c().3R('P')>-1)?'2w':'3n';H 4n(i,o,a)}D 4n(i,o,b){F s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F m=(j.2f(':M'))?j[o.d[b]](J):0;8(s<m){s=m}}H s}D 2R(i,o,b,c){8(!1k(c)){c=L}8(Y(o[o.d[b]])&&c){H o[o.d[b]]}8(Y(o.E[o.d[b]])){H o.E[o.d[b]]*i.S}F d=(b.6c().3R('P')>-1)?'2w':'3n',s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);s+=(j.2f(':M'))?j[o.d[d]](J):0}H s}D 5d(a,o,d){F b=a.2f(':M');8(b){a.4j()}F s=a.36()[o.d[d]]();8(b){a.4m()}H s}D 5e(o,a){H(Y(o[o.d['P']]))?o[o.d['P']]:a}D 6d(i,o,b){F s=L,v=L;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F c=(j.2f(':M'))?j[o.d[b]](J):0;8(s===L){s=c}O 8(s!=c){v=J}8(s==0){v=J}}H v}D 7F(i,o,d){H i[o.d['90'+d]](J)-i[o.d[d.6c()]]()}D 4s(s,o){8(3V(o)){o=4k(o.19(0,-1),10);8(!Y(o)){H s}s*=o/2I}H s}D I(n,c,a,b,d){8(!1k(a)){a=J}8(!1k(b)){b=J}8(!1k(d)){d=L}8(a){n=c.3y.45+n}8(b){n=n+'.'+c.3y.7r}8(b&&d){n+=c.3T}H n}D 2y(n,c){H(1p(c.63[n]))?c.63[n]:n}D 4I(a,o,p){8(!1k(p)){p=J}F b=(o.1R&&p)?o.1i:[0,0,0,0];F c={};c[o.d['P']]=a[0]+b[1]+b[3];c[o.d['1e']]=a[1]+b[0]+b[2];H c}D 3e(c,d){F e=[];1j(F a=0,7G=c.S;a<7G;a++){1j(F b=0,7H=d.S;b<7H;b++){8(d[b].3R(2X c[a])>-1&&1z(e[b])){e[b]=c[a];17}}}H e}D 6x(p){8(1z(p)){H[0,0,0,0]}8(Y(p)){H[p,p,p,p]}8(1p(p)){p=p.3Q('91').7I('').3Q('92').7I('').3Q(' ')}8(!2V(p)){H[0,0,0,0]}1j(F i=0;i<4;i++){p[i]=4k(p[i],10)}1F(p.S){R 0:H[0,0,0,0];R 1:H[p[0],p[0],p[0],p[0]];R 2:H[p[0],p[1],p[0],p[1]];R 3:H[p[0],p[1],p[2],p[1]];2J:H[p[0],p[1],p[2],p[3]]}}D 4H(a,o){F x=(Y(o[o.d['P']]))?1H.2z(o[o.d['P']]-2R(a,o,'P')):0;1F(o.1B){R'1m':H[0,x];R'35':H[x,0];R'5f':2J:H[1H.2z(x/2),1H.4l(x/2)]}}D 6r(o){F a=[['P','7J','2w','1e','7K','3n','1m','3q','1S',0,1,2,3],['1e','7K','3n','P','7J','2w','3q','1m','5p',3,2,1,0]];F b=a[0].S,7L=(o.2l=='35'||o.2l=='1m')?0:1;F c={};1j(F d=0;d<b;d++){c[a[0][d]]=a[7L][d]}H c}D 4E(x,o,a,b){F v=x;8(1o(a)){v=a.1h(b,v)}O 8(1p(a)){F p=a.3Q('+'),m=a.3Q('-');8(m.S>p.S){F c=J,6e=m[0],30=m[1]}O{F c=L,6e=p[0],30=p[1]}1F(6e){R'93':v=(x%2==1)?x-1:x;17;R'94':v=(x%2==0)?x-1:x;17;2J:v=x;17}30=4k(30,10);8(Y(30)){8(c){30=-30}v+=30}}8(!Y(v)||v<1){v=1}H v}D 2x(x,o,a,b){H 6f(4E(x,o,a,b),o.E.U)}D 6f(v,i){8(Y(i.34)&&v<i.34){v=i.34}8(Y(i.1X)&&v>i.1X){v=i.1X}8(v<1){v=1}H v}D 5k(s){8(!2V(s)){s=[[s]]}8(!2V(s[0])){s=[s]}1j(F j=0,l=s.S;j<l;j++){8(1p(s[j][0])){s[j][0]=$(s[j][0])}8(!1k(s[j][1])){s[j][1]=J}8(!1k(s[j][2])){s[j][2]=J}8(!Y(s[j][3])){s[j][3]=0}}H s}D 65(k){8(k=='35'){H 39}8(k=='1m'){H 37}8(k=='5c'){H 38}8(k=='7h'){H 40}H-1}D 5H(n,a,c){8(n){F v=a.1P(I('4p',c));$.1s.1v.25.64(n,v)}}D 7m(n){F c=$.1s.1v.25.3F(n);H(c=='')?0:c}D 6E(a,b){F c={};1j(F p=0,l=b.S;p<l;p++){c[b[p]]=a.Z(b[p])}H c}D 6s(a,b,c,d){8(!1T(a.U)){a.U={}}8(!1T(a.3M)){a.3M={}}8(a.3m==0&&Y(d)){a.3m=d}8(1T(a.M)){a.U.34=a.M.34;a.U.1X=a.M.1X;a.M=L}O 8(1p(a.M)){8(a.M=='1d'){a.U.1d=J}O{a.U.2c=a.M}a.M=L}O 8(1o(a.M)){a.U.2c=a.M;a.M=L}8(!1p(a.1t)){a.1t=(c.1t(':3t').S>0)?':M':'*'}8(!a[b.d['P']]){8(b.2H){18(J,'7M a '+b.d['P']+' 1j 75 E!');a[b.d['P']]=4n(c,b,'2w')}O{a[b.d['P']]=(6d(c,b,'2w'))?'1d':c[b.d['2w']](J)}}8(!a[b.d['1e']]){a[b.d['1e']]=(6d(c,b,'3n'))?'1d':c[b.d['3n']](J)}a.3M.P=a.P;a.3M.1e=a.1e;H a}D 6w(a,b){8(a.E[a.d['P']]=='1d'){a.E.U.1d=J}8(!a.E.U.1d){8(Y(a[a.d['P']])){a.E.M=1H.4l(a[a.d['P']]/a.E[a.d['P']])}O{a.E.M=1H.4l(b/a.E[a.d['P']]);a[a.d['P']]=a.E.M*a.E[a.d['P']];8(!a.E.U.2c){a.1B=L}}8(a.E.M=='95'||a.E.M<1){18(J,'2p a 5K 28 4f M E: 7M 46 \"1d\".');a.E.U.1d=J}}H a}D 6t(a,b,c){8(a=='N'){a=4n(c,b,'2w')}H a}D 6u(a,b,c){8(a=='N'){a=4n(c,b,'3n')}8(!a){a=b.E[b.d['1e']]}H a}D 5i(o,a){F p=4H(3I(a,o),o);o.1i[o.d[1]]=p[1];o.1i[o.d[3]]=p[0];H o}D 5g(o,a,b){F c=6f(1H.2z(o[o.d['P']]/o.E[o.d['P']]),o.E.U);8(c>a.S){c=a.S}F d=1H.4l(o[o.d['P']]/c);o.E.M=c;o.E[o.d['P']]=d;o[o.d['P']]=c*d;H o}D 3N(p){8(1p(p)){F i=(p.3R('96')>-1)?J:L,r=(p.3R('3g')>-1)?J:L}O{F i=r=L}H[i,r]}D 97(a){H(Y(a))?a:3O}D 6g(a){H(a===3O)}D 1z(a){H(6g(a)||2X a=='7N'||a===''||a==='7N')}D 2V(a){H(a 2W 98)}D 2v(a){H(a 2W 7O)}D 1T(a){H((a 2W 99||2X a=='2A')&&!6g(a)&&!2v(a)&&!2V(a))}D Y(a){H((a 2W 4e||2X a=='28')&&!9a(a))}D 1p(a){H((a 2W 9b||2X a=='2M')&&!1z(a)&&!3p(a)&&!53(a))}D 1o(a){H(a 2W 9c||2X a=='D')}D 1k(a){H(a 2W 9d||2X a=='3d'||3p(a)||53(a))}D 3p(a){H(a===J||a==='J')}D 53(a){H(a===L||a==='L')}D 3V(x){H(1p(x)&&x.19(-1)=='%')}D 2o(){H 7v 7w().2o()}D 3X(o,n){18(J,o+' 2f 9e, 9f 1j 9g 9h 9i 9j. 9k '+n+' 9l.')}D 18(d,m){8(!1z(3l.6h)&&!1z(3l.6h.7P)){8(1T(d)){F s=' ('+d.4o+')';d=d.18}O{F s=''}8(!d){H L}8(1p(m)){m='1v'+s+': '+m}O{m=['1v'+s+':',m]}3l.6h.7P(m)}H L}$.1L($.2u,{'9m':D(t){F a=t*t;H t*(-a*t+4*a-6*t+4)},'9n':D(t){H t*(4*t*t-9*t+6)},'9o':D(t){F a=t*t;H t*(33*a*a-9p*a*t+9q*a-67*t+15)}})})(7O);", 
62, 585, "|||||||opts|if|||||||||||||||||||||||||||||||function|items|var|conf|return|cf_e|true|itms|false|visible|auto|else|width|total|case|length|trigger|visibleConf|scrl|button|first|is_number|css||bind|tt0|children|prev||next|break|debug|slice|anims|pagination|push|variable|height|progress|stopPropagation|call|padding|for|is_boolean|this|left|wrp|is_function|is_string|data|swipe|fn|filter|tmrs|carouFredSel|fade|_onafter|_moveitems|is_undefined|container|align|_s_paddingold|_s_paddingcur|opacity|switch|play|Math|cover|_position|scroll|extend|duration|eq|_a_wrapper|triggerHandler|mousewheel|usePadding|marginRight|is_object|circular|fx|each|max|sz_resetMargin|i_cur_l|old|i_old_l|uncover|unbind||cookie|isScrolling|isPaused|number|a_cfs|_cfs_origCssMargin|clbk|adjust|isStopped|stopImmediatePropagation|is|queu|while|i_new|w_siz|nr|direction|avail_primary|synchronise|getTime|Not|bar|i_new_l|a_cur|remove|easing|is_jquery|outerWidth|cf_getItemsAdjust|cf_c|ceil|object|pR|_s_paddingnew|preventDefault|a_itm|pauseOnHover|options|responsive|100|default|timeoutDuration|startTime|string|removeClass|queue|last|i_skp|ms_getTotalSize|a_old|a_lef|a_dur|is_array|instanceof|typeof|key|transition|adj|opts_orig|gn_getVisibleItemsNext||min|right|parent||||addClass|pause|perc|boolean|cf_sortParams|scrolling|resume|onAfter|i_old|crossfade|slideTo|window|start|outerHeight|_cfs_triggerEvent|is_true|top|position|wrapper|hidden|sc_clearTimers|timePassed|Carousel|sc_startScroll|events|infinite|nv_enableNavi|i_siz|i_siz_vis|_a_paddingold|_a_paddingcur|get|onBefore|updatePageStatus|gi_getCurrentItems|gn_getItemIndex|anchorBuilder|event|sizesConf|bt_pauseOnHoverConfig|null|ns2|split|indexOf|go_getObject|serialNumber|maxDimension|is_percentage|gn_getVisibleItemsNextFilter|deprecated|orgCSS|zIndex||sz_storeOrigCss|none|sc_stopScroll|dur2|prefix|to|appendTo|sc_setScroll||sc_fireCallbacks|currentPage|end|before|Number|of|document|onTouch|onResize|hide|parseInt|floor|show|ms_getTrueLargestSize|selector|currentPosition|destroy|primarySizePercentage|ms_getPercentage|org|onTimeoutStart|onTimeoutPause|onTimeoutEnd|sz_storeMargin|stopped|pre|post|updater|minimum|gn_getVisibleItemsPrev|cf_getAdjust|onEnd|clone|cf_getAlignPadding|cf_mapWrapperSizes|ms_getSizes|a_wsz|a_new|not|a_cfs_vis|updateSizes|eval|sz_setSizes|pgs|deviation|nv_showNavi|sz_restoreOrigCss|mouseenter|mouseleave|pauseOnEvent|keys|throttle||di|go_getNaviObject|is_false|sz|element|starting_position|_cfs_isCarousel||_cfs_init|go_getPrevNextObject|defaults|up|ms_getParentSize|ms_getMaxDimension|center|in_getResponsiveValues|bottom|in_getAlignPadding|go_complementPrevNextObject|cf_getSynchArr|onPauseStart|onPausePause|onPauseEnd|pauseDuration|marginBottom|newPosition|sz_setResponsiveSizes|_cfs_unbind_events|finish|interval|type|conditions|gn_getVisibleOrg|backward|sc_hideHiddenItems|a_lef_vis|sc_getDuration|_a_paddingnew|sc_showHiddenItems|sc_mapCallbackArguments|sc_afterScroll|sc_fireQueue|cf_setCookie|gn_getVisibleItemsNextTestCircular|slideToPage|valid|linkAnchors|value|_cfs_bind_buttons|click|_cfs_unbind_buttons|scrolled|onMouse|swP|swN|delay|pauseOnResize|debounce|onWindowResize|_windowHeight|nh||ns3|continue|classnames|set|cf_getKeyCode|gn_getItemsPrevFilter||gn_getItemsNextFilter|seco|nw|ms_getLargestSize|toLowerCase|ms_hasVariableSizes|sta|cf_getItemAdjustMinMax|is_null|console|caroufredsel|No|found|go_getItemsObject|go_getScrollObject|go_getAutoObject|go_getPaginationObject|go_getSwipeObject|go_getMousewheelObject|cf_getDimensions|in_complementItems|in_complementPrimarySize|in_complementSecondarySize|upDateOnWindowResize|in_complementVisibleItems|cf_getPadding|500|go_complementAutoObject|go_complementPaginationObject|go_complementSwipeObject|go_complementMousewheelObject|_cfs_build|in_mapCss|textAlign|float|marginTop|marginLeft|absolute|_cfs_origCssZindex|_cfs_bind_events|stop|paused|enough|needed|page|slide_|configuration|gn_getScrollItemsPrevFilter|Scrolling|gi_getOldItemsPrev|gi_getNewItemsPrev|directscroll|concat|gn_getScrollItemsNextFilter|forward|gi_getOldItemsNext|gi_getNewItemsNext|jumpToStart|after|the|append|removeItem|round|hash|index|selected|gn_getVisibleItemsPrevFilter|Item|keyup|keyCode|scN|down|cursor|mcN|configs|classname|cf_getCookie|random|itm|onCreate|swing|namespace|pageAnchorBuilder|span|progressbarUpdater|new|Date|_cfs_isHidden|triggerOnTouchEnd|_cfs_tempCssMargin|_cfs_origCss|attr|style|newS|secp|ms_getPaddingBorderMargin|l1|l2|join|innerWidth|innerHeight|dx|Set|undefined|jQuery|log|caroufredsel_cookie_|relative|fixed|overflow|setInterval|setTimeout|or|Callback|returned|Page|resumed|currently|slide_prev|prependTo|slide_next|prevPage|nextPage|prepend|carousel|insertItem|Correct|insert|Appending|item|add|detach|currentVisible|body|find|Preventing|non|sliding|replaceWith|widths|heights|automatically|ontouchstart|in|swipeUp|swipeDown|swipeLeft|swipeRight|move|200|300|resize|wrap|class|animate|unshift|location|cfs|div|caroufredsel_wrapper|href|charAt|setTime|1000|expires|toGMTString|path|ease|orgDuration|shift|clearTimeout|clearInterval|skipped|Hiding|navigation|disabled|2500|Width|outer|px|em|even|odd|Infinity|immediate|bt_mousesheelNumber|Array|Object|isNaN|String|Function|Boolean|DEPRECATED|support|it|will|be|removed|Use|instead|quadratic|cubic|elastic|106|126".split("|"), 
0, {}));
jQuery.cookie = function(key, value, options) {
  if(arguments.length > 1 && String(value) !== "[object Object]") {
    options = jQuery.extend({}, options);
    if(value === null || value === undefined) {
      options.expires = -1
    }
    if(typeof options.expires === "number") {
      var days = options.expires, t = options.expires = new Date;
      t.setDate(t.getDate() + days)
    }
    value = String(value);
    return document.cookie = [encodeURIComponent(key), "=", options.raw ? value : encodeURIComponent(value), options.expires ? "; expires=" + options.expires.toUTCString() : "", options.path ? "; path=" + options.path : "", options.domain ? "; domain=" + options.domain : "", options.secure ? "; secure" : ""].join("")
  }
  options = value || {};
  var result, decode = options.raw ? function(s) {
    return s
  } : decodeURIComponent;
  return(result = (new RegExp("(?:^|; )" + encodeURIComponent(key) + "=([^;]*)")).exec(document.cookie)) ? decode(result[1]) : null
};
(function($) {
  var tmp, loading, overlay, wrap, outer, content, close, title, nav_left, nav_right, selectedIndex = 0, selectedOpts = {}, selectedArray = [], currentIndex = 0, currentOpts = {}, currentArray = [], ajaxLoader = null, imgPreloader = new Image, imgRegExp = /\.(jpg|gif|png|bmp|jpeg)(.*)?$/i, swfRegExp = /[^\.]\.(swf)\s*$/i, loadingTimer, loadingFrame = 1, titleHeight = 0, titleStr = "", start_pos, final_pos, busy = false, fx = $.extend($("<div/>")[0], {prop:0}), isIE6 = $.browser.msie && $.browser.version < 
  7 && !window.XMLHttpRequest, _abort = function() {
    loading.hide();
    imgPreloader.onerror = imgPreloader.onload = null;
    if(ajaxLoader) {
      ajaxLoader.abort()
    }
    tmp.empty()
  }, _error = function() {
    if(false === selectedOpts.onError(selectedArray, selectedIndex, selectedOpts)) {
      loading.hide();
      busy = false;
      return
    }
    selectedOpts.titleShow = false;
    selectedOpts.width = "auto";
    selectedOpts.height = "auto";
    tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');
    _process_inline()
  }, _start = function() {
    var obj = selectedArray[selectedIndex], href, type, title, str, emb, ret;
    _abort();
    selectedOpts = $.extend({}, $.fn.fancybox.defaults, typeof $(obj).data("fancybox") == "undefined" ? selectedOpts : $(obj).data("fancybox"));
    ret = selectedOpts.onStart(selectedArray, selectedIndex, selectedOpts);
    if(ret === false) {
      busy = false;
      return
    }else {
      if(typeof ret == "object") {
        selectedOpts = $.extend(selectedOpts, ret)
      }
    }
    title = selectedOpts.title || (obj.nodeName ? $(obj).attr("title") : obj.title) || "";
    if(obj.nodeName && !selectedOpts.orig) {
      selectedOpts.orig = $(obj).children("img:first").length ? $(obj).children("img:first") : $(obj)
    }
    if(title === "" && selectedOpts.orig && selectedOpts.titleFromAlt) {
      title = selectedOpts.orig.attr("alt")
    }
    href = selectedOpts.href || (obj.nodeName ? $(obj).attr("href") : obj.href) || null;
    if(/^(?:javascript)/i.test(href) || href == "#") {
      href = null
    }
    if(selectedOpts.type) {
      type = selectedOpts.type;
      if(!href) {
        href = selectedOpts.content
      }
    }else {
      if(selectedOpts.content) {
        type = "html"
      }else {
        if(href) {
          if(href.match(imgRegExp)) {
            type = "image"
          }else {
            if(href.match(swfRegExp)) {
              type = "swf"
            }else {
              if($(obj).hasClass("iframe")) {
                type = "iframe"
              }else {
                if(href.indexOf("#") === 0) {
                  type = "inline"
                }else {
                  type = "ajax"
                }
              }
            }
          }
        }
      }
    }
    if(!type) {
      _error();
      return
    }
    if(type == "inline") {
      obj = href.substr(href.indexOf("#"));
      type = $(obj).length > 0 ? "inline" : "ajax"
    }
    selectedOpts.type = type;
    selectedOpts.href = href;
    selectedOpts.title = title;
    if(selectedOpts.autoDimensions) {
      if(selectedOpts.type == "html" || selectedOpts.type == "inline" || selectedOpts.type == "ajax") {
        selectedOpts.width = "auto";
        selectedOpts.height = "auto"
      }else {
        selectedOpts.autoDimensions = false
      }
    }
    if(selectedOpts.modal) {
      selectedOpts.overlayShow = true;
      selectedOpts.hideOnOverlayClick = false;
      selectedOpts.hideOnContentClick = false;
      selectedOpts.enableEscapeButton = false;
      selectedOpts.showCloseButton = false
    }
    selectedOpts.padding = parseInt(selectedOpts.padding, 10);
    selectedOpts.margin = parseInt(selectedOpts.margin, 10);
    tmp.css("padding", selectedOpts.padding + selectedOpts.margin);
    $(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change", function() {
      $(this).replaceWith(content.children())
    });
    switch(type) {
      case "html":
        tmp.html(selectedOpts.content);
        _process_inline();
        break;
      case "inline":
        if($(obj).parent().is("#fancybox-content") === true) {
          busy = false;
          return
        }
        $('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup", function() {
          $(this).replaceWith(content.children())
        }).bind("fancybox-cancel", function() {
          $(this).replaceWith(tmp.children())
        });
        $(obj).appendTo(tmp);
        _process_inline();
        break;
      case "image":
        busy = false;
        $.fancybox.showActivity();
        imgPreloader = new Image;
        imgPreloader.onerror = function() {
          _error()
        };
        imgPreloader.onload = function() {
          busy = true;
          imgPreloader.onerror = imgPreloader.onload = null;
          _process_image()
        };
        imgPreloader.src = href;
        break;
      case "swf":
        selectedOpts.scrolling = "no";
        str = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"><param name="movie" value="' + href + '"></param>';
        emb = "";
        $.each(selectedOpts.swf, function(name, val) {
          str += '<param name="' + name + '" value="' + val + '"></param>';
          emb += " " + name + '="' + val + '"'
        });
        str += '<embed src="' + href + '" type="application/x-shockwave-flash" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"' + emb + "></embed></object>";
        tmp.html(str);
        _process_inline();
        break;
      case "ajax":
        busy = false;
        $.fancybox.showActivity();
        selectedOpts.ajax.win = selectedOpts.ajax.success;
        ajaxLoader = $.ajax($.extend({}, selectedOpts.ajax, {url:href, data:selectedOpts.ajax.data || {}, error:function(XMLHttpRequest, textStatus, errorThrown) {
          if(XMLHttpRequest.status > 0) {
            _error()
          }
        }, success:function(data, textStatus, XMLHttpRequest) {
          var o = typeof XMLHttpRequest == "object" ? XMLHttpRequest : ajaxLoader;
          if(o.status == 200) {
            if(typeof selectedOpts.ajax.win == "function") {
              ret = selectedOpts.ajax.win(href, data, textStatus, XMLHttpRequest);
              if(ret === false) {
                loading.hide();
                return
              }else {
                if(typeof ret == "string" || typeof ret == "object") {
                  data = ret
                }
              }
            }
            tmp.html(data);
            _process_inline()
          }
        }}));
        break;
      case "iframe":
        _show();
        break
    }
  }, _process_inline = function() {
    var w = selectedOpts.width, h = selectedOpts.height;
    if(w.toString().indexOf("%") > -1) {
      w = parseInt(($(window).width() - selectedOpts.margin * 2) * parseFloat(w) / 100, 10) + "px"
    }else {
      w = w == "auto" ? "auto" : w + "px"
    }
    if(h.toString().indexOf("%") > -1) {
      h = parseInt(($(window).height() - selectedOpts.margin * 2) * parseFloat(h) / 100, 10) + "px"
    }else {
      h = h == "auto" ? "auto" : h + "px"
    }
    tmp.wrapInner('<div style="width:' + w + ";height:" + h + ";overflow: " + (selectedOpts.scrolling == "auto" ? "auto" : selectedOpts.scrolling == "yes" ? "scroll" : "hidden") + ';position:relative;"></div>');
    selectedOpts.width = tmp.width();
    selectedOpts.height = tmp.height();
    _show()
  }, _process_image = function() {
    selectedOpts.width = imgPreloader.width;
    selectedOpts.height = imgPreloader.height;
    $("<img />").attr({"id":"fancybox-img", "src":imgPreloader.src, "alt":selectedOpts.title}).appendTo(tmp);
    _show()
  }, _show = function() {
    $(".joyride-close-tip").click();
    var pos, equal;
    loading.hide();
    if(wrap.is(":visible") && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
      $.event.trigger("fancybox-cancel");
      busy = false;
      return
    }
    busy = true;
    $(content.add(overlay)).unbind();
    $(window).unbind("resize.fb scroll.fb");
    $(document).unbind("keydown.fb");
    if(wrap.is(":visible") && currentOpts.titlePosition !== "outside") {
      wrap.css("height", wrap.height())
    }
    currentArray = selectedArray;
    currentIndex = selectedIndex;
    currentOpts = selectedOpts;
    if(currentOpts.overlayShow) {
      overlay.css({"background-color":currentOpts.overlayColor, "opacity":currentOpts.overlayOpacity, "cursor":currentOpts.hideOnOverlayClick ? "pointer" : "auto", "height":$(document).height()});
      if(!overlay.is(":visible")) {
        if(isIE6) {
          $("select:not(#fancybox-tmp select)").filter(function() {
            return this.style.visibility !== "hidden"
          }).css({"visibility":"hidden"}).one("fancybox-cleanup", function() {
            this.style.visibility = "inherit"
          })
        }
        overlay.show()
      }
    }else {
      overlay.hide()
    }
    final_pos = _get_zoom_to();
    _process_title();
    if(wrap.is(":visible")) {
      $(close.add(nav_left).add(nav_right)).hide();
      pos = wrap.position(), start_pos = {top:pos.top, left:pos.left, width:wrap.width(), height:wrap.height()};
      equal = start_pos.width == final_pos.width && start_pos.height == final_pos.height;
      content.fadeTo(currentOpts.changeFade, 0.3, function() {
        var finish_resizing = function() {
          content.html(tmp.contents()).fadeTo(currentOpts.changeFade, 1, _finish)
        };
        $.event.trigger("fancybox-change");
        content.empty().removeAttr("filter").css({"border-width":currentOpts.padding, "width":final_pos.width - currentOpts.padding * 2, "height":selectedOpts.autoDimensions ? "auto" : final_pos.height - titleHeight - currentOpts.padding * 2});
        if(equal) {
          finish_resizing()
        }else {
          fx.prop = 0;
          $(fx).animate({prop:1}, {duration:currentOpts.changeSpeed, easing:currentOpts.easingChange, step:_draw, complete:finish_resizing})
        }
      });
      return
    }
    wrap.removeAttr("style");
    content.css("border-width", currentOpts.padding);
    if(currentOpts.transitionIn == "elastic") {
      start_pos = _get_zoom_from();
      content.html(tmp.contents());
      wrap.show();
      if(currentOpts.opacity) {
        final_pos.opacity = 0
      }
      fx.prop = 0;
      $(fx).animate({prop:1}, {duration:currentOpts.speedIn, easing:currentOpts.easingIn, step:_draw, complete:_finish});
      return
    }
    if(currentOpts.titlePosition == "inside" && titleHeight > 0) {
      title.show()
    }
    content.css({"width":final_pos.width - currentOpts.padding * 2, "height":selectedOpts.autoDimensions ? "auto" : final_pos.height - titleHeight - currentOpts.padding * 2}).html(tmp.contents());
    wrap.css(final_pos).fadeIn(currentOpts.transitionIn == "none" ? 0 : currentOpts.speedIn, _finish)
  }, _format_title = function(title) {
    if(title && title.length) {
      if(currentOpts.titlePosition == "float") {
        return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">' + title + '</td><td id="fancybox-title-float-right"></td></tr></table>'
      }
      return'<div id="fancybox-title-' + currentOpts.titlePosition + '">' + title + "</div>"
    }
    return false
  }, _process_title = function() {
    titleStr = currentOpts.title || "";
    titleHeight = 0;
    title.empty().removeAttr("style").removeClass();
    if(currentOpts.titleShow === false) {
      title.hide();
      return
    }
    titleStr = $.isFunction(currentOpts.titleFormat) ? currentOpts.titleFormat(titleStr, currentArray, currentIndex, currentOpts) : _format_title(titleStr);
    if(!titleStr || titleStr === "") {
      title.hide();
      return
    }
    title.addClass("fancybox-title-" + currentOpts.titlePosition).html(titleStr).appendTo("body").show();
    switch(currentOpts.titlePosition) {
      case "inside":
        title.css({"width":final_pos.width - currentOpts.padding * 2, "marginLeft":currentOpts.padding, "marginRight":currentOpts.padding});
        titleHeight = title.outerHeight(true);
        title.appendTo(outer);
        final_pos.height += titleHeight;
        break;
      case "over":
        title.css({"marginLeft":currentOpts.padding, "width":final_pos.width - currentOpts.padding * 2, "bottom":currentOpts.padding}).appendTo(outer);
        break;
      case "float":
        title.css("left", parseInt((title.width() - final_pos.width - 40) / 2, 10) * -1).appendTo(wrap);
        break;
      default:
        title.css({"width":final_pos.width - currentOpts.padding * 2, "paddingLeft":currentOpts.padding, "paddingRight":currentOpts.padding}).appendTo(wrap);
        break
    }
    title.hide()
  }, _set_navigation = function() {
    if(currentOpts.enableEscapeButton || currentOpts.enableKeyboardNav) {
      $(document).bind("keydown.fb", function(e) {
        if(e.keyCode == 27 && currentOpts.enableEscapeButton) {
          e.preventDefault();
          $.fancybox.close()
        }else {
          if((e.keyCode == 37 || e.keyCode == 39) && currentOpts.enableKeyboardNav && e.target.tagName !== "INPUT" && e.target.tagName !== "TEXTAREA" && e.target.tagName !== "SELECT") {
            e.preventDefault();
            $.fancybox[e.keyCode == 37 ? "prev" : "next"]()
          }
        }
      })
    }
    if(!currentOpts.showNavArrows) {
      nav_left.hide();
      nav_right.hide();
      return
    }
    if(currentOpts.cyclic && currentArray.length > 1 || currentIndex !== 0) {
      nav_left.show()
    }
    if(currentOpts.cyclic && currentArray.length > 1 || currentIndex != currentArray.length - 1) {
      nav_right.show()
    }
  }, _finish = function() {
    if(!$.support.opacity) {
      content.get(0).style.removeAttribute("filter");
      wrap.get(0).style.removeAttribute("filter")
    }
    if(selectedOpts.autoDimensions) {
      content.css("height", "auto")
    }
    wrap.css("height", "auto");
    if(titleStr && titleStr.length) {
      title.show()
    }
    if(currentOpts.showCloseButton) {
      close.show()
    }
    _set_navigation();
    if(currentOpts.hideOnContentClick) {
      content.bind("click", $.fancybox.close)
    }
    if(currentOpts.hideOnOverlayClick) {
      overlay.bind("click", $.fancybox.close)
    }
    $(window).bind("resize.fb", $.fancybox.resize);
    if(currentOpts.centerOnScroll) {
      $(window).bind("scroll.fb", $.fancybox.center)
    }
    if(currentOpts.type == "iframe") {
      $('<iframe id="fancybox-frame" name="fancybox-frame' + (new Date).getTime() + '" frameborder="0" hspace="0" ' + ($.browser.msie ? 'allowtransparency="true""' : "") + ' scrolling="' + selectedOpts.scrolling + '" src="' + currentOpts.href + '"></iframe>').appendTo(content)
    }
    wrap.show();
    busy = false;
    $.fancybox.center();
    currentOpts.onComplete(currentArray, currentIndex, currentOpts);
    _preload_images()
  }, _preload_images = function() {
    var href, objNext;
    if(currentArray.length - 1 > currentIndex) {
      href = currentArray[currentIndex + 1].href;
      if(typeof href !== "undefined" && href.match(imgRegExp)) {
        objNext = new Image;
        objNext.src = href
      }
    }
    if(currentIndex > 0) {
      href = currentArray[currentIndex - 1].href;
      if(typeof href !== "undefined" && href.match(imgRegExp)) {
        objNext = new Image;
        objNext.src = href
      }
    }
  }, _draw = function(pos) {
    var dim = {width:parseInt(start_pos.width + (final_pos.width - start_pos.width) * pos, 10), height:parseInt(start_pos.height + (final_pos.height - start_pos.height) * pos, 10), top:parseInt(start_pos.top + (final_pos.top - start_pos.top) * pos, 10), left:parseInt(start_pos.left + (final_pos.left - start_pos.left) * pos, 10)};
    if(typeof final_pos.opacity !== "undefined") {
      dim.opacity = pos < 0.5 ? 0.5 : pos
    }
    wrap.css(dim);
    content.css({"width":dim.width - currentOpts.padding * 2, "height":dim.height - titleHeight * pos - currentOpts.padding * 2})
  }, _get_viewport = function() {
    return[$(window).width() - currentOpts.margin * 2, $(window).height() - currentOpts.margin * 2, $(document).scrollLeft() + currentOpts.margin, $(document).scrollTop() + currentOpts.margin]
  }, _get_zoom_to = function() {
    var view = _get_viewport(), to = {}, resize = currentOpts.autoScale, double_padding = currentOpts.padding * 2, ratio;
    if(currentOpts.width.toString().indexOf("%") > -1) {
      to.width = parseInt(view[0] * parseFloat(currentOpts.width) / 100, 10)
    }else {
      to.width = currentOpts.width + double_padding
    }
    if(currentOpts.height.toString().indexOf("%") > -1) {
      to.height = parseInt(view[1] * parseFloat(currentOpts.height) / 100, 10)
    }else {
      to.height = currentOpts.height + double_padding
    }
    if(resize && (to.width > view[0] || to.height > view[1])) {
      if(selectedOpts.type == "image" || selectedOpts.type == "swf") {
        ratio = currentOpts.width / currentOpts.height;
        if(to.width > view[0]) {
          to.width = view[0];
          to.height = parseInt((to.width - double_padding) / ratio + double_padding, 10)
        }
        if(to.height > view[1]) {
          to.height = view[1];
          to.width = parseInt((to.height - double_padding) * ratio + double_padding, 10)
        }
      }else {
        to.width = Math.min(to.width, view[0]);
        to.height = Math.min(to.height, view[1])
      }
    }
    to.top = parseInt(Math.max(view[3] - 20, view[3] + (view[1] - to.height - 40) * 0.5), 10);
    to.left = parseInt(Math.max(view[2] - 20, view[2] + (view[0] - to.width - 40) * 0.5), 10);
    return to
  }, _get_obj_pos = function(obj) {
    var pos = obj.offset();
    pos.top += parseInt(obj.css("paddingTop"), 10) || 0;
    pos.left += parseInt(obj.css("paddingLeft"), 10) || 0;
    pos.top += parseInt(obj.css("border-top-width"), 10) || 0;
    pos.left += parseInt(obj.css("border-left-width"), 10) || 0;
    pos.width = obj.width();
    pos.height = obj.height();
    return pos
  }, _get_zoom_from = function() {
    var orig = selectedOpts.orig ? $(selectedOpts.orig) : false, from = {}, pos, view;
    if(orig && orig.length) {
      pos = _get_obj_pos(orig);
      from = {width:pos.width + currentOpts.padding * 2, height:pos.height + currentOpts.padding * 2, top:pos.top - currentOpts.padding - 20, left:pos.left - currentOpts.padding - 20}
    }else {
      view = _get_viewport();
      from = {width:currentOpts.padding * 2, height:currentOpts.padding * 2, top:parseInt(view[3] + view[1] * 0.5, 10), left:parseInt(view[2] + view[0] * 0.5, 10)}
    }
    return from
  }, _animate_loading = function() {
    if(!loading.is(":visible")) {
      clearInterval(loadingTimer);
      return
    }
    $("div", loading).css("top", loadingFrame * -40 + "px");
    loadingFrame = (loadingFrame + 1) % 12
  };
  $.fn.fancybox = function(options) {
    if(!$(this).length) {
      return this
    }
    $(this).data("fancybox", $.extend({}, options, $.metadata ? $(this).metadata() : {})).unbind("click.fb").bind("click.fb", function(e) {
      e.preventDefault();
      if(busy) {
        return
      }
      busy = true;
      $(this).blur();
      selectedArray = [];
      selectedIndex = 0;
      var rel = $(this).attr("rel") || "";
      if(!rel || rel == "" || rel === "nofollow") {
        selectedArray.push(this)
      }else {
        selectedArray = $("a[rel=" + rel + "], area[rel=" + rel + "]");
        selectedIndex = selectedArray.index(this)
      }
      _start();
      return
    });
    return this
  };
  $.fancybox = function(obj) {
    var opts;
    if(busy) {
      return
    }
    busy = true;
    opts = typeof arguments[1] !== "undefined" ? arguments[1] : {};
    selectedArray = [];
    selectedIndex = parseInt(opts.index, 10) || 0;
    if($.isArray(obj)) {
      for(var i = 0, j = obj.length;i < j;i++) {
        if(typeof obj[i] == "object") {
          $(obj[i]).data("fancybox", $.extend({}, opts, obj[i]))
        }else {
          obj[i] = $({}).data("fancybox", $.extend({content:obj[i]}, opts))
        }
      }
      selectedArray = jQuery.merge(selectedArray, obj)
    }else {
      if(typeof obj == "object") {
        $(obj).data("fancybox", $.extend({}, opts, obj))
      }else {
        obj = $({}).data("fancybox", $.extend({content:obj}, opts))
      }
      selectedArray.push(obj)
    }
    if(selectedIndex > selectedArray.length || selectedIndex < 0) {
      selectedIndex = 0
    }
    _start()
  };
  $.fancybox.showActivity = function() {
    clearInterval(loadingTimer);
    loading.show();
    loadingTimer = setInterval(_animate_loading, 66)
  };
  $.fancybox.hideActivity = function() {
    loading.hide()
  };
  $.fancybox.next = function() {
    return $.fancybox.pos(currentIndex + 1)
  };
  $.fancybox.prev = function() {
    return $.fancybox.pos(currentIndex - 1)
  };
  $.fancybox.pos = function(pos) {
    if(busy) {
      return
    }
    pos = parseInt(pos);
    selectedArray = currentArray;
    if(pos > -1 && pos < currentArray.length) {
      selectedIndex = pos;
      _start()
    }else {
      if(currentOpts.cyclic && currentArray.length > 1) {
        selectedIndex = pos >= currentArray.length ? 0 : currentArray.length - 1;
        _start()
      }
    }
    return
  };
  $.fancybox.cancel = function() {
    if(busy) {
      return
    }
    busy = true;
    $.event.trigger("fancybox-cancel");
    _abort();
    selectedOpts.onCancel(selectedArray, selectedIndex, selectedOpts);
    busy = false
  };
  $.fancybox.close = function() {
    $(".joyride-close-tip").click();
    if(busy || wrap.is(":hidden")) {
      return
    }
    busy = true;
    if(currentOpts && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
      busy = false;
      return
    }
    _abort();
    $(close.add(nav_left).add(nav_right)).hide();
    $(content.add(overlay)).unbind();
    $(window).unbind("resize.fb scroll.fb");
    $(document).unbind("keydown.fb");
    content.find("iframe").attr("src", isIE6 && /^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank");
    if(currentOpts.titlePosition !== "inside") {
      title.empty()
    }
    wrap.stop();
    function _cleanup() {
      overlay.fadeOut("fast");
      title.empty().hide();
      wrap.hide();
      $.event.trigger("fancybox-cleanup");
      content.empty();
      currentOpts.onClosed(currentArray, currentIndex, currentOpts);
      currentArray = selectedOpts = [];
      currentIndex = selectedIndex = 0;
      currentOpts = selectedOpts = {};
      busy = false
    }
    if(currentOpts.transitionOut == "elastic") {
      start_pos = _get_zoom_from();
      var pos = wrap.position();
      final_pos = {top:pos.top, left:pos.left, width:wrap.width(), height:wrap.height()};
      if(currentOpts.opacity) {
        final_pos.opacity = 1
      }
      title.empty().hide();
      fx.prop = 1;
      $(fx).animate({prop:0}, {duration:currentOpts.speedOut, easing:currentOpts.easingOut, step:_draw, complete:_cleanup})
    }else {
      wrap.fadeOut(currentOpts.transitionOut == "none" ? 0 : currentOpts.speedOut, _cleanup)
    }
  };
  $.fancybox.resize = function() {
    if(overlay.is(":visible")) {
      overlay.css("height", $(document).height())
    }
    $.fancybox.center(true)
  };
  $.fancybox.center = function() {
    var view, align;
    if(busy) {
      return
    }
    align = arguments[0] === true ? 1 : 0;
    view = _get_viewport();
    if(!align && (wrap.width() > view[0] || wrap.height() > view[1])) {
      return
    }
    wrap.stop().animate({"top":parseInt(Math.max(view[3] - 20, view[3] + (view[1] - content.height() - 40) * 0.5 - currentOpts.padding)), "left":parseInt(Math.max(view[2] - 20, view[2] + (view[0] - content.width() - 40) * 0.5 - currentOpts.padding))}, typeof arguments[0] == "number" ? arguments[0] : 200)
  };
  $.fancybox.init = function() {
    if($("#fancybox-wrap").length) {
      return
    }
    $("body").append(tmp = $('<div id="fancybox-tmp"></div>'), loading = $('<div id="fancybox-loading"><div></div></div>'), overlay = $('<div id="fancybox-overlay"></div>'), wrap = $('<div id="fancybox-wrap"></div>'));
    outer = $('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);
    outer.append(content = $('<div id="fancybox-content"></div>'), close = $('<a id="fancybox-close"></a>'), title = $('<div id="fancybox-title"></div>'), nav_left = $('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'), nav_right = $('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));
    close.click($.fancybox.close);
    loading.click($.fancybox.cancel);
    nav_left.click(function(e) {
      e.preventDefault();
      $.fancybox.prev()
    });
    nav_right.click(function(e) {
      e.preventDefault();
      $.fancybox.next()
    });
    if($.fn.mousewheel) {
      wrap.bind("mousewheel.fb", function(e, delta) {
        if(busy) {
          e.preventDefault()
        }else {
          if($(e.target).get(0).clientHeight == 0 || $(e.target).get(0).scrollHeight === $(e.target).get(0).clientHeight) {
            e.preventDefault();
            $.fancybox[delta > 0 ? "prev" : "next"]()
          }
        }
      })
    }
    if(!$.support.opacity) {
      wrap.addClass("fancybox-ie")
    }
    if(isIE6) {
      loading.addClass("fancybox-ie6");
      wrap.addClass("fancybox-ie6");
      $('<iframe id="fancybox-hide-sel-frame" src="' + (/^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank") + '" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)
    }
  };
  $.fn.fancybox.defaults = {padding:10, margin:40, opacity:false, modal:false, cyclic:false, scrolling:"auto", width:560, height:340, autoScale:true, autoDimensions:true, centerOnScroll:false, ajax:{}, swf:{wmode:"transparent"}, hideOnOverlayClick:true, hideOnContentClick:false, overlayShow:true, overlayOpacity:0.7, overlayColor:"#777", titleShow:true, titlePosition:"float", titleFormat:null, titleFromAlt:false, transitionIn:"fade", transitionOut:"fade", speedIn:300, speedOut:300, changeSpeed:300, 
  changeFade:"fast", easingIn:"swing", easingOut:"swing", showCloseButton:true, showNavArrows:true, enableEscapeButton:true, enableKeyboardNav:true, onStart:function() {
  }, onCancel:function() {
  }, onComplete:function() {
  }, onCleanup:function() {
  }, onClosed:function() {
  }, onError:function() {
  }};
  $(document).ready(function() {
    $.fancybox.init()
  })
})(jQuery);
(function($) {
  var feature = {};
  feature.fileapi = $("<input type='file'/>").get(0).files !== undefined;
  feature.formdata = window.FormData !== undefined;
  $.fn.ajaxSubmit = function(options) {
    if(!this.length) {
      log("ajaxSubmit: skipping submit process - no element selected");
      return this
    }
    var method, action, url, $form = this;
    if(typeof options == "function") {
      options = {success:options}
    }
    method = this.attr("method");
    action = this.attr("action");
    url = typeof action === "string" ? $.trim(action) : "";
    url = url || window.location.href || "";
    if(url) {
      url = (url.match(/^([^#]+)/) || [])[1]
    }
    options = $.extend(true, {url:url, success:$.ajaxSettings.success, type:method || "GET", iframeSrc:/^https/i.test(window.location.href || "") ? "javascript:false" : "about:blank"}, options);
    var veto = {};
    this.trigger("form-pre-serialize", [this, options, veto]);
    if(veto.veto) {
      log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");
      return this
    }
    if(options.beforeSerialize && options.beforeSerialize(this, options) === false) {
      log("ajaxSubmit: submit aborted via beforeSerialize callback");
      return this
    }
    var traditional = options.traditional;
    if(traditional === undefined) {
      traditional = $.ajaxSettings.traditional
    }
    var elements = [];
    var qx, a = this.formToArray(options.semantic, elements);
    if(options.data) {
      options.extraData = options.data;
      qx = $.param(options.data, traditional)
    }
    if(options.beforeSubmit && options.beforeSubmit(a, this, options) === false) {
      log("ajaxSubmit: submit aborted via beforeSubmit callback");
      return this
    }
    this.trigger("form-submit-validate", [a, this, options, veto]);
    if(veto.veto) {
      log("ajaxSubmit: submit vetoed via form-submit-validate trigger");
      return this
    }
    var q = $.param(a, traditional);
    if(qx) {
      q = q ? q + "&" + qx : qx
    }
    if(options.type.toUpperCase() == "GET") {
      options.url += (options.url.indexOf("?") >= 0 ? "&" : "?") + q;
      options.data = null
    }else {
      options.data = q
    }
    var callbacks = [];
    if(options.resetForm) {
      callbacks.push(function() {
        $form.resetForm()
      })
    }
    if(options.clearForm) {
      callbacks.push(function() {
        $form.clearForm(options.includeHidden)
      })
    }
    if(!options.dataType && options.target) {
      var oldSuccess = options.success || function() {
      };
      callbacks.push(function(data) {
        var fn = options.replaceTarget ? "replaceWith" : "html";
        $(options.target)[fn](data).each(oldSuccess, arguments)
      })
    }else {
      if(options.success) {
        callbacks.push(options.success)
      }
    }
    options.success = function(data, status, xhr) {
      var context = options.context || options;
      for(var i = 0, max = callbacks.length;i < max;i++) {
        callbacks[i].apply(context, [data, status, xhr || $form, $form])
      }
    };
    var fileInputs = $("input:file:enabled[value]", this);
    var hasFileInputs = fileInputs.length > 0;
    var mp = "multipart/form-data";
    var multipart = $form.attr("enctype") == mp || $form.attr("encoding") == mp;
    var fileAPI = feature.fileapi && feature.formdata;
    log("fileAPI :" + fileAPI);
    var shouldUseFrame = (hasFileInputs || multipart) && !fileAPI;
    if(options.iframe !== false && (options.iframe || shouldUseFrame)) {
      if(options.closeKeepAlive) {
        $.get(options.closeKeepAlive, function() {
          fileUploadIframe(a)
        })
      }else {
        fileUploadIframe(a)
      }
    }else {
      if((hasFileInputs || multipart) && fileAPI) {
        fileUploadXhr(a)
      }else {
        $.ajax(options)
      }
    }
    for(var k = 0;k < elements.length;k++) {
      elements[k] = null
    }
    this.trigger("form-submit-notify", [this, options]);
    return this;
    function fileUploadXhr(a) {
      var formdata = new FormData;
      for(var i = 0;i < a.length;i++) {
        formdata.append(a[i].name, a[i].value)
      }
      if(options.extraData) {
        for(var p in options.extraData) {
          if(options.extraData.hasOwnProperty(p)) {
            formdata.append(p, options.extraData[p])
          }
        }
      }
      options.data = null;
      var s = $.extend(true, {}, $.ajaxSettings, options, {contentType:false, processData:false, cache:false, type:"POST"});
      if(options.uploadProgress) {
        s.xhr = function() {
          var xhr = jQuery.ajaxSettings.xhr();
          if(xhr.upload) {
            xhr.upload.onprogress = function(event) {
              var percent = 0;
              var position = event.loaded || event.position;
              var total = event.total;
              if(event.lengthComputable) {
                percent = Math.ceil(position / total * 100)
              }
              options.uploadProgress(event, position, total, percent)
            }
          }
          return xhr
        }
      }
      s.data = null;
      var beforeSend = s.beforeSend;
      s.beforeSend = function(xhr, o) {
        o.data = formdata;
        if(beforeSend) {
          beforeSend.call(o, xhr, options)
        }
      };
      $.ajax(s)
    }
    function fileUploadIframe(a) {
      var form = $form[0], el, i, s, g, id, $io, io, xhr, sub, n, timedOut, timeoutHandle;
      var useProp = !!$.fn.prop;
      if($(":input[name=submit],:input[id=submit]", form).length) {
        return
      }
      if(a) {
        for(i = 0;i < elements.length;i++) {
          el = $(elements[i]);
          if(useProp) {
            el.prop("disabled", false)
          }else {
            el.removeAttr("disabled")
          }
        }
      }
      s = $.extend(true, {}, $.ajaxSettings, options);
      s.context = s.context || s;
      id = "jqFormIO" + (new Date).getTime();
      if(s.iframeTarget) {
        $io = $(s.iframeTarget);
        n = $io.attr("name");
        if(!n) {
          $io.attr("name", id)
        }else {
          id = n
        }
      }else {
        $io = $('<iframe name="' + id + '" src="' + s.iframeSrc + '" />');
        $io.css({position:"absolute", top:"-1000px", left:"-1000px"})
      }
      io = $io[0];
      xhr = {aborted:0, responseText:null, responseXML:null, status:0, statusText:"n/a", getAllResponseHeaders:function() {
      }, getResponseHeader:function() {
      }, setRequestHeader:function() {
      }, abort:function(status) {
        var e = status === "timeout" ? "timeout" : "aborted";
        log("aborting upload... " + e);
        this.aborted = 1;
        $io.attr("src", s.iframeSrc);
        xhr.error = e;
        if(s.error) {
          s.error.call(s.context, xhr, e, status)
        }
        if(g) {
          $.event.trigger("ajaxError", [xhr, s, e])
        }
        if(s.complete) {
          s.complete.call(s.context, xhr, e)
        }
      }};
      g = s.global;
      if(g && 0 === $.active++) {
        $.event.trigger("ajaxStart")
      }
      if(g) {
        $.event.trigger("ajaxSend", [xhr, s])
      }
      if(s.beforeSend && s.beforeSend.call(s.context, xhr, s) === false) {
        if(s.global) {
          $.active--
        }
        return
      }
      if(xhr.aborted) {
        return
      }
      sub = form.clk;
      if(sub) {
        n = sub.name;
        if(n && !sub.disabled) {
          s.extraData = s.extraData || {};
          s.extraData[n] = sub.value;
          if(sub.type == "image") {
            s.extraData[n + ".x"] = form.clk_x;
            s.extraData[n + ".y"] = form.clk_y
          }
        }
      }
      var CLIENT_TIMEOUT_ABORT = 1;
      var SERVER_ABORT = 2;
      function getDoc(frame) {
        var doc = frame.contentWindow ? frame.contentWindow.document : frame.contentDocument ? frame.contentDocument : frame.document;
        return doc
      }
      var csrf_token = $("meta[name=csrf-token]").attr("content");
      var csrf_param = $("meta[name=csrf-param]").attr("content");
      if(csrf_param && csrf_token) {
        s.extraData = s.extraData || {};
        s.extraData[csrf_param] = csrf_token
      }
      function doSubmit() {
        var t = $form.attr("target"), a = $form.attr("action");
        form.setAttribute("target", id);
        if(!method) {
          form.setAttribute("method", "POST")
        }
        if(a != s.url) {
          form.setAttribute("action", s.url)
        }
        if(!s.skipEncodingOverride && (!method || /post/i.test(method))) {
          $form.attr({encoding:"multipart/form-data", enctype:"multipart/form-data"})
        }
        if(s.timeout) {
          timeoutHandle = setTimeout(function() {
            timedOut = true;
            cb(CLIENT_TIMEOUT_ABORT)
          }, s.timeout)
        }
        function checkState() {
          try {
            var state = getDoc(io).readyState;
            log("state = " + state);
            if(state && state.toLowerCase() == "uninitialized") {
              setTimeout(checkState, 50)
            }
          }catch(e) {
            log("Server abort: ", e, " (", e.name, ")");
            cb(SERVER_ABORT);
            if(timeoutHandle) {
              clearTimeout(timeoutHandle)
            }
            timeoutHandle = undefined
          }
        }
        var extraInputs = [];
        try {
          if(s.extraData) {
            for(var n in s.extraData) {
              if(s.extraData.hasOwnProperty(n)) {
                extraInputs.push($('<input type="hidden" name="' + n + '">').attr("value", s.extraData[n]).appendTo(form)[0])
              }
            }
          }
          if(!s.iframeTarget) {
            $io.appendTo("body");
            if(io.attachEvent) {
              io.attachEvent("onload", cb)
            }else {
              io.addEventListener("load", cb, false)
            }
          }
          setTimeout(checkState, 15);
          form.submit()
        }finally {
          form.setAttribute("action", a);
          if(t) {
            form.setAttribute("target", t)
          }else {
            $form.removeAttr("target")
          }
          $(extraInputs).remove()
        }
      }
      if(s.forceSync) {
        doSubmit()
      }else {
        setTimeout(doSubmit, 10)
      }
      var data, doc, domCheckCount = 50, callbackProcessed;
      function cb(e) {
        if(xhr.aborted || callbackProcessed) {
          return
        }
        try {
          doc = getDoc(io)
        }catch(ex) {
          log("cannot access response document: ", ex);
          e = SERVER_ABORT
        }
        if(e === CLIENT_TIMEOUT_ABORT && xhr) {
          xhr.abort("timeout");
          return
        }else {
          if(e == SERVER_ABORT && xhr) {
            xhr.abort("server abort");
            return
          }
        }
        if(!doc || doc.location.href == s.iframeSrc) {
          if(!timedOut) {
            return
          }
        }
        if(io.detachEvent) {
          io.detachEvent("onload", cb)
        }else {
          io.removeEventListener("load", cb, false)
        }
        var status = "success", errMsg;
        try {
          if(timedOut) {
            throw"timeout";
          }
          var isXml = s.dataType == "xml" || doc.XMLDocument || $.isXMLDoc(doc);
          log("isXml=" + isXml);
          if(!isXml && window.opera && (doc.body === null || !doc.body.innerHTML)) {
            if(--domCheckCount) {
              log("requeing onLoad callback, DOM not available");
              setTimeout(cb, 250);
              return
            }
          }
          var docRoot = doc.body ? doc.body : doc.documentElement;
          xhr.responseText = docRoot ? docRoot.innerHTML : null;
          xhr.responseXML = doc.XMLDocument ? doc.XMLDocument : doc;
          if(isXml) {
            s.dataType = "xml"
          }
          xhr.getResponseHeader = function(header) {
            var headers = {"content-type":s.dataType};
            return headers[header]
          };
          if(docRoot) {
            xhr.status = Number(docRoot.getAttribute("status")) || xhr.status;
            xhr.statusText = docRoot.getAttribute("statusText") || xhr.statusText
          }
          var dt = (s.dataType || "").toLowerCase();
          var scr = /(json|script|text)/.test(dt);
          if(scr || s.textarea) {
            var ta = doc.getElementsByTagName("textarea")[0];
            if(ta) {
              xhr.responseText = ta.value;
              xhr.status = Number(ta.getAttribute("status")) || xhr.status;
              xhr.statusText = ta.getAttribute("statusText") || xhr.statusText
            }else {
              if(scr) {
                var pre = doc.getElementsByTagName("pre")[0];
                var b = doc.getElementsByTagName("body")[0];
                if(pre) {
                  xhr.responseText = pre.textContent ? pre.textContent : pre.innerText
                }else {
                  if(b) {
                    xhr.responseText = b.textContent ? b.textContent : b.innerText
                  }
                }
              }
            }
          }else {
            if(dt == "xml" && !xhr.responseXML && xhr.responseText) {
              xhr.responseXML = toXml(xhr.responseText)
            }
          }
          try {
            data = httpData(xhr, dt, s)
          }catch(e) {
            status = "parsererror";
            xhr.error = errMsg = e || status
          }
        }catch(e) {
          log("error caught: ", e);
          status = "error";
          xhr.error = errMsg = e || status
        }
        if(xhr.aborted) {
          log("upload aborted");
          status = null
        }
        if(xhr.status) {
          status = xhr.status >= 200 && xhr.status < 300 || xhr.status === 304 ? "success" : "error"
        }
        if(status === "success") {
          if(s.success) {
            s.success.call(s.context, data, "success", xhr)
          }
          if(g) {
            $.event.trigger("ajaxSuccess", [xhr, s])
          }
        }else {
          if(status) {
            if(errMsg === undefined) {
              errMsg = xhr.statusText
            }
            if(s.error) {
              s.error.call(s.context, xhr, status, errMsg)
            }
            if(g) {
              $.event.trigger("ajaxError", [xhr, s, errMsg])
            }
          }
        }
        if(g) {
          $.event.trigger("ajaxComplete", [xhr, s])
        }
        if(g && !--$.active) {
          $.event.trigger("ajaxStop")
        }
        if(s.complete) {
          s.complete.call(s.context, xhr, status)
        }
        callbackProcessed = true;
        if(s.timeout) {
          clearTimeout(timeoutHandle)
        }
        setTimeout(function() {
          if(!s.iframeTarget) {
            $io.remove()
          }
          xhr.responseXML = null
        }, 100)
      }
      var toXml = $.parseXML || function(s, doc) {
        if(window.ActiveXObject) {
          doc = new ActiveXObject("Microsoft.XMLDOM");
          doc.async = "false";
          doc.loadXML(s)
        }else {
          doc = (new DOMParser).parseFromString(s, "text/xml")
        }
        return doc && doc.documentElement && doc.documentElement.nodeName != "parsererror" ? doc : null
      };
      var parseJSON = $.parseJSON || function(s) {
        return window["eval"]("(" + s + ")")
      };
      var httpData = function(xhr, type, s) {
        var ct = xhr.getResponseHeader("content-type") || "", xml = type === "xml" || !type && ct.indexOf("xml") >= 0, data = xml ? xhr.responseXML : xhr.responseText;
        if(xml && data.documentElement.nodeName === "parsererror") {
          if($.error) {
            $.error("parsererror")
          }
        }
        if(s && s.dataFilter) {
          data = s.dataFilter(data, type)
        }
        if(typeof data === "string") {
          if(type === "json" || !type && ct.indexOf("json") >= 0) {
            data = parseJSON(data)
          }else {
            if(type === "script" || !type && ct.indexOf("javascript") >= 0) {
              $.globalEval(data)
            }
          }
        }
        return data
      }
    }
  };
  $.fn.ajaxForm = function(options) {
    options = options || {};
    options.delegation = options.delegation && $.isFunction($.fn.on);
    if(!options.delegation && this.length === 0) {
      var o = {s:this.selector, c:this.context};
      if(!$.isReady && o.s) {
        log("DOM not ready, queuing ajaxForm");
        $(function() {
          $(o.s, o.c).ajaxForm(options)
        });
        return this
      }
      log("terminating; zero elements found by selector" + ($.isReady ? "" : " (DOM not ready)"));
      return this
    }
    if(options.delegation) {
      $(document).off("submit.form-plugin", this.selector, doAjaxSubmit).off("click.form-plugin", this.selector, captureSubmittingElement).on("submit.form-plugin", this.selector, options, doAjaxSubmit).on("click.form-plugin", this.selector, options, captureSubmittingElement);
      return this
    }
    return this.ajaxFormUnbind().bind("submit.form-plugin", options, doAjaxSubmit).bind("click.form-plugin", options, captureSubmittingElement)
  };
  function doAjaxSubmit(e) {
    var options = e.data;
    if(!e.isDefaultPrevented()) {
      e.preventDefault();
      $(this).ajaxSubmit(options)
    }
  }
  function captureSubmittingElement(e) {
    var target = e.target;
    var $el = $(target);
    if(!$el.is(":submit,input:image")) {
      var t = $el.closest(":submit");
      if(t.length === 0) {
        return
      }
      target = t[0]
    }
    var form = this;
    form.clk = target;
    if(target.type == "image") {
      if(e.offsetX !== undefined) {
        form.clk_x = e.offsetX;
        form.clk_y = e.offsetY
      }else {
        if(typeof $.fn.offset == "function") {
          var offset = $el.offset();
          form.clk_x = e.pageX - offset.left;
          form.clk_y = e.pageY - offset.top
        }else {
          form.clk_x = e.pageX - target.offsetLeft;
          form.clk_y = e.pageY - target.offsetTop
        }
      }
    }
    setTimeout(function() {
      form.clk = form.clk_x = form.clk_y = null
    }, 100)
  }
  $.fn.ajaxFormUnbind = function() {
    return this.unbind("submit.form-plugin click.form-plugin")
  };
  $.fn.formToArray = function(semantic, elements) {
    var a = [];
    if(this.length === 0) {
      return a
    }
    var form = this[0];
    var els = semantic ? form.getElementsByTagName("*") : form.elements;
    if(!els) {
      return a
    }
    var i, j, n, v, el, max, jmax;
    for(i = 0, max = els.length;i < max;i++) {
      el = els[i];
      n = el.name;
      if(!n) {
        continue
      }
      if(semantic && form.clk && el.type == "image") {
        if(!el.disabled && form.clk == el) {
          a.push({name:n, value:$(el).val(), type:el.type});
          a.push({name:n + ".x", value:form.clk_x}, {name:n + ".y", value:form.clk_y})
        }
        continue
      }
      v = $.fieldValue(el, true);
      if(v && v.constructor == Array) {
        if(elements) {
          elements.push(el)
        }
        for(j = 0, jmax = v.length;j < jmax;j++) {
          a.push({name:n, value:v[j]})
        }
      }else {
        if(feature.fileapi && el.type == "file" && !el.disabled) {
          if(elements) {
            elements.push(el)
          }
          var files = el.files;
          if(files.length) {
            for(j = 0;j < files.length;j++) {
              a.push({name:n, value:files[j], type:el.type})
            }
          }else {
            a.push({name:n, value:"", type:el.type})
          }
        }else {
          if(v !== null && typeof v != "undefined") {
            if(elements) {
              elements.push(el)
            }
            a.push({name:n, value:v, type:el.type, required:el.required})
          }
        }
      }
    }
    if(!semantic && form.clk) {
      var $input = $(form.clk), input = $input[0];
      n = input.name;
      if(n && !input.disabled && input.type == "image") {
        a.push({name:n, value:$input.val()});
        a.push({name:n + ".x", value:form.clk_x}, {name:n + ".y", value:form.clk_y})
      }
    }
    return a
  };
  $.fn.formSerialize = function(semantic) {
    return $.param(this.formToArray(semantic))
  };
  $.fn.fieldSerialize = function(successful) {
    var a = [];
    this.each(function() {
      var n = this.name;
      if(!n) {
        return
      }
      var v = $.fieldValue(this, successful);
      if(v && v.constructor == Array) {
        for(var i = 0, max = v.length;i < max;i++) {
          a.push({name:n, value:v[i]})
        }
      }else {
        if(v !== null && typeof v != "undefined") {
          a.push({name:this.name, value:v})
        }
      }
    });
    return $.param(a)
  };
  $.fn.fieldValue = function(successful) {
    for(var val = [], i = 0, max = this.length;i < max;i++) {
      var el = this[i];
      var v = $.fieldValue(el, successful);
      if(v === null || typeof v == "undefined" || v.constructor == Array && !v.length) {
        continue
      }
      if(v.constructor == Array) {
        $.merge(val, v)
      }else {
        val.push(v)
      }
    }
    return val
  };
  $.fieldValue = function(el, successful) {
    var n = el.name, t = el.type, tag = el.tagName.toLowerCase();
    if(successful === undefined) {
      successful = true
    }
    if(successful && (!n || el.disabled || t == "reset" || t == "button" || (t == "checkbox" || t == "radio") && !el.checked || (t == "submit" || t == "image") && el.form && el.form.clk != el || tag == "select" && el.selectedIndex == -1)) {
      return null
    }
    if(tag == "select") {
      var index = el.selectedIndex;
      if(index < 0) {
        return null
      }
      var a = [], ops = el.options;
      var one = t == "select-one";
      var max = one ? index + 1 : ops.length;
      for(var i = one ? index : 0;i < max;i++) {
        var op = ops[i];
        if(op.selected) {
          var v = op.value;
          if(!v) {
            v = op.attributes && op.attributes["value"] && !op.attributes["value"].specified ? op.text : op.value
          }
          if(one) {
            return v
          }
          a.push(v)
        }
      }
      return a
    }
    return $(el).val()
  };
  $.fn.clearForm = function(includeHidden) {
    return this.each(function() {
      $("input,select,textarea", this).clearFields(includeHidden)
    })
  };
  $.fn.clearFields = $.fn.clearInputs = function(includeHidden) {
    var re = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
    return this.each(function() {
      var t = this.type, tag = this.tagName.toLowerCase();
      if(re.test(t) || tag == "textarea") {
        this.value = ""
      }else {
        if(t == "checkbox" || t == "radio") {
          this.checked = false
        }else {
          if(tag == "select") {
            this.selectedIndex = -1
          }else {
            if(includeHidden) {
              if(includeHidden === true && /hidden/.test(t) || typeof includeHidden == "string" && $(this).is(includeHidden)) {
                this.value = ""
              }
            }
          }
        }
      }
    })
  };
  $.fn.resetForm = function() {
    return this.each(function() {
      if(typeof this.reset == "function" || typeof this.reset == "object" && !this.reset.nodeType) {
        this.reset()
      }
    })
  };
  $.fn.enable = function(b) {
    if(b === undefined) {
      b = true
    }
    return this.each(function() {
      this.disabled = !b
    })
  };
  $.fn.selected = function(select) {
    if(select === undefined) {
      select = true
    }
    return this.each(function() {
      var t = this.type;
      if(t == "checkbox" || t == "radio") {
        this.checked = select
      }else {
        if(this.tagName.toLowerCase() == "option") {
          var $sel = $(this).parent("select");
          if(select && $sel[0] && $sel[0].type == "select-one") {
            $sel.find("option").selected(false)
          }
          this.selected = select
        }
      }
    })
  };
  $.fn.ajaxSubmit.debug = false;
  function log() {
    if(!$.fn.ajaxSubmit.debug) {
      return
    }
    var msg = "[jquery.form] " + Array.prototype.join.call(arguments, "");
    if(window.console && window.console.log) {
      window.console.log(msg)
    }else {
      if(window.opera && window.opera.postError) {
        window.opera.postError(msg)
      }
    }
  }
})(jQuery);
(function($) {
  $.fn.joyride = function(options) {
    var settings = {"tipLocation":"bottom", "scrollSpeed":300, "timer":0, "startTimerOnClick":false, "nextButton":true, "tipAnimation":"fade", "tipAnimationFadeSpeed":300, "cookieMonster":false, "cookieName":"JoyRide", "cookieDomain":false, "tipContainer":"body", "inline":false, "tipContent":"#joyRideTipContent", "postRideCallback":$.noop, "postStepCallback":$.noop, "postInitCallback":$.noop};
    var options = $.extend(settings, options);
    return this.each(function() {
      if($(options.tipContent).length === 0) {
        return
      }
      $(options.tipContent).hide();
      var bodyOffset = $(options.tipContainer).children("*").first().position(), tipContent = $(options.tipContent + " > li"), count = skipCount = 0, prevCount = -1, timerIndicatorInstance, timerIndicatorTemplate = '<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>';
      var tipTemplate = function(tipClass, index, buttonText, self) {
        return'<div class="joyride-tip-guide ' + tipClass + '" id="joyRidePopup' + index + '"><span class="joyride-nub"></span><div class="joyride-content-wrapper">' + $(self).html() + buttonText + '<a href="#close" class="joyride-close-tip"></a>' + timerIndicatorInstance + "</div></div>"
      };
      var tipLayout = function(tipClass, index, buttonText, self) {
        if(index == 0 && settings.startTimerOnClick && settings.timer > 0 || settings.timer == 0) {
          timerIndicatorInstance = ""
        }else {
          timerIndicatorInstance = timerIndicatorTemplate
        }
        if(!tipClass) {
          tipClass = ""
        }
        if(buttonText) {
          buttonText = '<a href="#" class="joyride-next-tip small nice radius yellow button">' + buttonText + "</a>"
        }else {
          buttonText = ""
        }
        if(settings.inline) {
          $(tipTemplate(tipClass, index, buttonText, self)).insertAfter("#" + $(self).data("id"))
        }else {
          $(options.tipContainer).append(tipTemplate(tipClass, index, buttonText, self))
        }
      };
      if(!settings.cookieMonster || !$.cookie(settings.cookieName)) {
        tipContent.each(function(index) {
          var buttonText = $(this).data("text"), tipClass = $(this).attr("class"), self = this;
          if(settings.nextButton && !buttonText) {
            buttonText = "Next"
          }
          if(settings.nextButton || !settings.nextButton && settings.startTimerOnClick) {
            if($(this).attr("class")) {
              tipLayout(tipClass, index, buttonText, self)
            }else {
              tipLayout(false, index, buttonText, self)
            }
          }else {
            if(!settings.nextButton) {
              if($(this).attr("class")) {
                tipLayout(tipClass, index, "", self)
              }else {
                tipLayout(false, index, "", self)
              }
            }
          }
          $("#joyRidePopup" + index).hide();
          if(index === 0) {
            $("#joyRidePopup" + index).addClass("joyRideCurrent")
          }
        })
      }
      showNextTip = function() {
        var parentElementID = $(tipContent[count]).data("id"), parentElement = $("#" + parentElementID), opt = {};
        $.each(($(tipContent[count]).data("options") || ":").split(";"), function(i, s) {
          var p = s.split(":");
          if(p.length == 2) {
            opt[$.trim(p[0])] = $.trim(p[1])
          }
        });
        var tipSettings = $.extend({}, settings, opt);
        while(parentElement.offset() === null) {
          count++;
          skipCount++;
          if(tipContent.length - 1 > prevCount) {
            prevCount++
          }
          parentElementID = $(tipContent[count]).data("id"), parentElement = $("#" + parentElementID);
          if($(tipContent).length < count) {
            break
          }
        }
        if(count === 0 && settings.onInitCallback != $.noop) {
          settings.onInitCallback()
        }
        var windowHalf = Math.ceil($(window).height() / 2), currentTip = $("#joyRidePopup" + count), currentTipPosition = parentElement.offset(), currentParentHeight = parentElement.outerHeight(), currentTipHeight = currentTip.outerHeight(), nubHeight = Math.ceil($(".joyride-nub").outerHeight() / 2), tipOffset = 0;
        if(currentTip.length === 0) {
          return
        }
        $(".joyRideCurrent").removeClass("joyRideCurrent");
        $(currentTip).addClass("joyRideCurrent");
        if(count < tipContent.length) {
          if(settings.tipAnimation == "pop") {
            $(".joyride-timer-indicator").width(0);
            if(settings.timer > 0) {
              currentTip.show().children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:$(".joyride-timer-indicator-wrap").width()}, settings.timer)
            }else {
              currentTip.show()
            }
          }else {
            if(settings.tipAnimation == "fade") {
              $(".joyride-timer-indicator").width(0);
              if(settings.timer > 0) {
                currentTip.fadeIn(settings.tipAnimationFadeSpeed).children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:$(".joyride-timer-indicator-wrap").width()}, settings.timer)
              }else {
                currentTip.fadeIn(settings.tipAnimationFadeSpeed)
              }
            }
          }
          var nub = currentTip.children(".joyride-nub");
          var left = currentTipPosition.left - bodyOffset.left;
          nub.removeClass("bottom").removeClass("top").removeClass("right");
          if($(window).scrollLeft() + $(window).width() < left + currentTip.width()) {
            left -= currentTip.width() - nub.offset().left * 2;
            nub.addClass("right")
          }
          if(Modernizr.mq("only screen and (max-width: 769px)")) {
            if(tipSettings.tipLocation.indexOf("top") != -1) {
              if(currentTipHeight >= currentTipPosition.top) {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight - bodyOffset.top});
                nub.addClass("top").css({left:left})
              }else {
                currentTip.offset({top:currentTipPosition.top - (currentTipHeight + bodyOffset.top + nubHeight)});
                nub.addClass("bottom").css({left:left})
              }
            }else {
              currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight});
              nub.addClass("top").css({left:left})
            }
          }else {
            if(tipSettings.tipLocation == "top") {
              if(currentTipHeight >= currentTipPosition.top) {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight - bodyOffset.top, left:left});
                nub.addClass("top")
              }else {
                currentTip.offset({top:currentTipPosition.top - (currentTipHeight + bodyOffset.top + nubHeight), left:left});
                nub.addClass("bottom")
              }
            }else {
              if(tipSettings.tipLocation == "bottom") {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:left});
                nub.addClass("top")
              }
            }
          }
          if(tipSettings.tipLocation.indexOf("right") != -1) {
            currentTip.offset({left:currentTipPosition.left - bodyOffset.left - currentTip.width() + parentElement.width()});
            currentTip.children(".joyride-nub").addClass("right")
          }
          tipOffset = Math.ceil(currentTip.offset().top - windowHalf);
          $("html, body").animate({scrollTop:tipOffset}, settings.scrollSpeed);
          if(count > 0) {
            if(skipCount > 0) {
              var hideCount = prevCount - skipCount;
              skipCount = 0
            }else {
              var hideCount = prevCount
            }
            if(settings.tipAnimation == "pop") {
              $("#joyRidePopup" + hideCount).hide()
            }else {
              if(settings.tipAnimation == "fade") {
                $("#joyRidePopup" + hideCount).fadeOut(settings.tipAnimationFadeSpeed)
              }
            }
          }
        }else {
          if(tipContent.length - 1 < count) {
            var hideCnt;
            if(skipCount > 0) {
              hideCount = prevCount - skipCount;
              skipCount = 0
            }else {
              hideCount = prevCount
            }
            if(settings.cookieMonster == true) {
              $.cookie(settings.cookieName, "ridden", {expires:365, domain:settings.cookieDomain})
            }
            if(settings.tipAnimation == "pop") {
              $("#joyRidePopup" + hideCount).fadeTo(0, 0)
            }else {
              if(settings.tipAnimation == "fade") {
                $("#joyRidePopup" + hideCount).fadeTo(settings.tipAnimationFadeSpeed, 0)
              }
            }
          }
        }
        count++;
        if(prevCount < 0) {
          prevCount = 0
        }else {
          if(tipContent.length - 1 > prevCount) {
            prevCount++
          }
        }
        if(settings.postStepCallback != $.noop) {
          settings.postStepCallback(prevCount)
        }
      };
      if(!settings.inline || !settings.cookieMonster || !$.cookie(settings.cookieName)) {
        $(window).resize(function() {
          var parentElementID = $(tipContent[prevCount]).data("id"), currentTipPosition = $("#" + parentElementID).offset(), currentParentHeight = $("#" + parentElementID).outerHeight(), currentTipHeight = $("#joyRidePopup" + prevCount).outerHeight(), nubHeight = Math.ceil($(".joyride-nub").outerHeight() / 2);
          if(Modernizr.mq("only screen and (max-width: 769px)")) {
            if(settings.tipLocation == "bottom") {
              $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:0});
              $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:currentTipPosition.left - bodyOffset.left})
            }else {
              if(settings.tipLocation == "top") {
                if(currentTipPosition.top <= currentTipHeight) {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + nubHeight + currentParentHeight, left:0});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:currentTipPosition.left - bodyOffset.left})
                }else {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top - (currentTipHeight + nubHeight), left:0});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:currentTipPosition.left - bodyOffset.left})
                }
              }
            }
          }else {
            if(settings.tipLocation == "bottom") {
              $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:currentTipPosition.left});
              $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})
            }else {
              if(settings.tipLocation == "top") {
                if(currentTipPosition.top <= currentTipHeight) {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + nubHeight + currentParentHeight, left:currentTipPosition.left});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})
                }else {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top - (currentTipHeight + nubHeight), left:currentTipPosition.left});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:""})
                }
              }
            }
          }
        })
      }
      var interval_id = null, showTimerState = false;
      if(!settings.startTimerOnClick && settings.timer > 0) {
        showNextTip();
        interval_id = setInterval(function() {
          showNextTip()
        }, settings.timer)
      }else {
        showNextTip()
      }
      var endTip = function(e, interval_id, cookie, self) {
        e.preventDefault();
        clearInterval(interval_id);
        if(cookie) {
          $.cookie(settings.cookieName, "ridden", {expires:365, domain:settings.cookieDomain})
        }
        $(self).parent().parent().hide();
        if(settings.postRideCallback != $.noop) {
          settings.postRideCallback()
        }
        $(".joyRideCurrent").removeClass("joyRideCurrent")
      };
      $(".joyride-close-tip").click(function(e) {
        endTip(e, interval_id, settings.cookieMonster, this)
      });
      $(".joyride-next-tip").click(function(e) {
        e.preventDefault();
        if(count >= tipContent.length) {
          endTip(e, interval_id, settings.cookieMonster, this)
        }
        if(settings.timer > 0 && settings.startTimerOnClick) {
          showNextTip();
          clearInterval(interval_id);
          interval_id = setInterval(function() {
            showNextTip()
          }, settings.timer)
        }else {
          if(settings.timer > 0 && !settings.startTimerOnClick) {
            clearInterval(interval_id);
            interval_id = setInterval(function() {
              showNextTip()
            }, settings.timer)
          }else {
            showNextTip()
          }
        }
      })
    })
  }
})(jQuery);
(function(a) {
  function d(b) {
    var c = b || window.event, d = [].slice.call(arguments, 1), e = 0, f = !0, g = 0, h = 0;
    return b = a.event.fix(c), b.type = "mousewheel", c.wheelDelta && (e = c.wheelDelta / 120), c.detail && (e = -c.detail / 3), h = e, c.axis !== undefined && c.axis === c.HORIZONTAL_AXIS && (h = 0, g = -1 * e), c.wheelDeltaY !== undefined && (h = c.wheelDeltaY / 120), c.wheelDeltaX !== undefined && (g = -1 * c.wheelDeltaX / 120), d.unshift(b, e, g, h), (a.event.dispatch || a.event.handle).apply(this, d)
  }
  var b = ["DOMMouseScroll", "mousewheel"];
  if(a.event.fixHooks) {
    for(var c = b.length;c;) {
      a.event.fixHooks[b[--c]] = a.event.mouseHooks
    }
  }
  a.event.special.mousewheel = {setup:function() {
    if(this.addEventListener) {
      for(var a = b.length;a;) {
        this.addEventListener(b[--a], d, !1)
      }
    }else {
      this.onmousewheel = d
    }
  }, teardown:function() {
    if(this.removeEventListener) {
      for(var a = b.length;a;) {
        this.removeEventListener(b[--a], d, !1)
      }
    }else {
      this.onmousewheel = null
    }
  }}, a.fn.extend({mousewheel:function(a) {
    return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
  }, unmousewheel:function(a) {
    return this.unbind("mousewheel", a)
  }})
})(jQuery);
(function(c) {
  var b = {init:function(e) {
    var f = {set_width:false, set_height:false, horizontalScroll:false, scrollInertia:950, mouseWheel:true, mouseWheelPixels:"auto", autoDraggerLength:true, autoHideScrollbar:false, snapAmount:null, snapOffset:0, scrollButtons:{enable:false, scrollType:"continuous", scrollSpeed:"auto", scrollAmount:40}, advanced:{updateOnBrowserResize:true, updateOnContentResize:false, autoExpandHorizontalScroll:false, autoScrollOnFocus:true, normalizeMouseWheelDelta:false}, contentTouchScroll:true, callbacks:{onScrollStart:function() {
    }, onScroll:function() {
    }, onTotalScroll:function() {
    }, onTotalScrollBack:function() {
    }, onTotalScrollOffset:0, onTotalScrollBackOffset:0, whileScrolling:function() {
    }}, theme:"light"}, e = c.extend(true, f, e);
    return this.each(function() {
      var m = c(this);
      if(e.set_width) {
        m.css("width", e.set_width)
      }
      if(e.set_height) {
        m.css("height", e.set_height)
      }
      if(!c(document).data("mCustomScrollbar-index")) {
        c(document).data("mCustomScrollbar-index", "1")
      }else {
        var t = parseInt(c(document).data("mCustomScrollbar-index"));
        c(document).data("mCustomScrollbar-index", t + 1)
      }
      m.wrapInner("<div class='mCustomScrollBox mCS-" + e.theme + "' id='mCSB_" + c(document).data("mCustomScrollbar-index") + "' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_" + c(document).data("mCustomScrollbar-index"));
      var g = m.children(".mCustomScrollBox");
      if(e.horizontalScroll) {
        g.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");
        var k = g.children(".mCSB_h_wrapper");
        k.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:k.children().outerWidth(), position:"relative"}).unwrap()
      }else {
        g.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />")
      }
      var o = g.children(".mCSB_container");
      if(c.support.touch) {
        o.addClass("mCS_touch")
      }
      o.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");
      var l = g.children(".mCSB_scrollTools"), h = l.children(".mCSB_draggerContainer"), q = h.children(".mCSB_dragger");
      if(e.horizontalScroll) {
        q.data("minDraggerWidth", q.width())
      }else {
        q.data("minDraggerHeight", q.height())
      }
      if(e.scrollButtons.enable) {
        if(e.horizontalScroll) {
          l.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>")
        }else {
          l.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")
        }
      }
      g.bind("scroll", function() {
        if(!m.is(".mCS_disabled")) {
          g.scrollTop(0).scrollLeft(0)
        }
      });
      m.data({mCS_Init:true, mCustomScrollbarIndex:c(document).data("mCustomScrollbar-index"), horizontalScroll:e.horizontalScroll, scrollInertia:e.scrollInertia, scrollEasing:"mcsEaseOut", mouseWheel:e.mouseWheel, mouseWheelPixels:e.mouseWheelPixels, autoDraggerLength:e.autoDraggerLength, autoHideScrollbar:e.autoHideScrollbar, snapAmount:e.snapAmount, snapOffset:e.snapOffset, scrollButtons_enable:e.scrollButtons.enable, scrollButtons_scrollType:e.scrollButtons.scrollType, scrollButtons_scrollSpeed:e.scrollButtons.scrollSpeed, 
      scrollButtons_scrollAmount:e.scrollButtons.scrollAmount, autoExpandHorizontalScroll:e.advanced.autoExpandHorizontalScroll, autoScrollOnFocus:e.advanced.autoScrollOnFocus, normalizeMouseWheelDelta:e.advanced.normalizeMouseWheelDelta, contentTouchScroll:e.contentTouchScroll, onScrollStart_Callback:e.callbacks.onScrollStart, onScroll_Callback:e.callbacks.onScroll, onTotalScroll_Callback:e.callbacks.onTotalScroll, onTotalScrollBack_Callback:e.callbacks.onTotalScrollBack, onTotalScroll_Offset:e.callbacks.onTotalScrollOffset, 
      onTotalScrollBack_Offset:e.callbacks.onTotalScrollBackOffset, whileScrolling_Callback:e.callbacks.whileScrolling, bindEvent_scrollbar_drag:false, bindEvent_content_touch:false, bindEvent_scrollbar_click:false, bindEvent_mousewheel:false, bindEvent_buttonsContinuous_y:false, bindEvent_buttonsContinuous_x:false, bindEvent_buttonsPixels_y:false, bindEvent_buttonsPixels_x:false, bindEvent_focusin:false, bindEvent_autoHideScrollbar:false, mCSB_buttonScrollRight:false, mCSB_buttonScrollLeft:false, 
      mCSB_buttonScrollDown:false, mCSB_buttonScrollUp:false});
      if(e.horizontalScroll) {
        if(m.css("max-width") !== "none") {
          if(!e.advanced.updateOnContentResize) {
            e.advanced.updateOnContentResize = true
          }
        }
      }else {
        if(m.css("max-height") !== "none") {
          var s = false, r = parseInt(m.css("max-height"));
          if(m.css("max-height").indexOf("%") >= 0) {
            s = r, r = m.parent().height() * s / 100
          }
          m.css("overflow", "hidden");
          g.css("max-height", r)
        }
      }
      m.mCustomScrollbar("update");
      if(e.advanced.updateOnBrowserResize) {
        var i, j = c(window).width(), u = c(window).height();
        c(window).bind("resize." + m.data("mCustomScrollbarIndex"), function() {
          if(i) {
            clearTimeout(i)
          }
          i = setTimeout(function() {
            if(!m.is(".mCS_disabled") && !m.is(".mCS_destroyed")) {
              var w = c(window).width(), v = c(window).height();
              if(j !== w || u !== v) {
                if(m.css("max-height") !== "none" && s) {
                  g.css("max-height", m.parent().height() * s / 100)
                }
                m.mCustomScrollbar("update");
                j = w;
                u = v
              }
            }
          }, 150)
        })
      }
      if(e.advanced.updateOnContentResize) {
        var p;
        if(e.horizontalScroll) {
          var n = o.outerWidth()
        }else {
          var n = o.outerHeight()
        }
        p = setInterval(function() {
          if(e.horizontalScroll) {
            if(e.advanced.autoExpandHorizontalScroll) {
              o.css({position:"absolute", width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:o.outerWidth(), position:"relative"}).unwrap()
            }
            var v = o.outerWidth()
          }else {
            var v = o.outerHeight()
          }
          if(v != n) {
            m.mCustomScrollbar("update");
            n = v
          }
        }, 300)
      }
    })
  }, update:function() {
    var n = c(this), k = n.children(".mCustomScrollBox"), q = k.children(".mCSB_container");
    q.removeClass("mCS_no_scrollbar");
    n.removeClass("mCS_disabled mCS_destroyed");
    k.scrollTop(0).scrollLeft(0);
    var y = k.children(".mCSB_scrollTools"), o = y.children(".mCSB_draggerContainer"), m = o.children(".mCSB_dragger");
    if(n.data("horizontalScroll")) {
      var A = y.children(".mCSB_buttonLeft"), t = y.children(".mCSB_buttonRight"), f = k.width();
      if(n.data("autoExpandHorizontalScroll")) {
        q.css({position:"absolute", width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:q.outerWidth(), position:"relative"}).unwrap()
      }
      var z = q.outerWidth()
    }else {
      var w = y.children(".mCSB_buttonUp"), g = y.children(".mCSB_buttonDown"), r = k.height(), i = q.outerHeight()
    }
    if(i > r && !n.data("horizontalScroll")) {
      y.css("display", "block");
      var s = o.height();
      if(n.data("autoDraggerLength")) {
        var u = Math.round(r / i * s), l = m.data("minDraggerHeight");
        if(u <= l) {
          m.css({height:l})
        }else {
          if(u >= s - 10) {
            var p = s - 10;
            m.css({height:p})
          }else {
            m.css({height:u})
          }
        }
        m.children(".mCSB_dragger_bar").css({"line-height":m.height() + "px"})
      }
      var B = m.height(), x = (i - r) / (s - B);
      n.data("scrollAmount", x).mCustomScrollbar("scrolling", k, q, o, m, w, g, A, t);
      var D = Math.abs(q.position().top);
      n.mCustomScrollbar("scrollTo", D, {scrollInertia:0, trigger:"internal"})
    }else {
      if(z > f && n.data("horizontalScroll")) {
        y.css("display", "block");
        var h = o.width();
        if(n.data("autoDraggerLength")) {
          var j = Math.round(f / z * h), C = m.data("minDraggerWidth");
          if(j <= C) {
            m.css({width:C})
          }else {
            if(j >= h - 10) {
              var e = h - 10;
              m.css({width:e})
            }else {
              m.css({width:j})
            }
          }
        }
        var v = m.width(), x = (z - f) / (h - v);
        n.data("scrollAmount", x).mCustomScrollbar("scrolling", k, q, o, m, w, g, A, t);
        var D = Math.abs(q.position().left);
        n.mCustomScrollbar("scrollTo", D, {scrollInertia:0, trigger:"internal"})
      }else {
        k.unbind("mousewheel focusin");
        if(n.data("horizontalScroll")) {
          m.add(q).css("left", 0)
        }else {
          m.add(q).css("top", 0)
        }
        y.css("display", "none");
        q.addClass("mCS_no_scrollbar");
        n.data({bindEvent_mousewheel:false, bindEvent_focusin:false})
      }
    }
  }, scrolling:function(h, p, m, j, w, e, A, v) {
    var k = c(this);
    if(!k.data("bindEvent_scrollbar_drag")) {
      var n, o;
      if(c.support.msPointer) {
        j.bind("MSPointerDown", function(H) {
          H.preventDefault();
          k.data({on_drag:true});
          j.addClass("mCSB_dragger_onDrag");
          var G = c(this), J = G.offset(), F = H.originalEvent.pageX - J.left, I = H.originalEvent.pageY - J.top;
          if(F < G.width() && F > 0 && I < G.height() && I > 0) {
            n = I;
            o = F
          }
        });
        c(document).bind("MSPointerMove." + k.data("mCustomScrollbarIndex"), function(H) {
          H.preventDefault();
          if(k.data("on_drag")) {
            var G = j, J = G.offset(), F = H.originalEvent.pageX - J.left, I = H.originalEvent.pageY - J.top;
            D(n, o, I, F)
          }
        }).bind("MSPointerUp." + k.data("mCustomScrollbarIndex"), function(x) {
          k.data({on_drag:false});
          j.removeClass("mCSB_dragger_onDrag")
        })
      }else {
        j.bind("mousedown touchstart", function(H) {
          H.preventDefault();
          H.stopImmediatePropagation();
          var G = c(this), K = G.offset(), F, J;
          if(H.type === "touchstart") {
            var I = H.originalEvent.touches[0] || H.originalEvent.changedTouches[0];
            F = I.pageX - K.left;
            J = I.pageY - K.top
          }else {
            k.data({on_drag:true});
            j.addClass("mCSB_dragger_onDrag");
            F = H.pageX - K.left;
            J = H.pageY - K.top
          }
          if(F < G.width() && F > 0 && J < G.height() && J > 0) {
            n = J;
            o = F
          }
        }).bind("touchmove", function(H) {
          H.preventDefault();
          H.stopImmediatePropagation();
          var K = H.originalEvent.touches[0] || H.originalEvent.changedTouches[0], G = c(this), J = G.offset(), F = K.pageX - J.left, I = K.pageY - J.top;
          D(n, o, I, F)
        });
        c(document).bind("mousemove." + k.data("mCustomScrollbarIndex"), function(H) {
          if(k.data("on_drag")) {
            var G = j, J = G.offset(), F = H.pageX - J.left, I = H.pageY - J.top;
            D(n, o, I, F)
          }
        }).bind("mouseup." + k.data("mCustomScrollbarIndex"), function(x) {
          k.data({on_drag:false});
          j.removeClass("mCSB_dragger_onDrag")
        })
      }
      k.data({bindEvent_scrollbar_drag:true})
    }
    function D(G, H, I, F) {
      if(k.data("horizontalScroll")) {
        k.mCustomScrollbar("scrollTo", j.position().left - H + F, {moveDragger:true, trigger:"internal"})
      }else {
        k.mCustomScrollbar("scrollTo", j.position().top - G + I, {moveDragger:true, trigger:"internal"})
      }
    }
    if(c.support.touch && k.data("contentTouchScroll")) {
      if(!k.data("bindEvent_content_touch")) {
        var l, B, r, s, u, C, E;
        p.bind("touchstart", function(x) {
          x.stopImmediatePropagation();
          l = x.originalEvent.touches[0] || x.originalEvent.changedTouches[0];
          B = c(this);
          r = B.offset();
          u = l.pageX - r.left;
          s = l.pageY - r.top;
          C = s;
          E = u
        });
        p.bind("touchmove", function(x) {
          x.preventDefault();
          x.stopImmediatePropagation();
          l = x.originalEvent.touches[0] || x.originalEvent.changedTouches[0];
          B = c(this).parent();
          r = B.offset();
          u = l.pageX - r.left;
          s = l.pageY - r.top;
          if(k.data("horizontalScroll")) {
            k.mCustomScrollbar("scrollTo", E - u, {trigger:"internal"})
          }else {
            k.mCustomScrollbar("scrollTo", C - s, {trigger:"internal"})
          }
        })
      }
    }
    if(!k.data("bindEvent_scrollbar_click")) {
      m.bind("click", function(F) {
        var x = (F.pageY - m.offset().top) * k.data("scrollAmount"), y = c(F.target);
        if(k.data("horizontalScroll")) {
          x = (F.pageX - m.offset().left) * k.data("scrollAmount")
        }
        if(y.hasClass("mCSB_draggerContainer") || y.hasClass("mCSB_draggerRail")) {
          k.mCustomScrollbar("scrollTo", x, {trigger:"internal", scrollEasing:"draggerRailEase"})
        }
      });
      k.data({bindEvent_scrollbar_click:true})
    }
    if(k.data("mouseWheel")) {
      if(!k.data("bindEvent_mousewheel")) {
        h.bind("mousewheel", function(H, J) {
          var G, F = k.data("mouseWheelPixels"), x = Math.abs(p.position().top), I = j.position().top, y = m.height() - j.height();
          if(k.data("normalizeMouseWheelDelta")) {
            if(J < 0) {
              J = -1
            }else {
              J = 1
            }
          }
          if(F === "auto") {
            F = 100 + Math.round(k.data("scrollAmount") / 2)
          }
          if(k.data("horizontalScroll")) {
            I = j.position().left;
            y = m.width() - j.width();
            x = Math.abs(p.position().left)
          }
          if(J > 0 && I !== 0 || J < 0 && I !== y) {
            H.preventDefault();
            H.stopImmediatePropagation()
          }
          G = x - J * F;
          k.mCustomScrollbar("scrollTo", G, {trigger:"internal"})
        });
        k.data({bindEvent_mousewheel:true})
      }
    }
    if(k.data("scrollButtons_enable")) {
      if(k.data("scrollButtons_scrollType") === "pixels") {
        if(k.data("horizontalScroll")) {
          v.add(A).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend", i, g);
          k.data({bindEvent_buttonsContinuous_x:false});
          if(!k.data("bindEvent_buttonsPixels_x")) {
            v.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().left) + k.data("scrollButtons_scrollAmount"))
            });
            A.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().left) - k.data("scrollButtons_scrollAmount"))
            });
            k.data({bindEvent_buttonsPixels_x:true})
          }
        }else {
          e.add(w).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend", i, g);
          k.data({bindEvent_buttonsContinuous_y:false});
          if(!k.data("bindEvent_buttonsPixels_y")) {
            e.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().top) + k.data("scrollButtons_scrollAmount"))
            });
            w.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().top) - k.data("scrollButtons_scrollAmount"))
            });
            k.data({bindEvent_buttonsPixels_y:true})
          }
        }
        function q(x) {
          if(!j.data("preventAction")) {
            j.data("preventAction", true);
            k.mCustomScrollbar("scrollTo", x, {trigger:"internal"})
          }
        }
      }else {
        if(k.data("horizontalScroll")) {
          v.add(A).unbind("click");
          k.data({bindEvent_buttonsPixels_x:false});
          if(!k.data("bindEvent_buttonsContinuous_x")) {
            v.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollRight:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().left) + x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var i = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollRight"))
            };
            v.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", i);
            A.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollLeft:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().left) - x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var g = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollLeft"))
            };
            A.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", g);
            k.data({bindEvent_buttonsContinuous_x:true})
          }
        }else {
          e.add(w).unbind("click");
          k.data({bindEvent_buttonsPixels_y:false});
          if(!k.data("bindEvent_buttonsContinuous_y")) {
            e.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollDown:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().top) + x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var t = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollDown"))
            };
            e.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", t);
            w.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollUp:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().top) - x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var f = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollUp"))
            };
            w.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", f);
            k.data({bindEvent_buttonsContinuous_y:true})
          }
        }
        function z() {
          var x = k.data("scrollButtons_scrollSpeed");
          if(k.data("scrollButtons_scrollSpeed") === "auto") {
            x = Math.round((k.data("scrollInertia") + 100) / 40)
          }
          return x
        }
      }
    }
    if(k.data("autoScrollOnFocus")) {
      if(!k.data("bindEvent_focusin")) {
        h.bind("focusin", function() {
          h.scrollTop(0).scrollLeft(0);
          var x = c(document.activeElement);
          if(x.is("input,textarea,select,button,a[tabindex],area,object")) {
            var G = p.position().top, y = x.position().top, F = h.height() - x.outerHeight();
            if(k.data("horizontalScroll")) {
              G = p.position().left;
              y = x.position().left;
              F = h.width() - x.outerWidth()
            }
            if(G + y < 0 || G + y > F) {
              k.mCustomScrollbar("scrollTo", y, {trigger:"internal"})
            }
          }
        });
        k.data({bindEvent_focusin:true})
      }
    }
    if(k.data("autoHideScrollbar")) {
      if(!k.data("bindEvent_autoHideScrollbar")) {
        h.bind("mouseenter", function(x) {
          h.addClass("mCS-mouse-over");
          d.showScrollbar.call(h.children(".mCSB_scrollTools"))
        }).bind("mouseleave touchend", function(x) {
          h.removeClass("mCS-mouse-over");
          if(x.type === "mouseleave") {
            d.hideScrollbar.call(h.children(".mCSB_scrollTools"))
          }
        });
        k.data({bindEvent_autoHideScrollbar:true})
      }
    }
  }, scrollTo:function(e, f) {
    var i = c(this), o = {moveDragger:false, trigger:"external", callbacks:true, scrollInertia:i.data("scrollInertia"), scrollEasing:i.data("scrollEasing")}, f = c.extend(o, f), p, g = i.children(".mCustomScrollBox"), k = g.children(".mCSB_container"), r = g.children(".mCSB_scrollTools"), j = r.children(".mCSB_draggerContainer"), h = j.children(".mCSB_dragger"), t = draggerSpeed = f.scrollInertia, q, s, m, l;
    if(!k.hasClass("mCS_no_scrollbar")) {
      i.data({mCS_trigger:f.trigger});
      if(i.data("mCS_Init")) {
        f.callbacks = false
      }
      if(e || e === 0) {
        if(typeof e === "number") {
          if(f.moveDragger) {
            p = e;
            if(i.data("horizontalScroll")) {
              e = h.position().left * i.data("scrollAmount")
            }else {
              e = h.position().top * i.data("scrollAmount")
            }
            draggerSpeed = 0
          }else {
            p = e / i.data("scrollAmount")
          }
        }else {
          if(typeof e === "string") {
            var v;
            if(e === "top") {
              v = 0
            }else {
              if(e === "bottom" && !i.data("horizontalScroll")) {
                v = k.outerHeight() - g.height()
              }else {
                if(e === "left") {
                  v = 0
                }else {
                  if(e === "right" && i.data("horizontalScroll")) {
                    v = k.outerWidth() - g.width()
                  }else {
                    if(e === "first") {
                      v = i.find(".mCSB_container").find(":first")
                    }else {
                      if(e === "last") {
                        v = i.find(".mCSB_container").find(":last")
                      }else {
                        v = i.find(e)
                      }
                    }
                  }
                }
              }
            }
            if(v.length === 1) {
              if(i.data("horizontalScroll")) {
                e = v.position().left
              }else {
                e = v.position().top
              }
              p = e / i.data("scrollAmount")
            }else {
              p = e = v
            }
          }
        }
        if(i.data("horizontalScroll")) {
          if(i.data("onTotalScrollBack_Offset")) {
            s = -i.data("onTotalScrollBack_Offset")
          }
          if(i.data("onTotalScroll_Offset")) {
            l = g.width() - k.outerWidth() + i.data("onTotalScroll_Offset")
          }
          if(p < 0) {
            p = e = 0;
            clearInterval(i.data("mCSB_buttonScrollLeft"));
            if(!s) {
              q = true
            }
          }else {
            if(p >= j.width() - h.width()) {
              p = j.width() - h.width();
              e = g.width() - k.outerWidth();
              clearInterval(i.data("mCSB_buttonScrollRight"));
              if(!l) {
                m = true
              }
            }else {
              e = -e
            }
          }
          var n = i.data("snapAmount");
          if(n) {
            e = Math.round(e / n) * n - i.data("snapOffset")
          }
          d.mTweenAxis.call(this, h[0], "left", Math.round(p), draggerSpeed, f.scrollEasing);
          d.mTweenAxis.call(this, k[0], "left", Math.round(e), t, f.scrollEasing, {onStart:function() {
            if(f.callbacks && !i.data("mCS_tweenRunning")) {
              u("onScrollStart")
            }
            if(i.data("autoHideScrollbar")) {
              d.showScrollbar.call(r)
            }
          }, onUpdate:function() {
            if(f.callbacks) {
              u("whileScrolling")
            }
          }, onComplete:function() {
            if(f.callbacks) {
              u("onScroll");
              if(q || s && k.position().left >= s) {
                u("onTotalScrollBack")
              }
              if(m || l && k.position().left <= l) {
                u("onTotalScroll")
              }
            }
            h.data("preventAction", false);
            i.data("mCS_tweenRunning", false);
            if(i.data("autoHideScrollbar")) {
              if(!g.hasClass("mCS-mouse-over")) {
                d.hideScrollbar.call(r)
              }
            }
          }})
        }else {
          if(i.data("onTotalScrollBack_Offset")) {
            s = -i.data("onTotalScrollBack_Offset")
          }
          if(i.data("onTotalScroll_Offset")) {
            l = g.height() - k.outerHeight() + i.data("onTotalScroll_Offset")
          }
          if(p < 0) {
            p = e = 0;
            clearInterval(i.data("mCSB_buttonScrollUp"));
            if(!s) {
              q = true
            }
          }else {
            if(p >= j.height() - h.height()) {
              p = j.height() - h.height();
              e = g.height() - k.outerHeight();
              clearInterval(i.data("mCSB_buttonScrollDown"));
              if(!l) {
                m = true
              }
            }else {
              e = -e
            }
          }
          var n = i.data("snapAmount");
          if(n) {
            e = Math.round(e / n) * n - i.data("snapOffset")
          }
          d.mTweenAxis.call(this, h[0], "top", Math.round(p), draggerSpeed, f.scrollEasing);
          d.mTweenAxis.call(this, k[0], "top", Math.round(e), t, f.scrollEasing, {onStart:function() {
            if(f.callbacks && !i.data("mCS_tweenRunning")) {
              u("onScrollStart")
            }
            if(i.data("autoHideScrollbar")) {
              d.showScrollbar.call(r)
            }
          }, onUpdate:function() {
            if(f.callbacks) {
              u("whileScrolling")
            }
          }, onComplete:function() {
            if(f.callbacks) {
              u("onScroll");
              if(q || s && k.position().top >= s) {
                u("onTotalScrollBack")
              }
              if(m || l && k.position().top <= l) {
                u("onTotalScroll")
              }
            }
            h.data("preventAction", false);
            i.data("mCS_tweenRunning", false);
            if(i.data("autoHideScrollbar")) {
              if(!g.hasClass("mCS-mouse-over")) {
                d.hideScrollbar.call(r)
              }
            }
          }})
        }
        if(i.data("mCS_Init")) {
          i.data({mCS_Init:false})
        }
      }
    }
    function u(w) {
      this.mcs = {top:k.position().top, left:k.position().left, draggerTop:h.position().top, draggerLeft:h.position().left, topPct:Math.round(100 * Math.abs(k.position().top) / Math.abs(k.outerHeight() - g.height())), leftPct:Math.round(100 * Math.abs(k.position().left) / Math.abs(k.outerWidth() - g.width()))};
      switch(w) {
        case "onScrollStart":
          i.data("mCS_tweenRunning", true).data("onScrollStart_Callback").call(i, this.mcs);
          break;
        case "whileScrolling":
          i.data("whileScrolling_Callback").call(i, this.mcs);
          break;
        case "onScroll":
          i.data("onScroll_Callback").call(i, this.mcs);
          break;
        case "onTotalScrollBack":
          i.data("onTotalScrollBack_Callback").call(i, this.mcs);
          break;
        case "onTotalScroll":
          i.data("onTotalScroll_Callback").call(i, this.mcs);
          break
      }
    }
  }, stop:function() {
    var g = c(this), e = g.children().children(".mCSB_container"), f = g.children().children().children().children(".mCSB_dragger");
    d.mTweenAxisStop.call(this, e[0]);
    d.mTweenAxisStop.call(this, f[0])
  }, disable:function(e) {
    var j = c(this), f = j.children(".mCustomScrollBox"), h = f.children(".mCSB_container"), g = f.children(".mCSB_scrollTools"), i = g.children().children(".mCSB_dragger");
    f.unbind("mousewheel focusin mouseenter mouseleave touchend");
    h.unbind("touchstart touchmove");
    if(e) {
      if(j.data("horizontalScroll")) {
        i.add(h).css("left", 0)
      }else {
        i.add(h).css("top", 0)
      }
    }
    g.css("display", "none");
    h.addClass("mCS_no_scrollbar");
    j.data({bindEvent_mousewheel:false, bindEvent_focusin:false, bindEvent_content_touch:false, bindEvent_autoHideScrollbar:false}).addClass("mCS_disabled")
  }, destroy:function() {
    var e = c(this);
    e.removeClass("mCustomScrollbar _mCS_" + e.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();
    c(document).unbind("mousemove." + e.data("mCustomScrollbarIndex") + " mouseup." + e.data("mCustomScrollbarIndex") + " MSPointerMove." + e.data("mCustomScrollbarIndex") + " MSPointerUp." + e.data("mCustomScrollbarIndex"));
    c(window).unbind("resize." + e.data("mCustomScrollbarIndex"))
  }}, d = {showScrollbar:function() {
    this.stop().animate({opacity:1}, "fast")
  }, hideScrollbar:function() {
    this.stop().animate({opacity:0}, "fast")
  }, mTweenAxis:function(g, i, h, f, o, y) {
    var y = y || {}, v = y.onStart || function() {
    }, p = y.onUpdate || function() {
    }, w = y.onComplete || function() {
    };
    var n = t(), l, j = 0, r = g.offsetTop, s = g.style;
    if(i === "left") {
      r = g.offsetLeft
    }
    var m = h - r;
    q();
    e();
    function t() {
      if(window.performance && window.performance.now) {
        return window.performance.now()
      }else {
        if(window.performance && window.performance.webkitNow) {
          return window.performance.webkitNow()
        }else {
          if(Date.now) {
            return Date.now()
          }else {
            return(new Date).getTime()
          }
        }
      }
    }
    function x() {
      if(!j) {
        v.call()
      }
      j = t() - n;
      u();
      if(j >= g._time) {
        g._time = j > g._time ? j + l - (j - g._time) : j + l - 1;
        if(g._time < j + 1) {
          g._time = j + 1
        }
      }
      if(g._time < f) {
        g._id = _request(x)
      }else {
        w.call()
      }
    }
    function u() {
      if(f > 0) {
        g.currVal = k(g._time, r, m, f, o);
        s[i] = Math.round(g.currVal) + "px"
      }else {
        s[i] = h + "px"
      }
      p.call()
    }
    function e() {
      l = 1E3 / 60;
      g._time = j + l;
      _request = !window.requestAnimationFrame ? function(z) {
        u();
        return setTimeout(z, 0.01)
      } : window.requestAnimationFrame;
      g._id = _request(x)
    }
    function q() {
      if(g._id == null) {
        return
      }
      if(!window.requestAnimationFrame) {
        clearTimeout(g._id)
      }else {
        window.cancelAnimationFrame(g._id)
      }
      g._id = null
    }
    function k(B, A, F, E, C) {
      switch(C) {
        case "linear":
          return F * B / E + A;
          break;
        case "easeOutQuad":
          B /= E;
          return-F * B * (B - 2) + A;
          break;
        case "easeInOutQuad":
          B /= E / 2;
          if(B < 1) {
            return F / 2 * B * B + A
          }
          B--;
          return-F / 2 * (B * (B - 2) - 1) + A;
          break;
        case "easeOutCubic":
          B /= E;
          B--;
          return F * (B * B * B + 1) + A;
          break;
        case "easeOutQuart":
          B /= E;
          B--;
          return-F * (B * B * B * B - 1) + A;
          break;
        case "easeOutQuint":
          B /= E;
          B--;
          return F * (B * B * B * B * B + 1) + A;
          break;
        case "easeOutCirc":
          B /= E;
          B--;
          return F * Math.sqrt(1 - B * B) + A;
          break;
        case "easeOutSine":
          return F * Math.sin(B / E * (Math.PI / 2)) + A;
          break;
        case "easeOutExpo":
          return F * (-Math.pow(2, -10 * B / E) + 1) + A;
          break;
        case "mcsEaseOut":
          var D = (B /= E) * B, z = D * B;
          return A + F * (0.499999999999997 * z * D + -2.5 * D * D + 5.5 * z + -6.5 * D + 4 * B);
          break;
        case "draggerRailEase":
          B /= E / 2;
          if(B < 1) {
            return F / 2 * B * B * B + A
          }
          B -= 2;
          return F / 2 * (B * B * B + 2) + A;
          break
      }
    }
  }, mTweenAxisStop:function(e) {
    if(e._id == null) {
      return
    }
    if(!window.requestAnimationFrame) {
      clearTimeout(e._id)
    }else {
      window.cancelAnimationFrame(e._id)
    }
    e._id = null
  }, rafPolyfill:function() {
    var f = ["ms", "moz", "webkit", "o"], e = f.length;
    while(--e > -1 && !window.requestAnimationFrame) {
      window.requestAnimationFrame = window[f[e] + "RequestAnimationFrame"];
      window.cancelAnimationFrame = window[f[e] + "CancelAnimationFrame"] || window[f[e] + "CancelRequestAnimationFrame"]
    }
  }};
  d.rafPolyfill.call();
  c.support.touch = !!("ontouchstart" in window);
  c.support.msPointer = window.navigator.msPointerEnabled;
  var a = "https:" == document.location.protocol ? "https:" : "http:";
  c.event.special.mousewheel || document.write('<script src="' + a + '//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>');
  c.fn.mCustomScrollbar = function(e) {
    if(b[e]) {
      return b[e].apply(this, Array.prototype.slice.call(arguments, 1))
    }else {
      if(typeof e === "object" || !e) {
        return b.init.apply(this, arguments)
      }else {
        c.error("Method " + e + " does not exist")
      }
    }
  }
})(jQuery);
(function(d) {
  function g(a) {
    var b = a || window.event, i = [].slice.call(arguments, 1), c = 0, h = 0, e = 0;
    a = d.event.fix(b);
    a.type = "mousewheel";
    if(a.wheelDelta) {
      c = a.wheelDelta / 120
    }
    if(a.detail) {
      c = -a.detail / 3
    }
    e = c;
    if(b.axis !== undefined && b.axis === b.HORIZONTAL_AXIS) {
      e = 0;
      h = -1 * c
    }
    if(b.wheelDeltaY !== undefined) {
      e = b.wheelDeltaY / 120
    }
    if(b.wheelDeltaX !== undefined) {
      h = -1 * b.wheelDeltaX / 120
    }
    i.unshift(a, c, h, e);
    return d.event.handle.apply(this, i)
  }
  var f = ["DOMMouseScroll", "mousewheel"];
  d.event.special.mousewheel = {setup:function() {
    if(this.addEventListener) {
      for(var a = f.length;a;) {
        this.addEventListener(f[--a], g, false)
      }
    }else {
      this.onmousewheel = g
    }
  }, teardown:function() {
    if(this.removeEventListener) {
      for(var a = f.length;a;) {
        this.removeEventListener(f[--a], g, false)
      }
    }else {
      this.onmousewheel = null
    }
  }};
  d.fn.extend({mousewheel:function(a) {
    return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
  }, unmousewheel:function(a) {
    return this.unbind("mousewheel", a)
  }})
})(jQuery);
(function(r) {
  r.fn.qrcode = function(h) {
    var s;
    function u(a) {
      this.mode = s;
      this.data = a
    }
    function o(a, c) {
      this.typeNumber = a;
      this.errorCorrectLevel = c;
      this.modules = null;
      this.moduleCount = 0;
      this.dataCache = null;
      this.dataList = []
    }
    function q(a, c) {
      if(void 0 == a.length) {
        throw Error(a.length + "/" + c);
      }
      for(var d = 0;d < a.length && 0 == a[d];) {
        d++
      }
      this.num = Array(a.length - d + c);
      for(var b = 0;b < a.length - d;b++) {
        this.num[b] = a[b + d]
      }
    }
    function p(a, c) {
      this.totalCount = a;
      this.dataCount = c
    }
    function t() {
      this.buffer = [];
      this.length = 0
    }
    u.prototype = {getLength:function() {
      return this.data.length
    }, write:function(a) {
      for(var c = 0;c < this.data.length;c++) {
        a.put(this.data.charCodeAt(c), 8)
      }
    }};
    o.prototype = {addData:function(a) {
      this.dataList.push(new u(a));
      this.dataCache = null
    }, isDark:function(a, c) {
      if(0 > a || this.moduleCount <= a || 0 > c || this.moduleCount <= c) {
        throw Error(a + "," + c);
      }
      return this.modules[a][c]
    }, getModuleCount:function() {
      return this.moduleCount
    }, make:function() {
      if(1 > this.typeNumber) {
        for(var a = 1, a = 1;40 > a;a++) {
          for(var c = p.getRSBlocks(a, this.errorCorrectLevel), d = new t, b = 0, e = 0;e < c.length;e++) {
            b += c[e].dataCount
          }
          for(e = 0;e < this.dataList.length;e++) {
            c = this.dataList[e], d.put(c.mode, 4), d.put(c.getLength(), j.getLengthInBits(c.mode, a)), c.write(d)
          }
          if(d.getLengthInBits() <= 8 * b) {
            break
          }
        }
        this.typeNumber = a
      }
      this.makeImpl(!1, this.getBestMaskPattern())
    }, makeImpl:function(a, c) {
      this.moduleCount = 4 * this.typeNumber + 17;
      this.modules = Array(this.moduleCount);
      for(var d = 0;d < this.moduleCount;d++) {
        this.modules[d] = Array(this.moduleCount);
        for(var b = 0;b < this.moduleCount;b++) {
          this.modules[d][b] = null
        }
      }
      this.setupPositionProbePattern(0, 0);
      this.setupPositionProbePattern(this.moduleCount - 7, 0);
      this.setupPositionProbePattern(0, this.moduleCount - 7);
      this.setupPositionAdjustPattern();
      this.setupTimingPattern();
      this.setupTypeInfo(a, c);
      7 <= this.typeNumber && this.setupTypeNumber(a);
      null == this.dataCache && (this.dataCache = o.createData(this.typeNumber, this.errorCorrectLevel, this.dataList));
      this.mapData(this.dataCache, c)
    }, setupPositionProbePattern:function(a, c) {
      for(var d = -1;7 >= d;d++) {
        if(!(-1 >= a + d || this.moduleCount <= a + d)) {
          for(var b = -1;7 >= b;b++) {
            -1 >= c + b || this.moduleCount <= c + b || (this.modules[a + d][c + b] = 0 <= d && 6 >= d && (0 == b || 6 == b) || 0 <= b && 6 >= b && (0 == d || 6 == d) || 2 <= d && 4 >= d && 2 <= b && 4 >= b ? !0 : !1)
          }
        }
      }
    }, getBestMaskPattern:function() {
      for(var a = 0, c = 0, d = 0;8 > d;d++) {
        this.makeImpl(!0, d);
        var b = j.getLostPoint(this);
        if(0 == d || a > b) {
          a = b, c = d
        }
      }
      return c
    }, createMovieClip:function(a, c, d) {
      a = a.createEmptyMovieClip(c, d);
      this.make();
      for(c = 0;c < this.modules.length;c++) {
        for(var d = 1 * c, b = 0;b < this.modules[c].length;b++) {
          var e = 1 * b;
          this.modules[c][b] && (a.beginFill(0, 100), a.moveTo(e, d), a.lineTo(e + 1, d), a.lineTo(e + 1, d + 1), a.lineTo(e, d + 1), a.endFill())
        }
      }
      return a
    }, setupTimingPattern:function() {
      for(var a = 8;a < this.moduleCount - 8;a++) {
        null == this.modules[a][6] && (this.modules[a][6] = 0 == a % 2)
      }
      for(a = 8;a < this.moduleCount - 8;a++) {
        null == this.modules[6][a] && (this.modules[6][a] = 0 == a % 2)
      }
    }, setupPositionAdjustPattern:function() {
      for(var a = j.getPatternPosition(this.typeNumber), c = 0;c < a.length;c++) {
        for(var d = 0;d < a.length;d++) {
          var b = a[c], e = a[d];
          if(null == this.modules[b][e]) {
            for(var f = -2;2 >= f;f++) {
              for(var i = -2;2 >= i;i++) {
                this.modules[b + f][e + i] = -2 == f || 2 == f || -2 == i || 2 == i || 0 == f && 0 == i ? !0 : !1
              }
            }
          }
        }
      }
    }, setupTypeNumber:function(a) {
      for(var c = j.getBCHTypeNumber(this.typeNumber), d = 0;18 > d;d++) {
        var b = !a && 1 == (c >> d & 1);
        this.modules[Math.floor(d / 3)][d % 3 + this.moduleCount - 8 - 3] = b
      }
      for(d = 0;18 > d;d++) {
        b = !a && 1 == (c >> d & 1), this.modules[d % 3 + this.moduleCount - 8 - 3][Math.floor(d / 3)] = b
      }
    }, setupTypeInfo:function(a, c) {
      for(var d = j.getBCHTypeInfo(this.errorCorrectLevel << 3 | c), b = 0;15 > b;b++) {
        var e = !a && 1 == (d >> b & 1);
        6 > b ? this.modules[b][8] = e : 8 > b ? this.modules[b + 1][8] = e : this.modules[this.moduleCount - 15 + b][8] = e
      }
      for(b = 0;15 > b;b++) {
        e = !a && 1 == (d >> b & 1), 8 > b ? this.modules[8][this.moduleCount - b - 1] = e : 9 > b ? this.modules[8][15 - b - 1 + 1] = e : this.modules[8][15 - b - 1] = e
      }
      this.modules[this.moduleCount - 8][8] = !a
    }, mapData:function(a, c) {
      for(var d = -1, b = this.moduleCount - 1, e = 7, f = 0, i = this.moduleCount - 1;0 < i;i -= 2) {
        for(6 == i && i--;;) {
          for(var g = 0;2 > g;g++) {
            if(null == this.modules[b][i - g]) {
              var n = !1;
              f < a.length && (n = 1 == (a[f] >>> e & 1));
              j.getMask(c, b, i - g) && (n = !n);
              this.modules[b][i - g] = n;
              e--;
               -1 == e && (f++, e = 7)
            }
          }
          b += d;
          if(0 > b || this.moduleCount <= b) {
            b -= d;
            d = -d;
            break
          }
        }
      }
    }};
    o.PAD0 = 236;
    o.PAD1 = 17;
    o.createData = function(a, c, d) {
      for(var c = p.getRSBlocks(a, c), b = new t, e = 0;e < d.length;e++) {
        var f = d[e];
        b.put(f.mode, 4);
        b.put(f.getLength(), j.getLengthInBits(f.mode, a));
        f.write(b)
      }
      for(e = a = 0;e < c.length;e++) {
        a += c[e].dataCount
      }
      if(b.getLengthInBits() > 8 * a) {
        throw Error("code length overflow. (" + b.getLengthInBits() + ">" + 8 * a + ")");
      }
      for(b.getLengthInBits() + 4 <= 8 * a && b.put(0, 4);0 != b.getLengthInBits() % 8;) {
        b.putBit(!1)
      }
      for(;!(b.getLengthInBits() >= 8 * a);) {
        b.put(o.PAD0, 8);
        if(b.getLengthInBits() >= 8 * a) {
          break
        }
        b.put(o.PAD1, 8)
      }
      return o.createBytes(b, c)
    };
    o.createBytes = function(a, c) {
      for(var d = 0, b = 0, e = 0, f = Array(c.length), i = Array(c.length), g = 0;g < c.length;g++) {
        var n = c[g].dataCount, h = c[g].totalCount - n, b = Math.max(b, n), e = Math.max(e, h);
        f[g] = Array(n);
        for(var k = 0;k < f[g].length;k++) {
          f[g][k] = 255 & a.buffer[k + d]
        }
        d += n;
        k = j.getErrorCorrectPolynomial(h);
        n = (new q(f[g], k.getLength() - 1)).mod(k);
        i[g] = Array(k.getLength() - 1);
        for(k = 0;k < i[g].length;k++) {
          h = k + n.getLength() - i[g].length, i[g][k] = 0 <= h ? n.get(h) : 0
        }
      }
      for(k = g = 0;k < c.length;k++) {
        g += c[k].totalCount
      }
      d = Array(g);
      for(k = n = 0;k < b;k++) {
        for(g = 0;g < c.length;g++) {
          k < f[g].length && (d[n++] = f[g][k])
        }
      }
      for(k = 0;k < e;k++) {
        for(g = 0;g < c.length;g++) {
          k < i[g].length && (d[n++] = i[g][k])
        }
      }
      return d
    };
    s = 4;
    for(var j = {PATTERN_POSITION_TABLE:[[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], 
    [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]], G15:1335, G18:7973, G15_MASK:21522, getBCHTypeInfo:function(a) {
      for(var c = a << 10;0 <= j.getBCHDigit(c) - j.getBCHDigit(j.G15);) {
        c ^= j.G15 << j.getBCHDigit(c) - j.getBCHDigit(j.G15)
      }
      return(a << 10 | c) ^ j.G15_MASK
    }, getBCHTypeNumber:function(a) {
      for(var c = a << 12;0 <= j.getBCHDigit(c) - j.getBCHDigit(j.G18);) {
        c ^= j.G18 << j.getBCHDigit(c) - j.getBCHDigit(j.G18)
      }
      return a << 12 | c
    }, getBCHDigit:function(a) {
      for(var c = 0;0 != a;) {
        c++, a >>>= 1
      }
      return c
    }, getPatternPosition:function(a) {
      return j.PATTERN_POSITION_TABLE[a - 1]
    }, getMask:function(a, c, d) {
      switch(a) {
        case 0:
          return 0 == (c + d) % 2;
        case 1:
          return 0 == c % 2;
        case 2:
          return 0 == d % 3;
        case 3:
          return 0 == (c + d) % 3;
        case 4:
          return 0 == (Math.floor(c / 2) + Math.floor(d / 3)) % 2;
        case 5:
          return 0 == c * d % 2 + c * d % 3;
        case 6:
          return 0 == (c * d % 2 + c * d % 3) % 2;
        case 7:
          return 0 == (c * d % 3 + (c + d) % 2) % 2;
        default:
          throw Error("bad maskPattern:" + a);
      }
    }, getErrorCorrectPolynomial:function(a) {
      for(var c = new q([1], 0), d = 0;d < a;d++) {
        c = c.multiply(new q([1, l.gexp(d)], 0))
      }
      return c
    }, getLengthInBits:function(a, c) {
      if(1 <= c && 10 > c) {
        switch(a) {
          case 1:
            return 10;
          case 2:
            return 9;
          case s:
            return 8;
          case 8:
            return 8;
          default:
            throw Error("mode:" + a);
        }
      }else {
        if(27 > c) {
          switch(a) {
            case 1:
              return 12;
            case 2:
              return 11;
            case s:
              return 16;
            case 8:
              return 10;
            default:
              throw Error("mode:" + a);
          }
        }else {
          if(41 > c) {
            switch(a) {
              case 1:
                return 14;
              case 2:
                return 13;
              case s:
                return 16;
              case 8:
                return 12;
              default:
                throw Error("mode:" + a);
            }
          }else {
            throw Error("type:" + c);
          }
        }
      }
    }, getLostPoint:function(a) {
      for(var c = a.getModuleCount(), d = 0, b = 0;b < c;b++) {
        for(var e = 0;e < c;e++) {
          for(var f = 0, i = a.isDark(b, e), g = -1;1 >= g;g++) {
            if(!(0 > b + g || c <= b + g)) {
              for(var h = -1;1 >= h;h++) {
                0 > e + h || c <= e + h || 0 == g && 0 == h || i == a.isDark(b + g, e + h) && f++
              }
            }
          }
          5 < f && (d += 3 + f - 5)
        }
      }
      for(b = 0;b < c - 1;b++) {
        for(e = 0;e < c - 1;e++) {
          if(f = 0, a.isDark(b, e) && f++, a.isDark(b + 1, e) && f++, a.isDark(b, e + 1) && f++, a.isDark(b + 1, e + 1) && f++, 0 == f || 4 == f) {
            d += 3
          }
        }
      }
      for(b = 0;b < c;b++) {
        for(e = 0;e < c - 6;e++) {
          a.isDark(b, e) && !a.isDark(b, e + 1) && a.isDark(b, e + 2) && a.isDark(b, e + 3) && a.isDark(b, e + 4) && !a.isDark(b, e + 5) && a.isDark(b, e + 6) && (d += 40)
        }
      }
      for(e = 0;e < c;e++) {
        for(b = 0;b < c - 6;b++) {
          a.isDark(b, e) && !a.isDark(b + 1, e) && a.isDark(b + 2, e) && a.isDark(b + 3, e) && a.isDark(b + 4, e) && !a.isDark(b + 5, e) && a.isDark(b + 6, e) && (d += 40)
        }
      }
      for(e = f = 0;e < c;e++) {
        for(b = 0;b < c;b++) {
          a.isDark(b, e) && f++
        }
      }
      a = Math.abs(100 * f / c / c - 50) / 5;
      return d + 10 * a
    }}, l = {glog:function(a) {
      if(1 > a) {
        throw Error("glog(" + a + ")");
      }
      return l.LOG_TABLE[a]
    }, gexp:function(a) {
      for(;0 > a;) {
        a += 255
      }
      for(;256 <= a;) {
        a -= 255
      }
      return l.EXP_TABLE[a]
    }, EXP_TABLE:Array(256), LOG_TABLE:Array(256)}, m = 0;8 > m;m++) {
      l.EXP_TABLE[m] = 1 << m
    }
    for(m = 8;256 > m;m++) {
      l.EXP_TABLE[m] = l.EXP_TABLE[m - 4] ^ l.EXP_TABLE[m - 5] ^ l.EXP_TABLE[m - 6] ^ l.EXP_TABLE[m - 8]
    }
    for(m = 0;255 > m;m++) {
      l.LOG_TABLE[l.EXP_TABLE[m]] = m
    }
    q.prototype = {get:function(a) {
      return this.num[a]
    }, getLength:function() {
      return this.num.length
    }, multiply:function(a) {
      for(var c = Array(this.getLength() + a.getLength() - 1), d = 0;d < this.getLength();d++) {
        for(var b = 0;b < a.getLength();b++) {
          c[d + b] ^= l.gexp(l.glog(this.get(d)) + l.glog(a.get(b)))
        }
      }
      return new q(c, 0)
    }, mod:function(a) {
      if(0 > this.getLength() - a.getLength()) {
        return this
      }
      for(var c = l.glog(this.get(0)) - l.glog(a.get(0)), d = Array(this.getLength()), b = 0;b < this.getLength();b++) {
        d[b] = this.get(b)
      }
      for(b = 0;b < a.getLength();b++) {
        d[b] ^= l.gexp(l.glog(a.get(b)) + c)
      }
      return(new q(d, 0)).mod(a)
    }};
    p.RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 
    14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 116], 
    [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], [3, 
    70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 
    74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 
    117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 
    145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], 
    [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]];
    p.getRSBlocks = function(a, c) {
      var d = p.getRsBlockTable(a, c);
      if(void 0 == d) {
        throw Error("bad rs block @ typeNumber:" + a + "/errorCorrectLevel:" + c);
      }
      for(var b = d.length / 3, e = [], f = 0;f < b;f++) {
        for(var h = d[3 * f + 0], g = d[3 * f + 1], j = d[3 * f + 2], l = 0;l < h;l++) {
          e.push(new p(g, j))
        }
      }
      return e
    };
    p.getRsBlockTable = function(a, c) {
      switch(c) {
        case 1:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 0];
        case 0:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 1];
        case 3:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 2];
        case 2:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 3]
      }
    };
    t.prototype = {get:function(a) {
      return 1 == (this.buffer[Math.floor(a / 8)] >>> 7 - a % 8 & 1)
    }, put:function(a, c) {
      for(var d = 0;d < c;d++) {
        this.putBit(1 == (a >>> c - d - 1 & 1))
      }
    }, getLengthInBits:function() {
      return this.length
    }, putBit:function(a) {
      var c = Math.floor(this.length / 8);
      this.buffer.length <= c && this.buffer.push(0);
      a && (this.buffer[c] |= 128 >>> this.length % 8);
      this.length++
    }};
    "string" === typeof h && (h = {text:h});
    h = r.extend({}, {render:"canvas", width:256, height:256, typeNumber:-1, correctLevel:2, background:"#ffffff", foreground:"#000000"}, h);
    return this.each(function() {
      var a;
      if("canvas" == h.render) {
        a = new o(h.typeNumber, h.correctLevel);
        a.addData(h.text);
        a.make();
        var c = document.createElement("canvas");
        c.width = h.width;
        c.height = h.height;
        for(var d = c.getContext("2d"), b = h.width / a.getModuleCount(), e = h.height / a.getModuleCount(), f = 0;f < a.getModuleCount();f++) {
          for(var i = 0;i < a.getModuleCount();i++) {
            d.fillStyle = a.isDark(f, i) ? h.foreground : h.background;
            var g = Math.ceil((i + 1) * b) - Math.floor(i * b), j = Math.ceil((f + 1) * b) - Math.floor(f * b);
            d.fillRect(Math.round(i * b), Math.round(f * e), g, j)
          }
        }
      }else {
        a = new o(h.typeNumber, h.correctLevel);
        a.addData(h.text);
        a.make();
        c = r("<table></table>").css("width", h.width + "px").css("height", h.height + "px").css("border", "0px").css("border-collapse", "collapse").css("background-color", h.background);
        d = h.width / a.getModuleCount();
        b = h.height / a.getModuleCount();
        for(e = 0;e < a.getModuleCount();e++) {
          f = r("<tr></tr>").css("height", b + "px").appendTo(c);
          for(i = 0;i < a.getModuleCount();i++) {
            r("<td></td>").css("width", d + "px").css("background-color", a.isDark(e, i) ? h.foreground : h.background).appendTo(f)
          }
        }
      }
      a = c;
      jQuery(a).appendTo(this)
    })
  }
})(jQuery);
(function(b) {
  b.support.touch = "ontouchend" in document;
  if(!b.support.touch) {
    return
  }
  var c = b.ui.mouse.prototype, e = c._mouseInit, a;
  function d(g, h) {
    if(g.originalEvent.touches.length > 1) {
      return
    }
    g.preventDefault();
    var i = g.originalEvent.changedTouches[0], f = document.createEvent("MouseEvents");
    f.initMouseEvent(h, true, true, window, 1, i.screenX, i.screenY, i.clientX, i.clientY, false, false, false, false, 0, null);
    g.target.dispatchEvent(f)
  }
  c._touchStart = function(g) {
    var f = this;
    if(a || !f._mouseCapture(g.originalEvent.changedTouches[0])) {
      return
    }
    a = true;
    f._touchMoved = false;
    d(g, "mouseover");
    d(g, "mousemove");
    d(g, "mousedown")
  };
  c._touchMove = function(f) {
    if(!a) {
      return
    }
    this._touchMoved = true;
    d(f, "mousemove")
  };
  c._touchEnd = function(f) {
    if(!a) {
      return
    }
    d(f, "mouseup");
    d(f, "mouseout");
    if(!this._touchMoved) {
      d(f, "click")
    }
    a = false
  };
  c._mouseInit = function() {
    var f = this;
    f.element.bind("touchstart", b.proxy(f, "_touchStart")).bind("touchmove", b.proxy(f, "_touchMove")).bind("touchend", b.proxy(f, "_touchEnd"));
    e.call(f)
  }
})(jQuery);
(function(a, h, y) {
  var w = "function", v = "password", j = "maxLength", n = "type", b = "", c = true, u = "placeholder", i = false, t = "watermark", g = t, f = "watermarkClass", q = "watermarkFocus", l = "watermarkSubmit", o = "watermarkMaxLength", e = "watermarkPassword", d = "watermarkText", k = /\r/g, s = "input:data(" + g + "),textarea:data(" + g + ")", m = "input:text,input:password,input[type=search],input:not([type]),textarea", p = ["Page_ClientValidate"], r = i, x = u in document.createElement("input");
  a.watermark = a.watermark || {version:"3.1.3", runOnce:c, options:{className:t, useNative:c, hideBeforeUnload:c}, hide:function(b) {
    a(b).filter(s).each(function() {
      a.watermark._hide(a(this))
    })
  }, _hide:function(a, r) {
    var p = a[0], q = (p.value || b).replace(k, b), l = a.data(d) || b, m = a.data(o) || 0, i = a.data(f);
    if(l.length && q == l) {
      p.value = b;
      if(a.data(e)) {
        if((a.attr(n) || b) === "text") {
          var g = a.data(e) || [], c = a.parent() || [];
          if(g.length && c.length) {
            c[0].removeChild(a[0]);
            c[0].appendChild(g[0]);
            a = g
          }
        }
      }
      if(m) {
        a.attr(j, m);
        a.removeData(o)
      }
      if(r) {
        a.attr("autocomplete", "off");
        h.setTimeout(function() {
          a.select()
        }, 1)
      }
    }
    i && a.removeClass(i)
  }, show:function(b) {
    a(b).filter(s).each(function() {
      a.watermark._show(a(this))
    })
  }, _show:function(g) {
    var p = g[0], u = (p.value || b).replace(k, b), h = g.data(d) || b, s = g.attr(n) || b, t = g.data(f);
    if((u.length == 0 || u == h) && !g.data(q)) {
      r = c;
      if(g.data(e)) {
        if(s === v) {
          var m = g.data(e) || [], l = g.parent() || [];
          if(m.length && l.length) {
            l[0].removeChild(g[0]);
            l[0].appendChild(m[0]);
            g = m;
            g.attr(j, h.length);
            p = g[0]
          }
        }
      }
      if(s === "text" || s === "search") {
        var i = g.attr(j) || 0;
        if(i > 0 && h.length > i) {
          g.data(o, i);
          g.attr(j, h.length)
        }
      }
      t && g.addClass(t);
      p.value = h
    }else {
      a.watermark._hide(g)
    }
  }, hideAll:function() {
    if(r) {
      a.watermark.hide(m);
      r = i
    }
  }, showAll:function() {
    a.watermark.show(m)
  }};
  a.fn.watermark = a.fn.watermark || function(p, o) {
    var t = "string";
    if(!this.length) {
      return this
    }
    var s = i, r = typeof p === t;
    if(r) {
      p = p.replace(k, b)
    }
    if(typeof o === "object") {
      s = typeof o.className === t;
      o = a.extend({}, a.watermark.options, o)
    }else {
      if(typeof o === t) {
        s = c;
        o = a.extend({}, a.watermark.options, {className:o})
      }else {
        o = a.watermark.options
      }
    }
    if(typeof o.useNative !== w) {
      o.useNative = o.useNative ? function() {
        return c
      } : function() {
        return i
      }
    }
    return this.each(function() {
      var B = "dragleave", A = "dragenter", z = this, i = a(z);
      if(!i.is(m)) {
        return
      }
      if(i.data(g)) {
        if(r || s) {
          a.watermark._hide(i);
          r && i.data(d, p);
          s && i.data(f, o.className)
        }
      }else {
        if(x && o.useNative.call(z, i) && (i.attr("tagName") || b) !== "TEXTAREA") {
          r && i.attr(u, p);
          return
        }
        i.data(d, r ? p : b);
        i.data(f, o.className);
        i.data(g, 1);
        if((i.attr(n) || b) === v) {
          var C = i.wrap("<span>").parent(), t = a(C.html().replace(/type=["']?password["']?/i, 'type="text"'));
          t.data(d, i.data(d));
          t.data(f, i.data(f));
          t.data(g, 1);
          t.attr(j, p.length);
          t.focus(function() {
            a.watermark._hide(t, c)
          }).bind(A, function() {
            a.watermark._hide(t)
          }).bind("dragend", function() {
            h.setTimeout(function() {
              t.blur()
            }, 1)
          });
          i.blur(function() {
            a.watermark._show(i)
          }).bind(B, function() {
            a.watermark._show(i)
          });
          t.data(e, i);
          i.data(e, t)
        }else {
          i.focus(function() {
            i.data(q, 1);
            a.watermark._hide(i, c)
          }).blur(function() {
            i.data(q, 0);
            a.watermark._show(i)
          }).bind(A, function() {
            a.watermark._hide(i)
          }).bind(B, function() {
            a.watermark._show(i)
          }).bind("dragend", function() {
            h.setTimeout(function() {
              a.watermark._show(i)
            }, 1)
          }).bind("drop", function(e) {
            var c = i[0], a = e.originalEvent.dataTransfer.getData("Text");
            if((c.value || b).replace(k, b).replace(a, b) === i.data(d)) {
              c.value = a
            }
            i.focus()
          })
        }
        if(z.form) {
          var w = z.form, y = a(w);
          if(!y.data(l)) {
            y.submit(a.watermark.hideAll);
            if(w.submit) {
              y.data(l, w.submit);
              w.submit = function(c, b) {
                return function() {
                  var d = b.data(l);
                  a.watermark.hideAll();
                  if(d.apply) {
                    d.apply(c, Array.prototype.slice.call(arguments))
                  }else {
                    d()
                  }
                }
              }(w, y)
            }else {
              y.data(l, 1);
              w.submit = function(b) {
                return function() {
                  a.watermark.hideAll();
                  delete b.submit;
                  b.submit()
                }
              }(w)
            }
          }
        }
      }
      a.watermark._show(i)
    })
  };
  if(a.watermark.runOnce) {
    a.watermark.runOnce = i;
    a.extend(a.expr[":"], {data:function(c, d, b) {
      return!!a.data(c, b[3])
    }});
    (function(c) {
      a.fn.val = function() {
        var e = this;
        if(!e.length) {
          return arguments.length ? e : y
        }
        if(!arguments.length) {
          if(e.data(g)) {
            var f = (e[0].value || b).replace(k, b);
            return f === (e.data(d) || b) ? b : f
          }else {
            return c.apply(e, arguments)
          }
        }else {
          c.apply(e, arguments);
          a.watermark.show(e);
          return e
        }
      }
    })(a.fn.val);
    p.length && a(function() {
      for(var b, c, d = p.length - 1;d >= 0;d--) {
        b = p[d];
        c = h[b];
        if(typeof c === w) {
          h[b] = function(b) {
            return function() {
              a.watermark.hideAll();
              return b.apply(null, Array.prototype.slice.call(arguments))
            }
          }(c)
        }
      }
    });
    a(h).bind("beforeunload", function() {
      a.watermark.options.hideBeforeUnload && a.watermark.hideAll()
    })
  }
})(jQuery, window);
window.Modernizr = function(a, b, c) {
  function x(a) {
    j.cssText = a
  }
  function y(a, b) {
    return x(m.join(a + ";") + (b || ""))
  }
  function z(a, b) {
    return typeof a === b
  }
  function A(a, b) {
    return!!~("" + a).indexOf(b)
  }
  function B(a, b, d) {
    for(var e in a) {
      var f = b[a[e]];
      if(f !== c) {
        return d === !1 ? a[e] : z(f, "function") ? f.bind(d || b) : f
      }
    }
    return!1
  }
  var d = "2.5.2", e = {}, f = !0, g = b.documentElement, h = "modernizr", i = b.createElement(h), j = i.style, k, l = {}.toString, m = " -webkit- -moz- -o- -ms- ".split(" "), n = {}, o = {}, p = {}, q = [], r = q.slice, s, t = function(a, c, d, e) {
    var f, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body");
    if(parseInt(d, 10)) {
      while(d--) {
        j = b.createElement("div"), j.id = e ? e[d] : h + (d + 1), k.appendChild(j)
      }
    }
    return f = ["&#173;", "<style>", a, "</style>"].join(""), k.id = h, m.innerHTML += f, m.appendChild(k), l || g.appendChild(m), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i
  }, u = function(b) {
    var c = a.matchMedia || a.msMatchMedia;
    if(c) {
      return c(b).matches
    }
    var d;
    return t("@media " + b + " { #" + h + " { position: absolute; } }", function(b) {
      d = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle)["position"] == "absolute"
    }), d
  }, v = {}.hasOwnProperty, w;
  !z(v, "undefined") && !z(v.call, "undefined") ? w = function(a, b) {
    return v.call(a, b)
  } : w = function(a, b) {
    return b in a && z(a.constructor.prototype[b], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(b) {
    var c = this;
    if(typeof c != "function") {
      throw new TypeError;
    }
    var d = r.call(arguments, 1), e = function() {
      if(this instanceof e) {
        var a = function() {
        };
        a.prototype = c.prototype;
        var f = new a, g = c.apply(f, d.concat(r.call(arguments)));
        return Object(g) === g ? g : f
      }
      return c.apply(b, d.concat(r.call(arguments)))
    };
    return e
  });
  var C = function(c, d) {
    var f = c.join(""), g = d.length;
    t(f, function(c, d) {
      var f = b.styleSheets[b.styleSheets.length - 1], h = f ? f.cssRules && f.cssRules[0] ? f.cssRules[0].cssText : f.cssText || "" : "", i = c.childNodes, j = {};
      while(g--) {
        j[i[g].id] = i[g]
      }
      e.touch = "ontouchstart" in a || a.DocumentTouch && b instanceof DocumentTouch || (j.touch && j.touch.offsetTop) === 9
    }, g, d)
  }([, ["@media (", m.join("touch-enabled),("), h, ")", "{#touch{top:9px;position:absolute}}"].join("")], [, "touch"]);
  n.touch = function() {
    return e.touch
  };
  for(var D in n) {
    w(n, D) && (s = D.toLowerCase(), e[s] = n[D](), q.push((e[s] ? "" : "no-") + s))
  }
  return e.addTest = function(a, b) {
    if(typeof a == "object") {
      for(var d in a) {
        w(a, d) && e.addTest(d, a[d])
      }
    }else {
      a = a.toLowerCase();
      if(e[a] !== c) {
        return e
      }
      b = typeof b == "function" ? b() : b, g.className += " " + (b ? "" : "no-") + a, e[a] = b
    }
    return e
  }, x(""), i = k = null, e._version = d, e._prefixes = m, e.mq = u, e.testStyles = t, g.className = g.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (f ? " js " + q.join(" ") : ""), e
}(this, this.document), function(a, b, c) {
  function d(a) {
    return o.call(a) == "[object Function]"
  }
  function e(a) {
    return typeof a == "string"
  }
  function f() {
  }
  function g(a) {
    return!a || a == "loaded" || a == "complete" || a == "uninitialized"
  }
  function h() {
    var a = p.shift();
    q = 1, a ? a.t ? m(function() {
      (a.t == "c" ? B.injectCss : B.injectJs)(a.s, 0, a.a, a.x, a.e, 1)
    }, 0) : (a(), h()) : q = 0
  }
  function i(a, c, d, e, f, i, j) {
    function k(b) {
      if(!o && g(l.readyState) && (u.r = o = 1, !q && h(), l.onload = l.onreadystatechange = null, b)) {
        a != "img" && m(function() {
          t.removeChild(l)
        }, 50);
        for(var d in y[c]) {
          y[c].hasOwnProperty(d) && y[c][d].onload()
        }
      }
    }
    var j = j || B.errorTimeout, l = {}, o = 0, r = 0, u = {t:d, s:c, e:f, a:i, x:j};
    y[c] === 1 && (r = 1, y[c] = [], l = b.createElement(a)), a == "object" ? l.data = c : (l.src = c, l.type = a), l.width = l.height = "0", l.onerror = l.onload = l.onreadystatechange = function() {
      k.call(this, r)
    }, p.splice(e, 0, u), a != "img" && (r || y[c] === 2 ? (t.insertBefore(l, s ? null : n), m(k, j)) : y[c].push(l))
  }
  function j(a, b, c, d, f) {
    return q = 0, b = b || "j", e(a) ? i(b == "c" ? v : u, a, b, this.i++, c, d, f) : (p.splice(this.i++, 0, a), p.length == 1 && h()), this
  }
  function k() {
    var a = B;
    return a.loader = {load:j, i:0}, a
  }
  var l = b.documentElement, m = a.setTimeout, n = b.getElementsByTagName("script")[0], o = {}.toString, p = [], q = 0, r = "MozAppearance" in l.style, s = r && !!b.createRange().compareNode, t = s ? l : n.parentNode, l = !!b.attachEvent, u = r ? "object" : l ? "script" : "img", v = l ? "script" : u, w = Array.isArray || function(a) {
    return o.call(a) == "[object Array]"
  }, x = [], y = {}, z = {timeout:function(a, b) {
    return b.length && (a.timeout = b[0]), a
  }}, A, B;
  B = function(a) {
    function b(a) {
      var a = a.split("!"), b = x.length, c = a.pop(), d = a.length, c = {url:c, origUrl:c, prefixes:a}, e, f, g;
      for(f = 0;f < d;f++) {
        g = a[f].split("="), (e = z[g.shift()]) && (c = e(c, g))
      }
      for(f = 0;f < b;f++) {
        c = x[f](c)
      }
      return c
    }
    function g(a, e, f, g, i) {
      var j = b(a), l = j.autoCallback;
      j.url.split(".").pop().split("?").shift(), j.bypass || (e && (e = d(e) ? e : e[a] || e[g] || e[a.split("/").pop().split("?")[0]] || h), j.instead ? j.instead(a, e, f, g, i) : (y[j.url] ? j.noexec = !0 : y[j.url] = 1, f.load(j.url, j.forceCSS || !j.forceJS && "css" == j.url.split(".").pop().split("?").shift() ? "c" : c, j.noexec, j.attrs, j.timeout), (d(e) || d(l)) && f.load(function() {
        k(), e && e(j.origUrl, i, g), l && l(j.origUrl, i, g), y[j.url] = 2
      })))
    }
    function i(a, b) {
      function c(a, c) {
        if(a) {
          if(e(a)) {
            c || (j = function() {
              var a = [].slice.call(arguments);
              k.apply(this, a), l()
            }), g(a, j, b, 0, h)
          }else {
            if(Object(a) === a) {
              for(n in m = function() {
                var b = 0, c;
                for(c in a) {
                  a.hasOwnProperty(c) && b++
                }
                return b
              }(), a) {
                a.hasOwnProperty(n) && (!c && !--m && (d(j) ? j = function() {
                  var a = [].slice.call(arguments);
                  k.apply(this, a), l()
                } : j[n] = function(a) {
                  return function() {
                    var b = [].slice.call(arguments);
                    a && a.apply(this, b), l()
                  }
                }(k[n])), g(a[n], j, b, n, h))
              }
            }
          }
        }else {
          !c && l()
        }
      }
      var h = !!a.test, i = a.load || a.both, j = a.callback || f, k = j, l = a.complete || f, m, n;
      c(h ? a.yep : a.nope, !!i), i && c(i)
    }
    var j, l, m = this.yepnope.loader;
    if(e(a)) {
      g(a, 0, m, 0)
    }else {
      if(w(a)) {
        for(j = 0;j < a.length;j++) {
          l = a[j], e(l) ? g(l, 0, m, 0) : w(l) ? B(l) : Object(l) === l && i(l, m)
        }
      }else {
        Object(a) === a && i(a, m)
      }
    }
  }, B.addPrefix = function(a, b) {
    z[a] = b
  }, B.addFilter = function(a) {
    x.push(a)
  }, B.errorTimeout = 1E4, b.readyState == null && b.addEventListener && (b.readyState = "loading", b.addEventListener("DOMContentLoaded", A = function() {
    b.removeEventListener("DOMContentLoaded", A, 0), b.readyState = "complete"
  }, 0)), a.yepnope = k(), a.yepnope.executeStack = h, a.yepnope.injectJs = function(a, c, d, e, i, j) {
    var k = b.createElement("script"), l, o, e = e || B.errorTimeout;
    k.src = a;
    for(o in d) {
      k.setAttribute(o, d[o])
    }
    c = j ? h : c || f, k.onreadystatechange = k.onload = function() {
      !l && g(k.readyState) && (l = 1, c(), k.onload = k.onreadystatechange = null)
    }, m(function() {
      l || (l = 1, c(1))
    }, e), i ? k.onload() : n.parentNode.insertBefore(k, n)
  }, a.yepnope.injectCss = function(a, c, d, e, g, i) {
    var e = b.createElement("link"), j, c = i ? h : c || f;
    e.href = a, e.rel = "stylesheet", e.type = "text/css";
    for(j in d) {
      e.setAttribute(j, d[j])
    }
    g || (n.parentNode.insertBefore(e, n), m(c, 0))
  }
}(this, document), Modernizr.load = function() {
  yepnope.apply(window, [].slice.call(arguments, 0))
}, Modernizr.addTest("ie8compat", function() {
  return!window.addEventListener && document.documentMode && document.documentMode === 7
});
window.Modernizr = function(a, b, c) {
  function v(a) {
    i.cssText = a
  }
  function w(a, b) {
    return v(prefixes.join(a + ";") + (b || ""))
  }
  function x(a, b) {
    return typeof a === b
  }
  function y(a, b) {
    return!!~("" + a).indexOf(b)
  }
  function z(a, b, d) {
    for(var e in a) {
      var f = b[a[e]];
      if(f !== c) {
        return d === !1 ? a[e] : x(f, "function") ? f.bind(d || b) : f
      }
    }
    return!1
  }
  var d = "2.5.3", e = {}, f = b.documentElement, g = "modernizr", h = b.createElement(g), i = h.style, j, k = {}.toString, l = {}, m = {}, n = {}, o = [], p = o.slice, q, r = function(a, c, d, e) {
    var h, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body");
    if(parseInt(d, 10)) {
      while(d--) {
        j = b.createElement("div"), j.id = e ? e[d] : g + (d + 1), k.appendChild(j)
      }
    }
    return h = ["&#173;", "<style>", a, "</style>"].join(""), k.id = g, (l ? k : m).innerHTML += h, m.appendChild(k), l || (m.style.background = "", f.appendChild(m)), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i
  }, s = function(b) {
    var c = a.matchMedia || a.msMatchMedia;
    if(c) {
      return c(b).matches
    }
    var d;
    return r("@media " + b + " { #" + g + " { position: absolute; } }", function(b) {
      d = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle)["position"] == "absolute"
    }), d
  }, t = {}.hasOwnProperty, u;
  !x(t, "undefined") && !x(t.call, "undefined") ? u = function(a, b) {
    return t.call(a, b)
  } : u = function(a, b) {
    return b in a && x(a.constructor.prototype[b], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(b) {
    var c = this;
    if(typeof c != "function") {
      throw new TypeError;
    }
    var d = p.call(arguments, 1), e = function() {
      if(this instanceof e) {
        var a = function() {
        };
        a.prototype = c.prototype;
        var f = new a, g = c.apply(f, d.concat(p.call(arguments)));
        return Object(g) === g ? g : f
      }
      return c.apply(b, d.concat(p.call(arguments)))
    };
    return e
  });
  for(var A in l) {
    u(l, A) && (q = A.toLowerCase(), e[q] = l[A](), o.push((e[q] ? "" : "no-") + q))
  }
  return v(""), h = j = null, e._version = d, e.mq = s, e.testStyles = r, e
}(this, this.document);
(function($) {
  $.widget("ui.tagit", {options:{tagSource:[], triggerKeys:["enter", "space", "comma", "tab"], initialTags:[], minLength:1, select:false, allowNewTags:true, caseSensitive:false, sortable:false, highlightOnExistColor:"#0F0", emptySearch:true, watermarkAllowMessage:"Add tags", watermarkDenyMessage:"Tags limit reached", tagsChanged:function(tagValue, action, element) {
  }}, _splitAt:/\ |,/g, _existingAtIndex:0, _pasteMetaKeyPressed:false, _keys:{backspace:[8], enter:[13], space:[32], comma:[44, 188], tab:[9]}, _sortable:{sorting:-1}, _create:function() {
    var self = this;
    this.tagsArray = [];
    this.timer = null;
    this.element.addClass("tagit");
    this.element.children("li").each(function() {
      var tag = $(this);
      var tagValue = tag.attr("tagValue");
      self.options.initialTags.push({label:tag.text(), value:tagValue ? tagValue : tag.text()})
    });
    self._splitAt = null;
    if($.inArray("space", self.options.triggerKeys) > 0 && $.inArray("comma", self.options.triggerKeys) > 0) {
      self._splitAt = /\ |,/g
    }else {
      if($.inArray("space", self.options.triggerKeys) > 0) {
        self._splitAt = /\ /g
      }else {
        if($.inArray("comma", self.options.triggerKeys) > 0) {
          self._splitAt = /,/g
        }
      }
    }
    this.element.html('<li class="tagit-new"><input class="tagit-input" type="text" /></li>');
    this.input = this.element.find(".tagit-input");
    if(typeof $().watermark == "function") {
      this.input.watermark(this.options.watermarkAllowMessage)
    }
    $(this.element).click(function(e) {
      if($(e.target).hasClass("tagit-close")) {
        var parent = $(e.target).parent();
        var tag = self.tagsArray[parent.index()];
        tag.element.remove();
        self._popTag(tag)
      }else {
        self.input.focus();
        if(self.options.emptySearch && $(e.target).hasClass("tagit-input") && self.input.val() == "" && self.input.autocomplete != undefined) {
          self.input.autocomplete("search")
        }
      }
    });
    var os = this.options.select;
    this.options.appendTo = this.element;
    this.options.source = this.options.tagSource;
    this.options.select = function(event, ui) {
      self.input.data("autoCompleteTag", true);
      clearTimeout(self.timer);
      if(ui.item.label === undefined) {
        self._addTag(ui.item.value)
      }else {
        self._addTag(ui.item.label, ui.item.value)
      }
      event.stopPropagation();
      return false
    };
    this.options.focus = function(event, ui) {
      if(ui.item.label !== undefined && /^key/.test(event.originalEvent.originalEvent.type)) {
        self.input.val(ui.item.label);
        self.input.attr("tagValue", ui.item.value);
        return false
      }
    };
    this.options.autoFocus = !this.options.allowNewTags;
    this.input.autocomplete(this.options);
    this.options.select = os;
    this.input.keydown(function(e) {
      var lastLi = self.element.children(".tagit-choice:last");
      if(e.which == self._keys.backspace) {
        return self._backspace(lastLi)
      }
      if(self._isInitKey(e.which) && !(self._isTabKey(e.which) && this.value == "" && !self.input.data("autoCompleteTag"))) {
        e.preventDefault();
        self.input.data("autoCompleteTag", false);
        if(self.options.allowNewTags && $(this).val().length >= self.options.minLength) {
          self._addTag($(this).val())
        }
      }
      if(self.options.maxLength !== undefined && self.input.val().length == self.options.maxLength) {
        e.preventDefault()
      }
      if(lastLi.hasClass("selected")) {
        lastLi.removeClass("selected")
      }
      _pasteMetaKeyPressed = e.metaKey;
      self.lastKey = e.which
    });
    this.input.keyup(function(e) {
      if(_pasteMetaKeyPressed && (e.which == 91 || e.which == 86)) {
        $(this).blur()
      }
      window.setTimeout(function() {
        _pasteMetaKeyPressed = e.metaKey
      }, 250)
    });
    this.input.blur(function(e) {
      self.currentLabel = $(this).val();
      self.currentValue = $(this).attr("tagValue");
      if(self.options.allowNewTags && self.currentLabel) {
        self.timer = setTimeout(function() {
          self._addTag(self.currentLabel, self.currentValue);
          self.currentValue = "";
          self.currentLabel = ""
        }, 400)
      }
      $(this).val("").removeAttr("tagValue");
      return true
    });
    if(!String.prototype.trim) {
      String.prototype.trim = function() {
        return this.replace(/^\s+|\s+$/g, "")
      }
    }
    if(this.options.select) {
      this.select = $('<select class="tagit-hiddenSelect" name="' + this.element.attr("name") + '" multiple="multiple"></select>');
      this.element.after(this.select)
    }
    this._initialTags();
    if(self.options.sortable !== false) {
      var soptions = {items:".tagit-choice", containment:"parent", opacity:0.6, tolerance:"pointer", start:function(event, ui) {
        self._sortable.tag = $(ui.item);
        self._sortable.origIndex = self._sortable.tag.index()
      }, update:function(event, ui) {
        self._sortable.newIndex = self._sortable.tag.index();
        self._moveTag(self._sortable.origIndex, self._sortable.newIndex);
        if(self.options.tagsChanged) {
          var tag = self.tagsArray[self._sortable.newIndex];
          self.options.tagsChanged(tag.value, "moved", tag.element)
        }
      }};
      if(self.options.sortable == "handle") {
        soptions.handle = "a.ui-icon";
        soptions.cursor = "move"
      }
      self.element.sortable(soptions)
    }
  }, _popSelect:function(tag) {
    $("option:eq(" + tag.index + ")", this.select).remove();
    this.select.change()
  }, _addSelect:function(tag) {
    this.select.append('<option selected="selected" value="' + tag.value + '">' + tag.label + "</option>");
    this.select.change()
  }, _popTag:function(tag) {
    if(tag === undefined) {
      tag = this.tagsArray.pop()
    }else {
      this.tagsArray.splice(tag.index, 1)
    }
    if(typeof $().watermark == "function") {
      this.input.watermark(this.options.watermarkAllowMessage)
    }
    for(var ind in this.tagsArray) {
      this.tagsArray[ind].index = ind
    }
    if(this.options.select) {
      this._popSelect(tag)
    }
    if(this.options.tagsChanged) {
      this.options.tagsChanged(tag.value || tag.label, "popped", null)
    }
    return
  }, _addTag:function(label, value) {
    if(this.tagsArray.length > this.options.maxTags - 1) {
      $(this.input).blur();
      return false
    }
    this.input.autocomplete("close").val("");
    if(this._splitAt && label.search(this._splitAt) > 0) {
      var result = label.split(this._splitAt);
      for(var i = 0;i < result.length;i++) {
        this._addTag(result[i], value)
      }
      return
    }
    label = label.replace(/,+$/, "").trim();
    if(label == "") {
      return false
    }
    var tagExists = this._exists(label, value);
    if(tagExists !== false) {
      this._highlightExisting(tagExists);
      return false
    }
    if(this.tagsArray.length == this.options.maxTags - 1) {
      if(typeof $().watermark == "function") {
        this.input.watermark(this.options.watermarkDenyMessage)
      }
      $(this.input).blur()
    }
    var tag = this.tag(label, value);
    tag.element = $('<li class="tagit-choice"' + (value !== undefined ? ' tagValue="' + value + '"' : "") + ">" + (this.options.sortable == "handle" ? '<a class="ui-icon ui-icon-grip-dotted-vertical" style="float:left"></a>' : "") + label + '<a class="tagit-close">x</a></li>');
    tag.element.insertBefore(this.input.parent());
    this.tagsArray.push(tag);
    this.input.val("");
    if(this.options.select) {
      this._addSelect(tag)
    }
    if(this.options.tagsChanged) {
      this.options.tagsChanged(tag.label, "added", tag.element)
    }
    return true
  }, _removeTagWithValue:function(label, value) {
    var index = this._exists(label, value);
    if(index != false) {
      var tag = this.tagsArray[index];
      tag.element.remove();
      this._popTag(tag)
    }
  }, _exists:function(label, value) {
    if(this.tagsArray.length == 0) {
      return false
    }
    label = this._lowerIfCaseInsensitive(label);
    value = this._lowerIfCaseInsensitive(value);
    for(var ind in this.tagsArray) {
      if(this._lowerIfCaseInsensitive(this.tagsArray[ind].label) == label) {
        if(value !== undefined) {
          if(this._lowerIfCaseInsensitive(this.tagsArray[ind].value) == value) {
            return ind
          }
        }else {
          return ind
        }
      }
    }
    return false
  }, _highlightExisting:function(index) {
    if(this.options.highlightOnExistColor === undefined) {
      return
    }
    var tag = this.tagsArray[index];
    tag.element.stop();
    var initialColor = tag.element.css("color");
    tag.element.animate({color:this.options.highlightOnExistColor}, 100).animate({"color":initialColor}, 800)
  }, _isInitKey:function(keyCode) {
    var keyName = "";
    for(var key in this._keys) {
      if($.inArray(keyCode, this._keys[key]) != -1) {
        keyName = key
      }
    }
    if($.inArray(keyName, this.options.triggerKeys) != -1) {
      return true
    }
    return false
  }, _isTabKey:function(keyCode) {
    var tabKeys = this._keys["tab"];
    return $.inArray(keyCode, tabKeys) > -1
  }, _removeTag:function() {
    this._popTag();
    this.element.children(".tagit-choice:last").remove()
  }, _backspace:function(li) {
    if(this.input.val() == "") {
      if(this.lastKey == this._keys.backspace) {
        this._popTag();
        li.remove();
        this.lastKey = null
      }else {
        li.addClass("selected");
        this.lastKey = this._keys.backspace
      }
    }
    return true
  }, _initialTags:function() {
    var input = this;
    var _temp;
    if(this.options.tagsChanged) {
      _temp = this.options.tagsChanged
    }
    this.options.tagsChanged = null;
    if(this.options.initialTags.length != 0) {
      $(this.options.initialTags).each(function(i, element) {
        if(typeof element == "object") {
          input._addTag(element.label, element.value)
        }else {
          input._addTag(element)
        }
      })
    }
    this.options.tagsChanged = _temp
  }, _lowerIfCaseInsensitive:function(inp) {
    if(inp === undefined || typeof inp != typeof"a") {
      return inp
    }
    if(this.options.caseSensitive) {
      return inp
    }
    return inp.toLowerCase()
  }, _moveTag:function(old_index, new_index) {
    this.tagsArray.splice(new_index, 0, this.tagsArray.splice(old_index, 1)[0]);
    for(var ind in this.tagsArray) {
      this.tagsArray[ind].index = ind
    }
    if(this.options.select) {
      $("option:eq(" + old_index + ")", this.select).insertBefore($("option:eq(" + new_index + ")", this.select))
    }
  }, tags:function() {
    return this.tagsArray
  }, destroy:function() {
    $.Widget.prototype.destroy.apply(this, arguments);
    this.tagsArray = []
  }, reset:function() {
    this.element.find(".tagit-choice").remove();
    this.tagsArray = [];
    if(this.options.select) {
      this.select.children().remove();
      this.select.change()
    }
    this._initialTags();
    if(this.options.tagsChanged) {
      this.options.tagsChanged(null, "reset", null)
    }
    if(typeof $().watermark == "function") {
      this.input.watermark(this.options.watermarkAllowMessage)
    }
  }, fill:function(tags) {
    if(tags !== undefined) {
      this.options.initialTags = tags
    }
    this.reset()
  }, add:function(label, value) {
    if(typeof label == "object") {
      return this._addTag({label:label, value:value})
    }else {
      return this._addTag(label, value)
    }
  }, remove:function(value) {
    this._removeTagWithValue(value, value)
  }, tag:function(label, value, element) {
    var self = this;
    return{label:label, value:value === undefined ? label : value, element:element, index:self.tagsArray.length}
  }})
})(jQuery);
if(!window["YT"]) {
  var YT = {}
}
if(!YT.Player) {
  (function() {
    var a = document.createElement("script");
    a.src = "https:" + "//s.ytimg.com/yts/jsbin/www-widgetapi-vflop0WbJ.js";
    a.async = true;
    var b = document.getElementsByTagName("script")[0];
    b.parentNode.insertBefore(a, b)
  })()
}
;VISH.Renderer = function(V, $, undefined) {
  var SLIDE_CONTAINER = null;
  var init = function() {
    SLIDE_CONTAINER = $(".slides");
    V.Renderer.Filter.init()
  };
  var renderSlide = function(slide, extra_classes, extra_buttons, slidenumber) {
    var article;
    if(!extra_classes) {
      var extra_classes = ""
    }
    if(!extra_buttons) {
      var extra_buttons = ""
    }
    switch(slide.type) {
      case undefined:
      ;
      case V.Constant.STANDARD:
      ;
      case V.Constant.QUIZ_SIMPLE:
        article = _renderStandardSlide(slide, extra_classes, extra_buttons, slidenumber);
        break;
      case V.Constant.FLASHCARD:
        article = _renderFlashcardSlide(slide, extra_classes, extra_buttons, slidenumber);
        break;
      case V.Constant.VTOUR:
        article = _renderVirtualTourSlide(slide, extra_classes, extra_buttons, slidenumber);
        break;
      default:
        article = null;
        break
    }
    if(article) {
      SLIDE_CONTAINER.append($(article));
      _afterDrawSlide(slide)
    }
  };
  var _renderStandardSlide = function(slide, extra_classes, extra_buttons) {
    var content = "";
    var classes = "";
    if(typeof extra_classes == "undefined" || extra_classes === null) {
      extra_classes = ""
    }
    for(el in slide.elements) {
      if(!V.Renderer.Filter.allowElement(slide.elements[el])) {
        content += V.Renderer.Filter.renderContentFiltered(slide.elements[el], slide.template)
      }else {
        if(slide.elements[el].type === V.Constant.TEXT) {
          content += _renderText(slide.elements[el], slide.template)
        }else {
          if(slide.elements[el].type === V.Constant.IMAGE) {
            content += _renderImage(slide.elements[el], slide.template)
          }else {
            if(slide.elements[el].type === V.Constant.VIDEO) {
              content += renderVideo(slide.elements[el], slide.template)
            }else {
              if(slide.elements[el].type === V.Constant.OBJECT) {
                content += _renderObject(slide.elements[el], slide.template);
                classes += "object "
              }else {
                if(slide.elements[el].type === V.Constant.SNAPSHOT) {
                  content += _renderSnapshot(slide.elements[el], slide.template);
                  classes += "snapshot "
                }else {
                  if(slide.elements[el].type === V.Constant.APPLET) {
                    content += _renderApplet(slide.elements[el], slide.template);
                    classes += "applet "
                  }else {
                    if(slide.elements[el].type === V.Constant.QUIZ) {
                      content += V.Quiz.render(slide.elements[el], slide.template);
                      classes += V.Constant.QUIZ
                    }else {
                      content += _renderEmpty(slide.elements[el], slide.template)
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    return"<article class='" + extra_classes + " " + classes + "' type='" + V.Constant.STANDARD + "' id='" + slide.id + "'>" + extra_buttons + content + "</article>"
  };
  var _renderFlashcardSlide = function(slide, extra_classes, extra_buttons, slidenumber) {
    var all_slides = "";
    for(index in slide.slides) {
      var subslide = slide.slides[index];
      all_slides += _renderStandardSlide(subslide, "hide_in_smartcard", "<div class='close_subslide' id='close" + subslide.id + "'></div>")
    }
    return $("<article class='" + extra_classes + "' slidenumber='" + slidenumber + "' type='" + V.Constant.FLASHCARD + "' avatar='" + slide.background + "' id='" + slide.id + "'>" + extra_buttons + all_slides + "</article>")
  };
  var _renderVirtualTourSlide = function(slide, extra_classes, extra_buttons, slidenumber) {
    var all_slides = "";
    for(index in slide.slides) {
      var subslide = slide.slides[index];
      all_slides += _renderStandardSlide(subslide, "hide_in_smartcard", "<div class='close_subslide' id='close" + subslide.id + "'></div>")
    }
    return $("<article class='" + extra_classes + "' slidenumber='" + slidenumber + "' type='" + V.Constant.VTOUR + "' id='" + slide.id + "'>" + extra_buttons + all_slides + "</article>")
  };
  var _afterDrawSlide = function(slide) {
    switch(slide.type) {
      case undefined:
      ;
      case V.Constant.STANDARD:
        break;
      case V.Constant.FLASHCARD:
        $("#" + slide.id).css("background-image", slide.background);
        for(index in slide.pois) {
          var poi = slide.pois[index];
          V.Flashcard.addArrow(slide.id, poi, true)
        }
        break;
      case V.Constant.VTOUR:
        V.VirtualTour.drawMap(slide);
        break;
      default:
        break
    }
  };
  var _renderText = function(element, template) {
    return"<div id='" + element["id"] + "' class='VEtextArea " + template + "_" + element["areaid"] + " " + template + "_text" + "'>" + element["body"] + "</div>"
  };
  var _renderEmpty = function(element, template) {
    return"<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + " " + template + "_text" + "'></div>"
  };
  var _renderImage = function(element, template) {
    if(typeof element["style"] == "undefined") {
      style = "max-height: 100%; max-width: 100%;"
    }else {
      style = element["style"]
    }
    var div = $("<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + "'></div>");
    var img = $("<img class='" + template + "_image' src='" + element["body"] + "' style='" + style + "' />");
    if(element["hyperlink"]) {
      var a = $("<a href='" + element["hyperlink"] + "' target='blank_'></a>");
      $(a).append(img);
      $(div).append(a)
    }else {
      $(div).append(img)
    }
    return V.Utils.getOuterHTML(div)
  };
  var renderVideo = function(element, template) {
    var rendered = "<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + "'>";
    var style = element["style"] ? "style='" + element["style"] + "'" : "";
    var controls = element["controls"] ? "controls='" + element["controls"] + "' " : "controls='controls' ";
    var autoplay = element["autoplay"] ? "autoplayonslideenter='" + element["autoplay"] + "' " : "";
    var poster = element["poster"] ? "poster='" + element["poster"] + "' " : "";
    var loop = element["loop"] ? "loop='loop' " : "";
    var sources = element["sources"];
    var videoId = V.Utils.getId();
    if(typeof sources == "string") {
      sources = JSON.parse(sources)
    }
    rendered = rendered + "<video id='" + videoId + "' class='" + template + "_video' preload='metadata' " + style + controls + autoplay + poster + loop + ">";
    $.each(sources, function(index, source) {
      var type = source.type ? "type='" + source.type + "' " : "";
      rendered = rendered + "<source src='" + source.src + "' " + type + ">"
    });
    if(sources.length > 0) {
      rendered = rendered + "<p>Your browser does not support HTML5 video.</p>"
    }
    rendered = rendered + "</video>";
    return rendered
  };
  var _renderObject = function(element, template) {
    var objectInfo = V.Object.getObjectInfo(element.body);
    switch(objectInfo.type) {
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        return _renderYoutubeVideo(element, template, objectInfo.source);
        break;
      default:
        var style = element["style"] ? element["style"] : "";
        var body = element["body"];
        var zoomInStyle = element["zoomInStyle"] ? element["zoomInStyle"] : "";
        return"<div id='" + element["id"] + "' class='objectelement " + template + "_" + element["areaid"] + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' objectWrapper='" + body + "'>" + "" + "</div>";
        break
    }
  };
  var _renderYoutubeVideo = function(element, template, source) {
    var ytContainerId = V.Utils.getId();
    var style = element["style"] ? element["style"] : "";
    var body = element["body"];
    var zoomInStyle = element["zoomInStyle"] ? element["zoomInStyle"] : "";
    return"<div id='" + element["id"] + "' class='objectelement youtubeelement " + template + "_" + element["areaid"] + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' source='" + source + "' ytContainerId='" + ytContainerId + "'>" + "</div>"
  };
  var _renderSnapshot = function(element, template) {
    var style = element["style"] ? element["style"] : "";
    var body = element["body"];
    var scrollTop = element["scrollTop"] ? element["scrollTop"] : 0;
    var scrollLeft = element["scrollLeft"] ? element["scrollLeft"] : 0;
    return"<div id='" + element["id"] + "' class='snapshotelement " + template + "_" + element["areaid"] + "' template='" + template + "' objectStyle='" + style + "' scrollTop='" + scrollTop + "' scrollTopOrigin='" + scrollTop + "' scrollLeft='" + scrollLeft + "' scrollLeftOrigin='" + scrollLeft + "' objectWrapper='" + body + "'>" + "" + "</div>"
  };
  var _renderApplet = function(element, template) {
    return"<div id='" + element["id"] + "' class='appletelement " + template + "_" + element["areaid"] + "' code='" + element["code"] + "' width='" + element["width"] + "' height='" + element["height"] + "' archive='" + element["archive"] + "' params='" + element["params"] + "' ></div>"
  };
  return{init:init, renderVideo:renderVideo, renderSlide:renderSlide}
}(VISH, jQuery);
VISH.Status = function(V, $, undefined) {
  var _device;
  var _isInIframe;
  var _isAnotherDomain;
  var _isOnline;
  var _isSlave;
  var _isPreventDefault;
  var _isVEFocused;
  var _isWindowFocused;
  var _isCKEditorInstanceFocused;
  var init = function(callback) {
    _checkIframe();
    _checkDomain();
    _isVEFocused = false;
    _isWindowFocused = false;
    _isCKEditorInstanceFocused = false;
    V.Status.Device.init(function(returnedDevice) {
      _device = returnedDevice;
      _checkOnline();
      if(typeof callback === "function") {
        callback()
      }
    })
  };
  var _checkIframe = function() {
    _isInIframe = window.location != window.parent.location ? true : false;
    return _isInIframe
  };
  var _checkDomain = function() {
    _isAnotherDomain = false;
    if(_checkIframe()) {
      try {
        var parent = window.parent;
        while(parent != window.top) {
          if(typeof parent.location.href === "undefined") {
            _isAnotherDomain = true;
            break
          }else {
            parent = parent.parent
          }
        }
        if(typeof window.top.location.href === "undefined") {
          _isAnotherDomain = true
        }
      }catch(e) {
        _isAnotherDomain = true
      }
    }
    return _isAnotherDomain
  };
  var _checkOnline = function() {
    $.ajax({async:true, cache:false, error:function(req, status, ex) {
      V.Debugging.log("Error: " + ex);
      _isOnline = false
    }, success:function(data, status, req) {
      _isOnline = true
    }, timeout:5E3, type:"GET", url:V.ImagesPath + "blank.gif"})
  };
  var getDevice = function() {
    return _device
  };
  var getIsEmbed = function() {
    return _isAnotherDomain
  };
  var getIsInIframe = function() {
    return _isInIframe
  };
  var getIframe = function() {
    if(_isInIframe && !_isAnotherDomain) {
      return window.frameElement
    }else {
      return null
    }
  };
  var isOnline = function() {
    return _isOnline
  };
  var isSlaveMode = function() {
    if(typeof _isSlave !== "undefined") {
      return _isSlave
    }else {
      return false
    }
  };
  var setSlaveMode = function(slaveMode) {
    if(slaveMode !== _isSlave) {
      if(slaveMode === true) {
        V.Events.unbindViewerEventListeners();
        V.VideoPlayer.HTML5.showControls(false);
        _isSlave = true
      }else {
        V.Events.bindViewerEventListeners();
        V.VideoPlayer.HTML5.showControls(true);
        _isSlave = false
      }
    }
  };
  var isPreventDefaultMode = function() {
    if(typeof _isPreventDefault !== "undefined") {
      return _isPreventDefault
    }else {
      return false
    }
  };
  var setPreventDefaultMode = function(preventDefault) {
    if(preventDefault !== _isPreventDefault) {
      if(preventDefault === true) {
        _isPreventDefault = true
      }else {
        _isPreventDefault = false
      }
    }
  };
  var setWindowFocus = function(focus) {
    if(typeof focus == "boolean") {
      _isWindowFocused = focus;
      _updateFocus(!focus)
    }
  };
  var setCKEditorInstanceFocused = function(focus) {
    if(typeof focus == "boolean") {
      _isCKEditorInstanceFocused = focus;
      _updateFocus(!focus)
    }
  };
  var _updateFocus = function(delayUpdate) {
    if(delayUpdate === true) {
      setTimeout(function() {
        _updateFocus()
      }, 100);
      return
    }
    var updatedFocus = _isWindowFocused || _isCKEditorInstanceFocused;
    if(updatedFocus != _isVEFocused) {
      _isVEFocused = updatedFocus;
      var params = new Object;
      params.focus = updatedFocus;
      V.EventsNotifier.notifyEvent(V.Constant.Event.onVEFocusChange, params)
    }
  };
  var isVEFocused = function() {
    return _isVEFocused
  };
  return{init:init, getDevice:getDevice, getIsEmbed:getIsEmbed, getIsInIframe:getIsInIframe, getIframe:getIframe, isOnline:isOnline, isSlaveMode:isSlaveMode, setSlaveMode:setSlaveMode, isPreventDefaultMode:isPreventDefaultMode, setPreventDefaultMode:setPreventDefaultMode, setWindowFocus:setWindowFocus, setCKEditorInstanceFocused:setCKEditorInstanceFocused, isVEFocused:isVEFocused}
}(VISH, jQuery);
VISH.Status.Device = function(V, $, undefined) {
  var init = function(callback) {
    V.Status.Device.Browser.init();
    V.Status.Device.Features.init();
    _fillDevice(callback)
  };
  var _fillDevice = function(callback) {
    var storedDevice = V.Storage.get(V.Constant.Storage.Device);
    if(typeof storedDevice !== "undefined") {
      device = storedDevice;
      _loadViewportForDevice(device, function() {
        _fillScreen(device);
        if(typeof callback === "function") {
          callback(device)
        }
      });
      return
    }
    var device = {};
    device.browser = {};
    device.features = {};
    device.browser = V.Status.Device.Browser.fillBrowser();
    _fillUserAgentBeforeViewport(device);
    _loadViewportForDevice(device, function() {
      _fillUserAgentAfterViewport(device);
      _fillScreen(device);
      device.features = V.Status.Device.Features.fillFeatures();
      V.Storage.add(V.Constant.Storage.Device, device, false);
      if(device.android && device.browser.name === V.Constant.ANDROID_BROWSER) {
        if(device.hasTestingViewport === true) {
          _reloadOnAndroidTestingViewport(callback, device);
          return
        }
      }
      if(typeof callback === "function") {
        callback(device)
      }
    })
  };
  var _reloadOnAndroidTestingViewport = function(callback, device) {
    var attempts = 0;
    var maxAttempts = 3;
    var initialDevice = V.Storage.get(V.Constant.Storage.Device);
    if(typeof storedDevice !== "undefined") {
      location.reload(true);
      return
    }
    var waitTimer = setInterval(function() {
      var storedDevice = V.Storage.get(V.Constant.Storage.Device);
      if(typeof storedDevice !== "undefined") {
        clearInterval(waitTimer);
        location.reload(true)
      }else {
        attempts++;
        if(attempts >= maxAttempts) {
          clearInterval(waitTimer);
          callback(device)
        }
      }
    }, 1E3)
  };
  var _fillUserAgentBeforeViewport = function(device) {
    device.pixelRatio = window.devicePixelRatio || 1;
    device.iPhone = /iPhone/i.test(navigator.userAgent);
    device.iPhone4 = device.iPhone && device.pixelRatio == 2;
    device.iPad = /iPad/i.test(navigator.userAgent);
    device.iOS = device.iPhone || device.iPad;
    device.applePhone = device.iPhone || device.iPhone4;
    device.appleTablet = device.iPad;
    device.android = /android/i.test(navigator.userAgent)
  };
  var _loadViewportForDevice = function(device, callback) {
    if(device.iOS && device.browser.name === V.Constant.SAFARI) {
      _setViewportForIphone(callback)
    }else {
      if(device.android) {
        if(device.browser.name === V.Constant.CHROME) {
          _setViewportForChromeForAndroid(callback)
        }else {
          if(device.browser.name === V.Constant.ANDROID_BROWSER) {
            if(typeof device.desktop === "undefined") {
              device.hasTestingViewport = true;
              _setTestingViewportForAndroidBrowser(callback)
            }else {
              _setViewportForAndroidBrowser(callback)
            }
          }
        }
      }else {
        if(typeof callback === "function") {
          callback()
        }
      }
    }
  };
  var WAITING_TIME_FOR_VIEWPORT_LOAD = 1250;
  var _setViewport = function(viewportContent, callback) {
    var viewport = $("head>meta[name='viewport']");
    if(viewport.length === 0) {
      $("head").prepend('<meta name="viewport" content="' + viewportContent + '"/>')
    }else {
      $(viewport).attr("content", viewportContent)
    }
    setTimeout(function() {
      if(typeof callback === "function") {
        callback()
      }
    }, WAITING_TIME_FOR_VIEWPORT_LOAD)
  };
  var _setViewportForAndroidBrowser = function(callback) {
    _setViewport("user-scalable=yes", callback)
  };
  var _setTestingViewportForAndroidBrowser = function(callback) {
    _setViewport("width=device-width,height=device-height,user-scalable=yes", callback)
  };
  var _setViewportForChromeForAndroid = function(callback) {
    _setViewport("width=device-width,height=device-height,user-scalable=yes", callback)
  };
  var _setViewportForIphone = function(callback) {
    _setViewport("user-scalable=yes", callback)
  };
  var _fillUserAgentAfterViewport = function(device) {
    device.androidPhone = false;
    device.androidTablet = false;
    if(device.android) {
      if(/tablet/i.test(navigator.userAgent)) {
        device.androidTablet = true
      }else {
        var maxWidth = 960 * device.pixelRatio;
        var maxHeight = 720 * device.pixelRatio;
        var landscape = window.screen.availWidth > window.screen.availHeight;
        if(landscape) {
          if(window.screen.availWidth >= maxWidth && window.screen.availHeight >= maxHeight) {
            device.androidTablet = true
          }else {
            device.androidPhone = true
          }
        }else {
          if(window.screen.availWidth >= maxHeight && window.screen.availHeight >= maxWidth) {
            device.androidTablet = true
          }else {
            device.androidPhone = true
          }
        }
      }
    }
    device.mobile = device.applePhone || device.androidPhone;
    device.tablet = device.appleTablet || device.androidTablet;
    if(!device.mobile && !device.tablet) {
      device.desktop = true
    }else {
      device.desktop = false
    }
  };
  var _fillScreen = function(device) {
    device.viewport = {width:window.innerWidth, height:window.innerHeight};
    device.screen = {rWidth:window.screen.availWidth * device.pixelRatio, rHeight:window.screen.availHeight * device.pixelRatio, width:window.screen.availWidth, height:window.screen.availHeight}
  };
  return{init:init}
}(VISH, jQuery);
VISH.Utils = function(V, undefined) {
  var ids;
  var domIds;
  var init = function() {
    if(!domIds) {
      domIds = new Array;
      ids = []
    }
    jQuery.fn.cssNumber = function(prop) {
      var v = parseInt(this.css(prop), 10);
      return isNaN(v) ? 0 : v
    };
    jQuery.fn.reverse = [].reverse;
    String.prototype.replaceAll = function(find, replace) {
      var str = this;
      return str.replace(new RegExp(find.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&"), "g"), replace)
    }
  };
  var getOptions = function() {
    if(V.Editing) {
      return V.Editor.getOptions()
    }else {
      return V.Viewer.getOptions()
    }
  };
  var getId = function(full_id_prefix, justCheck, separator) {
    if(!justCheck) {
      if(typeof full_id_prefix !== "string") {
        full_id_prefix = "unicID"
      }
      if(typeof separator !== "string") {
        separator = ""
      }
      if(typeof domIds[full_id_prefix] === "undefined") {
        domIds[full_id_prefix] = 0
      }
      domIds[full_id_prefix] = domIds[full_id_prefix] + 1;
      var full_id = full_id_prefix + separator + domIds[full_id_prefix]
    }else {
      var full_id = full_id_prefix;
      full_id_prefix = full_id_prefix.replace(full_id_prefix[full_id_prefix.length - 1], "")
    }
    if($("#" + full_id).length === 0 && ids.indexOf(full_id) === -1) {
      ids.push(full_id);
      return full_id
    }else {
      return getId(full_id_prefix, false, separator)
    }
  };
  var registerId = function(id) {
    if(ids.indexOf(id) === -1) {
      ids.push(id)
    }
  };
  var fixPresentation = function(presentation) {
    if(typeof presentation == "undefined" || presentation === null || typeof presentation.slides == "undefined") {
      return null
    }
    if(typeof presentation.VEVersion == "undefined") {
      presentation.VEVersion = "0.1"
    }
    presentation = _fixTypes(presentation);
    if(V.Slides.isSlideset(presentation.type)) {
      presentation.type = V.Constant.PRESENTATION
    }
    if(!_checkIds(presentation)) {
      presentation = _overwriteIds(presentation)
    }
    return presentation
  };
  var _fixTypes = function(presentation) {
    if(typeof presentation.type == "undefined") {
      presentation.type = V.Constant.PRESENTATION
    }
    var slides = presentation.slides;
    var sL = slides.length;
    for(var i = 0;i < sL;i++) {
      var slide = slides[i];
      switch(slide.type) {
        case V.Constant.STANDARD:
          break;
        case V.Constant.FLASHCARD:
        ;
        case V.Constant.VTOUR:
          var subslides = slide.slides;
          if(subslides) {
            var ssL = subslides.length;
            for(var j = 0;j < ssL;j++) {
              if(typeof subslides[j].type == "undefined") {
                subslides[j].type = V.Constant.STANDARD
              }
            }
          }
          break;
        case V.Constant.QUIZ_SIMPLE:
          break;
        default:
          slide.type = V.Constant.STANDARD;
          break
      }
    }
    return presentation
  };
  var _checkIds = function(presentation) {
    var slides = presentation.slides;
    var sL = slides.length;
    for(var i = 0;i < sL;i++) {
      var slide = slides[i];
      if(!slide.id.match(/^article[0-9]+/g)) {
        return false
      }
      switch(slide.type) {
        case V.Constant.STANDARD:
          if(!_checkIdsStandardSlide(slide)) {
            return false
          }
          break;
        case V.Constant.FLASHCARD:
          if(!_checkIdsFlashcardSlide(slide)) {
            return false
          }
          break;
        case V.Constant.VTOUR:
          if(!_checkIdsVTourSlide(slide)) {
            return false
          }
          break;
        case V.Constant.QUIZ_SIMPLE:
          break;
        default:
          break
      }
    }
    return true
  };
  var _checkIdsStandardSlide = function(slide) {
    var elements = slide.elements;
    var eL = elements.length;
    for(var j = 0;j < eL;j++) {
      if(elements[j].id.match(new RegExp("^" + slide.id, "g")) === null) {
        return false
      }
    }
    return true
  };
  var _checkIdsFlashcardSlide = function(slide) {
    return _checkSlideset(slide)
  };
  var _checkIdsVTourSlide = function(slide) {
    return _checkSlideset(slide)
  };
  var _checkSlideset = function(slideset) {
    var subslides = slideset.slides;
    var subslidesIds = [];
    if(subslides) {
      var ssL = subslides.length;
      for(var i = 0;i < ssL;i++) {
        var subslide = subslides[i];
        if(typeof subslide.id != "undefined") {
          subslidesIds.push(subslide.id)
        }
        if(!_checkIdsStandardSlide(subslide)) {
          return false
        }
      }
    }
    var pois = slideset.pois;
    if(typeof pois != "undefined") {
      var pL = pois.length;
      for(var j = 0;j < pL;j++) {
        var poi = pois[j];
        if(typeof poi.slide_id == "undefined") {
          return false
        }
        if(poi.slide_id.match(new RegExp("^" + slideset.id + "_article[0-9]+", "g")) === null) {
          return false
        }
        if(subslidesIds.indexOf(poi.slide_id) === -1) {
          return false
        }
      }
    }
    return true
  };
  var _overwriteIds = function(presentation) {
    var slides = presentation.slides;
    var sL = slides.length;
    for(var i = 0;i < sL;i++) {
      var slide = slides[i];
      slide.id = "article" + (i + 1).toString();
      switch(slide.type) {
        case V.Constant.STANDARD:
          slide = _overwriteIdsStandardSlide(slide);
          break;
        case V.Constant.FLASHCARD:
          slide = _overwriteIdsFlashcardSlide(slide);
          break;
        case V.Constant.VTOUR:
          slide = _overwriteIdsVTourSlide(slide);
          break;
        case V.Constant.QUIZ_SIMPLE:
          break;
        default:
          return
      }
    }
    return presentation
  };
  var _overwriteIdsStandardSlide = function(slide) {
    var elements = slide.elements;
    var eL = elements.length;
    for(var j = 0;j < eL;j++) {
      elements[j].id = slide.id + "_zone" + (j + 1).toString()
    }
    return slide
  };
  var _overwriteIdsFlashcardSlide = function(slide) {
    return _overwriteIdsSlideset(slide)
  };
  var _overwriteIdsVTourSlide = function(slide) {
    return _overwriteIdsSlideset(slide)
  };
  var _overwriteIdsSlideset = function(slideset) {
    var subslides = slideset.slides;
    var subslidesIds = new Array;
    if(subslides) {
      var ssL = subslides.length;
      for(var i = 0;i < ssL;i++) {
        var subslide = subslides[i];
        var oldId = subslide.id;
        subslide.id = slideset.id + "_article" + (i + 1).toString();
        subslidesIds[oldId] = subslide.id;
        subslide = _overwriteIdsStandardSlide(subslide)
      }
    }
    var newPois = [];
    var pois = slideset.pois;
    if(typeof pois != "undefined") {
      var pL = pois.length;
      for(var j = 0;j < pL;j++) {
        var poi = pois[j];
        if(typeof subslidesIds[poi.slide_id] != "undefined") {
          poi.slide_id = subslidesIds[poi.slide_id];
          newPois.push(poi)
        }
      }
      slideset.pois = newPois
    }
    return slideset
  };
  var showPNotValidDialog = function() {
    var options = {};
    options.width = 650;
    options.height = 220;
    options.text = V.I18n.getTrans("i.resourceNonCompatibleNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var getOuterHTML = function(tag) {
    if(typeof $(tag)[0].outerHTML == "undefined") {
      return $(tag).clone().wrap("<div></div>").parent().html()
    }else {
      return $(tag)[0].outerHTML
    }
  };
  var sendParentToURL = function(the_url) {
    window.top.location = the_url
  };
  var addParamToUrl = function(url, paramName, paramValue) {
    if(typeof url !== "string" || typeof paramName !== "string" || typeof paramValue !== "string") {
      return url
    }
    var splitHash = url.split("#");
    url = splitHash[0];
    var param = paramName + "=" + paramValue;
    if(url.indexOf("?") > -1) {
      url += "&" + param
    }else {
      url += "?" + param
    }
    if(splitHash.length > 1) {
      url = url + "#" + splitHash[1]
    }
    return url
  };
  var getParamsFromUrl = function(url) {
    var params = {};
    if(typeof url !== "string") {
      return params
    }
    var split = url.split("?");
    if(split.length <= 1) {
      return params
    }else {
      var urlParams = split[1].split("#")[0].split("&");
      for(var i = 0;i < urlParams.length;i++) {
        var resultSplit = urlParams[i].split("=");
        if(resultSplit.length === 2) {
          params[resultSplit[0]] = resultSplit[1]
        }
      }
      return params
    }
  };
  var checkMiniumRequirements = function() {
    var browserRequirements = true;
    var device = V.Status.getDevice();
    switch(device.browser.name) {
      case V.Constant.IE:
        if(V.Editing) {
          if(device.browser.version < 9) {
            browserRequirements = false
          }
        }else {
          if(device.browser.version < 8) {
            browserRequirements = false
          }
        }
        break;
      case V.Constant.FIREFOX:
        break;
      case V.Constant.CHROME:
        break;
      default:
        break
    }
    if(!browserRequirements) {
      $.fancybox($("#requirements_form_wrapper").html(), {"autoDimensions":false, "width":650, "height":400, "showCloseButton":false, "padding":0, "onClosed":function() {
      }});
      return false
    }
    return true
  };
  var getSrcFromCSS = function(css) {
    try {
      if(typeof css == "string" && css.indexOf("url") === 0 && css.length > 3) {
        var quote = css[4];
        if(quote == '"' || quote == "'") {
          return css.substring(5, css.length - 2)
        }else {
          return css.substring(4, css.length - 1)
        }
      }
    }catch(e) {
    }
    return css
  };
  var getZoomInStyle = function(zoom) {
    var style = "";
    style = style + "-ms-transform: scale(" + zoom + "); ";
    style = style + "-ms-transform-origin: 0 0; ";
    style = style + "-moz-transform: scale(" + zoom + "); ";
    style = style + "-moz-transform-origin: 0 0; ";
    style = style + "-o-transform: scale(" + zoom + "); ";
    style = style + "-o-transform-origin: 0 0; ";
    style = style + "-webkit-transform: scale(" + zoom + "); ";
    style = style + "-webkit-transform-origin: 0 0; ";
    return style
  };
  var getZoomFromStyle = function(style) {
    var zoom = 1;
    if(!style) {
      return zoom
    }
    var moz_zoom_pattern = /-moz-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var webkit_zoom_pattern = /-webkit-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var opera_zoom_pattern = /-o-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var ie_zoom_pattern = /-ms-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    $.each(style.split(";"), function(index, property) {
      if(property.match(moz_zoom_pattern) != null) {
        var result = moz_zoom_pattern.exec(property);
        if(result !== null && result[1]) {
          zoom = parseFloat(result[1]);
          return false
        }
      }else {
        if(property.match(webkit_zoom_pattern) != null) {
          var result = webkit_zoom_pattern.exec(property);
          if(result !== null && result[1]) {
            zoom = parseFloat(result[1]);
            return false
          }
        }else {
          if(property.match(opera_zoom_pattern) != null) {
            var result = opera_zoom_pattern.exec(property);
            if(result !== null && result[1]) {
              zoom = parseFloat(result[1]);
              return false
            }
          }else {
            if(property.match(ie_zoom_pattern) != null) {
              var result = ie_zoom_pattern.exec(property);
              if(result !== null && result[1]) {
                zoom = parseFloat(result[1]);
                return false
              }
            }
          }
        }
      }
    });
    return zoom
  };
  var getWidthFromStyle = function(style, area) {
    return getPixelDimensionsFromStyle(style, area)[0]
  };
  var getHeightFromStyle = function(style, area) {
    return getPixelDimensionsFromStyle(style, area)[1]
  };
  var getPixelDimensionsFromStyle = function(style, area) {
    var dimensions = [];
    var width = null;
    var height = null;
    $.each(style.split(";"), function(index, property) {
      var width_percent_pattern = /width:\s?([0-9]+(\.[0-9]+)?)%/g;
      var width_px_pattern = /width:\s?([0-9]+(\.?[0-9]+)?)px/g;
      var height_percent_pattern = /height:\s?([0-9]+(\.[0-9]+)?)%/g;
      var height_px_pattern = /height:\s?([0-9]+(\.?[0-9]+)?)px/g;
      if(property.indexOf("width") !== -1) {
        if(property.match(width_px_pattern)) {
          var result = width_px_pattern.exec(property);
          if(result[1]) {
            width = result[1]
          }
        }else {
          if(property.match(width_percent_pattern)) {
            var result = width_percent_pattern.exec(property);
            if(result[1]) {
              var percent = result[1];
              if(area) {
                width = $(area).width() * percent / 100
              }
            }
          }
        }
      }else {
        if(property.indexOf("height") !== -1) {
          if(property.match(height_px_pattern)) {
            var result = height_px_pattern.exec(property);
            if(result[1]) {
              height = result[1]
            }
          }else {
            if(property.match(height_percent_pattern)) {
              var result = height_percent_pattern.exec(property);
              if(result[1]) {
                var percent = result[1];
                if(area) {
                  height = $(area).height() * percent / 100
                }
              }
            }
          }
        }
      }
    });
    dimensions.push(width);
    dimensions.push(height);
    return dimensions
  };
  var getFontSizeFromStyle = function(style) {
    if(!style) {
      return
    }
    var ft = null;
    $.each(style.split(";"), function(index, property) {
      var font_style_pattern = /font-size:\s?([0-9]+)px/g;
      if(property.match(font_style_pattern) != null) {
        var result = font_style_pattern.exec(property);
        if(result !== null && result[1] !== null) {
          ft = parseFloat(result[1]);
          return false
        }
      }
    });
    return ft
  };
  var addFontSizeToStyle = function(style, fontSize) {
    if(typeof style !== "string") {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("font-size") === -1 && property !== "") {
        filterStyle = filterStyle + property + "; "
      }
    });
    if(fontSize) {
      filterStyle = filterStyle + "font-size:" + fontSize + ";"
    }
    return filterStyle
  };
  var removeFontSizeInStyle = function(style) {
    if(typeof style !== "string") {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("font-size") === -1 && property !== "") {
        filterStyle = filterStyle + property + "; "
      }
    });
    return filterStyle
  };
  var showDialog = function(options) {
    _cleanDialog();
    var rootTemplate = $("#notification_template");
    if($(rootTemplate).length === 0) {
      return
    }
    if(!options || !options.text) {
      return
    }
    var width = "90%";
    var height;
    var showCloseButton = false;
    var notificationIconSrc;
    if(V.Editing) {
      notificationIconSrc = V.ImagesPath + "zonethumbs/content_fail.png"
    }
    if(options.width) {
      width = options.width
    }
    if(options.showCloseButton) {
      showCloseButton = options.showCloseButton
    }
    if(options.notificationIconSrc) {
      notificationIconSrc = options.notificationIconSrc
    }
    if(!notificationIconSrc) {
      options.textWrapperClass = "forceCenter"
    }
    if(typeof width == "string" && width.indexOf("%") != 0) {
      width = width.split("%")[0].trim();
      width = width * $(window).width() / 100
    }
    var notificationParent = $(rootTemplate).parent();
    $(rootTemplate).width(width);
    var text_wrapper = $(rootTemplate).find(".notification_row1");
    var buttons_wrapper = $(rootTemplate).find(".notification_row2");
    var imgIcon = $(text_wrapper).find(".notificationIcon");
    if(notificationIconSrc) {
      $(imgIcon).attr("src", notificationIconSrc);
      $(imgIcon).css("display", "inline")
    }
    if(options.notificationIconClass) {
      $(imgIcon).addClass(options.notificationIconClass)
    }
    if(options.textWrapperClass) {
      $(text_wrapper).addClass(options.textWrapperClass)
    }
    if(options.buttonsWrapperClass) {
      $(buttons_wrapper).addClass(options.buttonsWrapperClass)
    }
    $(text_wrapper).find(".notification_text").html(options.text);
    if(options.buttons) {
      var obLength = options.buttons.length;
      $(options.buttons).reverse().each(function(index, button) {
        var bNumber = obLength - index;
        var buttonDOM = $('<a href="#" buttonNumber="' + bNumber + '" class="button notification_button">' + button.text + "</a>");
        if(button.extraclass) {
          $(buttonDOM).addClass(button.extraclass)
        }
        $(buttons_wrapper).append(buttonDOM)
      })
    }
    if(options.middlerow) {
      var middlerow = document.createElement("div");
      $(middlerow).addClass("notification_middlerow");
      $(middlerow).append(options.middlerow);
      if(options.middlerowExtraClass) {
        $(middlerow).addClass(options.middlerowExtraClass)
      }
      $(buttons_wrapper).before(middlerow)
    }
    $(notificationParent).addClass("temp_shown");
    var adjustedHeight = $(text_wrapper).outerHeight(true) + $(buttons_wrapper).outerHeight(true);
    if(options.middlerow) {
      var middlerow = $(rootTemplate).find(".notification_middlerow");
      adjustedHeight = adjustedHeight + $(middlerow).outerHeight(true)
    }
    $(notificationParent).removeClass("temp_shown");
    var cloneTemplate = $(rootTemplate).clone();
    $(cloneTemplate).attr("id", "notification_template_cloned");
    $(notificationParent).append(cloneTemplate);
    var notification = $("#notification_template_cloned");
    if(options.buttons) {
      buttons_wrapper = $(notification).find(".notification_row2");
      $(buttons_wrapper).html("");
      var obLength = options.buttons.length;
      $(options.buttons).reverse().each(function(index, button) {
        var bNumber = obLength - index;
        var buttonDOM = $('<a href="#" buttonNumber="' + bNumber + '" class="button notification_button">' + button.text + "</a>");
        if(button.extraclass) {
          $(buttonDOM).addClass(button.extraclass)
        }
        $(buttons_wrapper).append(buttonDOM);
        $(buttons_wrapper).find(".button[buttonNumber='" + bNumber + "']").click(function(event) {
          event.preventDefault();
          button.callback()
        })
      })
    }
    $("a#link_to_notification_template").fancybox({"autoDimensions":false, "autoScale":true, "scrolling":"no", "width":width, "height":adjustedHeight, "padding":0, "hideOnOverlayClick":true, "hideOnContentClick":false, "showCloseButton":showCloseButton, "onStart":function(data) {
    }, "onComplete":function(data) {
    }, "onClosed":function(data) {
      _cleanDialog();
      if(options && typeof options.onClosedCallback == "function") {
        options.onClosedCallback()
      }
    }});
    $("a#link_to_notification_template").trigger("click")
  };
  var _cleanDialog = function() {
    var notificationWrapper = $("#notification_template_wrapper");
    $(notificationWrapper).html("");
    var notificationTemplate = document.createElement("div");
    $(notificationTemplate).attr("id", "notification_template");
    var row1 = document.createElement("div");
    $(row1).addClass("notification_row1");
    var img = document.createElement("img");
    $(img).addClass("notificationIcon");
    $(img).attr("style", "display:none");
    var span = document.createElement("span");
    $(span).addClass("notification_text");
    $(row1).append(img);
    $(row1).append(span);
    $(notificationTemplate).append(row1);
    var row2 = document.createElement("div");
    $(row2).addClass("notification_row2");
    $(notificationTemplate).append(row2);
    $(notificationWrapper).append(notificationTemplate)
  };
  return{init:init, getOptions:getOptions, getId:getId, registerId:registerId, getOuterHTML:getOuterHTML, getSrcFromCSS:getSrcFromCSS, checkMiniumRequirements:checkMiniumRequirements, addFontSizeToStyle:addFontSizeToStyle, removeFontSizeInStyle:removeFontSizeInStyle, getFontSizeFromStyle:getFontSizeFromStyle, getZoomFromStyle:getZoomFromStyle, getZoomInStyle:getZoomInStyle, getWidthFromStyle:getWidthFromStyle, getHeightFromStyle:getHeightFromStyle, getPixelDimensionsFromStyle:getPixelDimensionsFromStyle, 
  sendParentToURL:sendParentToURL, addParamToUrl:addParamToUrl, getParamsFromUrl:getParamsFromUrl, fixPresentation:fixPresentation, showDialog:showDialog, showPNotValidDialog:showPNotValidDialog}
}(VISH);
VISH.Editor = function(V, $, undefined) {
  var initOptions;
  var initialPresentation = false;
  var draftPresentation;
  var lastStoredPresentationStringify;
  var currentZone;
  var lastZone;
  var contentAddModeForSlides = V.Constant.NONE;
  var init = function(options, presentation) {
    $("#waiting_overlay").show();
    V.Editing = true;
    $("body").addClass("ViSHEditorBody");
    V.Debugging.init(options);
    if(options) {
      initOptions = options;
      if(options.configuration && V.Configuration) {
        V.Configuration.init(options.configuration);
        V.Configuration.applyConfiguration()
      }
    }else {
      initOptions = {}
    }
    V.Utils.init();
    V.Status.init(function() {
      _initAferStatusLoaded(options, presentation)
    })
  };
  var _initAferStatusLoaded = function(options, presentation) {
    if(!V.Utils.checkMiniumRequirements()) {
      $("#waiting_overlay").hide();
      return
    }
    V.Utils.Loader.loadDeviceCSS();
    V.I18n.init(options.lang);
    V.Utils.Loader.loadLanguageCSS();
    V.Editor.Dummies.init();
    V.EventsNotifier.init();
    V.Editor.Animations.init();
    V.Editor.Themes.init();
    V.Flashcard.init();
    V.VirtualTour.init();
    V.Editor.Slideset.init();
    V.Editor.Presentation.init();
    V.Editor.Flashcard.init();
    V.Editor.VirtualTour.init();
    V.Renderer.init();
    V.Slides.init();
    V.User.init(options);
    V.Editor.LRE.init(options.lang);
    V.Editor.Settings.init();
    if(V.Debugging.isDevelopping()) {
      if(options.configuration.mode == V.Constant.NOSERVER && V.Debugging.getActionInit() == "loadSamples" && !presentation) {
        presentation = V.Debugging.getPresentationSamples()
      }
    }
    if(presentation) {
      presentation = V.Utils.fixPresentation(presentation);
      if(presentation === null) {
        $("#waiting_overlay").hide();
        V.Utils.showPNotValidDialog();
        return
      }
      initialPresentation = true;
      draftPresentation = presentation;
      V.Editor.Settings.loadPresentationSettings(presentation);
      if(!isPresentationDraft()) {
        V.Editor.Tools.changePublishButtonStatus("unpublish")
      }
      V.Editor.Themes.selectTheme(presentation.theme, false, function() {
        V.Editor.Renderer.init(presentation);
        _removeSelectableProperties();
        _initAferPresentationLoaded(options, presentation)
      })
    }else {
      initialPresentation = false;
      V.Editor.Settings.loadPresentationSettings();
      _initAferPresentationLoaded(options, presentation)
    }
  };
  var _initAferPresentationLoaded = function(options, presentation) {
    V.Slides.updateSlides();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber())
    });
    if(initialPresentation) {
      $(".object_wrapper").hide()
    }
    V.Editor.Text.init();
    V.Editor.Image.init();
    V.Editor.Video.init();
    V.Editor.Object.init();
    V.Editor.PDFex.init();
    V.Editor.Presentation.Repository.init();
    V.Editor.Slideset.Repository.init();
    V.Editor.Thumbnails.init();
    V.Editor.Quiz.init();
    V.Editor.Preview.init();
    V.Editor.Tools.init();
    V.Editor.Filter.init();
    V.Storage.init();
    V.Editor.Clipboard.init();
    V.Editor.Events.init();
    if(options.addons) {
      V.Addons.init(options.addons)
    }
    V.Editor.Utils.Loader.unloadAllObjects();
    if(V.Slides.getCurrentSlideNumber() > 0) {
      V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
    }
    if(!initialPresentation) {
      var slide = V.Editor.Dummies.getDummy(V.Constant.STANDARD, {template:"1", slideNumber:1});
      V.Editor.Slides.addSlide(slide)
    }
    if(V.Configuration.getConfiguration().presentationSettings && !initialPresentation) {
      V.Editor.Settings.displaySettings()
    }
    $("#VEversion").html(V.VERSION);
    window.focus();
    $("#waiting_overlay").hide()
  };
  var onSlideThumbClicked = function(event) {
    var type = $(event.currentTarget).attr("type");
    if(!type) {
      type = V.Constant.STANDARD
    }
    var slideMode = contentAddModeForSlides;
    if(slideMode === V.Constant.STANDARD) {
      var options = {};
      if(type === V.Constant.STANDARD) {
        options.template = $(event.currentTarget).attr("template")
      }
      options.slideNumber = V.Slides.getSlidesQuantity() + 1;
      var slide = V.Editor.Dummies.getDummy(type, options);
      V.Editor.Slides.addSlide(slide)
    }else {
      if(slideMode === V.Constant.SLIDESET) {
        var slideset = V.Slides.getCurrentSlide();
        if(type === V.Constant.STANDARD && V.Editor.Slideset.isSlideset(slideset)) {
          var options = {};
          options.subslide = true;
          options.template = $(event.currentTarget).attr("template");
          options.slideset = slideset;
          var subslide = V.Editor.Dummies.getDummy(type, options);
          V.Editor.Slides.addSubslide(slideset, subslide)
        }
      }
    }
    $.fancybox.close()
  };
  var onEditableClicked = function(event) {
    $(this).removeClass("editable");
    setCurrentArea($(this));
    var content = $("#menuselect").clone();
    $(content).removeAttr("id");
    $(content).find("a").css("display", "none");
    $(content).find("a.all").css("display", "inline");
    switch($(this).attr("size")) {
      case V.Constant.EXTRA_SMALL:
        $(content).find("a.small").css("display", "inline");
        $(content).find("a > div").addClass("thumb_extra_small");
        break;
      case V.Constant.SMALL:
        $(content).find("a.small").css("display", "inline");
        $(content).find("a > div").addClass("thumb_small");
        break;
      case V.Constant.MEDIUM:
        $(content).find("a.medium").css("display", "inline");
        $(content).find("a > div").addClass("thumb_medium");
        break;
      case V.Constant.LARGE:
        $(content).find("a.large").css("display", "inline");
        $(content).find("a > div").addClass("thumb_large");
        break
    }
    V.Editor.Tools.hideZoneToolTip($(this).find(".zone_tooltip"));
    $(this).append(content);
    V.Editor.Events.addZoneThumbsEvents(this)
  };
  var onDeleteItemClicked = function() {
    setCurrentArea($(this).parent());
    var options = {};
    options.width = 375;
    options.height = 135;
    options.notificationIconSrc = V.ImagesPath + "zonethumbs/" + getCurrentArea().attr("type") + ".png";
    options.text = V.I18n.getTrans("i.areyousureNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.no");
    button1.callback = function() {
      $.fancybox.close()
    };
    var button2 = {};
    button2.text = V.I18n.getTrans("i.delete");
    button2.callback = function() {
      var area = getCurrentArea();
      area.html("");
      area.removeAttr("type");
      area.addClass("editable");
      V.Editor.Tools.addTooltipToZone(area);
      selectArea(null);
      $.fancybox.close()
    };
    options.buttons = [button1, button2];
    V.Utils.showDialog(options)
  };
  var onDeleteSlideClicked = function() {
    var article_to_delete = $(this).parent()[0];
    var options = {};
    options.width = 375;
    options.height = 130;
    options.notificationIconSrc = V.Editor.Thumbnails.getThumbnailURL(article_to_delete);
    options.notificationIconClass = "notificationIconDelete";
    options.text = V.I18n.getTrans("i.areyousureNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.no");
    button1.callback = function() {
      $.fancybox.close()
    };
    var button2 = {};
    button2.text = V.I18n.getTrans("i.delete");
    button2.callback = function() {
      if(V.Editor.Slides.isSubslide(article_to_delete)) {
        V.Editor.Slides.removeSubslide(article_to_delete)
      }else {
        V.Editor.Slides.removeSlide(V.Slides.getCurrentSlide())
      }
      $.fancybox.close()
    };
    options.buttons = [button1, button2];
    V.Utils.showDialog(options)
  };
  var onSelectableClicked = function(event) {
    selectArea($(this));
    event.stopPropagation();
    event.preventDefault()
  };
  var onNoSelectableClicked = function(event) {
    if(!$(event.target).hasClass("noSelectableElement")) {
      if($("#fancybox-content").is(":visible")) {
        return
      }
      if($(event.target).parent().hasClass("selectable")) {
        return
      }
      if(jQuery.contains($("#toolbar_wrapper")[0], event.target)) {
        return
      }
      if(event.target.id === "toolbar_wrapper") {
        return
      }
      var isWysiwygFancyboxEnabled = false;
      $(".cke_dialog").each(function(index, cke_dialog) {
        if(cke_dialog && jQuery.contains(cke_dialog, event.target)) {
          isWysiwygFancyboxEnabled = true;
          return false
        }
      });
      if(isWysiwygFancyboxEnabled) {
        return
      }
    }
    V.Editor.Tools.cleanZoneTools(getCurrentArea());
    setCurrentArea(null);
    _removeSelectableProperties()
  };
  var _addSelectableProperties = function(zone) {
    $(zone).removeClass("zoneUnselected");
    $(zone).addClass("zoneSelected")
  };
  var _removeSelectableProperties = function(zone) {
    if(zone) {
      $(zone).removeClass("zoneSelected");
      $(zone).addClass("zoneUnselected")
    }else {
      $(".zoneSelected").addClass("zoneUnselected");
      $(".zoneSelected").removeClass("zoneSelected")
    }
  };
  var addDeleteButton = function(element) {
    element.append("<div class='delete_content'></div>")
  };
  var onSlideEnterEditor = function(e) {
    var slide = $(e.target);
    e.stopPropagation();
    if(V.Editor.Slideset.isSlideset(slide)) {
      V.Editor.Slideset.onEnterSlideset(slide)
    }else {
      V.Editor.Utils.Loader.loadObjectsInEditorSlide(slide);
      setTimeout(function() {
        $(slide).find(".object_wrapper").show()
      }, 500)
    }
    V.Editor.Tools.loadToolsForSlide(slide)
  };
  var onSlideLeaveEditor = function(e) {
    var slide = $(e.target);
    e.stopPropagation();
    if(V.Editor.Slideset.isSlideset(slide)) {
      V.Editor.Slideset.onLeaveSlideset(slide)
    }else {
      V.Editor.Utils.Loader.unloadObjectsInEditorSlide(slide);
      $(".object_wrapper").hide()
    }
  };
  var selectArea = function(area) {
    setCurrentArea(area);
    _removeSelectableProperties();
    _addSelectableProperties(area);
    V.Editor.Tools.loadToolsForZone(area)
  };
  var savePresentation = function() {
    var presentation = {};
    presentation = V.Editor.Settings.saveSettings();
    presentation.slides = [];
    V.Editor.Utils.Loader.loadAllObjects();
    $(".object_wrapper, .snapshot_wrapper").show();
    $("section.slides > article").each(function(index, slideDOM) {
      var slide = {};
      if(!V.Editor.Slideset.isSlideset(slideDOM)) {
        slide = _saveStandardSlide(slideDOM, presentation, false)
      }else {
        var slidesetModule = V.Editor.Slideset.getCreatorModule(slideDOM);
        slide = slidesetModule.getSlideHeader(slideDOM);
        $(slideDOM).find("article").each(function(index, subslideDOM) {
          var subslide = _saveStandardSlide(subslideDOM, presentation, true);
          slide.slides.push(subslide)
        })
      }
      presentation.slides.push(slide)
    });
    V.Editor.Utils.Loader.unloadAllObjects();
    V.Editor.Utils.Loader.loadObjectsInEditorSlide(V.Slides.getCurrentSlide());
    return presentation
  };
  var _saveStandardSlide = function(slideDOM, presentation, isSubslide) {
    slide = {};
    slide.id = $(slideDOM).attr("id");
    slide.type = $(slideDOM).attr("type");
    slide.template = $(slideDOM).attr("template");
    slide.elements = [];
    if(isSubslide) {
      $(slideDOM).parent().addClass("temp_shown")
    }
    $(slideDOM).addClass("temp_shown");
    $(slideDOM).find("div").each(function(i, div) {
      var element = {};
      if($(div).attr("areaid") !== undefined) {
        element.id = $(div).attr("id");
        element.type = $(div).attr("type");
        element.areaid = $(div).attr("areaid");
        if(element.type == V.Constant.TEXT) {
          var CKEditor = V.Editor.Text.getCKEditorFromZone(div);
          if(CKEditor !== null) {
            element.body = CKEditor.getData()
          }else {
            element.body = ""
          }
        }else {
          if(element.type == V.Constant.IMAGE) {
            element.body = $(div).find("img").attr("src");
            element.style = V.Editor.Utils.getStylesInPercentages($(div), $(div).find("img"));
            if($(div).attr("hyperlink")) {
              element.hyperlink = $(div).attr("hyperlink")
            }
          }else {
            if(element.type == V.Constant.VIDEO) {
              var video = $(div).find("video");
              element.poster = $(video).attr("poster");
              element.style = V.Editor.Utils.getStylesInPercentages($(div), $(video));
              var sources = "";
              $(video).find("source").each(function(index, source) {
                if(index !== 0) {
                  sources = sources + ","
                }
                var type = typeof $(source).attr("type") != "undefined" ? ' "type": "' + $(source).attr("type") + '", ' : "";
                sources = sources + "{" + type + '"src": "' + $(source).attr("src") + '"}'
              });
              sources = "[" + sources + "]";
              element.sources = sources
            }else {
              if(element.type === V.Constant.OBJECT) {
                var wrapper = $(div).find(".object_wrapper")[0];
                var object = $(wrapper).children()[0];
                var myObject = $(object).clone();
                $(myObject).removeAttr("style");
                element.body = V.Utils.getOuterHTML(myObject);
                element.style = V.Editor.Utils.getStylesInPercentages($(div), $(object).parent());
                var zoom = V.Utils.getZoomFromStyle($(object).attr("style"));
                if(zoom != 1) {
                  element.zoomInStyle = V.Utils.getZoomInStyle(zoom)
                }
              }else {
                if(element.type === V.Constant.QUIZ) {
                  var quizJSON = VISH.Editor.Quiz.save(div);
                  element.quiztype = quizJSON.quizType;
                  element.selfA = quizJSON.selfA;
                  element.question = quizJSON.question;
                  element.choices = quizJSON.choices;
                  if(quizJSON.extras) {
                    element.extras = quizJSON.extras
                  }
                  slide.containsQuiz = true
                }else {
                  if(element.type === V.Constant.SNAPSHOT) {
                    var snapshotWrapper = $(div).find(".snapshot_wrapper");
                    var snapshotIframe = $(snapshotWrapper).children()[0];
                    $(snapshotIframe).removeAttr("style");
                    element.body = V.Utils.getOuterHTML(snapshotIframe);
                    element.style = V.Editor.Utils.getStylesInPercentages($(div), snapshotWrapper);
                    var scrollTopAttr = $(snapshotWrapper).attr("scrollTop");
                    if(typeof scrollTopAttr !== "undefined") {
                      element.scrollTop = scrollTopAttr;
                      element.scrollLeft = $(snapshotWrapper).attr("scrollLeft")
                    }else {
                      element.scrollTop = $(snapshotWrapper).scrollTop();
                      element.scrollLeft = $(snapshotWrapper).scrollLeft()
                    }
                  }else {
                    if(typeof element.type == "undefined") {
                    }
                  }
                }
              }
            }
          }
        }
        slide.elements.push(element)
      }
    });
    if(slide.containsQuiz) {
      var quizSlide = $.extend(true, {}, slide);
      quizSlide.type = V.Constant.QUIZ_SIMPLE;
      var quizPresentation = {};
      quizPresentation.title = presentation.title;
      quizPresentation.description = presentation.description;
      quizPresentation.author = presentation.author;
      quizPresentation.type = V.Constant.QUIZ_SIMPLE;
      quizPresentation.slides = [quizSlide];
      for(var k = 0;k < slide.elements.length;k++) {
        if(slide.elements[k].type === V.Constant.QUIZ) {
          slide.elements[k].quiz_simple_json = quizPresentation
        }
      }
    }
    if(isSubslide) {
      $(slideDOM).parent().removeClass("temp_shown")
    }
    $(slideDOM).removeClass("temp_shown");
    return slide
  };
  var sendPresentation = function(presentation, order, successCallback, failCallback) {
    switch(V.Configuration.getConfiguration().mode) {
      case V.Constant.VISH:
        var createNewPresentation = typeof lastStoredPresentationStringify == "undefined" && !initialPresentation;
        var send_type;
        if(createNewPresentation) {
          send_type = "POST"
        }else {
          send_type = "PUT"
        }
        var params = {"authenticity_token":V.User.getToken()};
        if(order != "unpublish") {
          var jsonPresentation = JSON.stringify(presentation);
          params["excursion[json]"] = jsonPresentation
        }
        if(order === "publish") {
          params.draft = false
        }else {
          if(order === "unpublish") {
            params.draft = true
          }else {
            if(order === "save") {
              if(createNewPresentation) {
                params.draft = true
              }
            }
          }
        }
        $.ajax({type:send_type, url:V.UploadPresentationPath, data:params, success:function(data) {
          if(order != "unpublish") {
            lastStoredPresentationStringify = jsonPresentation;
            if(createNewPresentation && typeof data != "undefined" && data.uploadPath) {
              V.UploadPresentationPath = data.uploadPath;
              if(V.Status.getDevice().features.historypushState) {
                if(data.editPath) {
                  window.top.history.replaceState("", "", data.editPath)
                }
              }
            }
          }
          if(typeof successCallback == "function") {
            successCallback(data)
          }
        }, error:function(xhr, error) {
          if(typeof failCallback == "function") {
            failCallback()
          }
        }});
        break;
      case V.Constant.NOSERVER:
        if(V.Debugging && V.Debugging.isDevelopping()) {
          if(order != "unpublish") {
            lastStoredPresentationStringify = JSON.stringify(presentation)
          }
          setTimeout(function() {
            successCallback()
          }, 5E3)
        }
        break;
      case V.Constant.STANDALONE:
        _uploadPresentationWithNode(presentation);
        break
    }
  };
  var _uploadPresentationWithNode = function(presentation) {
    var send_type;
    var url = V.UploadPresentationPath;
    if(draftPresentation) {
      send_type = "PUT";
      url = url + draftPresentation.id
    }else {
      send_type = "POST"
    }
    var jsonPresentation = JSON.stringify(presentation);
    var params = {"presentation[json]":jsonPresentation};
    $.ajax({type:send_type, url:url, data:params, success:function(data) {
      V.Editor.Events.allowExitWithoutConfirmation();
      window.top.location.href = data.url
    }})
  };
  var getOptions = function() {
    return initOptions
  };
  var getTemplate = function(area) {
    if(area) {
      return area.parent().attr("template")
    }else {
      if(getCurrentArea()) {
        return getCurrentArea().parent().attr("template")
      }
    }
    return null
  };
  var getCurrentArea = function() {
    if(currentZone) {
      return currentZone
    }
    return null
  };
  var setCurrentArea = function(area) {
    if($(area).attr("id") != $(currentZone).attr("id")) {
      lastZone = currentZone;
      currentZone = area
    }
  };
  var getLastArea = function() {
    if(lastZone) {
      return lastZone
    }
    return null
  };
  var getDraftPresentation = function() {
    return draftPresentation
  };
  var hasInitialPresentation = function() {
    return initialPresentation
  };
  var isZoneEmpty = function(zone) {
    return zone && $(zone).find(".delete_content").length === 0
  };
  var getContentAddMode = function() {
    return contentAddModeForSlides
  };
  var setContentAddMode = function(mode) {
    contentAddModeForSlides = mode
  };
  var getPresentationType = function() {
    if(!draftPresentation || !draftPresentation.type) {
      return V.Constant.PRESENTATION
    }
    return draftPresentation.type
  };
  var isPresentationDraft = function() {
    if(initialPresentation) {
      if(initOptions.draft && typeof initOptions.draft === "boolean") {
        return initOptions.draft
      }else {
        return false
      }
    }else {
      return true
    }
  };
  var hasPresentationChanged = function() {
    try {
      var objectToCompare;
      if(typeof lastStoredPresentationStringify != "undefined") {
        objectToCompare = lastStoredPresentationStringify
      }else {
        if(typeof draftPresentation != "undefined") {
          objectToCompare = JSON.stringify(draftPresentation)
        }else {
          return true
        }
      }
      var currentPresentation = V.Editor.savePresentation();
      return!(objectToCompare === JSON.stringify(currentPresentation))
    }catch(e) {
      return true
    }
  };
  return{init:init, getOptions:getOptions, getTemplate:getTemplate, getCurrentArea:getCurrentArea, getLastArea:getLastArea, getPresentationType:getPresentationType, getDraftPresentation:getDraftPresentation, isPresentationDraft:isPresentationDraft, getContentAddMode:getContentAddMode, setContentAddMode:setContentAddMode, hasInitialPresentation:hasInitialPresentation, isZoneEmpty:isZoneEmpty, savePresentation:savePresentation, sendPresentation:sendPresentation, setCurrentArea:setCurrentArea, selectArea:selectArea, 
  onSlideEnterEditor:onSlideEnterEditor, onSlideLeaveEditor:onSlideLeaveEditor, onSlideThumbClicked:onSlideThumbClicked, onEditableClicked:onEditableClicked, onSelectableClicked:onSelectableClicked, onNoSelectableClicked:onNoSelectableClicked, onDeleteItemClicked:onDeleteItemClicked, onDeleteSlideClicked:onDeleteSlideClicked, addDeleteButton:addDeleteButton, hasPresentationChanged:hasPresentationChanged}
}(VISH, jQuery);
VISH.Editor.Utils = function(V, $, undefined) {
  var dimentionToDraw = function(w_zone, h_zone, w_content, h_content) {
    var dimentions_for_drawing = {width:w_content, height:h_content};
    var aspect_ratio_zone = w_zone / h_zone;
    var aspect_ratio_content = w_content / h_content;
    if(aspect_ratio_zone > aspect_ratio_content) {
      dimentions_for_drawing.width = aspect_ratio_content * h_zone;
      dimentions_for_drawing.height = h_zone;
      return dimentions_for_drawing
    }else {
      dimentions_for_drawing.width = w_zone;
      dimentions_for_drawing.height = w_zone / aspect_ratio_content;
      return dimentions_for_drawing
    }
  };
  var setStyleInPixels = function(style, area) {
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("width") === -1 && property.indexOf("height") === -1) {
        filterStyle = filterStyle + property + "; "
      }
    });
    var dimensions = V.Utils.getPixelDimensionsFromStyle(style, area);
    if(dimensions && dimensions[0]) {
      filterStyle = filterStyle + "width: " + dimensions[0] + "px; ";
      if(dimensions[1]) {
        filterStyle = filterStyle + "height: " + dimensions[1] + "px; "
      }
    }
    return filterStyle
  };
  var addZoomToStyle = function(style, zoom) {
    if(!style) {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("-ms-transform") === -1 && property.indexOf("-moz-transform") === -1 && property.indexOf("-o-transform") === -1 && property.indexOf("-webkit-transform") === -1 && property.indexOf("-moz-transform-origin") === -1 && property.indexOf("-webkit-transform-origin") === -1 && property.indexOf("-o-transform-origin") === -1 && property.indexOf("-ms-transform-origin") === -1) {
        filterStyle = filterStyle + property + "; "
      }
    });
    if(zoom) {
      filterStyle = filterStyle + "-ms-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-ms-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-moz-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-moz-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-o-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-o-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-webkit-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-webkit-transform-origin: 0 0; "
    }
    return filterStyle
  };
  var getStylesInPercentages = function(parent, element) {
    var WidthPercent = element.width() * 100 / parent.width();
    var HeightPercent = element.height() * 100 / parent.height();
    var TopPercent = element.position().top * 100 / parent.height();
    var LeftPercent = element.position().left * 100 / parent.width();
    return"position: relative; width:" + WidthPercent + "%; height:" + HeightPercent + "%; top:" + TopPercent + "%; left:" + LeftPercent + "%;"
  };
  var refreshDraggables = function(slide) {
    $(slide).find("[draggable='true']").draggable({cursor:"move", stop:function() {
      $(this).parent().click()
    }})
  };
  var generateTable = function(options) {
    var title = "Unknown";
    var author = "";
    var description = "";
    var tableClass = "metadata";
    if(options) {
      if(options.title) {
        title = options.title
      }
      if(options.author) {
        author = options.author
      }
      if(options.description) {
        description = options.description
      }
      if(options.tableClass) {
        tableClass = options.tableClass
      }
      if(options.url) {
        title = "<a title='view resource' class='metadata_link' target='_blank' href='" + options.url + "'>" + title + "</a>"
      }
    }
    return'<table class="' + tableClass + '">' + '<tr class="even">' + '<td class="title header_left">' + V.I18n.getTrans("i.Title") + "</td>" + '<td class="title header_right"><div class="height_wrapper">' + title + "</div></td>" + "</tr>" + '<tr class="odd">' + '<td class="title">' + V.I18n.getTrans("i.Author") + "</td>" + '<td class="info"><div class="height_wrapper">' + author + "</div></td>" + "</tr>" + '<tr class="even">' + '<td colspan="2" class="title_description">' + V.I18n.getTrans("i.Description") + 
    "</td>" + "</tr>" + '<tr class="odd">' + '<td colspan="2" class="info_description"><div class="height_wrapper_description">' + description + "</div></td>" + "</tr>" + "</table>"
  };
  var convertToTagsArray = function(tags) {
    var tagsArray = [];
    if(!tags || tags.length == 0) {
      return tagsArray
    }
    $.each(tags, function(index, tag) {
      tagsArray.push(tag.value)
    });
    return tagsArray
  };
  var autocompleteUrls = function(input) {
    var http_urls_pattern = /(^http(s)?:\/\/)/g;
    var objectInfo = V.Object.getObjectInfo();
    if(objectInfo.wrapper == null && input.match(http_urls_pattern) == null) {
      return"http://" + input
    }else {
      return input
    }
  };
  var filterFilePath = function(path) {
    return path.replace("C:\\fakepath\\", "")
  };
  var prepareSlideToNest = function(parentId, slide) {
    if(typeof parentId !== "string") {
      return slide
    }
    if(slide.type === V.Constant.FLASHCARD || slide.type === V.Constant.VTOUR) {
      return
    }
    slide.id = parentId + "_" + slide.id;
    if(slide.elements) {
      $.each(slide.elements, function(index, element) {
        slide.elements[index].id = parentId + "_" + slide.elements[index].id
      })
    }
    return slide
  };
  var undoNestedSlide = function(parentId, slide) {
    if(typeof parentId !== "string") {
      return slide
    }
    if(slide.type === V.Constant.FLASHCARD || slide.type === V.Constant.VTOUR) {
      return
    }
    slide.id = slide.id.replace(parentId + "_", "");
    if(slide.elements) {
      $.each(slide.elements, function(index, element) {
        slide.elements[index].id = slide.elements[index].id.replace(parentId + "_", "")
      })
    }
    return slide
  };
  var replaceIdsForSlide = function(slide) {
    var slideId = V.Utils.getId("article");
    $(slide).attr("id", slideId);
    var slideType = V.Slides.getSlideType(slide);
    switch(slideType) {
      case V.Constant.STANDARD:
        slide = _replaceIdsForStandardSlide(slide, slideId);
        break;
      case V.Constant.FLASHCARD:
        slide = _replaceIdsForFlashcardSlide(slide, slideId);
        break;
      case V.Constant.VTOUR:
        slide = _replaceIdsForVirtualTourSlide(slide, slideId);
        break;
      default:
        return
    }
    return slide
  };
  var _replaceIdsForStandardSlide = function(slide, slideId) {
    $(slide).children("div[id][areaid]").each(function(index, zone) {
      zone = _replaceIdsForZone(zone, slideId)
    });
    return slide
  };
  var _replaceIdsForFlashcardSlide = function(flashcard, flashcardId) {
    var pois = $(flashcard).find("div.fc_poi");
    $(pois).each(function(index, poi) {
      var poiId = V.Utils.getId(flashcardId + "_poi");
      $(poi).attr("id", poiId)
    });
    var subslides = $(flashcard).find(".subslides > article.subslide");
    $(subslides).each(function(index, subSlide) {
      subSlide = _replaceIdsForSubSlide(subSlide, flashcardId)
    });
    return flashcard
  };
  var _replaceIdsForVirtualTourSlide = function(vt, vtId) {
    var canvas = $(vt).find(".map_canvas");
    var canvasId = V.Utils.getId(vtId + "_canvas");
    $(canvas).attr("id", canvasId);
    var subslides = $(vt).find(".subslides > article.subslide");
    $(subslides).each(function(index, subSlide) {
      subSlide = _replaceIdsForSubSlide(subSlide, vtId)
    });
    return vt
  };
  var _replaceIdsForSubSlide = function(subSlide, parentId) {
    var slideId = V.Utils.getId(parentId + "_article");
    $(subSlide).attr("id", slideId);
    $(subSlide).children(".close_subslide").attr("id", "close" + slideId);
    var zones = $(subSlide).children("div[id]").not(".close_subslide");
    $(zones).each(function(index, zone) {
      zone = _replaceIdsForZone(zone, slideId)
    })
  };
  var _replaceIdsForZone = function(zone, slideId) {
    var zoneId = V.Utils.getId(slideId + "_zone");
    $(zone).attr("id", zoneId);
    $(zone).find("[id]").each(function(index, el) {
      el = _replaceIdsForEl(el, zoneId)
    });
    return zone
  };
  var _replaceIdsForEl = function(el, zoneId) {
    var elName = _getNameOfEl(el);
    var elId = V.Utils.getId(zoneId + "_" + elName);
    $(el).attr("id", elId);
    return el
  };
  var _getNameOfEl = function(el) {
    var elName = $($(el).attr("id").split("_")).last()[0];
    if(elName.length > 1) {
      return elName.substring(0, elName.length - 1)
    }else {
      return elName
    }
  };
  var replaceIdsForSlideJSON = function(slide, forceId) {
    var slideType = slide.type;
    var slideId;
    if(forceId) {
      slideId = forceId
    }else {
      slideId = V.Utils.getId("article")
    }
    switch(slideType) {
      case V.Constant.STANDARD:
        slide = _replaceIdsForStandardSlideJSON(slide, slideId);
        break;
      case V.Constant.FLASHCARD:
        slide = _replaceIdsForFlashcardJSON(slide, slideId);
        break;
      case V.Constant.VTOUR:
        slide = _replaceIdsForVTourJSON(slide, slideId);
        break;
      default:
        return
    }
    return slide
  };
  var _replaceIdsForStandardSlideJSON = function(slide, slideId) {
    var s = jQuery.extend(true, {}, slide);
    var oldId = s.id;
    s.id = slideId;
    var eL = s.elements.length;
    for(var i = 0;i < eL;i++) {
      var el = s.elements[i];
      if(el.id.match(new RegExp("^" + oldId, "g")) != null) {
        el.id = el.id.replace(oldId, s.id)
      }else {
        return null
      }
    }
    return s
  };
  var _replaceIdsForFlashcardJSON = function(flashcard, fcId) {
    var hash_subslide_new_ids = {};
    var old_id;
    var fc = jQuery.extend(true, {}, flashcard);
    fc.id = fcId;
    for(var ind in fc.slides) {
      old_id = fc.slides[ind].id;
      fc.slides[ind] = _replaceIdsForStandardSlideJSON(fc.slides[ind], fc.id + "_article" + (parseInt(ind) + 1));
      if(fc.slides[ind] === null) {
        return null
      }
      hash_subslide_new_ids[old_id] = fc.slides[ind].id
    }
    for(var num in fc.pois) {
      fc.pois[num].id = fc.id + "_poi" + (parseInt(num) + 1);
      fc.pois[num].slide_id = hash_subslide_new_ids[fc.pois[num].slide_id]
    }
    return fc
  };
  var _replaceIdsForVTourJSON = function(vTour, vTourId) {
    var hash_subslide_new_ids = {};
    var old_id;
    var vt = jQuery.extend(true, {}, vTour);
    vt.id = vTourId;
    for(var ind in vt.slides) {
      old_id = vt.slides[ind].id;
      vt.slides[ind] = _replaceIdsForStandardSlideJSON(vt.slides[ind], vt.id + "_article" + (parseInt(ind) + 1));
      hash_subslide_new_ids[old_id] = vt.slides[ind].id
    }
    for(var num in vt.pois) {
      vt.pois[num].id = vt.id + "_poi" + (parseInt(num) + 1);
      vt.pois[num].slide_id = hash_subslide_new_ids[vt.pois[num].slide_id]
    }
    return vt
  };
  var loadTab = function(tab_id) {
    $(".joyride-close-tip").click();
    $(".fancy_tab_content").hide();
    $("#" + tab_id + "_content").show();
    $(".fancy_tab").removeClass("fancy_selected");
    $("#" + tab_id).addClass("fancy_selected");
    $(".help_in_fancybox").hide();
    switch(tab_id) {
      case "tab_presentations_repo":
        V.Editor.Presentation.Repository.beforeLoadTab();
        break;
      case "tab_smartcards_repo":
        V.Editor.Slideset.Repository.beforeLoadTab();
        break;
      case "tab_pic_thumbnails":
        V.Editor.Image.Thumbnails.beforeLoadTab();
        break;
      case "tab_pic_repo":
        V.Editor.Image.Repository.beforeLoadTab();
        break;
      case "tab_pic_flikr":
        V.Editor.Image.Flikr.beforeLoadTab();
        break;
      case "tab_pic_lre":
        V.Editor.Image.LRE.beforeLoadTab();
        break;
      case "tab_video_repo":
        V.Editor.Video.Repository.beforeLoadTab();
        break;
      case "tab_video_youtube":
        V.Editor.Video.Youtube.beforeLoadTab();
        break;
      case "tab_video_vimeo":
        V.Editor.Video.Vimeo.beforeLoadTab();
        break;
      case "tab_object_repo":
        V.Editor.Object.Repository.beforeLoadTab();
        break;
      case "tab_object_lre":
        V.Editor.Object.LRE.beforeLoadTab();
        break;
      case "tab_live_resource":
        V.Editor.Object.Live.beforeLoadTab();
        break;
        break;
      default:
        break
    }
    $("#" + tab_id + "_help").show();
    switch(tab_id) {
      case "tab_slides":
        break;
      case "tab_presentations_repo":
        V.Editor.Presentation.Repository.onLoadTab();
        break;
      case "tab_smartcards_repo":
        V.Editor.Slideset.Repository.onLoadTab();
        break;
      case "tab_pic_thumbnails":
        V.Editor.Image.Thumbnails.onLoadTab();
        break;
      case "tab_pic_from_url":
        V.Editor.Image.onLoadTab("url");
        break;
      case "tab_pic_upload":
        V.Editor.Image.onLoadTab("upload");
        break;
      case "tab_pic_repo":
        V.Editor.Image.Repository.onLoadTab();
        break;
      case "tab_pic_flikr":
        V.Editor.Image.Flikr.onLoadTab();
        break;
      case "tab_pic_lre":
        V.Editor.Image.LRE.onLoadTab();
        break;
      case "tab_video_from_url":
        V.Editor.Video.onLoadTab();
        break;
      case "tab_video_repo":
        V.Editor.Video.Repository.onLoadTab();
        break;
      case "tab_video_youtube":
        V.Editor.Video.Youtube.onLoadTab();
        break;
      case "tab_video_vimeo":
        V.Editor.Video.Vimeo.onLoadTab();
        break;
      case "tab_object_from_url":
        V.Editor.Object.onLoadTab("url");
        break;
      case "tab_object_from_web":
        V.Editor.Object.Web.onLoadTab();
        break;
      case "tab_object_snapshot":
        V.Editor.Object.Snapshot.onLoadTab();
        break;
      case "tab_object_upload":
        V.Editor.Object.onLoadTab("upload");
        break;
      case "tab_object_repo":
        V.Editor.Object.Repository.onLoadTab();
        break;
      case "tab_object_lre":
        V.Editor.Object.LRE.onLoadTab();
        break;
      case "tab_live_resource":
        V.Editor.Object.Live.onLoadTab();
        break;
      case "tab_json_file":
        V.Editor.Presentation.File.onLoadTab();
        break;
      case "tab_pdfex":
        V.Editor.PDFex.onLoadTab();
        break;
      default:
        break
    }
    return false
  };
  var addTmpShown = function(els) {
    $(els).each(function(index, el) {
      $(el).addClass("temp_shown")
    })
  };
  var removeTmpShown = function(els) {
    $(els).each(function(index, el) {
      $(el).removeClass("temp_shown")
    })
  };
  return{setStyleInPixels:setStyleInPixels, addZoomToStyle:addZoomToStyle, getStylesInPercentages:getStylesInPercentages, dimentionToDraw:dimentionToDraw, refreshDraggables:refreshDraggables, replaceIdsForSlide:replaceIdsForSlide, replaceIdsForSlideJSON:replaceIdsForSlideJSON, prepareSlideToNest:prepareSlideToNest, undoNestedSlide:undoNestedSlide, generateTable:generateTable, convertToTagsArray:convertToTagsArray, autocompleteUrls:autocompleteUrls, filterFilePath:filterFilePath, loadTab:loadTab, 
  addTmpShown:addTmpShown, removeTmpShown:removeTmpShown}
}(VISH, jQuery);
VISH.Editor.Text = function(V, $, undefined) {
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $(document).on("click", ".textthumb", launchTextEditor);
      CKEDITOR.on("dialogDefinition", function(ev) {
        var dialogName = ev.data.name;
        var dialogDefinition = ev.data.definition;
        if(dialogName == "link") {
          dialogDefinition.getContents("info").remove("linkType");
          var protocols = dialogDefinition.getContents("info").get("protocol").items;
          protocols.splice(3, 1);
          protocols.splice(2, 1);
          dialogDefinition.removeContents("advanced");
          var targetTab = dialogDefinition.getContents("target");
          var targetField = targetTab.get("linkTargetType");
          targetField["default"] = "_blank";
          targetField.items.splice(6, 1);
          targetField.items.splice(4, 1);
          targetField.items.splice(1, 1);
          targetField.items.splice(0, 1)
        }
        if(dialogName == "table") {
          dialogDefinition.removeContents("advanced");
          var info = dialogDefinition.getContents("info");
          var alignment = info.get("cmbAlign");
          alignment.items.splice(0, 1);
          alignment["default"] = "center";
          info.remove("selHeaders")
        }
      });
      initialized = true
    }
  };
  var launchTextEditor = function(event, area, initial_text, options) {
    init();
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = $(this).parents(".selectable")
    }
    var isQuiz = $("div[type='quiz']").has(current_area).length > 0;
    var isTemplateArea = $(current_area).attr("areaid") !== undefined;
    if(isTemplateArea) {
      current_area.attr("type", "text")
    }
    var wysiwygContainerId = V.Utils.getId();
    var wysiwygContainer = $("<div id='" + wysiwygContainerId + "' class='wysiwygTextArea'></div>");
    $(wysiwygContainer).attr("style", "width: 100%; height: 100%");
    $(current_area).append(wysiwygContainer);
    var config = {};
    config.toolbar = "Full";
    config.toolbar_Full = [{name:"first", items:["Bold", "Italic", "Underline", "-", "Subscript", "Superscript", "Font", "FontSize", "TextColor", "BGColor"]}, "/", {name:"lists", items:["NumberedList", "BulletedList", "Table"]}, {name:"alignment", items:["JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyBlock"]}, {name:"link", items:["Link"]}];
    config.sharedSpaces = {top:"toolbar_text"};
    config.toolbarCanCollapse = false;
    config.resize_enabled = false;
    config.removePlugins = "elementspath";
    config.extraPlugins = "tableresize,autogrow";
    if(options && options.autogrow) {
      config.autoGrow_minHeight = 34;
      config.autoGrow_maxHeight = 800
    }
    config.width = "100%";
    config.height = $(current_area).height();
    config.fontSize_defaultLabel = "12";
    var ckeditorBasePath = CKEDITOR.basePath.substr(0, CKEDITOR.basePath.indexOf("editor/"));
    config.skin = "vEditor," + ckeditorBasePath + "editor/skins/vEditor/";
    var ckeditor = CKEDITOR.appendTo(wysiwygContainerId, config);
    var myWidth = $(current_area).width();
    var myHeight = $(current_area).height();
    var newInstance = !(typeof initial_text === "string") || options && options.forceNew;
    if(newInstance) {
      var defaultFontSize = 12;
      var defaultAlignment = "left";
      switch($(current_area).attr("size")) {
        case V.Constant.EXTRA_SMALL:
          defaultFontSize = 18;
          break;
        case V.Constant.SMALL:
          defaultFontSize = 18;
          break;
        case V.Constant.MEDIUM:
          defaultFontSize = 26;
          break;
        case V.Constant.LARGE:
          defaultFontSize = 36;
          break;
        default:
          break
      }
      var areaId = $(current_area).attr("areaid");
      if(areaId) {
        var isCircleArea = $(current_area).attr("areaid").indexOf("circle") !== -1;
        if(isCircleArea) {
          defaultAlignment = "center"
        }
      }
      var initialTextColor = "color:#" + V.Editor.Themes.getCurrentTheme().color;
      var blankTextColor = initialTextColor;
      if(options) {
        if(typeof options.fontSize == "number") {
          defaultFontSize = options.fontSize
        }
        if(options.placeholder === true) {
          initialTextColor = "color:#ccc"
        }
      }
      if(isTemplateArea || typeof initial_text != "string" || initial_text === "") {
        initial_text = "&shy"
      }
      initial_text = "<p style='text-align:" + defaultAlignment + ";'><span autoColor='true' style='" + initialTextColor + "'><span style='font-size:" + defaultFontSize + "px;'>" + initial_text + "</span></span></p>";
      initial_text_blank = "<p style='text-align:" + defaultAlignment + ";'><span autoColor='true' style='" + blankTextColor + "'><span style='font-size:" + defaultFontSize + "px;'>" + "&shy" + "</span></span></p>"
    }
    ckeditor.on("instanceReady", function() {
      if(initial_text) {
        ckeditor.setData(initial_text, function() {
          if(isQuiz) {
            var slide = $("article").has(current_area);
            $(slide).addClass("temp_shown");
            var iframeContent = _getCKEditorIframeContentFromInstance(ckeditor);
            var newMyHeight = $(iframeContent).find("html").height();
            $(slide).removeClass("temp_shown");
            if(newMyHeight > myHeight) {
              ckeditor.resize(myWidth, newMyHeight)
            }
          }else {
            ckeditor.resize(myWidth, myHeight)
          }
          _fixCKEDITORBug(ckeditor)
        });
        if(newInstance) {
          if(isTemplateArea || options && options.focus) {
            ckeditor.focus()
          }
        }
      }
    });
    ckeditor.on("resize", function(event) {
    });
    ckeditor.on("focus", function(event) {
      V.Status.setCKEditorInstanceFocused(true);
      if(options && options.placeholder === true) {
        var a = $(initial_text).text().replace(/\s+/g, "");
        var b = $(event.editor.getData()).text().replace(/\s+/g, "");
        if(a == b) {
          setTimeout(function() {
            event.editor.setData(initial_text_blank);
            event.editor.focus()
          }, 20)
        }
      }
      var area = getZoneForCKContainer(event.editor.container.$);
      V.Editor.selectArea(area)
    });
    ckeditor.on("blur", function(event) {
      V.Status.setCKEditorInstanceFocused(false)
    });
    ckeditor.getPlainText = _getPlainText;
    if(isTemplateArea) {
      V.Editor.addDeleteButton(current_area)
    }
  };
  var getCKEditorFromZone = function(zone) {
    if(!zone || typeof CKEDITOR === "undefined" || typeof CKEDITOR.instances === "undefined") {
      return null
    }
    var CKEditorInstance = null;
    jQuery.each(CKEDITOR.instances, function(name, CKinstance) {
      var CKzone = getZoneForCKContainer(CKinstance.container.$);
      if($(CKzone).attr("id") === $(zone).attr("id")) {
        CKEditorInstance = CKinstance;
        return
      }
    });
    return CKEditorInstance
  };
  var getZoneForCKContainer = function(container) {
    var area;
    area = $("div[type='text']").has(container);
    if(area.length === 0) {
      area = $("div[type='quiz']").has(container)
    }
    return area
  };
  var getCKEditorIframeContentFromZone = function(zone) {
    var editor = getCKEditorFromZone(zone);
    if(!editor) {
      return null
    }
    return _getCKEditorIframeContentFromInstance(editor)
  };
  var _getCKEditorIframeContentFromInstance = function(editor) {
    var iframe = $(document.getElementById("cke_contents_" + editor.name)).find("iframe")[0];
    return $(iframe).contents()[0]
  };
  var getCKEditorFromTextArea = function(textArea) {
    if(!textArea || typeof CKEDITOR === "undefined" || typeof CKEDITOR.instances === "undefined") {
      return null
    }
    if(!$(textArea).hasClass(".cke_skin_vEditor")) {
      textArea = $(textArea).find(".cke_skin_vEditor");
      if(textArea.length > 0) {
        textArea = textArea[0]
      }
    }
    var CKEditorInstance = null;
    jQuery.each(CKEDITOR.instances, function(name, CKinstance) {
      if(textArea === CKinstance.container.$) {
        CKEditorInstance = CKinstance;
        return
      }
    });
    return CKEditorInstance
  };
  var _getPlainText = function() {
    return $(this.getSnapshot()).text()
  };
  var _fixCKEDITORBug = function(editor) {
    if(CKEDITOR.env.webkit) {
      var iframe = $(document.getElementById("cke_contents_" + editor.name)).find("iframe")[0];
      iframe.style.display = "none";
      iframe.style.display = "block"
    }
  };
  var refreshAutoColors = function() {
    var currentColor = "color:#" + V.Editor.Themes.getCurrentTheme().color;
    jQuery.each(CKEDITOR.instances, function(name, CKinstance) {
      var iframe = $($(document.getElementById("cke_contents_" + CKinstance.name)).find("iframe")[0]).contents()[0];
      var spans = $(iframe).find("span[autocolor][style]");
      jQuery.each(spans, function(name, span) {
        $(span).attr("style", currentColor + ";")
      })
    })
  };
  return{init:init, launchTextEditor:launchTextEditor, getCKEditorFromZone:getCKEditorFromZone, getCKEditorIframeContentFromZone:getCKEditorIframeContentFromZone, getCKEditorFromTextArea:getCKEditorFromTextArea, refreshAutoColors:refreshAutoColors}
}(VISH, jQuery);
VISH.Editor.Video = function(V, $, undefined) {
  var urlDivId = "tab_video_from_url_content";
  var init = function() {
    V.Editor.Video.HTML5.init();
    V.Editor.Video.Repository.init();
    V.Editor.Video.Youtube.init();
    V.Editor.Video.Vimeo.init();
    var urlInput = $("#" + urlDivId).find("input");
    $("#tab_video_from_url_content .previewButton").click(function(event) {
      if(V.Police.validateObject($(urlInput).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($(urlInput).val());
        V.Editor.Object.drawPreview("tab_video_from_url_content", contentToAdd)
      }else {
        contentToAdd = null
      }
    })
  };
  var onLoadTab = function(tab) {
    $("#tab_video_from_url_content").find("input").val("");
    V.Editor.Object.resetPreview("tab_video_from_url_content")
  };
  var drawPreviewElement = function() {
    V.Editor.Object.drawPreviewObject(contentToAdd)
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement}
}(VISH, jQuery);
VISH.Editor.Image = function(V, $, undefined) {
  var contentToAdd = null;
  var contentAddMode = V.Constant.NONE;
  var uploadDivId = "tab_pic_upload_content";
  var urlDivId = "tab_pic_from_url_content";
  var urlInputId = "picture_url";
  var init = function() {
    V.Editor.Image.Flikr.init();
    V.Editor.Image.Repository.init();
    V.Editor.Image.LRE.init();
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        V.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    });
    var options = V.Editor.getOptions();
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_document_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          var description = "Uploaded by " + V.User.getName() + " via ViSH Editor";
          $("#" + uploadDivId + " input[name='document[description]']").val(description);
          $("#" + uploadDivId + " input[name='document[owner_id]']").val(V.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
          $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadImagePath);
          var tagList = $("#" + uploadDivId + " .tagList");
          $("#" + uploadDivId + " input[name='document[tag_list]']").val(V.Editor.Utils.convertToTagsArray($(tagList).tagit("tags")));
          $(tagList).parent().hide();
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      switch(V.Configuration.getConfiguration()["mode"]) {
        case V.Constant.NOSERVER:
          processResponse('{"src":"/vishEditor/images/excursion_thumbnails/excursion-01.png"}');
          break;
        case V.Constant.VISH:
          processResponse(xhr.responseText);
          break;
        case V.Constant.STANDALONE:
          processResponse(xhr.responseText);
          break
      }
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, error:function(error) {
      V.Debugging.log("Upload error");
      V.Debugging.log(error)
    }})
  };
  var onLoadTab = function(tab) {
    if(tab == "upload") {
      _onLoadUploadTab()
    }
    if(tab == "url") {
      _onLoadURLTab()
    }
  };
  var _onLoadURLTab = function() {
    contentToAdd = null;
    V.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var _onLoadUploadTab = function() {
    contentToAdd = null;
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    V.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    V.Editor.Object.resetPreview(uploadDivId);
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList)[0].children.length !== 0) {
      $(tagList).tagit("reset")
    }
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:20, maxTags:8, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(V.Police.validateObject(jsonResponse.src)[0]) {
          V.Editor.Object.drawPreview(uploadDivId, jsonResponse.src);
          contentToAdd = jsonResponse.src
        }
      }
    }catch(e) {
    }
  };
  var addContent = function(content, options) {
    if(content) {
      contentToAdd = content
    }
    switch(contentAddMode) {
      case V.Constant.FLASHCARD:
        V.Editor.Flashcard.onBackgroundSelected(contentToAdd);
        break;
      case V.Constant.THUMBNAIL:
        V.Editor.Settings.onThumbnailSelected(contentToAdd);
        break;
      default:
        V.Editor.Object.drawPreviewObject(contentToAdd, {forceType:V.Constant.MEDIA.IMAGE})
    }
    contentAddMode = V.Constant.NONE
  };
  var drawImage = function(image_url, area, style, hyperlink) {
    _drawImageInArea(image_url, area, style, hyperlink)
  };
  var _drawImageInArea = function(image_url, area, style, hyperlink) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    var newStyle;
    if(style) {
      newStyle = V.Editor.Utils.setStyleInPixels(style, current_area)
    }else {
      var image_width = $(current_area).width();
      newStyle = "width:" + image_width + "px;"
    }
    var template = V.Editor.getTemplate();
    var nextImageId = V.Utils.getId();
    var idToDragAndResize = "draggable" + nextImageId;
    current_area.attr("type", "image");
    if(hyperlink) {
      current_area.attr("hyperlink", hyperlink)
    }
    current_area.html("<img class='" + template + "_image' id='" + idToDragAndResize + "' draggable='true' title='Click to drag' src='" + image_url + "' style='" + newStyle + "'/>");
    if(!style) {
      var theImg = $("#" + idToDragAndResize);
      $(theImg).load(function() {
        $(current_area).parent().addClass("temp_shown");
        $(current_area).addClass("temp_shown");
        $(theImg).addClass("temp_shown");
        var dimentionsToDraw = V.Editor.Utils.dimentionToDraw($(current_area).width(), $(current_area).height(), $(theImg).width(), $(theImg).height());
        $(current_area).parent().removeClass("temp_shown");
        $(current_area).removeClass("temp_shown");
        $(theImg).removeClass("temp_shown");
        $(theImg).width(dimentionsToDraw.width);
        if(dimentionsToDraw.height > 0) {
          $(theImg).height(dimentionsToDraw.height)
        }
      })
    }
    V.Editor.addDeleteButton(current_area);
    $("#" + idToDragAndResize).draggable({cursor:"move", stop:function() {
      $(this).parent().click()
    }})
  };
  var getAddContentMode = function() {
    return contentAddMode
  };
  var setAddContentMode = function(mode) {
    contentAddMode = mode
  };
  return{init:init, onLoadTab:onLoadTab, drawImage:drawImage, addContent:addContent, getAddContentMode:getAddContentMode, setAddContentMode:setAddContentMode}
}(VISH, jQuery);
VISH.Editor.Object = function(V, $, undefined) {
  var contentToAdd = null;
  var uploadDivId = "tab_object_upload_content";
  var urlDivId = "tab_object_from_url_content";
  var urlInputId = "object_embed_code";
  var init = function() {
    V.Editor.Object.LRE.init();
    V.Editor.Object.Repository.init();
    V.Editor.Object.Live.init();
    V.Editor.Object.Web.init();
    V.Editor.Object.GoogleDOC.init();
    V.Editor.Object.Snapshot.init();
    var urlInput = $("#" + urlDivId).find("input");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        drawPreview(urlDivId, contentToAdd)
      }
    });
    var options = V.Editor.getOptions();
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_document_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          var description = "Uploaded by " + V.User.getName() + " via ViSH Editor";
          $("#" + uploadDivId + " input[name='document[description]']").val(description);
          $("#" + uploadDivId + " input[name='document[owner_id]']").val(V.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
          $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadObjectPath);
          var tagList = $("#" + uploadDivId + " .tagList");
          $("#" + uploadDivId + " input[name='document[tag_list]']").val(V.Editor.Utils.convertToTagsArray($(tagList).tagit("tags")));
          $(tagList).parent().hide();
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      switch(V.Configuration.getConfiguration()["mode"]) {
        case V.Constant.NOSERVER:
          processResponse('{"src":"/vishEditor/images/excursion_thumbnails/excursion-01.png"}');
          break;
        case V.Constant.VISH:
          processResponse(xhr.responseText);
          break;
        case V.Constant.STANDALONE:
          processResponse(xhr.responseText);
          break
      }
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, error:function(error) {
      V.Debugging.log("Upload error");
      V.Debugging.log(error)
    }})
  };
  var onLoadTab = function(tab) {
    if(tab == "upload") {
      _onLoadUploadTab()
    }
    if(tab == "url") {
      _onLoadURLTab()
    }
  };
  var _onLoadURLTab = function() {
    contentToAdd = null;
    resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var _onLoadUploadTab = function() {
    contentToAdd = null;
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    V.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    resetPreview(uploadDivId);
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList)[0].children.length !== 0) {
      $(tagList).tagit("reset")
    }
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:20, maxTags:8, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(V.Police.validateObject(jsonResponse.src)[0]) {
          drawPreview(uploadDivId, jsonResponse.src);
          contentToAdd = jsonResponse.src
        }
      }
    }catch(e) {
    }
  };
  var previewBackground;
  var drawPreview = function(divId, src) {
    previewBackground = $("#" + divId + " .previewimgbox").css("background-image");
    $("#" + divId + " .previewimgbox").css("background-image", "none");
    $("#" + divId + " .previewimgbox img.imagePreview").remove();
    var wrapper = renderObjectPreview(src);
    if($("#" + divId + " .previewimgbox .objectPreview").length > 0) {
      $("#" + divId + " .previewimgbox .objectPreview").remove()
    }
    $("#" + divId + " .previewimgbox").append(wrapper);
    $("#" + divId + " .previewimgbox button").show();
    $("#" + divId + " .documentblank").addClass("documentblank_extraMargin")
  };
  var resetPreview = function(divId) {
    $("#" + divId + " .previewimgbox button").hide();
    $("#" + divId + " .previewimgbox img.imagePreview").remove();
    $("#" + divId + " .previewimgbox .objectPreview").remove();
    if(previewBackground) {
      $("#" + divId + " .previewimgbox").css("background-image", previewBackground)
    }
    $("#" + divId + " .documentblank").removeClass("documentblank_extraMargin")
  };
  var drawPreviewElement = function() {
    drawPreviewObject(contentToAdd)
  };
  var drawPreviewObject = function(content, options) {
    if(content) {
      drawObject(content, options);
      $.fancybox.close()
    }
  };
  var resizeObject = function(id, newWidth) {
    var parent = $("#" + id).parent();
    var aspectRatio = $("#" + id).width() / $("#" + id).height();
    var newWrapperHeight = Math.round(newWidth / aspectRatio);
    var newWrapperWidth = Math.round(newWidth);
    $(parent).width(newWrapperWidth);
    $(parent).height(newWrapperHeight);
    var zoom = V.Utils.getZoomFromStyle($("#" + id).attr("style"));
    if(zoom != 1) {
      newWidth = newWidth / zoom;
      var newHeight = Math.round(newWidth / aspectRatio);
      newWidth = Math.round(newWidth)
    }else {
      var newHeight = newWrapperHeight;
      var newWidth = newWrapperWidth
    }
    $("#" + id).width(newWidth);
    $("#" + id).height(newHeight)
  };
  var _adjustWrapperOfObject = function(objectID, current_area) {
    var proportion = $("#" + objectID).height() / $("#" + objectID).width();
    var maxWidth = current_area.width();
    var maxHeight = current_area.height();
    var width = $("#" + objectID).width();
    var height = $("#" + objectID).height();
    if(width > maxWidth) {
      $("#" + objectID).width(maxWidth);
      $("#" + objectID).height(width * proportion);
      width = maxWidth;
      height = $("#" + objectID).height()
    }
    if(height > maxHeight) {
      $("#" + objectID).height(maxHeight);
      $("#" + objectID).width(height / proportion);
      width = $("#" + objectID).width();
      height = maxHeight
    }
    var wrapper = $("#" + objectID).parent();
    if($(wrapper).hasClass("object_wrapper")) {
      $(wrapper).height($("#" + objectID).height());
      $(wrapper).width($("#" + objectID).width())
    }
  };
  var autofixWrapperedObjectAfterZoom = function(object, zoom) {
    var wrapper = $(object).parent();
    $(object).height($(wrapper).height() / zoom);
    $(object).width($(wrapper).width() / zoom)
  };
  var renderObjectPreview = function(object) {
    var objectInfo = V.Object.getObjectInfo(object);
    switch(objectInfo.wrapper) {
      case null:
        switch(objectInfo.type) {
          case V.Constant.MEDIA.IMAGE:
            return"<img class='imagePreview' src='" + object + "'></img>";
            break;
          case V.Constant.MEDIA.FLASH:
            return"<embed class='objectPreview' src='" + object + "' wmode='opaque' ></embed>";
            break;
          case V.Constant.MEDIA.PDF:
          ;
          case V.Constant.MEDIA.DOC:
          ;
          case V.Constant.MEDIA.PPT:
            return V.Editor.Object.GoogleDOC.generatePreviewWrapper(object);
            break;
          case V.Constant.MEDIA.YOUTUBE_VIDEO:
            return V.Editor.Video.Youtube.generatePreviewWrapperForYoutubeVideoUrl(object);
            break;
          case V.Constant.MEDIA.HTML5_VIDEO:
            return V.Editor.Video.HTML5.renderVideoFromSources([object]);
            break;
          case V.Constant.MEDIA.WEB:
            return V.Editor.Object.Web.generatePreviewWrapperForWeb(object);
            break;
          default:
            V.Debugging.log("Unrecognized object source type");
            break
        }
        break;
      case V.Constant.WRAPPER.EMBED:
        return _genericWrapperPreview(object);
        break;
      case V.Constant.WRAPPER.OBJECT:
        return _genericWrapperPreview(object);
        break;
      case V.Constant.WRAPPER.IFRAME:
        return _genericWrapperPreview(object);
        break;
      default:
        V.Debugging.log("Unrecognized object wrapper: " + objectInfo.wrapper);
        break
    }
  };
  var _genericWrapperPreview = function(object) {
    var wrapperPreview = $(object);
    $(wrapperPreview).addClass("objectPreview");
    $(wrapperPreview).attr("wmode", "opaque");
    $(wrapperPreview).removeAttr("width");
    $(wrapperPreview).removeAttr("height");
    return wrapperPreview
  };
  var drawObject = function(object, options) {
    if(!V.Police.validateObject(object)[0]) {
      return
    }
    var objectInfo = V.Object.getObjectInfo(object);
    var current_area = V.Editor.getCurrentArea();
    var object_style = "";
    var zoomInStyle;
    if(options) {
      if(options.area) {
        current_area = options.area
      }
      if(options.style) {
        object_style = options.style
      }
      if(options.zoomInStyle) {
        zoomInStyle = options.zoomInStyle
      }
      if(options.forceType) {
        objectInfo.wrapper = null;
        objectInfo.type = options.forceType
      }
    }
    switch(objectInfo.wrapper) {
      case null:
        switch(objectInfo.type) {
          case V.Constant.MEDIA.IMAGE:
            V.Editor.Image.drawImage(object);
            break;
          case V.Constant.MEDIA.FLASH:
            V.Editor.Object.Flash.drawFlashObjectWithSource(object, object_style);
            break;
          case V.Constant.MEDIA.PDF:
          ;
          case V.Constant.MEDIA.DOC:
          ;
          case V.Constant.MEDIA.PPT:
            V.Editor.Object.drawObject(V.Editor.Object.GoogleDOC.generateWrapper(object));
            break;
          case V.Constant.MEDIA.YOUTUBE_VIDEO:
            V.Editor.Object.drawObject(V.Editor.Video.Youtube.generateWrapperForYoutubeVideoUrl(object));
            break;
          case V.Constant.MEDIA.HTML5_VIDEO:
            V.Editor.Video.HTML5.drawVideoWithUrl(object);
            break;
          case V.Constant.MEDIA.WEB:
            V.Editor.Object.drawObject(V.Editor.Object.Web.generateWrapperForWeb(object));
            break;
          default:
            V.Debugging.log("Unrecognized object source type: " + objectInfo.type);
            break
        }
        break;
      case V.Constant.WRAPPER.EMBED:
        drawObjectWithWrapper(object, current_area, object_style);
        break;
      case V.Constant.WRAPPER.OBJECT:
        drawObjectWithWrapper(object, current_area, object_style);
        break;
      case V.Constant.WRAPPER.IFRAME:
        drawObjectWithWrapper(object, current_area, object_style, zoomInStyle);
        break;
      default:
        V.Debugging.log("Unrecognized object wrapper: " + objectInfo.wrapper);
        break
    }
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var drawObjectWithWrapper = function(wrapper, current_area, style, zoomInStyle) {
    var template = V.Editor.getTemplate(current_area);
    var nextWrapperId = V.Utils.getId();
    var idToDrag = "draggable" + nextWrapperId;
    var idToResize = "resizable" + nextWrapperId;
    current_area.attr("type", "object");
    var wrapperDiv = document.createElement("div");
    wrapperDiv.setAttribute("id", idToDrag);
    wrapperDiv.setAttribute("draggable", true);
    if(style) {
      wrapperDiv.setAttribute("style", style)
    }
    $(wrapperDiv).addClass("object_wrapper");
    var wrapperTag = $(wrapper);
    $(wrapperTag).attr("id", idToResize);
    $(wrapperTag).css("pointer-events", "none");
    $(wrapperTag).attr("class", template + "_object");
    $(wrapperTag).attr("wmode", "opaque");
    $(current_area).html("");
    $(current_area).append(wrapperDiv);
    V.Editor.addDeleteButton($(current_area));
    $(wrapperDiv).append(wrapperTag);
    $("#" + idToDrag).draggable({cursor:"move"});
    _adjustWrapperOfObject(idToResize, current_area);
    V.Editor.Tools.loadToolbarForObject(wrapper);
    if(zoomInStyle) {
      $(wrapperTag).attr("style", zoomInStyle);
      V.ObjectPlayer.adjustDimensionsAfterZoom($(wrapperTag))
    }
  };
  return{init:init, onLoadTab:onLoadTab, drawObject:drawObject, renderObjectPreview:renderObjectPreview, resizeObject:resizeObject, autofixWrapperedObjectAfterZoom:autofixWrapperedObjectAfterZoom, drawPreview:drawPreview, resetPreview:resetPreview, drawPreviewElement:drawPreviewElement, drawPreviewObject:drawPreviewObject}
}(VISH, jQuery);
VISH.Editor.Presentation = function(V, $, undefined) {
  var init = function() {
    V.Editor.Presentation.File.init();
    V.EventsNotifier.registerCallback(V.Constant.Event.onSelectedSlides, function(params) {
      insertPresentation(params.JSON, params.acceptedSlides);
      $.fancybox.close()
    })
  };
  var _onConnect = function(origin) {
    V.IframeAPI.registerCallback("onMessage", function(VEMessage, origin) {
      var VEMessageObject = JSON.parse(VEMessage);
      if(VEMessageObject.VEevent === V.Constant.Event.onSelectedSlides) {
        V.Messenger.Helper.processVEMessage(VEMessage)
      }
    })
  };
  var previewPresentation = function(presentation) {
    V.Editor.Preview.preview({insertMode:true, slideNumberToPreview:1, presentationJSON:presentation});
    V.IframeAPI.init({callback:_onConnect})
  };
  var insertPresentation = function(presentationJSON, selectedSlideNumbers) {
    var snL = selectedSlideNumbers.length;
    if(snL < 1) {
      $.fancybox.close();
      return
    }
    presentationJSON = V.Utils.fixPresentation(presentationJSON);
    if(presentationJSON === null) {
      V.Utils.showPNotValidDialog();
      $.fancybox.close();
      return
    }
    var selectedSlides = [];
    var flashcards = [];
    var vts = [];
    for(var i = 0;i < snL;i++) {
      var slide = presentationJSON.slides[selectedSlideNumbers[i] - 1];
      var mySlide = V.Editor.Utils.replaceIdsForSlideJSON(slide);
      if(mySlide === null) {
        $.fancybox.close();
        V.Debugging.log("Not valid presentation");
        return null
      }
      switch(mySlide.type) {
        case V.Constant.FLASHCARD:
          flashcards.push(mySlide);
          break;
        case V.Constant.VTOUR:
          vts.push(mySlide);
          break;
        default:
          break
      }
      selectedSlides.push(mySlide)
    }
    presentationJSON.slides = selectedSlides;
    V.Editor.Renderer.renderPresentation(presentationJSON);
    V.Slides.updateSlides();
    V.Slides.lastSlide();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber())
    });
    V.Editor.Utils.Loader.unloadAllObjects();
    if(V.Slides.getCurrentSlideNumber() > 0) {
      V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
    }
    $.fancybox.close()
  };
  return{init:init, insertPresentation:insertPresentation, previewPresentation:previewPresentation}
}(VISH, jQuery);
VISH.Editor.Presentation.Repository = function(V, $, undefined) {
  var containerDivId = "tab_presentations_repo_content";
  var carrouselDivId = "tab_presentations_repo_content_carrousel";
  var previewDivId = "tab_presentations_repo_content_preview";
  var previewButton;
  var myInput;
  var timestampLastSearch;
  var currentPresentations = new Array;
  var selectedPres = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    });
    previewButton = $("#" + previewDivId).find("button.okButton2");
    $(previewButton).click(function() {
      if(selectedPres) {
        V.Editor.Presentation.previewPresentation(selectedPres)
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestExcursions(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectMetadata();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId), {style:"loading_presentation_carrousel"});
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectMetadata();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.excursions || data.excursions.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    currentExcursions = new Array;
    $.each(data.excursions, function(index, pres) {
      if(!pres.id) {
        pres.id = V.Utils.getId("tmp")
      }
      if(!pres.avatar) {
        pres.avatar = V.ImagesPath + "icons/defaultAvatar.png"
      }
      var myImg = $("<img excursionId ='" + pres.id + "'' src=" + pres.avatar + " />");
      carrouselImages.push(myImg);
      currentExcursions[pres.id] = pres
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.width = 800;
        options.styleClass = "presentation_repository";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var excursionId = $(event.target).attr("excursionId");
    if(excursionId) {
      $(".excursionSelectedInCarrousel").removeClass("excursionSelectedInCarrousel");
      $(event.target).addClass("excursionSelectedInCarrousel");
      selectedPres = currentExcursions[excursionId];
      _renderObjectMetadata(selectedPres)
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectMetadata = function(object) {
    var metadataArea = $("#" + previewDivId).find("div.content_preview_metadata");
    $(metadataArea).html("");
    if(object) {
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description, tableClass:"metadata metadata_presentation"});
      $(metadataArea).html(table);
      $(previewButton).show()
    }
  };
  var _cleanObjectMetadata = function() {
    var metadataArea = $("#" + previewDivId).find("div.content_preview_metadata");
    $(metadataArea).html("");
    $(previewButton).hide()
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Slideset = function(V, $, undefined) {
  var initialized = false;
  var currentSubslide;
  var init = function() {
    if(initialized) {
      return
    }
    initialized = true
  };
  var getCreatorModule = function(obj) {
    type = _getTypeIfPresent(obj);
    switch(type) {
      case V.Constant.FLASHCARD:
        return V.Editor.Flashcard;
        break;
      case V.Constant.VTOUR:
        return V.Editor.VirtualTour;
        break;
      default:
        return null
    }
  };
  var getDummy = function(slideset, options) {
    var slidesetCreator = getCreatorModule(slideset);
    if(typeof slidesetCreator.getDummy == "function") {
      if(!options || typeof options.slidesetId != "string") {
        var slidesetId = V.Utils.getId("article")
      }else {
        var slidesetId = options.slidesetId
      }
      return slidesetCreator.getDummy(slidesetId, options)
    }
  };
  var isSlideset = function(obj) {
    type = _getTypeIfPresent(obj);
    return V.Slides.isSlideset(type)
  };
  var _getTypeIfPresent = function(obj) {
    if(typeof obj == "string") {
      return obj
    }else {
      if(typeof obj == "object") {
        return $(obj).attr("type")
      }
    }
    return undefined
  };
  var getCurrentSubslide = function() {
    return currentSubslide
  };
  var setCurrentSubslide = function(newSubslide) {
    currentSubslide = newSubslide
  };
  var onEnterSlideset = function(slideset) {
    updateThumbnails(slideset);
    $("#bottomside").show();
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    var slidesetId = $(slideset).attr("id");
    var subslides = $("#" + slidesetId + " > article");
    if(typeof slidesetCreator.onEnterSlideset == "function") {
      slidesetCreator.onEnterSlideset(slideset)
    }
    openSlideset(slideset);
    V.Editor.Thumbnails.drawSlidesetThumbnails(subslides, function() {
    })
  };
  var onLeaveSlideset = function(slideset) {
    closeSlideset(slideset);
    var currentSubslide = getCurrentSubslide();
    if(currentSubslide) {
      closeSubslide(currentSubslide)
    }
    $("#bottomside").hide();
    $("#subslide_selected > img").attr("src", "");
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.onLeaveSlideset == "function") {
      slidesetCreator.onLeaveSlideset(slideset)
    }
  };
  var openSlideset = function(slideset) {
    _showSlideButtons(slideset);
    $("#subslide_selected_img").addClass("selectedSlidesetThumbnail");
    var currentSubslide = getCurrentSubslide();
    if(currentSubslide) {
      closeSubslide(currentSubslide)
    }
    V.Editor.Tools.loadToolsForSlide(slideset);
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.loadSlideset == "function") {
      slidesetCreator.loadSlideset(slideset)
    }
  };
  var closeSlideset = function(slideset) {
    _hideSlideButtons(slideset);
    $("#subslide_selected_img").removeClass("selectedSlidesetThumbnail");
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.unloadSlideset == "function") {
      slidesetCreator.unloadSlideset(slideset)
    }
  };
  var beforeCreateSlidesetThumbnails = function() {
    var slideset = V.Slides.getCurrentSlide();
    if(isSlideset(slideset)) {
      var slidesetCreator = getCreatorModule(slideset);
      if(typeof slidesetCreator.beforeCreateSlidesetThumbnails == "function") {
        slidesetCreator.beforeCreateSlidesetThumbnails(slideset)
      }
    }
  };
  var beforeRemoveSlideset = function(slideset) {
    onLeaveSlideset(slideset);
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.beforeRemoveSlideset == "function") {
      slidesetCreator.beforeRemoveSlideset(slideset)
    }
  };
  var beforeRemoveSubslide = function(slideset, subslide) {
    closeSubslide(subslide);
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.beforeRemoveSubslide == "function") {
      slidesetCreator.beforeRemoveSubslide(slideset, subslide)
    }
  };
  var openSubslideWithNumber = function(subslideNumber) {
    var slideset = V.Slides.getCurrentSlide();
    var subslides = $(slideset).find("article");
    var subslide = subslides[subslideNumber - 1];
    openSubslide(subslide)
  };
  var openSubslide = function(subslide) {
    var currentSubslide = getCurrentSubslide();
    if(currentSubslide) {
      closeSubslide(currentSubslide)
    }else {
      var slideset = $(subslide).parent();
      closeSlideset(slideset)
    }
    setCurrentSubslide(subslide);
    _showSubslide(subslide);
    V.Editor.Thumbnails.selectSubslideThumbnail($(subslide).attr("slidenumber"));
    V.Slides.triggerEnterEventById($(subslide).attr("id"))
  };
  var _showSubslide = function(subslide) {
    $(subslide).css("display", "block")
  };
  var _hideSubslide = function(subslide) {
    $(subslide).css("display", "none")
  };
  var closeSubslideWithNumber = function(subslideNumber) {
    var slideset = V.Slides.getCurrentSlide();
    var subslides = $(slideset).find("article");
    var subslide = subslides[subslideNumber - 1];
    closeSubslide(subslide)
  };
  var closeSubslide = function(subslide) {
    setCurrentSubslide(null);
    V.Editor.Thumbnails.selectSubslideThumbnail(null);
    _hideSubslide(subslide);
    V.Slides.triggerLeaveEventById($(subslide).attr("id"))
  };
  var _showSlideButtons = function(slide) {
    $(slide).find("div.delete_slide:first").show();
    $(slide).find("img.help_in_slide:first").show()
  };
  var _hideSlideButtons = function(slide) {
    $(slide).find("div.delete_slide:first").hide();
    $(slide).find("img.help_in_slide:first").hide()
  };
  var updateThumbnails = function(slideset) {
    var thumbnailURL = V.Editor.Thumbnails.getThumbnailURL(slideset);
    $("#subslide_selected > img").attr("src", thumbnailURL);
    var slideThumbnail = V.Editor.Thumbnails.getThumbnailForSlide(slideset);
    $(slideThumbnail).attr("src", thumbnailURL)
  };
  var onClickOpenSlideset = function() {
    var slideset = V.Slides.getCurrentSlide();
    openSlideset(slideset)
  };
  return{init:init, isSlideset:isSlideset, getCreatorModule:getCreatorModule, getDummy:getDummy, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, openSlideset:openSlideset, closeSlideset:closeSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, beforeRemoveSlideset:beforeRemoveSlideset, beforeRemoveSubslide:beforeRemoveSubslide, getCurrentSubslide:getCurrentSubslide, openSubslideWithNumber:openSubslideWithNumber, openSubslide:openSubslide, closeSubslideWithNumber:closeSubslideWithNumber, 
  closeSubslide:closeSubslide, updateThumbnails:updateThumbnails, onClickOpenSlideset:onClickOpenSlideset}
}(VISH, jQuery);
VISH.Editor.VirtualTour = function(V, $, undefined) {
  var initialized = false;
  var geocoder;
  var gMlLoaded = false;
  var vts;
  var init = function() {
    if(!initialized) {
      vts = {};
      _loadEvents();
      V.Utils.Loader.loadGoogleLibrary("https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places", function() {
        geocoder = new google.maps.Geocoder;
        gMlLoaded = true;
        var el = document;
        var evt = document.createEvent("Event");
        evt.initEvent("googleMapsLibraryLoadedinVE", true, true);
        el.dispatchEvent(evt)
      });
      initialized = true
    }
  };
  var _loadEvents = function() {
    $(document).on("keydown", "input.vt_search_input", function(event) {
      if(event.keyCode === 13) {
        event.preventDefault()
      }
    });
    $(document).on("click", "button.vt_search_button", function(event) {
      event.preventDefault();
      _onSearchAddress()
    })
  };
  var getDummy = function(slidesetId, options) {
    return"<article id='" + slidesetId + "' type='" + V.Constant.VTOUR + "' slidenumber='" + options.slideNumber + "'><div class='delete_slide'></div><img class='help_in_slide help_in_vt' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div class='vt_canvas'></div><div class='vt_search'><input class='vt_search_input' type='text' placeholder='" + V.I18n.getTrans("i.Searchplaces") + "'></input><button class='vt_search_button'><img class='vt_search_button_img' src='" + V.ImagesPath + 
    "icons/gsearch.png'/></button></div></article>"
  };
  var _drawMap = function(vtJSON, vtDOM) {
    if(!vtJSON) {
      vtJSON = {};
      vtJSON.center = {"lat":34, "lng":2};
      vtJSON.zoom = 2;
      vtJSON.mapType = V.Constant.VTour.DEFAULT_MAP;
      vtJSON.pois = []
    }
    var vtId = $(vtDOM).attr("id");
    if(typeof vts[vtId] == "undefined") {
      vts[vtId] = vtJSON;
      vts[vtId].markers = {}
    }
    if(vts[vtId].drawed === true) {
      return
    }
    if(!gMlLoaded) {
      $(document).on("googleMapsLibraryLoadedinVE", function() {
        _drawMap(vtJSON, vtDOM)
      });
      return
    }
    vts[vtId].drawed = true;
    $(vtDOM).addClass("temp_shown");
    var latlng = new google.maps.LatLng(vtJSON.center.lat, vtJSON.center.lng);
    var myOptions = {zoom:parseInt(vtJSON.zoom), center:latlng, streetViewControl:false, mapTypeId:vtJSON.mapType};
    var canvas = $(vtDOM).find("div.vt_canvas");
    vts[vtId].map = new google.maps.Map($(canvas)[0], myOptions);
    vts[vtId].overlay = new google.maps.OverlayView;
    vts[vtId].overlay.draw = function() {
    };
    vts[vtId].overlay.setMap(vts[vtId].map);
    _loadLabel();
    var input = $(vtDOM).find("input.vt_search_input")[0];
    var options = {};
    var autocomplete = new google.maps.places.Autocomplete(input, options);
    google.maps.event.addListener(autocomplete, "place_changed", function() {
      _onSearchAddress()
    });
    google.maps.event.addListener(vts[vtId].map, "click", function() {
      $(".vt_search_input").blur()
    });
    google.maps.event.addListenerOnce(vts[vtId].map, "idle", function() {
      $(vtJSON.pois).each(function(index, poi) {
        _addMarkerToCoordinates(poi.lat, poi.lng, poi.slide_id, index + 1, vts[vtId]);
        $(".draggable_sc_div[slide_id='" + poi.slide_id + "']").hide()
      });
      $(vtDOM).removeClass("temp_shown")
    })
  };
  function Label(opt_options) {
    this.setValues(opt_options);
    var span = this.span_ = document.createElement("span");
    $(span).addClass("poi_label");
    var div = this.div_ = document.createElement("div");
    $(div).addClass("poi_label_container");
    div.appendChild(span)
  }
  var labelsInit = false;
  function _loadLabel() {
    if(labelsInit) {
      return
    }
    Label.prototype = new google.maps.OverlayView;
    Label.prototype.onAdd = function() {
      var pane = this.getPanes().overlayImage;
      pane.appendChild(this.div_);
      var me = this;
      this.listeners_ = [google.maps.event.addListener(this, "position_changed", function() {
        me.draw()
      }), google.maps.event.addListener(this, "text_changed", function() {
        me.draw()
      })]
    };
    Label.prototype.onRemove = function() {
      this.div_.parentNode.removeChild(this.div_);
      for(var i = 0, I = this.listeners_.length;i < I;++i) {
        google.maps.event.removeListener(this.listeners_[i])
      }
    };
    Label.prototype.draw = function() {
      var projection = this.getProjection();
      var position = projection.fromLatLngToDivPixel(this.get("position"));
      var div = this.div_;
      div.style.left = position.x + "px";
      div.style.top = position.y + "px";
      div.style.display = "block";
      div.style.zIndex = "2000";
      if(typeof this.get("text") != "undefined") {
        this.span_.innerHTML = this.get("text").toString()
      }
    };
    labelsInit = true
  }
  var _onSearchAddress = function() {
    var currentVT = V.Slides.getCurrentSlide();
    var currentInput = $(currentVT).find("input.vt_search_input");
    var text = $(currentInput).val();
    if(typeof text == "string" && text != "") {
      _getAddressForText(text, function(location) {
        if(location) {
          var map = _getCurrentTour().map;
          map.setCenter(location.address);
          if(location.bounds) {
            map.fitBounds(location.bounds)
          }else {
            if(location.viewport) {
              map.fitBounds(location.viewport)
            }
          }
          $(currentInput).val("");
          $(currentInput).attr("placeholder", V.I18n.getTrans("i.Searchplaces"))
        }else {
          $(currentInput).val("");
          $(currentInput).attr("placeholder", V.I18n.getTrans("i.Noresultsfound"))
        }
      })
    }
  };
  var _getAddressForText = function(addressText, callback) {
    geocoder.geocode({"address":addressText}, function(results, status) {
      if(status === google.maps.GeocoderStatus.OK) {
        var addrLocation = results[0].geometry.location;
        var bounds = results[0].geometry.bounds;
        var viewport = results[0].geometry.viewport;
        var location = {address:addrLocation, bounds:bounds, viewport:viewport};
        if(typeof callback === "function") {
          callback(location)
        }
      }else {
        if(typeof callback === "function") {
          callback(null)
        }
      }
    })
  };
  var _addMarkerToCoordinates = function(lat, lng, slide_id, slideNumber, vtJSON) {
    return _addMarkerToPosition(new google.maps.LatLng(lat, lng), slide_id, slideNumber, vtJSON)
  };
  var _addMarkerToPosition = function(myLatlng, slide_id, slideNumber, vtJSON) {
    var vt;
    if(vtJSON) {
      vt = vtJSON
    }else {
      vt = _getCurrentTour()
    }
    var map = vt.map;
    var label = new Label({map:map});
    if(!slideNumber) {
      slideNumber = parseInt($(".draggable_sc_div[slide_id='" + slide_id + "']").attr("slidenumber"))
    }
    var pinImage = _getPinImageForSlideNumber(slideNumber);
    var marker = new google.maps.Marker({position:myLatlng, map:map, draggable:true, icon:pinImage, slide_id:slide_id, label:label, title:"(" + myLatlng.lat().toFixed(3) + "," + myLatlng.lng().toFixed(3) + ")"});
    label.bindTo("position", marker, "position");
    google.maps.event.addListener(marker, "click", function(event) {
      _onClick(marker)
    });
    if(typeof vt.markers == "undefined") {
      vt.markers = {}
    }
    vt.markers[slide_id] = marker;
    return marker
  };
  var _getPinImageForSlideNumber = function(slideNumber) {
    var pinText = String.fromCharCode(64 + parseInt(slideNumber));
    var pinImage = new google.maps.MarkerImage("https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=" + pinText + "|FF776B|000000", new google.maps.Size(25, 40), new google.maps.Point(0, 0), new google.maps.Point(10, 34));
    return pinImage
  };
  var _onClick = function(marker) {
    var vt = _getCurrentTour();
    var point = vt.overlay.getProjection().fromLatLngToContainerPixel(marker.position);
    var arrow = $(".draggable_sc_div[slide_id='" + marker.slide_id + "']");
    $(arrow).show();
    var vtDOM = V.Slides.getCurrentSlide();
    var canvas = $(vtDOM).find("div.vt_canvas");
    var xDif = ($(vtDOM).outerWidth() - $(canvas).outerWidth()) / 2;
    var yDif = ($(vtDOM).outerHeight() - $(canvas).outerHeight()) / 2;
    var vt_offset = $(vtDOM).offset();
    var top = point.y + vt_offset.top + yDif - 38;
    var left = point.x + vt_offset.left + xDif - 25;
    var parent = $(arrow).parent();
    var parent_offset = $(parent).offset();
    var newMarginTop = parent_offset.top - 20;
    var newMarginLeft = parent_offset.left + 12;
    var newTop = top - newMarginTop;
    var newLeft = left - newMarginLeft;
    $(arrow).css("position", "fixed");
    $(arrow).css("margin-top", newMarginTop + "px");
    $(arrow).css("margin-left", newMarginLeft + "px");
    $(arrow).css("top", newTop + "px");
    $(arrow).css("left", newLeft + "px");
    $(arrow).animate({top:0, left:0}, "slow", function() {
      $(arrow).css("position", "absolute");
      $(arrow).css("margin-top", "-20px");
      $(arrow).css("margin-left", "12px");
      $(arrow).attr("ddend", "scrollbar")
    });
    _removeMarker(marker)
  };
  var _onDoubleClick = function(marker) {
  };
  var _removeAllMarkers = function() {
    var markers = _getCurrentTour().markers;
    for(var key in markers) {
      _removeMarker(markers[key])
    }
  };
  var _removeMarker = function(marker) {
    marker.setMap(null);
    if(marker.label) {
      marker.label.onRemove()
    }
    var markers = _getCurrentTour().markers;
    if(typeof markers[marker.slide_id] !== "undefined") {
      delete markers[marker.slide_id]
    }
  };
  var _isPositionInViewport = function(position) {
    return _getCurrentTour().map.getBounds().contains(position)
  };
  var _getCurrentTour = function() {
    return vts[$(V.Slides.getCurrentSlide()).attr("id")]
  };
  var draw = function(slidesetJSON, scaffoldDOM) {
    _drawMap(slidesetJSON, scaffoldDOM)
  };
  var onEnterSlideset = function(vt) {
  };
  var onLeaveSlideset = function(vt) {
  };
  var loadSlideset = function(vt) {
    $("#subslides_list").find("div.draggable_sc_div[ddend='scrollbar']").show()
  };
  var unloadSlideset = function(vt) {
  };
  var beforeCreateSlidesetThumbnails = function(vt) {
    _drawPois(vt)
  };
  var beforeRemoveSlideset = function(vt) {
    var vtId = $(vt).attr("id");
    if(typeof vts[vtId] !== "undefined") {
      delete vts[vtId]
    }
  };
  var beforeRemoveSubslide = function(vt, subslide) {
    var subslideId = $(subslide).attr("id");
    var slideNumber = $(subslide).attr("slideNumber");
    var markers = _getCurrentTour().markers;
    Object.keys(markers).forEach(function(key) {
      var marker = markers[key];
      if(marker.slide_id === subslideId) {
        _removeMarker(marker)
      }else {
        var markerArrow = $(".draggable_sc_div[slide_id='" + marker.slide_id + "']");
        var markerSlideNumber = $(markerArrow).attr("slideNumber");
        if(markerSlideNumber > slideNumber) {
          $(markerArrow).attr("slideNumber", markerSlideNumber - 1);
          marker.setIcon(_getPinImageForSlideNumber(markerSlideNumber - 1))
        }
      }
    })
  };
  var _drawPois = function(vtDOM) {
    var vt = _getCurrentTour();
    if(!vt) {
      return
    }
    var markers = vt.markers;
    var subslides = $(vtDOM).find("article");
    $("#subslides_list").find("div.wrapper_barbutton").each(function(index, div) {
      var slide = subslides[index];
      if(slide) {
        var slide_id = $(slide).attr("id");
        var arrowDiv = $('<div class="draggable_sc_div" slide_id="' + slide_id + '" slideNumber="' + (index + 1) + '"" >');
        $(arrowDiv).append($('<img src="' + V.ImagesPath + 'icons/flashcard_button.png" class="fc_draggable_arrow">'));
        $(arrowDiv).append($('<p class="draggable_number">' + String.fromCharCode(64 + index + 1) + "</p>"));
        $(div).prepend(arrowDiv);
        if(typeof markers[slide_id] != "undefined") {
          $(arrowDiv).hide()
        }
      }
    });
    $("div.draggable_sc_div").draggable({start:function(event, ui) {
      var position = $(event.target).css("position");
      if(position === "fixed") {
        $(event.target).attr("ddstart", "background")
      }else {
        var current_offset = $(event.target).offset();
        $(event.target).css("position", "fixed");
        $(event.target).css("margin-top", current_offset.top + "px");
        $(event.target).css("margin-left", current_offset.left + "px");
        $(event.target).attr("ddstart", "scrollbar")
      }
    }, stop:function(event, ui) {
      var canvas = $(vtDOM).find("div.vt_canvas");
      var xDif = ($(vtDOM).outerWidth() - $(canvas).outerWidth()) / 2;
      var yDif = ($(vtDOM).outerHeight() - $(canvas).outerHeight()) / 2;
      var vt_offset = $(vtDOM).offset();
      var poi_offset = $(event.target).offset();
      var myX = poi_offset.left - vt_offset.left - xDif + 25;
      var myY = poi_offset.top - vt_offset.top - yDif + 34;
      var point = new google.maps.Point(myX, myY);
      var position = _getCurrentTour().overlay.getProjection().fromContainerPixelToLatLng(point);
      var insideMap = _isPositionInViewport(position);
      insideMap = insideMap && V.Editor.Slideset.getCurrentSubslide() == null;
      if(insideMap) {
        $(event.target).attr("ddend", "background");
        var newTop = $(event.target).cssNumber("margin-top") + $(event.target).cssNumber("top");
        var newLeft = $(event.target).cssNumber("margin-left") + $(event.target).cssNumber("left");
        $(event.target).css("margin-top", "0px");
        $(event.target).css("margin-left", "0px");
        $(event.target).css("top", newTop + "px");
        $(event.target).css("left", newLeft + "px");
        var slide_id = $(event.target).attr("slide_id");
        var marker = _addMarkerToPosition(position, slide_id);
        $(event.target).hide()
      }else {
        $(event.target).animate({top:0, left:0}, "slow", function() {
          $(event.target).css("position", "absolute");
          $(event.target).css("margin-top", "-20px");
          $(event.target).css("margin-left", "12px");
          $(event.target).attr("ddend", "scrollbar")
        })
      }
    }})
  };
  var getThumbnailURL = function(fc) {
    return V.ImagesPath + "templatesthumbs/tVTour.png"
  };
  var getSlideHeader = function(vtDOM) {
    var vtId = $(vtDOM).attr("id");
    var vt = vts[vtId];
    var slide = {};
    slide.id = vtId;
    slide.type = V.Constant.VTOUR;
    slide.map_service = V.Constant.VTour.SERVICES.GMaps;
    var center = vt.map.getCenter();
    slide.center = {lat:center.lat().toString(), lng:center.lng().toString()};
    slide.zoom = vt.map.getZoom().toString();
    slide.mapType = _getMapType(vt.map);
    slide.width = "100%";
    slide.height = "100%";
    var pois = [];
    for(var key in vt.markers) {
      var marker = vt.markers[key];
      var poi = {};
      poi.lat = marker.position.lat().toString();
      poi.lng = marker.position.lng().toString();
      poi.slide_id = marker.slide_id;
      pois.push(poi)
    }
    slide.pois = pois;
    slide.slides = [];
    return slide
  };
  var _getMapType = function(map) {
    if(map && map.mapTypeId) {
      return map.mapTypeId
    }else {
      return V.Constant.VTour.DEFAULT_MAP
    }
  };
  var preCopyActions = function(vtJSON, vtDOM) {
  };
  var postCopyActions = function(vtJSON, vtDOM) {
  };
  return{init:init, getDummy:getDummy, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, loadSlideset:loadSlideset, unloadSlideset:unloadSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, beforeRemoveSlideset:beforeRemoveSlideset, beforeRemoveSubslide:beforeRemoveSubslide, getSlideHeader:getSlideHeader, getThumbnailURL:getThumbnailURL, preCopyActions:preCopyActions, postCopyActions:postCopyActions}
}(VISH, jQuery);
VISH.Editor.Flashcard = function(V, $, undefined) {
  var init = function() {
  };
  var getDummy = function(slidesetId, options) {
    return"<article id='" + slidesetId + "' type='" + V.Constant.FLASHCARD + "' slidenumber='" + options.slideNumber + "'><div class='delete_slide'></div><img class='help_in_slide help_in_flashcard' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div class='change_bg_button'></div></article>"
  };
  var draw = function(slidesetJSON, scaffoldDOM) {
    if(slidesetJSON) {
      if(typeof slidesetJSON.background == "string" && slidesetJSON.background != "none") {
        onBackgroundSelected(V.Utils.getSrcFromCSS(slidesetJSON.background))
      }
      if(slidesetJSON.pois) {
        var validPois = [];
        $(slidesetJSON.pois).each(function(index, poi) {
          if(poi.x && poi.y && poi.x <= 100 && poi.y <= 100) {
            validPois.push(poi)
          }
        });
        if(validPois.length > 0) {
          _savePoisJSONToDom(scaffoldDOM, validPois)
        }
      }
    }
  };
  var onEnterSlideset = function(fc) {
  };
  var onLeaveSlideset = function(fc) {
  };
  var loadSlideset = function(fc) {
    $("#subslides_list").find("div.draggable_sc_div").show()
  };
  var unloadSlideset = function(fc) {
    _savePoisToDom(fc);
    $("#subslides_list").find("div.draggable_sc_div[ddend='background']").hide()
  };
  var beforeCreateSlidesetThumbnails = function(fc) {
    var POIdata = _getPoisFromDoom(fc);
    _drawPois(fc, POIdata)
  };
  var _drawPois = function(fc, POIdata) {
    var pois = {};
    var fc_offset = $(fc).offset();
    for(var i = 0;i < POIdata.length;i++) {
      var myPoi = POIdata[i];
      pois[myPoi.slide_id] = {};
      pois[myPoi.slide_id].x = myPoi.x * 800 / 100 + fc_offset.left;
      pois[myPoi.slide_id].y = myPoi.y * 600 / 100 + fc_offset.top;
      pois[myPoi.slide_id].slide_id = myPoi.slide_id
    }
    var subslides = $(fc).find("article");
    $("#subslides_list").find("div.wrapper_barbutton").each(function(index, div) {
      var slide = subslides[index];
      if(slide) {
        var slide_id = $(slide).attr("id");
        var arrowDiv = $('<div class="draggable_sc_div" slide_id="' + slide_id + '" >');
        $(arrowDiv).append($('<img src="' + V.ImagesPath + 'icons/flashcard_button.png" class="fc_draggable_arrow">'));
        $(arrowDiv).append($('<p class="draggable_number">' + String.fromCharCode(64 + index + 1) + "</p>"));
        $(div).prepend(arrowDiv);
        var poi = pois[slide_id];
        if(poi) {
          $(arrowDiv).css("position", "fixed");
          $(arrowDiv).css("margin-top", "0px");
          $(arrowDiv).css("margin-left", "0px");
          $(arrowDiv).css("top", poi.y + "px");
          $(arrowDiv).css("left", poi.x + "px");
          $(arrowDiv).attr("ddstart", "scrollbar");
          $(arrowDiv).attr("ddend", "background")
        }
      }
    });
    var isBackgroundShowing = V.Editor.Slideset.getCurrentSubslide() == null;
    if(!isBackgroundShowing) {
      $("#subslides_list").find("div.draggable_sc_div[ddend='background']").hide()
    }
    $("div.draggable_sc_div").draggable({start:function(event, ui) {
      var position = $(event.target).css("position");
      if(position === "fixed") {
        $(event.target).attr("ddstart", "background")
      }else {
        var current_offset = $(event.target).offset();
        $(event.target).css("position", "fixed");
        $(event.target).css("margin-top", current_offset.top + "px");
        $(event.target).css("margin-left", current_offset.left + "px");
        $(event.target).attr("ddstart", "scrollbar")
      }
    }, stop:function(event, ui) {
      var current_offset = $(event.target).offset();
      var fc_offset = $(fc).offset();
      var yOk = current_offset.top > fc_offset.top - 10 && current_offset.top < fc_offset.top + $(fc).outerHeight() - 38;
      var xOk = current_offset.left > fc_offset.left - 5 && current_offset.left < fc_offset.left + $(fc).outerWidth() - 44;
      var insideBackground = yOk && xOk;
      insideBackground = insideBackground && V.Editor.Slideset.getCurrentSubslide() == null;
      if(insideBackground) {
        $(event.target).attr("ddend", "background");
        if($(event.target).attr("ddstart") === "scrollbar") {
          var newTop = $(event.target).cssNumber("margin-top") + $(event.target).cssNumber("top");
          var newLeft = $(event.target).cssNumber("margin-left") + $(event.target).cssNumber("left");
          $(event.target).css("margin-top", "0px");
          $(event.target).css("margin-left", "0px");
          $(event.target).css("top", newTop + "px");
          $(event.target).css("left", newLeft + "px")
        }else {
        }
      }else {
        if($(event.target).attr("ddstart") === "scrollbar") {
        }else {
          if($(event.target).attr("ddstart") === "background") {
            var parent = $(event.target).parent();
            var parent_offset = $(parent).offset();
            var newMarginTop = parent_offset.top - 20;
            var newMarginLeft = parent_offset.left + 12;
            var newTop = $(event.target).cssNumber("top") - newMarginTop;
            var newLeft = $(event.target).cssNumber("left") - newMarginLeft;
            $(event.target).css("margin-top", newMarginTop + "px");
            $(event.target).css("margin-left", newMarginLeft + "px");
            $(event.target).css("top", newTop + "px");
            $(event.target).css("left", newLeft + "px")
          }
        }
        $(event.target).animate({top:0, left:0}, "slow", function() {
          $(event.target).css("position", "absolute");
          $(event.target).css("margin-top", "-20px");
          $(event.target).css("margin-left", "12px");
          $(event.target).attr("ddend", "scrollbar")
        })
      }
    }})
  };
  var _savePoisToJson = function(fc) {
    var pois = [];
    var poisDOM = $("#subslides_list").find("div.draggable_sc_div[ddend='background']");
    var hasCurrentClass = $(fc).hasClass("current");
    if(!hasCurrentClass) {
      $(fc).addClass("current")
    }
    $(fc).addClass("temp_shown");
    $(poisDOM).addClass("temp_shown");
    var fc_offset = $(fc).offset();
    $(poisDOM).each(function(index, poi) {
      pois[index] = {};
      pois[index].x = (100 * ($(poi).offset().left - fc_offset.left) / 800).toString();
      pois[index].y = (100 * ($(poi).offset().top - fc_offset.top) / 600).toString();
      pois[index].slide_id = $(poi).attr("slide_id")
    });
    if(!hasCurrentClass) {
      $(fc).removeClass("current")
    }
    $(poisDOM).removeClass("temp_shown");
    $(fc).removeClass("temp_shown");
    return pois
  };
  var _savePoisToDom = function(fc) {
    var poisJSON = _savePoisToJson(fc);
    _savePoisJSONToDom(fc, poisJSON);
    return poisJSON
  };
  var _savePoisJSONToDom = function(fc, poisJSON) {
    $(fc).attr("poisData", JSON.stringify(poisJSON))
  };
  var _getPoisFromDoom = function(fc) {
    var poisData = $(fc).attr("poisData");
    if(poisData) {
      return JSON.parse($(fc).attr("poisData"))
    }else {
      return[]
    }
  };
  var onBackgroundSelected = function(contentToAdd, fc) {
    if(!fc) {
      fc = V.Slides.getCurrentSlide()
    }
    if($(fc).attr("type") === V.Constant.FLASHCARD) {
      $(fc).css("background-image", "url(" + contentToAdd + ")");
      $(fc).attr("avatar", "url('" + contentToAdd + "')");
      $(fc).find("div.change_bg_button").hide();
      V.Editor.Slideset.updateThumbnails(fc)
    }
    $.fancybox.close()
  };
  var getThumbnailURL = function(fc) {
    var avatar = $(fc).attr("avatar");
    if(avatar) {
      return V.Utils.getSrcFromCSS(avatar)
    }else {
      return getDefaultThumbnailURL()
    }
  };
  var getDefaultThumbnailURL = function() {
    return V.ImagesPath + "templatesthumbs/flashcard_template.png"
  };
  var onThumbnailLoadFail = function(fc) {
    var thumbnailURL = getDefaultThumbnailURL();
    $(fc).css("background-image", "none");
    $(fc).attr("dirtyavatar", $(fc).attr("avatar"));
    $(fc).attr("avatar", "url('" + thumbnailURL + "')");
    $(fc).find("div.change_bg_button").show();
    if(V.Slides.getCurrentSlide() == fc) {
      $("#subslide_selected > img").attr("src", thumbnailURL)
    }
    var slideThumbnail = V.Editor.Thumbnails.getThumbnailForSlide(fc);
    $(slideThumbnail).attr("src", thumbnailURL)
  };
  var getSlideHeader = function(fc) {
    var slide = {};
    slide.id = $(fc).attr("id");
    slide.type = V.Constant.FLASHCARD;
    var currentBackground = $(fc).css("background-image");
    var dirtyAvatar = $(fc).attr("dirtyavatar");
    if(currentBackground == "none" && dirtyAvatar) {
      slide.background = dirtyAvatar
    }else {
      slide.background = currentBackground
    }
    if(V.Slides.getCurrentSlide() === fc) {
      _savePoisToDom(fc)
    }
    slide.pois = _getPoisFromDoom(fc);
    slide.slides = [];
    return slide
  };
  var preCopyActions = function(fcJSON, fcDOM) {
  };
  var postCopyActions = function(fcJSON, fcDOM) {
  };
  return{init:init, getDummy:getDummy, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, loadSlideset:loadSlideset, unloadSlideset:unloadSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, getSlideHeader:getSlideHeader, onBackgroundSelected:onBackgroundSelected, getThumbnailURL:getThumbnailURL, getDefaultThumbnailURL:getDefaultThumbnailURL, onThumbnailLoadFail:onThumbnailLoadFail, preCopyActions:preCopyActions, postCopyActions:postCopyActions}
}(VISH, jQuery);
VISH.Editor.Slideset.Repository = function(V, $, undefined) {
  var containerDivId = "tab_smartcards_repo_content";
  var carrouselDivId = "tab_smartcards_repo_content_carrousel";
  var previewDivId = "tab_smartcards_repo_content_preview";
  var previewButton;
  var myInput;
  var timestampLastSearch;
  var currentPresentations = new Array;
  var selectedPres = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    });
    previewButton = $("#" + previewDivId).find("button.okButton2");
    $(previewButton).click(function() {
      if(selectedPres) {
        V.Editor.Presentation.previewPresentation(selectedPres)
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestSmartcards(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectMetadata();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId), {style:"loading_presentation_carrousel"});
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectMetadata();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.excursions || data.excursions.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    currentExcursions = new Array;
    $.each(data.excursions, function(index, pres) {
      if(!pres.id) {
        pres.id = V.Utils.getId("tmp")
      }
      if(!pres.avatar) {
        pres.avatar = V.ImagesPath + "icons/defaultAvatar.png"
      }
      var myImg = $("<img excursionId ='" + pres.id + "'' src=" + pres.avatar + " />");
      carrouselImages.push(myImg);
      currentExcursions[pres.id] = pres
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.width = 800;
        options.styleClass = "presentation_repository";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var excursionId = $(event.target).attr("excursionId");
    if(excursionId) {
      $(".excursionSelectedInCarrousel").removeClass("excursionSelectedInCarrousel");
      $(event.target).addClass("excursionSelectedInCarrousel");
      selectedPres = currentExcursions[excursionId];
      _renderObjectMetadata(selectedPres)
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectMetadata = function(object) {
    var metadataArea = $("#" + previewDivId).find("div.content_preview_metadata");
    $(metadataArea).html("");
    if(object) {
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description, tableClass:"metadata metadata_presentation"});
      $(metadataArea).html(table);
      $(previewButton).show()
    }
  };
  var _cleanObjectMetadata = function() {
    var metadataArea = $("#" + previewDivId).find("div.content_preview_metadata");
    $(metadataArea).html("");
    $(previewButton).hide()
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Samples = function(V, undefined) {
  var basic_samples = {"id":"1", "title":"The Iberian Lynx", "description":"The Iberian Lynx.\nAmazing presentation with images, videos and objects, generated by ViSH Editor.", "author":"ViSH Editor Team", "language":"en", "avatar":"http://vishub.org/assets/logos/original/excursion-10.png", "tags":["Do\u00f1ana", "Lynx"], "age_range":"4 - 20", "subject":["Biology"], "educational_objectives":"Know about Iberian Lynx", "adquired_competencies":"Pupils will be smarter", "VEVersion":"0.2", "type":"presentation", 
  "theme":"theme1", "animation":"animation1", "slides":[{"id":"article1", "type":"standard", "template":"t1", "elements":[{"id":"article1_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/312.jpg", "style":"position: relative; width:117.0886075949367%; height:109.47368421052632%; top:-4.7368421052631575%; left:-2.5316455696202533%;"}, {"id":"article1_zone2", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4 vish-parent-fontundefined" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><i>by <b><span class="vish-fontundefined vish-fontHelvetica" style="color:#cb6120;undefined;">Vish</span> Editor</b> Team<b>&nbsp;</b></i></span></div>'}, 
  {"id":"article1_zone3", "areaid":"subheader"}]}, {"id":"article2", "type":"standard", "template":"t8", "elements":[{"id":"article2_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6 vish-parent-fontundefined" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;"> Lynx &nbsp; &nbsp; &nbsp;</span><span class="vish-fontundefined vish-fontHelvetica" style="color:#5ea099;undefined;">Description and habitat</span></div>'}, 
  {"id":"article2_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/73.jpeg", "style":"position: relative; width:130.4%; height:106.6%; top:0.5%; left:-25.2%;"}, {"id":"article2_zone3", "type":"text", "areaid":"center", "body":'In most respects, the Iberian Lynx resembles other species of lynx, with a short tail,tufted ears and a ruff of fur beneath the chin. ...<div class="vish-parent-font7" style="font-weight: normal; "><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article2_zone4", "type":"image", "areaid":"right", "body":"http://vishub.org/pictures/313.png", "style":"position: relative; width:119.5%; height:88.6%; top:3.4%; left:-2.6%;"}]}, {"id":"article3", "type":"standard", "template":"t3", "elements":[{"id":"article3_zone1", "type":"text", "areaid":"header", "body":'<span class="vish-font6 vish-fontHelvetica" style="color: rgb(219, 150, 0); font-weight: normal; ">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">Lynx</span><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article3_zone2", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/8t29CZcGAbs?wmode=opaque" frameborder="0" id="resizableunicID9" class="t3_object" wmode="opaque"></iframe>', "style":"position: relative; width:85.81661891117479%; height:100%; top:0.22321428571428573%; left:6.446991404011461%;"}]}, {"id":"article4", "type":"standard", "template":"t6", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;Lynx</span><br></div>'}, 
  {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.6111111111111%; height:217.9%; top:-34.97%; left:-42.13%;"}, {"id":"article4_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.1%; height:217.7%; top:-46.9%; left:-199.1%;"}, {"id":"article4_zone4", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font4 vish-parent-fontundefined" style="text-align: center; font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">During the mating season the female leaves her territory...</span><span class="vish-fontundefined vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, 
  {"id":"article5", "type":"standard", "template":"t10", "elements":[{"id":"article5_zone1", "type":"object", "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Do%C3%B1ana_National_Park?wmode=transparent" id="resizableunicID15" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article6", "type":"standard", "template":"t12", "elements":[{"id":"article6_zone1", "areaid":"left1"}, {"id":"article6_zone2", 
  "areaid":"right1"}, {"id":"article6_zone3", "areaid":"left2"}, {"id":"article6_zone4", "type":"image", "areaid":"right2", "body":"http://vishub.org/pictures/312.jpg", "style":"position: relative; width:114.6%; height:113.8%; top:0%; left:0%;"}]}]};
  var samplesv01 = {"id":"2", "type":"presentation", "title":"Chess: The Art of Learning", "description":"Samples of VE v01. The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by ViSH Editor.", "avatar":"http://static.betazeta.com/www.veoverde.com/wp-content/uploads/2011/07/fotos-gatos.jpg", "tags":["Samples", "Test", "Development"], "author":"ViSH Editor Team", "theme":"theme1", "age_range":"4 - 14", "subject":["Art", 
  "Astronomy"], "language":"en", "educational_objectives":"bla bla bla 3", "adquired_competencies":"pupils will be smarter", "slides":[{"id":"article1", "template":"t1", "elements":[{"id":"zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"article2", "template":"t3", "elements":[{"id":"325", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, 
  {"id":"7335", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"articlearticle4", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article_5", "type":"standard", "template":"t2", "elements":[{"id":"zone11", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]};
  var fc_sample = {"id":"3", "VEVersion":"0.2", "type":"flashcard", "title":"Curiosity Flashcard", "description":'A Flashcard about "Curiosity", the car-sized robotic rover exploring Gale Crater on Mars.', "avatar":"http://vishub.org/pictures/311.jpg", "tags":["Science", "Space", "Mars"], "age_range":"12 - 30", "subject":["Astronomy"], "language":"independent", "educational_objectives":'Know about "Curiosity", the car-sized robotic rover exploring Gale Crater on Mars.', "adquired_competencies":"Pupils will be smarter", 
  "author":"ViSH Editor Team", "slides":[{"id":"article4", "type":"flashcard", "background":"url(http://vishub.org/pictures/311.jpg)", "pois":[{"id":"article4_poi1", "x":"88.88", "y":"50.83", "slide_id":"article4_article1"}, {"id":"article4_poi2", "x":"45.5", "y":"2.5", "slide_id":"article4_article3"}, {"id":"article4_poi3", "x":"13.5", "y":"63.17", "slide_id":"article4_article4"}], "slides":[{"id":"article4_article1", "type":"standard", "template":"t2", "elements":[{"id":"article4_article1_zone1", 
  "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/P4boyXQuUIw?wmode=opaque" frameborder="0" id="resizableunicID3" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:98.7%; top:0%; left:0%;"}]}, {"id":"article4_article3", "type":"standard", "template":"t7", "elements":[{"id":"article4_article3_zone1", "type":"image", "areaid":"header", "body":"http://vishub.org/pictures/315.jpeg", "style":"position: relative; width:101.9%; height:190.4%; top:-69.2%; left:-0.1%;"}, 
  {"id":"article4_article3_zone2", "type":"text", "areaid":"left", "body":'The image shows the Alpha Particle X-Ray Spectrometer (APXS) on NASA\'s Curiosity rover, with the Martian landscape in the background.<div class="vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article4_article3_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/316.jpeg", "style":"position: relative; width:129.1%; height:110.6%; top:-5.2%; left:-10.9%;"}, 
  {"id":"article4_article3_zone4", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font4" style="font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Image credit: NASA/JPL-Caltech/MSSS</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, {"id":"article4_article4", "type":"standard", "template":"t10", "elements":[{"id":"article4_article4_zone1", "type":"object", "areaid":"center", 
  "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}]}]};
  var samples_vtour = {"id":"1987", "title":"Toledo Virtual Tour", "description":"Virtual Tour example with ViSH Editor", "author":"Aldo", "avatar":"http://vishub.org/assets/logos/original/excursion-05.png", "tags":["Samples", "Test", "Development", "Virtual Tour"], "age_range":"4 - 14", "subject":"Media Education", "educational_objectives":"Amazing educational Virtual Tour", "adquired_competencies":"Pupils will be smarter", "type":"VirtualTour", "theme":"theme1", "language":"en", "VEVersion":"0.4", 
  "slides":[{"id":"article5", "type":"VirtualTour", "map_service":"Google Maps", "center":{"lat":"41.23", "lng":"-366.3"}, "zoom":5, "mapType":"roadmap", "width":"100%", "height":"100%", "pois":[{"id":"article5_poi1", "lat":"40.24", "lng":"-3.6", "slide_id":"article5_article1"}, {"id":"article5_poi2", "lat":"41.2", "lng":"2.1", "slide_id":"article5_article2"}, {"id":"article5_poi3", "lat":"37.26", "lng":"-5.97", "slide_id":"article5_article3"}, {"id":"article5_poi4", "lat":"43.26", "lng":"-5.97", 
  "slide_id":"article5_article4"}], "tours":[{"id":"article5_tour1", "path":["article5_poi1", "article5_poi2", "article5_poi3"]}], "slides":[{"id":"article5_article1", "template":"t1", "elements":[{"id":"article5_article1_zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"article5_article1_zone2", "type":"text", 
  "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, {"id":"article5_article1_zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, 
  {"id":"article5_article2", "template":"t3", "elements":[{"id":"article5_article2_zone1", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, {"id":"article5_article2_zone2", "type":"object", "areaid":"left", "body":'<embed id="resizableunicID12" class="t10_object" src="http://localhost/vishEditor/examples/contents/swf/virtualexperiment.swf" wmode="opaque">', "style":"position: relative; width:64.53634085213032%; height:64.71571906354515%; top:15.719063545150501%; left:15.288220551378446%;"}]}, 
  {"id":"article5_article3", "template":"t6", "elements":[{"id":"article5_article3_zone1", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"article5_article3_zone2", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"article5_article3_zone4", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"article5_article3_zone5", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article5_article4", "type":"standard", "template":"t2", "elements":[{"id":"article5_article4_zone1", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]}]};
  var full_samples = {"id":"4", "VEVersion":"0.2", "type":"presentation", "theme":"theme1", "animation":"animation1", "avatar":"http://vishub.org/assets/logos/original/excursion-10.png", "title":"The Iberian Lynx", "author":"ViSH Editor Team", "description":"The Iberian Lynx.\nAmazing presentation with images, videos and objects, generated by ViSH Editor.", "tags":["Do\u00f1ana", "Lynx", "Biology"], "language":"en", "context":"university", "age_range":"4 - 20", "difficulty":"easy", "subject":["Art", 
  "Astronomy", "Biology"], "TLT":"PT6H30M15S", "educational_objectives":"Know about the Iberian Lynx", "slides":[{"id":"article1", "type":"standard", "template":"t1", "elements":[{"id":"article1_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/312.jpeg", "style":"position: relative; width:117.0886075949367%; height:109.47368421052632%; top:-4.7368421052631575%; left:-2.320675105485232%;"}, {"id":"article1_zone2", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4 vish-parent-fontundefined" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><i>by <b><span class="vish-fontundefined vish-fontHelvetica" style="color:#cb6120;undefined;">Vish</span> Editor</b> Team<b>&nbsp;</b></i></span></div>'}, 
  {"id":"article1_zone3", "areaid":"subheader"}]}, {"id":"article2", "type":"standard", "template":"t8", "elements":[{"id":"article2_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6 vish-parent-fontundefined" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;"> Lynx &nbsp; &nbsp; &nbsp;</span><span class="vish-fontundefined vish-fontHelvetica" style="color:#5ea099;undefined;">Description and habitat</span></div>'}, 
  {"id":"article2_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/73.jpeg", "style":"position: relative; width:130.43478260869566%; height:106.63507109004739%; top:0%; left:-25.217391304347824%;"}, {"id":"article2_zone3", "type":"text", "areaid":"center", "body":'In most respects, the Iberian Lynx resembles other species of lynx, with a short tail,tufted ears and a ruff of fur beneath the chin. ...<div class="vish-parent-font7" style="font-weight: normal; "><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article2_zone4", "type":"image", "areaid":"right", "body":"http://vishub.org/pictures/313.png", "style":"position: relative; width:119.56521739130434%; height:88.60759493670886%; top:2.9535864978902953%; left:-2.608695652173913%;"}]}, {"id":"article12", "template":"t3", "elements":[{"id":"article12_zone1", "type":"text", "areaid":"header", "body":"Experimento virtual"}, {"id":"article12_zone2", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash" id="resizableunicID8" class="t3_object" wmode="opaque">', 
  "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article8", "type":"flashcard", "background":"url(http://vishub.org/pictures/317.png)", "pois":[{"id":"article8_poi1", "x":"36.9", "y":"67.3", "slide_id":"article8_article1"}, {"id":"article8_poi2", "x":"55.4", "y":"68.16", "slide_id":"article8_article2"}, {"id":"article8_poi3", "x":"45.875", "y":"5.5", "slide_id":"article8_article3"}], "slides":[{"id":"article8_article1", "type":"standard", "template":"t2", "elements":[{"id":"article8_article1_zone1", 
  "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/318.jpeg", "style":"position: relative; width:110.31518624641834%; height:97.1590909090909%; top:2.0833333333333335%; left:-1.146131805157593%;"}]}, {"id":"article8_article2", "type":"standard", "template":"t2", "elements":[{"id":"article8_article2_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/327.jpeg", "style":"position: relative; width:103.15186246418338%; height:90.53030303030303%; top:3.0303030303030303%; left:-0.5730659025787965%;"}]}, 
  {"id":"article8_article3", "type":"standard", "template":"t2", "elements":[{"id":"article8_article3_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/319.jpeg", "style":"position: relative; width:119.05444126074498%; height:129.54545454545453%; top:-2.6515151515151514%; left:-3.5816618911174785%;"}]}]}, {"id":"article9", "type":"standard", "template":"t3", "elements":[{"id":"article9_zone1", "type":"text", "areaid":"header", "body":'<span class="vish-font6 vish-fontHelvetica" style="color: rgb(219, 150, 0); font-weight: normal; ">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">Lynx</span><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article9_zone2", "type":"video", "areaid":"left", "poster":"https://raw.github.com/ging/vish_editor/master/public/vishEditor/images/vicons/example_poster_image.jpg", "style":"position: relative; width:100%; height:100%; top:-3.125%; left:0.14326647564469913%;", "sources":'[{ "type": "video/webm", "src": "http://vishub.org/videos/325.webm"},{ "type": "video/mp4", "src": "http://vishub.org/videos/325.mp4"}]'}]}, {"id":"article3", "type":"standard", "template":"t3", "elements":[{"id":"article3_zone1", 
  "type":"text", "areaid":"header", "body":'<span class="vish-font6 vish-fontHelvetica" style="color: rgb(219, 150, 0); font-weight: normal; ">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">Lynx</span><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article3_zone2", 
  "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/8t29CZcGAbs?wmode=opaque" frameborder="0" id="resizableunicID4" class="t3_object" wmode="opaque"></iframe>', "style":"position: relative; width:85.81661891117479%; height:100%; top:0%; left:6.446991404011461%;"}]}, {"id":"article4", "type":"standard", "template":"t6", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;Lynx</span><br></div>'}, 
  {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.6111111111111%; height:217.91044776119404%; top:-34.9680170575693%; left:-42.129629629629626%;"}, {"id":"article4_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.14814814814815%; height:217.69722814498934%; top:-46.695095948827294%; left:-199.07407407407408%;"}, {"id":"article4_zone4", 
  "type":"text", "areaid":"right", "body":'<div class="vish-parent-font4 vish-parent-fontundefined" style="text-align: center; font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">During the mating season the female leaves her territory...</span><span class="vish-fontundefined vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, {"id":"article5", "type":"standard", "template":"t10", "elements":[{"id":"article5_zone1", "type":"object", 
  "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Do%C3%B1ana_National_Park?wmode=transparent" id="resizableunicID7" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article7", "type":"flashcard", "background":"url(http://vishub.org/pictures/320.jpeg)", "pois":[{"id":"article7_poi1", "x":"15.63", "y":"8.5", "slide_id":"article7_article1"}, {"id":"article7_poi2", "x":"77.75", "y":"11.5", "slide_id":"article7_article2"}, 
  {"id":"article7_poi3", "x":"17.125", "y":"58.83", "slide_id":"article7_article3"}], "slides":[{"id":"article7_article1", "type":"standard", "template":"t10", "elements":[{"id":"article7_article1_zone1", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/321.jpeg", "style":"position: relative; width:49.62406015037594%; height:66.22073578595318%; top:15.719063545150501%; left:24.18546365914787%;"}]}, {"id":"article7_article2", "type":"standard", "template":"t10", "elements":[{"id":"article7_article2_zone1", 
  "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/322.jpeg", "style":"position: relative; width:60.526315789473685%; height:67.3913043478261%; top:15.719063545150501%; left:20.17543859649123%;"}]}, {"id":"article7_article3", "type":"standard", "template":"t10", "elements":[{"id":"article7_article3_zone1", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/323.jpeg", "style":"position: relative; width:115.91478696741855%; height:116.05351170568562%; top:-2.842809364548495%; left:-0.7518796992481203%;"}]}]}, 
  {"id":"article6", "type":"standard", "template":"t12", "elements":[{"id":"article6_zone1", "areaid":"left1"}, {"id":"article6_zone2", "areaid":"right1"}, {"id":"article6_zone3", "areaid":"left2"}, {"id":"article6_zone4", "type":"image", "areaid":"right2", "body":"http://vishub.org/pictures/312.jpeg", "style":"position: relative; width:114.6268656716418%; height:113.83399209486166%; top:0%; left:0%;"}]}, {"id":"article13", "type":"standard", "template":"t2", "elements":[{"id":"article13_zone1", 
  "type":"snapshot", "areaid":"left", "body":'<iframe src="http://en.wikipedia.org" id="resizableunicID10" class="snapshot_content" scrolling="no" wmode="transparent"></iframe>', "style":"position: relative; width:61.46131805157593%; height:61.17424242424242%; top:40.15151515151515%; left:-15.759312320916905%;", "scrollTop":417, "scrollLeft":129}]}, {"id":"article14", "type":"VirtualTour", "map_service":"Google Maps", "center":{"lat":"41.23", "lng":"-366.3"}, "zoom":"5", "mapType":"roadmap", "width":"100%", 
  "height":"100%", "pois":[{"id":"article14_poi1", "lat":"40.24", "lng":"-3.6", "slide_id":"article14_article1"}, {"id":"article14_poi2", "lat":"41.2", "lng":"2.1", "slide_id":"article14_article2"}, {"id":"article14_poi3", "lat":"37.26", "lng":"-5.97", "slide_id":"article14_article3"}, {"id":"article14_poi4", "lat":"43.26", "lng":"-5.97", "slide_id":"article14_article4"}], "tours":[{"id":"article14_tour1", "path":["article14_poi1", "article14_poi2", "article14_poi3"]}], "slides":[{"id":"article14_article1", 
  "template":"t1", "elements":[{"id":"article14_article1_zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"article14_article1_zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"article14_article1_zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"article14_article2", "template":"t3", "elements":[{"id":"article14_article2_zone1", "type":"text", 
  "areaid":"header", "body":"Experimento virtual1"}, {"id":"article14_article2_zone2", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"article14_article3", "template":"t6", "elements":[{"id":"article14_article3_zone1", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"article14_article3_zone2", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"article14_article3_zone4", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"article14_article3_zone5", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article14_article4", "type":"standard", "template":"t2", "elements":[{"id":"article14_article4_zone1", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]}]};
  var quiz_samples = {"VEVersion":"0.7", "type":"presentation", "title":"Quiz samples", "description":"Quiz example", "avatar":"http://vishub.org/assets/logos/original/excursion-15.png", "author":"agordillo", "theme":"theme1", "animation":"animation1", "language":"independent", "age_range":"4 - 20", "slides":[{"id":"article2", "type":"standard", "template":"t2", "elements":[{"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\u00adWhat is the oldest ancient weapon?", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;What is the oldest ancient weapon?</span></span></p>\n'}, "choices":[{"id":"1", "value":"Fu\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Fu&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00adBow", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Bow</span></span></p>\n', 
  "answer":true}, {"id":"3", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Chu Ko Nuh</span></span></p>\n', "answer":false}, {"id":"4", "value":"\u00adWar Galley", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;War Galley</span></span></p>\n', "answer":false}], "extras":{"multipleAnswer":false}, "quiz_simple_json":{"title":"Quiz samples", 
  "description":"Quiz example", "author":"agordillo", "type":"quiz_simple", "slides":[{"id":"article2", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\u00adWhat is the oldest ancient weapon?", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;What is the oldest ancient weapon?</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"Fu\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Fu&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00adBow", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Bow</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Chu Ko Nuh</span></span></p>\n', 
  "answer":false}, {"id":"4", "value":"\u00adWar Galley", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;War Galley</span></span></p>\n', "answer":false}], "extras":{"multipleAnswer":false}}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article1", "type":"standard", "template":"t2", "elements":[{"id":"article1_zone1", "type":"quiz", "areaid":"left", "quiztype":"truefalse", "selfA":true, "question":{"value":"\u00adWhat of the followings are ancient weapons?", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span style="color:#ff0000;"><span style="font-size:10px;"><span autocolor="true">&shy;</span><span autocolor="true"><span style="font-size:24px;">What of the followings are ancient weapons?</span></span></span></span></p>\n'}, "choices":[{"id":"1", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span><span style="color: rgb(0, 0, 0); font-size: 24.44444465637207px;">Chu Ko Nuh</span></p>\n', 
  "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", "value":"Halberd", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Halberd</font></p>\n', "answer":true}, {"id":"4", "value":"Battleaxe", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Battleaxe</font></p>\n', 
  "answer":true}], "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":"agordillo", "type":"quiz_simple", "slides":[{"id":"article1", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article1_zone1", "type":"quiz", "areaid":"left", "quiztype":"truefalse", "selfA":true, "question":{"value":"\u00adWhat of the followings are ancient weapons?", "wysiwygValue":'<p style="text-align:left;">\n\t<span style="color:#ff0000;"><span style="font-size:10px;"><span autocolor="true">&shy;</span><span autocolor="true"><span style="font-size:24px;">What of the followings are ancient weapons?</span></span></span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span><span style="color: rgb(0, 0, 0); font-size: 24.44444465637207px;">Chu Ko Nuh</span></p>\n', "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", 
  "value":"Halberd", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Halberd</font></p>\n', "answer":true}, {"id":"4", "value":"Battleaxe", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Battleaxe</font></p>\n', "answer":true}]}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article3", "type":"standard", "template":"t2", "elements":[{"id":"article3_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":true, 
  "question":{"value":"What are ancient weapons?\u00ad", "wysiwygValue":'<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What are ancient weapons?&shy;</span></span></p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n'}, "choices":[{"id":"1", "value":"\u00adFu", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Fu</span></span></p>\n', 
  "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", "value":"Chu Ko Nuh\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Chu Ko Nuh&shy;</span></span></p>\n', "answer":true}, {"id":"4", "value":"\u00adNuclear bomb", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Nuclear bomb</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":true}, "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":"agordillo", "type":"quiz_simple", "slides":[{"id":"article3", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article3_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"What are ancient weapons?\u00ad", "wysiwygValue":'<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What are ancient weapons?&shy;</span></span></p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n'}, 
  "choices":[{"id":"1", "value":"\u00adFu", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Fu</span></span></p>\n', "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", "value":"Chu Ko Nuh\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Chu Ko Nuh&shy;</span></span></p>\n', 
  "answer":true}, {"id":"4", "value":"\u00adNuclear bomb", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Nuclear bomb</span></span></p>\n', "answer":false}], "extras":{"multipleAnswer":true}}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article4", "type":"standard", "template":"t8", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:18px;">Ejemplo de un Quiz enriquecido&shy;</span></span></p>\n'}, 
  {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://farm8.staticflickr.com/7328/11049505694_7e90530bee.jpg", "style":"position: relative; width:110.9704641350211%; height:121.81818181818181%; top:-0.9090909090909091%; left:-3.7974683544303796%;"}, {"id":"article4_zone3", "type":"quiz", "areaid":"center", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"What is the capital of Spain?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What is the capital of Spain?&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u200bBarcelona\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Barcelona&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u200b\u00adMadrid", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Madrid</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u200b\u00adLugo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Lugo</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":false}, "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":"agordillo", "type":"quiz_simple", "slides":[{"id":"article4", "type":"quiz_simple", "template":"t8", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:18px;">Ejemplo de un Quiz enriquecido&shy;</span></span></p>\n'}, {"id":"article4_zone2", 
  "type":"image", "areaid":"left", "body":"http://farm8.staticflickr.com/7328/11049505694_7e90530bee.jpg", "style":"position: relative; width:110.9704641350211%; height:121.81818181818181%; top:-0.9090909090909091%; left:-3.7974683544303796%;"}, {"id":"article4_zone3", "type":"quiz", "areaid":"center", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"What is the capital of Spain?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What is the capital of Spain?&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u200bBarcelona\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Barcelona&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u200b\u00adMadrid", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Madrid</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u200b\u00adLugo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Lugo</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":false}}, {"id":"article4_zone4", "type":"image", "areaid":"right", "body":"http://farm6.staticflickr.com/5520/11018661665_67b642b119.jpg", "style":"position: relative; width:109.70464135021098%; height:140.8906882591093%; top:-17.408906882591094%; left:-9.282700421940929%;"}], "containsQuiz":true}]}}, {"id":"article4_zone4", "type":"image", "areaid":"right", "body":"http://farm6.staticflickr.com/5520/11018661665_67b642b119.jpg", "style":"position: relative; width:109.70464135021098%; height:140.8906882591093%; top:-17.408906882591094%; left:-9.282700421940929%;"}], 
  "containsQuiz":true}]};
  var magnetic_gifs = {"id":"405", "type":"presentation", "title":"Magnetic Resonance Imaging of Foods (Mobile)", "description":"Images of magnetic resonance: Food series.\nhttp://insideinsides.blogspot.com.es/", "avatar":"http://vishub.org/assets/logos/original/excursion-35.png", "tags":["Art", "Mobile", "LifeSciences", "Life-Sciences", "EarthScience", "e-learning"], "author":"N\u00e9stor Toribio Ruiz", "slides":[{"id":"article_405_0", "type":"standard", "template":"t1", "elements":[{"id":"zone1", 
  "type":"image", "areaid":"left", "body":"http://3.bp.blogspot.com/-QLfceEKHmis/TijNAXnjwLI/AAAAAAAACSA/LWzvgAAy4YI/s840/insideinsides.jpg", "style":"position: relative; width:97.61388286334056%; height:60.85790884718499%; top:23.288651126319536%; left:1.0773698057890455%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" class="vish-parent-font7 vish-parent-font2 vish-parent-font4" align="center"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font2 vish-fontHelvetica" style="color:#201815;undefined;"><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;">Magnetic Resonance</span></span></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div style="font-weight: 400;" class="vish-parent-font5 vish-parent-font2" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><i>Imaging of Foods</i></span></span></div>'}]}, {"id":"article_405_1", "type":"standard", "template":"t5", "elements":[{"id":"zone4", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="font-weight: 400;">Magnetic Resonance: Broccoli</span></span></div>'}, 
  {"id":"zone5", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/150.gif", "style":"position: relative; width:123.07692307692308%; height:70.78651685393258%; top:12.142323697550912%; left:-17.887178861177883%;"}, {"id":"zone6", "type":"image", "areaid":"right", "body":"http://www.tarot-josnell.com/imagenes/brocoli.jpg", "style":"position: relative; width:107.6923076923077%; height:75.50561797752809%; top:9.438202247191011%; left:-3.6923076923076925%;"}]}, {"id":"article_405_2", 
  "type":"standard", "template":"t5", "elements":[{"id":"zone7", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" class="vish-parent-font2" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="font-weight: 400;">Magnetic Resonance: Corn</span></span><br></div>'}, {"id":"zone8", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/146.gif", "style":"position: relative; width:70.76923076923077%; height:101.79775280898876%; top:0%; left:15.097430889423077%;"}, 
  {"id":"zone9", "type":"image", "areaid":"right", "body":"http://www.scientificamerican.com/media/inline/that-burger-youre-eating-is-mostly-corn_1.jpg", "style":"position: relative; width:169.23076923076923%; height:123.59550561797752%; top:-13.730335021286868%; left:-36.68716195913461%;"}]}, {"id":"article_405_3", "type":"standard", "template":"t5", "elements":[{"id":"zone10", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="font-weight: 400;">Magnetic Resonance: Garlic</span></span></div>'}, 
  {"id":"zone11", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/149.gif", "style":"position: relative; width:132.30769230769232%; height:97.52808988764045%; top:6.29962706833743%; left:-16.041053185096153%;"}, {"id":"zone12", "type":"image", "areaid":"right", "body":"http://www.planetmattersandmore.com/wp-content/uploads/2012/04/garlic_bulb.jpg", "style":"position: relative; width:153.84615384615384%; height:84.9438202247191%; top:7.872660776202598%; left:-28.369290865384617%;"}]}, 
  {"id":"article_405_4", "type":"standard", "template":"t5", "elements":[{"id":"zone13", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="font-weight: 400;">Magnetic Resonance: Tomato</span></span></div>'}, {"id":"zone14", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/148.gif", "style":"position: relative; width:107.6923076923077%; height:78.65168539325843%; top:8.546818079573384%; left:-7.405127892127404%;"}, 
  {"id":"zone15", "type":"image", "areaid":"right", "body":"http://www.lacocinadeinma.com/wp-content/uploads/Tomate.jpg", "style":"position: relative; width:123.07692307692308%; height:89.88764044943821%; top:4.943820224719101%; left:-9.866671048677885%;"}]}, {"id":"article_405_5", "type":"standard", "template":"t5", "elements":[{"id":"zone16", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="font-weight: 400;">Magnetic Resonance: Pineapple</span></span></div>'}, 
  {"id":"zone17", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/156.gif?1347543540", "style":"position: relative; width:200%; height:81.57303370786516%; top:12.36329496576545%; left:-48.05127892127404%;"}, {"id":"zone18", "type":"image", "areaid":"right", "body":"http://www.floridahillnursery.com/images/gold%20pineapple%20.jpg", "style":"position: relative; width:123.07692307692308%; height:165.8426966292135%; top:-69.93258358387465%; left:-10.784621018629808%;"}]}, {"id":"article_405_6", 
  "type":"standard", "template":"t5", "elements":[{"id":"zone19", "type":"text", "areaid":"header", "body":'<div style="font-weight: 400;" align="center"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="font-weight: 400;">Magnetic Resonance: Apple</span></span></div>'}, {"id":"zone20", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/151.gif", "style":"position: relative; width:163.07692307692307%; height:119.10112359550561%; top:-8.771533751755618%; left:-32.65127798227164%;"}, 
  {"id":"zone21", "type":"image", "areaid":"right", "body":"http://appleadayproject.files.wordpress.com/2011/03/apple-full2.jpg", "style":"position: relative; width:138.46153846153845%; height:101.79775280898876%; top:-8.996252852879213%; left:-14.4769287109375%;"}]}, {"id":"article_405_7", "type":"standard", "template":"t2", "elements":[{"id":"zone22", "type":"text", "areaid":"left", "body":'<div style="font-weight: 400;" class="vish-parent-font7 vish-parent-font2 vish-parent-fontundefined" align="center"><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"><br></span><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"><br></span><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"><br></span><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"><br></span><span class="vish-fontundefined vish-fontHelvetica" style="color:#717175;undefined;"><span class="vish-font2 vish-fontHelvetica" style="color:undefined;undefined;"><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;">http://insideinsides.blogspot.com.es/</span></span></span></div>'}]}]};
  var new_wysiwyg = {"VEVersion":"0.3", "id":"4", "type":"presentation", "title":"The Iberian Lynx", "description":"The Iberian Lynx.\nAmazing presentation with images, videos and objects, generated by ViSH Editor.", "avatar":"http://vishub.org/assets/logos/original/excursion-10.png", "tags":["Do\u00c3\u00b1ana", "Lynx", "Biology"], "theme":"theme1", "age_range":"4 - 20", "subject":["Biology"], "language":"en", "educational_objectives":"Know about Iberian Lynx", "adquired_competencies":"Pupils will be smarter", 
  "author":"", "slides":[{"id":"article1", "type":"standard", "template":"t2", "elements":[{"id":"article1_zone1", "type":"text", "areaid":"left", "body":'<p>\n\taaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</p>\n<p>\n\tbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</p>\n<p>\n\t<span style="font-size:10px;">10cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;">16ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd</span></span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;"><span style="font-size:26px;">26eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</span></span></span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;"><span style="font-size:26px;"><span style="font-size:48px;">48ffffffffffffffffffffffffffffffffffffffffffffffff</span></span></span></span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;"><span style="font-size:26px;"><span style="font-size:48px;"><span style="font-size:72px;">72ggggggggggggggg</span></span></span></span></span></p>\n<p>\n\t&nbsp;</p>\n'}]}, 
  {"id":"article2", "type":"standard", "template":"t2", "elements":[{"id":"article2_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align: center;">\n\t<span style="color:#ff0000;"><span style="font-size:48px;"><span style="font-family:trebuchet ms,helvetica,sans-serif;">Hello World</span></span></span></p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span style="color: rgb(255, 0, 0); font-family: \'trebuchet ms\', helvetica, sans-serif; font-size: 48px;">Hello World</span></p>\n'}]}, 
  {"id":"article3", "type":"standard", "template":"t2", "elements":[{"id":"article3_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t<span style="font-size:36px;">&shy;<span style="font-size:20px;">1</span></span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">2</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">3</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">4</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">5</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">6</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">7</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">8</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">9</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">10</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">11</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">12</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">13</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">14</span></p>\n'}]}, 
  {"id":"article4", "type":"standard", "template":"t1", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t<span style="font-size:36px;"><a href="http://delanada" target="_blank">http://delanada</a>&shy;</span></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n'}, {"id":"article4_zone2", "areaid":"header"}, {"id":"article4_zone3", "type":"text", "areaid":"subheader", "body":'<p style="text-align:left;">\n\t<span style="font-size:18px;">&shy;asdadsad</span></p>\n'}]}, 
  {"id":"article5", "type":"standard", "template":"t2", "elements":[{"id":"article5_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t<span style="font-size:36px;">exponentes<sup>2</sup></span></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<span style="font-size:22px;"><span style="font-size:36px;">exponentesb<sub>345</sub>asdadsadasd</span></span></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<u><span style="font-size:22px;"><span style="font-size:36px;">Subrayado</span></span></u></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<em><span style="font-size:22px;"><span style="font-size:36px;">Cursiva</span></span></em></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<strong><span style="font-size:22px;"><span style="font-size:36px;">Negrita</span></span></strong></p>\n'}]}, 
  {"id":"article6", "type":"standard", "template":"t2", "elements":[{"id":"article6_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<table align="center" border="1" cellpadding="1" cellspacing="1" style="width: 500px;" summary="Fin de ejemplo de tabla">\n\t<caption>\n\t\t<span style="font-size:24px;">Ejemplo de Tabla</span></caption>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<span style="color:#ffff00;"><span style="font-size:36px;"><span style="font-family:comic sans ms,cursive;"><span style="background-color:#000000;">Esto es un</span></span></span></span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">ejemplo de&nbsp;</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">una tabla</span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">con el</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">nuevo</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">wysiwyg</span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<font size="5">a ver si</font></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">redimensiona</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">bien</span></td>\n\t\t</tr>\n\t</tbody>\n</table>\n<p style="text-align:left;">\n\t<span style="font-size:36px;">&shy;</span></p>\n'}]}]};
  var test = {"VEVersion":"0.7", "type":"presentation", "title":"Excursion MC Multiple Answer Test", "description":"Excursion MC Multiple Answer Test", "avatar":"http://farm6.staticflickr.com/5254/5471377987_d3125cc9b6.jpg", "author":"<Demo>", "theme":"theme1", "animation":"animation1", "language":"independent", "age_range":"4 - 20", "slides":[{"id":"article1", "type":"standard", "template":"t1", "elements":[{"id":"article1_zone1", "areaid":"left"}, {"id":"article1_zone2", "areaid":"header"}, {"id":"article1_zone3", 
  "areaid":"subheader"}]}, {"id":"article2", "type":"standard", "template":"t2", "elements":[{"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"Marca las que quieras", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000"><span style="font-size: 38px;">Marca las que quieras</span></font></p>\n'}, "choices":[{"id":"1", "value":"\u00adMe gusta el color rojo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Me gusta el color rojo</span></span></p>\n', 
  "answer":true}, {"id":"2", "value":"\u200bMe gusta la pizza\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Me gusta la pizza&shy;</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u200b\u00adSoy un gnomo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Soy un gnomo</span></span></p>\n', "answer":true}, {"id":"4", "value":"\u00adSoy designer", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Soy designer</span></span></p>\n', "answer":true}], "extras":{"multipleAnswer":true}, "quiz_simple_json":{"title":"Excursion MC Multiple Answer Test", "description":"Excursion MC Multiple Answer Test", "author":"&lt;Demo&gt;", "type":"quiz_simple", "slides":[{"id":"article2", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article2_zone1", "type":"quiz", "areaid":"left", 
  "quiztype":"multiplechoice", "selfA":true, "question":{"value":"Marca las que quieras", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000"><span style="font-size: 38px;">Marca las que quieras</span></font></p>\n'}, "choices":[{"id":"1", "value":"\u00adMe gusta el color rojo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Me gusta el color rojo</span></span></p>\n', "answer":true}, {"id":"2", "value":"\u200bMe gusta la pizza\u00ad", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Me gusta la pizza&shy;</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u200b\u00adSoy un gnomo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Soy un gnomo</span></span></p>\n', "answer":true}, {"id":"4", "value":"\u00adSoy designer", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Soy designer</span></span></p>\n', 
  "answer":true}], "extras":{"multipleAnswer":true}}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article3", "type":"standard", "template":"t2", "elements":[{"id":"article3_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":false, "question":{"value":"Quiz no autoevaluable, \u00bfQue piensas del mineralismo?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">Quiz no autoevaluable, &iquest;Que piensas del mineralismo?&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u200bEs algo bueno\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Es algo bueno&shy;</span></span></p>\n', "answer":"?"}, {"id":"2", "value":"\u200b\u00adEs algo malo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Es algo malo</span></span></p>\n', "answer":"?"}, {"id":"3", "value":"\u200bEl mineralismo va a llegar\u00ad", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">El mineralismo va a llegar&shy;</span></span></p>\n', "answer":"?"}], "extras":{"multipleAnswer":false}, "quiz_simple_json":{"title":"Excursion MC Multiple Answer Test", "description":"Excursion MC Multiple Answer Test", "author":"&lt;Demo&gt;", "type":"quiz_simple", "slides":[{"id":"article3", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article3_zone1", "type":"quiz", 
  "areaid":"left", "quiztype":"multiplechoice", "selfA":false, "question":{"value":"Quiz no autoevaluable, \u00bfQue piensas del mineralismo?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">Quiz no autoevaluable, &iquest;Que piensas del mineralismo?&shy;</span></span></p>\n'}, "choices":[{"id":"1", "value":"\u200bEs algo bueno\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Es algo bueno&shy;</span></span></p>\n', 
  "answer":"?"}, {"id":"2", "value":"\u200b\u00adEs algo malo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Es algo malo</span></span></p>\n', "answer":"?"}, {"id":"3", "value":"\u200bEl mineralismo va a llegar\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">El mineralismo va a llegar&shy;</span></span></p>\n', "answer":"?"}], "extras":{"multipleAnswer":false}}], 
  "containsQuiz":true}]}}], "containsQuiz":true}], "id":"621"};
  return{basic_samples:basic_samples, samplesv01:samplesv01, fc_sample:fc_sample, samples_vtour:samples_vtour, full_samples:full_samples, quiz_samples:quiz_samples, magnetic_gifs:magnetic_gifs, new_wysiwyg:new_wysiwyg, test:test}
}(VISH);
VISH.Samples.API = function(V, undefined) {
  var recommendationList = [{"id":"1", "url":"http://vishub.org/excursions/144", "title":"Nanogame", "author":"Enrique Barra", "description":" bla bla bla", "image":"http://vishub.org/assets/logos/original/excursion-05.png", "views":"56", "favourites":"3", "number_of_slides":"8"}, {"id":"2", "url":"http://vishub.org/excursions/83", "title":"Flascard Curiosity", "author":"Evita Tassiopolu", "description":" bla bla bla 2", "image":"http://www.topsecretwriters.com/wp-content/uploads/2012/08/curiosityrover.jpg", 
  "views":"563", "favourites":"13", "number_of_slides":"2"}, {"id":"3", "url":"http://vishub.org/excursions/55", "title":"Madrid\u00b4s Planetarium", "author":"Nestor Toribio", "description":" bla bla bla", "image":"http://upload.wikimedia.org/wikipedia/commons/0/06/Planetarium_WPKiW.jpg", "views":"56", "favourites":"33", "number_of_slides":"8"}, {"id":"4", "url":"http://vishub.org/excursions/14", "title":"Earth explained", "author":"Enrique Barra", "description":" bla bla bla", "image":"http://upload.wikimedia.org/wikipedia/commons/2/22/Earth_Western_Hemisphere_transparent_background.png", 
  "views":"156", "favourites":"3", "number_of_slides":"8"}, {"id":"5", "url":"http://vishub.org/excursions/81", "title":"Planets: Mars", "author":"Barbara Kieslinger ", "description":" bla bla bla 2", "image":"http://static.giantbomb.com/uploads/scale_small/0/4866/192066-mars.jpg", "views":"463", "favourites":"23", "number_of_slides":"2"}, {"id":"6", "url":"http://vishub.org/excursions/56", "title":"Galileo", "author":"Nestor Toribio", "description":" bla bla bla", "image":"https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcRjinxT31jvvelugew_ydynnvzXcJRLSeTAMYPfEcFZsbvxAlHP", 
  "views":"1256", "favourites":"33", "number_of_slides":"8"}];
  var excursionList = {"excursions":[VISH.Samples.full_samples, VISH.Samples.quiz_samples, VISH.Samples.magnetic_gifs, VISH.Samples.basic_samples, VISH.Samples.fc_sample, VISH.Samples.samples_vtour, VISH.Samples.samplesv01, VISH.Samples.test]};
  var excursionListLittle = {"excursions":[VISH.Samples.full_samples, VISH.Samples.quiz_samples, VISH.Samples.magnetic_gifs]};
  var excursionListDummy = {"excursions":[]};
  var flashcardList = {"flashcards":[{"id":"1120", "VEVersion":"0.2", "type":"flashcard", "author":"", "slides":[{"id":"article4", "type":"flashcard", "background":"url(http://4.bp.blogspot.com/-fsV8poJXoJc/ULe8nkVbaVI/AAAAAAAAA-M/Q2vW16z6Ivc/s1600/Imagen16.png)", "pois":[{"id":"article4_poi1", "x":"36.875", "y":"67.33333333333333", "slide_id":"article4_article1"}, {"id":"article4_poi2", "x":"55.375", "y":"68.16666666666667", "slide_id":"article4_article2"}, {"id":"article4_poi3", "x":"45.875", "y":"5.5", 
  "slide_id":"article4_article3"}], "slides":[{"id":"article4_article1", "type":"standard", "template":"t2", "elements":[{"id":"article4_article1_zone1", "type":"image", "areaid":"left", "body":"http://1.bp.blogspot.com/_KaMLeO20q1Q/TGk8gfWkp7I/AAAAAAAAAHI/80bTifiIk6M/s1600/24+Do%C3%B1ana.JPG", "style":"position: relative; width:110.31518624641834%; height:97.1590909090909%; top:2.0833333333333335%; left:-1.146131805157593%;"}]}, {"id":"article4_article2", "type":"standard", "template":"t2", "elements":[{"id":"article4_article2_zone1", 
  "type":"image", "areaid":"left", "body":"http://farm9.staticflickr.com/8504/8367119464_f8ff09456d.jpg", "style":"position: relative; width:103.15186246418338%; height:90.53030303030303%; top:3.0303030303030303%; left:-0.5730659025787965%;"}]}, {"id":"article4_article3", "type":"standard", "template":"t2", "elements":[{"id":"article4_article3_zone1", "type":"image", "areaid":"left", "body":"http://cabeceras.eldiariomontanes.es/imagenes-municipios/galerias/5348/mf01z4411811x1492-452.jpg", "style":"position: relative; width:119.05444126074498%; height:129.54545454545453%; top:-2.6515151515151514%; left:-3.5816618911174785%;"}]}]}]}, 
  {"id":"1115", "VEVersion":"0.2", "type":"flashcard", "author":"", "slides":[{"id":"article4", "type":"flashcard", "background":"url(http://www.exploringnature.org/graphics/endangered_species/endangered_animals200.jpg)", "pois":[{"id":"article4_poi1", "x":"15.625", "y":"8.5", "slide_id":"article4_article3"}, {"id":"article4_poi2", "x":"77.75", "y":"11.5", "slide_id":"article4_article1"}, {"id":"article4_poi3", "x":"17.125", "y":"58.833333333333336", "slide_id":"article4_article2"}], "slides":[{"id":"article4_article3", 
  "type":"standard", "template":"t10", "elements":[{"id":"article4_article3_zone1", "type":"image", "areaid":"center", "body":"http://d30mmglg94tqnw.cloudfront.net/wp-content/plugins/magic-gallery/uploads/12/komodo-dragon_6771_600x450.jpg", "style":"position: relative; width:49.62406015037594%; height:66.22073578595318%; top:15.719063545150501%; left:24.18546365914787%;"}]}, {"id":"article4_article1", "type":"standard", "template":"t10", "elements":[{"id":"article4_article1_zone1", "type":"image", 
  "areaid":"center", "body":"http://www.golden-gate-park.com/wp-content/uploads/2011/03/bison_bufflo_in_golden_gate_park.jpg", "style":"position: relative; width:60.526315789473685%; height:67.3913043478261%; top:15.719063545150501%; left:20.17543859649123%;"}]}, {"id":"article4_article2", "type":"standard", "template":"t10", "elements":[{"id":"article4_article2_zone1", "type":"image", "areaid":"center", "body":"http://wfiles.brothersoft.com/e/elephant_88059-1600x1200.jpg", "style":"position: relative; width:115.91478696741855%; height:116.05351170568562%; top:-2.842809364548495%; left:-0.7518796992481203%;"}]}]}]}, 
  {"id":"111", "title":"Chess: The Art of Learning", "description":"The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by ViSH Editor.", "avatar":"/vishEditor/images/excursion_thumbnails/excursion-10.png", "author":"John Doe", "type":"flashcard", "tags":["Samples", "Test", "Development"], "author":"", "theme":"theme1", "age_range":"4 - 14", "subject":"Media Education", "language":"en", "educational_objectives":"bla bla bla 3", 
  "adquired_competencies":"pupils will be smarter", "slides":[{"id":"article1", "type":"flashcard", "background":"url(http://html.rincondelvago.com/000563580.png)", "pois":[{"id":"article1_poi1", "x":"11", "y":"4.5", "slide_id":"article1_article1"}, {"id":"article1_poi2", "x":"47", "y":"34", "slide_id":"article1_article2"}, {"id":"article1_poi3", "x":"84", "y":"81", "slide_id":"article1_article3"}], "slides":[{"id":"article1_article1", "template":"t1", "elements":[{"id":"article1_article1_zone1", 
  "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"article1_article1_zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"article1_article1_zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"article1_article2", "template":"t2", "elements":[{"id":"article1_article2_zone1", "type":"text", 
  "areaid":"header", "body":"Experimento virtual1"}, {"id":"article1_article2_zone2", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"article1_article3", "template":"t6", "elements":[{"id":"article1_article3_zone1", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"article1_article3_zone2", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"article1_article3_zone3", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"article1_article3_zone4", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}]}]}, 
  {"id":"222", "title":"Curiosity", "description":"The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by ViSH Editor.", "avatar":"/vishEditor/images/excursion_thumbnails/excursion-12.png", "author":"Comepiedras volador", "type":"flashcard", "tags":["Samples", "Test", "Development"], "theme":"theme1", "age_range":"4 - 14", "subject":"Media Education", "language":"en", "educational_objectives":"Known the comepiedras volador", 
  "adquired_competencies":"pupils will be smarter", "slides":[{"id":"article1", "type":"flashcard", "background":"url(http://images.freshnessmag.com/wp-content/uploads//2012/08/nasa-NASA-curiosity-mars-rover-00.jpg)", "pois":[{"id":"article1_poi1", "x":"11", "y":"4.5", "slide_id":"article1_article1"}, {"id":"article1_poi2", "x":"47", "y":"34", "slide_id":"article1_article2"}, {"id":"article1_poi3", "x":"84", "y":"81", "slide_id":"article1_article3"}], "slides":[{"id":"article1_article1", "template":"t1", 
  "elements":[{"id":"article1_article1_zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"article1_article1_zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"article1_article1_zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"article1_article2", "template":"t2", "elements":[{"id":"article1_article2_zone1", "type":"text", 
  "areaid":"header", "body":"Experimento virtual1"}, {"id":"article1_article2_zone2", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"article1_article3", "template":"t6", "elements":[{"id":"article1_article3_zone1", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"article1_article3_zone2", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"article1_article3_zone3", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"article1_article3_zone4", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}]}]}]};
  var smartcardList = {"excursions":[flashcardList.flashcards[0], flashcardList.flashcards[1], flashcardList.flashcards[2], flashcardList.flashcards[3], flashcardList.flashcards[3], flashcardList.flashcards[3], VISH.Samples.fc_sample, VISH.Samples.samples_vtour, VISH.Samples.test]};
  var imageList = {"pictures":[{"id":54, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.dan-dare.org/dan%20simpsons/TheSimpsonsEveryoneEver800.jpg"}, {"id":55, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://3.bp.blogspot.com/--H0o8mc28bA/TxrsnMAFMDI/AAAAAAAAARs/eOCVIXKlm9I/s1600/sala-cine.jpg"}, {"id":56, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, 
  {"id":57, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.granadablogs.com/pateandoelmundo/wp-content/uploads/2009/10/_061.jpg"}, {"id":58, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.revistaintime.com/wp-content/uploads/2012/03/el-padrino-2.jpg"}, {"id":59, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://cinealdesnudo.files.wordpress.com/2011/12/el-indomable-will-hunting.jpg"}, {"id":60, 
  "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://politicamenteconservador.blogia.com/upload/20060818041914-el-senor-de-los-anillos2.jpg"}, {"id":61, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://despertando.me/wp-content/uploads/2012/04/el-se%C3%B1or-de-los-anillos.jpg"}, {"id":62, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://4.bp.blogspot.com/-Fh_v8PYbVg0/TyGdKEiYmKI/AAAAAAAAAPI/MKdfZ224aEQ/s1600/el_senor_de_los_anillos_la_batalla_por_la_tierra_media_2_the_rise_of_the_witchking-181035.jpg"}, 
  {"id":63, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://1.bp.blogspot.com/_9PpLM82o3g0/S8uPONu3kaI/AAAAAAAAC9A/thHNALuFxdE/s1600/Gandalf-vs-El-Balrog-gandalf-7018563-1280-960.jpg"}, {"id":64, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"NOVAACARGAR"}, {"id":65, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":66, "title":"ClintEastwood.jpg", 
  "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":67, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":68, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":69, "title":"ClintEastwoooood.jpg", "description":"this is clint", 
  "author":"Demo", "src":"http://upload.wikimedia.org/wikipedia/en/4/47/Simpsons_on_Tracey_Ullman.png"}]};
  var imageListLittle = {"pictures":[{"id":54, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.dan-dare.org/dan%20simpsons/TheSimpsonsEveryoneEver800.jpg"}, {"id":55, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://3.bp.blogspot.com/--H0o8mc28bA/TxrsnMAFMDI/AAAAAAAAARs/eOCVIXKlm9I/s1600/sala-cine.jpg"}, {"id":56, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}]};
  var imageListDummy = {"pictures":[]};
  var video = {"id":"1534", "title":"Midnight Sun", "description":"Awesome HTML5 video example", "author":"John Doe", "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"};
  var videoList = {"videos":[{"id":"1534", "title":"HTML5 Demo", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML. HTML5 especifica dos variantes de sintaxis para HTML: un clasico HTML (text/html), la variante conocida como HTML5 y una variante XHTML conocida como sintaxis XHTML5 que debera ser servida como XML (XHTML) (application/xhtml+xml).1 2 Esta es la primera vez que HTML y XHTML se han desarrollado en paralelo.", 
  "author":"Awesome Videos", "poster":"http://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Sasso_lungo_da_passo_pordoi.jpg/250px-Sasso_lungo_da_passo_pordoi.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1535", "title":"Paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1536", "title":"Otro paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://1.bp.blogspot.com/-DFj9INluj80/TfiNl7q3DbI/AAAAAAAAAws/hVJu13VbKEY/s1600/paisaje.jpg", 
  "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1537", "title":"Verde", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://www.forodefotos.com/attachments/naturaleza/12983d1281113830-fotos-de-paisaje-fotos-de-paisaje.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + 
  '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1538", "title":"Noche", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://ro18.blogspot.es/img/paisaje.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1539", 
  "title":"Puesta de sol", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://walpaper.es/images/wallpapers/Paisaje-fotografia-HDR-656343.jpeg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1540", "title":"Cayuco", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://3.bp.blogspot.com/-a-WrZZf0WJo/TsEBPXjUQXI/AAAAAAAAFBg/kh0aS9Kemag/s1600/PAISAJE+JUANMA.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1541", "title":"Aves", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://images.artelista.com/artelista/obras/fichas/8/3/3/8619208014133041.JPG", 
  "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1542", "title":"Delfines", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://4.bp.blogspot.com/-CfZKEdXcXtg/TijG57sIFWI/AAAAAAAAARQ/O8FP1OQ0a0w/s1600/delfines-saltando.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + 
  '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1543", "title":"Gato", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://www.10puntos.com/wp-content/uploads/2010/09/gato-lindo.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + 
  "]"}, {"id":"1544", "title":"Otro gato", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://neko.koiora.net/files/2011/06/Gato17.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1545", "title":"Gato ninja", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://www.sarda.es/fotos/gato_volador/gato_volador.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}]};
  var videoListLittle = {"videos":[{"id":"1534", "title":"HTML5 Demo", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML. HTML5 especifica dos variantes de sintaxis para HTML: un clasico HTML (text/html), la variante conocida como HTML5 y una variante XHTML conocida como sintaxis XHTML5 que debera ser servida como XML (XHTML) (application/xhtml+xml).1 2 Esta es la primera vez que HTML y XHTML se han desarrollado en paralelo.", 
  "author":"Awesome Videos", "poster":"http://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Sasso_lungo_da_passo_pordoi.jpg/250px-Sasso_lungo_da_passo_pordoi.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1535", "title":"Paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1536", "title":"Otro paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://1.bp.blogspot.com/-DFj9INluj80/TfiNl7q3DbI/AAAAAAAAAws/hVJu13VbKEY/s1600/paisaje.jpg", 
  "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}]};
  var videoListDummy = {"videos":[]};
  var liveList = [{"id":"1534", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1535", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1536", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1537", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1538", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1539", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1540", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1541", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1542", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1543", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1544", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1545", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1546", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1547", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1548", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}];
  var liveListLittle = [{"id":"1534", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1535", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1548", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}];
  var liveListDummy = [];
  var objectList = [{"id":"1534", "title":"Game Strauss", "description":"Fichero PDF", "author":"Conspirazzi", "object":"http://www.conspirazzi.com/e-books/game-strauss.pdf"}, {"id":"1536", "title":"Profe", "description":"Flash Object Test", "author":"FlashMan", "object":'<embed width="100%" height="100%" id="player_api" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1537", "title":"Youtube video about HTML5", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML.", 
  "author":"W3C", "object":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns?wmode=opaque" frameborder="0" allowfullscreen></iframe>'}, {"id":"1538", "title":"Global excursion", "description":"Iframe example", "author":"Vish", "object":'<iframe width="100%" height="100%" src="http://www.globalexcursion-project.eu"></iframe>'}, {"id":"1539", "title":"Image", "description":"Image Embed", "author":"Globedia", "object":'<embed width="100%" src="http://globedia.com/imagenes/noticias/2011/2/10/encuentran-octava-maravilla-mundo-destruida-125-anos_2_585286.jpg"></embed>'}, 
  {"id":"1540", "title":"Profe Demo", "description":"Flash Object Test 2", "author":"FlashMan", "object":'<embed width="100%" height="100%" id="player_api" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}];
  var objectListLittle = [{"id":"1534", "title":"Game Strauss", "description":"Fichero PDF", "author":"Conspirazzi", "object":"http://www.conspirazzi.com/e-books/game-strauss.pdf"}, {"id":"1536", "title":"Profe", "description":"Flash Object Test", "author":"FlashMan", "object":'<embed width="100%" height="100%" id="player_api" src="examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1537", "title":"Youtube video about HTML5", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML.", 
  "author":"W3C", "object":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns?wmode=opaque" frameborder="0" allowfullscreen></iframe>'}];
  var objectListDummy = [];
  var tagsList = {"tags":["ActionScript", "AppleScript", "Asp", "BASIC", "C", "C++", "Clojure", "COBOL", "ColdFusion", "Erlang", "Fortran", "Groovy", "Haskell", "Java", "JavaScript", "Lisp", "Perl", "PHP", "Python", "Ruby", "Scala", "Scheme"]};
  var thumbnailsList = {"pictures":[{"title":"Thumbnail 1", "description":"Sample excursion thumbnail 1", "src":"/vishEditor/images/excursion_thumbnails/excursion-01.png"}, {"title":"Thumbnail 2", "description":"Sample excursion thumbnail 2", "src":"/vishEditor/images/excursion_thumbnails/excursion-02.png"}, {"title":"Thumbnail 3", "description":"Sample excursion thumbnail 3", "src":"/vishEditor/images/excursion_thumbnails/excursion-03.png"}, {"title":"Thumbnail 4", "description":"Sample excursion thumbnail 4", 
  "src":"/vishEditor/images/excursion_thumbnails/excursion-04.png"}, {"title":"Thumbnail 5", "description":"Sample excursion thumbnail 5", "src":"/vishEditor/images/excursion_thumbnails/excursion-05.png"}, {"title":"Thumbnail 6", "description":"Sample excursion thumbnail 6", "src":"/vishEditor/images/excursion_thumbnails/excursion-06.png"}, {"title":"Thumbnail 7", "description":"Sample excursion thumbnail 7", "src":"/vishEditor/images/excursion_thumbnails/excursion-07.png"}, {"title":"Thumbnail 8", 
  "description":"Sample excursion thumbnail 8", "src":"/vishEditor/images/excursion_thumbnails/excursion-08.png"}, {"title":"Thumbnail 9", "description":"Sample excursion thumbnail 9", "src":"/vishEditor/images/excursion_thumbnails/excursion-09.png"}, {"title":"Thumbnail 10", "description":"Sample excursion thumbnail 10", "src":"/vishEditor/images/excursion_thumbnails/excursion-10.png"}, {"title":"Thumbnail 11", "description":"Sample excursion thumbnail 11", "src":"/vishEditor/images/excursion_thumbnails/excursion-11.png"}, 
  {"title":"Thumbnail 12", "description":"Sample excursion thumbnail 12", "src":"/vishEditor/images/excursion_thumbnails/excursion-12.png"}, {"title":"Thumbnail 13", "description":"Sample excursion thumbnail 13", "src":"/vishEditor/images/excursion_thumbnails/excursion-13.png"}, {"title":"Thumbnail 14", "description":"Sample excursion thumbnail 14", "src":"/vishEditor/images/excursion_thumbnails/excursion-14.png"}, {"title":"Thumbnail 15", "description":"Sample excursion thumbnail 15", "src":"/vishEditor/images/excursion_thumbnails/excursion-15.png"}, 
  {"title":"Thumbnail 16", "description":"Sample excursion thumbnail 16", "src":"/vishEditor/images/excursion_thumbnails/excursion-16.png"}, {"title":"Thumbnail 17", "description":"Sample excursion thumbnail 17", "src":"/vishEditor/images/excursion_thumbnails/excursion-17.png"}, {"title":"Thumbnail 18", "description":"Sample excursion thumbnail 18", "src":"/vishEditor/images/excursion_thumbnails/excursion-18.png"}, {"title":"Thumbnail 19", "description":"Sample excursion thumbnail 19", "src":"/vishEditor/images/excursion_thumbnails/excursion-19.png"}, 
  {"title":"Thumbnail 20", "description":"Sample excursion thumbnail 20", "src":"/vishEditor/images/excursion_thumbnails/excursion-20.png"}, {"title":"Thumbnail 21", "description":"Sample excursion thumbnail 21", "src":"/vishEditor/images/excursion_thumbnails/excursion-21.png"}, {"title":"Thumbnail 22", "description":"Sample excursion thumbnail 22", "src":"/vishEditor/images/excursion_thumbnails/excursion-22.png"}, {"title":"Thumbnail 23", "description":"Sample excursion thumbnail 23", "src":"/vishEditor/images/excursion_thumbnails/excursion-23.png"}, 
  {"title":"Thumbnail 24", "description":"Sample excursion thumbnail 24", "src":"/vishEditor/images/excursion_thumbnails/excursion-24.png"}, {"title":"Thumbnail 25", "description":"Sample excursion thumbnail 25", "src":"/vishEditor/images/excursion_thumbnails/excursion-25.png"}, {"title":"Thumbnail 26", "description":"Sample excursion thumbnail 26", "src":"/vishEditor/images/excursion_thumbnails/excursion-26.png"}, {"title":"Thumbnail 27", "description":"Sample excursion thumbnail 27", "src":"/vishEditor/images/excursion_thumbnails/excursion-27.png"}, 
  {"title":"Thumbnail 28", "description":"Sample excursion thumbnail 28", "src":"/vishEditor/images/excursion_thumbnails/excursion-28.png"}, {"title":"Thumbnail 29", "description":"Sample excursion thumbnail 29", "src":"/vishEditor/images/excursion_thumbnails/excursion-29.png"}, {"title":"Thumbnail 30", "description":"Sample excursion thumbnail 30", "src":"/vishEditor/images/excursion_thumbnails/excursion-30.png"}]};
  var LREImageList = {"results":[{"meta":{"id":157132, "provider":"ILBE", "langBlocks":[{"language":"x-mt-it", "title":"Fauna e Floara dell'Israele", "description":"Questa risorsa ha le fotografie, le descrizioni di alcuna della flora e fauna dell'Israele"}, {"language":"x-mt-fr", "title":"Faune et Floara de l'Israel", "description":"Cette ressource a des photographies, des descriptions d'une partie de la flore et la faune de l'Israel"}, {"language":"x-mt-de", "title":"Fauna und Floara von Israel", 
  "description":"Dieses Hilfsmittel hat Fotographien, Beschreibungen von etwas von der Flora und Fauna von Israel"}, {"language":"x-mt-es", "title":"Fauna y Floara de Israel", "description":"Este recurso tiene las fotograf\u00edas, las descripciones de algo de la flora y fauna de Israel"}, {"language":"en", "title":"Fauna and Floara of Israel", "description":"This resource has photographs, descriptions of some of the flora and Fauna of Israel"}, {"language":"x-mt-pt", "title":"Fauna e Floara de Israel", 
  "description":"Este recurso tem fotografias, descri\u00e7\u00f5es de algum do flora e fauna de Israel"}, {"language":"x-mt-el", "title":"\u03a0\u03b1\u03bd\u03af\u03b4\u03b1 \u03ba\u03b1\u03b9 Floara \u03c4\u03bf\u03c5 \u0399\u03c3\u03c1\u03b1\u03ae\u03bb", "description":"\u0391\u03c5\u03c4\u03cc \u03c4\u03bf \u03c3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03bf \u03c3\u03c5\u03bc\u03c0\u03b5\u03c1\u03b9\u03c6\u03bf\u03c1\u03ac\u03c2 \u03ad\u03c7\u03b5\u03b9 \u03c4\u03b9\u03c2 \u03c6\u03c9\u03c4\u03bf\u03b3\u03c1\u03b1\u03c6\u03af\u03b5\u03c2, \u03c0\u03b5\u03c1\u03b9\u03b3\u03c1\u03b1\u03c6\u03ad\u03c2 \u03bc\u03b5\u03c1\u03b9\u03ba\u03ad\u03c2 \u03b1\u03c0\u03cc \u03c4\u03b7 \u03c7\u03bb\u03c9\u03c1\u03af\u03b4\u03b1 \u03ba\u03b1\u03b9 \u03c4\u03b7\u03bd \u03c0\u03b1\u03bd\u03af\u03b4\u03b1 \u03c4\u03bf\u03c5 \u0399\u03c3\u03c1\u03b1\u03ae\u03bb"}], 
  "rights":{"cc":false, "url":"", "by":false, "nc":false, "nd":false, "sa":false}, "expressions":[{"language":"en", "manifestations":[{"player":"webBrowser", "urls":["http://oer.eun.org/VWClc0HZLsQohR_gIPB3Tm41jgwk"]}]}]}, "para":{"commentsInfo":{"count":0}, "favouritesInfo":{"count":0}, "idsTuple":{"expressionID":0, "globalLREID":157132, "manifestationID":0, "socialID":"157132/0/0"}, "opinionsInfo":{"downCount":0, "upCount":0}, "ratingsInfo":{"average":0, "count":0, "sum":0}, "tagsInfo":{"labels":[]}}}, 
  {"meta":{"id":249838, "provider":"TD", "langBlocks":[{"language":"en", "title":"Design Inspired by Nature", "description":"In this stills collage produced for Teachers' Domain, see several examples of everyday inventions that were either inspired by nature or are similar in form and function to plants or animals."}], "rights":{"cc":false, "url":"http://www.teachersdomain.org/terms_of_use.html", "by":false, "nc":false, "nd":false, "sa":false}, "expressions":[{"language":"en", "manifestations":[{"player":"landingPage", 
  "urls":["http://oer.eun.org/VWClc0LSLsIrhB_gIPJ4Rgn51X81"]}, {"player":"webBrowser", "urls":["http://oer.eun.org/VWClc0LSLsIrhR_gIPJ4RgU23uqf"]}]}]}, "para":{"commentsInfo":{"count":0}, "favouritesInfo":{"count":0}, "idsTuple":{"expressionID":0, "globalLREID":249838, "manifestationID":0, "socialID":"249838/0/0"}, "opinionsInfo":{"downCount":0, "upCount":0}, "ratingsInfo":{"average":0, "count":0, "sum":0}, "tagsInfo":{"labels":[]}}}, {"meta":{"id":253883, "provider":"NASAPHOTOJOURNAL", "langBlocks":[{"language":"x-mt-it", 
  "title":"Hamersley ': Non abbastanza Come 'Il Cratere Dell'Aquila '", "description":'Questo mosaico approssimativo di immagine di allineare-colore dalla macchina fotografica panoramica sull\'occasione del vagabondo di esplorazione del Marte mostra l\'obiettivo nicknamed "Hamersley" all\'interno "del cratere di Fram." La natura del materiale dell\'affioramento visto in questa posizione si interrompe visibilmente. Alcune zone egualmente hanno fare uno strato di che pu\u00f2 essere distintivo da che cosa gli scienziati hanno visto precedentemente in "cratere dell\'aquila." L\'occasione sta viaggiando verso "una resistenza dubbed grande cratere." Pu\u00f2 ritornare a Fram per ulteriore analisi delle relativi roccie e terrenise permessi di tempo. Le immagini in questo mosaico sono state prese sul solenoide 87 con le macchine fotografiche panoramica 480 -, 530- ed i filtri 600-nanometer.'}, 
  {"language":"x-mt-de", "title":"Hamersley ': Nicht Durchaus Wie ' Adler-Krater '", "description":'Dieses ungef\u00e4hre Zutreffendfarbe Bildmosaik von der panoramischen Kamera auf der Mars Erforschung-Vagabund-Gelegenheit zeigt das Ziel, das nicknamed ist "Hamersley" innerhalb "des Fram Kraters." Die Natur des Zutageliegenmaterials, das in diesen Standort gesehen wird, wird sichtbar gest\u00f6rt. Etwas Bereiche haben auch das \u00dcberlagern, das sein kann unterscheidend von, was Wissenschaftler sahen vorher in "Adler-Krater." Gelegenheit reist in Richtung zu einer gro\u00dfer Krater betitelten "Ausdauer." Sie kann zu Fram f\u00fcr weitere Analyse seiner Felsen und Bodens zur\u00fcckgehen wenn Zeiterlaubnis. Die Bilder in diesem Mosaik wurden auf Solenoid 87 mit der panoramischen Kamera 480 -, 530- und Filter 600-nanometer genommen.'}, 
  {"language":"x-mt-fr", "title":"Hamersley ': Pas tout \u00e0 fait Comme Le 'Crat\u00e8re d'Aigle '", "description":"Cette mosa\u00efque approximative d'image de vrai-couleur de l'appareil-photo panoramique sur l'occasion de vagabond d'exploration de Mars montre la cible surnomm\u00e9e \"Hamersley\" dans le \"crat\u00e8re de Fram.\" La nature du mat\u00e9riel d'affleurement vu dans cet emplacement est visiblement perturb\u00e9e. Quelques zones ont \u00e9galement poser qui peut \u00eatre distinctif dece que les scientifiques ont vu pr\u00e9c\u00e9demment en \"crat\u00e8re d'aigle.\" L'occasion voyage vers une \"r\u00e9sistance doubl\u00e9e grand par crat\u00e8re.\" Elle peut retourner \u00e0 Fram pour davantage d'analyse de ses roches et sols si des laisux de temps. Les images dans cette mosa\u00efque ont \u00e9t\u00e9 prises sur le sol\u00e9no\u00efde 87 avec l'appareil-photo panoramique 480 -, 530- et filtres 600-nanometer."}, 
  {"language":"x-mt-es", "title":"Hamersley ': No absolutamente Como El ' Cr\u00e1ter Del \u00c1guila '", "description":'Este mosaico aproximado de la imagen del verdadero-color de la c\u00e1mara fotogr\u00e1fica panor\u00e1mica en la oportunidad del rover de la exploraci\u00f3n de Marte muestra la blanco apodada "Hamersley" dentro del "cr\u00e1ter de Fram." La naturaleza del material del afloramiento considerado en esta localizaci\u00f3n se interrumpe visiblemente. Algunas \u00e1reas tambi\u00e9n tienen acodar que pueda ser distintivo de lo que vieron los cient\u00edficos previamenteen "cr\u00e1ter del \u00e1guila." La oportunidad est\u00e1 viajando hacia una "resistencia doblada cr\u00e1ter grande." Puede volver a Fram para el an\u00e1lisis adicional de sus rocas y suelos si los permisos del tiempo. Las im\u00e1genes en este mosaico fueron adquiridas el solenoide 87 con la c\u00e1mara fotogr\u00e1fica panor\u00e1mica 480 -, 530- y filtros 600-nanometer.'}, 
  {"language":"en", "title":"Hamersley' : Not Quite Like 'Eagle Crater'", "description":'This approximate true-color image mosaic from the panoramic camera on the Mars Exploration Rover Opportunity shows the target nicknamed "Hamersley" within "Fram Crater." The nature of the outcrop material seen in this location is visibly disrupted. Some areas also have layering that may be distinctive from what scientists saw previously in "Eagle Crater." Opportunity is traveling toward a large crater dubbed "Endurance." It may return to Fram for further analysis of its rocks and soils if time permits. The images in this mosaic were taken on sol 87 with the panoramic camera\'s 480-, 530- and 600-nanometer filters.'}, 
  {"language":"x-mt-pt", "title":"Hamersley ': N\u00e3o completamente Como ' A Cratera Da \u00c1guia '", "description":'Este mosaic aproximado da imagem da verdadeiro-cor da c\u00e2mera panoramic na oportunidade do vagabundo da explora\u00e7\u00e3o de Marte mostra o alvo nicknamed "Hamersley" dentro de "da cratera Fram." A natureza do material do outcrop visto nestaposi\u00e7\u00e3o disrupted visivelmente. Algumas \u00e1reas t\u00eam tamb\u00e9m mergulhar que pode ser distintivo de o que os cientistas viram previamente da "na cratera \u00e1guia." A oportunidade est\u00e1 viajando para cratera grande uma "resist\u00eancia dubbed." Pode retornar a Fram para uma an\u00e1lise mais adicional de seus rochas e solos se licen\u00e7as do tempo. As imagens neste mosaic foram feitas exame no solen\u00f3ide 87 com a c\u00e2mera panoramic 480 -, 530- e filtros 600-nanometer.'}], 
  "rights":{"cc":false, "url":"http://creativecommons.org/publicdomain/mark/1.0/", "by":false, "nc":false, "nd":false, "sa":false}, "expressions":[{"language":"en", "manifestations":[{"player":"landingPage", "urls":["http://oer.eun.org/VWClc0HbKM4qhR_gIPB5TFHGMCw1"]}]}]}, "para":{"commentsInfo":{"count":0}, "favouritesInfo":{"count":0}, "idsTuple":{"expressionID":0, "globalLREID":253883, "manifestationID":0, "socialID":"253883/0/0"}, "opinionsInfo":{"downCount":0, "upCount":0}, "ratingsInfo":{"average":0, 
  "count":0, "sum":0}, "tagsInfo":{"labels":[]}}}, {"meta":{"id":253896, "provider":"NASAPHOTOJOURNAL", "langBlocks":[{"language":"x-mt-it", "title":"Roccie Sedimentarie Di Schiaparelli", "description":"Versione no. MOC2-403, il 26 di MGS MOC giugno 2003 alcuni dei risultati di formazione immagine di alta risoluzione pi\u00f9 importanti del centro globale di esperimento della macchina fotografica del orbiter del Marte dell'ispettore del Marte (MGS) (MOC)sulle scoperte circa la presenza e la natura del record sedimentario della roccia su Marte. Questo vecchio cratere di effetto del meteor in bacino nordoccidentale di Schiaparelli esibisce una vista spettacolare della roccia fatta uno strato di e sedimentaria. Ilcratere (1.4 miglio) largo 2.3 chilometri pu\u00f2 completamente essere riempito una volta di sedimento; il materiale pi\u00f9 successivamente \u00e8 stato corroso alla relativa forma attuale. Ledozzine degli strati di spessore simile e le propriet\u00e0 fisiche ora sono espresse nelle nozze raggrum-come la pila nel mezzo del cratere. La luce solare che illumina la scena dalla parte di sinistra indica che il cerchio, o la parte superiore di MESA, alla met\u00e0 del cratere si leva in piedi pi\u00f9 superiore agli altri strati scala-fatti un passo. Le propriet\u00e0 fisiche dell'uniforme e l'assestamento di questi strati potrebbero indicare che originalmente sono state depositate in un lago (\u00e8 possibile che il cratere era allaparte inferiore di lago molto pi\u00f9 grande, di un bacino riempientesi di Schiaparelli); alternativamente, gli strati sono stati depositati sistemandosi dell'atmosfera in un ambiente asciutto. Questa immagine \u00e8 stata acquistata il 3 giugno 2003 ed \u00e8 situata vicino a 0.9S, 346.2W."}, 
  {"language":"en", "title":"Schiaparelli Sedimentary Rocks", "description":"MGS MOC Release No. MOC2-403, 26 June 2003 Some of the most important high resolution imaging results of the Mars Global Surveyor (MGS) Mars Orbiter Camera (MOC) experiment center on discoveries about the presence and nature of the sedimentary rock record on Mars. This old meteor impact crater in northwestern Schiaparelli Basin exhibits a spectacular view of layered, sedimentary rock. The 2.3 kilometer (1.4 miles) wide crater may have once been completely filled with sediment; the material was later eroded to its present form. Dozens of layers of similar thickness and physical properties are now expressed in a wedding cake-like stack in the middle of the crater. Sunlight illuminating the scene from the left shows that the circle, or mesa top, at the middle of the crater stands higher than the other stair-stepped layers. The uniform physical properties and bedding of these layers might indicate that they were originally deposited in a lake (it is possible that the crater was at the bottom of a much larger lake, filling Schiaparelli Basin); alternatively, the layers were deposited by settling out of the atmosphere in a dry environment. This picture was acquired on June 3, 2003, and is located near 0.9S, 346.2W."}, 
  {"language":"x-mt-pt", "title":"Rochas Sedimentary De Schiaparelli", "description":"Libera\u00e7\u00e3o no. MOC2-403 de MGS MOC, 26 junho 2003alguns dos resultados de alta resolu\u00e7\u00e3o os mais importantes da imagem latente do centro global da experi\u00eancia da c\u00e2mera do orbiter de Marte do surveyor de Marte (MGS) (MOC) em descobertas sobre a presen\u00e7a e a natureza do registro sedimentary da rocha em Marte. Esta cratera velha do impacto do meteoro na bacia do noroeste deSchiaparelli exibe uma vista espectacular da rocha mergulhada, sedimentary. A cratera de 2.3 quil\u00f4metros (1.4 milha) de largura pode uma vez completamente ter sido enchida com o sedimento; o material foi corro\u00eddo mais tarde a seu formul\u00e1rio atual. As d\u00fazias das camadas de espessura similar e as propriedades f\u00edsicas s\u00e3o expressadas agora em um casamento endure\u00e7-como a pilha no meio da cratera. A luz solar que ilumina a cena da esquerda mostra que o c\u00edrculo, ou o alto do mesa, no meio da cratera est\u00e3o mais altamente do que as outras camadas escada-pisadas. As propriedades f\u00edsicas e o fundamento uniformes destas camadas puderam indicar que estiveram depositadas originalmente em um lago (\u00e9 poss\u00edvel que a cratera estava no fundo de um lago muito maior, de umabacia de enchimento de Schiaparelli); alternativamente, as camadas foram depositadas estabelecindo-se fora da atmosfera em um ambiente seco. Este retrato foi adquirido junho em 3, 2003, e \u00e9ficado situado perto de 0.9S, 346.2W."}], 
  "rights":{"cc":false, "url":"http://creativecommons.org/publicdomain/mark/1.0/", "by":false, "nc":false, "nd":false, "sa":false}, "expressions":[{"language":"en", "manifestations":[{"player":"landingPage", "urls":["http://oer.eun.org/VWClc0HbKMcpgh_gIPB5TLh4hjKH"]}]}]}, "para":{"commentsInfo":{"count":0}, "favouritesInfo":{"count":0}, "idsTuple":{"expressionID":0, "globalLREID":253896, "manifestationID":0, "socialID":"253896/0/0"}, "opinionsInfo":{"downCount":0, "upCount":0}, "ratingsInfo":{"average":0, 
  "count":0, "sum":0}, "tagsInfo":{"labels":[]}}}, {"meta":{"id":253900, "provider":"NASAPHOTOJOURNAL", "langBlocks":[{"language":"x-mt-it", "title":"Banda del radar de 28 ottobre 2005, flyby di Titan", "description":"Questo programma della luna Titan del Saturno mostra la posizione tracciata con il rilevamento del radar di Cassini usando il relativo modo sintetico di formazione immagine del radar dell'apertura durante 28 ottobre 2005, flyby. La banda del radar\u00e8 sovrapposta su un'immagine di falso-colore fatta dalle osservazionidal telescopio dello spazio del Hubble della NASA. La posizione del luogo di atterraggio di Huygens \u00e8 contrassegnata nel colore rossoall'estrema destra. La sovrapposizione fra i dati di Huygens e la volont\u00e0 di dati del radar d\u00e0 i nuovi indizii alla natura della superficie vista dalla sonda di Huygens, che ha atterrato su Titan nelmese di gennaio del 2005. Del 28 la banda ottobre \u00e8 di lunghezza circa 6.150 chilometri (3.821 miglio), estendendosi del nordda 7 gradi fino 18 gradi di latitudine del sud ed ad ovest da 179 gradi fino 320 gradi di longitudine ad ovest. La risoluzione spaziale delle immagini del radar varia da circa 300 tester (980 piedi) per il pixel a circa 1.5 chilometro (0.93 miglia) per il pixel.Quattro passaggi del radar del Cassini hanno rivelato una variet\u00e0 di caratteristiche geologiche, compreso i crateri di effetto,di depositi vento-saltati, di scanalature e di caratteristiche cryovolcanic. La missione di Cassini-Huygens \u00e8 un progetto cooperativo della NASA, dell'Ente Spaziale Europeo e dell'agenzia italiana dello spazio. Il laboratorio di propulsione del getto, una divisione della California Institute of Technology A Pasadena, gestisce la missione per la direzione di missione di scienza della NASA, Washington, D.C. The Cassini che il orbiter \u00e8 stato progettato,sviluppato e montato a JPL. Lo strumento del radar \u00e8 stato costruito da JPL e l'agenzia italiana dello spazio, funzionante con i membri della squadra dal unito Dichiara e parecchi paesi europei. Per le pi\u00f9 informazioni sulla chiamata di missione di Cassini-Huygens"}, 
  {"language":"x-mt-de", "title":"Radar-Schwade von Okt. 28, 2005, Titan Flyby", "description":"Diese Karte von Mond Titan Saturns zeigt den Standort, der mit dem Cassini Radarkartographen mit seinem synthetischen Blenden\u00f6ffnung Radar-Belichtung Modus w\u00e4hrend des Okt.28, 2005, Flyby abgebildet wird. Die RadarSchwade wird auf einem Falschfarbe Bild gelegt, das von den Beobachtungen durch Platz-Teleskop Hubble NASAs gebildet wird. Der Standort der Huygens Landungsites wird im Rot auf dem weit rechten gekennzeichnet. Die Deckung zwischen den Huygens Daten und dem Radardatenwillen geben neue Anhaltspunkte zur Natur der Oberfl\u00e4che, die durch die Huygens Pr\u00fcfspitze gesehen wird, die auf Titan im Januar 2005 landete. Die Okt. 28 Schwade ist ungef\u00e4hr 6.150 Kilometer (3.821 Meilen) lang und dehnt sich von 7 Grad Nord auf 18 Grad S\u00fcdbreite und von 179 Grad West auf 320 Grad Westl\u00e4nge aus. Die r\u00e4umliche Zerlegung der Radarbilder reicht von ungef\u00e4hr 300 Metern (980 Fu\u00df) pro Pixel bis zu ungef\u00e4hr 1.5 Kilometern (0.93 Meilen) pro Pixel. Cassinis deckten vier Radardurchl\u00e4ufe eine Vielzahl der geologischen Merkmale, einschlie\u00dflich Auswirkung Krater,der Wind-durchgebrannten Ablagerungen, der F\u00fchrungen und der cryovolcanic Merkmale auf. Die Cassini-Huygens Mission ist ein kooperatives Projekt der NASAS, der Europ\u00e4ischen Weltraumorganisationund der italienischen Platz-Agentur. Das Strahl Antrieb-Labor, eine Abteilung der California Institutes of Technology in Pasadena, handhat die Mission f\u00fcr Direktorat Mission Wissenschaft der NASAS, Washington, D.C. The Cassini, das Orbiter konzipiert war, sich entwickelt und an JPL zusammengebaut. Das Radarinstrument wurde durch JPL und die italienische Platz-Agentur aufgebaut und arbeitete mit Teambauteilen von den Vereinigten Staaten und von einigen europ\u00e4ischen L\u00e4ndern. Zu mehr Information \u00fcber den Cassini-Huygens Mission Besuch"}, 
  {"language":"x-mt-fr", "title":"Bandage de radar oct. de 28, 2005, flyby de Titan", "description":"Cette carte du Titan de la lune de Saturne montre l'emplacement trac\u00e9 avec le cartographe de radar de Cassini enutilisant son mode synth\u00e9tique de formation image de radar d'ouverture pendant oct. 28, 2005, flyby. Le bandage de radar est superpos\u00e9 \u00e0 une image de faux-couleur faite \u00e0 partir des observations par le t\u00e9lescope de l'espace de Hubble de NASA's. L'emplacement du site d'atterrissage de Huygens est marqu\u00e9 dansle rouge sur loin le droit. La superposition entre les donn\u00e9es de Huygens et la volont\u00e9 de donn\u00e9es de radar donnent de nouveaux indices \u00e0 la nature de la surface vue par la sonde de Huygens, qui a d\u00e9barqu\u00e9 sur le Titan en janvier 2005. Le bandage oct. de 28 est d'environ 6.150 kilom\u00e8tres de long (3.821 milles), s'\u00e9tendant de 7 degr\u00e9s de du nord \u00e0 18 degr\u00e9s de latitude du sud et de 179 degr\u00e9s d'occidental \u00e0 320 degr\u00e9s de longitude occidentale. La r\u00e9solution spatiale des images de radar s'\u00e9tend d'environ 300 m\u00e8tres (980 pieds) par Pixel \u00e0 environ 1.5 kilom\u00e8tre (0.93 mille) par Pixel. Quatre passages du radar de Cassini ont indiqu\u00e9 une vari\u00e9t\u00e9 de dispositifs g\u00e9ologiques, y compris des crat\u00e8res d'impact, de d\u00e9p\u00f4ts vent-souffl\u00e9s, de canaux et de dispositifs cryovolcanic. La mission de Cassini-Huygens est un projet coop\u00e9ratif de la NASA, de l'Agence europ\u00e9enne de l'espace et de l'agence italienne de l'espace. Le laboratoire depropulsion de Voyager en jet, une division de la California Institute of Technology \u00c0 Pasadena, contr\u00f4le la mission pour la direction de mission de la Science de la NASA, Washington, D.C. The Cassini que la navette spatiale a \u00e9t\u00e9 con\u00e7ue, d\u00e9velopp\u00e9 et r\u00e9uni \u00e0 JPL. L'instrument de radar a \u00e9t\u00e9 construit par JPL et l'agence italienne de l'espace, fonctionnant avec des membres d'\u00e9quipe des Etats-Unis et plusieurs pays europ\u00e9ens. Pour plus d'informations sur la visite de mission de Cassini-Huygens"}, 
  {"language":"x-mt-es", "title":"Andana del radar del de oct. 28 de 2005, flyby delTit\u00e1n", "description":"Esta correspondencia del Tit\u00e1n de la luna de Saturno muestra la localizaci\u00f3n asociada con el mapper del radar de Cassini usando su modo sintetizado de la proyecci\u00f3n de imagen del radar de la abertura durante de oct. el 28 de 2005, flyby. La andana del radar se sobrepone en una imagen del falso-color hecha de observaciones por el telescopio del espacio de Hubble de NAS\u00c1s. La localizaci\u00f3n del sitio del aterrizaje de Huygens est\u00e1 marcada en rojo en el lejos derecho. El traslapo entre los datosde Huygens y la voluntad de los datos del radar da nuevas pistas a la naturaleza de la superficie considerada por la punta de prueba de Huygens, que aterriz\u00f3 en Tit\u00e1n en enero de 2005. La andanade oct. del 28 tiene cerca de 6.150 kil\u00f3metros de largo (3.821 millas), extendiendo a partir de 7 grados de del norte a 18 grados de latitud del sur y de 179 grados de del oeste a 320 grados de longitud del oeste. La resoluci\u00f3n espacial de las im\u00e1genes del radar seextiende de cerca de 300 contadores (980 pies) por el pixel a cerca de1.5 kil\u00f3metros (0.93 milla) por el pixel. Cuatro pasos del radar de Cassini revelaron una variedad de caracter\u00edsticas geol\u00f3gicas, incluyendo los cr\u00e1teres del impacto, de dep\u00f3sitos viento-soplados, de canales y de caracter\u00edsticas cryovolcanic. La misi\u00f3n de Cassini-Huygens es un proyecto cooperativo de la NASA, de la Agencia Espacial Europea y de la agencia italiana del espacio. El laboratorio de la propulsi\u00f3n del jet, divisi\u00f3n de la California Institute of Technology En Pasadena, maneja la misi\u00f3n para la direcci\u00f3n de la misi\u00f3n de la ciencia de la NASA, Washington,D.C. The Cassini que el orbiter fue dise\u00f1ado, convertido y ensambladoen JPL. El instrumento del radar fue construido por JPL y la agencia italiana del espacio, trabajando con los miembros del equipo de los Estados Unidos y de varios pa\u00edses europeos. Para m\u00e1s informaci\u00f3n sobre la visita de la misi\u00f3n de Cassini-Huygens"}, 
  {"language":"en", "title":"Radar Swath of Oct. 28, 2005, Titan Flyby", "description":"This map of Saturn's moon Titan shows the location mapped with the Cassini radar mapper using its synthetic aperture radar imaging mode during the Oct. 28, 2005, flyby. The radar swath is superimposed on a false-color image made from observations by NASA's Hubble Space Telescope. The location of the Huygens landing site is marked in red on the far right. The overlap between the Huygens data and the radar data will give new clues to the nature of the surface seen by the Huygens probe, which landed on Titan in January 2005. The Oct. 28 swath is about 6,150 kilometers long (3,821 miles), extending from 7 degrees north to 18 degrees south latitude and 179 degrees west to 320 degrees west longitude. The spatial resolution of the radar images ranges from about 300 meters (980 feet) per pixel to about 1.5 kilometers (0.93 miles) per pixel. Cassini's four radar passes revealed a variety of geologic features, including impact craters, wind-blown deposits, channels and cryovolcanic features. The Cassini-Huygens mission is a cooperative project of NASA, the European Space Agency and the Italian Space Agency. The Jet Propulsion Laboratory, a division of the California Institute of Technology in Pasadena, manages the mission for NASA's Science Mission Directorate, Washington, D.C. The Cassini orbiter was designed, developed and assembled at JPL. The radar instrument was built by JPL and the Italian Space Agency, working with team members from the United States and several European countries. For more information about the Cassini-Huygens mission visit"}, 
  {"language":"x-mt-pt", "title":"Swath do radar outubro de 28, 2005, demostra\u00e7\u00e3o a\u00e9rea de Titan", "description":"Este mapa da lua Titan de Saturno mostra a posi\u00e7\u00e3o tra\u00e7ada com o cart\u00f3grafo do radar de Cassini usando sua modalidade sint\u00e9tica da imagem latente do radar da abertura durante outubro o 28, 2005, demostra\u00e7\u00e3o a\u00e9rea. O swath do radar \u00e9 sobreposto em uma imagem da falso-cor feita das observa\u00e7\u00f5es pelo telesc\u00f3pio do espa\u00e7o de Hubble de NASA. A posi\u00e7\u00e3o do local da aterragem de Huygens \u00e9 marcada no vermelho no distante direito. A sobreposi\u00e7\u00e3o entre os dados de Huygens e a vontade dos dadosdo radar d\u00e1 ind\u00edcios novos \u00e0 natureza da superf\u00edcie vista pela ponta de prova de Huygens, que aterrou em Titan em janeiro 2005. O swath outubro de 28 tem aproximadamente 6.150 quil\u00f4metros de comprimento (3.821 milhas), estendendo de 7 graus norte a 18 graus de latitude sul e de 179 graus ocidental a 320 graus de longitude ocidental. A defini\u00e7\u00e3o spatial das imagens do radar varia de aproximadamente 300 medidores (980 p\u00e9s) por o pixel a aproximadamente1.5 quil\u00f4metro (0.93 milha) por o pixel. Passagens do radar de Cassini quatro revelaram uma variedade de caracter\u00edsticas geologic, including crateras do impacto, de dep\u00f3sitos vento-fundidos, de canaletas e de caracter\u00edsticas cryovolcanic. A miss\u00e3o de Cassini-Huygens \u00e9 um projeto cooperativo da NASA, da ag\u00eancia de espa\u00e7o europ\u00e9ia e da ag\u00eancia italiana do espa\u00e7o. O laborat\u00f3rio da propuls\u00e3o do jato, uma divis\u00e3o da California Institute of Technology Em Pasadena, controla a miss\u00e3o para o directorate da miss\u00e3o da ci\u00eancia da NASA, Washington, C.C.  Cassini que o orbiter foi projetado, tornado e montado em JPL. O instrumento do radar foi constru\u00eddo por JPL e pela ag\u00eancia italiana do espa\u00e7o, trabalhando com membros da equipe dos estados unidos e de diversos pa\u00edses europeus. Para mais informa\u00e7\u00e3o sobre a visitada miss\u00e3o de Cassini-Huygens"}], 
  "rights":{"cc":false, "url":"http://creativecommons.org/publicdomain/mark/1.0/", "by":false, "nc":false, "nd":false, "sa":false}, "expressions":[{"language":"en", "manifestations":[{"player":"landingPage", "urls":["http://oer.eun.org/VWClc0LSJcMhih_gIPJ5TpiQpQej"]}]}]}, "para":{"commentsInfo":{"count":0}, "favouritesInfo":{"count":0}, "idsTuple":{"expressionID":0, "globalLREID":253900, "manifestationID":0, "socialID":"253900/0/0"}, "opinionsInfo":{"downCount":0, "upCount":0}, "ratingsInfo":{"average":0, 
  "count":0, "sum":0}, "tagsInfo":{"labels":[]}}}]};
  return{recommendationList:recommendationList, imageList:imageList, imageListLittle:imageListLittle, imageListDummy:imageListDummy, videoList:videoList, videoListLittle:videoListLittle, videoListDummy:videoListDummy, objectList:objectList, objectListLittle:objectListLittle, objectListDummy:objectListDummy, liveList:liveList, liveListLittle:liveListLittle, liveListDummy:liveListDummy, excursionList:excursionList, excursionListLittle:excursionListLittle, excursionListDummy:excursionListDummy, smartcardList:smartcardList, 
  tagsList:tagsList, thumbnailsList:thumbnailsList, LREImageList:LREImageList}
}(VISH);
VISH.Slides = function(V, $, undefined) {
  var slideEls;
  var curSlideIndex;
  var SLIDE_CLASSES = ["far-past", "past", "current", "next", "far-next"];
  var curSubSlideId = null;
  var init = function() {
    _getcurSlideIndexFromHash()
  };
  var updateSlides = function() {
    setSlides(document.querySelectorAll("section.slides > article"));
    _updateSlideClasses();
    _updateHash()
  };
  var _updateHash = function() {
    if(!V.Editing) {
      location.replace("#" + (curSlideIndex + 1))
    }
  };
  var _updateSlideClasses = function() {
    for(var i = 0;i < slideEls.length;i++) {
      switch(i) {
        case curSlideIndex - 2:
          updateSlideClass(i + 1, "far-past");
          break;
        case curSlideIndex - 1:
          updateSlideClass(i + 1, "past");
          break;
        case curSlideIndex:
          updateSlideClass(i + 1, "current");
          break;
        case curSlideIndex + 1:
          updateSlideClass(i + 1, "next");
          break;
        case curSlideIndex + 2:
          updateSlideClass(i + 1, "far-next");
          break;
        default:
          updateSlideClass(i + 1);
          break
      }
    }
  };
  var updateSlideClass = function(slideNumber, className) {
    var el = getSlideWithNumber(slideNumber);
    if(!el) {
      return
    }
    if(className) {
      $(el).addClass(className)
    }
    for(var i in SLIDE_CLASSES) {
      if(className != SLIDE_CLASSES[i]) {
        $(el).removeClass(SLIDE_CLASSES[i])
      }
    }
  };
  var _getcurSlideIndexFromHash = function() {
    if(V.Editing) {
      setCurrentSlideNumber(0)
    }else {
      var slideNo = parseInt(location.hash.substr(1));
      if(slideNo) {
        setCurrentSlideNumber(slideNo)
      }else {
        setCurrentSlideNumber(1)
      }
    }
  };
  var getSlides = function() {
    return slideEls
  };
  var setSlides = function(newSlideEls) {
    slideEls = newSlideEls;
    $.each(slideEls, function(index, value) {
      $(value).attr("slidenumber", index + 1)
    })
  };
  var getCurrentSlide = function() {
    return slideEls[curSlideIndex]
  };
  var getCurrentSubSlide = function() {
    if(curSubSlideId === null) {
      return null
    }else {
      return $("#" + curSubSlideId)
    }
  };
  var getCurrentSlideNumber = function() {
    return curSlideIndex + 1
  };
  var setCurrentSlideNumber = function(currentSlideNumber) {
    _setCurrentSlideIndex(currentSlideNumber - 1)
  };
  var _setCurrentSlideIndex = function(newCurSlideIndex) {
    curSlideIndex = newCurSlideIndex
  };
  var getSlideWithNumber = function(slideNumber) {
    var no = slideNumber - 1;
    if(no < 0 || no >= slideEls.length) {
      return null
    }else {
      return slideEls[no]
    }
  };
  var getNumberOfSlide = function(slide) {
    if(slideEls) {
      var result = 0;
      $.each(slideEls, function(index, value) {
        if($(value).attr("id") == $(slide).attr("id")) {
          result = index + 1;
          return
        }
      });
      return result
    }else {
      return 0
    }
  };
  var getSlidesQuantity = function() {
    var slides = getSlides();
    if(typeof slides != "undefined" && slides.length) {
      return slides.length
    }else {
      return 0
    }
  };
  var getSlideType = function(slideEl) {
    if(slideEl && slideEl.tagName === "ARTICLE") {
      return $(slideEl).attr("type")
    }else {
      if(typeof slideEl == "object" && slideEl.length === 1 && slideEl[0].tagName === "ARTICLE") {
        return $(slideEl).attr("type")
      }else {
        if(typeof slideEl == "object" && typeof slideEl.type == "string") {
          return slideEl.type
        }else {
          return null
        }
      }
    }
  };
  var isCurrentFirstSlide = function() {
    return curSlideIndex === 0
  };
  var isCurrentLastSlide = function() {
    return curSlideIndex === slideEls.length - 1
  };
  var triggerEnterEvent = function(slideNumber) {
    var el = getSlideWithNumber(slideNumber);
    if(!el) {
      return
    }
    triggerEnterEventById(el.id)
  };
  var triggerLeaveEvent = function(slideNumber) {
    var el = getSlideWithNumber(slideNumber);
    if(!el) {
      return
    }
    triggerLeaveEventById(el.id)
  };
  var triggerEnterEventById = function(slide_id) {
    var el = $("#" + slide_id)[0];
    var evt = document.createEvent("Event");
    evt.initEvent("slideenter", true, true);
    el.dispatchEvent(evt)
  };
  var triggerLeaveEventById = function(slide_id) {
    var el = $("#" + slide_id)[0];
    var evt = document.createEvent("Event");
    evt.initEvent("slideleave", true, true);
    el.dispatchEvent(evt)
  };
  var forwardOneSlide = function(event) {
    moveSlides(1)
  };
  var backwardOneSlide = function() {
    moveSlides(-1)
  };
  var moveSlides = function(n) {
    if(n > 0 && !V.Editing && isCurrentLastSlide() && V.Status.getDevice().desktop && V.Viewer.getPresentationType() === V.Constant.PRESENTATION) {
      V.Recommendations.showFancybox();
      return
    }
    var no = curSlideIndex + n + 1;
    no = Math.min(Math.max(1, no), slideEls.length);
    goToSlide(no)
  };
  var goToSlide = function(no, triggeredByUser) {
    if(no === getCurrentSlideNumber() || no > slideEls.length || no <= 0) {
      return
    }
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && V.Status.isPreventDefaultMode() && V.Messenger) {
      var params = new Object;
      params.slideNumber = no;
      V.Messenger.notifyEventByMessage(V.Constant.Event.onGoToSlide, params);
      return
    }
    if(!V.Editing && $.fancybox) {
      $.fancybox.close()
    }
    _goToSlide(no);
    if(V.Editing) {
      V.Editor.Tools.cleanZoneTools();
      V.Editor.Thumbnails.selectThumbnail(no)
    }else {
      V.Viewer.updateSlideCounter()
    }
    var params = new Object;
    params.slideNumber = no;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onGoToSlide, params, triggeredByUser)
  };
  var _goToSlide = function(no) {
    var nextSlideIndex = no - 1;
    if(nextSlideIndex < slideEls.length && nextSlideIndex >= 0) {
      triggerLeaveEvent(curSlideIndex + 1);
      _setCurrentSlideIndex(nextSlideIndex);
      updateSlides();
      triggerEnterEvent(curSlideIndex + 1)
    }
  };
  var lastSlide = function() {
    goToSlide(slideEls.length)
  };
  var openSubslide = function(slide_id, triggeredByUser) {
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && V.Status.isPreventDefaultMode() && V.Messenger) {
      var params = new Object;
      params.slideNumber = slide_id;
      V.Messenger.notifyEventByMessage(V.Constant.Event.onFlashcardPointClicked, params);
      return
    }
    _onOpenSubslide(slide_id);
    $("#" + slide_id).removeClass("hide_in_smartcard");
    $("#" + slide_id).addClass("show_in_smartcard");
    triggerEnterEventById(slide_id);
    var params = new Object;
    params.slideNumber = slide_id;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onFlashcardPointClicked, params, triggeredByUser)
  };
  var closeSubslide = function(slide_id, triggeredByUser) {
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && V.Status.isPreventDefaultMode() && V.Messenger) {
      var params = new Object;
      params.slideNumber = slide_id;
      V.Messenger.notifyEventByMessage(V.Constant.Event.onFlashcardSlideClosed, params);
      return
    }
    _onCloseSubslide(slide_id);
    $("#" + slide_id).removeClass("show_in_smartcard");
    $("#" + slide_id).addClass("hide_in_smartcard");
    triggerLeaveEventById(slide_id);
    var params = new Object;
    params.slideNumber = slide_id;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onFlashcardSlideClosed, params, triggeredByUser)
  };
  var _onOpenSubslide = function(subSlideId) {
    curSubSlideId = subSlideId;
    $("#closeButton").hide()
  };
  var _onCloseSubslide = function() {
    curSubSlideId = null;
    if(V.Status.getDevice().mobile) {
      setTimeout(function() {
        V.ViewerAdapter.decideIfCloseButton();
        V.ViewerAdapter.decideIfPageSwitcher()
      }, 800)
    }else {
      V.ViewerAdapter.decideIfPageSwitcher()
    }
  };
  var isSlideset = function(type) {
    switch(type) {
      case V.Constant.FLASHCARD:
      ;
      case V.Constant.VTOUR:
        return true;
      default:
        return false
    }
  };
  return{init:init, updateSlides:updateSlides, getSlides:getSlides, setSlides:setSlides, getCurrentSlide:getCurrentSlide, getCurrentSubSlide:getCurrentSubSlide, getCurrentSlideNumber:getCurrentSlideNumber, setCurrentSlideNumber:setCurrentSlideNumber, getSlideWithNumber:getSlideWithNumber, getNumberOfSlide:getNumberOfSlide, getSlidesQuantity:getSlidesQuantity, getSlideType:getSlideType, isCurrentFirstSlide:isCurrentFirstSlide, isCurrentLastSlide:isCurrentLastSlide, moveSlides:moveSlides, forwardOneSlide:forwardOneSlide, 
  backwardOneSlide:backwardOneSlide, goToSlide:goToSlide, lastSlide:lastSlide, openSubslide:openSubslide, closeSubslide:closeSubslide, isSlideset:isSlideset, triggerEnterEvent:triggerEnterEvent, triggerEnterEventById:triggerEnterEventById, triggerLeaveEvent:triggerLeaveEvent, triggerLeaveEventById:triggerLeaveEventById}
}(VISH, jQuery);
VISH.Events = function(V, $, undefined) {
  var eMobile;
  var bindedEventListeners = false;
  var mobile;
  var init = function() {
    mobile = !V.Status.getDevice().desktop;
    eMobile = V.Events.Mobile;
    if(!V.Editing) {
      eMobile.init();
      bindViewerEventListeners()
    }
  };
  var bindViewerEventListeners = function() {
    if(bindedEventListeners) {
      return
    }
    $("article").live("slideenter", V.Viewer.onSlideEnterViewer);
    $("article").live("slideleave", V.Viewer.onSlideLeaveViewer);
    _addTutorialEvents();
    $(document).bind("keydown", handleBodyKeyDown);
    $(document).on("click", "#page-switcher-start", function() {
      V.Slides.backwardOneSlide()
    });
    $(document).on("click", "#page-switcher-end", function() {
      V.Slides.forwardOneSlide()
    });
    $(document).on("keypress", "#slide-counter-input", function(e) {
      if(e.which == 13) {
        V.Slides.goToSlide($("#slide-counter-input").val())
      }
    });
    $(document).on("click", "#closeButton", function(event) {
      event.stopPropagation();
      event.preventDefault();
      var comeBackUrl = V.Viewer.getOptions()["comeBackUrl"];
      if(comeBackUrl) {
        window.top.location.href = V.Viewer.getOptions()["comeBackUrl"]
      }else {
        if(V.Status.getIsEmbed() && V.Status.getDevice().features.history) {
          history.back()
        }
      }
    });
    $(document).on("click", "#back_arrow", function(event) {
      V.Slides.backwardOneSlide()
    });
    $(document).on("click", "#forward_arrow", function(event) {
      V.Slides.forwardOneSlide()
    });
    $(document).on("click", ".close_subslide", onCloseSubslideClicked);
    if(typeof applicationCache !== "undefined") {
      applicationCache.addEventListener("cached", function() {
        V.Storage.addPresentation(presentation)
      }, false);
      applicationCache.addEventListener("updateready", function() {
        V.Storage.addPresentation(presentation)
      }, false)
    }
    $(window).focus(function() {
      V.Status.setWindowFocus(true)
    }).blur(function() {
      V.Status.setWindowFocus(false)
    });
    var multipleOnResize = undefined;
    window.onresize = function() {
      if(typeof multipleOnResize === "undefined") {
        multipleOnResize = false;
        setTimeout(function() {
          if(!multipleOnResize) {
            multipleOnResize = undefined;
            V.ViewerAdapter.updateInterface()
          }else {
            multipleOnResize = undefined;
            window.onresize()
          }
        }, 600)
      }else {
        multipleOnResize = true
      }
    };
    if(mobile) {
      eMobile.bindViewerMobileEventListeners()
    }
    bindedEventListeners = true
  };
  var _addTutorialEvents = function() {
    $(document).on("click", "#tab_quiz_session_help", function() {
      V.Tour.startTourWithId("quiz_session_help", "bottom")
    });
    $(document).on("click", "#tab_quiz_stats_help", function() {
      V.Tour.startTourWithId("quiz_session_help", "bottom")
    });
    $(document).on("click", "#help_addslides_selection", function() {
      V.Tour.startTourWithId("addslides_help", "bottom")
    })
  };
  var unbindViewerEventListeners = function() {
    if(!bindedEventListeners) {
      return
    }
    $(document).unbind("keydown", handleBodyKeyDown);
    $(document).off("click", "#page-switcher-start");
    $(document).off("click", "#page-switcher-end");
    $(document).off("click", "#back_arrow", V.Slides.backwardOneSlide);
    $(document).off("click", "#forward_arrow", V.Slides.forwardOneSlide);
    $(document).off("click", "#closeButton");
    $(document).off("click", ".close_subslide", onCloseSubslideClicked);
    if(typeof applicationCache !== "undefined") {
      applicationCache.removeEventListener("cached", function() {
        V.Storage.addPresentation(presentation)
      }, false);
      applicationCache.removeEventListener("updateready", function() {
        V.Storage.addPresentation(presentation)
      }, false)
    }
    if(mobile) {
      eMobile.unbindViewerMobileEventListeners()
    }
    bindedEventListeners = false
  };
  var handleBodyKeyDown = function(event) {
    switch(event.keyCode) {
      case 34:
      ;
      case 38:
      ;
      case 39:
        V.Slides.forwardOneSlide();
        event.preventDefault();
        break;
      case 33:
      ;
      case 37:
      ;
      case 40:
        V.Slides.backwardOneSlide();
        event.preventDefault();
        break
    }
  };
  var onFlashcardPoiClicked = function(poiId) {
    var poi = V.Flashcard.getPoiData(poiId);
    if(poi !== null) {
      V.Slides.openSubslide(poi.slide_id, true)
    }
  };
  var onCloseSubslideClicked = function(event) {
    var close_slide_id = event.target.id.substring(5);
    V.Slides.closeSubslide(close_slide_id, true)
  };
  return{init:init, bindViewerEventListeners:bindViewerEventListeners, unbindViewerEventListeners:unbindViewerEventListeners, onFlashcardPoiClicked:onFlashcardPoiClicked, onCloseSubslideClicked:onCloseSubslideClicked}
}(VISH, jQuery);
VISH.Flashcard = function(V, $, undefined) {
  var flashcards;
  var pois;
  var FPS = 25;
  var TOTAL_FRAMES = 20;
  var FRAME_WIDTH = 50;
  var init = function(presentation) {
    if(!flashcards) {
      flashcards = new Array;
      pois = new Array
    }
  };
  var startAnimation = function(slideId) {
    if(typeof flashcards !== "undefined" && typeof flashcards[slideId] !== "undefined" && typeof flashcards[slideId].timer == "undefined") {
      flashcards[slideId].timer = setInterval(function() {
        animateArrows(slideId)
      }, 1E3 / FPS)
    }
  };
  var stopAnimation = function(slideId) {
    if(typeof flashcards !== "undefined" && typeof flashcards[slideId] !== "undefined" && typeof flashcards[slideId].timer !== "undefined") {
      clearTimeout(flashcards[slideId].timer);
      flashcards[slideId].timer = undefined
    }
  };
  var addArrow = function(fcId, poi, sync) {
    if(!poi || !poi.x || !poi.y || poi.x > 100 || poi.y > 100) {
      return
    }
    var flashcard_div = $("#" + fcId);
    var poiId = V.Utils.getId(fcId + "_poi");
    var div_to_add = "<div class='fc_poi' id='" + poiId + "' style='position:absolute;left:" + poi.x + "%;top:" + poi.y + "%'></div>";
    flashcard_div.append(div_to_add);
    if(typeof flashcards[fcId] === "undefined") {
      flashcards[fcId] = new Object;
      flashcards[fcId].arrows = []
    }
    var arrow = new Object;
    arrow.id = poiId;
    if(sync) {
      arrow.position = 0
    }else {
      var rand_pos = Math.floor(Math.random() * TOTAL_FRAMES + 1) * FRAME_WIDTH;
      arrow.position = rand_pos
    }
    arrow.slide_id = poi.slide_id;
    arrow.x = poi.x;
    arrow.y = poi.y;
    flashcards[fcId].arrows.push(arrow);
    pois[arrow.id] = arrow;
    $("#" + poiId).click(function(event) {
      V.Events.onFlashcardPoiClicked(poiId)
    })
  };
  var animateArrows = function(slideId) {
    if(!slideId || typeof flashcards[slideId] === "undefined") {
      return
    }
    $(flashcards[slideId].arrows).each(function(index, value) {
      var new_pos = (value.position + FRAME_WIDTH) % (TOTAL_FRAMES * FRAME_WIDTH);
      var arrow_dom_el = $("#" + value.id);
      $(arrow_dom_el).css("background-position", new_pos + "px" + " 0px");
      flashcards[slideId].arrows[index].position = new_pos
    })
  };
  var getPoiData = function(poiId) {
    if(typeof pois !== "undefined" && typeof pois[poiId] !== "undefined") {
      return pois[poiId]
    }
    return null
  };
  return{init:init, addArrow:addArrow, startAnimation:startAnimation, stopAnimation:stopAnimation, animateArrows:animateArrows, getPoiData:getPoiData}
}(VISH, jQuery);
VISH.Quiz = function(V, $, undefined) {
  var quizMode;
  var currentQuizDOM;
  var currentQuizSession;
  var currentPolling;
  var quizSessionId;
  var initBeforeRender = function(presentation) {
    if(presentation.type === V.Constant.QUIZ_SIMPLE) {
      quizMode = V.Constant.QZ_MODE.RT;
      if(V.Utils.getOptions().quizSessionId) {
        quizSessionId = V.Utils.getOptions().quizSessionId
      }
    }else {
      quizMode = V.Constant.QZ_MODE.SELFA
    }
  };
  var init = function() {
    $("#quizSessionNameInput").watermark(V.I18n.getTrans("i.QuizSessionName"));
    V.Quiz.API.init(V.Utils.getOptions().quizSessionAPI);
    V.Quiz.MC.init();
    V.Quiz.TF.init();
    V.QuizCharts.init(V.Utils.getOptions());
    _loadEvents()
  };
  var _loadEvents = function() {
    $(document).on("click", ".quizAnswerButton", _onAnswerQuiz);
    $(document).on("click", ".quizStartButton", _onStartQuiz);
    $(document).on("click", ".quizStopButton", _onStopQuiz);
    $("a#addQuizSessionFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":"0%", "height":"0%", "padding":0, "autoScale":true, "onStart":function(data) {
      loadTab("tab_quiz_session");
      $("#fancybox-close").height(0);
      $("#fancybox-close").css("padding", 0)
    }, "onComplete":function(data) {
      setTimeout(function() {
        V.ViewerAdapter.updateFancyboxAfterSetupSize();
        if(currentQuizSession && currentQuizSession.url) {
          _loadQr(currentQuizSession.url)
        }
      }, 300)
    }, "onClosed":function() {
      _stopPolling()
    }})
  };
  var _onAnswerQuiz = function(event) {
    var quizDOM = $("div.quizContainer").has(event.target);
    var quizModule = _getQuizModule($(quizDOM).attr("type"));
    if(quizModule) {
      if(quizMode === V.Constant.QZ_MODE.SELFA) {
        var quizStatus = $(quizDOM).find(".quizAnswerButton").attr("quizstatus");
        if(quizStatus === "retry") {
          quizModule.onRetryQuiz(quizDOM)
        }else {
          quizModule.onAnswerQuiz(quizDOM)
        }
      }else {
        var report = quizModule.getReport(quizDOM);
        _answerRTQuiz(quizDOM, quizModule, report)
      }
    }
  };
  var _answerRTQuiz = function(quizDOM, quizModule, report) {
    if(!quizSessionId) {
      return
    }
    if(report.empty === true) {
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizEmptyAnswerAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    quizModule.disableQuiz(quizDOM);
    _loadingAnswerButton(quizDOM);
    var answers = report.answers;
    V.Quiz.API.sendAnwers(answers, quizSessionId, function(data) {
      disableAnswerButton(quizDOM);
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizSubmittedAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options)
    }, function(error) {
      disableAnswerButton(quizDOM);
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizNotSubmittedAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options)
    })
  };
  var _onStartQuiz = function(event) {
    var startButton = $(event.target);
    var quizDOM = $("div.quizContainer").has(startButton);
    switch($(startButton).attr("quizStatus")) {
      case "running":
        $("#fancybox-close").hide();
        $("a#addQuizSessionFancybox").trigger("click");
        break;
      case "loading":
        break;
      case "stop":
      ;
      default:
        _startNewQuizSession(quizDOM);
        break
    }
  };
  var _startNewQuizSession = function(quizDOM) {
    if(currentQuizSession) {
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizMultipleLaunchAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    _loadingLaunchButton(quizDOM);
    var quizJSON = _getQuizJSONFromQuiz(quizDOM);
    V.Quiz.API.startQuizSession(quizDOM, quizJSON, _onQuizSessionReceived, _onQuizSessionReceivedError)
  };
  var _onQuizSessionReceived = function(quizDOM, quizSession) {
    currentQuizDOM = quizDOM;
    currentQuizSession = quizSession;
    _runningLaunchButton(quizDOM);
    $("a#addQuizSessionFancybox").trigger("click")
  };
  var _onQuizSessionReceivedError = function(quizDOM, error) {
    _enableLaunchButton(quizDOM);
    var options = {};
    options.width = "80%";
    options.text = V.I18n.getTrans("i.QuizCreateSessionError");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options);
    return
  };
  var _getQuizJSONFromQuiz = function(quizDOM) {
    var slideDOM = $("article").has(quizDOM);
    return _getQuizJSONFromSlide(slideDOM)
  };
  var _getQuizJSONFromSlide = function(slideDOM) {
    var slideId = $(slideDOM).attr("id");
    var presentation = V.Viewer.getCurrentPresentation();
    if(slideId && presentation) {
      var slides = presentation.slides;
      var sL = slides.length;
      for(var i = 0;i < sL;i++) {
        if(slides[i].id == slideId) {
          var elements = slides[i].elements;
          var eL = elements.length;
          for(var j = 0;j < eL;j++) {
            if(elements[j].type == V.Constant.QUIZ) {
              return elements[j].quiz_simple_json
            }
          }
        }
      }
    }
  };
  var _onStopQuiz = function(event) {
    var options = {};
    options.width = "80%";
    options.text = V.I18n.getTrans("i.QuizSaveConfirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.cancel");
    button1.extraclass = "quizSession_button_cancel";
    button1.callback = function() {
      _onCloseQuizSession("cancel")
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.text = V.I18n.getTrans("i.No");
    button2.extraclass = "quizSession_button_no";
    button2.callback = function() {
      _onCloseQuizSession("no")
    };
    options.buttons.push(button2);
    var button3 = {};
    button3.text = V.I18n.getTrans("i.Yes");
    button3.extraclass = "quizSession_button_yes";
    button3.callback = function() {
      _onCloseQuizSession("yes")
    };
    options.buttons.push(button3);
    var input = document.createElement("input");
    $(input).attr("id", "quizSessionNameInput");
    $(input).attr("title", V.I18n.getTrans("i.tooltip.QSInput"));
    $(input).addClass("quizSessionNameInput");
    $(input).watermark(V.I18n.getTrans("i.QuizSessionName"));
    options.middlerow = $(input);
    options.middlerowExtraClass = "mr_quizSession";
    options.buttonsWrapperClass = "forceCenter";
    V.Utils.showDialog(options)
  };
  var _onCloseQuizSession = function(saving) {
    var name = undefined;
    switch(saving) {
      case "yes":
        $(".quizSessionNameInput").each(function(index, pn) {
          if($(pn).is(":visible")) {
            name = $(pn).val()
          }
        });
        $(".quizSession_button_yes").addClass("quizStartButtonLoading");
        _closeQuizSession(name);
        break;
      case "no":
        $(".quizSession_button_no").addClass("quizStartButtonLoading");
        _deleteQuizSession();
        break;
      case "cancel":
      ;
      default:
        $.fancybox.close();
        break
    }
  };
  var _closeQuizSession = function(name) {
    V.Quiz.API.closeQuizSession(currentQuizSession.id, name, function(data) {
      _afterCloseQuizSession()
    }, function() {
      _afterCloseQuizSession()
    })
  };
  var _afterCloseQuizSession = function() {
    $.fancybox.close();
    $(".quizSession_button_no").removeClass("quizStartButtonLoading");
    $(".quizSession_button_yes").removeClass("quizStartButtonLoading");
    _enableLaunchButton(currentQuizDOM);
    currentQuizDOM = null;
    currentQuizSession = null;
    _cleanResults()
  };
  var _deleteQuizSession = function() {
    V.Quiz.API.deleteQuizSession(currentQuizSession.id);
    _afterCloseQuizSession()
  };
  var render = function(elJSON, template) {
    var quizModule = _getQuizModule(elJSON.quiztype);
    if(quizModule) {
      var quizDOM = quizModule.render(elJSON, template);
      return"<div id='" + elJSON["id"] + "' class='quizWrapper " + template + "_" + elJSON["areaid"] + " " + template + "_quiz" + "'>" + quizDOM + "</div>"
    }
  };
  var renderButtons = function(selfA) {
    var quizButtons = $("<div class='quizButtons'></div>");
    if(quizMode === V.Constant.QZ_MODE.SELFA && (V.Configuration.getConfiguration().mode === V.Constant.VISH || V.Configuration.getConfiguration()["mode"] === V.Constant.NOSERVER) && V.User.isLogged() && !V.Utils.getOptions().preview) {
      var startButton = $("<input type='button' class='buttonQuiz quizStartButton' value='" + V.I18n.getTrans("i.QuizLaunch") + "'/>");
      $(quizButtons).append(startButton)
    }
    if(selfA || quizMode === V.Constant.QZ_MODE.RT) {
      var answerButton = $("<input type='button' class='buttonQuiz quizAnswerButton' value='" + V.I18n.getTrans("i.QuizButtonAnswer") + "'/>");
      $(quizButtons).append(answerButton)
    }
    return quizButtons
  };
  var enableAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).removeAttr("disabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).removeAttr("quizStatus");
    $(answerButton).attr("value", V.I18n.getTrans("i.QuizButtonAnswer"))
  };
  var retryAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).removeAttr("disabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "retry");
    $(answerButton).attr("value", V.I18n.getTrans("i.QuizRetry"))
  };
  var _loadingAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).attr("disabled", "disabled");
    $(answerButton).addClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "loading")
  };
  var disableAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).attr("disabled", "disabled");
    $(answerButton).addClass("quizAnswerButtonDisabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "disabled")
  };
  var _enableLaunchButton = function(quiz) {
    var startButton = $(quiz).find("input.quizStartButton");
    $(startButton).removeAttr("disabled");
    $(startButton).removeClass("quizStartButtonLoading");
    $(startButton).removeAttr("quizStatus");
    $(startButton).attr("value", V.I18n.getTrans("i.QuizLaunch"))
  };
  var _loadingLaunchButton = function(quizDOM) {
    var startButton = $(quizDOM).find("input.quizStartButton");
    $(startButton).attr("disabled", "disabled");
    $(startButton).addClass("quizStartButtonLoading");
    $(startButton).attr("quizStatus", "loading");
    $(startButton).attr("value", V.I18n.getTrans("i.QuizLaunch"))
  };
  var _runningLaunchButton = function(quiz) {
    var startButton = $(quiz).find("input.quizStartButton");
    $(startButton).removeAttr("disabled");
    $(startButton).removeClass("quizStartButtonLoading");
    $(startButton).attr("quizStatus", "running");
    $(startButton).attr("value", V.I18n.getTrans("i.QuizButtonOptions"))
  };
  var loadTab = function(tab_id) {
    $(".fancy_viewer_tab_content").hide();
    $("#" + tab_id + "_content").show();
    $(".fancy_viewer_tab").removeClass("fancy_selected");
    $("#" + tab_id).addClass("fancy_selected");
    $(".help_in_fancybox_viewer").hide();
    $("#" + tab_id + "_help").show();
    switch(tab_id) {
      case "tab_quiz_session":
        _loadQuizSession();
        break;
      case "tab_quiz_stats":
        _loadStats();
        break;
      default:
        break
    }
    return false
  };
  var _loadQuizSession = function() {
    if(!currentQuizSession) {
      return
    }
    var myA = $("#tab_quiz_session_url_link");
    $(myA).attr("href", currentQuizSession.url);
    $(myA).html("<p id='tab_quiz_session_url'>" + currentQuizSession.url + "</p>");
    var sharingText = $(currentQuizDOM).find(".mc_question_wrapper_viewer").text().trim();
    var twitter = $("#tab_quiz_session_share_twitter");
    $(twitter).attr("href", "https://twitter.com/share?url=" + currentQuizSession.url + "&text=" + sharingText + "");
    var facebook = $("#tab_quiz_session_share_facebook");
    var facebookUrl = "http://www.facebook.com/sharer.php?s=100&p[url]=" + currentQuizSession.url + "&p[title]=" + sharingText;
    $(facebook).attr("href", facebookUrl);
    var gPlus = $("#tab_quiz_session_share_gPlus");
    $(gPlus).attr("href", "https://plus.google.com/share?url=" + currentQuizSession.url)
  };
  var _loadStats = function() {
    V.Quiz.API.getResults(currentQuizSession.id, function(results) {
      _drawResults(results);
      _startPolling()
    })
  };
  var _loadQr = function(url) {
    if(typeof url != "string") {
      return
    }
    var container = $(".quizQr");
    $(container).html("");
    $("#tab_quiz_session_content").addClass("temp_shown");
    $(container).addClass("temp_shown");
    var height = $(container).height();
    $(container).removeClass("temp_shown");
    $("#tab_quiz_session_content").removeClass("temp_shown");
    var width = height;
    var qrOptions = {render:"canvas", width:width, height:height, color:"#000", bgColor:"#fff", text:url.toString()};
    $(container).qrcode(qrOptions);
    var overlayHeight = $("#qr_overlay").height();
    var qrOptions = {render:"canvas", width:overlayHeight, height:overlayHeight, color:"#000", bgColor:"#fff", text:url.toString()};
    $("#qr_overlay").qrcode(qrOptions);
    var qrDOMFancybox = $(container).find("canvas");
    $(qrDOMFancybox).click(function() {
      $("#qr_overlay").show()
    });
    $("#qr_overlay").click(function() {
      $("#qr_overlay").hide()
    })
  };
  var _openQrOverlay = function(qr) {
    $("#qr_overlay").show()
  };
  var _updateQrSizeOnOverlay = function() {
    var qr = $("#qr_overlay").find("canvas");
    var qrSize = Math.min($("#qr_overlay").width(), $("#qr_overlay").height());
    $(qr).width(qrSize);
    $(qr).height(qrSize)
  };
  var _closeQrOverlay = function() {
    $("#qr_overlay").hide()
  };
  var _startPolling = function() {
    _stopPolling();
    currentPolling = setInterval(function() {
      if(!currentQuizSession) {
        _stopPolling();
        return
      }
      V.Quiz.API.getResults(currentQuizSession.id, function(results) {
        _drawResults(results)
      })
    }, 2500)
  };
  var _stopPolling = function() {
    if(currentPolling) {
      clearInterval(currentPolling)
    }
  };
  var _drawResults = function(results) {
    if(currentQuizSession) {
      if(typeof currentQuizSession.lastDrawedResults != "undefined" && results.length === currentQuizSession.lastDrawedResults.length) {
        return
      }else {
        currentQuizSession.lastDrawedResults = results
      }
    }else {
      return
    }
    var options = {};
    if(typeof currentQuizSession.firstDrawed == "undefined") {
      currentQuizSession.firstDrawed = false;
      options.animation = true;
      options.callback = function() {
        currentQuizSession.firstDrawed = true
      }
    }else {
      if(currentQuizSession.firstDrawed == false) {
        return
      }
    }
    _cleanResults();
    var canvas = $("#quiz_chart");
    var desiredWidth = $("#fancybox-content").width();
    var desiredHeight = $("#fancybox-content").height() * 0.8;
    $(canvas).width(desiredWidth);
    $(canvas).height(desiredHeight);
    $(canvas).attr("width", desiredWidth);
    $(canvas).attr("height", desiredHeight);
    $(canvas).show();
    var quizJSON = _getQuizJSONFromQuiz(currentQuizDOM);
    V.QuizCharts.drawQuizChart(canvas, quizJSON, results, options)
  };
  var _cleanResults = function() {
    var canvas = $("#quiz_chart");
    var ctx = $(canvas).get(0).getContext("2d");
    ctx.clearRect(0, 0, $(canvas).width(), $(canvas).height());
    $(canvas).hide()
  };
  var _getQuizModule = function(quiz_type) {
    switch(quiz_type) {
      case V.Constant.QZ_TYPE.OPEN:
        break;
      case V.Constant.QZ_TYPE.MCHOICE:
        return V.Quiz.MC;
        break;
      case V.Constant.QZ_TYPE.TF:
        return V.Quiz.TF;
        break;
      default:
        return null;
        break
    }
  };
  var updateCheckbox = function(checkbox, check) {
    if(typeof check == "boolean") {
      check = check.toString()
    }
    var imagePathRoot = V.ImagesPath + "quiz/checkbox";
    switch(check) {
      case "true":
        $(checkbox).attr("check", "true");
        $(checkbox).attr("src", imagePathRoot + "_checked.png");
        break;
      case "false":
        $(checkbox).attr("check", "false");
        $(checkbox).attr("src", imagePathRoot + "_wrong.png");
        break;
      case "none":
      ;
      default:
        $(checkbox).attr("check", "none");
        $(checkbox).attr("src", imagePathRoot + ".png");
        break
    }
  };
  var aftersetupSize = function(increase) {
    setTimeout(function() {
      if(currentQuizSession && currentQuizSession.url) {
        _loadQr(currentQuizSession.url);
        _updateQrSizeOnOverlay()
      }
    }, 500)
  };
  return{initBeforeRender:initBeforeRender, init:init, render:render, renderButtons:renderButtons, updateCheckbox:updateCheckbox, enableAnswerButton:enableAnswerButton, retryAnswerButton:retryAnswerButton, disableAnswerButton:disableAnswerButton, loadTab:loadTab, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Editor.Tools = function(V, $, undefined) {
  var toolbarEventsLoaded = false;
  var INCREASE_SIZE = 1.05;
  var init = function() {
    cleanToolbar();
    cleanZoneTools();
    var presentationType = V.Editor.getPresentationType();
    if(presentationType !== V.Constant.PRESENTATION) {
      disableToolbar();
      return
    }
    if(!toolbarEventsLoaded) {
      $.each($("#toolbar_wrapper a.tool_action, img.toolbar_icon"), function(index, toolbarButton) {
        $(toolbarButton).on("click", function(event) {
          if(typeof V.Editor.Tools[$(toolbarButton).attr("action")] == "function") {
            if(!$(toolbarButton).parent().hasClass("toolbar_presentation_wrapper_disabled")) {
              V.Editor.Tools[$(toolbarButton).attr("action")](this)
            }
          }
          return false
        })
      });
      $(document).on("keydown", ".tools_input_addUrl", _addUrlOnKeyDown);
      toolbarEventsLoaded = true
    }
    V.Editor.Tools.Menu.init()
  };
  var cleanToolbar = function() {
    loadToolsForSlide(V.Slides.getCurrentSlide());
    _cleanElementToolbar()
  };
  var enableToolbar = function() {
    $("#toolbar_wrapper").show()
  };
  var disableToolbar = function() {
    $("#toolbar_wrapper").hide()
  };
  var loadToolsForSlide = function(slide) {
    _cleanPresentationToolbar();
    var type = $(slide).attr("type");
    switch(type) {
      case V.Constant.STANDARD:
        $("#toolbar_background").parent().addClass("toolbar_presentation_wrapper_disabled");
        break;
      case V.Constant.FLASHCARD:
        break;
      case V.Constant.VTOUR:
        $("#toolbar_background").parent().addClass("toolbar_presentation_wrapper_disabled");
        break;
      default:
        return
    }
  };
  var _cleanPresentationToolbar = function() {
    $(".toolbar_presentation_wrapper_slideTools").removeClass("toolbar_presentation_wrapper_disabled")
  };
  var changePublishButtonStatus = function(status) {
    switch(status) {
      case "publish":
        _enablePublishButton();
        break;
      case "publishing":
        _enablePublishingButton();
        break;
      case "unpublish":
        _enableUnpublishButton();
        break;
      case "unpublishing":
        _enableUnpublishingButton();
        break;
      case "disabled":
        _disablePublishButton();
        break;
      default:
        return
    }
  };
  var _enablePublishButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish").parent().removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish").parent().removeClass("toolbar_presentation_wrapper_disabled");
    var icon = $("#toolbar_publish").find("i.icon-download-alt");
    $(icon).removeClass("icon-rotate-90");
    $(icon).addClass("icon-rotate-270");
    $("#toolbar_publish").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Publish"));
    $("#toolbar_publish").attr("action", "publish");
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().removeClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Publish"));
    $(menuItem).attr("action", "onPublishButtonClicked")
  };
  var _enablePublishingButton = function() {
    $("#waiting_overlay").show();
    $("#toolbar_publish").parent().addClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish").parent().addClass("toolbar_presentation_wrapper_disabled");
    var icon = $("#toolbar_publish").find("i.icon-download-alt");
    $(icon).removeClass("icon-rotate-90");
    $(icon).addClass("icon-rotate-270");
    $("#toolbar_publish").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Publishing"));
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().addClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Publishing"))
  };
  var _enableUnpublishButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish").parent().removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish").parent().removeClass("toolbar_presentation_wrapper_disabled");
    var icon = $("#toolbar_publish").find("i.icon-download-alt");
    $(icon).removeClass("icon-rotate-270");
    $(icon).addClass("icon-rotate-90");
    $("#toolbar_publish").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Unpublish"));
    $("#toolbar_publish").attr("action", "unpublish");
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().removeClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Unpublish"));
    $(menuItem).attr("action", "onUnpublishButtonClicked")
  };
  var _enableUnpublishingButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish").parent().addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_publish").parent().addClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Unpublishing"));
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().addClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Unpublishing"))
  };
  var _disablePublishButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish").parent().removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish").parent().addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_publish").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Publish"));
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().addClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Publish"))
  };
  var dirtyModeTimeout;
  var saveButtonStatus = "enabled";
  var changeSaveButtonStatus = function(status) {
    switch(status) {
      case "enabled":
        _enableSaveButton();
        break;
      case "loading":
        _loadingSaveButton();
        break;
      case "disabled":
        _disableSaveButton();
        break;
      default:
        return
    }
  };
  var _enableSaveButton = function() {
    if(saveButtonStatus === "enabled") {
      return
    }
    saveButtonStatus = "enabled";
    _stopDirtyTimeout();
    $("#toolbar_save").parent().removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_save").parent().removeClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_save").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Save"));
    $(".menu_option.menu_action[action='onSaveButtonClicked']").parent().removeClass("menu_item_disabled");
    $(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(V.I18n.getTrans("i.Save"))
  };
  var _loadingSaveButton = function() {
    if(saveButtonStatus === "loading") {
      return
    }
    saveButtonStatus = "loading";
    $("#toolbar_save").parent().addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_save").parent().addClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_save").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Saving"));
    $(".menu_option.menu_action[action='onSaveButtonClicked']").parent().addClass("menu_item_disabled");
    $(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(V.I18n.getTrans("i.Saving"))
  };
  var _disableSaveButton = function() {
    if(saveButtonStatus === "disabled") {
      return
    }
    saveButtonStatus = "disabled";
    $("#toolbar_save").parent().removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_save").parent().addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_save").parent().find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Saved"));
    _stopDirtyTimeout();
    dirtyModeTimeout = setTimeout(function() {
      changeSaveButtonStatus("enabled")
    }, 5E3);
    $(".menu_option.menu_action[action='onSaveButtonClicked']").parent().addClass("menu_item_disabled");
    $(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(V.I18n.getTrans("i.Saved"))
  };
  var _stopDirtyTimeout = function() {
    if(typeof dirtyModeTimeout != "undefined") {
      clearTimeout(dirtyModeTimeout)
    }
  };
  var loadToolsForZone = function(zone) {
    cleanZoneTools(V.Editor.getLastArea());
    var type = $(zone).clone().attr("type");
    switch(type) {
      case "text":
        _loadToolbarForElement(type);
        break;
      case "image":
        _loadToolbarForElement(type);
        break;
      case "video":
        _loadToolbarForElement(type);
        break;
      case "object":
        var object = $(zone).find(".object_wrapper").children()[0];
        loadToolbarForObject(object);
        break;
      case "snapshot":
        _loadToolbarForElement("snapshot");
        break;
      case "quiz":
        _loadToolbarForElement("quiz");
        break;
      case undefined:
        $(zone).find(".menuselect_hide").show();
        hideZoneToolTip($(zone).find(".zone_tooltip"));
        return;
      default:
        break
    }
    $(zone).find(".delete_content").show()
  };
  var addTooltipsToSlide = function(slide) {
    var zones = $(slide).find("div.vezone");
    for(var i = 0;i < zones.length;i++) {
      addTooltipToZone(zones[i])
    }
  };
  var addTooltipToZone = function(zone, hidden) {
    var style = "";
    var visible = "true";
    if(hidden === true) {
      style = "style='display:none'";
      visible = "false"
    }
    var tooltip = "<span class='zone_tooltip' visible='" + visible + "' " + style + " >" + V.I18n.getTrans("i.ZoneTooltip") + "</span>";
    $(zone).append(tooltip);
    tooltip = $(zone).find(".zone_tooltip");
    if(hidden === true) {
      hideZoneToolTip(tooltip)
    }else {
      showZoneToolTip(tooltip)
    }
  };
  var showZoneToolTip = function(tooltip) {
    var zone = $("div").has(tooltip);
    $(tooltip).show();
    $(tooltip).attr("visible", "true");
    $(zone).attr("tooltip", "true");
    if($(tooltip).css("margin-top") === "0px") {
      _setTooltipMargins(tooltip)
    }
  };
  var _setTooltipMargins = function(tooltip) {
    var zone = $("div").has(tooltip);
    var slide = $("article").has(zone);
    $(slide).addClass("temp_shown");
    $(zone).addClass("temp_shown");
    $(tooltip).addClass("temp_shown");
    var zoneHeight = $(zone).height();
    var spanHeight = $(tooltip).height();
    var marginTop = (zoneHeight - spanHeight) / 2;
    $(slide).removeClass("temp_shown");
    $(zone).removeClass("temp_shown");
    $(tooltip).removeClass("temp_shown");
    $(tooltip).css("margin-top", marginTop + "px")
  };
  var setAllTooltipMargins = function(callback) {
    $("span.zone_tooltip").each(function(index, tooltip) {
      _setTooltipMargins(tooltip)
    });
    if(typeof callback == "function") {
      callback(true)
    }
  };
  var hideZoneToolTip = function(tooltip) {
    var zone = $("div").has(tooltip);
    $(tooltip).hide();
    $(tooltip).attr("visible", "false");
    $(zone).attr("tooltip", "false")
  };
  var cleanZoneTools = function(zone) {
    $(".menuselect_hide").hide();
    $(".delete_content").hide();
    _cleanElementToolbar();
    var tooltip = $(zone).find(".zone_tooltip");
    if(V.Editor.isZoneEmpty(zone)) {
      showZoneToolTip(tooltip)
    }else {
      hideZoneToolTip(tooltip)
    }
  };
  var _loadToolbarForElement = function(type) {
    _cleanElementToolbar();
    if(type == "text" || type == "quiz") {
      _loadTextToolbar();
      return
    }
    var toolbarClass = "toolbar_" + type;
    $("#toolbar_element").find("img").hide();
    $("#toolbar_element").find("img." + toolbarClass).show()
  };
  var _loadTextToolbar = function() {
    $("#toolbar_element").find("img").hide();
    $("#toolbar_text").show()
  };
  var loadToolbarForObject = function(object) {
    var objectInfo = V.Object.getObjectInfo(object);
    switch(objectInfo.type) {
      case "web":
        _loadToolbarForElement(objectInfo.type);
        break;
      default:
        _loadToolbarForElement("object");
        break
    }
  };
  var _cleanElementToolbar = function() {
    $("#toolbar_text").hide();
    $("#toolbar_element").find("img").hide()
  };
  var save = function() {
    V.Editor.Tools.Menu.onSaveButtonClicked()
  };
  var publish = function() {
    V.Editor.Tools.Menu.onPublishButtonClicked()
  };
  var unpublish = function() {
    V.Editor.Tools.Menu.onUnpublishButtonClicked()
  };
  var preview = function() {
    V.Editor.Preview.preview()
  };
  var selectTheme = function() {
    $("#hidden_button_to_launch_theme_fancybox").trigger("click")
  };
  var selectAnimation = function() {
    $("#hidden_button_to_launch_animation_fancybox").trigger("click")
  };
  var changeBackground = function() {
    $("#hidden_button_to_change_slide_background").trigger("click")
  };
  var zoomMore = function() {
    _changeZoom("+")
  };
  var zoomLess = function() {
    _changeZoom("-")
  };
  var resizeMore = function() {
    _resize("+")
  };
  var resizeLess = function() {
    _resize("-")
  };
  var _resize = function(action) {
    var object, objectInfo, resizeFactor;
    var area = V.Editor.getCurrentArea();
    var type = $(area).attr("type");
    if(action == "+") {
      resizeFactor = INCREASE_SIZE
    }else {
      resizeFactor = 1 / INCREASE_SIZE
    }
    switch(type) {
      case "snapshot":
        var snapshot_wrapper = area.children(":first");
        var proportion = $(snapshot_wrapper).height() / $(snapshot_wrapper).width();
        var originalWidth = $(snapshot_wrapper).width();
        snapshot_wrapper.width(originalWidth * resizeFactor);
        snapshot_wrapper.height(originalWidth * resizeFactor * proportion);
        break;
      case "object":
        var parent = area.children(":first");
        object = parent.children(":first");
        objectInfo = V.Object.getObjectInfo(object);
        var newWidth, newHeight;
        var aspectRatio = parent.width() / parent.height();
        var originalHeight = object.height();
        var originalWidth = object.width();
        var parentoriginalHeight = parent.height();
        var parentoriginalWidth = parent.width();
        $(parent).width(parentoriginalWidth * resizeFactor);
        $(parent).height(parentoriginalHeight * resizeFactor);
        var styleZoom = V.Utils.getZoomFromStyle($(object).attr("style"));
        if(styleZoom != 1) {
          newWidth = newWidth / styleZoom;
          newHeight = Math.round(newWidth / aspectRatio);
          newWidth = Math.round(newWidth)
        }else {
          newHeight = parentoriginalHeight * resizeFactor;
          newWidth = parentoriginalWidth * resizeFactor
        }
        $(object).width(newWidth);
        $(object).height(newHeight);
        break;
      case "image":
        object = $(area).find("img");
        var originalHeight = object.height();
        var originalWidth = object.width();
        object.width(originalWidth * resizeFactor);
        object.height(originalHeight * resizeFactor);
        break;
      case "video":
        object = $(area).find("video");
        var originalHeight = object.height();
        var originalWidth = object.width();
        object.width(originalWidth * resizeFactor);
        object.height(originalHeight * resizeFactor);
        break;
      default:
        break
    }
  };
  var _changeZoom = function(action) {
    var object, objectInfo, zoom;
    var area = V.Editor.getCurrentArea();
    var type = $(area).attr("type");
    switch(type) {
      case "object":
        var parent = area.children(":first");
        object = parent.children(":first");
        objectInfo = V.Object.getObjectInfo(object);
        if(objectInfo.type === "web") {
          var iframe = $(area).find("iframe");
          zoom = V.Utils.getZoomFromStyle($(iframe).attr("style"));
          if(action == "+") {
            zoom = zoom + 0.1
          }else {
            zoom = zoom - 0.1
          }
          $(iframe).attr("style", V.Editor.Utils.addZoomToStyle($(iframe).attr("style"), zoom));
          V.Editor.Object.autofixWrapperedObjectAfterZoom(iframe, zoom)
        }
        break;
      default:
        break
    }
  };
  var addLink = function() {
    $.fancybox($("#tools_addUrl").html(), {"autoDimensions":false, "scrolling":"no", "width":800, "height":215, "showCloseButton":true, "padding":0, "onStart":function() {
    }, "onComplete":function() {
      var area = V.Editor.getCurrentArea();
      var hyperlink = $(area).attr("hyperlink");
      if(hyperlink) {
        $(".tools_input_addUrl").val(hyperlink);
        $(".removeUrlButton").show()
      }else {
        $(".removeUrlButton").hide()
      }
    }, "onClosed":function() {
      $(".removeUrlButton").hide()
    }})
  };
  var _addUrlOnKeyDown = function(event) {
    switch(event.keyCode) {
      case 13:
        addUrl();
        break;
      default:
        break
    }
  };
  var addUrl = function() {
    var url;
    $(".tools_input_addUrl").each(function(index, input) {
      if($($(input).parent().parent()).attr("id") !== "tools_addUrl") {
        url = $(input).val()
      }
    });
    if(url) {
      url = V.Editor.Utils.autocompleteUrls(url);
      var area = V.Editor.getCurrentArea();
      switch($(area).attr("type")) {
        case "image":
          $(area).attr("hyperlink", url);
          break;
        default:
          break
      }
    }
    $.fancybox.close()
  };
  var removeUrl = function() {
    var area = V.Editor.getCurrentArea();
    $(area).removeAttr("hyperlink");
    $.fancybox.close()
  };
  return{init:init, loadToolsForSlide:loadToolsForSlide, loadToolsForZone:loadToolsForZone, loadToolbarForObject:loadToolbarForObject, cleanZoneTools:cleanZoneTools, cleanToolbar:cleanToolbar, enableToolbar:enableToolbar, disableToolbar:disableToolbar, addLink:addLink, addUrl:addUrl, removeUrl:removeUrl, resizeMore:resizeMore, resizeLess:resizeLess, zoomMore:zoomMore, zoomLess:zoomLess, save:save, publish:publish, unpublish:unpublish, preview:preview, selectTheme:selectTheme, selectAnimation:selectAnimation, 
  changeBackground:changeBackground, addTooltipsToSlide:addTooltipsToSlide, addTooltipToZone:addTooltipToZone, showZoneToolTip:showZoneToolTip, hideZoneToolTip:hideZoneToolTip, setAllTooltipMargins:setAllTooltipMargins, changePublishButtonStatus:changePublishButtonStatus, changeSaveButtonStatus:changeSaveButtonStatus}
}(VISH, jQuery);
VISH.Addons = function(V, undefined) {
  var init = function(addons) {
    if(typeof addons === "object") {
      for(var i = 0;i < addons.length;i++) {
        var targeted = V.Editing && addons[i].target === V.Constant.Edit || !V.Editing && addons[i].target === V.Constant.Viewer || addons[i].target === V.Constant.AnyMode;
        if(targeted) {
          if(typeof V.Addons[addons[i].id] !== "undefined" && typeof V.Addons[addons[i].id].init === "function") {
            V.Addons[addons[i].id].init(addons[i].config)
          }
        }
      }
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.VideoPlayer = function(V, $, undefined) {
  var init = function() {
    V.VideoPlayer.CustomPlayer.init();
    V.VideoPlayer.HTML5.init();
    V.VideoPlayer.Youtube.init()
  };
  var getTypeVideoWithId = function(videoId) {
    return getTypeVideo(document.getElementById(videoId))
  };
  var getTypeVideo = function(video) {
    if(!video) {
      return V.Constant.UNKNOWN
    }else {
      if(video.tagName === "VIDEO") {
        return V.Constant.Video.HTML5
      }else {
        if(video.tagName === "OBJECT" || video.tagName === "IFRAME") {
          return V.Constant.Video.Youtube
        }
      }
    }
    return V.Constant.UNKNOWN
  };
  var playVideo = function(videoId, currentTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case V.Constant.Video.HTML5:
        V.VideoPlayer.HTML5.playVideo(videoId, currentTime, triggeredByUser);
        break;
      case V.Constant.Video.Youtube:
        V.VideoPlayer.Youtube.playVideo(videoId, currentTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var pauseVideo = function(videoId, currentTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case V.Constant.Video.HTML5:
        V.VideoPlayer.HTML5.pauseVideo(videoId, currentTime, triggeredByUser);
        break;
      case V.Constant.Video.Youtube:
        V.VideoPlayer.Youtube.pauseVideo(videoId, currentTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var seekVideo = function(videoId, seekTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case V.Constant.Video.HTML5:
        V.VideoPlayer.HTML5.seekVideo(videoId, seekTime, triggeredByUser);
        break;
      case V.Constant.Video.Youtube:
        V.VideoPlayer.Youtube.seekVideo(videoId, seekTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var getDuration = function(video) {
    switch(getTypeVideo(video)) {
      case V.Constant.Video.HTML5:
        return video.getDuration();
        break;
      case V.Constant.Video.Youtube:
        return youtubePlayers[video.id].getDuration();
        break;
      default:
        break
    }
  };
  var getCurrentTime = function(video) {
    switch(getTypeVideo(video)) {
      case V.Constant.Video.HTML5:
        return video.getCurrentTime();
        break;
      case V.Constant.Video.Youtube:
        return youtubePlayers[video.id].getCurrentTime();
        break;
      default:
        break
    }
  };
  return{init:init, getTypeVideoWithId:getTypeVideoWithId, getTypeVideo:getTypeVideo, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, getDuration:getDuration, getCurrentTime:getCurrentTime}
}(VISH, jQuery);
VISH.Messenger = function(V, undefined) {
  var init = function() {
    V.EventsNotifier.registerCallback(V.Constant.Event.onGoToSlide, function(params) {
      notifyEventByMessage(V.Constant.Event.onGoToSlide, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPlayVideo, function(params) {
      notifyEventByMessage(V.Constant.Event.onPlayVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPauseVideo, function(params) {
      notifyEventByMessage(V.Constant.Event.onPauseVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSeekVideo, function(params) {
      notifyEventByMessage(V.Constant.Event.onSeekVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onFlashcardPointClicked, function(params) {
      notifyEventByMessage(V.Constant.Event.onFlashcardPointClicked, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onFlashcardSlideClosed, function(params) {
      notifyEventByMessage(V.Constant.Event.onFlashcardSlideClosed, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onVEFocusChange, function(params) {
      notifyEventByMessage(V.Constant.Event.onVEFocusChange, params)
    })
  };
  var notifyEventByMessage = function(event, params) {
    if(params.triggeredByUser === false) {
      return
    }
    var VEMessage = V.Messenger.Helper.createMessage(event, params);
    V.EventsNotifier.notifyEvent(V.Constant.Event.onMessage, VEMessage, true)
  };
  return{init:init, notifyEventByMessage:notifyEventByMessage}
}(VISH);
VISH.Editor.Quiz = function(V, $, undefined) {
  var init = function() {
    V.Editor.Quiz.MC.init();
    V.Editor.Quiz.TF.init()
  };
  var _getQuizModule = function(quiz_type) {
    switch(quiz_type) {
      case VISH.Constant.QZ_TYPE.OPEN:
        break;
      case VISH.Constant.QZ_TYPE.MCHOICE:
        return V.Editor.Quiz.MC;
        break;
      case VISH.Constant.QZ_TYPE.TF:
        return V.Editor.Quiz.TF;
        break;
      default:
        return null;
        break
    }
  };
  var add = function(quizType, area) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    if(_getQuizModule(quizType)) {
      _getQuizModule(quizType).add(current_area)
    }
    $.fancybox.close()
  };
  var save = function(area) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    var quizType = $(area).attr("quiztype");
    if(_getQuizModule(quizType)) {
      return _getQuizModule(quizType).save(current_area)
    }
  };
  var draw = function(area, quiz) {
    if(_getQuizModule(quiz.quiztype)) {
      _getQuizModule(quiz.quiztype).draw(area, quiz)
    }
  };
  return{init:init, add:add, save:save, draw:draw}
}(VISH, jQuery);
VISH.Addons.IframeMessenger = function(V, undefined) {
  var listenerInitialized = false;
  var init = function(config) {
    if(!config || !config.enable) {
      return
    }
    if(window.addEventListener) {
      window.addEventListener("message", _onWebAppMessage, false)
    }else {
      if(el.attachEvent) {
        window.attachEvent("message", _onWebAppMessage)
      }
    }
    V.Constant.Event.onIframeMessengerHello = "onIframeMessengerHello"
  };
  var _initListener = function() {
    V.EventsNotifier.registerCallback(V.Constant.Event.onMessage, _onVishEditorMessage);
    listenerInitialized = true
  };
  var _onVishEditorMessage = function(VEMessage) {
    _sendMessage(VEMessage)
  };
  var _onWebAppMessage = function(webAppMessage) {
    if(webAppMessage) {
      var VEMessage = webAppMessage.data;
      var processSelfMessages = V.Status.isPreventDefaultMode();
      if(V.Messenger.Helper.validateVEMessage(VEMessage, {allowSelfMessages:processSelfMessages})) {
        if(_isVEHelloMessage(VEMessage)) {
          if(!listenerInitialized) {
            _initListener();
            if(V.Status.getIsInIframe()) {
              var helloEcho = JSON.parse(VEMessage);
              if(V.Status.getIframe() != null) {
                helloEcho.origin = V.Status.getIframe().id
              }
              VEMessage = JSON.stringify(helloEcho)
            }
            _sendMessage(VEMessage)
          }
        }else {
          V.Messenger.Helper.processVEMessage(VEMessage)
        }
      }
    }
  };
  var _isVEHelloMessage = function(VEMessage) {
    var message = JSON.parse(VEMessage);
    return message.VEevent === V.Constant.Event.onIframeMessengerHello
  };
  var _validateWebAppMessage = function(webAppMessage) {
    if(!webAppMessage) {
      return false
    }
    return V.Messenger.Helper.validateVEMessage(webAppMessage.data)
  };
  var _sendMessage = function(VEMessage) {
    window.parent.postMessage(VEMessage, "*")
  };
  return{init:init}
}(VISH, jQuery);
VISH.Animations = function(V, $, undefined) {
  var loadAnimation = function(animation, callback) {
    if(!animation) {
      animation = V.Constant.Animations.Default
    }
    _unloadAllAnimations();
    V.Utils.Loader.loadCSS("animations/" + animation + ".css", callback)
  };
  var _unloadAllAnimations = function() {
    var animation_pattern = "(^" + V.StylesheetsPath + "animations/)";
    $("head").find("link[type='text/css']").each(function(index, link) {
      var href = $(link).attr("href");
      if(href) {
        if(href.match(animation_pattern) !== null) {
          $(link).remove()
        }
      }
    })
  };
  return{loadAnimation:loadAnimation}
}(VISH, jQuery);
VISH.AppletPlayer = function() {
  var loadApplet = function(element) {
    $.each(element.children(".appletelement"), function(index, value) {
      var toAppend = "<applet code='" + $(value).attr("code") + "' width='" + $(value).attr("width") + "' height='" + $(value).attr("height") + "' archive='" + $(value).attr("archive") + "'>" + $(value).attr("params") + "</applet>";
      $(value).html(toAppend)
    })
  };
  var unloadApplet = function(element) {
    $(".appletelement applet").remove()
  };
  return{loadApplet:loadApplet, unloadApplet:unloadApplet}
}(VISH, jQuery);
VISH.Configuration = function(V, $, undefined) {
  var configuration;
  var init = function(myConfiguration) {
    configuration = myConfiguration;
    _initPaths()
  };
  var _initPaths = function() {
    V.ImagesPath = configuration["ImagesPath"];
    V.StylesheetsPath = configuration["StylesheetsPath"];
    V.UploadImagePath = configuration["uploadImagePath"];
    V.UploadObjectPath = configuration["uploadObjectPath"];
    V.UploadPresentationPath = configuration["uploadPresentationPath"];
    V.UploadPDF2PPath = configuration["uploadPDF2PPath"];
    V.SearchLREPath = configuration["SearchLREPath"]
  };
  var applyConfiguration = function() {
    if(configuration["presentationSettings"]) {
      if(!configuration["presentationTags"]) {
        $(".tagBoxUpload").css("display", "none");
        $("#tagBoxIntro").css("display", "none")
      }
      if(!configuration["presentationThumbnails"]) {
        $("#thumbnails_in_excursion_details").css("display", "none")
      }
    }
    if(!configuration["VishLives"]) {
      $(".addLive").css("display", "none")
    }
    if(!configuration["VishRepo"]) {
      $("#tab_pic_repo").css("display", "none");
      $("#tab_object_repo").css("display", "none");
      $("#tab_video_repo").css("display", "none")
    }
    if(!configuration["Upload"]) {
      $("#tab_pic_upload").css("display", "none");
      $("#tab_object_upload").css("display", "none")
    }
    if(!configuration["Youtube"]) {
      $("#tab_video_youtube").css("display", "none")
    }
    if(!configuration["Vimeo"]) {
      $("#tab_video_vimeo").css("display", "none")
    }
    if(!configuration["LRE"]) {
      $("#tab_pic_lre").css("display", "none");
      $("#tab_object_lre").css("display", "none")
    }
    if(!configuration["Flickr"]) {
      $("#tab_pic_flikr").css("display", "none")
    }
  };
  var getConfiguration = function() {
    return configuration
  };
  return{init:init, applyConfiguration:applyConfiguration, getConfiguration:getConfiguration}
}(VISH, jQuery);
VISH.Debugging = function(V, $, undefined) {
  var developping = false;
  var settings;
  var presentationOptions;
  var init = function(options) {
    if(options) {
      if(typeof options["developping"] == "boolean") {
        developping = options["developping"];
        if(developping) {
          presentationOptions = options;
          if(options["developmentSettings"]) {
            settings = options["developmentSettings"]
          }
        }
      }else {
        developping = false;
        settings = null
      }
    }else {
      developping = false;
      settings = null
    }
  };
  var log = function(text) {
    if(window.console && window.console.log && developping) {
      console.log(text)
    }
  };
  var shuffleJson = function(json) {
    return _shuffle(json)
  };
  var _shuffle = function(o) {
    for(var j, x, i = o.length;i;j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x) {
    }
    return o
  };
  var enableDevelopingMode = function() {
    developping = true
  };
  var disableDevelopingMode = function() {
    developping = false
  };
  var isDevelopping = function() {
    return developping
  };
  var getActionSave = function() {
    if(settings) {
      return settings.actionSave
    }else {
      return"preview"
    }
  };
  var getActionInit = function() {
    if(settings) {
      return settings.actionInit
    }else {
      return"nothing"
    }
  };
  var getPresentationSamples = function() {
    if(settings && settings.samples) {
      return settings.samples
    }else {
      log("VISH.Debugging Error: Please specify development settings");
      return null
    }
  };
  return{init:init, log:log, shuffleJson:shuffleJson, enableDevelopingMode:enableDevelopingMode, disableDevelopingMode:disableDevelopingMode, isDevelopping:isDevelopping, getActionSave:getActionSave, getActionInit:getActionInit, getPresentationSamples:getPresentationSamples}
}(VISH, jQuery);
VISH.Editor.API = function(V, $, undefined) {
  var init = function() {
  };
  var requestImages = function(text, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      var result = jQuery.extend({}, V.Samples.API.imageList);
      switch(text) {
        case "dummy":
          result["pictures"] = V.Samples.API.imageListDummy["pictures"];
          break;
        case "little":
          result["pictures"] = V.Debugging.shuffleJson(V.Samples.API.imageListLittle["pictures"]);
          break;
        case "server error":
          result = undefined;
          break;
        default:
          result["pictures"] = V.Debugging.shuffleJson(V.Samples.API.imageList["pictures"])
      }
      setTimeout(function() {
        if(typeof result == "undefined" && typeof failCallback == "function") {
          failCallback()
        }else {
          if(typeof successCallback == "function") {
            successCallback(result)
          }
        }
      }, 2E3);
      return
    }
    _requestByType("picture", text, successCallback, failCallback)
  };
  var requestRecomendedImages = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Samples.API.imageList;
        result["pictures"] = V.Debugging.shuffleJson(V.Samples.API.imageList["pictures"]);
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("picture", "", successCallback, failCallback)
  };
  var requestVideos = function(text, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      var result = jQuery.extend({}, V.Samples.API.videoList);
      switch(text) {
        case "dummy":
          result["videos"] = V.Samples.API.videoListDummy["videos"];
          break;
        case "little":
          result["videos"] = V.Debugging.shuffleJson(V.Samples.API.videoListLittle["videos"]);
          break;
        case "server error":
          result = undefined;
          break;
        default:
          result["videos"] = V.Debugging.shuffleJson(V.Samples.API.videoList["videos"])
      }
      setTimeout(function() {
        if(typeof result == "undefined" && typeof failCallback == "function") {
          failCallback()
        }else {
          if(typeof successCallback == "function") {
            successCallback(result)
          }
        }
      }, 2E3);
      return
    }
    _requestByType("video", text, successCallback, failCallback)
  };
  var requestRecomendedVideos = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Samples.API.videoList;
        result["videos"] = V.Debugging.shuffleJson(V.Samples.API.videoList["videos"]);
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("video", "", successCallback, failCallback)
  };
  var requestObjects = function(text, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      var result = jQuery.extend({}, V.Samples.API.objectList);
      switch(text) {
        case "dummy":
          result = V.Samples.API.objectListDummy;
          break;
        case "little":
          result = V.Debugging.shuffleJson(V.Samples.API.objectListLittle);
          break;
        case "server error":
          result = undefined;
          break;
        default:
          result = V.Debugging.shuffleJson(V.Samples.API.objectList)
      }
      setTimeout(function() {
        if(typeof result == "undefined" && typeof failCallback == "function") {
          failCallback()
        }else {
          if(typeof successCallback == "function") {
            successCallback(result)
          }
        }
      }, 2E3);
      return
    }
    _requestByType("object", text, successCallback, failCallback)
  };
  var requestRecomendedObjects = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Debugging.shuffleJson(V.Samples.API.objectList);
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("object", "", successCallback, failCallback)
  };
  var requestLives = function(text, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      var result = jQuery.extend({}, V.Samples.API.liveList);
      switch(text) {
        case "dummy":
          result = V.Samples.API.liveListDummy;
          break;
        case "little":
          result = V.Debugging.shuffleJson(V.Samples.API.liveListLittle);
          break;
        case "server error":
          result = undefined;
          break;
        default:
          result = V.Debugging.shuffleJson(V.Samples.API.liveList)
      }
      setTimeout(function() {
        if(typeof result == "undefined" && typeof failCallback == "function") {
          failCallback()
        }else {
          if(typeof successCallback == "function") {
            successCallback(result)
          }
        }
      }, 2E3);
      return
    }
    _requestByType("live", text, successCallback, failCallback)
  };
  var requestRecomendedLives = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Debugging.shuffleJson(V.Samples.API.liveList);
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("live", "", successCallback, failCallback)
  };
  var requestExcursions = function(text, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      var result = V.Samples.API.excursionList;
      switch(text) {
        case "dummy":
          result = V.Samples.API.excursionListDummy;
          break;
        case "little":
          result = V.Debugging.shuffleJson(V.Samples.API.excursionListLittle);
          break;
        case "server error":
          result = undefined;
          break;
        default:
          result = V.Debugging.shuffleJson(V.Samples.API.excursionList)
      }
      setTimeout(function() {
        if(typeof result == "undefined" && typeof failCallback == "function") {
          failCallback()
        }else {
          if(typeof successCallback == "function") {
            successCallback(result)
          }
        }
      }, 2E3);
      return
    }
    _requestByType("excursion", text, successCallback, failCallback)
  };
  var requestRecomendedExcursions = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Samples.API.excursionList;
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("excursion", "", successCallback, failCallback)
  };
  var requestSmartcards = function(text, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Samples.API.smartcardList;
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("smartcard", text, successCallback, failCallback)
  };
  var requestRecomendedSmartcards = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        var result = V.Samples.API.smartcardList;
        setTimeout(function() {
          successCallback(result)
        }, 2E3)
      }
      return
    }
    _requestByType("smartcard", "", successCallback, failCallback)
  };
  var _requestByType = function(type, query, successCallback, failCallback) {
    if(type === "live" || type === "object") {
      _requestResourceType(type, query, successCallback, failCallback);
      return
    }else {
      if(type === "excursion" || type === "smartcard") {
        _requestExcursionType(type, query, successCallback, failCallback);
        return
      }
    }
    $.ajax({type:"GET", url:"/search.json?type=" + type + "&q=" + query, dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var resp = JSON.parse(response);
        successCallback(resp)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var _requestResourceType = function(type, query, successCallback, failCallback) {
    $.ajax({type:"GET", url:"/resources/search.json?" + type + "=1&q=" + query, dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var resp = JSON.parse(response);
        successCallback(resp)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var _requestExcursionType = function(type, query, successCallback, failCallback) {
    if(type === "excursion") {
      type = ""
    }
    $.ajax({type:"GET", url:"/excursions/search.json?type=" + type + "&q=" + query, dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var resp = JSON.parse(response);
        successCallback(resp)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var requestTags = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        setTimeout(function() {
          successCallback(V.Samples.API.tagsList["tags"])
        }, 2E3)
      }
      return
    }
    $.ajax({type:"GET", url:"/tags.json?mode=popular&limit=100", dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var tagsJSON = JSON.parse(response);
        var tags = [];
        if(tagsJSON.length > 0) {
          $.each(tagsJSON, function(index, tagJSON) {
            tags.push(tagJSON.name)
          })
        }
        successCallback(tags)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var requestThumbnails = function(successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        setTimeout(function() {
          successCallback(V.Samples.API.thumbnailsList)
        }, 2E3)
      }
      return
    }
    $.ajax({async:false, type:"GET", url:"/excursion_thumbnails.json", dataType:"json", success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback(xhr, ajaxOptions, thrownError)
      }
    }})
  };
  var uploadTmpJSON = function(json, successCallback, failCallback) {
    if(V.Utils.getOptions().configuration.mode == V.Constant.NOSERVER) {
      if(typeof successCallback == "function") {
        setTimeout(function() {
          failCallback()
        }, 2E3)
      }
      return
    }
    $.ajax({async:false, type:"POST", url:"/excursions/tmpJson.json", dataType:"json", data:{"authenticity_token":V.User.getToken(), "json":JSON.stringify(json)}, success:function(data) {
      if(data && data.fileId) {
        V.Editor.API.downloadTmpJSON(data.fileId);
        if(typeof successCallback == "function") {
          successCallback()
        }
      }else {
        if(typeof failCallback == "function") {
          failCallback()
        }
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback(xhr, ajaxOptions, thrownError)
      }
    }})
  };
  var downloadTmpJSON = function(fileId) {
    var filename = fileId;
    var iframe = $("#hiddenIframeForAjaxDownloads");
    $(iframe).attr("src", "/excursions/tmpJson.json?fileId=" + fileId + "&filename=" + filename)
  };
  return{init:init, requestExcursions:requestExcursions, requestRecomendedExcursions:requestRecomendedExcursions, requestSmartcards:requestSmartcards, requestRecomendedSmartcards:requestRecomendedSmartcards, requestVideos:requestVideos, requestRecomendedVideos:requestRecomendedVideos, requestImages:requestImages, requestRecomendedImages:requestRecomendedImages, requestObjects:requestObjects, requestRecomendedObjects:requestRecomendedObjects, requestLives:requestLives, requestRecomendedLives:requestRecomendedLives, 
  requestTags:requestTags, requestThumbnails:requestThumbnails, uploadTmpJSON:uploadTmpJSON, downloadTmpJSON:downloadTmpJSON}
}(VISH, jQuery);
VISH.Editor.Animations = function(V, $, undefined) {
  var initialized = false;
  var currentAnimation;
  var animation = {};
  var init = function() {
    if(!initialized) {
      animation["animation1"] = {number:"1", filename:"animation1"};
      animation["animation2"] = {number:"2", filename:"animation2"};
      animation["animation3"] = {number:"3", filename:"animation3"};
      animation["animation4"] = {number:"4", filename:"animation4"};
      animation["animation5"] = {number:"5", filename:"animation5"};
      animation["animation6"] = {number:"6", filename:"animation6"};
      animation["animation7"] = {number:"7", filename:"animation7"};
      animation["animation8"] = {number:"8", filename:"animation8"};
      animation["animation9"] = {number:"9", filename:"animation9"};
      animation["animation10"] = {number:"10", filename:"animation10"};
      animation["animation11"] = {number:"11", filename:"animation11"};
      animation["animation12"] = {number:"12", filename:"animation12"}
    }
    setCurrentAnimation(VISH.Constant.Animations.Default)
  };
  var onAnimationSelected = function(event) {
    event.preventDefault();
    var animationNumber = $(event.currentTarget).attr("animation");
    selectAnimation(animationNumber);
    V.Editor.Settings.selectAnimation(animation[animationNumber].number)
  };
  var selectAnimation = function(animation) {
    currentAnimation = animation
  };
  var getCurrentAnimation = function() {
    if(currentAnimation) {
      return animation[currentAnimation]
    }else {
      return animation[VISH.Constant.Animations.Default]
    }
  };
  var setCurrentAnimation = function(the_animation) {
    if(the_animation != undefined) {
      currentAnimation = the_animation;
      V.Editor.Settings.selectAnimation(animation[the_animation].number)
    }
  };
  return{init:init, onAnimationSelected:onAnimationSelected, selectAnimation:selectAnimation, getCurrentAnimation:getCurrentAnimation, setCurrentAnimation:setCurrentAnimation}
}(VISH, jQuery);
VISH.Editor.Carrousel = function(V, $, undefined) {
  var createCarrousel = function(containerId, options) {
    if(!containerId) {
      return
    }
    var rows = 1;
    var rowItems = 5;
    var scrollItems = null;
    var styleClass = "";
    var titleClass = "";
    var callback = null;
    var width = 650;
    var startAtLastElement = false;
    var pagination = true;
    var sortable = false;
    var afterCreateCarruselFunction = null;
    if(options) {
      if(options["rows"]) {
        rows = options["rows"]
      }
      if(options["rowItems"]) {
        rowItems = options["rowItems"]
      }
      if(options["scrollItems"]) {
        scrollItems = options["scrollItems"]
      }
      if(options["styleClass"]) {
        styleClass = options["styleClass"]
      }
      if(options["titleClass"]) {
        titleClass = options["titleClass"]
      }
      if(options["callback"]) {
        callback = options["callback"]
      }
      if(options["width"]) {
        width = options["width"]
      }
      if(options["startAtLastElement"]) {
        startAtLastElement = options["startAtLastElement"]
      }
      if(typeof options["pagination"] == "boolean") {
        pagination = options["pagination"]
      }
      if(typeof options["sortable"] == "boolean") {
        sortable = options["sortable"]
      }
      if(options["afterCreateCarruselFunction"]) {
        afterCreateCarruselFunction = options["afterCreateCarruselFunction"]
      }
    }
    var multipleRow = rows > 1;
    var carrouselClass = "";
    if(styleClass) {
      carrouselClass = "_" + styleClass
    }
    if(!scrollItems) {
      scrollItems = rowItems
    }
    if(multipleRow) {
      var rowClass = "multiple_row" + carrouselClass
    }else {
      var rowClass = "single_row" + carrouselClass
    }
    var wrapperDiv = $("#" + containerId);
    wrapperDiv.attr("class", "image_carousel image_carousel_" + rowClass);
    wrapperDiv.removeAttr("id");
    var mainDiv = document.createElement("div");
    $(mainDiv).html($(wrapperDiv).html());
    $(wrapperDiv).html("");
    mainDiv.setAttribute("id", containerId);
    var clearFix = document.createElement("div");
    clearFix.setAttribute("class", "clearfix");
    var button_prev = document.createElement("a");
    var button_next = document.createElement("a");
    button_prev.setAttribute("class", "prev");
    button_next.setAttribute("class", "next");
    $(button_prev).addClass("prev_" + rowClass);
    $(button_next).addClass("next_" + rowClass);
    button_prev.setAttribute("href", "#");
    button_next.setAttribute("href", "#");
    button_prev.setAttribute("id", "carrousel_prev" + containerId);
    button_next.setAttribute("id", "carrousel_next" + containerId);
    $(button_prev).html("<span>prev</span>");
    $(button_next).html("<span>next</span>");
    $(wrapperDiv).append(clearFix);
    $(wrapperDiv).append(button_prev);
    $(wrapperDiv).append(button_next);
    if(pagination) {
      var paginationDiv = document.createElement("div");
      paginationDiv.setAttribute("class", "pagination pagination_" + rowClass);
      paginationDiv.setAttribute("id", "carrousel_pag" + containerId);
      $(wrapperDiv).append(paginationDiv)
    }
    $(mainDiv).children().addClass("carrousel_element_" + rowClass);
    $(mainDiv).children().each(function(index, value) {
      $(value).children().addClass("carrousel_element_" + rowClass)
    });
    if(callback && typeof callback == "function") {
      $(mainDiv).children().click(function(event) {
        callback(event)
      })
    }
    if(multipleRow) {
      _applyMultipleRows(containerId, wrapperDiv, mainDiv, rows, rowItems, scrollItems, rowClass, width, afterCreateCarruselFunction)
    }else {
      $(wrapperDiv).prepend(mainDiv);
      if(startAtLastElement) {
        var start = $(mainDiv).children().length - rowItems + 1
      }else {
        var start = 0
      }
      _setMainCarrousel(containerId, containerId, rows, [], rowItems, scrollItems, width, start, function() {
        if(pagination) {
          _forceShowPagination(containerId)
        }
        if(sortable) {
          $("#" + containerId).sortable()
        }
        if(typeof afterCreateCarruselFunction === "function") {
          afterCreateCarruselFunction()
        }
      })
    }
    return
  };
  var _applyMultipleRows = function(containerId, wrapperDiv, mainDiv, rows, rowItems, scrollItems, rowClass, width, afterCreateCarruselFunction) {
    var synchronizeIds = [];
    var createdRows = 0;
    var i;
    for(i = 0;i < rows;i++) {
      window[mainDiv.id + "_row" + i] = document.createElement("div");
      window[mainDiv.id + "_row" + i].setAttribute("id", mainDiv.id + "_row" + i);
      window[mainDiv.id + "_row" + i].setAttribute("class", "carrousel_wrapper_" + rowClass);
      if(i != 0) {
        synchronizeIds.push(mainDiv.id + "_row" + i)
      }
    }
    $(mainDiv).children().each(function(index, value) {
      $(window[mainDiv.id + "_row" + index % rows]).append(value)
    });
    for(i = rows - 1;i >= 0;i--) {
      $(wrapperDiv).prepend(window[mainDiv.id + "_row" + i]);
      if(i == 0) {
        var newContainerId = mainDiv.id + "_row" + i;
        _setMainCarrousel(newContainerId, containerId, rows, synchronizeIds, rowItems, scrollItems, width, null, function() {
          createdRows++;
          _afterCreateRow(createdRows, rows, afterCreateCarruselFunction)
        })
      }else {
        _setRowCarrousel(mainDiv.id + "_row" + i, rowItems, scrollItems, width, function() {
          createdRows++;
          _afterCreateRow(createdRows, rows, afterCreateCarruselFunction)
        })
      }
    }
  };
  var _afterCreateRow = function(createdRows, rows, afterCreateCarruselFunction) {
    if(createdRows === rows && typeof afterCreateCarruselFunction == "function") {
      afterCreateCarruselFunction()
    }
  };
  var _setRowCarrousel = function(id, rowItems, scrollItems, width, afterCreateCarruselFunction) {
    $("#" + id).carouFredSel({auto:false, circular:false, infinite:false, width:width, scroll:{items:scrollItems, fx:"scroll", duration:1E3, timeoutDuration:2E3}, items:{visible:{min:rowItems, max:rowItems}}, onCreate:afterCreateCarruselFunction})
  };
  var _setMainCarrousel = function(id, widgetsId, rows, synchronizeIds, rowItems, scrollItems, width, start, afterCreateCarruselFunction) {
    if(!start) {
      start = 0
    }
    $("#" + id).carouFredSel({circular:false, infinite:false, auto:false, width:width, scroll:{items:scrollItems, duration:1E3, timeoutDuration:2E3}, items:{visible:{min:rowItems, max:rowItems}, start:start}, prev:{button:"#carrousel_prev" + widgetsId}, next:{button:"#carrousel_next" + widgetsId}, pagination:"#carrousel_pag" + widgetsId, onCreate:afterCreateCarruselFunction});
    if(synchronizeIds) {
      var syncString = "";
      $(synchronizeIds).each(function(index, value) {
        if(index != 0) {
          syncString = syncString + ", "
        }
        syncString = syncString + "#" + value
      });
      $("#" + id).trigger("configuration", ["synchronise", syncString])
    }
    $("#" + id).attr("rows", rows)
  };
  var cleanCarrousel = function(containerId) {
    $("#" + containerId).html("");
    var containderIdForMultiRow = containerId + "_row0";
    if($("#" + containderIdForMultiRow).attr("rows")) {
      var rows = $("#" + containderIdForMultiRow).attr("rows");
      var i;
      for(i = 0;i < rows;i++) {
        _cleanOneRowCarrousel(containerId + "_row" + i)
      }
      $("#" + containderIdForMultiRow).attr("id", containerId)
    }else {
      _cleanOneRowCarrousel(containerId)
    }
  };
  var _cleanOneRowCarrousel = function(containerId) {
    var carrouselWrapper = $("#" + containerId).parent().parent();
    if($(carrouselWrapper).hasClass("image_carousel")) {
      $(carrouselWrapper).removeClass();
      $(carrouselWrapper).html("");
      $(carrouselWrapper).attr("id", containerId)
    }
  };
  var _forceShowPagination = function(containerId) {
    var parent = $("#" + containerId).parent().parent();
    if($(parent).hasClass("image_carousel")) {
      $(parent).find(".pagination").attr("style", "")
    }
  };
  var goToElement = function(carrouselDivId, element) {
    if($(element).is("IMG")) {
      element = $(element).parent()
    }
    $("#" + carrouselDivId).trigger("slideTo", element)
  };
  var advanceCarrousel = function(carrouselDivId, no) {
    $("#" + carrouselDivId).trigger("next", no)
  };
  var backCarrousel = function(carrouselDivId, no) {
    $("#" + carrouselDivId).trigger("prev", no)
  };
  var insertElement = function(carrouselDivId, element, posc) {
    $("#" + carrouselDivId).trigger("insertItem", [element, posc])
  };
  return{createCarrousel:createCarrousel, cleanCarrousel:cleanCarrousel, goToElement:goToElement, advanceCarrousel:advanceCarrousel, backCarrousel:backCarrousel, insertElement:insertElement}
}(VISH, jQuery);
VISH.Editor.Clipboard = function(V, $, undefined) {
  var stack;
  var _lastTimestamp;
  var init = function() {
    stack = [null, null, null]
  };
  var copy = function(element, type) {
    if(element) {
      var params = {};
      switch(type) {
        case V.Constant.Clipboard.Slide:
          var slideType = V.Slides.getSlideType(element);
          switch(slideType) {
            case V.Constant.STANDARD:
              params.textAreas = V.Editor.Slides.copyTextAreasOfSlide(element);
              break;
            case V.Constant.FLASHCARD:
            ;
            case V.Constant.VTOUR:
              break;
            default:
              break
          }
          break;
        default:
          return
      }
      stack[0] = V.Utils.getOuterHTML($(element).clone()[0]);
      stack[1] = type;
      stack[2] = params;
      if(V.Status.getDevice().features.localStorage) {
        localStorage.setItem(V.Constant.Clipboard.LocalStorageStack, JSON.stringify(stack))
      }
    }
  };
  var paste = function() {
    if(_lastTimestamp) {
      var elapsed = (new Date).getTime() - _lastTimestamp;
      if(elapsed < 500) {
        return
      }
    }
    _lastTimestamp = (new Date).getTime();
    if(V.Status.getDevice().features.localStorage) {
      var storedStack = localStorage.getItem(V.Constant.Clipboard.LocalStorageStack);
      if(storedStack !== null) {
        var myStack = JSON.parse(storedStack)
      }
    }
    if(!myStack) {
      myStack = stack
    }
    if(!myStack[0]) {
      return
    }else {
      myStack[0] = $(myStack[0])[0]
    }
    switch(myStack[1]) {
      case V.Constant.Clipboard.Slide:
        var slideToCopy = $(myStack[0]).clone()[0];
        if(V.Editor.Slideset.isSlideset(slideToCopy)) {
          return
        }
        var options = {};
        if(myStack[2]) {
          if(myStack[2].textAreas) {
            options.textAreas = myStack[2].textAreas
          }
          if(myStack[2].JSON) {
            options.JSON = myStack[2].JSON
          }
        }
        V.Editor.Slides.copySlide(slideToCopy, options);
        break;
      default:
        break
    }
  };
  return{init:init, copy:copy, paste:paste}
}(VISH, jQuery);
VISH.Editor.Competitions = function(V, $, undefined) {
  var competitionTag = "ViSHCompetition2013";
  var competitionCategories = ["Maths", "Physics", "Chemistry", "Biology", "EnvironmentalStudies", "Geography", "Engineering", "Humanities", "NaturalScience", "ComputerScience"];
  var misleadingTags = ["ViSHCompetitions2013"];
  var vishCompetitionTagAdded = false;
  var init = function() {
  };
  var addCompetitionTags = function(tagsArray) {
    if(typeof tagsArray == "object") {
      tagsArray = _purgeTags(tagsArray);
      var competitionTags = _getAllTags();
      $(competitionTags).each(function(index, value) {
        if(tagsArray.indexOf(value) == -1) {
          tagsArray.unshift(value)
        }
      })
    }
    return tagsArray
  };
  var _purgeTags = function(tagsArray) {
    var tagsToRemove = [];
    $(tagsArray).each(function(index, value) {
      if(_isSimilarToACompetitionTag(value, true)) {
        tagsToRemove.push(value)
      }
    });
    $(tagsToRemove).each(function(index, value) {
      tagsArray.splice(tagsArray.indexOf(value), 1)
    });
    return tagsArray
  };
  var _getAllTags = function() {
    var allTags = jQuery.extend([], competitionCategories);
    allTags.push(competitionTag);
    return allTags
  };
  var _isSimilarToACompetitionTag = function(tag, includeEquals) {
    if(typeof tag != "string") {
      return false
    }
    var competitionTags = _getAllTags();
    var cL = competitionTags.length;
    for(var i = 0;i < cL;i++) {
      if(_areSimilarTags(tag, competitionTags[i], includeEquals)) {
        return true
      }
    }
    var mL = misleadingTags.length;
    for(var j = 0;j < mL;j++) {
      if(_areSimilarTags(tag, misleadingTags[j], true)) {
        return true
      }
    }
    return false
  };
  var _areSimilarTags = function(tag1, tag2, includeEquals) {
    if(tag1 == tag2) {
      if(includeEquals === true) {
        return true
      }else {
        return false
      }
    }
    var myTag1 = new String(tag1);
    var myTag2 = new String(tag2);
    myTag1 = myTag1.toLowerCase();
    myTag2 = myTag2.toLowerCase();
    if(myTag1 == myTag2) {
      return true
    }
    return false
  };
  var isValidCandidate = function() {
    var tags = V.Editor.Settings.getTags();
    if(!tags || tags.length < 1) {
      return false
    }
    if(tags.indexOf(competitionTag) != -1) {
      var ccL = competitionCategories.length;
      for(var i = 0;i < ccL;i++) {
        if(tags.indexOf(competitionCategories[i]) != -1) {
          return true
        }
      }
    }else {
      return false
    }
    return false
  };
  var generateForm = function() {
    var result = "<hr class='hrcomp'><div class='comp_first_row'>" + V.I18n.getTrans("i.NoCompetitions2") + "</div>";
    result += "<div class='comp_second_row'>" + V.I18n.getTrans("i.NoCompetitions3") + "</div>";
    result += "<div class='check_boxer'>";
    for(var i = 0;i <= competitionCategories.length - 1;i++) {
      result += "<div class='comp_checkbox'><input type='checkbox' name='" + competitionCategories[i] + "' value='" + competitionCategories[i] + "'  />" + competitionCategories[i] + "</div>"
    }
    result += "</div>";
    return result
  };
  var specialTagSelected = function(event) {
    var tagList = $("#tagBoxIntro .tagList");
    if($(event.target).is(":checked")) {
      if(!vishCompetitionTagAdded) {
        $(tagList).tagit("add", "ViSHCompetition2013")
      }
      $(tagList).tagit("add", $(event.target).val());
      $(".notification_row2 a[buttonnumber=1]").removeClass("competi_disabled")
    }else {
      $(tagList).tagit("remove", $(event.target).val());
      if($(".comp_checkbox input:checked").size() == 0) {
        $(".notification_row2 a[buttonnumber=1]").addClass("competi_disabled")
      }
    }
  };
  return{init:init, addCompetitionTags:addCompetitionTags, generateForm:generateForm, isValidCandidate:isValidCandidate, specialTagSelected:specialTagSelected}
}(VISH, jQuery);
VISH.Editor.Dummies = function(V, undefined) {
  var dummies = [];
  var init = function() {
    dummies = ["<article id='article_id_to_change' type='standard' template='t1' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='left' \t size='large' class='t1_left editable vezone selectable'></div><div id='div_id_to_change' areaid='header' size='small' class='t1_header editable vezone selectable'></div><div id='div_id_to_change' areaid='subheader' size='extra-small' class='t1_subheader editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t2' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='left' \t size='large' class='t2_left editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t3' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t3_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='large'  class='t3_left editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t4' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t4_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='large'  class='t4_left editable vezone selectable'></div><div id='div_id_to_change' areaid='right'  size='small'  class='t4_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t5' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t5_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t5_left editable vezone selectable'></div><div id='div_id_to_change' areaid='right'  size='medium' class='t5_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t6' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t6_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t6_left editable vezone selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t6_center editable vezone selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t6_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t7' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t7_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t7_left editable vezone selectable'></div><div id='div_id_to_change' areaid='center' size='large'  class='t7_center editable vezone selectable'></div><div id='div_id_to_change' areaid='subheader' size='small' class='t7_subheader editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t8' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t8_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='small'  class='t8_left editable vezone selectable'></div><div id='div_id_to_change' areaid='center' size='large'  class='t8_center editable vezone selectable'></div><div id='div_id_to_change' areaid='right' size='small'     class='t8_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t9' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img  class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t9_header editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t9_left editable vezone selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t9_center editable vezone selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t9_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t10' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='center'  size='large' class='t10_center editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t11' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='center1' size='medium' class='t11_center1 editable vezone selectable'></div><div id='div_id_to_change' areaid='center2' size='medium'  class='t11_center2 editable vezone selectable'></div><div id='div_id_to_change' areaid='center3'  size='medium'  class='t11_center3 editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t12' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='left1'   size='medium' class='t12_left1 editable vezone selectable'></div><div id='div_id_to_change' areaid='right1' size='medium' class='t12_right1 editable vezone selectable'></div><div id='div_id_to_change' areaid='left2' size='medium' class='t12_left2 editable vezone selectable'></div><div id='div_id_to_change' areaid='right2' size='medium'  class='t12_right2 editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t13' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='header'  size='small' class='t13_header editable vezone selectable'></div><div id='div_id_to_change' areaid='circle' size='medium' class='t13_circle editable vezone selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t13_left editable vezone selectable'></div><div id='div_id_to_change' areaid='right' size='medium'  class='t13_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t14' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='circle1' size='small' class='t14_circle1 editable vezone selectable'></div><div id='div_id_to_change' areaid='right1' size='medium' class='t14_right1 editable vezone selectable'></div><div id='div_id_to_change' areaid='circle2' size='small' class='t14_circle2 editable vezone selectable'></div><div id='div_id_to_change' areaid='right2' size='medium' class='t14_right2 editable vezone selectable'></div><div id='div_id_to_change' areaid='circle3' size='small' class='t14_circle3 editable vezone selectable'></div><div id='div_id_to_change' areaid='right3' size='medium' class='t14_right3 editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t15' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' \tareaid='left' \t size='medium' class='t15_left editable vezone selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t15_center editable vezone selectable'></div><div id='div_id_to_change' areaid='right' size='medium' class='t15_right editable vezone selectable'></div><div id='div_id_to_change' areaid='center2' size='large' class='t15_center2 editable vezone selectable'></div></article>"]
  };
  var getDummy = function(slideType, options) {
    var isSlideset = V.Editor.Slideset.isSlideset(slideType);
    if(isSlideset) {
      return V.Editor.Slideset.getDummy(slideType, options)
    }else {
      if(slideType == V.Constant.STANDARD) {
        if(options && options.subslide) {
          return _getDummyForSubslide(slideType, options)
        }else {
          return _getDummyForStandardSlide(slideType, options)
        }
      }
    }
  };
  var _getDummyForStandardSlide = function(slideType, options) {
    var dummy = dummies[parseInt(options.template, 10) - 1];
    return _replaceIds(dummy, options.slideNumber)
  };
  var _getDummyForSubslide = function(slideType, options) {
    var dummy = dummies[parseInt(options.template, 10) - 1];
    var slidesetId = $(options.slideset).attr("id");
    var subslideId = V.Utils.getId(slidesetId + "_article");
    var slideNumber = $(options.slideset).find("article").length + 1;
    return _replaceIds(dummy, slideNumber, subslideId)
  };
  var getScaffoldForSlide = function(slide, options) {
    var slideType = V.Slides.getSlideType(slide);
    var isSlideset = V.Editor.Slideset.isSlideset(slideType);
    if(isSlideset) {
      var dummy = V.Editor.Slideset.getDummy(slideType, options);
      if(dummy) {
        return _removeEditable(_replaceIds(dummy, options.slideNumber, slide.id))
      }
    }else {
      if(slideType == V.Constant.STANDARD) {
        return _getScaffoldForStandardSlide(slide, options)
      }
    }
  };
  var _getScaffoldForStandardSlide = function(slide, options) {
    var zoneIds = [];
    for(el in slide.elements) {
      zoneIds.push(slide.elements[el].id)
    }
    var dummy = dummies[parseInt(options.template, 10) - 1];
    return _removeEditable(_replaceIds(dummy, options.slideNumber, slide.id, zoneIds))
  };
  var _replaceIds = function(dummy, slideNumber, articleId, zoneIds) {
    var newDummy = dummy;
    var nextZoneId = 0;
    if(!articleId) {
      articleId = V.Utils.getId("article")
    }else {
      V.Utils.registerId(articleId)
    }
    if(newDummy.indexOf("article_id_to_change") != -1) {
      newDummy = newDummy.replace("article_id_to_change", articleId)
    }
    if(newDummy.indexOf("slidenumber_to_change") != -1) {
      newDummy = newDummy.replace("slidenumber_to_change", slideNumber)
    }
    while(newDummy.indexOf("div_id_to_change") != -1) {
      if(zoneIds) {
        var newZoneId = zoneIds[nextZoneId];
        nextZoneId++;
        V.Utils.registerId(newZoneId)
      }else {
        var newZoneId = V.Utils.getId(articleId + "_zone")
      }
      newDummy = newDummy.replace("div_id_to_change", newZoneId)
    }
    return newDummy
  };
  var _removeEditable = function(dummy) {
    return dummy.replace(/editable /g, "")
  };
  return{init:init, getDummy:getDummy, getScaffoldForSlide:getScaffoldForSlide}
}(VISH);
VISH.Editor.Events = function(V, $, undefined) {
  var bindedEventListeners = false;
  var confirmOnExit;
  var ctrlDown = false;
  var init = function() {
    bindEditorEventListeners()
  };
  var bindEditorEventListeners = function() {
    if(!bindedEventListeners && V.Editing) {
      $(document).on("click", "#addSlideButton", V.Editor.Tools.Menu.insertSlide);
      $(document).on("click", "#addSlideButtonOnSubslides", V.Editor.Tools.Menu.insertSubslide);
      $(document).on("click", "#importButton", V.Editor.Tools.Menu.insertPDFex);
      $(document).on("click", "#subslide_selected_img", V.Editor.Slideset.onClickOpenSlideset);
      $(document).on("click", "#presentation_details_preview_thumbnail", V.Editor.Settings.onChangeThumbnailClicked);
      $(document).on("hover", "#presentation_details_preview_thumbnail", function(event) {
        var thumbnail = $("#presentation_details_preview_thumbnail_img");
        if($(thumbnail).hasClass("addThumbnailPlus")) {
          return
        }
        if(event.type === "mouseenter") {
          $("#editthumb").slideDown()
        }else {
          $("#editthumb").slideUp()
        }
      });
      $(document).on("keyup", "#presentation_details_input_title", V.Editor.Settings.onKeyUpOnTitle);
      $(document).on("keyup", "#presentation_details_preview_addtitle_input", V.Editor.Settings.onKeyUpOnPreviewTitle);
      $(document).on("click", "#pedagogical_clasification_button", V.Editor.Settings.onPedagogicalButtonClicked);
      $(document).on("click", "#done_in_pedagogical", V.Editor.Settings.onDonePedagogicalButtonClicked);
      $(document).on("click", "#fill_details_later_button", function(event) {
        event.preventDefault();
        $.fancybox.close()
      });
      $(document).on("change", "#tlt_hours", V.Editor.Settings.onTLTchange);
      $(document).on("change", "#tlt_minutes", V.Editor.Settings.onTLTchange);
      $(document).on("change", "#tlt_seconds", V.Editor.Settings.onTLTchange);
      $(document).on("click", "#save_presentation_details", V.Editor.Settings.onSavePresentationDetailsButtonClicked);
      $(document).on("click", "div.slidethumb", V.Editor.onSlideThumbClicked);
      $(document).on("click", ".editable", V.Editor.onEditableClicked);
      $(document).on("click", ".selectable", V.Editor.onSelectableClicked);
      $(document).on("click", ':not(".selectable")', V.Editor.onNoSelectableClicked);
      $(document).on("click", ".delete_content", V.Editor.onDeleteItemClicked);
      $(document).on("click", ".delete_slide", V.Editor.onDeleteSlideClicked);
      $(document).on("click", "#animation_fancybox div[animation]", V.Editor.Animations.onAnimationSelected);
      $(document).on("click", "#theme_fancybox img[theme]", V.Editor.Themes.onThemeSelected);
      $(document).on("click", ".change_bg_button", V.Editor.Tools.changeBackground);
      $(document).on("click", ".comp_checkbox input", V.Editor.Competitions.specialTagSelected);
      $(document).bind("keydown", handleBodyKeyDown);
      $(document).bind("keyup", handleBodyKeyUp);
      $("article").live("slideenter", V.Editor.onSlideEnterEditor);
      $("article").live("slideleave", V.Editor.onSlideLeaveEditor);
      $(document).on("click", "#waiting_overlay", function(event) {
        event.stopPropagation();
        event.preventDefault()
      });
      $(window).focus(function() {
        V.Status.setWindowFocus(true)
      }).blur(function() {
        V.Status.setWindowFocus(false)
      });
      _addTutorialEvents();
      $("a#addSlideFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":800, "height":600, "padding":0, "onStart":function(data) {
        var slidesAddMode = V.Editor.getContentAddMode();
        if(slidesAddMode === V.Constant.NONE) {
          V.Editor.setContentAddMode(V.Constant.STANDARD)
        }
        if(slidesAddMode === V.Constant.SLIDESET) {
          $("#tab_pdfex").parent().hide();
          $("#tab_presentations_repo").parent().hide();
          $("#tab_smartcards_repo").parent().hide();
          $("#tab_json_file").parent().hide();
          $(".tab_slides_smartcards").hide()
        }
        var clickedZoneId = $(data).attr("zone");
        V.Editor.setCurrentArea($("#" + clickedZoneId));
        V.Editor.Utils.loadTab("tab_slides")
      }, "onClosed":function(data) {
        $(".tab_slides_smartcards").show();
        $("#tab_pdfex").parent().show();
        $("#tab_presentations_repo").parent().show();
        $("#tab_smartcards_repo").parent().show();
        $("#tab_json_file").parent().show();
        V.Editor.setContentAddMode(V.Constant.NONE)
      }});
      $("#hidden_button_to_launch_theme_fancybox").fancybox({"autoDimensions":false, "width":600, "scrolling":"no", "height":400, "padding":0});
      $("#hidden_button_to_launch_animation_fancybox").fancybox({"autoDimensions":false, "width":600, "scrolling":"no", "height":400, "padding":0});
      $("#fancyLoad").fancybox({"type":"inline", "autoDimensions":false, "scrolling":"no", "autoScale":true, "width":"100%", "height":"100%", "padding":0, "margin":0, "overlayOpacity":0, "overlayColor":"#fff", "showCloseButton":false, "onComplete":function(data) {
        $("#fancybox-outer").css("background", "rgba(255,255,255,0.9)");
        $("#fancybox-wrap").css("margin-top", "20px");
        $("#fancybox-wrap").css("margin-left", "20px")
      }, "onClosed":function(data) {
        $("#fancybox-outer").css("background", "white")
      }});
      $("#hidden_button_to_change_slide_background").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
        V.Editor.Image.setAddContentMode(V.Constant.FLASHCARD);
        V.Editor.Utils.loadTab("tab_pic_from_url")
      }, "onClosed":function(data) {
        V.Editor.Image.setAddContentMode(V.Constant.NONE)
      }});
      $("#hidden_button_to_uploadThumbnail").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
        V.Editor.Image.setAddContentMode(V.Constant.THUMBNAIL);
        $("#tab_pic_thumbnails").show();
        V.Editor.Utils.loadTab("tab_pic_thumbnails")
      }, "onClosed":function(data) {
        $("#tab_pic_thumbnails").hide();
        if(V.Editor.Image.getAddContentMode() === V.Constant.THUMBNAIL) {
          setTimeout(function() {
            V.Editor.Settings.displaySettings()
          }, 100)
        }
        V.Editor.Image.setAddContentMode(V.Constant.NONE)
      }});
      window.onbeforeunload = _exitConfirmation;
      confirmOnExit = true;
      $(window.document).on("click", function(ev) {
        if(V.Status.getDevice().browser.name === V.Constant.IE) {
          if(ev.target && $(ev.target).is(":input")) {
            return
          }
        }
        window.focus()
      });
      bindedEventListeners = true
    }
  };
  var _addTutorialEvents = function() {
    $(document).on("click", "#help_right", function() {
      V.Tour.startTourWithId("menubar_help", "top")
    });
    $(document).on("click", ".help_in_sslide", function() {
      V.Tour.startTourWithId("sslide_help", "bottom")
    });
    $(document).on("click", ".help_in_flashcard", function() {
      V.Tour.startTourWithId("fc_help", "top")
    });
    $(document).on("click", ".help_in_vt", function() {
      V.Tour.startTourWithId("vt_help", "top")
    });
    $(document).on("click", "#tab_slides_help", function() {
      V.Tour.startTourWithId("help_template_selection_help", "bottom")
    });
    $(document).on("click", "#tab_pdfex_help", function() {
      V.Tour.startTourWithId("help_pdfex_help", "bottom")
    });
    $(document).on("click", "#tab_json_file_help", function() {
      V.Tour.startTourWithId("help_iJSON_help", "bottom")
    });
    $(document).on("click", "#tab_presentations_lre_help", function() {
      V.Tour.startTourWithId("tab_presentations_lre_help", "bottom")
    });
    $(document).on("click", "#tab_presentations_repo_help", function() {
      V.Tour.startTourWithId("help_excursion_selection_help", "bottom")
    });
    $(document).on("click", "#tab_smartcards_repo_help", function() {
      V.Tour.startTourWithId("help_smartcard_selection_help", "bottom")
    });
    $(document).on("click", "#help_themes_selection", function() {
      V.Tour.startTourWithId("themes_help", "bottom")
    });
    $(document).on("click", "#help_animation_selection", function() {
      V.Tour.startTourWithId("animation_help", "bottom")
    });
    $(document).on("click", "#help_in_settings", function() {
      V.Tour.startTourWithId("help_in_settings_help", "bottom")
    });
    $(document).on("click", "#help_in_competitions", function() {
      V.Tour.startTourWithId("help_in_competitions_help", "bottom")
    });
    $(document).on("click", "#help_pedagogical_selection", function() {
      V.Tour.startTourWithId("help_pedagogical_selection_help", "bottom")
    });
    $(document).on("click", "#tab_pic_from_url_help", function() {
      V.Tour.startTourWithId("images_fancy_tabs_id_help", "top")
    });
    $(document).on("click", "#tab_pic_upload_help", function() {
      V.Tour.startTourWithId("upload_picture_form_help", "top")
    });
    $(document).on("click", "#tab_pic_repo_help", function() {
      V.Tour.startTourWithId("search_picture_help", "bottom")
    });
    $(document).on("click", "#tab_pic_flikr_help", function() {
      V.Tour.startTourWithId("search_flickr_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_pic_lre_help", function() {
      V.Tour.startTourWithId("search_lre_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_object_from_web_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_snapshot_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_from_url_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_upload_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_repo_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_lre_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_from_url_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_repo_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_youtube_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_vimeo_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_quizzes_help", function() {
      V.Tour.startTourWithId("quiz_help", "bottom")
    });
    $(document).on("click", "#tab_live_resource_help", function() {
      V.Tour.startTourWithId("tab_live_resource_id", "bottom")
    })
  };
  var addZoneThumbsEvents = function(container) {
    $(container).find("a.addpicture").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Image.setAddContentMode(V.Constant.NONE);
      V.Editor.Utils.loadTab("tab_pic_from_url")
    }});
    $(container).find("a.addobject").fancybox({"autoDimensions":false, "width":800, "height":600, "scrolling":"no", "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab("tab_object_from_web")
    }});
    $(container).find("a.addvideo").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab("tab_video_youtube")
    }});
    $(container).find("a.addQuiz").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab("tab_quizzes")
    }});
    $(container).find("a.addLive").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab("tab_live_resource")
    }})
  };
  var handleBodyKeyDown = function(event) {
    switch(event.keyCode) {
      case 39:
      ;
      case 40:
        if(V.Editor.Slides.isSlideFocused()) {
          if(!ctrlDown) {
            V.Slides.forwardOneSlide()
          }else {
            V.Slides.moveSlides(10)
          }
          event.preventDefault()
        }
        break;
      case 37:
      ;
      case 38:
        if(V.Editor.Slides.isSlideFocused()) {
          if(!ctrlDown) {
            V.Slides.backwardOneSlide()
          }else {
            V.Slides.moveSlides(-10)
          }
          event.preventDefault()
        }
        break;
      case 17:
        ctrlDown = true;
        break;
      case 67:
        if(V.Editor.Slides.isSlideFocused()) {
          if(ctrlDown) {
            if(V.Slides.getCurrentSlideNumber()) {
              V.Editor.Clipboard.copy(V.Slides.getCurrentSlide(), V.Constant.Clipboard.Slide)
            }
          }
        }
        break;
      case 86:
        if(V.Editor.Slides.isSlideFocused()) {
          if(ctrlDown) {
            V.Editor.Clipboard.paste()
          }
        }
        break;
      case 46:
        if(V.Editor.Slides.isSlideFocused()) {
          V.Editor.Slides.removeSlideKeyboard()
        }
        break
    }
  };
  var handleBodyKeyUp = function(event) {
    switch(event.keyCode) {
      case 17:
        ctrlDown = false;
        break
    }
  };
  var _exitConfirmation = function() {
    if(confirmOnExit) {
      if(V.Editor.hasPresentationChanged()) {
        if(V.Configuration.getConfiguration().mode === V.Constant.VISH || true) {
          var confirmationMsg = V.I18n.getTrans("i.exitConfirmation");
          return confirmationMsg
        }
      }
    }else {
      return
    }
  };
  var allowExitWithoutConfirmation = function() {
    confirmOnExit = false
  };
  var unbindEditorEventListeners = function() {
    if(bindedEventListeners) {
      $(document).unbind("keydown", handleBodyKeyDown);
      $(document).unbind("keyup", handleBodyKeyUp);
      $(window.document).off("click", function() {
        window.focus()
      });
      bindedEventListeners = false
    }
  };
  return{init:init, bindEditorEventListeners:bindEditorEventListeners, unbindEditorEventListeners:unbindEditorEventListeners, addZoneThumbsEvents:addZoneThumbsEvents, allowExitWithoutConfirmation:allowExitWithoutConfirmation}
}(VISH, jQuery);
VISH.Editor.Filter = function(V, $, undefined) {
  var init = function() {
    var device = V.Status.getDevice();
    var browser = device.browser;
    switch(browser.name) {
      case V.Constant.IE:
        $("#tab_object_snapshot").hide();
        break;
      case V.Constant.UNKNOWN:
        $("#tab_object_snapshot").hide();
        break
    }
    if(!device.features.reader) {
      $(".liInsertJson > a").css("display", "none")
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.Image.Flikr = function(V, $, undefined) {
  var containerDivId = "tab_pic_flikr_content";
  var carrouselDivId = "tab_pic_flikr_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var init = function() {
    myInput = $("#tab_pic_flikr_content").find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    _searchInFlickr(text)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _searchInFlickr = function(text) {
    var url_flikr = "http://api.flickr.com/services/feeds/photos_public.gne?tags=" + text + "&tagmode=any&format=json&jsoncallback=?";
    $.getJSON(url_flikr, function(data) {
      _onDataReceived(data)
    }).error(function() {
      _onAPIError()
    })
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.items || data.items.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.items, function(index, item) {
      var myImg = $("<img src='" + item.media.m.replace(/_m/i, "") + "' title='" + item.title + "'/>");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorFlickrConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options["rows"] = 2;
        options["callback"] = _onClickCarrouselElement;
        options["rowItems"] = 4;
        options["scrollItems"] = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Image.LRE = function(V, $, undefined) {
  var containerDivId = "tab_pic_lre_content";
  var carrouselDivId = "tab_pic_lre_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.LRE.requestImages(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.pictures || data.pictures.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.pictures, function(index, image) {
      var myTitle = image.title;
      var myImg = $("<img src='" + image.src + "' title='" + myTitle + "' >");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    var loadedImages = $("#" + carrouselDivId + " div:not(#loading_fancy)");
    var emptyResults = loadedImages && $(loadedImages).length === 0;
    if(emptyResults) {
      _drawData(true)
    }else {
      _drawData()
    }
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorLREConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 2;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 4;
        options.scrollItems = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Image.Repository = function(V, $, undefined) {
  var containerDivId = "tab_pic_repo_content";
  var carrouselDivId = "tab_pic_repo_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestImages(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.pictures || data.pictures.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.pictures, function(index, image) {
      var myImg = $("<img src='" + image.src + "' title='" + image.title + "' >");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 2;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 4;
        options.scrollItems = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Image.Thumbnails = function(V, $, undefined) {
  var containerDivId = "tab_pic_thumbnails_content";
  var carrouselDivId = "tab_pic_thumbnails_carrousel";
  var thumbnailsRequested = false;
  var dataDrawed = false;
  var init = function() {
  };
  var beforeLoadTab = function() {
  };
  var onLoadTab = function() {
    if(!thumbnailsRequested) {
      thumbnailsRequested = true;
      _requestThumbnails()
    }
  };
  var _requestThumbnails = function() {
    _cleanCarrouselAndLoading();
    V.Editor.API.requestThumbnails(_onDataReceived, _onAPIError)
  };
  var _cleanCarrouselAndLoading = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId))
  };
  var _cleanCarrousel = function() {
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide()
  };
  var _onDataReceived = function(data) {
    _loadData(data)
  };
  var _loadData = function(data) {
    if(!data.pictures || data.pictures.length == 0) {
      _stopLoading();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.pictures, function(index, image) {
      var myImg = $("<img src='" + image.src + "' title='" + image.title + "' >");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    options.order = true;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _stopLoading();
    _drawData()
  };
  var _stopLoading = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId))
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 3;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "thumbnails";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
    dataDrawed = true
  };
  var _onAPIError = function() {
    _stopLoading();
    _drawData(false)
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isCarrouselVisible = function() {
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.LRE = function(V, $, undefined) {
  var VISH_LRE_URL = "";
  var LRE_THUMBNAILS_URL = "http://lrethumbnails.eun.org/";
  var DEFAULT_LIMIT = 40;
  var DEFAULT_MAXAGE = 20;
  var DEFAULT_MINAGE = 4;
  var DEFAULT_LANGUAGE = "en";
  var PROVIDERS_TO_REMOVE = ["KHAN", "OPENLEARN"];
  var init = function(lang) {
    VISH_LRE_URL = V.SearchLREPath;
    if(lang != "en") {
      DEFAULT_LANGUAGE = "x-mt-" + lang
    }else {
      DEFAULT_LANGUAGE = lang
    }
  };
  var requestImages = function(text, successCallback, failCallback) {
    var query = _composeLREQuery(text.split(" "), ["image"]);
    _requestLRE(query, DEFAULT_LIMIT, "image", successCallback, failCallback)
  };
  var requestObjects = function(text, successCallback, failCallback) {
    var query = _composeLREQuery(text.split(" "), ["audio", "video", "data", "text"]);
    _requestLRE(query, DEFAULT_LIMIT, "object", successCallback, failCallback)
  };
  var _requestLRE = function(query, limit, response_type, successCallback, failCallback) {
    $.ajax({type:"GET", url:VISH_LRE_URL + "?q=" + query + "&limit=" + limit, dataType:"json", success:function(response) {
      if(typeof successCallback == "function") {
        var formatedResponse = formatLREResponse(response, response_type);
        successCallback(formatedResponse)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var _composeLREQuery = function(terms, lrt) {
    var query = "";
    if(terms.length == 0) {
      failCallback("Search terms can\u00b4t be blank")
    }
    for(var i = 0;i < terms.length;i++) {
      query += "((content[" + terms[i] + "]))"
    }
    if(lrt && lrt.length > 0) {
      query += "(";
      for(var j = 0;j < lrt.length;j++) {
        query += "(lrt[" + lrt[j] + "])"
      }
      query += ")"
    }
    return query
  };
  var formatLREResponse = function(lre_response, type) {
    var the_array = new Array;
    var the_return_list = {};
    if(lre_response && lre_response["results"]) {
      var results_array = lre_response["results"];
      for(var i = 0;i < results_array.length;i++) {
        var the_elem = _formatLREElem(results_array[i], type);
        if(the_elem) {
          the_array.push(the_elem)
        }
      }
      switch(type) {
        case "image":
          the_return_list.pictures = the_array;
          break;
        case "object":
          the_return_list = the_array;
          break
      }
    }
    return the_return_list
  };
  var _formatLREElem = function(the_element, type) {
    if(type === "object" || type === "image" && _checkValidImgElem(the_element)) {
      var tmp_elem = {};
      tmp_elem.id = the_element.meta.id;
      if($.inArray(the_element.meta.provider, PROVIDERS_TO_REMOVE) >= 0) {
        return null
      }
      tmp_elem.author = the_element.meta.provider;
      var title_and_desc = _getTitleAndDescInMyLang(the_element.meta.langBlocks);
      tmp_elem.title = title_and_desc.title;
      tmp_elem.description = title_and_desc.description;
      switch(type) {
        case "image":
          tmp_elem.src = _getValidSRC(the_element, type);
          if(!tmp_elem.src) {
            return null
          }
          break;
        case "object":
          tmp_elem.object = _getValidSRC(the_element, type);
          if(!tmp_elem.object) {
            return null
          }
          break
      }
      tmp_elem.thumbnail = LRE_THUMBNAILS_URL + tmp_elem.id.toString().slice(-3) + "/" + tmp_elem.id.toString() + ".png";
      return tmp_elem
    }
  };
  var _isValidImageUrl = function(url, callback) {
    var img = new Image;
    img.onerror = function() {
      V.Debugger("This is not an image: " + url);
      callback(url, false)
    };
    img.onload = function() {
      callback(url, true)
    };
    img.src = url
  };
  var _getValidSRC = function(my_element, type) {
    if(!my_element) {
      return""
    }
    if(my_element.meta && my_element.meta.expressions) {
      for(var i = 0;i < my_element.meta.expressions.length;i++) {
        var exp = my_element.meta.expressions[i];
        for(var j = 0;j < exp.manifestations.length;j++) {
          if(type === "image" && exp.manifestations[j].player == "webBrowser") {
            return exp.manifestations[j].urls[0]
          }else {
            if(type === "object" && (exp.manifestations[j].player == "webBrowser" || exp.manifestations[j].player == "landingPage" || exp.manifestations[j].player == "printable")) {
              return exp.manifestations[j].urls[0]
            }
          }
        }
      }
    }
    return""
  };
  var _checkValidImgElem = function(img_element) {
    if(!img_element) {
      return false
    }
    if(img_element.meta && img_element.meta.expressions) {
      for(var i = 0;i < img_element.meta.expressions.length;i++) {
        var exp = img_element.meta.expressions[i];
        for(var j = 0;j < exp.manifestations.length;j++) {
          if(exp.manifestations[j].player == "webBrowser") {
            return true
          }
        }
      }
    }
    return false
  };
  var _getTitleAndDescInMyLang = function(langBlocks) {
    var filled_lang = false;
    var title_and_desc = {};
    var default_title_and_desc = {};
    if(langBlocks.length == 1) {
      default_title_and_desc.title = langBlocks[0].title;
      default_title_and_desc.description = langBlocks[0].description;
      return default_title_and_desc
    }
    for(var i = 0;i < langBlocks.length;i++) {
      if(langBlocks[i].language == DEFAULT_LANGUAGE) {
        title_and_desc.title = langBlocks[i].title;
        title_and_desc.description = langBlocks[i].description;
        filled_lang = true
      }
      if(langBlocks[i].language == "en" || langBlocks[i].language == "en-GB") {
        default_title_and_desc.title = langBlocks[i].title;
        default_title_and_desc.description = langBlocks[i].description
      }
    }
    if(filled_lang) {
      return title_and_desc
    }else {
      return default_title_and_desc
    }
  };
  return{init:init, requestImages:requestImages, requestObjects:requestObjects, formatLREResponse:formatLREResponse}
}(VISH, jQuery);
VISH.Editor.MenuTablet = function(V, $, undefined) {
  var init = function() {
    $(".menu_option_main").click(function(event) {
      if($("ul.menu_option_main").css("display") == "none") {
        $("ul.menu_option_main > li > ul").hide();
        $("ul.menu_option_main").show()
      }else {
        $("ul.menu_option_main").hide()
      }
    });
    $("a.menu_option").click(function(event) {
      if(!$(this).hasClass("menu_action") && $(this).parent()[0].tagName === "LI" && $(this).parent().find("ul").length == 1) {
        event.preventDefault();
        event.stopPropagation();
        var subMenu = $(this).parent().find("ul")[0];
        if($(subMenu).is(":visible")) {
          $(subMenu).hide();
          return
        }
        $("ul.menu_option_main > li > ul").hide();
        $(subMenu).show()
      }else {
      }
    })
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.Object.Flash = function(V, $, undefined) {
  var drawFlashObjectWithSource = function(src) {
    var current_area = V.Editor.getCurrentArea();
    var template = V.Editor.getTemplate();
    var nextFlashId = V.Utils.getId();
    var idToDrag = "draggable" + nextFlashId;
    var idToResize = "resizable" + nextFlashId;
    current_area.attr("type", "object");
    var embedDiv = document.createElement("div");
    embedDiv.setAttribute("id", idToDrag);
    $(embedDiv).addClass("object_wrapper");
    $(embedDiv).addClass(template + "_object");
    var embedTag = document.createElement("embed");
    embedTag.setAttribute("id", idToResize);
    embedTag.setAttribute("class", template + "_object");
    embedTag.setAttribute("src", src);
    embedTag.setAttribute("wmode", "opaque");
    $(embedDiv).append(embedTag);
    $(current_area).html("");
    $(current_area).append(embedDiv);
    V.Editor.addDeleteButton($(current_area));
    $("#" + idToDrag).draggable({cursor:"move"})
  };
  return{drawFlashObjectWithSource:drawFlashObjectWithSource}
}(VISH, jQuery);
VISH.Editor.Object.GoogleDOC = function(V, $, undefined) {
  var init = function() {
  };
  var generateWrapper = function(url) {
    return"<iframe src='http://docs.google.com/viewer?url=" + url + "&embedded=true'></iframe>"
  };
  var generatePreviewWrapper = function(url) {
    return"<iframe class='objectPreview' src='http://docs.google.com/viewer?url=" + url + "&embedded=true'></iframe>"
  };
  return{init:init, generatePreviewWrapper:generatePreviewWrapper, generateWrapper:generateWrapper}
}(VISH, jQuery);
VISH.Editor.Object.LRE = function(V, $, undefined) {
  var containerDivId = "tab_object_lre_content";
  var carrouselDivId = "tab_object_lre_content_carrousel";
  var previewDivId = "tab_object_lre_content_preview";
  var myInput;
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch();
    _cleanObjectPreview()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.LRE.requestObjects(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.length || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(index, objectItem) {
      var myImg = $("<img src='" + objectItem.thumbnail + "' objectId='" + objectItem.id + "' title='" + objectItem.title + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectItem.id] = objectItem
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorLREConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = V.Editor.Object.renderObjectPreview(currentObject[objectId].object);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#tab_object_lre_content_preview_object");
    var metadataArea = $("#tab_object_lre_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var objectInfo = V.Object.getObjectInfo(object.object);
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description, url:objectInfo.source});
      $(metadataArea).html(table);
      $("#tab_object_lre_content_preview").find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#tab_object_lre_content_preview_object");
    var metadataArea = $("#tab_object_lre_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#tab_object_lre_content_preview").find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      V.Editor.Object.drawObject(selectedObject.object);
      $.fancybox.close()
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.Live = function(V, $, undefined) {
  var containerDivId = "tab_live_resource_content";
  var carrouselDivId = "tab_live_resource_content_carrousel";
  var previewDivId = "tab_live_resource_content_preview";
  var myInput;
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch();
    _cleanObjectPreview()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestLives(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(index, objectItem) {
      var objectInfo = V.Object.getObjectInfo(objectItem.object);
      var imageSource = null;
      switch(objectInfo.type) {
        case "swf":
          imageSource = V.ImagesPath + "carrousel/swf.png";
          break;
        case "youtube":
          imageSource = V.ImagesPath + "carrousel/youtube.png";
          break;
        case "web":
          if(objectInfo.wrapper == "IFRAME") {
            imageSource = V.ImagesPath + "carrousel/iframe.png"
          }else {
            imageSource = V.ImagesPath + "carrousel/object.png"
          }
          break;
        default:
          imageSource = V.ImagesPath + "carrousel/object.png"
      }
      var myImg = $("<img src='" + imageSource + "' objectId='" + objectItem.id + "' title='" + objectItem.title + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectItem.id] = objectItem
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = V.Editor.Object.renderObjectPreview(currentObject[objectId].fulltext);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_live");
    var metadataArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description});
      $(metadataArea).html(table);
      $("#tab_live_resource_content_preview_foot").find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_live");
    var metadataArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#tab_live_resource_content_preview_foot").find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      V.Editor.Object.drawObject(selectedObject.fulltext);
      $.fancybox.close()
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.Repository = function(V, $, undefined) {
  var containerDivId = "tab_object_repo_content";
  var carrouselDivId = "tab_object_repo_content_carrousel";
  var previewDivId = "tab_object_repo_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch();
    _cleanObjectPreview()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestObjects(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(index, objectItem) {
      var objectInfo = V.Object.getObjectInfo(objectItem.object);
      var imageSource = null;
      switch(objectInfo.type) {
        case "swf":
          imageSource = V.ImagesPath + "carrousel/swf.png";
          break;
        case "youtube":
          imageSource = V.ImagesPath + "carrousel/youtube.png";
          break;
        case "web":
          if(objectInfo.wrapper == "IFRAME") {
            imageSource = V.ImagesPath + "carrousel/iframe.png"
          }else {
            imageSource = V.ImagesPath + "carrousel/object.png"
          }
          break;
        default:
          imageSource = V.ImagesPath + "carrousel/object.png"
      }
      var myImg = $("<img src='" + imageSource + "' objectId='" + objectItem.id + "' title='" + objectItem.title + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectItem.id] = objectItem
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = V.Editor.Object.renderObjectPreview(currentObject[objectId].object);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_object");
    var metadataArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description});
      $(metadataArea).html(table);
      $("#" + previewDivId).find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_object");
    var metadataArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#" + previewDivId).find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      V.Editor.Object.drawObject(selectedObject.object);
      $.fancybox.close()
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.Snapshot = function(V, $, undefined) {
  var contentToAdd = null;
  var urlDivId = "tab_object_snapshot_content";
  var urlInputId = "object_snapshot_code";
  var init = function() {
    var urlInput = $("#" + urlDivId).find("input");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        V.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    })
  };
  var onLoadTab = function(tab) {
    contentToAdd = null;
    V.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var drawPreviewElement = function() {
    if(_validateSnapShot(contentToAdd)) {
      drawSnapShot(_wrapperSnapShot(contentToAdd));
      $.fancybox.close()
    }
  };
  var _validateSnapShot = function(object) {
    var objectInfo = V.Object.getObjectInfo(object);
    switch(objectInfo.wrapper) {
      case null:
        return _validateUrl(object);
        break;
      case "IFRAME":
        return _validateUrl(objectInfo.source);
        break;
      default:
        return false;
        break
    }
  };
  var _validateUrl = function(url) {
    var http_urls_pattern = /(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    if(url.match(http_urls_pattern) != null) {
      return true
    }else {
      return false
    }
  };
  var _wrapperSnapShot = function(content) {
    var objectInfo = V.Object.getObjectInfo(content);
    if(objectInfo.wrapper === null) {
      return"<iframe src='" + content + "'></iframe>"
    }else {
      return content
    }
  };
  var drawSnapShot = function(wrapper, area, style, scrollTop, scrollLeft) {
    var current_area;
    var object_style = "";
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    if(style) {
      object_style = style
    }
    var template = V.Editor.getTemplate(current_area);
    var nextWrapperId = V.Utils.getId();
    var idToDrag = "draggable" + nextWrapperId;
    var idToResize = "resizable" + nextWrapperId;
    current_area.attr("type", "snapshot");
    var wrapperDiv = document.createElement("div");
    wrapperDiv.setAttribute("id", idToDrag);
    if(style) {
      wrapperDiv.setAttribute("style", style)
    }
    $(wrapperDiv).addClass("snapshot_wrapper");
    var iframeTag = $(wrapper);
    $(iframeTag).attr("id", idToResize);
    $(iframeTag).attr("class", "snapshot_content");
    $(iframeTag).attr("scrolling", "no");
    $(iframeTag).attr("wmode", "opaque");
    $(iframeTag).css("pointer-events", "none");
    $(current_area).html("");
    $(current_area).append(wrapperDiv);
    V.Editor.addDeleteButton($(current_area));
    $(wrapperDiv).append(iframeTag);
    if(scrollTop) {
      $("#" + idToDrag).scrollTop(scrollTop)
    }
    if(scrollLeft) {
      $("#" + idToDrag).scrollLeft(scrollLeft)
    }
    $(wrapperDiv).attr("scrollTop", scrollTop);
    $(wrapperDiv).attr("scrollLeft", scrollLeft);
    $("#" + idToDrag).bind("mousedown", function(event) {
      event.preventDefault()
    });
    $("#" + idToDrag).draggable({cursor:"move", disabled:false, start:function(event, ui) {
      if(!_isBorderClick(event, idToDrag)) {
        return false
      }
    }});
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var _isBorderClick = function(event, idToDrag) {
    var accuracy = 6;
    var scrollAccuracy = -10;
    var width = $("#" + idToDrag).width();
    var height = $("#" + idToDrag).height();
    var offset = $("#" + idToDrag).offset();
    var dif1 = event.pageX - offset.left;
    if(dif1 < accuracy) {
      return true
    }
    var dif2 = event.pageY - offset.top;
    if(dif2 < accuracy) {
      return true
    }
    var dif3 = offset.left + width - event.pageX;
    if(dif3 < scrollAccuracy) {
      return true
    }
    var dif4 = offset.top + height - event.pageY;
    if(dif4 < scrollAccuracy) {
      return true
    }
    return false
  };
  var _resizeWebIframe = function(id, width) {
    var proportion = $("#" + id).height() / $("#" + id).width();
    $("#" + id).width(width);
    $("#" + id).height(width * proportion)
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement, drawSnapShot:drawSnapShot}
}(VISH, jQuery);
VISH.Editor.Object.Web = function(V, $, undefined) {
  var contentToAdd = null;
  var urlDivId = "tab_object_from_web_content";
  var urlInputId = "object_embedWeb_code";
  var init = function() {
    var urlInput = $("#" + urlDivId).find("input");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        V.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    })
  };
  var onLoadTab = function(tab) {
    contentToAdd = null;
    V.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var drawPreviewElement = function() {
    V.Editor.Object.drawPreviewObject(contentToAdd)
  };
  var generateWrapperForWeb = function(url) {
    return"<iframe src='" + url + "?wmode=transparent'></iframe>"
  };
  var generatePreviewWrapperForWeb = function(url) {
    return"<iframe class='objectPreview' src='" + url + "'></iframe>"
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement, generatePreviewWrapperForWeb:generatePreviewWrapperForWeb, generateWrapperForWeb:generateWrapperForWeb}
}(VISH, jQuery);
VISH.Editor.PDFex = function(V, $, undefined) {
  var uploadDivId = "tab_pdfex_content";
  var init = function() {
    var options = V.Editor.getOptions();
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='pdfex[attach]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='pdfex[title]']").val(filterFilePath);
      _resetUploadFields();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_pdfex_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='pdfex[attach]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          $("#" + uploadDivId + " input[name='pdfex[owner_id]']").val(V.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
          $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadPDF2PPath);
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal);
      if(percentVal === "100%") {
        V.Utils.Loader.startLoading()
      }
    }, success:function(responseText, statusText, xhr, form) {
      switch(V.Configuration.getConfiguration()["mode"]) {
        case V.Constant.VISH:
          processResponse(responseText);
          break;
        case V.Constant.STANDALONE:
          processResponse(responseText);
          break;
        default:
          break
      }
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      switch(V.Configuration.getConfiguration()["mode"]) {
        case V.Constant.NOSERVER:
          setTimeout(function() {
            var responseTest = {};
            responseTest.urls = [];
            for(var v = 0;v < 13;v++) {
              responseTest.urls.push("http://localhost/vishEditor/examples/contents/pdf2p/Presentacion_INTED2013_VishViewer-" + v + ".jpg")
            }
            processResponse(responseTest)
          }, 1E4);
          break;
        case V.Constant.VISH:
        ;
        case V.Constant.STANDALONE:
        ;
        default:
          break
      }
    }, error:function(error) {
      if(V.Configuration.getConfiguration()["mode"] === V.Constant.NOSERVER) {
        return
      }
      setTimeout(function() {
        V.Utils.Loader.onCloseLoading();
        _showErrorDialog()
      }, 800)
    }})
  };
  var onLoadTab = function() {
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='pdfex[attach]']").val("");
    _resetUploadFields()
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%")
  };
  var _showErrorDialog = function() {
    var options = {};
    options.width = 650;
    options.height = 190;
    options.text = V.I18n.getTrans("i.pdfErrorNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var processResponse = function(jsonResponse) {
    try {
      var presentation = generatePresentationWithImgArray(jsonResponse.urls);
      V.Editor.Presentation.previewPresentation(presentation);
      V.Utils.Loader.onCloseLoading()
    }catch(e) {
      V.Utils.Loader.stopLoading()
    }
  };
  var generatePresentationWithImgArray = function(imgs) {
    var presentation = {};
    presentation.VEVersion = V.VERSION;
    presentation.type = V.Constant.PRESENTATION;
    presentation.theme = V.Constant.Themes.Default;
    presentation.slides = [];
    for(var i = 0;i < imgs.length;i++) {
      var imageUrl = imgs[i];
      presentation.slides.push(_generateSlideWithImg(i, imageUrl))
    }
    return presentation
  };
  var _generateSlideWithImg = function(index, imgUrl) {
    var slide = {};
    slide.id = "article" + index;
    slide.type = V.Constant.STANDARD;
    slide.template = "t10";
    slide.elements = [];
    var element = {};
    element.areaid = "center";
    element.body = imgUrl;
    element.id = slide.id + "_zone1";
    element.type = V.Constant.IMAGE;
    slide.elements.push(element);
    return slide
  };
  return{init:init, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Presentation.File = function(V, $, undefined) {
  var fileDivId = "tab_json_file_content";
  var inputFilesId = "json_file_input";
  var buttonId = "json_preview_button";
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $("#" + buttonId).click(function() {
        var files = $("#" + inputFilesId)[0].files;
        if(files.length > 0) {
          _insertFile(files[0])
        }else {
          _showNoFileDialog()
        }
      });
      initialized = true
    }
  };
  var onLoadTab = function(tab) {
    $("#json_file_input").attr("value", "")
  };
  var _insertFile = function(file) {
    var reader = new FileReader;
    reader.onload = function(theFile) {
      return function(e) {
        try {
          var json = JSON.parse(e.target.result);
          V.Editor.Presentation.previewPresentation(json)
        }catch(e) {
          _showErrorDialog()
        }
      }
    }(file);
    reader.readAsText(file)
  };
  var _showErrorDialog = function() {
    var options = {};
    options.width = 650;
    options.height = 190;
    options.text = V.I18n.getTrans("i.readJSONfileError");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var _showNoFileDialog = function() {
    var options = {};
    options.width = 650;
    options.height = 190;
    options.text = V.I18n.getTrans("i.NoJSONFileError");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      V.Editor.Tools.Menu.insertJSON()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var exportToJSON = function(successCallback, failCallback) {
    var presentation = V.Editor.savePresentation();
    V.Editor.API.uploadTmpJSON(presentation, successCallback, failCallback)
  };
  return{init:init, onLoadTab:onLoadTab, exportToJSON:exportToJSON}
}(VISH, jQuery);
VISH.Editor.Preview = function(V, $, undefined) {
  var presentationPreview = null;
  var init = function() {
    setTimeout(function() {
      _realInit()
    }, 2E3)
  };
  var _realInit = function() {
    $("#preview_action").fancybox({"width":910, "height":680, "padding":0, "autoScale":false, "transitionIn":"none", "transitionOut":"none", "type":"iframe", "onStart":function() {
      if(presentationPreview === null) {
        _prepare()
      }
      V.Editor.Utils.Loader.unloadObjectsInEditorSlide(V.Slides.getCurrentSlide())
    }, "onClosed":function() {
      presentationPreview = null;
      V.Editor.Utils.Loader.loadObjectsInEditorSlide(V.Slides.getCurrentSlide())
    }, "onComplete":function() {
      $("#fancybox-wrap").css("top", "45px");
      $("#fancybox-wrap").css("left", "135px");
      $("#fancybox-frame").addClass("vishEditorIframe")
    }})
  };
  var preview = function(options) {
    _prepare(options);
    $("#preview_action").trigger("click")
  };
  var _prepare = function(options) {
    var slideNumberToPreview;
    if(!options || !options["slideNumberToPreview"] || typeof options["slideNumberToPreview"] != "number") {
      slideNumberToPreview = V.Slides.getCurrentSlideNumber()
    }else {
      slideNumberToPreview = options["slideNumberToPreview"]
    }
    if(V.Configuration.getConfiguration().mode == V.Constant.VISH) {
      $("#preview_action").attr("href", "/excursions/preview#" + slideNumberToPreview)
    }else {
      if(V.Configuration.getConfiguration().mode == V.Constant.NOSERVER) {
        $("#preview_action").attr("href", "/vishEditor/viewer.html#" + slideNumberToPreview)
      }else {
        if(V.Configuration.getConfiguration().mode == V.Constant.STANDALONE) {
        }
      }
    }
    if(!options || !options["presentationJSON"] || typeof options["presentationJSON"] != "object") {
      presentationPreview = V.Editor.savePresentation()
    }else {
      presentationPreview = options["presentationJSON"]
    }
    if(options && options["insertMode"] && typeof options["insertMode"] == "boolean") {
      presentationPreview.insertMode = options["insertMode"]
    }
  };
  var getPreview = function() {
    return presentationPreview
  };
  return{init:init, preview:preview, getPreview:getPreview}
}(VISH, jQuery);
VISH.Editor.Quiz.MC = function(V, $, undefined) {
  var addQuizOptionButtonClass = "add_quiz_option_mc";
  var deleteQuizOptionButtonClass = "delete_quiz_option_mc";
  var mcCheckbox = "mcCheckbox";
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $(document).on("click", "." + "mcContainer", _clickOnQuizArea);
      $(document).on("click", "." + addQuizOptionButtonClass, _clickToAddOptionInQuiz);
      $(document).on("click", "." + deleteQuizOptionButtonClass, _removeOptionInQuiz);
      $(document).on("click", "." + mcCheckbox, _onCheckboxClick);
      initialized = true
    }
  };
  var _clickOnQuizArea = function(event) {
    switch(event.target.classList[0]) {
      case "mcContainer":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.id));
        break;
      case "mc_option_text":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.parentElement.id));
        break;
      case "mc_option":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.id));
        break;
      default:
        break
    }
  };
  var _onCheckboxClick = function(event) {
    var check = $(event.target).attr("check");
    switch(check) {
      case "true":
        V.Quiz.updateCheckbox(event.target, "none");
        break;
      case "false":
        break;
      case "none":
      ;
      default:
        V.Quiz.updateCheckbox(event.target, "true");
        break
    }
  };
  var add = function(area) {
    area.append(_getDummy());
    area.find(".menuselect_hide").remove();
    area.attr("type", "quiz");
    area.attr("quiztype", V.Constant.QZ_TYPE.MCHOICE);
    _launchTextEditorForQuestion(area);
    _addOptionInQuiz(area);
    V.Editor.addDeleteButton(area)
  };
  var _getDummy = function() {
    return"<div class='mcContainer'><div class='mc_question_wrapper'></div><ul class='mc_options'></ul><img src='" + V.ImagesPath + "icons/add.png' class='" + addQuizOptionButtonClass + "'/><input type='hidden' name='quiz_id'/></div></div>"
  };
  var _getOptionDummy = function() {
    return"<li class='mc_option'><div class='mc_option_wrapper'><span class='mc_option_index'></span><div class='mc_option_text'></div><table class='mc_checks'><tr class='checkFirstRow'><td><img src='" + V.ImagesPath + "icons/ve_delete.png' class='" + deleteQuizOptionButtonClass + "'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + mcCheckbox + "' check='none'/></td></tr></table></div></li>"
  };
  var _clickToAddOptionInQuiz = function(event) {
    var area = $("#" + event.target.parentElement.parentElement.id);
    V.Editor.setCurrentArea(area);
    _addOptionInQuiz(area)
  };
  var _addOptionInQuiz = function(area, value, check) {
    var nChoices = $(area).find("li.mc_option").size();
    var quiz_option = _getOptionDummy();
    var quiz_option = $(quiz_option).attr("nChoice", nChoices + 1);
    $(area).find(".mc_options").append(quiz_option);
    _refreshChoicesIndexs(area);
    if(check) {
      V.Quiz.updateCheckbox($(quiz_option).find("td > img")[1], check)
    }
    _launchTextEditorForOptions(area, nChoices, value);
    if(nChoices > 0) {
      $(area).find("li[nChoice='" + (nChoices + 1) + "']").find("." + deleteQuizOptionButtonClass).css("visibility", "visible")
    }
  };
  var _removeOptionInQuiz = function(event) {
    var area = $("div[type='quiz']").has(event.target);
    V.Editor.setCurrentArea(area);
    var liToRemove = $("li.mc_option").has(event.target);
    $(liToRemove).remove();
    _refreshChoicesIndexs(area)
  };
  var _refreshChoicesIndexs = function(area) {
    $(area).find("li.mc_option").each(function(index, option_element) {
      $(option_element).find(".mc_option_index").text(String.fromCharCode(96 + index + 1) + ")")
    })
  };
  var _launchTextEditorForQuestion = function(area, question) {
    var textArea = $(area).find(".mc_question_wrapper");
    if(!question) {
      V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:38, focus:true, autogrow:true})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, question, {autogrow:true})
    }
  };
  var _launchTextEditorForOptions = function(area, nChoice, value) {
    var first = nChoice === 0;
    var textArea = $(area).find(".mc_option_text")[nChoice];
    if(!value) {
      if(first) {
        V.Editor.Text.launchTextEditor({}, textArea, "Write options here", {forceNew:true, fontSize:24, autogrow:true, placeholder:true})
      }else {
        V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:24, autogrow:true, focus:true})
      }
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, value, {autogrow:true})
    }
  };
  var save = function(area) {
    var textArea = $(area).find(".mc_question_wrapper");
    var quiz = {};
    quiz.quizType = VISH.Constant.QZ_TYPE.MCHOICE;
    quiz.selfA = false;
    quiz.extras = {};
    quiz.extras.multipleAnswer = false;
    var nAnswers = 0;
    var questionInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".mc_question_wrapper"));
    quiz.question = {};
    quiz.question.value = questionInstance.getPlainText();
    quiz.question.wysiwygValue = questionInstance.getData();
    quiz.choices = [];
    var nChoices = $(area).find("li.mc_option").size();
    var optionTextAreas = $(area).find(".mc_option_text");
    for(var i = 0;i < nChoices;i++) {
      var textArea = optionTextAreas[i];
      var optionInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
      var choice = {};
      choice.id = (i + 1).toString();
      choice.value = optionInstance.getPlainText();
      choice.wysiwygValue = optionInstance.getData();
      if($(textArea).parent().find(".mcCheckbox").attr("check") === "true") {
        choice.answer = true;
        quiz.selfA = true;
        nAnswers++
      }else {
        choice.answer = "?"
      }
      quiz.choices.push(choice)
    }
    if(quiz.selfA) {
      $(quiz.choices).each(function(index, choice) {
        if(choice.answer !== true) {
          choice.answer = false
        }
      })
    }
    if(nAnswers > 1) {
      quiz.extras.multipleAnswer = true
    }
    return quiz
  };
  var draw = function(area, quiz) {
    $(area).append(_getDummy());
    $(area).attr("type", V.Constant.QUIZ);
    $(area).attr("quiztype", V.Constant.QZ_TYPE.MCHOICE);
    _launchTextEditorForQuestion(area, quiz.question.wysiwygValue);
    V.Editor.addDeleteButton(area);
    $(quiz.choices).each(function(index, choice) {
      var check = undefined;
      if(quiz.selfA) {
        if(choice.answer === true) {
          check = "true"
        }
      }
      _addOptionInQuiz(area, choice.wysiwygValue, check)
    })
  };
  return{init:init, add:add, save:save, draw:draw}
}(VISH, jQuery);
VISH.Editor.Quiz.TF = function(V, $, undefined) {
  var addQuizOptionButtonClass = "add_quiz_option_tf";
  var deleteQuizOptionButtonClass = "delete_quiz_option_tf";
  var tfCheckbox = "tfCheckbox";
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $(document).on("click", "." + "mcContainer", _clickOnQuizArea);
      $(document).on("click", "." + addQuizOptionButtonClass, _clickToAddOptionInQuiz);
      $(document).on("click", "." + deleteQuizOptionButtonClass, _removeOptionInQuiz);
      $(document).on("click", "." + tfCheckbox, _onCheckboxClick);
      initialized = true
    }
  };
  var _clickOnQuizArea = function(event) {
    switch(event.target.classList[0]) {
      case "mcContainer":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.id));
        break;
      case "mc_option_text":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.parentElement.id));
        break;
      case "mc_option":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.id));
        break;
      default:
        break
    }
  };
  var _onCheckboxClick = function(event) {
    var check = $(event.target).attr("check");
    var column = $(event.target).attr("column");
    switch(column) {
      case "true":
        if(check === "true") {
          V.Quiz.updateCheckbox(event.target, "none")
        }else {
          var falseColumnCheckbox = $("tr").has(event.target).find(".tfCheckbox[column='false']");
          V.Quiz.updateCheckbox(falseColumnCheckbox, "none");
          V.Quiz.updateCheckbox(event.target, "true")
        }
        break;
      case "false":
        if(check === "false") {
          V.Quiz.updateCheckbox(event.target, "none")
        }else {
          var trueColumnCheckbox = $("tr").has(event.target).find(".tfCheckbox[column='true']");
          V.Quiz.updateCheckbox(trueColumnCheckbox, "none");
          V.Quiz.updateCheckbox(event.target, "false")
        }
        break;
      default:
        break
    }
  };
  var add = function(area) {
    area.append(_getDummy());
    area.find(".menuselect_hide").remove();
    area.attr("type", "quiz");
    area.attr("quiztype", V.Constant.QZ_TYPE.TF);
    _launchTextEditorForQuestion(area);
    _addOptionInQuiz(area);
    V.Editor.addDeleteButton(area)
  };
  var _getDummy = function() {
    return"<div class='tfContainer'><div class='mc_question_wrapper'></div><ul class='mc_options'></ul><img src='" + V.ImagesPath + "icons/add.png' class='" + addQuizOptionButtonClass + "'/><input type='hidden' name='quiz_id'/></div></div>"
  };
  var _getOptionDummy = function() {
    return"<li class='mc_option'><div class='mc_option_wrapper'><span class='mc_option_index'></span><div class='mc_option_text'></div><table class='mc_checks'><tr class='checkFirstRow'><td><img src='" + V.ImagesPath + "icons/ve_delete.png' class='" + deleteQuizOptionButtonClass + "'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + tfCheckbox + "' column='true' check='none'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + tfCheckbox + "' column='false' check='none'/></td></tr></table></div></li>"
  };
  var _clickToAddOptionInQuiz = function(event) {
    var area = $("#" + event.target.parentElement.parentElement.id);
    V.Editor.setCurrentArea(area);
    _addOptionInQuiz(area)
  };
  var _addOptionInQuiz = function(area, value, check) {
    var nChoices = $(area).find("li.mc_option").size();
    var quiz_option = _getOptionDummy();
    var quiz_option = $(quiz_option).attr("nChoice", nChoices + 1);
    $(area).find(".mc_options").append(quiz_option);
    _refreshChoicesIndexs(area);
    if(check === "true") {
      V.Quiz.updateCheckbox($(quiz_option).find("td > img")[1], check)
    }else {
      if(check === "false") {
        V.Quiz.updateCheckbox($(quiz_option).find("td > img")[2], check)
      }
    }
    _launchTextEditorForOptions(area, nChoices, value);
    if(nChoices > 0) {
      $(area).find("li[nChoice='" + (nChoices + 1) + "']").find("." + deleteQuizOptionButtonClass).css("visibility", "visible")
    }
  };
  var _removeOptionInQuiz = function(event) {
    var area = $("div[type='quiz']").has(event.target);
    V.Editor.setCurrentArea(area);
    var liToRemove = $("li.mc_option").has(event.target);
    $(liToRemove).remove();
    _refreshChoicesIndexs(area)
  };
  var _refreshChoicesIndexs = function(area) {
    $(area).find("li.mc_option").each(function(index, option_element) {
      $(option_element).find(".mc_option_index").text(String.fromCharCode(96 + index + 1) + ")")
    })
  };
  var _launchTextEditorForQuestion = function(area, question) {
    var textArea = $(area).find(".mc_question_wrapper");
    if(!question) {
      V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:38, focus:true, autogrow:true})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, question, {autogrow:true})
    }
  };
  var _launchTextEditorForOptions = function(area, nChoice, value) {
    var first = nChoice === 0;
    var textArea = $(area).find(".mc_option_text")[nChoice];
    if(!value) {
      if(first) {
        V.Editor.Text.launchTextEditor({}, textArea, "Write options here", {forceNew:true, fontSize:24, autogrow:true, placeholder:true})
      }else {
        V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:24, autogrow:true, focus:true})
      }
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, value, {autogrow:true})
    }
  };
  var save = function(area) {
    var textArea = $(area).find(".mc_question_wrapper");
    var quiz = {};
    quiz.quizType = VISH.Constant.QZ_TYPE.TF;
    quiz.selfA = false;
    var questionInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".mc_question_wrapper"));
    quiz.question = {};
    quiz.question.value = questionInstance.getPlainText();
    quiz.question.wysiwygValue = questionInstance.getData();
    quiz.choices = [];
    var nChoices = $(area).find("li.mc_option").size();
    var optionTextAreas = $(area).find(".mc_option_text");
    for(var i = 0;i < nChoices;i++) {
      var textArea = optionTextAreas[i];
      var optionInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
      var choice = {};
      choice.id = (i + 1).toString();
      choice.value = optionInstance.getPlainText();
      choice.wysiwygValue = optionInstance.getData();
      var trueColumCheckbox = $(textArea).parent().find(".tfCheckbox[column='true']");
      if($(trueColumCheckbox).attr("check") === "true") {
        choice.answer = true;
        quiz.selfA = true
      }else {
        var falseColumCheckbox = $(textArea).parent().find(".tfCheckbox[column='false']");
        if($(falseColumCheckbox).attr("check") === "false") {
          choice.answer = false;
          quiz.selfA = true
        }else {
          choice.answer = "?"
        }
      }
      quiz.choices.push(choice)
    }
    return quiz
  };
  var draw = function(area, quiz) {
    $(area).append(_getDummy());
    $(area).attr("type", V.Constant.QUIZ);
    $(area).attr("quiztype", V.Constant.QZ_TYPE.TF);
    _launchTextEditorForQuestion(area, quiz.question.wysiwygValue);
    V.Editor.addDeleteButton(area);
    $(quiz.choices).each(function(index, choice) {
      var check = undefined;
      if(quiz.selfA) {
        if(choice.answer === true) {
          check = "true"
        }else {
          if(choice.answer === false) {
            check = "false"
          }
        }
      }
      _addOptionInQuiz(area, choice.wysiwygValue, check)
    })
  };
  return{init:init, add:add, save:save, draw:draw}
}(VISH, jQuery);
VISH.Editor.Renderer = function(V, $, undefined) {
  var slides = null;
  var init = function(presentation) {
    V.Editor.Animations.setCurrentAnimation(presentation.animation);
    if(presentation.type === V.Constant.PRESENTATION) {
      renderPresentation(presentation)
    }else {
      if(presentation.type === V.Constant.QUIZ_SIMPLE) {
        presentation.type = V.Constant.PRESENTATION;
        renderPresentation(presentation)
      }
    }
  };
  var renderPresentation = function(presentation) {
    slides = presentation.slides;
    for(var i = 0;i < slides.length;i++) {
      var slideNumber = V.Slides.getSlidesQuantity() + 1;
      var type = slides[i].type;
      if(type === V.Constant.STANDARD) {
        _renderSlide(slides[i], {slideNumber:slideNumber})
      }else {
        var isSlideset = V.Editor.Slideset.isSlideset(type);
        if(isSlideset) {
          _renderSlideset(slides[i], slideNumber)
        }
      }
    }
  };
  var _renderSlide = function(slide, renderOptions) {
    var options = {};
    options.template = "1";
    if(slide.template) {
      options.template = slide.template.substring(1)
    }
    options.slideNumber = renderOptions.slideNumber;
    var scaffold = V.Editor.Dummies.getScaffoldForSlide(slide, options);
    if(!renderOptions.subslide) {
      V.Editor.Slides.appendSlide(scaffold);
      V.Slides.updateSlides();
      V.Slides.lastSlide()
    }else {
      V.Editor.Slides.appendSubslide(renderOptions.slidesetDOM, scaffold);
      var scaffoldDOM = $("#" + $(scaffold).attr("id"));
      $(scaffoldDOM).addClass("temp_shown")
    }
    for(el in slide.elements) {
      var areaId = slide.elements[el].id;
      var area = $("div#" + areaId + "[areaid='" + slide.elements[el].areaid + "']");
      if(area.length === 0) {
        continue
      }
      if(slide.elements[el].type === V.Constant.TEXT) {
        V.Editor.Text.launchTextEditor({}, area, slide.elements[el].body)
      }else {
        if(slide.elements[el].type === V.Constant.IMAGE) {
          V.Editor.Image.drawImage(slide.elements[el].body, area, slide.elements[el].style, slide.elements[el].hyperlink)
        }else {
          if(slide.elements[el].type === V.Constant.VIDEO) {
            var options = [];
            options["poster"] = slide.elements[el].poster;
            options["autoplay"] = slide.elements[el].autoplay;
            var sourcesArray = [];
            $.each(JSON.parse(slide.elements[el].sources), function(index, source) {
              sourcesArray.push([source.src, source.type])
            });
            V.Editor.Video.HTML5.drawVideo(sourcesArray, options, area)
          }else {
            if(slide.elements[el].type === V.Constant.OBJECT) {
              V.Editor.Object.drawObject(slide.elements[el].body, {area:area, style:slide.elements[el].style, zoomInStyle:slide.elements[el].zoomInStyle})
            }else {
              if(slide.elements[el].type === V.Constant.SNAPSHOT) {
                V.Editor.Object.Snapshot.drawSnapShot(slide.elements[el].body, area, slide.elements[el].style, slide.elements[el].scrollTop, slide.elements[el].scrollLeft)
              }else {
                if(slide.elements[el].type === V.Constant.QUIZ) {
                  V.Editor.Quiz.draw(area, slide.elements[el])
                }
              }
            }
          }
        }
      }
      var hideTooltip = true;
      if(V.Editor.isZoneEmpty(area)) {
        hideTooltip = false;
        $(area).addClass("editable")
      }
      V.Editor.Tools.addTooltipToZone(area, hideTooltip)
    }
    if(renderOptions.subslide) {
      $(scaffoldDOM).removeClass("temp_shown")
    }
  };
  var _renderSlideset = function(slidesetJSON, slideNumber) {
    var options = {};
    options.slideNumber = slideNumber;
    options.slidesetId = slidesetJSON.id.toString();
    var scaffold = V.Editor.Dummies.getScaffoldForSlide(slidesetJSON, options);
    if(scaffold) {
      V.Editor.Slides.appendSlide(scaffold);
      V.Slides.updateSlides();
      V.Slides.lastSlide();
      var slidesetId = $(scaffold).attr("id");
      var scaffoldDOM = $("#" + slidesetId);
      var subslides = slidesetJSON.slides;
      if(subslides) {
        var ssL = subslides.length;
        for(var i = 0;i < ssL;i++) {
          var subslideJSON = subslides[i];
          _renderSlide(subslideJSON, {slidesetDOM:scaffoldDOM, slideNumber:i + 1, subslide:true})
        }
      }
      var slidesetCreator = V.Editor.Slideset.getCreatorModule(slidesetJSON.type);
      slidesetCreator.draw(slidesetJSON, scaffoldDOM)
    }
  };
  return{init:init, renderPresentation:renderPresentation}
}(VISH, jQuery);
VISH.Editor.Scrollbar = function(V, $, undefined) {
  var createScrollbar = function(containerId, options) {
    if(!containerId) {
      return
    }
    var callback = null;
    var horizontalScroll = false;
    if(options) {
      if(options["callback"]) {
        callback = options["callback"]
      }
      if(options["horizontalScroll"]) {
        horizontalScroll = options["horizontalScroll"]
      }
    }
    var scrollbar = $("#" + containerId);
    $(scrollbar).mCustomScrollbar({scrollInertia:0, autoDraggerLength:true, horizontalScroll:horizontalScroll});
    $(scrollbar).find(".mCSB_container").css("margin-right", "5px");
    setTimeout(function() {
      $(scrollbar).mCustomScrollbar("update");
      setTimeout(function() {
        if(options && options.scrollTop === true) {
        }else {
          $(scrollbar).mCustomScrollbar("scrollTo", "bottom")
        }
        if(typeof callback === "function") {
          callback()
        }
      }, 150)
    }, 100);
    return
  };
  var cleanScrollbar = function(containerId) {
    var scrollbar = $("#" + containerId);
    $(scrollbar).html("");
    $(scrollbar).removeClass();
    return
  };
  var goToElement = function(containerId, element) {
    var elementId = $(element).attr("id");
    var hasId = typeof elementId == "string";
    if(!hasId) {
      var tmpId = V.Utils.getId("tmp");
      $(element).attr("id", tmpId);
      elementId = tmpId
    }
    $("#" + containerId).mCustomScrollbar("scrollTo", "#" + elementId);
    if(!hasId) {
      $(element).removeAttr("id", tmpId)
    }
  };
  var insertElement = function(containerId, element, posc) {
  };
  return{createScrollbar:createScrollbar, cleanScrollbar:cleanScrollbar, goToElement:goToElement}
}(VISH, jQuery);
VISH.Editor.Settings = function(V, $, undefined) {
  var themeScrollbarDivId = "scrollbar_themes_list";
  var tagsLoaded = false;
  var themeScrollbarCreated = false;
  var LOM_Difficulty;
  var presentationThumbnail;
  var init = function() {
    LOM_Difficulty = V.Editor.Utils.LOM.getDifficulty();
    _initSliders()
  };
  var _initSliders = function() {
    $("#slider-age").slider({range:true, min:0, max:30, values:[V.Constant.AGE_RANGE_MIN, V.Constant.AGE_RANGE_MAX], slide:function(event, ui) {
      $("#age_range").val(ui.values[0] + " - " + ui.values[1])
    }});
    $("#age_range").val(V.Constant.AGE_RANGE);
    $("#slider-difficulty").slider({min:0, max:5, value:[V.Constant.DIFFICULTY], slide:function(event, ui) {
      $("#difficulty_range").attr("difficulty", ui.value);
      $("#difficulty_range").val(LOM_Difficulty[ui.value].text)
    }});
    $("#difficulty_range").attr("difficulty", V.Constant.DIFFICULTY);
    $("#difficulty_range").val(LOM_Difficulty[V.Constant.DIFFICULTY].text);
    if(V.Configuration.getConfiguration()["presentationTags"] && !tagsLoaded) {
      $("#tagBoxIntro").attr("HTMLcontent", $("#tagBoxIntro").html());
      V.Utils.Loader.startLoadingInContainer($("#tagBoxIntro"), {style:"loading_tags"});
      V.Editor.API.requestTags(_onInitialTagsReceived)
    }
  };
  var displaySettings = function() {
    $("a#edit_presentation_details").fancybox({"autoDimensions":false, "autoScale":true, "scrolling":"no", "width":1E3, "height":700, "padding":0, "hideOnOverlayClick":false, "hideOnContentClick":false, "showCloseButton":false, "onComplete":function(data) {
      $("#fancybox-wrap").css("margin-top", "20px");
      _onDisplaySettings()
    }, "onClosed":function(data) {
      var selectedThemeNumber = $(".theme_selected_in_scrollbar").attr("themeNumber");
      var currentThemeNumber = V.Editor.Themes.getCurrentTheme().number;
      if(typeof selectedThemeNumber == "string" && selectedThemeNumber != currentThemeNumber) {
        V.Editor.Themes.selectTheme("theme" + selectedThemeNumber)
      }
    }});
    $("a#edit_presentation_details").trigger("click")
  };
  var _onDisplaySettings = function() {
    var options = V.Utils.getOptions();
    if(!themeScrollbarCreated) {
      V.Editor.Scrollbar.cleanScrollbar(themeScrollbarDivId);
      $("#" + themeScrollbarDivId).hide();
      var imagesArray = [];
      var imagesArrayTitles = [];
      for(var i = 1;i < 13;i++) {
        var imgExt = "png";
        if(i == 12) {
          imgExt = "gif"
        }
        var srcURL = V.ImagesPath + "themes/theme" + i + "/select." + imgExt;
        imagesArray.push($("<img themeNumber='" + i + "' class='image_barbutton' src='" + srcURL + "' />"));
        imagesArrayTitles.push(i)
      }
      var options = {};
      options.order = true;
      options.titleArray = imagesArrayTitles;
      options.callback = _onThemeImagesLoaded;
      V.Utils.Loader.loadImagesOnContainer(imagesArray, themeScrollbarDivId, options)
    }else {
      selectTheme(V.Editor.Themes.getCurrentTheme().number);
      V.Editor.Scrollbar.goToElement(themeScrollbarDivId, $("img.theme_selected_in_scrollbar"))
    }
    onTLTchange();
    _checkIfEnableContinueButton()
  };
  var loadPresentationSettings = function(presentation) {
    if(!presentation) {
      presentation = {}
    }
    if(presentation.avatar) {
      _addThumbnail(presentation.avatar)
    }
    if(presentation.title) {
      $("#presentation_details_preview_addtitle_input").val(presentation.title);
      $("#presentation_details_input_title").val(presentation.title)
    }
    var author;
    var options = V.Utils.getOptions();
    if(options && options.username) {
      author = options.username
    }else {
      if(presentation.author) {
        author = presentation.author
      }
    }
    if(author) {
      var authorDOM = $("#author_span_in_preview");
      $(authorDOM).html(author)
    }
    if(presentation.description) {
      var descriptionDOM = $("#presentation_details_textarea");
      $(descriptionDOM).val(presentation.description)
    }
    selectTheme(V.Editor.Themes.getCurrentTheme().number);
    if(presentation.language) {
      $("#language_tag").val(presentation.language)
    }
    if(presentation.context) {
      $("#context_tag").val(presentation.context)
    }
    if(presentation.age_range) {
      var start_range = presentation.age_range.substring(0, presentation.age_range.indexOf("-") - 1);
      var end_range = presentation.age_range.substring(presentation.age_range.indexOf("-") + 2);
      $("#slider-age").slider("values", [start_range, end_range]);
      $("#age_range").val(presentation.age_range)
    }else {
      $("#age_range").val(V.Constant.AGE_RANGE)
    }
    if(presentation.difficulty) {
      var difficultyIndexValue = 0;
      for(var j = 0;j < LOM_Difficulty.length;j++) {
        if(LOM_Difficulty[j].value === presentation.difficulty) {
          difficultyIndexValue = j
        }
      }
      $("#difficulty_range").val(LOM_Difficulty[difficultyIndexValue].text);
      $("#difficulty_range").attr("difficulty", difficultyIndexValue);
      $("#slider-difficulty").slider("value", difficultyIndexValue)
    }
    if(presentation.TLT) {
      var durations = VISH.Editor.Utils.iso8601Parser.getDurationPerUnit(presentation.TLT);
      $("#tlt_hours").val(durations[4].toString());
      $("#tlt_minutes").val(durations[5].toString());
      $("#tlt_seconds").val(durations[6].toString())
    }
    if(presentation.subject) {
      $("#subject_tag").val(presentation.subject)
    }
    if(presentation.educational_objectives) {
      $("#educational_objectives_textarea").val(presentation.educational_objectives)
    }
  };
  var _onThemeImagesLoaded = function() {
    $("#" + themeScrollbarDivId).find("img.image_barbutton").each(function(index, img) {
      var imgContainer = $(img).parent();
      $(imgContainer).addClass("wrapper_barbutton");
      var p = $(imgContainer).find("p");
      $(p).addClass("ptext_barbutton");
      $(img).click(function(event) {
        _onClickTheme(event)
      })
    });
    var options = new Array;
    options.scrollTop = true;
    options.callback = _afterCreateThemesScrollbar;
    $("#" + themeScrollbarDivId).show();
    V.Editor.Scrollbar.createScrollbar(themeScrollbarDivId, options)
  };
  var _onClickTheme = function(event) {
    var themeNumber = $(event.target).attr("themeNumber");
    selectTheme(themeNumber)
  };
  var _afterCreateThemesScrollbar = function() {
    selectTheme(V.Editor.Themes.getCurrentTheme().number);
    V.Editor.Scrollbar.goToElement(themeScrollbarDivId, $("img.theme_selected_in_scrollbar"));
    themeScrollbarCreated = true
  };
  var selectTheme = function(themeNumber) {
    $(".theme_selected_in_scrollbar").removeClass("theme_selected_in_scrollbar");
    $("#scrollbar_themes_list img.image_barbutton[themenumber='" + themeNumber + "']").addClass("theme_selected_in_scrollbar");
    $(".theme_selected_in_fancybox").removeClass("theme_selected_in_fancybox");
    $("#theme_fancybox div#select_theme" + themeNumber + " img").addClass("theme_selected_in_fancybox")
  };
  var selectAnimation = function(animationNumber) {
    $(".animation_selected_in_fancybox").removeClass("animation_selected_in_fancybox");
    $("#animation_fancybox div#select_animation" + animationNumber).addClass("animation_selected_in_fancybox")
  };
  var _onInitialTagsReceived = function(data) {
    tagsLoaded = true;
    data = V.Editor.Competitions.addCompetitionTags(data);
    V.Utils.Loader.stopLoadingInContainer($("#tagBoxIntro"));
    $("#tagBoxIntro").html($("#tagBoxIntro").attr("HTMLcontent"));
    var tagList = $("#tagBoxIntro .tagList");
    var draftPresentation = V.Editor.getDraftPresentation();
    if($(tagList).children().length == 0) {
      if(!draftPresentation) {
      }else {
        if(draftPresentation.tags) {
          $.each(draftPresentation.tags, function(index, tag) {
            $(tagList).append("<li>" + tag + "</li>")
          })
        }
      }
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:20, maxTags:8, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var onChangeThumbnailClicked = function() {
    $("#editthumb").hide();
    $("#hidden_button_to_uploadThumbnail").trigger("click")
  };
  var onThumbnailSelected = function(thumbnail_url) {
    V.Editor.Settings.displaySettings();
    _addThumbnail(thumbnail_url);
    _checkIfEnableContinueButton()
  };
  var _addThumbnail = function(thumbnail_url) {
    var thumbnail_wrapper = $("#presentation_details_preview_thumbnail");
    var thumbnail = $("#presentation_details_preview_thumbnail_img");
    $(thumbnail).removeClass("addThumbnailPlus");
    $(thumbnail).attr("src", thumbnail_url);
    $(thumbnail_wrapper).find("p.addthumbtitle").hide();
    presentationThumbnail = thumbnail_url
  };
  var onKeyUpOnTitle = function(event) {
    var inputData = $("#presentation_details_input_title");
    var inputPreview = $("#presentation_details_preview_addtitle_input");
    var title = $(inputData).val();
    if(title.trim() != "") {
      $(inputPreview).val(title)
    }else {
      $(inputPreview).val("")
    }
    _checkIfEnableContinueButton()
  };
  var onKeyUpOnPreviewTitle = function(event) {
    var inputData = $("#presentation_details_input_title");
    var inputPreview = $("#presentation_details_preview_addtitle_input");
    var title = $(inputPreview).val();
    if(title.trim() != "") {
      $(inputData).val(title)
    }else {
      $(inputData).val("")
    }
    _checkIfEnableContinueButton()
  };
  var onTLTchange = function() {
    var TLT = _getTLT();
    if(TLT === null) {
      $("#tlt_current_value").val(V.I18n.getTrans("i.invalidvalue"))
    }else {
      if(typeof TLT == "undefined") {
        $("#tlt_current_value").val(V.I18n.getTrans("i.unspecified"))
      }else {
        if(typeof TLT == "string") {
          $("#tlt_current_value").val(TLT)
        }
      }
    }
  };
  var _checkIfEnableContinueButton = function() {
    var enable = checkMandatoryFields();
    if(enable) {
      $("#save_presentation_details").removeClass("buttonDisabledOnSettings");
      $("#save_presentation_details").removeAttr("disabled");
      $("#save_presentation_details").attr("disabledTitle", $("#save_presentation_details").attr("title"));
      $("#save_presentation_details").removeAttr("title")
    }else {
      if(!$("#save_presentation_details").attr("title")) {
        $("#save_presentation_details").attr("title", $("#save_presentation_details").attr("disabledTitle"))
      }
      $("#save_presentation_details").addClass("buttonDisabledOnSettings");
      $("#save_presentation_details").attr("disabled", "true")
    }
  };
  var checkMandatoryFields = function() {
    var title = $("#presentation_details_input_title").val();
    var thumbnailURL = presentationThumbnail;
    if(typeof title != "string" || title.trim() == "") {
      return false
    }
    if(typeof thumbnailURL != "string" || thumbnailURL.trim() == "") {
      return false
    }
    return true
  };
  var onSavePresentationDetailsButtonClicked = function(event) {
    event.preventDefault();
    if($(event.target).hasClass("buttonDisabledOnSettings")) {
      return
    }
    $.fancybox.close()
  };
  var saveSettings = function() {
    var settings = {};
    settings.VEVersion = V.VERSION;
    settings.type = V.Constant.PRESENTATION;
    var title = $("#presentation_details_input_title").val();
    if(typeof title == "string" && title.trim() != "") {
      settings.title = title
    }
    var description = $("#presentation_details_textarea").val();
    if(typeof description == "string" && description.trim() != "") {
      settings.description = description
    }
    if(presentationThumbnail) {
      settings.avatar = presentationThumbnail
    }
    var author = $("#author_span_in_preview").html();
    if(typeof author == "string" && author.trim() != "") {
      settings.author = author
    }
    var tags = getTags();
    if(tags && tags.length > 0) {
      settings.tags = tags
    }
    var themeNumber = V.Editor.Themes.getCurrentTheme().number;
    if(typeof themeNumber == "string") {
      settings.theme = "theme" + themeNumber
    }else {
      settings.theme = V.Constant.Themes.Default
    }
    var animationSelection = V.Editor.Animations.getCurrentAnimation().filename;
    if(typeof animationSelection == "string") {
      settings.animation = animationSelection
    }else {
      settings.animation = V.Constant.Animations.Default
    }
    var language = $("#language_tag").val();
    if(typeof language == "string") {
      settings.language = language
    }
    var context = $("#context_tag").val();
    if(typeof context == "string" && context != "unspecified") {
      settings.context = context
    }
    var age_range = $("#age_range").val();
    if(typeof age_range == "string") {
      settings.age_range = age_range
    }
    var difficultyIndexValue = $("#difficulty_range").attr("difficulty");
    var difficultyValue = LOM_Difficulty[difficultyIndexValue];
    if(typeof difficultyValue == "object") {
      var difficulty = difficultyValue.value;
      if(typeof difficulty == "string" && difficulty != "unspecified") {
        settings.difficulty = difficulty
      }
    }
    var TLT = _getTLT();
    if(typeof TLT == "string") {
      settings.TLT = TLT
    }
    var subjectsToSave = [];
    var subjects = $("#subject_tag").val();
    var sL = subjects.length;
    if(typeof sL == "number" && sL > 0) {
      for(var sI = 0;sI < sL;sI++) {
        var subject = subjects[sI];
        if(subject != "Unspecified") {
          subjectsToSave.push(subject)
        }
      }
      if(subjectsToSave.length > 0) {
        settings.subject = subjectsToSave
      }
    }
    var educational_objectives = $("#educational_objectives_textarea").val();
    if(typeof educational_objectives == "string" && educational_objectives.trim() != "") {
      settings.educational_objectives = educational_objectives
    }
    return settings
  };
  var _getTLT = function() {
    var TLT = "PT";
    var hours = $("#tlt_hours").val();
    var minutes = $("#tlt_minutes").val();
    var seconds = $("#tlt_seconds").val();
    if(jQuery.isNumeric(hours) && jQuery.isNumeric(minutes) && jQuery.isNumeric(seconds)) {
      hours = parseInt(hours);
      minutes = parseInt(minutes);
      seconds = parseInt(seconds);
      if(hours >= 0 && hours < 100 && minutes >= 0 && minutes < 60 && seconds >= 0 && seconds < 60) {
        if(hours * 24 * 60 + minutes * 60 + seconds > 0) {
          if(hours != 0) {
            TLT = TLT + hours + "H"
          }
          if(minutes != 0) {
            TLT = TLT + minutes + "M"
          }
          if(seconds != 0) {
            TLT = TLT + seconds + "S"
          }
          return TLT
        }else {
          if(hours === 0 && minutes === 0 && seconds === 0) {
            return undefined
          }
        }
      }
    }
    return null
  };
  var getTags = function() {
    var tagIndex = $("#tagindex");
    if(tagIndex.length > 0 && $(tagIndex).hasClass("tagit")) {
      return V.Editor.Utils.convertToTagsArray($(tagIndex).tagit("tags"))
    }else {
      var draftPresentation = V.Editor.getDraftPresentation();
      if(typeof draftPresentation == "object") {
        return draftPresentation.tags
      }
    }
  };
  var onPedagogicalButtonClicked = function(event) {
    event.preventDefault();
    $("#presentation_details_fields").slideUp();
    $("#pedagogical_options_fields").slideDown()
  };
  var onDonePedagogicalButtonClicked = function(event) {
    event.preventDefault();
    $("#pedagogical_options_fields").slideUp();
    $("#presentation_details_fields").slideDown()
  };
  return{init:init, displaySettings:displaySettings, loadPresentationSettings:loadPresentationSettings, onChangeThumbnailClicked:onChangeThumbnailClicked, onThumbnailSelected:onThumbnailSelected, selectTheme:selectTheme, onKeyUpOnTitle:onKeyUpOnTitle, onKeyUpOnPreviewTitle:onKeyUpOnPreviewTitle, onTLTchange:onTLTchange, checkMandatoryFields:checkMandatoryFields, onSavePresentationDetailsButtonClicked:onSavePresentationDetailsButtonClicked, getTags:getTags, saveSettings:saveSettings, onPedagogicalButtonClicked:onPedagogicalButtonClicked, 
  onDonePedagogicalButtonClicked:onDonePedagogicalButtonClicked, selectAnimation:selectAnimation}
}(VISH, jQuery);
VISH.Editor.Slides = function(V, $, undefined) {
  var showSlides = function() {
    $(".slides > article").removeClass("temp_hidden")
  };
  var hideSlides = function() {
    $(".slides > article").addClass("temp_hidden")
  };
  var isSlideFocused = function() {
    if($(".wysiwygInstance").is(":focus")) {
      return false
    }
    if($("#fancybox-content").is(":visible")) {
      return false
    }
    if($("input").is(":focus")) {
      return false
    }
    if(V.Editor && V.Editor.getCurrentArea() !== null) {
      return false
    }
    return true
  };
  var moveSlideTo = function(orgPosition, destPosition) {
    var slide_to_move = V.Slides.getSlideWithNumber(orgPosition);
    var reference_slide = V.Slides.getSlideWithNumber(destPosition);
    if(typeof slide_to_move === "undefined" || typeof reference_slide === "undefined") {
      return
    }
    if(typeof slide_to_move.length !== undefined) {
      slide_to_move = $(slide_to_move)[0];
      if(typeof slide_to_move === "undefined") {
        return
      }
    }
    if(typeof reference_slide.length !== undefined) {
      reference_slide = $(reference_slide)[0];
      if(typeof reference_slide === "undefined") {
        return
      }
    }
    if(slide_to_move.tagName != "ARTICLE" || reference_slide.tagName != "ARTICLE" || slide_to_move == reference_slide) {
      return
    }
    var movement = null;
    if(destPosition > orgPosition) {
      movement = "after"
    }else {
      if(destPosition < orgPosition) {
        movement = "before"
      }else {
        return
      }
    }
    var article_to_move = slide_to_move;
    var article_reference = reference_slide;
    var moving_current_slide = false;
    var currentSlide = V.Slides.getCurrentSlide();
    var oldCurrentSlideNumber = parseInt($(currentSlide).attr("slidenumber"));
    if(currentSlide === article_to_move) {
      moving_current_slide = true
    }
    var textAreas = copyTextAreasOfSlide(article_to_move);
    $(article_to_move).remove();
    if(movement == "after") {
      $(article_reference).after(article_to_move)
    }else {
      if(movement == "before") {
        $(article_reference).before(article_to_move)
      }else {
        V.Debugging.log("V.Slides: Error. Movement not defined... !");
        return
      }
    }
    $(article_to_move).addClass("temp_shown");
    V.Editor.Utils.refreshDraggables(article_to_move);
    _cleanTextAreas(article_to_move);
    _loadTextAreasOfSlide(article_to_move, textAreas);
    $(article_to_move).removeClass("temp_shown");
    V.Slides.setSlides(document.querySelectorAll("section.slides > article"));
    $("#slides_list").find("div.wrapper_barbutton:has(img[slidenumber])").each(function(index, div) {
      var slideNumber = index + 1;
      var p = $(div).find("p.ptext_barbutton");
      $(p).html(slideNumber);
      var img = $(div).find("img.image_barbutton");
      $(img).attr("slidenumber", slideNumber)
    });
    var newCurrentSlideNumber;
    if(moving_current_slide) {
      newCurrentSlideNumber = destPosition
    }else {
      if(orgPosition > oldCurrentSlideNumber && destPosition <= oldCurrentSlideNumber) {
        newCurrentSlideNumber = oldCurrentSlideNumber + 1
      }else {
        if(orgPosition < oldCurrentSlideNumber && destPosition >= oldCurrentSlideNumber) {
          newCurrentSlideNumber = oldCurrentSlideNumber - 1
        }
      }
    }
    if(typeof newCurrentSlideNumber == "number") {
      V.Slides.setCurrentSlideNumber(newCurrentSlideNumber)
    }
    V.Slides.updateSlides()
  };
  var copySlideWithNumber = function(slideNumber, options) {
    var slide = V.Slides.getSlideWithNumber(slideNumber);
    if(slide === null) {
      return
    }
    var newSlide = $(slide).clone();
    copySlide(newSlide, options)
  };
  var copySlide = function(slideToCopy, options) {
    slideToCopy = _cleanTextAreas(slideToCopy);
    slideToCopy = V.Editor.Utils.replaceIdsForSlide(slideToCopy);
    var newId = $(slideToCopy).attr("id");
    if(typeof slideToCopy == "undefined") {
      return
    }
    var slideToCopyType = V.Slides.getSlideType(slideToCopy);
    var currentSlide = V.Slides.getCurrentSlide();
    if(currentSlide) {
      $(currentSlide).after(slideToCopy)
    }else {
      $("section#slides_panel").append(slideToCopy)
    }
    var slideCopied = $("#" + newId);
    V.Editor.Utils.refreshDraggables(slideCopied);
    if(slideToCopyType === V.Constant.STANDARD) {
      if(options.textAreas) {
        _loadTextAreasOfSlide(slideCopied, options.textAreas)
      }
    }
    V.Slides.updateSlides();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      if(currentSlide) {
        V.Slides.goToSlide(V.Slides.getCurrentSlideNumber() + 1);
        V.Editor.Thumbnails.moveThumbnailsToSlide(V.Slides.getCurrentSlideNumber())
      }else {
        V.Slides.goToSlide(1);
        V.Editor.Thumbnails.moveThumbnailsToSlide(1)
      }
    })
  };
  var _cleanTextAreas = function(slide) {
    $(slide).find("div[type='text'],div.wysiwygTextArea").each(function(index, textArea) {
      $(textArea).html("")
    });
    return slide
  };
  var copyTextAreasOfSlide = function(slide) {
    var textAreas = {};
    $(slide).find("div[type='text']").each(function(index, textArea) {
      var areaId = $(textArea).attr("areaid");
      var ckEditor = V.Editor.Text.getCKEditorFromZone(textArea);
      if(areaId && ckEditor !== null) {
        textAreas[areaId] = ckEditor.getData()
      }
    });
    $(slide).find("div[type='quiz']").each(function(index, quizArea) {
      var areaId = $(quizArea).attr("areaid");
      textAreas[areaId] = [];
      $(quizArea).find("div.wysiwygTextArea").each(function(index, textArea) {
        var ckEditor = V.Editor.Text.getCKEditorFromTextArea(textArea);
        if(areaId && ckEditor !== null) {
          textAreas[areaId].push(ckEditor.getData())
        }
      })
    });
    return textAreas
  };
  var _loadTextAreasOfSlide = function(slide, textAreas) {
    $(slide).find("div[type='text']").each(function(index, textArea) {
      var areaId = $(textArea).attr("areaid");
      if(areaId && textAreas[areaId]) {
        var data = textAreas[areaId];
        V.Editor.Text.launchTextEditor({}, $(textArea), data)
      }
    });
    $(slide).find("div[type='quiz']").each(function(index, quizArea) {
      var areaId = $(quizArea).attr("areaid");
      if(areaId && textAreas[areaId]) {
        var data = textAreas[areaId];
        $(quizArea).find("div.wysiwygTextArea").each(function(index, textArea) {
          var parent = $(textArea).parent();
          $(parent).html("");
          V.Editor.Text.launchTextEditor({}, $(parent), data[index], {autogrow:true})
        })
      }
    })
  };
  var addSlide = function(slide) {
    var slide = $(slide);
    var slideType = V.Slides.getSlideType(slide);
    appendSlide(slide);
    var oldCurrentSlideNumber = V.Slides.getCurrentSlideNumber();
    V.Slides.setCurrentSlideNumber(oldCurrentSlideNumber + 1);
    if(slideType === V.Constant.STANDARD) {
      V.Editor.Tools.addTooltipsToSlide(slide)
    }
    V.Slides.triggerLeaveEvent(oldCurrentSlideNumber);
    V.Slides.updateSlides();
    V.Slides.lastSlide();
    V.Slides.triggerEnterEvent(V.Slides.getCurrentSlideNumber());
    if(V.Editor.Slideset.isSlideset(slideType)) {
      var slidesetCreator = V.Editor.Slideset.getCreatorModule(slideType);
      slidesetCreator.draw(null, slide)
    }
    V.Editor.Thumbnails.redrawThumbnails(function() {
      V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber())
    })
  };
  var appendSlide = function(slide) {
    $(".slides").append(slide)
  };
  var removeSlide = function(slide) {
    if(slide === null) {
      return
    }
    if(V.Editor.Slideset.isSlideset(slide)) {
      V.Editor.Slideset.beforeRemoveSlideset(slide)
    }
    var removing_current_slide = false;
    if(V.Slides.getCurrentSlide() === slide) {
      removing_current_slide = true
    }
    $(slide).remove();
    if(removing_current_slide) {
      if(V.Slides.getCurrentSlideNumber() === 1 && V.Slides.getSlidesQuantity() > 1) {
        V.Slides.setCurrentSlideNumber(1)
      }else {
        V.Slides.setCurrentSlideNumber(V.Slides.getCurrentSlideNumber() - 1)
      }
    }
    V.Slides.updateSlides();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      if(typeof V.Slides.getCurrentSlide() != "undefined") {
        V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber());
        V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
      }
    })
  };
  var isSubslide = function(slide) {
    var parent = $(slide).parent()[0];
    if(parent) {
      return parent.tagName === "ARTICLE"
    }else {
      return false
    }
  };
  var addSubslide = function(slideset, subslide) {
    var subslide = $(subslide).css("display", "none");
    appendSubslide(slideset, subslide);
    V.Editor.Tools.addTooltipsToSlide(subslide);
    V.Editor.Slideset.openSubslide(subslide);
    V.Editor.Thumbnails.drawSlidesetThumbnails($(slideset).find("article"), function() {
      V.Editor.Thumbnails.selectSubslideThumbnail($(subslide).attr("slidenumber"))
    })
  };
  var appendSubslide = function(slideset, subslide) {
    $(slideset).append(subslide)
  };
  var removeSubslide = function(subslide) {
    if(typeof subslide !== "object") {
      return
    }
    var slideset = $(subslide).parent();
    V.Editor.Slideset.beforeRemoveSubslide(slideset, subslide);
    $(subslide).remove();
    var subslides = $(slideset).find("article");
    $(subslides).each(function(index, subslide) {
      $(subslide).attr("slidenumber", index + 1)
    });
    V.Editor.Thumbnails.drawSlidesetThumbnails(subslides, function() {
    });
    V.Editor.Slideset.openSlideset(slideset)
  };
  var removeSlideKeyboard = function() {
    if(V.Editor.Slideset.getCurrentSubslide() != null) {
      removeSubslide(V.Editor.Slideset.getCurrentSubslide())
    }else {
      removeSlide(V.Slides.getCurrentSlide())
    }
  };
  return{showSlides:showSlides, hideSlides:hideSlides, isSlideFocused:isSlideFocused, moveSlideTo:moveSlideTo, copySlide:copySlide, copySlideWithNumber:copySlideWithNumber, appendSlide:appendSlide, addSlide:addSlide, removeSlide:removeSlide, addSubslide:addSubslide, appendSubslide:appendSubslide, removeSubslide:removeSubslide, removeSlideKeyboard:removeSlideKeyboard, isSubslide:isSubslide, copyTextAreasOfSlide:copyTextAreasOfSlide}
}(VISH, jQuery);
VISH.Editor.Themes = function(V, $, undefined) {
  var initialized = false;
  var currentTheme;
  var themes = {};
  var init = function() {
    if(!initialized) {
      themes["theme1"] = {number:"1", color:"000"};
      themes["theme2"] = {number:"2", color:"fff"};
      themes["theme3"] = {number:"3", color:"666"};
      themes["theme4"] = {number:"4", color:"000"};
      themes["theme5"] = {number:"5", color:"fff"};
      themes["theme6"] = {number:"6", color:"555"};
      themes["theme7"] = {number:"7", color:"000"};
      themes["theme8"] = {number:"8", color:"000"};
      themes["theme9"] = {number:"9", color:"666"};
      themes["theme10"] = {number:"10", color:"666"};
      themes["theme11"] = {number:"11", color:"fff"};
      themes["theme12"] = {number:"12", color:"666"}
    }
  };
  var onThemeSelected = function(event) {
    event.preventDefault();
    var themeNumber = $(event.currentTarget).attr("theme");
    if($(event.target).hasClass("waitCursor")) {
      return
    }
    selectTheme(themeNumber, true);
    V.Editor.Settings.selectTheme(themes[themeNumber].number)
  };
  var selectTheme = function(theme, fromFancybox, callback) {
    if(fromFancybox) {
      $("#theme_fancybox").addClass("waitCursor");
      $(".themethumb").addClass("waitCursor")
    }
    V.Themes.loadTheme(theme, function() {
      currentTheme = theme;
      V.Editor.Text.refreshAutoColors();
      V.Editor.Tools.setAllTooltipMargins(function() {
        if(fromFancybox) {
          $.fancybox.close();
          $("#theme_fancybox").removeClass("waitCursor");
          $(".themethumb").removeClass("waitCursor")
        }
        if(typeof callback == "function") {
          callback()
        }
      })
    })
  };
  var getCurrentTheme = function() {
    if(currentTheme) {
      return themes[currentTheme]
    }else {
      return themes[VISH.Constant.Themes.Default]
    }
  };
  return{init:init, onThemeSelected:onThemeSelected, selectTheme:selectTheme, getCurrentTheme:getCurrentTheme}
}(VISH, jQuery);
VISH.Editor.Thumbnails = function(V, $, undefined) {
  var thumbnailsDivId = "slides_list";
  var slidesetThumbnailsDivId = "subslides_list";
  var redrawThumbnailsCallback;
  var drawSlidesetThumbnailsCallback;
  var init = function() {
  };
  var redrawThumbnails = function(successCallback) {
    redrawThumbnailsCallback = successCallback;
    V.Editor.Scrollbar.cleanScrollbar(thumbnailsDivId);
    $("#" + thumbnailsDivId).hide();
    var imagesArray = [];
    var imagesArrayTitles = [];
    var slideElements = 0;
    $(".slides > article").each(function(index, s) {
      var srcURL = getThumbnailURL(s);
      var defaultURL = getDefaultThumbnailURL(s);
      if(srcURL) {
        slideElements += 1;
        imagesArray.push($("<img id='slideThumbnail" + slideElements + "' class='image_barbutton' slideNumber='" + slideElements + "' action='goToSlide' src='" + srcURL + "' defaultsrc='" + defaultURL + "'/>"));
        imagesArrayTitles.push(slideElements)
      }
    });
    var options = {};
    options.order = true;
    options.titleArray = imagesArrayTitles;
    options.callback = _onImagesLoaded;
    options.defaultOnError = true;
    options.onImageErrorCallback = _onImageError;
    V.Utils.Loader.loadImagesOnContainer(imagesArray, thumbnailsDivId, options)
  };
  var _onImageError = function(image) {
    var slideNumber = $(image).attr("slidenumber");
    var slide = V.Slides.getSlideWithNumber(slideNumber);
    var isSlideset = V.Editor.Slideset.isSlideset(slide);
    if(isSlideset) {
      var creator = V.Editor.Slideset.getCreatorModule(slide);
      if(typeof creator.onThumbnailLoadFail == "function") {
        creator.onThumbnailLoadFail(slide)
      }
    }
  };
  var _onImagesLoaded = function() {
    $("#" + thumbnailsDivId).find("img.image_barbutton").each(function(index, img) {
      var imgContainer = $(img).parent();
      $(imgContainer).addClass("wrapper_barbutton");
      var p = $(imgContainer).find("p");
      $(p).addClass("ptext_barbutton");
      $(img).click(function(event) {
        _onClickSlideElement(event)
      })
    });
    $(".barbutton").css("background-color", "transparent");
    var options = new Array;
    options["callback"] = _afterCreateSlidesScrollbar;
    $("#" + thumbnailsDivId).show();
    V.Editor.Scrollbar.createScrollbar(thumbnailsDivId, options)
  };
  var _afterCreateSlidesScrollbar = function() {
    $("#" + thumbnailsDivId).sortable({items:'div.wrapper_barbutton:has(img[action="goToSlide"])', change:function(event, ui) {
    }, start:function(event, ui) {
    }, stop:function(event, ui) {
      var dragElement = ui.item;
      var img = $(ui.item).find("img.image_barbutton[slidenumber]");
      if(isNaN($(img).attr("slidenumber"))) {
        return
      }
      var orgPosition = parseInt($(img).attr("slidenumber"));
      var destPosition;
      $("#slides_list").find("img.image_barbutton[slidenumber]").each(function(index, item) {
        var beforeIndex = parseInt($(item).attr("slidenumber"));
        var afterIndex = index + 1;
        if(beforeIndex === orgPosition && beforeIndex != afterIndex) {
          destPosition = afterIndex
        }
      });
      V.Editor.Slides.moveSlideTo(orgPosition, destPosition)
    }});
    if(typeof redrawThumbnailsCallback == "function") {
      redrawThumbnailsCallback();
      redrawThumbnailsCallback = undefined
    }
  };
  var _onClickSlideElement = function(event) {
    switch($(event.target).attr("action")) {
      case "goToSlide":
        V.Slides.goToSlide($(event.target).attr("slideNumber"));
        break;
      default:
        return
    }
  };
  var selectThumbnail = function(no) {
    $("#slides_list img.image_barbutton").removeClass("selectedSlideThumbnail");
    $("#slides_list img.image_barbutton[slideNumber=" + no + "]").addClass("selectedSlideThumbnail")
  };
  var moveThumbnailsToSlide = function(slideNumber) {
    var element = $("img.image_barbutton[slideNumber=" + slideNumber + "]");
    V.Editor.Scrollbar.goToElement(thumbnailsDivId, element)
  };
  var getThumbnailForSlide = function(slide) {
    var slidenumber = $(slide).attr("slidenumber");
    return $("#slides_list img.image_barbutton[slideNumber=" + slidenumber + "]")
  };
  var getThumbnailForSubslide = function(subslide) {
    var slidenumber = $(subslide).attr("slidenumber");
    return $("#subslides_list img.image_barbutton[slideNumber=" + slidenumber + "]")
  };
  var getThumbnailURL = function(slide) {
    var thumbnailURL;
    var slideType = $(slide).attr("type");
    var isSlideset = V.Editor.Slideset.isSlideset(slideType);
    if(isSlideset) {
      thumbnailURL = V.Editor.Slideset.getCreatorModule(slideType).getThumbnailURL(slide)
    }else {
      if(slideType == V.Constant.STANDARD) {
        var template = $(slide).attr("template");
        thumbnailURL = V.ImagesPath + "templatesthumbs/" + template + ".png"
      }
    }
    return thumbnailURL
  };
  var getDefaultThumbnailURL = function(slide) {
    var slideType = $(slide).attr("type");
    if(slideType == V.Constant.STANDARD) {
      return getThumbnailURL(slide)
    }else {
      if(V.Editor.Slideset.isSlideset(slideType)) {
        var creatorModule = V.Editor.Slideset.getCreatorModule(slideType);
        if(typeof creatorModule.getDefaultThumbnailURL == "function") {
          return creatorModule.getDefaultThumbnailURL(slide)
        }else {
          return creatorModule.getThumbnailURL(slide)
        }
      }
    }
  };
  var drawSlidesetThumbnails = function(subslides, successCallback) {
    drawSlidesetThumbnailsCallback = successCallback;
    V.Editor.Scrollbar.cleanScrollbar(slidesetThumbnailsDivId);
    $("#" + slidesetThumbnailsDivId).hide();
    var imagesArray = [];
    var imagesArrayTitles = [];
    var slideElements = 0;
    $(subslides).each(function(index, s) {
      if($(s).attr("type") !== V.Constant.STANDARD) {
        V.Debugging.log("Subslide must be of standard type");
        return true
      }
      var template = $(s).attr("template");
      var srcURL = V.ImagesPath + "templatesthumbs/" + template + ".png";
      slideElements += 1;
      imagesArray.push($("<img id='subslideThumbnail" + slideElements + "' class='image_barbutton' slideNumber='" + slideElements + "' src='" + srcURL + "' />"));
      imagesArrayTitles.push(String.fromCharCode(64 + slideElements))
    });
    var options = {};
    options.order = true;
    options.titleArray = imagesArrayTitles;
    options.callback = _onSlidesetThumbnailsImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(imagesArray, slidesetThumbnailsDivId, options)
  };
  var _onSlidesetThumbnailsImagesLoaded = function() {
    $("#" + slidesetThumbnailsDivId).find("img.image_barbutton").each(function(index, img) {
      var imgContainer = $(img).parent();
      $(imgContainer).addClass("wrapper_barbutton");
      var p = $(imgContainer).find("p");
      $(p).addClass("ptext_barbutton");
      $(img).click(function(event) {
        _onClickSubslideElement(event)
      })
    });
    V.Editor.Slideset.beforeCreateSlidesetThumbnails();
    var options = new Array;
    options["horizontalScroll"] = true;
    options["callback"] = _afterCreateSubslidesScrollbar;
    $("#" + slidesetThumbnailsDivId).show();
    V.Editor.Scrollbar.createScrollbar(slidesetThumbnailsDivId, options)
  };
  var _afterCreateSubslidesScrollbar = function() {
    if(typeof drawSlidesetThumbnailsCallback == "function") {
      drawSlidesetThumbnailsCallback();
      drawSlidesetThumbnailsCallback = undefined
    }
  };
  var _onClickSubslideElement = function(event) {
    var subslideNumber = $(event.target).attr("slideNumber");
    V.Editor.Slideset.openSubslideWithNumber(subslideNumber)
  };
  var selectSubslideThumbnail = function(no) {
    $("#subslides_list img.image_barbutton").removeClass("selectedSubslideThumbnail");
    $("#subslides_list img.image_barbutton[slideNumber=" + no + "]").addClass("selectedSubslideThumbnail")
  };
  return{init:init, redrawThumbnails:redrawThumbnails, selectThumbnail:selectThumbnail, moveThumbnailsToSlide:moveThumbnailsToSlide, drawSlidesetThumbnails:drawSlidesetThumbnails, selectSubslideThumbnail:selectSubslideThumbnail, getThumbnailURL:getThumbnailURL, getThumbnailForSlide:getThumbnailForSlide, getThumbnailForSubslide:getThumbnailForSubslide}
}(VISH, jQuery);
VISH.Editor.Tools.Menu = function(V, $, undefined) {
  var _initialized = false;
  var _hoverMenu = false;
  var _competitionsModalShown = false;
  var init = function() {
    if(!_initialized) {
      if(!V.Status.getDevice().desktop) {
        if(V.Status.getDevice().tablet) {
          V.Editor.MenuTablet.init()
        }else {
          disableMenu();
          return
        }
      }else {
        _hoverMenu = true
      }
      $.each($("#menu a.menu_action"), function(index, menuButton) {
        $(menuButton).on("click", function(event) {
          event.preventDefault();
          if($(menuButton).parent().hasClass("menu_item_disabled")) {
            return false
          }
          if(typeof V.Editor.Tools.Menu[$(menuButton).attr("action")] == "function") {
            V.Editor.Tools.Menu[$(menuButton).attr("action")](this);
            _hideMenuAfterAction()
          }
          return false
        })
      });
      if(V.Status.getDevice().desktop) {
        $("a.menu_option_main, a.menu_option:not('.menu_action')").on("click", function(event) {
          event.preventDefault();
          return false
        })
      }
      var options = V.Utils.getOptions();
      if(typeof options.exitURL != "string") {
        $(".menu_option.menu_action[action='exit']").parent().hide()
      }
      _initialized = true
    }
    $("#menu").show()
  };
  var _enableMenuItem = function(items) {
    $(items).removeClass("menu_item_disabled").addClass("menu_item_enabled")
  };
  var _disableMenuItem = function(items) {
    $(items).removeClass("menu_item_enabled").addClass("menu_item_disabled")
  };
  var disableMenu = function() {
    $("#menu").hide();
    $("#menu").attr("id", "menuDisabled")
  };
  var enableMenu = function() {
    $("#menuDisabled").show();
    $("#menuDisabled").attr("id", "menu")
  };
  var onSaveButtonClicked = function() {
    V.Editor.Tools.changeSaveButtonStatus("loading");
    var presentation = V.Editor.savePresentation();
    V.Editor.sendPresentation(presentation, "save", function() {
      V.Editor.Tools.changeSaveButtonStatus("disabled")
    }, function() {
      V.Editor.Tools.changeSaveButtonStatus("enabled")
    })
  };
  var onPublishButtonClicked = function() {
    if(!V.Editor.Settings.checkMandatoryFields()) {
      var options = {};
      options.width = 600;
      options.height = 220;
      options.text = V.I18n.getTrans("i.MandatoryFieldsNotification");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.GotoSettings");
      button1.callback = function() {
        V.Editor.Settings.displaySettings()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    if(V.Slides.getSlides().length === 0) {
      var options = {};
      options.width = 600;
      options.height = 150;
      options.text = V.I18n.getTrans("i.NoSlidesOnSaveNotification");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    if(!V.Editor.Competitions.isValidCandidate() && !_competitionsModalShown) {
      _competitionsModalShown = true;
      var options = {};
      options.width = 650;
      options.height = 190;
      options.text = V.I18n.getTrans("i.NoCompetitions1");
      options.textWrapperClass = "competitions_paragraph";
      options.onClosedCallback = function() {
        setTimeout(function() {
          V.Editor.Tools.Menu.onPublishButtonClicked()
        }, 500)
      };
      options.notificationIconSrc = V.ImagesPath + "zonethumbs/content_fail.png";
      options.middlerow = V.Editor.Competitions.generateForm();
      options.middlerowExtraClass = "competitions_options";
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Done");
      button1.extraclass = "competi_disabled";
      button1.callback = function() {
        $.fancybox.close()
      };
      var button2 = {};
      button2.text = V.I18n.getTrans("i.NoThanks");
      button2.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1, button2];
      V.Utils.showDialog(options);
      return
    }
    var options = {};
    options.width = 600;
    options.height = 200;
    options.notificationIconSrc = V.ImagesPath + "icons/publish_icon.png";
    options.notificationIconClass = "publishNotificationIcon";
    options.text = V.I18n.getTrans("i.Publish_confirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.cancel");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.text = V.I18n.getTrans("i.publish");
    button2.callback = function() {
      V.Editor.Tools.changePublishButtonStatus("publishing");
      var presentation = V.Editor.savePresentation();
      V.Editor.sendPresentation(presentation, "publish", function(data) {
        switch(V.Configuration.getConfiguration().mode) {
          case V.Constant.VISH:
            V.Editor.Events.allowExitWithoutConfirmation();
            window.top.location.href = data.url;
            break;
          case V.Constant.NOSERVER:
            V.Editor.Preview.preview();
            V.Editor.Tools.changePublishButtonStatus("unpublish");
            break;
          case V.Constant.STANDALONE:
            break
        }
      }, function() {
        V.Editor.Tools.changePublishButtonStatus("publish")
      });
      $.fancybox.close()
    };
    options.buttons.push(button2);
    V.Utils.showDialog(options)
  };
  var onUnpublishButtonClicked = function() {
    var options = {};
    options.width = 600;
    options.height = 200;
    options.notificationIconSrc = V.ImagesPath + "icons/unpublish_icon.png";
    options.notificationIconClass = "publishNotificationIcon";
    options.text = V.I18n.getTrans("i.Unpublish_confirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.cancel");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.text = V.I18n.getTrans("i.unpublish");
    button2.callback = function() {
      V.Editor.Tools.changePublishButtonStatus("unpublishing");
      var presentation = V.Editor.savePresentation();
      V.Editor.sendPresentation(null, "unpublish", function() {
        V.Editor.Tools.changePublishButtonStatus("publish")
      }, function() {
        V.Editor.Tools.changePublishButtonStatus("unpublish")
      });
      $.fancybox.close()
    };
    options.buttons.push(button2);
    V.Utils.showDialog(options)
  };
  var preview = function() {
    V.Editor.Preview.preview()
  };
  var help = function() {
    $("#help_right").trigger("click")
  };
  var about = function() {
    V.Tour.startTourWithId("about_screen", "top")
  };
  var exit = function() {
    if(V.Editor.hasPresentationChanged()) {
      var options = {};
      options.width = 600;
      options.height = 200;
      options.notificationIconSrc = V.ImagesPath + "icons/save_document.png";
      options.text = V.I18n.getTrans("i.exitConfirmationMenu");
      options.buttons = [];
      var button1 = {};
      button1.text = V.I18n.getTrans("i.cancel");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons.push(button1);
      var button2 = {};
      button2.text = V.I18n.getTrans("i.ExitWSaving");
      button2.callback = function() {
        _exitFromVE();
        $.fancybox.close()
      };
      options.buttons.push(button2);
      var button3 = {};
      button3.text = V.I18n.getTrans("i.SaveAndExit");
      button3.callback = function() {
        $("#waiting_overlay").show();
        V.Editor.Tools.changeSaveButtonStatus("loading");
        var presentation = V.Editor.savePresentation();
        V.Editor.sendPresentation(presentation, "save", function() {
          V.Editor.Tools.changeSaveButtonStatus("disabled");
          _exitFromVE()
        }, function() {
          V.Editor.Tools.changeSaveButtonStatus("enabled");
          $("#waiting_overlay").hide()
        });
        $.fancybox.close()
      };
      options.buttons.push(button3);
      V.Utils.showDialog(options)
    }else {
      _exitFromVE()
    }
  };
  var _exitFromVE = function() {
    V.Editor.Events.allowExitWithoutConfirmation();
    window.top.location.href = V.Utils.getOptions().exitURL
  };
  var insertSmartcard = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_smartcards_repo")
  };
  var insertPresentation = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_presentations_repo")
  };
  var insertSlide = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_slides");
    return false
  };
  var insertSubslide = function() {
    V.Editor.setContentAddMode(V.Constant.SLIDESET);
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_slides");
    return false
  };
  var insertJSON = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_json_file")
  };
  var insertPDFex = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_pdfex");
    return false
  };
  var exportToJSON = function() {
    V.Utils.Loader.startLoading();
    V.Editor.Presentation.File.exportToJSON(function() {
      V.Utils.Loader.stopLoading()
    }, function() {
      setTimeout(function() {
        V.Utils.Loader.onCloseLoading();
        var options = {};
        options.width = 600;
        options.height = 185;
        options.text = V.I18n.getTrans("i.exportPresToJSONerrorNotification");
        var button1 = {};
        button1.text = V.I18n.getTrans("i.Ok");
        button1.callback = function() {
          $.fancybox.close()
        };
        options.buttons = [button1];
        V.Utils.showDialog(options)
      }, 500)
    })
  };
  var displaySettings = function() {
    V.Editor.Settings.displaySettings()
  };
  var _hideMenuAfterAction = function() {
    if(_hoverMenu) {
      $("#menu ul.menu_option_main").addClass("temp_hidden");
      setTimeout(function() {
        $("#menu ul.menu_option_main").removeClass("temp_hidden")
      }, 500)
    }
  };
  return{init:init, disableMenu:disableMenu, enableMenu:enableMenu, insertPresentation:insertPresentation, insertSmartcard:insertSmartcard, insertSlide:insertSlide, insertSubslide:insertSubslide, insertJSON:insertJSON, insertPDFex:insertPDFex, exportToJSON:exportToJSON, displaySettings:displaySettings, onPublishButtonClicked:onPublishButtonClicked, onUnpublishButtonClicked:onUnpublishButtonClicked, onSaveButtonClicked:onSaveButtonClicked, preview:preview, help:help, about:about, exit:exit}
}(VISH, jQuery);
VISH.Editor.Utils.LOM = function(V, $, undefined) {
  var LOM_difficulty;
  var _init = function() {
    LOM_difficulty = new Array;
    LOM_difficulty[0] = {value:"unspecified", text:V.I18n.getTrans("i.unspecified")};
    LOM_difficulty[1] = {value:"very easy", text:V.I18n.getTrans("i.veryeasy")};
    LOM_difficulty[2] = {value:"easy", text:V.I18n.getTrans("i.easy")};
    LOM_difficulty[3] = {value:"medium", text:V.I18n.getTrans("i.medium")};
    LOM_difficulty[4] = {value:"difficult", text:V.I18n.getTrans("i.difficult")};
    LOM_difficulty[5] = {value:"very difficult", text:V.I18n.getTrans("i.verydifficult")}
  };
  var getDifficulty = function() {
    if(typeof LOM_difficulty == "undefined") {
      _init()
    }
    return LOM_difficulty
  };
  return{getDifficulty:getDifficulty}
}(VISH, jQuery);
VISH.Editor.Utils.Loader = function(V, $, undefined) {
  var _loadObjectsInEditor = function(objects) {
    $.each(objects, function(index, object) {
      var htmlContent = $(object).attr("htmlContent");
      if(typeof htmlContent !== "undefined") {
        $(object).html(htmlContent);
        $(object).removeAttr("htmlContent")
      }
    })
  };
  var _unloadObjectsInEditor = function(objects) {
    $.each(objects, function(index, object) {
      var htmlContent = $(object).html();
      if(typeof htmlContent !== "undefined" && htmlContent !== "") {
        $(object).attr("htmlContent", $(object).html());
        $(object).html("")
      }
    })
  };
  var _loadSnapshotsInEditor = function(snapshots) {
    $.each(snapshots, function(index, snapshot) {
      var htmlContent = $(snapshot).attr("htmlContent");
      if(typeof htmlContent !== "undefined") {
        $(snapshot).html(htmlContent);
        $(snapshot).removeAttr("htmlContent");
        var scrollTop = parseInt($(snapshot).attr("scrollTop"));
        var scrollLeft = parseInt($(snapshot).attr("scrollLeft"));
        $(snapshot).scrollTop(scrollTop);
        $(snapshot).scrollLeft(scrollLeft)
      }
    })
  };
  var _unloadSnapshotsInEditor = function(snapshots, updateScrolls) {
    $.each(snapshots, function(index, snapshot) {
      var htmlContent = $(snapshot).html();
      if(typeof htmlContent !== "undefined" && htmlContent !== "") {
        if(updateScrolls === true) {
          $(snapshot).attr("scrollTop", $(snapshot).scrollTop());
          $(snapshot).attr("scrollLeft", $(snapshot).scrollLeft())
        }
        $(snapshot).attr("htmlContent", htmlContent);
        $(snapshot).html("")
      }
    })
  };
  var loadObjectsInEditorSlide = function(slide) {
    _loadObjectsInEditor($(slide).find(".object_wrapper"));
    _loadSnapshotsInEditor($(slide).find(".snapshot_wrapper"))
  };
  var unloadObjectsInEditorSlide = function(slide) {
    _unloadObjectsInEditor($(slide).find(".object_wrapper"));
    _unloadSnapshotsInEditor($(slide).find(".snapshot_wrapper"), true)
  };
  var loadAllObjects = function() {
    _loadObjectsInEditor($(".object_wrapper"));
    _loadSnapshotsInEditor($(".snapshot_wrapper"))
  };
  var unloadAllObjects = function() {
    _unloadObjectsInEditor($(".object_wrapper"));
    _unloadSnapshotsInEditor($(".snapshot_wrapper"))
  };
  return{loadObjectsInEditorSlide:loadObjectsInEditorSlide, unloadObjectsInEditorSlide:unloadObjectsInEditorSlide, loadAllObjects:loadAllObjects, unloadAllObjects:unloadAllObjects}
}(VISH, jQuery);
VISH.Editor.Utils.iso8601Parser = function(V, $, undefined) {
  var multiplicators = [31104E3, 2592E3, 604800, 86400, 3600, 60, 1];
  var getDuration = function(period) {
    var durationPerUnit = getDurationPerUnit(period);
    if(durationPerUnit) {
      var durationInSeconds = 0;
      var dL = durationPerUnit.length;
      for(var i = 0;i < dL;i++) {
        durationInSeconds += durationPerUnit[i] * multiplicators[i]
      }
      return durationInSeconds
    }
    return null
  };
  var getDurationPerUnit = function(period) {
    try {
      var durationPerUnit = _parsePeriodString(period)
    }catch(e) {
      return null
    }
    return durationPerUnit
  };
  function _parsePeriodString(period, _distributeOverflow) {
    var distributeOverflow = _distributeOverflow ? _distributeOverflow : false;
    var valueIndexes = [2, 3, 4, 5, 7, 8, 9];
    var duration = [0, 0, 0, 0, 0, 0, 0];
    var overflowLimits = [0, 12, 4, 7, 24, 60, 60];
    var struct;
    period = period.toUpperCase();
    if(!period) {
      return duration
    }else {
      if(typeof period !== "string") {
        throw new Error("Invalid iso8601 period string '" + period + "'");
      }
    }
    if(struct = /^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(period)) {
      for(var i = 0;i < valueIndexes.length;i++) {
        var structIndex = valueIndexes[i];
        duration[i] = struct[structIndex] ? +struct[structIndex].replace(/[A-Za-z]+/g, "") : 0
      }
    }else {
      throw new Error("String '" + period + "' is not a valid ISO8601 period.");
    }
    if(distributeOverflow) {
      for(var i = duration.length - 1;i > 0;i--) {
        if(duration[i] >= overflowLimits[i]) {
          duration[i - 1] = duration[i - 1] + Math.floor(duration[i] / overflowLimits[i]);
          duration[i] = duration[i] % overflowLimits[i]
        }
      }
    }
    return duration
  }
  return{getDuration:getDuration, getDurationPerUnit:getDurationPerUnit}
}();
VISH.Editor.Video.HTML5 = function(V, $, undefined) {
  var init = function() {
  };
  var drawVideoWithUrl = function(url) {
    drawVideo([[url, _getVideoType(url)]])
  };
  var _getVideoType = function(url) {
    var source = V.Object.getObjectInfo(url).source;
    return"video/" + source.split(".").pop()
  };
  var drawVideo = function(sources, options, area, style) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    var posterUrl = V.ImagesPath + "vicons/example_poster_image.jpg";
    var autoplay = false;
    if(options) {
      if(options["poster"]) {
        posterUrl = options["poster"]
      }
      if(options["autoplay"]) {
        autoplay = options["autoplay"]
      }
    }
    var template = V.Editor.getTemplate(area);
    var nextVideoId = V.Utils.getId();
    var idToDragAndResize = "draggable" + nextVideoId;
    current_area.attr("type", "video");
    var videoTag = document.createElement("video");
    videoTag.setAttribute("id", idToDragAndResize);
    videoTag.setAttribute("draggable", true);
    videoTag.setAttribute("class", template + "_video");
    videoTag.setAttribute("title", "Click to drag");
    videoTag.setAttribute("controls", "controls");
    videoTag.setAttribute("preload", "metadata");
    videoTag.setAttribute("poster", posterUrl);
    videoTag.setAttribute("autoplayonslideenter", autoplay);
    if(style) {
      videoTag.setAttribute("style", style)
    }
    $(sources).each(function(index, source) {
      var videoSource = document.createElement("source");
      videoSource.setAttribute("src", source[0]);
      if(source[1]) {
        videoSource.setAttribute("type", source[1])
      }
      $(videoTag).append(videoSource)
    });
    var fallbackText = document.createElement("p");
    $(fallbackText).html("Your browser does not support HTML5 video.");
    $(videoTag).append(fallbackText);
    $(current_area).html("");
    $(current_area).append(videoTag);
    V.Editor.addDeleteButton($(current_area));
    $("#" + idToDragAndResize).draggable({cursor:"move"});
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var renderVideoFromSources = function(sources) {
    var posterUrl = V.ImagesPath + "icons/example_poster_image.jpg";
    var rendered = "<video class='objectPreview' preload='metadata' controls='controls' poster='" + posterUrl + "' >";
    $.each(sources, function(index, source) {
      rendered = rendered + "<source src='" + source + "' " + _getVideoType(source) + ">"
    });
    rendered = rendered + "</video>";
    return rendered
  };
  return{init:init, drawVideoWithUrl:drawVideoWithUrl, drawVideo:drawVideo, renderVideoFromSources:renderVideoFromSources}
}(VISH, jQuery);
VISH.Editor.Video.Repository = function(V, $, undefined) {
  var containerDivId = "tab_video_repo_content";
  var carrouselDivId = "tab_video_repo_content_carrousel";
  var previewDivId = "tab_video_repo_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentVideos = new Array;
  var selectedVideo = null;
  var init = function() {
    myInput = $("#tab_video_repo_content").find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestVideos(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanVideoPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanVideoPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.videos || data.videos.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    currentVideos = new Array;
    $.each(data.videos, function(index, video) {
      if(video) {
        var myImg = $("<img src='" + video.poster + "' videoId='" + video.id + "' title='" + video.title + "'/>");
        carrouselImages.push(myImg);
        currentVideos[video.id] = video
      }
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var videoId = $(event.target).attr("videoId");
    var renderedVideo = V.Renderer.renderVideo(currentVideos[videoId], "preview");
    _renderVideoPreview(renderedVideo, currentVideos[videoId]);
    selectedVideo = currentVideos[videoId]
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderVideoPreview = function(renderedVideo, video) {
    var videoArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    if(renderedVideo && video) {
      $(videoArea).append(renderedVideo);
      var table = V.Editor.Utils.generateTable({title:video.title, author:video.author, description:video.description});
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanVideoPreview = function() {
    var videoArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var addSelectedVideo = function() {
    if(selectedVideo != null) {
      var sourcesArray = [];
      var options = new Array;
      options["poster"] = selectedVideo.poster;
      var sources = selectedVideo.sources;
      if(typeof sources == "string") {
        sources = JSON.parse(sources)
      }
      $.each(sources, function(index, source) {
        sourcesArray.push([source.src, source.type])
      });
      V.Editor.Video.HTML5.drawVideo(sourcesArray, options);
      $.fancybox.close()
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedVideo:addSelectedVideo}
}(VISH, jQuery);
VISH.Editor.Video.Vimeo = function(V, $, undefined) {
  var containerDivId = "tab_video_vimeo_content";
  var carrouselDivId = "tab_video_vimeo_content_carrousel";
  var previewDivId = "tab_video_vimeo_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentVideos = new Array;
  var selectedVideo = null;
  var init = function() {
  };
  var beforeLoadTab = function() {
  };
  var onLoadTab = function() {
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Video.Youtube = function(V, $, undefined) {
  var containerDivId = "tab_video_youtube_content";
  var carrouselDivId = "tab_video_youtube_content_carrousel";
  var previewDivId = "tab_video_youtube_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentVideos = new Array;
  var selectedVideo = null;
  var MAX_VIDEOS = 20;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).watermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    _searchInYoutube(text)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanVideoPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanVideoPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _searchInYoutube = function(text) {
    var url_youtube = "http://gdata.youtube.com/feeds/api/videos?q=" + text + "&alt=json-in-script&callback=?&max-results=" + MAX_VIDEOS + "&start-index=1";
    $.getJSON(url_youtube, function(data) {
      _onDataReceived(data)
    }).error(function() {
      _onAPIError()
    })
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || !data.feed || data.feed.length == 0 || !data.feed.entry) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentVideos = new Array;
    var carrouselImages = [];
    $.each(data.feed.entry, function(i, item) {
      var video = item["id"]["$t"];
      var title = item["title"]["$t"];
      var author = item.author[0].name.$t;
      var subtitle = item.media$group.media$description.$t;
      video = video.replace("http://gdata.youtube.com/feeds/api/videos/", "http://www.youtube.com/watch?v=");
      var videoId = video.replace("http://www.youtube.com/watch?v=", "");
      currentVideos[videoId] = new Object;
      currentVideos[videoId].id = videoId;
      currentVideos[videoId].title = title;
      currentVideos[videoId].author = author;
      currentVideos[videoId].subtitle = subtitle;
      var image_url = "http://img.youtube.com/vi/" + videoId + "/0.jpg";
      var myImg = $("<img videoId='" + videoId + "' src='" + image_url + "' title='" + title + "'/>");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Editor.Utils.addTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorYoutubeConnection") + "</p>");
        V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Editor.Utils.removeTmpShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var addSelectedVideo = function() {
    if(selectedVideo != null) {
      V.Editor.Object.drawObject(_generateWrapper(selectedVideo.id));
      $.fancybox.close()
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var videoId = $(event.target).attr("videoId");
    var renderedPreviewVideo = _generatePreviewWrapper(videoId);
    _renderVideoPreview(renderedPreviewVideo, currentVideos[videoId]);
    selectedVideo = currentVideos[videoId]
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderVideoPreview = function(renderedIframe, video) {
    var videoArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    if(renderedIframe && video) {
      $(videoArea).append(renderedIframe);
      var table = V.Editor.Utils.generateTable({title:video.title, author:video.author, description:video.subtitle});
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanVideoPreview = function() {
    var videoArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var _generateWrapper = function(videoId) {
    var video_embedded = "http://www.youtube.com/embed/" + videoId;
    current_area = V.Editor.getCurrentArea();
    var width_height = V.Editor.Utils.dimentionToDraw(current_area.width(), current_area.height(), 325, 243);
    var wrapper = "<iframe src='" + video_embedded + "?wmode=opaque' frameborder='0' style='width:" + width_height.width + "px; height:" + width_height.height + "px;'></iframe>";
    return wrapper
  };
  var generateWrapperForYoutubeVideoUrl = function(url) {
    var videoId = V.VideoPlayer.Youtube.getYoutubeIdFromURL(url);
    if(videoId != null) {
      return _generateWrapper(videoId)
    }else {
      return"Youtube Video ID can't be founded."
    }
  };
  var _generatePreviewWrapper = function(videoId) {
    var video_embedded = "http://www.youtube.com/embed/" + videoId;
    var wrapper = '<iframe class="objectPreview" type="text/html" src="' + video_embedded + '?wmode=opaque" frameborder="0"></iframe>';
    return wrapper
  };
  var generatePreviewWrapperForYoutubeVideoUrl = function(url) {
    var videoId = V.VideoPlayer.Youtube.getYoutubeIdFromURL(url);
    if(videoId != null) {
      return _generatePreviewWrapper(videoId)
    }else {
      return"<p class='objectPreview'>Youtube Video ID can't be founded.</p>"
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedVideo:addSelectedVideo, generateWrapperForYoutubeVideoUrl:generateWrapperForYoutubeVideoUrl, generatePreviewWrapperForYoutubeVideoUrl:generatePreviewWrapperForYoutubeVideoUrl}
}(VISH, jQuery);
VISH.Events.Mobile = function(V, $, undefined) {
  var PM_TOUCH_SENSITIVITY = 20;
  var PM_TOUCH_DESVIATION = 60;
  var MINIMUM_ZOOM_TO_ENABLE_SCROLL = 1.2;
  var PM_TOUCH_SENSITIVITY_FOR_PAGER_FALLBACK = 15;
  var LONG_TOUCH_DURATION = 1E3;
  var bindedEventListeners = false;
  var init = function() {
    var device = V.Status.getDevice();
    var isIphoneAndSafari = device.iPhone && device.browser.name === V.Constant.SAFARI;
    if(isIphoneAndSafari) {
      _simpleClick = _simpleClickForIphoneAndSafari
    }
    if(device.tablet) {
      _longClick = _longClickForTablets
    }
    if(!isIphoneAndSafari && !device.tablet) {
      _checkClickTouches = function() {
        return false
      }
    }
  };
  var bindViewerMobileEventListeners = function() {
    if(bindedEventListeners) {
      return
    }else {
      bindedEventListeners = true
    }
    $(document).bind("touchstart", handleTouchStart);
    window.addEventListener("load", function() {
      _hideAddressBar()
    });
    $(window).on("orientationchange", function() {
      _hideAddressBar();
      $(window).trigger("resize")
    });
    document.body.addEventListener("touchmove", handleTouchMove, true);
    document.body.addEventListener("touchend", handleTouchEnd, true);
    document.body.addEventListener("touchcancel", handleTouchCancel, true)
  };
  var unbindViewerMobileEventListeners = function() {
    if(!bindedEventListeners) {
      return
    }else {
      bindedEventListeners = false
    }
    $(document).unbind("touchstart", handleTouchStart);
    window.removeEventListener("load", function() {
      _hideAddressBar()
    });
    $(window).off("orientationchange", function() {
      _hideAddressBar();
      window.onresize()
    });
    document.body.removeEventListener("touchmove", handleTouchMove, true);
    document.body.removeEventListener("touchend", handleTouchEnd, true)
  };
  var touchStartX = 0;
  var touchStartY = 0;
  var touchCX = 0;
  var touchCY = 0;
  var touchesLength = 0;
  var touchStartTime = 0;
  var handleTouchStart = function(event) {
    _resetTouchVars();
    var touches = _getTouches(event);
    touchesLength = touches.length;
    if(touchesLength === 1) {
      touchStartX = touches[0].pageX;
      touchStartY = touches[0].pageY
    }
    touchStartTime = (new Date).getTime()
  };
  var _resetTouchVars = function() {
    touchStartX = -1;
    touchStartY = -1;
    touchCX = -1;
    touchCY = -1;
    touchesLength = -1;
    touchStart = -1
  };
  var handleTouchMove = function(event) {
    var touches = _getTouches(event);
    if(touches.length === 1) {
      touchCX = touches[0].pageX;
      touchCY = touches[0].pageY;
      var zoom = document.documentElement.clientWidth / window.innerWidth;
      if(zoom <= MINIMUM_ZOOM_TO_ENABLE_SCROLL) {
        event.preventDefault();
        return
      }
    }
  };
  var handleTouchEnd = function(event) {
    if(touchesLength === 1) {
      if(_checkClickTouches(event)) {
        return
      }
      if(_checkAdvanceSlidesTouches(event)) {
        return
      }
      if(_checkOtherTouches(event)) {
        return
      }
    }
    _resetTouchVars()
  };
  var handleTouchCancel = function() {
    _resetTouchVars()
  };
  var _hideAddressBar = function() {
  };
  var _checkClickTouches = function(event) {
    var click = touchCX == -1 && touchCY == -1;
    if(click) {
      var duration = (new Date).getTime() - touchStartTime;
      if(duration < LONG_TOUCH_DURATION) {
        _simpleClick(event)
      }else {
        _longClick(event)
      }
    }
    return click
  };
  var _simpleClick = function(event) {
    return true
  };
  var _simpleClickForIphoneAndSafari = function(event) {
    if($(event.target).hasClass("fc_poi")) {
      event.preventDefault();
      var poiId = event.target.id;
      V.Events.onFlashcardPoiClicked(poiId)
    }else {
      if($(event.target).hasClass("close_subslide")) {
        event.preventDefault();
        V.Events.onCloseSubslideClicked(event)
      }
    }
    return true
  };
  var _longClick = function(event) {
    return true
  };
  var _longClickForTablets = function(event) {
    if(_checkPaginatorClick(event.target.id)) {
      event.preventDefault();
      event.stopPropagation();
      _applyPaginatorClick(event.target.id)
    }
  };
  var _checkAdvanceSlidesTouches = function(event) {
    var touchDX = touchCX - touchStartX;
    var touchDY = touchCY - touchStartY;
    var absTouchDX = Math.abs(touchDX);
    var absTouchDY = Math.abs(touchDY);
    var move_slide = absTouchDX > PM_TOUCH_SENSITIVITY && absTouchDY < PM_TOUCH_DESVIATION;
    move_slide = move_slide && touchCX !== -1;
    if(move_slide) {
      event.preventDefault();
      var zoom = document.documentElement.clientWidth / window.innerWidth;
      if(zoom > MINIMUM_ZOOM_TO_ENABLE_SCROLL) {
        return
      }
      var subslide = V.Slides.getCurrentSubSlide();
      if(subslide !== null) {
        V.Slides.closeSubslide($(subslide).attr("id"))
      }
      if(touchDX > 0) {
        V.Slides.backwardOneSlide()
      }else {
        V.Slides.forwardOneSlide()
      }
    }
    return move_slide
  };
  var _checkOtherTouches = function(event) {
    return false
  };
  var _checkOtherTouchesForTablets = function(event) {
    var id = event.target.id;
    if(_checkPaginatorClick(id)) {
      if((absTouchDX + absTouchDY) / 2 < PM_TOUCH_SENSITIVITY_FOR_PAGER_FALLBACK) {
        event.preventDefault();
        _applyPaginatorClick(id);
        return true
      }
    }
  };
  var _checkPaginatorClick = function(targetId) {
    return targetId === "page-switcher-end" || targetId === "page-switcher-start"
  };
  var _applyPaginatorClick = function(targetId) {
    if(targetId === "page-switcher-end") {
      $("#page-switcher-end").trigger("click")
    }else {
      if(targetId === "page-switcher-start") {
        $("#page-switcher-start").trigger("click")
      }
    }
  };
  var _getTouches = function(event) {
    if(event.touches) {
      return event.touches
    }else {
      if(event.originalEvent.touches) {
        return event.originalEvent.touches
      }else {
        return null
      }
    }
  };
  return{init:init, bindViewerMobileEventListeners:bindViewerMobileEventListeners, unbindViewerMobileEventListeners:unbindViewerMobileEventListeners}
}(VISH, jQuery);
VISH.EventsNotifier = function(V, $, undefined) {
  var listeners;
  var init = function() {
    listeners = new Array
  };
  var registerCallback = function(listenedEvent, callback) {
    if(listenedEvent in listeners) {
      listeners[listenedEvent].push(callback)
    }else {
      listeners[listenedEvent] = [];
      listeners[listenedEvent].push(callback);
      if(listenedEvent == V.Constant.Event.onMessage) {
        V.Messenger.init()
      }
    }
  };
  var unRegisterCallback = function(listenedEvent, callback) {
    if(listenedEvent in listeners) {
      if(listeners[listenedEvent].indexOf(callback) !== -1) {
        listeners[listenedEvent].splice(listeners[listenedEvent].indexOf(callback), 1)
      }
    }
  };
  var notifyEvent = function(triggeredEvent, params, triggeredByUser) {
    if(!listeners) {
      return
    }
    params = params || {};
    params.triggeredByUser = !(triggeredByUser === false);
    var eventListeners = listeners[triggeredEvent];
    if(eventListeners) {
      for(var i = 0;i < eventListeners.length;i++) {
        eventListeners[i](params)
      }
    }
  };
  return{init:init, notifyEvent:notifyEvent, registerCallback:registerCallback, unRegisterCallback:unRegisterCallback}
}(VISH, jQuery);
VISH.I18n = function(V, $, undefined) {
  var translations;
  var defaultTranslations;
  var language;
  var init = function(lang) {
    switch(V.Configuration.getConfiguration().mode) {
      case V.Constant.NOSERVER:
        if(typeof i18n["vish"]["default"] != "undefined") {
          defaultTranslations = i18n["vish"]["default"]
        }
        break;
      case V.Constant.VISH:
        if(typeof i18n["vish"]["default"] != "undefined") {
          defaultTranslations = i18n["vish"]["default"]
        }
        break;
      case V.Constant.STANDALONE:
        if(typeof i18n["standalone"]["default"] != "undefined") {
          defaultTranslations = i18n["standalone"]["default"]
        }
        break
    }
    if(typeof lang != "undefined") {
      language = lang
    }else {
      return
    }
    switch(V.Configuration.getConfiguration().mode) {
      case V.Constant.NOSERVER:
        if(typeof i18n["vish"][language] != "undefined") {
          translations = i18n["vish"][language]
        }
        break;
      case V.Constant.VISH:
        if(typeof i18n["vish"][language] != "undefined") {
          translations = i18n["vish"][language];
          defaultTranslations = i18n["vish"]["default"]
        }
        break;
      case V.Constant.STANDALONE:
        if(typeof i18n["standalone"][language] != "undefined") {
          translations = i18n["standalone"][language];
          defaultTranslations = i18n["standalone"]["default"]
        }
        break
    }
    if(typeof translations == "undefined") {
      return
    }
    $("[i18n-key]").each(function(index, elem) {
      var translation = getTrans($(elem).attr("i18n-key"));
      if(translation != null) {
        switch(elem.tagName) {
          case "INPUT":
            _translateInput(elem, translation);
            break;
          case "TEXTAREA":
            _translateTextArea(elem, translation);
            break;
          case "DIV":
            _translateDiv(elem, translation);
            break;
          case "LI":
            _translateLI(elem, translation);
            break;
          case "IMG":
            _translateImg(elem, translation);
          default:
            _genericTranslate(elem, translation);
            break
        }
      }
    });
    $("[i18n-key-href]").each(function(index, elem) {
      var translation = getTrans($(elem).attr("i18n-key-href"));
      if(translation != null) {
        $(elem).attr("href", translation)
      }
    })
  };
  var _translateInput = function(input, translation) {
    if($(input).val() !== "") {
      $(input).val(translation)
    }
    if($(input).attr("placeholder")) {
      $(input).attr("placeholder", translation)
    }
  };
  var _translateDiv = function(div, translation) {
    if($(div).attr("data-text") != undefined) {
      $(div).attr("data-text", translation)
    }
    if($(div).attr("title") != undefined) {
      $(div).attr("title", translation)
    }
  };
  var _translateTextArea = function(textArea, translation) {
    $(textArea).attr("placeholder", translation)
  };
  var _translateLI = function(li, translation) {
    if($(li).attr("data-text") != undefined) {
      $(li).attr("data-text", translation)
    }else {
      _genericTranslate(li, translation)
    }
  };
  var _translateImg = function(img, translation) {
    $(img).attr("src", V.ImagesPath + translation)
  };
  var _genericTranslate = function(elem, translation) {
    $(elem).text(translation)
  };
  var getTrans = function(s, params) {
    if(typeof translations != "undefined" && translations[s]) {
      return _getTrans(translations[s], params)
    }
    if(typeof defaultTranslations != "undefined" && defaultTranslations[s]) {
      return _getTrans(defaultTranslations[s], params)
    }
    var key_pattern = /^i\./g;
    if(key_pattern.exec(s) != null) {
      return null
    }else {
      return s
    }
  };
  var _getTrans = function(trans, params) {
    if(typeof params != "object") {
      return trans
    }
    for(var key in params) {
      var stringToReplace = "#{" + key + "}";
      if(trans.indexOf(stringToReplace) != -1) {
        trans = trans.replaceAll(stringToReplace, params[key])
      }
    }
    return trans
  };
  var getLanguage = function() {
    return language
  };
  return{init:init, getTrans:getTrans, getLanguage:getLanguage}
}(VISH, jQuery);
var VISH = VISH || {};
VISH.Constant = VISH.Constant || {};
VISH.Constant.Event = {};
VISH.Constant.Event.onMessage = "onMessage";
VISH.Constant.Event.onGoToSlide = "onGoToSlide";
VISH.Constant.Event.onPlayVideo = "onPlayVideo";
VISH.Constant.Event.onPauseVideo = "onPauseVideo";
VISH.Constant.Event.onSeekVideo = "onSeekVideo";
VISH.Constant.Event.onFlashcardPointClicked = "onFlashcardPointClicked";
VISH.Constant.Event.onFlashcardSlideClosed = "onFlashcardSlideClosed";
VISH.Constant.Event.onSetSlave = "onSetSlave";
VISH.Constant.Event.onPreventDefault = "onPreventDefault";
VISH.Constant.Event.allowExitWithoutConfirmation = "allowExitWithoutConfirmation";
VISH.Constant.Event.onSelectedSlides = "onSelectedSlides";
VISH.Constant.Event.onVEFocusChange = "onVEFocusChange";
VISH.Constant.Event.onIframeMessengerHello = "onIframeMessengerHello";
VISH.IframeAPI = function(V, undefined) {
  var helloAttempts;
  var maxHelloAttempts = 15;
  var helloTimeout;
  var options;
  var listeners;
  var init = function(initOptions) {
    options = initOptions;
    if(window.addEventListener) {
      window.addEventListener("message", _onWrapperedVEMessage, false)
    }else {
      if(el.attachEvent) {
        window.attachEvent("message", _onWrapperedVEMessage)
      }
    }
    listeners = new Array;
    _startHelloExchange()
  };
  var _startHelloExchange = function() {
    registerCallback(VISH.Constant.Event.onIframeMessengerHello, function(origin) {
      if(helloTimeout) {
        clearTimeout(helloTimeout)
      }
      _applyOptions(origin);
      if(options && typeof options.callback === "function") {
        options.callback(origin)
      }
    });
    helloAttempts = 0;
    helloTimeout = setInterval(function() {
      _sayHello()
    }, 1E3);
    _sayHello()
  };
  var _sayHello = function() {
    var helloMessage = _createMessage(VISH.Constant.Event.onIframeMessengerHello);
    sendMessage(helloMessage, "*");
    helloAttempts++;
    if(helloAttempts >= maxHelloAttempts && helloTimeout) {
      clearTimeout(helloTimeout)
    }
  };
  var _sendPreventDefaults = function(preventDefaults, destination) {
    var params = {};
    params.preventDefaults = preventDefaults;
    var VEMessage = _createMessage(VISH.Constant.Event.onPreventDefault, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var _applyOptions = function(destination) {
    if(options) {
      if(options.preventDefault === true) {
        _sendPreventDefaults(true, destination)
      }
    }
  };
  var registerCallback = function(listenedEvent, callback) {
    if(callback) {
      listeners[listenedEvent] = callback
    }
  };
  var unRegisterCallback = function(listenedEvent) {
    if(listenedEvent in listeners) {
      listeners[listenedEvent] = null
    }
  };
  function message(VEevent, params, origin, destination) {
    this.vishEditor = true;
    this.VEevent = VEevent;
    if(params) {
      this.params = params
    }
    if(origin) {
      this.origin = origin
    }else {
      this.origin = "?"
    }
    if(destination) {
      this.destination = destination
    }else {
      this.destination = "*"
    }
  }
  var _createMessage = function(VEevent, params, origin, destination) {
    var VEMessage = new message(VEevent, params, origin, destination);
    return JSON.stringify(VEMessage)
  };
  var _validateVEMessage = function(VEMessage) {
    if(typeof VEMessage !== "string") {
      return false
    }
    try {
      var VEMessageObject = JSON.parse(VEMessage);
      if(typeof VEMessageObject !== "object") {
        return false
      }
      if(VEMessageObject.vishEditor !== true) {
        return false
      }
      if(!VEMessageObject.VEevent) {
        return false
      }
    }catch(e) {
      return false
    }
    return true
  };
  var sendMessage = function(VEMessage, destination) {
    if(typeof destination === "string") {
      if(destination === "*") {
        _broadcastMessage(VEMessage)
      }else {
        var iframe = document.getElementById(destination);
        if(iframe && iframe.contentWindow) {
          iframe.contentWindow.postMessage(VEMessage, "*")
        }
      }
    }else {
      if(_isArray(destination) && typeof destination[0] == "string") {
        for(var i = 0;i < destination.length;i++) {
          var iframe = document.getElementById(destination[i]);
          if(iframe && iframe.contentWindow) {
            iframe.contentWindow.postMessage(VEMessage, "*")
          }
        }
      }else {
        _broadcastMessage(VEMessage)
      }
    }
  };
  var _broadcastMessage = function(VEMessage) {
    var allVEIframes = document.querySelectorAll(".vishEditorIframe");
    for(var i = 0;i < allVEIframes.length;i++) {
      allVEIframes[i].contentWindow.postMessage(VEMessage, "*")
    }
  };
  var _onWrapperedVEMessage = function(wrapperedVEMessage) {
    if(wrapperedVEMessage) {
      if(_validateVEMessage(wrapperedVEMessage.data)) {
        _processVEMessage(wrapperedVEMessage.data)
      }
    }
  };
  var _processVEMessage = function(VEMessage) {
    var VEMessageObject = JSON.parse(VEMessage);
    if(listeners[VISH.Constant.Event.onMessage]) {
      listeners[VISH.Constant.Event.onMessage](VEMessage, VEMessageObject.origin)
    }
    var callback = listeners[VEMessageObject.VEevent];
    if(!callback) {
      return
    }
    switch(VEMessageObject.VEevent) {
      case VISH.Constant.Event.onGoToSlide:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onPlayVideo:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onPauseVideo:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onSeekVideo:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onFlashcardPointClicked:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onFlashcardSlideClosed:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onVEFocusChange:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.focus, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onIframeMessengerHello:
        callback(VEMessageObject.origin);
        break;
      default:
        _print("VISH.Messenger.Proceesor Error: Unrecognized event: " + VEMessageObject.VEevent);
        break
    }
  };
  var goToSlide = function(slideNumber, destination) {
    var params = {};
    params.slideNumber = slideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onGoToSlide, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var playVideo = function(videoId, currentTime, videoSlideNumber, destination) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onPlayVideo, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var pauseVideo = function(videoId, currentTime, videoSlideNumber, destination) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onPauseVideo, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var seekVideo = function(videoId, currentTime, videoSlideNumber, destination) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onSeekVideo, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var openSlideInFlashcard = function(flashcardSlideNumber, slideNumber, destination) {
    var params = {};
    params.flashcardSlideNumber = flashcardSlideNumber;
    params.slideNumber = slideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onFlashcardPointClicked, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var closeSlideInFlashcard = function(flashcardSlideNumber, slideNumber, destination) {
    var params = {};
    params.flashcardSlideNumber = flashcardSlideNumber;
    params.slideNumber = slideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onFlashcardSlideClosed, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var setSlave = function(slave, destination) {
    var params = {};
    params.slave = slave;
    var VEMessage = _createMessage(VISH.Constant.Event.onSetSlave, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var setMaster = function(master) {
    var params = {};
    var allVEIframes = document.querySelectorAll(".vishEditorIframe");
    for(var i = 0;i < allVEIframes.length;i++) {
      if(allVEIframes[i].id !== master) {
        params.slave = true
      }else {
        params.slave = false
      }
      var destination = allVEIframes[i].id;
      var VEMessage = _createMessage(VISH.Constant.Event.onSetSlave, params, null, destination);
      sendMessage(VEMessage, destination)
    }
  };
  var allowExitWithoutConfirmation = function(destination) {
    var params = {};
    var VEMessage = _createMessage(VISH.Constant.Event.allowExitWithoutConfirmation, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var _print = function(objectToPrint) {
    if(console && console.log) {
      console.log(objectToPrint)
    }
  };
  var _isArray = function(object) {
    if(typeof object !== "undefined") {
      return object.constructor === Array
    }
    return false
  };
  return{init:init, registerCallback:registerCallback, unRegisterCallback:unRegisterCallback, sendMessage:sendMessage, setSlave:setSlave, setMaster:setMaster, allowExitWithoutConfirmation:allowExitWithoutConfirmation, goToSlide:goToSlide, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, openSlideInFlashcard:openSlideInFlashcard, closeSlideInFlashcard:closeSlideInFlashcard}
}(VISH);
VISH.ImagePlayer = function() {
  var reloadGifs = function(slide) {
    var imgs = $(slide).find("img");
    $.each(imgs, function(index, img) {
      var ext = V.Object.getExtensionFromSrc($(img).attr("src"));
      if(ext === "gif") {
        $(img).attr("src", $(img).attr("src"))
      }
    })
  };
  return{reloadGifs:reloadGifs}
}(VISH, jQuery);
VISH.Messenger.Helper = function(V, undefined) {
  function message(VEevent, params, origin, destination) {
    this.vishEditor = true;
    this.VEevent = VEevent;
    if(params) {
      this.params = params
    }
    if(origin) {
      this.origin = origin
    }else {
      this.origin = "?"
    }
    if(destination) {
      this.destination = destination
    }else {
      this.destination = "*"
    }
  }
  var createMessage = function(VEevent, params, origin, destination) {
    if(!origin) {
      if(V.Status.getIsInIframe() && V.Status.getIframe() != null) {
        origin = V.Status.getIframe().id
      }
    }
    var VEMessage = new message(VEevent, params, origin, destination);
    return JSON.stringify(VEMessage)
  };
  var validateVEMessage = function(VEMessage, params) {
    if(typeof VEMessage !== "string") {
      return false
    }
    try {
      var VEMessageObject = JSON.parse(VEMessage);
      if(typeof VEMessageObject !== "object") {
        return false
      }
      if(VEMessageObject.vishEditor !== true) {
        return false
      }
      if(!VEMessageObject.VEevent) {
        return false
      }
      if(V.Status.getIsInIframe() && V.Status.getIframe() != null && params && params.allowSelfMessages === false) {
        if(VEMessageObject.origin === V.Status.getIframe().id) {
          return false
        }
      }
      if(typeof VEMessageObject.origin != "undefined" && VEMessageObject.origin !== "?") {
        if($.contains(document, $("#" + VEMessageObject.origin)[0])) {
          return false
        }
      }
    }catch(e) {
      return false
    }
    return true
  };
  var processVEMessage = function(VEMessage) {
    var VEMessageObject = JSON.parse(VEMessage);
    switch(VEMessageObject.VEevent) {
      case V.Constant.Event.onGoToSlide:
        if(VEMessageObject.params && VEMessageObject.params.slideNumber) {
          V.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
        }
        break;
      case V.Constant.Event.onPlayVideo:
        if(VEMessageObject.params && VEMessageObject.params.videoId) {
          if(VEMessageObject.params.slideNumber && V.Slides.getCurrentSlideNumber() != VEMessageObject.params.slideNumber) {
            V.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
          }
          V.VideoPlayer.playVideo(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, false)
        }
        break;
      case V.Constant.Event.onPauseVideo:
        if(VEMessageObject.params && VEMessageObject.params.videoId) {
          if(VEMessageObject.params.slideNumber && V.Slides.getCurrentSlideNumber() != VEMessageObject.params.slideNumber) {
            V.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
          }
          V.VideoPlayer.pauseVideo(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, false)
        }
        break;
      case V.Constant.Event.onSeekVideo:
        if(VEMessageObject.params && VEMessageObject.params.videoId) {
          if(VEMessageObject.params.slideNumber && V.Slides.getCurrentSlideNumber() != VEMessageObject.params.slideNumber) {
            V.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
          }
          V.VideoPlayer.seekVideo(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, false)
        }
        break;
      case V.Constant.Event.onFlashcardPointClicked:
        if(VEMessageObject.params && VEMessageObject.params.slideNumber) {
          V.Slides.openSubslide(VEMessageObject.params.slideNumber, false)
        }
        break;
      case V.Constant.Event.onFlashcardSlideClosed:
        if(VEMessageObject.params && VEMessageObject.params.slideNumber) {
          V.Slides.closeSubslide(VEMessageObject.params.slideNumber, false)
        }
        break;
      case V.Constant.Event.onSetSlave:
        if(VEMessageObject.params && typeof VEMessageObject.params.slave != "undefined") {
          V.Status.setSlaveMode(VEMessageObject.params.slave)
        }
        break;
      case V.Constant.Event.onPreventDefault:
        if(VEMessageObject.params && typeof VEMessageObject.params.preventDefaults != "undefined") {
          V.Status.setPreventDefaultMode(VEMessageObject.params.preventDefaults)
        }
        break;
      case V.Constant.Event.allowExitWithoutConfirmation:
        V.Editor.Events.allowExitWithoutConfirmation();
        break;
      case V.Constant.Event.onSelectedSlides:
        V.EventsNotifier.notifyEvent(V.Constant.Event.onSelectedSlides, VEMessageObject.params, true);
        break;
      default:
        V.Debugging.log("V.Messenger.Proceesor Error: Unrecognized event: " + VEMessageObject.VEevent);
        break
    }
  };
  return{createMessage:createMessage, processVEMessage:processVEMessage, validateVEMessage:validateVEMessage}
}(VISH, jQuery);
VISH.Object = function(V, $, undefined) {
  var init = function() {
  };
  function objectInfo(wrapper, source, sourceType) {
    this.wrapper = wrapper;
    this.source = source;
    this.type = sourceType
  }
  var getObjectInfo = function(object) {
    var wrapper = null;
    var element = $(object)[0];
    if(typeof element != "undefined") {
      var wrapper = element.tagName
    }
    var source = _getSourceFromObject(object, wrapper);
    var type = _getTypeFromSource(source);
    return new objectInfo(wrapper, source, type)
  };
  var _getSourceFromObject = function(object, wrapper) {
    switch(wrapper) {
      case null:
        return object;
      case "EMBED":
        return $(object).attr("src");
      case "OBJECT":
        if(typeof $(object).attr("src") != "undefined") {
          return $(object).attr("src")
        }
        if(typeof $(object).attr("data") != "undefined") {
          return $(object).attr("data")
        }
        return"source not founded";
      case "IFRAME":
        return $(object).attr("src");
      default:
        V.Debugging.log("Unrecognized object wrapper: " + wrapper);
        return null;
        break
    }
  };
  var _getTypeFromSource = function(source) {
    var http_urls_pattern = /(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    var www_urls_pattern = /(www[.])([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    var youtube_video_pattern = /(http(s)?:\/\/)?(((youtu.be\/)([aA-zZ0-9-]+))|((www.youtube.com\/((watch\?v=)|(embed\/)|(v\/)))([aA-z0-9-Z&=.])+))/g;
    var html5VideoFormats = ["mp4", "webm", "ogg"];
    var imageFormats = ["jpg", "jpeg", "png", "gif", "bmp"];
    if(typeof source != "string") {
      return null
    }
    if(source.match(youtube_video_pattern) != null) {
      return"youtube"
    }
    source = source.split("?")[0];
    var extension = getExtensionFromSrc(source);
    if(imageFormats.indexOf(extension) != "-1") {
      return V.Constant.MEDIA.IMAGE
    }
    if(extension == "swf") {
      return V.Constant.MEDIA.FLASH
    }
    if(extension == "pdf") {
      return V.Constant.MEDIA.PDF
    }
    if(html5VideoFormats.indexOf(extension) != "-1") {
      return V.Constant.MEDIA.HTML5_VIDEO
    }
    if(extension == "json") {
      return V.Constant.MEDIA.JSON
    }
    if(extension == "doc") {
      return V.Constant.MEDIA.DOC
    }
    if(extension == "ppt") {
      return V.Constant.MEDIA.PPT
    }
    if(source.match(http_urls_pattern) != null || source.match(www_urls_pattern) != null) {
      return V.Constant.MEDIA.WEB
    }
    return extension
  };
  var getExtensionFromSrc = function(source) {
    return source.split(".").pop().split("&")[0].toLowerCase()
  };
  return{init:init, getExtensionFromSrc:getExtensionFromSrc, getObjectInfo:getObjectInfo}
}(VISH, jQuery);
VISH.ObjectPlayer = function(V, $, undefined) {
  var loadObject = function(slide) {
    $.each(slide.children(".objectelement"), function(index, value) {
      if($(value).hasClass("youtubeelement")) {
        V.VideoPlayer.Youtube.loadYoutubeObject(slide, value);
        return
      }
      if($(value).attr("objectWrapper").match("^<iframe") !== null && V.Status.isOnline() === false) {
        $(value).html("<img src='" + V.ImagesPath + "/adverts/advert_new_grey_iframe.png'/>");
        return
      }
      var object = $($(value).attr("objectWrapper"));
      $(object).attr("style", $(value).attr("zoomInStyle"));
      $(value).html("<div style='" + $(value).attr("objectStyle") + "'>" + V.Utils.getOuterHTML(object) + "</div>");
      adjustDimensionsAfterZoom($($(value).children()[0]).children()[0])
    })
  };
  var unloadObject = function(slide) {
    $.each($(slide).children(".objectelement"), function(index, value) {
      $(value).html("")
    })
  };
  var aftersetupSize = function() {
    if($(".current").hasClass("object")) {
      loadObject($(".current"))
    }
  };
  var adjustDimensionsAfterZoom = function(objectWithZoom) {
    var parent = $(objectWithZoom).parent();
    var parentHeight = $(parent).height();
    var parentWidth = $(parent).width();
    var zoom = V.Utils.getZoomFromStyle($(objectWithZoom).attr("style"));
    var percentHeight = parentHeight / zoom / parentHeight * 100;
    var percentWidth = parentWidth / zoom / parentWidth * 100;
    $(objectWithZoom).height(percentHeight + "%");
    $(objectWithZoom).width(percentWidth + "%")
  };
  return{loadObject:loadObject, unloadObject:unloadObject, aftersetupSize:aftersetupSize, adjustDimensionsAfterZoom:adjustDimensionsAfterZoom}
}(VISH, jQuery);
VISH.Police = function(V, $, undefined) {
  var init = function() {
  };
  var valid_url_pattern = /((http(s)?:\/\/)|(www[.]))(.*)/g;
  var validateObject = function(object, callback) {
    if(!object) {
      return[false, "Object is null or undefined"]
    }
    if(typeof object == "string" && object.trim() == "") {
      return[false, "Object is an empty string"]
    }
    var objectInfo = V.Object.getObjectInfo(object);
    if(!objectInfo) {
      return[false, "Can't get Object info"]
    }
    if(!objectInfo.source || !objectInfo.type) {
      return[false, "Can't recognize object source"]
    }
    if(objectInfo.source.trim() == "") {
      return[false, "Object source is an empty string"]
    }
    if(typeof callback == "function") {
      _validateUrl(objectInfo.source, callback)
    }
    return[true, "Validation Ok"]
  };
  function _validateUrl(url, callback) {
    _checkUrl(url, function(status) {
      if(status === 404) {
        callback([false, "HTTP 404: Not found"])
      }else {
        callback([true, "Validation Ok"])
      }
    })
  }
  function _checkUrl(url, cb) {
    jQuery.ajax({url:url, dataType:"text", type:"GET", complete:function(xhr) {
      if(typeof cb === "function") {
        cb.apply(this, [xhr.status])
      }
    }})
  }
  var validateFileUpload = function(fileName) {
    if(!fileName) {
      return[false, "Name is null or undefined"]
    }
    if(fileName.trim() == "") {
      return[false, "Name is an empty string"]
    }
    return[true, "Validation Ok"]
  };
  return{init:init, validateObject:validateObject, validateFileUpload:validateFileUpload}
}(VISH, jQuery);
VISH.Presentation = function(V, undefined) {
  var mySlides = null;
  var init = function(slides) {
    mySlides = slides;
    V.Renderer.init();
    for(var i = 0;i < slides.length;i++) {
      V.Renderer.renderSlide(slides[i])
    }
    _finishRenderer()
  };
  var _finishRenderer = function() {
    V.VideoPlayer.HTML5.setVideoEvents();
    V.Slides.updateSlides()
  };
  return{init:init}
}(VISH);
VISH.Quiz.API = function(V, $, undefined) {
  var quizSessionAPIrootURL;
  var init = function(quizSessionAPI) {
    if(typeof quizSessionAPI == "object" && typeof quizSessionAPI.rootURL == "string") {
      quizSessionAPIrootURL = quizSessionAPI.rootURL
    }
  };
  var startQuizSession = function(quizDOM, quizJSON, successCallback, failCallback) {
    if(V.Configuration.getConfiguration().mode === V.Constant.VISH) {
      var send_type = "POST";
      var params = {"quiz":JSON.stringify(quizJSON), "authenticity_token":V.User.getToken()};
      $.ajax({type:send_type, url:quizSessionAPIrootURL, data:params, success:function(data) {
        if(typeof successCallback == "function") {
          successCallback(quizDOM, data)
        }
      }, error:function(error) {
        if(typeof failCallback == "function") {
          failCallback(quizDOM, error)
        }
      }})
    }else {
      if(V.Configuration.getConfiguration()["mode"] == V.Constant.NOSERVER) {
        var quizSessionId = Math.ceil(1E4 * (1 + Math.random())).toString();
        var url = quizSessionAPIrootURL + quizSessionId;
        var quiz_session = {id:quizSessionId, url:url};
        if(typeof successCallback == "function" && typeof failCallback == "function") {
          setTimeout(function() {
            successCallback(quizDOM, quiz_session)
          }, 1E3)
        }
      }
    }
  };
  var closeQuizSession = function(quizSessionId, name, successCallback, failCallback) {
    if(V.Configuration.getConfiguration()["mode"] == V.Constant.VISH) {
      var send_type = "GET";
      var params = {"id":quizSessionId, "authenticity_token":V.User.getToken()};
      if(typeof name == "string" && name.trim() != "") {
        params["name"] = name
      }
      $.ajax({type:send_type, url:quizSessionAPIrootURL + quizSessionId + "/close", data:params, success:function(data) {
        if(typeof successCallback == "function") {
          successCallback(data)
        }
      }, error:function(error) {
        if(typeof failCallback == "function") {
          failCallback(error)
        }
      }})
    }else {
      if(V.Configuration.getConfiguration()["mode"] == V.Constant.NOSERVER) {
        var data = {"processed":"true"};
        if(typeof successCallback == "function" && typeof failCallback == "function") {
          setTimeout(function() {
            successCallback(data)
          }, 1E3)
        }
      }
    }
  };
  var deleteQuizSession = function(quizSessionId, successCallback, failCallback) {
    if(V.Configuration.getConfiguration()["mode"] == V.Constant.VISH) {
      var send_type = "GET";
      var params = {"id":quizSessionId, "authenticity_token":V.User.getToken()};
      $.ajax({type:send_type, url:quizSessionAPIrootURL + quizSessionId + "/delete", data:params, success:function(data) {
        if(typeof successCallback == "function") {
          successCallback(data)
        }
      }, error:function(error) {
        if(typeof failCallback == "function") {
          failCallback(error)
        }
      }})
    }else {
      if(V.Configuration.getConfiguration()["mode"] == V.Constant.NOSERVER) {
        var data = {"processed":"true"};
        if(typeof successCallback == "function") {
          setTimeout(function() {
            successCallback(data)
          }, 1E3)
        }
      }
    }
  };
  var getResults = function(quizSessionId, successCallback, failCallback) {
    if(V.Configuration.getConfiguration()["mode"] == V.Constant.VISH) {
      var send_type = "GET";
      var params = {"id":quizSessionId};
      if(V.User.isLogged()) {
        params["authenticity_token"] = V.User.getToken()
      }
      $.ajax({type:send_type, url:quizSessionAPIrootURL + quizSessionId + "/results.json", data:params, success:function(data) {
        if(typeof successCallback == "function") {
          successCallback(data)
        }
      }, error:function(error) {
        if(typeof failCallback == "function") {
          failCallback(error)
        }
      }})
    }else {
      if(V.Configuration.getConfiguration()["mode"] == V.Constant.NOSERVER) {
        var data = [{"answer":'[{"no":"3","answer":"true"}]', "created_at":"2013-11-26T12:49:34Z", "id":47, "quiz_session_id":31}];
        if(typeof successCallback == "function") {
          setTimeout(function() {
            successCallback(data)
          }, 1E3)
        }
      }
    }
  };
  var sendAnwers = function(answers, quizSessionId, successCallback, failCallback) {
    if(V.Configuration.getConfiguration().mode === V.Constant.VISH) {
      var send_type = "POST";
      var params = {"id":quizSessionId, "answers":JSON.stringify(answers)};
      if(V.User.isLogged()) {
        params["authenticity_token"] = V.User.getToken()
      }
      $.ajax({type:send_type, url:quizSessionAPIrootURL + quizSessionId + "/answer", data:params, success:function(data) {
        if(typeof successCallback == "function") {
          successCallback(data)
        }
      }, error:function(error) {
        if(typeof failCallback == "function") {
          failCallback(error)
        }
      }});
      return null
    }else {
      if(typeof successCallback == "function") {
        setTimeout(function() {
          successCallback()
        }, 1E3)
      }
    }
  };
  return{init:init, startQuizSession:startQuizSession, closeQuizSession:closeQuizSession, deleteQuizSession:deleteQuizSession, getResults:getResults, sendAnwers:sendAnwers}
}(VISH, jQuery);
VISH.Quiz.MC = function(V, $, undefined) {
  var choices = {};
  var init = function() {
    _loadEvents()
  };
  var _loadEvents = function() {
  };
  var render = function(slide, template) {
    var quizId = V.Utils.getId();
    var container = $("<div id='" + quizId + "' class='quizContainer mcContainer' type='" + V.Constant.QZ_TYPE.MCHOICE + "'></div>");
    var multipleAnswer = false;
    var inputType = "radio";
    if(slide.extras && slide.extras.multipleAnswer === true) {
      multipleAnswer = true;
      inputType = "checkbox";
      $(container).attr("multipleAnswer", true)
    }
    var questionWrapper = $("<div class='mc_question_wrapper, mc_question_wrapper_viewer'></div>");
    $(questionWrapper).html(slide.question.wysiwygValue);
    $(container).append(questionWrapper);
    var optionsWrapper = $("<table cellspacing='0' cellpadding='0' class='mc_options'></table>");
    choices[quizId] = [];
    for(var i = 0;i < slide.choices.length;i++) {
      var option = slide.choices[i];
      var optionWrapper = $("<tr class='mc_option' nChoice='" + (i + 1) + "'></tr>");
      var optionBox = $("<td><input class='mc_box' type='" + inputType + "' name='mc_option' value='" + i + "'/></td>");
      var optionIndex = $("<td><span class='mc_option_index mc_option_index_viewer'>" + String.fromCharCode(96 + i + 1) + ") </span></td>");
      var optionText = $("<td><div class='mc_option_text mc_option_text_viewer'></div></td>");
      $(optionText).html(option.wysiwygValue);
      $(optionWrapper).append(optionBox);
      $(optionWrapper).append(optionIndex);
      $(optionWrapper).append(optionText);
      $(optionsWrapper).append(optionWrapper);
      choices[quizId].push(option)
    }
    $(container).append(optionsWrapper);
    var quizButtons = V.Quiz.renderButtons(slide.selfA);
    $(container).append(quizButtons);
    return V.Utils.getOuterHTML(container)
  };
  var onAnswerQuiz = function(quiz) {
    var answeredQuiz = false;
    var quizChoices = choices[$(quiz).attr("id")];
    $(quiz).find("input[name='mc_option']").each(function(index, radioBox) {
      var answerValue = parseInt($(radioBox).attr("value"));
      var choice = quizChoices[answerValue];
      if($(radioBox).is(":checked")) {
        var trAnswer = $("tr.mc_option").has(radioBox);
        if(choice.answer === true) {
          $(trAnswer).addClass("mc_correct_choice")
        }else {
          if(choice.answer === false) {
            $(trAnswer).addClass("mc_wrong_choice")
          }
        }
        answeredQuiz = true
      }
    });
    var trCorrectAnswers = [];
    for(var key in quizChoices) {
      if(quizChoices[key].answer === true) {
        var trCorrect = $(quiz).find("tr.mc_option")[key];
        trCorrectAnswers.push($(quiz).find("tr.mc_option")[key]);
        if(answeredQuiz) {
          $(trCorrect).addClass("mc_correct_choice")
        }
      }
    }
    if(!answeredQuiz) {
      $(trCorrectAnswers).each(function(index, trCorrect) {
        $(trCorrect).find("input[name='mc_option']").attr("checked", "checked")
      })
    }
    disableQuiz(quiz)
  };
  var onRetryQuiz = function(quizDOM) {
    $(quizDOM).find("tr").removeClass("mc_correct_choice");
    $(quizDOM).find("tr").removeClass("mc_wrong_choice");
    $(quizDOM).find("input[name='mc_option']").removeAttr("checked");
    V.Quiz.enableAnswerButton(quizDOM)
  };
  var getReport = function(quiz) {
    var report = {};
    report.answers = [];
    $(quiz).find("input[name='mc_option']").each(function(index, radioBox) {
      if($(radioBox).is(":checked")) {
        report.answers.push({no:(index + 1).toString(), answer:"true"})
      }
    });
    report.empty = report.answers.length === 0;
    return report
  };
  var disableQuiz = function(quiz) {
    $(quiz).find("input[name='mc_option']").attr("disabled", "disabled");
    V.Quiz.disableAnswerButton(quiz)
  };
  return{init:init, render:render, onAnswerQuiz:onAnswerQuiz, onRetryQuiz:onRetryQuiz, getReport:getReport, disableQuiz:disableQuiz}
}(VISH, jQuery);
VISH.Quiz.TF = function(V, $, undefined) {
  var choices = {};
  var init = function() {
    _loadEvents()
  };
  var _loadEvents = function() {
  };
  var render = function(slide, template) {
    var quizId = V.Utils.getId();
    var container = $("<div id='" + quizId + "' class='quizContainer mcContainer' type='" + V.Constant.QZ_TYPE.TF + "'></div>");
    var questionWrapper = $("<div class='mc_question_wrapper, mc_question_wrapper_viewer'></div>");
    $(questionWrapper).html(slide.question.wysiwygValue);
    $(container).append(questionWrapper);
    var optionsWrapper = $("<table cellspacing='0' cellpadding='0' class='tf_options'></table>");
    choices[quizId] = [];
    var newTr = $("<tr class='mc_option tf_head'><td><img src='" + V.ImagesPath + "quiz/checkbox_checked.png' class='tfCheckbox_viewer'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox_wrong.png' class='tfCheckbox_viewer'/></td><td></td><td></td></tr>");
    $(optionsWrapper).prepend(newTr);
    for(var i = 0;i < slide.choices.length;i++) {
      var option = slide.choices[i];
      var optionWrapper = $("<tr class='mc_option' nChoice='" + (i + 1) + "'></tr>");
      var optionBox1 = $("<td><input class='tf_radio' type='radio' name='tf_radio" + i + "' column='true'  /></td>");
      var optionBox2 = $("<td><input class='tf_radio' type='radio' name='tf_radio" + i + "' column='false' /></td>");
      var optionIndex = $("<td><span class='mc_option_index mc_option_index_viewer'>" + String.fromCharCode(96 + i + 1) + ") </span></td>");
      var optionText = $("<td><div class='mc_option_text mc_option_text_viewer'></div></td>");
      $(optionText).html(option.wysiwygValue);
      $(optionWrapper).append(optionBox1);
      $(optionWrapper).append(optionBox2);
      $(optionWrapper).append(optionIndex);
      $(optionWrapper).append(optionText);
      $(optionsWrapper).append(optionWrapper);
      choices[quizId].push(option)
    }
    $(container).append(optionsWrapper);
    var quizButtons = V.Quiz.renderButtons(slide.selfA);
    $(container).append(quizButtons);
    return V.Utils.getOuterHTML(container)
  };
  var onAnswerQuiz = function(quiz) {
    var quizChoices = choices[$(quiz).attr("id")];
    $(quiz).find("tr.mc_option").not(".tf_head").each(function(index, tr) {
      var trueRadio = $(tr).find("input[type='radio'][column='true']")[0];
      var falseRadio = $(tr).find("input[type='radio'][column='false']")[0];
      var myAnswer;
      if($(trueRadio).is(":checked")) {
        myAnswer = true
      }else {
        if($(falseRadio).is(":checked")) {
          myAnswer = false
        }else {
          myAnswer = undefined
        }
      }
      var choice = quizChoices[index];
      var trChoice = $(quiz).find("tr.mc_option").not(".tf_head")[index];
      if(myAnswer === choice.answer) {
        $(trChoice).addClass("mc_correct_choice")
      }else {
        if(typeof myAnswer != "undefined") {
          $(trChoice).addClass("mc_wrong_choice")
        }else {
          if(choice.answer === true) {
            $(trueRadio).attr("checked", true)
          }else {
            if(choice.answer === false) {
              $(falseRadio).attr("checked", true)
            }
          }
        }
      }
    });
    disableQuiz(quiz)
  };
  var onRetryQuiz = function(quizDOM) {
    $(quizDOM).find("tr").removeClass("mc_correct_choice");
    $(quizDOM).find("tr").removeClass("mc_wrong_choice");
    $(quizDOM).find("input[type='radio']").removeAttr("checked");
    V.Quiz.enableAnswerButton(quizDOM)
  };
  var getReport = function(quiz) {
    var report = {};
    report.answers = [];
    report.empty = true;
    $(quiz).find("tr.mc_option").not(".tf_head").each(function(index, tr) {
      var trueRadio = $(tr).find("input[type='radio'][column='true']")[0];
      var falseRadio = $(tr).find("input[type='radio'][column='false']")[0];
      if($(trueRadio).is(":checked")) {
        report.answers.push({no:(index + 1).toString(), answer:"true"});
        report.empty = false
      }else {
        if($(falseRadio).is(":checked")) {
          report.answers.push({no:(index + 1).toString(), answer:"false"});
          report.empty = false
        }else {
          report.answers.push({no:(index + 1).toString(), answer:"none"})
        }
      }
    });
    return report
  };
  var disableQuiz = function(quiz) {
    $(quiz).find("input[type='radio']").attr("disabled", "disabled");
    V.Quiz.disableAnswerButton(quiz)
  };
  return{init:init, render:render, onAnswerQuiz:onAnswerQuiz, onRetryQuiz:onRetryQuiz, getReport:getReport, disableQuiz:disableQuiz}
}(VISH, jQuery);
var VISH = VISH || {};
VISH.Constant = VISH.Constant || {};
VISH.Constant.QZ_TYPE = VISH.Constant.QZ_TYPE || {};
VISH.Constant.QZ_TYPE.OPEN = "open";
VISH.Constant.QZ_TYPE.MCHOICE = "multiplechoice";
VISH.Constant.QZ_TYPE.TF = "truefalse";
VISH.QuizCharts = function(V, $, undefined) {
  var pieBackgroundColor = ["#F38630", "#E0E4CC", "#69D2E7", "#FFF82A", "#FF0FB4", "#2A31FF", "#FF6075", "#00D043"];
  var pieLetterColor = ["#000"];
  var choices = {};
  var language = "en";
  var i18n = {"es":{"i.T":"V", "i.F":"F"}, "default":{"i.T":"T", "i.F":"F"}};
  var translations = i18n["default"];
  var init = function(options) {
    if(options && options.lang) {
      language = options.lang
    }
    if(i18n[language]) {
      translations = i18n[language]
    }
  };
  var _getTrans = function(s, params) {
    if(translations[s]) {
      return _getTransWithParams(translations[s], params)
    }
    return _getTransWithParams(i18n["default"][s], params)
  };
  var _getTransWithParams = function(trans, params) {
    if(typeof params != "object") {
      return trans
    }
    for(var key in params) {
      var stringToReplace = "#{" + key + "}";
      if(trans.indexOf(stringToReplace) != -1) {
        trans = trans.replaceAll(stringToReplace, params[key])
      }
    }
    return trans
  };
  var drawQuizChart = function(canvas, quizJSON, results, options) {
    var quizParams = _getQuizParams(quizJSON);
    var answersList = _getAnswers(results);
    switch(quizParams.quizType) {
      case V.Constant.QZ_TYPE.OPEN:
        break;
      case V.Constant.QZ_TYPE.MCHOICE:
        if(quizParams.extras.multipleAnswer == true) {
          _drawMcChoiceMAnswerQuizChart(canvas, quizParams, answersList, options)
        }else {
          _drawMcChoiceQuizChart(canvas, quizParams, answersList, options)
        }
        break;
      case V.Constant.QZ_TYPE.TF:
        _drawTFQuizChart(canvas, quizParams, answersList, options);
        break;
      default:
        return null;
        break
    }
  };
  var _drawMcChoiceQuizChart = function(canvas, quizParams, answersList, options) {
    var pieFragments = [];
    var data = [];
    var choicesQuantity = quizParams.choices.length;
    var pBCL = pieBackgroundColor.length;
    var pLCL = pieLetterColor.length;
    for(var i = 0;i < choicesQuantity;i++) {
      pieFragments[i] = {};
      pieFragments[i].value = 0;
      pieFragments[i].label = String.fromCharCode(96 + i + 1);
      pieFragments[i].color = pieBackgroundColor[i % pBCL];
      pieFragments[i].labelColor = pieLetterColor[i % pLCL];
      pieFragments[i].labelFontSize = "16";
      pieFragments[i].tooltipLabel = _purgeString(quizParams.choices[i].value)
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var index = answer.no - 1;
        if(answer.answer === "true" && pieFragments[index]) {
          pieFragments[index].value++
        }
      }
    }
    for(var i = 0;i < choicesQuantity;i++) {
      data.push(pieFragments[i])
    }
    var ctx = $(canvas).get(0).getContext("2d");
    var chartOptions = {showTooltips:true, animation:false};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Pie(data, chartOptions);
    if(options && options.animation != true && typeof options.callback == "function") {
      options.callback()
    }
  };
  var _drawMcChoiceMAnswerQuizChart = function(canvas, quizParams, answersList, options) {
    var labels = [];
    var tooltipLabels = [];
    var data = [];
    var choicesQuantity = quizParams.choices.length;
    var maxValue = 0;
    var scaleSteps = 10;
    for(var i = 0;i < choicesQuantity;i++) {
      labels[i] = String.fromCharCode(96 + i + 1);
      tooltipLabels[i] = _purgeString(quizParams.choices[i].value);
      data[i] = 0
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var index = answer.no - 1;
        if(answer.answer === "true") {
          data[index]++
        }
      }
    }
    for(var l = 0;l < choicesQuantity;l++) {
      if(data[l] > maxValue) {
        maxValue = data[l]
      }
    }
    if(maxValue < 10) {
      scaleSteps = Math.max(1, maxValue)
    }
    var ctx = $(canvas).get(0).getContext("2d");
    var data = {labels:labels, tooltipLabels:tooltipLabels, datasets:[{fillColor:"#E2FFE3", strokeColor:"rgba(220,220,220,1)", data:data}]};
    var chartOptions = {showTooltips:true, animation:false, scaleOverride:true, scaleStepWidth:Math.max(1, Math.ceil(maxValue / 10)), scaleSteps:scaleSteps};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Bar(data, chartOptions);
    if(options && options.animation != true && typeof options.callback == "function") {
      options.callback()
    }
  };
  var _drawTFQuizChart = function(canvas, quizParams, answersList, options) {
    var labels = [];
    var tooltipLabels = [];
    var dataTrue = [];
    var dataFalse = [];
    var choicesQuantity = quizParams.choices.length;
    var maxValue = 0;
    var scaleSteps = 10;
    for(var i = 0;i < choicesQuantity;i++) {
      labels[i] = _getTrans("i.T") + "       " + String.fromCharCode(96 + i + 1) + "       " + _getTrans("i.F");
      tooltipLabels[i] = _purgeString(quizParams.choices[i].value);
      dataTrue[i] = 0;
      dataFalse[i] = 0
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var index = answer.no - 1;
        if(answer.answer === "true") {
          dataTrue[index]++
        }else {
          dataFalse[index]++
        }
      }
    }
    for(var l = 0;l < choicesQuantity;l++) {
      if(dataTrue[l] > maxValue) {
        maxValue = dataTrue[l]
      }
      if(dataFalse[l] > maxValue) {
        maxValue = dataFalse[l]
      }
    }
    if(maxValue < 10) {
      scaleSteps = Math.max(1, maxValue)
    }
    var ctx = $(canvas).get(0).getContext("2d");
    var data = {labels:labels, tooltipLabels:tooltipLabels, datasets:[{fillColor:"#E2FFE3", strokeColor:"rgba(220,220,220,1)", data:dataTrue}, {fillColor:"#FFE2E2", strokeColor:"rgba(220,220,220,1)", data:dataFalse}]};
    var chartOptions = {showTooltips:true, animation:false, scaleOverride:true, scaleStepWidth:Math.max(1, Math.ceil(maxValue / 10)), scaleSteps:scaleSteps};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Bar(data, chartOptions);
    if(options && options.animation != true && typeof options.callback == "function") {
      options.callback()
    }
  };
  var _getAnswers = function(results) {
    var answers = [];
    var rL = results.length;
    for(var i = 0;i < rL;i++) {
      answers.push(JSON.parse(results[i].answer))
    }
    return answers
  };
  var _getQuizParams = function(quiz) {
    var params = {};
    params.extras = {};
    try {
      var quizEl = quiz["slides"][0]["elements"][0];
      params.quizType = quizEl["quiztype"];
      if(params.quizType == V.Constant.QZ_TYPE.MCHOICE) {
        if(quizEl.extras && quizEl.extras.multipleAnswer == true) {
          params.extras.multipleAnswer = true
        }
      }
      params.choices = quiz["slides"][0]["elements"][0]["choices"];
      params.nAnswers = params.choices.length
    }catch(e) {
    }
    return params
  };
  var _purgeString = function(str) {
    if(typeof str != "string") {
      return str
    }
    return str.replace(/\u00c2/g, "")
  };
  return{init:init, drawQuizChart:drawQuizChart}
}(VISH, jQuery);
VISH.Recommendations = function(V, $, undefined) {
  var url_to_get_recommendations;
  var user_id;
  var presentation_id;
  var generated;
  var _isRecVisible;
  var init = function(options) {
    user_id = V.User.getId();
    presentation_id = V.Viewer.getCurrentPresentation().id;
    _isRecVisible = false;
    if(options && options["urlToGetRecommendations"]) {
      url_to_get_recommendations = options["urlToGetRecommendations"]
    }
    generated = false;
    $("#fancyRec").fancybox({"type":"inline", "autoDimensions":false, "scrolling":"no", "autoScale":false, "width":"100%", "height":"100%", "padding":0, "overlayOpacity":0, "onComplete":function(data) {
      $("#fancybox-outer").css("background", "rgba(0,0,0,.7)");
      $("#fancybox-wrap").css("margin-top", "0px");
      V.Slides.triggerLeaveEvent(V.Slides.getCurrentSlideNumber() - 1);
      _isRecVisible = true
    }, "onClosed":function(data) {
      $("#fancybox-outer").css("background", "white");
      $("#fancybox-wrap").css("margin-top", "-14px");
      V.Slides.triggerEnterEvent(V.Slides.getCurrentSlideNumber() - 1);
      _isRecVisible = false
    }})
  };
  var generateFancybox = function() {
    if(!generated) {
      if(V.Configuration.getConfiguration()["mode"] === V.Constant.VISH) {
        if(url_to_get_recommendations !== undefined) {
          var params_to_send = {user_id:user_id, excursion_id:presentation_id, quantity:9};
          $.ajax({type:"GET", url:url_to_get_recommendations, data:params_to_send, success:function(data) {
            _fillFancyboxWithData(data)
          }})
        }
      }else {
        if(V.Configuration.getConfiguration()["mode"] == "noserver") {
          _fillFancyboxWithData(VISH.Samples.API.recommendationList)
        }
      }
    }
  };
  var _fillFancyboxWithData = function(data) {
    if(!data || data.length === 0) {
      return
    }
    var ex;
    var result = "";
    for(var i = data.length - 1;i >= 0;i--) {
      ex = data[i];
      if(V.Status.getIsEmbed()) {
        result += '<a href="' + ex.url + '.full">'
      }
      result += '<div class="rec-excursion" id="recom-' + ex.id + '" number="' + i + '">' + '<ul class="rec-thumbnail">' + '<li class="rec-img-excursion">' + '<img src="' + ex.image + '">' + '<div class="rec-number_pages">' + ex.number_of_slides + "</div>" + "</li>" + '<li class="rec-info-excursion">' + '<div class="rec-title-excursion">' + ex.title + "</div>" + '<div class="rec-by">by <span class="rec-name">' + ex.author + "</span></div>" + '<span class="rec-visits">' + ex.views + '</span> <span class="rec-views">views</span>' + 
      '<div class="rec-likes">' + ex.favourites + '<img class="rec-menu_icon" src="http://vishub.org/assets/icons/star-on10.png"></div>' + "</li>" + "</ul>" + "</div>";
      if(V.Status.getIsEmbed()) {
        result += "</a>"
      }
    }
    $("#fancy_recommendations .rec-grid").html(result);
    generated = true;
    if(!V.Status.getIsEmbed()) {
      for(var i = data.length - 1;i >= 0;i--) {
        $("#recom-" + data[i].id).click(function(my_event) {
          V.Utils.sendParentToURL(data[$(my_event.target).closest(".rec-excursion").attr("number")].url)
        })
      }
    }
  };
  var showFancybox = function() {
    if(V.Utils.getOptions() && V.Utils.getOptions().preview) {
      return
    }
    if(V.Configuration.getConfiguration()["mode"] != V.Constant.NOSERVER && typeof url_to_get_recommendations == "undefined") {
      return
    }
    if(isRecVisible()) {
      return
    }
    $("#fancyRec").trigger("click")
  };
  var isRecVisible = function() {
    return _isRecVisible
  };
  return{init:init, generateFancybox:generateFancybox, showFancybox:showFancybox, isRecVisible:isRecVisible}
}(VISH, jQuery);
VISH.Renderer.Filter = function(V, $, undefined) {
  var init = function() {
  };
  var allowElement = function(element) {
    var device = V.Status.getDevice();
    if(device.desktop) {
      switch(element.type) {
        case "applet":
          return false;
        default:
          return true
      }
    }else {
      if(device.mobile || device.tablet) {
        switch(element.type) {
          case "object":
            var objectInfo = V.Object.getObjectInfo(element.body);
            if(objectInfo.type == "swf") {
              return false
            }else {
              if(objectInfo.type == "youtube") {
                return true
              }
            }
            break;
          case "video":
            return true;
            break;
          case "snapshot":
            return true;
            break;
          case "applet":
            return false;
          default:
            return true
        }
      }
    }
    return true
  };
  var renderContentFiltered = function(element, template) {
    return"<div id='" + element["id"] + "' class='contentfiltered " + template + "_" + element["areaid"] + "'><img class='" + template + "_image' src='" + V.ImagesPath + "adverts/advert_new_grey.png'/></div>"
  };
  return{init:init, allowElement:allowElement, renderContentFiltered:renderContentFiltered}
}(VISH, jQuery);
VISH.SlidesSelector = function(V, $, undefined) {
  var initialized = false;
  var countIndex;
  var acceptButton;
  var nSlides;
  var slides;
  var init = function() {
    if(!initialized) {
      countIndex = $("#ssbsp");
      acceptButton = $("#ssbaccept");
      nSlides = V.Slides.getSlidesQuantity();
      slides = [nSlides];
      _acceptAll();
      _updateIndex();
      _updateAllInterface("accept");
      $("#ssbAll").click(function(event) {
        _acceptAll();
        _updateAllInterface("accept");
        _updateButtonValue(V.Slides.getCurrentSlideNumber());
        _updateIndex()
      });
      $("#ssbuAll").click(function(event) {
        _denyAll();
        _updateAllInterface("deny");
        _updateButtonValue(V.Slides.getCurrentSlideNumber());
        _updateIndex()
      });
      $(acceptButton).click(function(event) {
        var aIndex = V.Slides.getCurrentSlideNumber() - 1;
        if(slides[aIndex] === true) {
          slides[aIndex] = false;
          _updateOneInterface(V.Slides.getCurrentSlide(), "deny")
        }else {
          slides[aIndex] = true;
          _updateOneInterface(V.Slides.getCurrentSlide(), "accept")
        }
        $("#ssbAll").removeClass("selected_inactive");
        $("#ssbuAll").removeClass("selected_inactive");
        _updateButtonValue(V.Slides.getCurrentSlideNumber());
        _updateIndex()
      });
      $("#ssbdone").click(function(event) {
        var params = new Object;
        params.acceptedSlides = _getAcceptedSlides();
        params.JSON = V.Viewer.getCurrentPresentation();
        V.Messenger.notifyEventByMessage(V.Constant.Event.onSelectedSlides, params)
      });
      V.EventsNotifier.registerCallback(V.Constant.Event.onGoToSlide, function(params) {
        _updateButtonValue(params.slideNumber)
      });
      initialized = true
    }
  };
  _acceptAll = function() {
    for(var i = 0;i < nSlides;i++) {
      slides[i] = true
    }
  };
  _denyAll = function() {
    for(var i = 0;i < nSlides;i++) {
      slides[i] = false
    }
  };
  _updateIndex = function() {
    var nAcceptedSlides = _getAcceptedSlides().length;
    $(countIndex).html("+" + nAcceptedSlides);
    if(nAcceptedSlides === 0) {
      $(countIndex).removeClass("selected_n_slides");
      $(countIndex).addClass("selected_zero_slides")
    }else {
      $(countIndex).removeClass("selected_zero_slides");
      $(countIndex).addClass("selected_n_slides")
    }
    $(countIndex).addClass("addslidetrans");
    $(countIndex).addClass("addslidetrans2");
    setTimeout(function() {
      $(countIndex).removeClass("addslidetrans");
      $(countIndex).removeClass("addslidetrans2")
    }, 800)
  };
  _getAcceptedSlides = function() {
    var aSlides = [];
    for(var i = 0;i < nSlides;i++) {
      if(slides[i]) {
        aSlides.push(i + 1)
      }
    }
    return aSlides
  };
  _updateAllInterface = function(status) {
    if(status === "accept") {
      $("#ssbAll").addClass("selected_inactive");
      $("#ssbuAll").removeClass("selected_inactive")
    }else {
      $("#ssbuAll").addClass("selected_inactive");
      $("#ssbAll").removeClass("selected_inactive")
    }
    var all_slides = V.Slides.getSlides();
    for(var i = 0;i < all_slides.length;i++) {
      _updateOneInterface(all_slides[i], status)
    }
  };
  _updateOneInterface = function(the_slide, status) {
    $(the_slide).removeClass("selected_accept");
    $(the_slide).removeClass("selected_deny");
    $(the_slide).addClass("selected_" + status)
  };
  _updateButtonValue = function(slideNumber) {
    var img = $(acceptButton).find("table tr td:nth-child(1) img");
    var span = $(acceptButton).find("table tr td:nth-child(2) span");
    if(slides[slideNumber - 1] === true) {
      $(img).attr("src", V.ImagesPath + "quiz/checkbox_wrong.png");
      $(span).text(V.I18n.getTrans("i.UnselectSlide"))
    }else {
      $(img).attr("src", V.ImagesPath + "quiz/checkbox_checked.png");
      $(span).text(V.I18n.getTrans("i.SelectSlide"))
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.SnapshotPlayer = function(V, $, undefined) {
  var loadSnapshot = function(element) {
    $.each(element.children(".snapshotelement"), function(index, value) {
      var wrapper_class = "snapshot_wrapper" + "_viewer";
      var content_class = "snapshot_content" + "_viewer";
      var content = $(value).attr("objectWrapper");
      if(V.Status.isOnline() === false) {
        $(value).html("<img src='" + V.ImagesPath + "adverts/advert_new_grey_iframe.png'/>");
        return
      }
      var iframe = $(V.Utils.getOuterHTML($(content)));
      $(iframe).removeClass();
      $(iframe).addClass(content_class);
      var scrollTop = $(value).attr("scrollTop");
      var scrollLeft = $(value).attr("scrollLeft");
      $(value).html("<div class='" + wrapper_class + "' style='" + $(value).attr("objectStyle") + "'>" + V.Utils.getOuterHTML(iframe) + "</div>");
      if($(value).attr("zoom")) {
        $(value).find("." + content_class).attr("style", V.Utils.getZoomInStyle($(value).attr("zoom")))
      }
      $(value).find("." + wrapper_class).scrollTop(scrollTop);
      $(value).find("." + wrapper_class).scrollLeft(scrollLeft)
    })
  };
  var unloadSnapshot = function(element) {
    var element = $(".past, .next");
    $.each(element.children(".snapshotelement"), function(index, value) {
      $(value).html("")
    })
  };
  var aftersetupSize = function(increase) {
    $.each($(".snapshot_content_viewer"), function(index, iframe) {
      var area = $(iframe).parent().parent();
      var iframe_wrapper = $(iframe).parent();
      $(area).attr("zoom", increase);
      $(iframe).attr("style", V.Utils.getZoomInStyle(increase));
      var scrollLeft = $(area).attr("scrollLeftOrigin");
      var newScrollLeft = scrollLeft * increase;
      var scrollTop = $(area).attr("scrollTopOrigin");
      var newScrollTop = scrollTop * increase;
      $(area).attr("scrollLeft", newScrollLeft);
      $(area).attr("scrollTop", newScrollTop);
      $(iframe_wrapper).scrollLeft(newScrollLeft);
      $(iframe_wrapper).scrollTop(newScrollTop)
    })
  };
  return{loadSnapshot:loadSnapshot, unloadSnapshot:unloadSnapshot, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Status.Device.Browser = function(V, $, undefined) {
  var init = function() {
  };
  var fillBrowser = function() {
    var browser = {};
    var version;
    var android;
    version = _getInternetExplorerVersion();
    if(version != -1) {
      browser.name = V.Constant.IE;
      browser.version = version;
      return browser
    }
    version = _getFirefoxVersion();
    if(version != -1) {
      browser.name = V.Constant.FIREFOX;
      browser.version = version;
      return browser
    }
    version = _getGoogleChromeVersion();
    if(version != -1) {
      browser.name = V.Constant.CHROME;
      browser.version = version;
      return browser
    }
    android = /android/i.test(navigator.userAgent);
    version = _getSafariVersion();
    if(version != -1) {
      if(android) {
        browser.name = V.Constant.ANDROID_BROWSER
      }else {
        browser.name = V.Constant.SAFARI
      }
      browser.version = version;
      return browser
    }
    browser.name = V.Constant.UNKNOWN;
    browser.version = -1;
    if(android) {
      browser.name = V.Constant.ANDROID_BROWSER
    }
    return browser
  };
  var _getInternetExplorerVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_IE) {
      var ua = navigator.userAgent;
      var re = new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getFirefoxVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      var re = new RegExp(".* Firefox/([0-9.]+)");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getGoogleChromeVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      var re = new RegExp(".* Chrome/([0-9.]+)");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getSafariVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      if(ua.indexOf("Safari") !== -1 && ua.indexOf("Chrome") === -1 && ua.indexOf("crmo") == -1) {
        var rv = -2;
        var re = new RegExp(".* Version/([0-9.]+)");
        if(re.exec(ua) != null) {
          rv = parseFloat(RegExp.$1)
        }
      }
    }
    return rv
  };
  return{init:init, fillBrowser:fillBrowser}
}(VISH, jQuery);
VISH.Status.Device.Features = function(V, $, undefined) {
  var init = function() {
  };
  var fillFeatures = function() {
    var features = {};
    var elem = document.getElementById("page-fullscreen");
    if(elem && (elem.requestFullScreen || elem.mozRequestFullScreen || elem.webkitRequestFullScreen)) {
      features.fullscreen = true
    }else {
      features.fullscreen = false
    }
    features.touchScreen = !!("ontouchstart" in window);
    features.localStorage = V.Storage.checkLocalStorageSupport();
    features.history = typeof history === "object" && typeof history.back === "function" && typeof history.go === "function";
    if(features.history && typeof history.pushState == "function") {
      features.historypushState = true
    }else {
      features.historypushState = false
    }
    if(window.File && window.FileReader && window.FileList && window.Blob) {
      features.reader = true
    }else {
      features.reader = false
    }
    return features
  };
  return{init:init, fillFeatures:fillFeatures}
}(VISH, jQuery);
VISH.Storage = function(V, $, undefined) {
  var _initialized;
  var _testing = false;
  var _isLocalStorageSupported;
  var init = function() {
    if(!_initialized) {
      _isLocalStorageSupported = checkLocalStorageSupport();
      _initialized = true;
      if(_testing) {
        clear();
        _isLocalStorageSupported = false
      }
    }
  };
  var add = function(key, value, persistent) {
    if(!_initialized) {
      init()
    }
    if(_isLocalStorageSupported) {
      persistent = !(persistent === false);
      var myObject = {};
      myObject.value = value;
      myObject.persistent = persistent;
      myObject.version = V.VERSION;
      myObject = JSON.stringify(myObject);
      localStorage.setItem(key, myObject);
      return true
    }else {
      return false
    }
  };
  var get = function(key) {
    if(!_initialized) {
      init()
    }
    if(_isLocalStorageSupported) {
      var myObject = localStorage.getItem(key);
      if(typeof myObject === "string") {
        myObject = JSON.parse(myObject);
        if(myObject && myObject.value) {
          if(!myObject.persistent && myObject.version) {
            var cVersion = parseFloat(V.VERSION);
            var valueVersion = parseFloat(myObject.version);
            if(cVersion > valueVersion) {
              return undefined
            }
          }
          return myObject.value
        }
      }
      return undefined
    }else {
      return undefined
    }
  };
  var addPresentation = function(presentation) {
    if(!_initialized) {
      init()
    }
    if(_isLocalStorageSupported) {
      var list = localStorage.getItem("presentation_list") ? JSON.parse(localStorage.getItem("presentation_list")) : new Array;
      if($.inArray(presentation.id, list) === -1) {
        list.push(presentation.id);
        localStorage.setItem("presentation_list", JSON.stringify(list))
      }
      localStorage.setItem("presentation_" + presentation.id, JSON.stringify(presentation));
      localStorage.setItem("presentation_" + presentation.id + "_url", window.location.href);
      if(presentation.avatar !== undefined) {
        _saveImage(presentation.avatar)
      }
    }else {
    }
  };
  var _saveImage = function(path) {
    if(!_initialized) {
      init()
    }
    if(localStorage.getItem(path) === null && !path.match(/^http/)) {
      var canvas = document.createElement("canvas");
      var ctx = canvas.getContext("2d");
      var img = new Image;
      img.src = path;
      img.onload = function() {
        canvas.width = this.width;
        canvas.height = this.height;
        ctx.drawImage(this, 0, 0, canvas.width, canvas.height);
        var name = img.src.replace(/http:\/\/[^\/]+/i, "");
        localStorage.setItem(name, canvas.toDataURL())
      }
    }
  };
  var checkLocalStorageSupport = function() {
    return typeof Storage !== "undefined"
  };
  var clear = function() {
    localStorage.clear()
  };
  var setTestingMode = function(bolean) {
    _testing = bolean
  };
  return{init:init, add:add, get:get, addPresentation:addPresentation, checkLocalStorageSupport:checkLocalStorageSupport, clear:clear, setTestingMode:setTestingMode}
}(VISH, jQuery);
VISH.Text = function(V, $, undefined) {
  var disableConversion = false;
  var init = function() {
    if(V.Status.getDevice().browser.name === V.Constant.IE && V.Status.getDevice().browser.version < 9) {
      disableConversion = true
    }
    if(disableConversion) {
      return
    }
    _adaptPs($("article > div.VEtextArea > p"));
    _adaptPs($("article div.quizContainer > div > p"));
    _adaptPs($("article div.quizContainer").find("td > p"));
    $("article > div.VEtextArea > table").each(function(index, table) {
      _adaptSpans($(table).find("caption").find("span"));
      $(table).find("td").each(function(index, td) {
        _adaptSpans($(td).find("span"));
        _adaptFonts($(td).find("font"))
      });
      var tableOrgStyle = $(table).attr("style");
      if(tableOrgStyle) {
        var tableStyle = "";
        var tableWidth = V.Utils.getWidthFromStyle(tableOrgStyle);
        if(tableWidth) {
          var percentWidth = tableWidth * 100 / 800;
          tableStyle += "width:" + percentWidth + "%;"
        }
        var tableHeight = V.Utils.getHeightFromStyle(tableOrgStyle);
        if(tableHeight) {
          var percentHeight = tableHeight * 100 / 600;
          tableStyle += "height:" + percentHeight + "%;"
        }
        if(tableStyle !== "") {
          $(table).attr("style", tableStyle)
        }
      }
    })
  };
  var _adaptPs = function(selector) {
    $(selector).each(function(index, p) {
      _setStyleInRem(p);
      _adaptSpans($(p).find("span"));
      _adaptFonts($(p).find("font"))
    })
  };
  var _adaptSpans = function(spans) {
    $(spans).each(function(index, span) {
      var oldStyle = $(span).attr("style");
      if(typeof oldStyle == "undefined") {
        return
      }
      fontSize = parseInt(V.Utils.getFontSizeFromStyle(oldStyle));
      if(typeof fontSize != "number" || isNaN(fontSize)) {
        return
      }
      var rem = fontSize / V.Constant.TextBase + "rem";
      newStyle = V.Utils.addFontSizeToStyle(oldStyle, rem);
      $(span).attr("style", newStyle)
    })
  };
  var _adaptFonts = function(fonts) {
    $(fonts).each(function(index, font) {
      var fSize = $(font).attr("size");
      if(!fSize) {
        return
      }
      var fontSize = parseInt(fSize);
      if(isNaN(fontSize)) {
        return
      }
      $(font).hide();
      var pxfontSize = _font_to_px(fontSize);
      var rem = pxfontSize / V.Constant.TextBase + "rem";
      var span = $("<span style='font-size:" + rem + "'></span>");
      $(span).html($(font).html());
      $(font).parent().prepend(span);
      $(font).remove()
    })
  };
  var _setStyleInRem = function(el) {
    var oldStyle = $(el).attr("style");
    if(typeof oldStyle !== "string") {
      return
    }
    var fontSize = V.Utils.getFontSizeFromStyle(oldStyle);
    if(typeof fontSize != "number" || isNaN(fontSize)) {
      return
    }
    var rem = fontSize / V.Constant.TextBase + "rem";
    var newStyle = V.Utils.addFontSizeToStyle(oldStyle, rem);
    $(el).attr("style", newStyle)
  };
  var aftersetupSize = function(increase) {
    increase = increase * _correctionFactor(increase);
    var reference_font_size = V.Constant.TextBase;
    var texts = $("html");
    $(texts).css("font-size", reference_font_size * increase + "px")
  };
  var _correctionFactor = function(factor) {
    if(factor < 0.25) {
      return 0.5
    }else {
      if(_isInRange(factor, 0.25, 0.3)) {
        return 0.55
      }else {
        if(_isInRange(factor, 0.3, 0.35)) {
          return 0.65
        }else {
          if(_isInRange(factor, 0.35, 0.4)) {
            return 0.7
          }else {
            if(_isInRange(factor, 0.4, 0.5)) {
              return 0.8
            }else {
              if(_isInRange(factor, 0.5, 0.6)) {
                return 0.85
              }else {
                if(_isInRange(factor, 0.6, 0.75)) {
                  return 0.9
                }else {
                  if(_isInRange(factor, 0.75, 0.95)) {
                    return 0.95
                  }else {
                    if(_isInRange(factor, 0.95, 1.5)) {
                      return 1
                    }else {
                      if(factor > 1.5) {
                        return 1
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    return 1
  };
  var _isInRange = function(number, min, max) {
    return number > min && number <= max
  };
  var _font_to_px = function(fz) {
    switch(fz) {
      case 7:
        return 48;
        break;
      case 6:
        return 32;
        break;
      case 5:
        return 24;
        break;
      case 4:
        return 18;
        break;
      case 3:
        return 16;
        break;
      case 2:
        return 14;
        break;
      case 1:
        return 12;
        break;
      default:
        break
    }
  };
  return{init:init, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Themes = function(V, $, undefined) {
  var loadTheme = function(theme, callback) {
    if(!theme) {
      theme = V.Constant.Themes.Default
    }
    _unloadAllThemes();
    V.Utils.Loader.loadCSS("themes/" + theme + ".css", callback)
  };
  var _unloadAllThemes = function() {
    var theme_pattern = "(^" + V.StylesheetsPath + "themes/)";
    $("head").find("link[type='text/css']").each(function(index, link) {
      var href = $(link).attr("href");
      if(href) {
        if(href.match(theme_pattern) !== null) {
          $(link).remove()
        }
      }
    })
  };
  return{loadTheme:loadTheme}
}(VISH, jQuery);
VISH.Tour = function(V, $, undefined) {
  var startTourWithId = function(helpid, tipLocation) {
    _clean();
    var loc;
    if(tipLocation === undefined) {
      loc = "top"
    }else {
      loc = tipLocation
    }
    $(window).joyride({"tipLocation":loc, "tipContent":"#" + helpid, "postRideCallback":_onTourFinish, "postStepCallback":_onStepFinish, "onInitCallback":_onInit})
  };
  var _onInit = function() {
  };
  var _onStepFinish = function(count) {
    _adjustMaxHeightOfCurrentTour()
  };
  var _onTourFinish = function(el) {
    _clean()
  };
  var _clean = function() {
    $(".joyride-tip-guide").each(function() {
      $(this).remove()
    })
  };
  var getCurrentTour = function() {
    var currentJoyride = $(".joyRideCurrent");
    if(currentJoyride.length > 0) {
      return currentJoyride
    }
  };
  var _adjustMaxHeightOfCurrentTour = function() {
    var currentJoyride = getCurrentTour();
    if(typeof currentJoyride != "undefined") {
      var joyRideParent = $(currentJoyride).parent();
      var joyRideWrapper = $(currentJoyride).find(".joyride-content-wrapper");
      var top = $(currentJoyride).cssNumber("top");
      var paddingTop = $(joyRideWrapper).cssNumber("padding-top");
      var paddingBottom = $(joyRideWrapper).cssNumber("padding-bottom");
      var outerPercentage = (top + paddingTop + paddingBottom) * 100 / $(joyRideParent).width();
      var maxHeightPercentage = Math.floor(100 - outerPercentage);
      if(maxHeightPercentage > 1.5) {
        maxHeightPercentage = maxHeightPercentage - 1.5
      }
      $(currentJoyride).css("max-height", maxHeightPercentage + "%");
      if(top === 0) {
        var currentHeightPercentage = $(currentJoyride).height() * 100 / $(window).height();
        currentHeightPercentage = Math.min(currentHeightPercentage, maxHeightPercentage);
        var topPorcentage = (100 - currentHeightPercentage) / 2;
        $(currentJoyride).css("top", topPorcentage + "%")
      }
    }
  };
  return{startTourWithId:startTourWithId, getCurrentTour:getCurrentTour}
}(VISH, jQuery);
VISH.User = function(V, $, undefined) {
  var user;
  var init = function(options) {
    user = new Object;
    if(options["username"]) {
      user.username = options["username"]
    }
    if(options["userId"]) {
      user.id = options["userId"]
    }
    if(options["token"]) {
      user.token = options["token"]
    }
  };
  var isLogged = function() {
    if(user && typeof user.token == "string" && user.id) {
      return true
    }else {
      return false
    }
  };
  var getUser = function() {
    if(user) {
      return user
    }else {
      return null
    }
  };
  var getName = function() {
    if(user && user.username) {
      return user.username
    }else {
      return null
    }
  };
  var getId = function() {
    if(user && user.id) {
      return user.id
    }else {
      return null
    }
  };
  var getToken = function() {
    if(user && user.token) {
      return user.token
    }else {
      return null
    }
  };
  return{init:init, isLogged:isLogged, getUser:getUser, getName:getName, getId:getId, getToken:getToken}
}(VISH, jQuery);
VISH.Utils.Loader = function(V, undefined) {
  var _loadGoogleLibraryCallback = undefined;
  var loadImagesOnContainer = function(imagesArray, containerId, options) {
    if(options.order === true) {
      _loadImagesOnContainerWithOrder(imagesArray, containerId, options)
    }else {
      _loadImagesOnContainer(imagesArray, containerId, options)
    }
  };
  var _loadImagesOnContainer = function(imagesArray, containerId, options) {
    var imagesLength = imagesArray.length;
    var imagesLoaded = 0;
    $.each(imagesArray, function(i, image) {
      $(image).load(function(response) {
        _insertElementOnContainer(image, imagesArray, containerId, options);
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength && typeof options.callback == "function") {
          options.callback()
        }
      });
      $(image).error(function(response) {
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength && typeof options.callback == "function") {
          options.callback()
        }
      })
    })
  };
  var _loadImagesOnContainerWithOrder = function(imagesArray, containerId, options) {
    var validImagesArray = imagesArray;
    var imagesLength = imagesArray.length;
    var imagesLoaded = 0;
    $.each(imagesArray, function(i, image) {
      $(image).load(function(response) {
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength) {
          _insertElementsWithOrder(validImagesArray, containerId, options);
          if(typeof options.callback == "function") {
            options.callback()
          }
        }
      });
      $(image).error(function(response) {
        if(options && options.defaultOnError) {
          var defaultSrc = $(image).attr("defaultsrc");
          if(typeof defaultSrc == "string") {
            $(image).removeAttr("defaultsrc");
            $(image).attr("src", defaultSrc);
            if(typeof options.onImageErrorCallback == "function") {
              options.onImageErrorCallback(image)
            }
            return
          }
        }
        imagesLoaded = imagesLoaded + 1;
        validImagesArray.splice(validImagesArray.indexOf(image), 1);
        if(imagesLoaded == imagesLength) {
          _insertElementsWithOrder(validImagesArray, containerId, options);
          if(typeof options.callback == "function") {
            options.callback()
          }
        }
      })
    })
  };
  var _insertElementsWithOrder = function(imagesArray, containerId, options) {
    $.each(imagesArray, function(i, image) {
      _insertElementOnContainer(image, imagesArray, containerId, options)
    })
  };
  var _insertElementOnContainer = function(image, imagesArray, containerId, options) {
    var titleArray = options.titleArray;
    if(titleArray && titleArray[imagesArray.indexOf(image)]) {
      $("#" + containerId).append("<div><p>" + titleArray[imagesArray.indexOf(image)] + "</p>" + V.Utils.getOuterHTML(image) + "</div>")
    }else {
      $("#" + containerId).append("<div>" + V.Utils.getOuterHTML(image) + "</div>")
    }
  };
  var loadScript = function(scriptSrc, callback) {
    if(typeof scriptSrc !== "string" || typeof callback !== "function") {
      return
    }
    var head = document.getElementsByTagName("head")[0];
    if(head) {
      var script = document.createElement("script");
      script.setAttribute("src", scriptSrc);
      script.setAttribute("type", "text/javascript");
      var loadFunction = function() {
        if(this.readyState == "complete" || this.readyState == "loaded") {
          callback()
        }
      };
      script.onreadystatechange = loadFunction;
      script.onload = callback;
      head.appendChild(script)
    }
  };
  var loadGoogleLibrary = function(scriptSrc, callback) {
    if(typeof callback === "function") {
      _loadGoogleLibraryCallback = callback
    }else {
      return
    }
    var fullScriptSrc = scriptSrc + "&callback=VISH.Utils.Loader.onGoogleLibraryLoaded";
    loadScript(fullScriptSrc, function() {
    })
  };
  var onGoogleLibraryLoaded = function() {
    if(typeof _loadGoogleLibraryCallback === "function") {
      _loadGoogleLibraryCallback()
    }
    _loadGoogleLibraryCallback = undefined
  };
  var loadCSS = function(path, callback) {
    var url = V.StylesheetsPath + path;
    var head = document.getElementsByTagName("head")[0];
    var link = document.createElement("link");
    link.type = "text/css";
    link.rel = "stylesheet";
    link.href = url;
    if(typeof callback == "function") {
      link.onload = function() {
        callback()
      };
      var loadFunction = function() {
        if(this.readyState == "complete" || this.readyState == "loaded") {
          callback()
        }
      };
      link.onreadystatechange = loadFunction
    }
    head.appendChild(link)
  };
  var loadDeviceCSS = function() {
    if(V.Status.getDevice().desktop) {
      loadCSS("device/desktop.css")
    }else {
      if(V.Status.getDevice().mobile) {
        loadCSS("device/mobile.css")
      }else {
        if(V.Status.getDevice().tablet) {
          loadCSS("device/tablet.css")
        }
      }
    }
    switch(V.Status.getDevice().browser.name) {
      case V.Constant.FIREFOX:
        loadCSS("browser/firefox.css");
        break;
      case V.Constant.IE:
        loadCSS("browser/ie.css");
        break;
      case V.Constant.CHROME:
        loadCSS("browser/chrome.css");
        break
    }
  };
  var loadLanguageCSS = function() {
    var languagesWithCSS = ["es"];
    var language = V.I18n.getLanguage();
    if(languagesWithCSS.indexOf(language) != -1) {
      loadCSS("language/" + language + ".css")
    }
  };
  var t1Loading;
  var startLoading = function() {
    if(!_isFullLoadingActive()) {
      t1Loading = Date.now();
      $("#fancyLoad").trigger("click")
    }
  };
  var stopLoading = function(callback) {
    var diff = Date.now() - t1Loading;
    if(diff < 800) {
      setTimeout(function() {
        stopLoading(callback)
      }, 800)
    }else {
      var closed = false;
      if(_isFullLoadingActive()) {
        $.fancybox.close();
        closed = true
      }
      if(typeof callback == "function") {
        callback(closed)
      }
    }
  };
  var onCloseLoading = function() {
    $("#fancybox-outer").css("background", "white")
  };
  var _isFullLoadingActive = function() {
    return $("#loading_fancy").is(":visible")
  };
  var startLoadingInContainer = function(container, options) {
    $(container).html($("#loading_fancy_wrapper").html());
    $(container).addClass("loadingtmpShown");
    if(options && options.style) {
      $(container).find(".loading_fancy_img").addClass(options.style)
    }
  };
  var stopLoadingInContainer = function(container) {
    $(container).find(".loading_fancy_img").parent().remove();
    $(container).removeClass("loadingtmpShown")
  };
  return{loadImagesOnContainer:loadImagesOnContainer, loadScript:loadScript, loadGoogleLibrary:loadGoogleLibrary, loadCSS:loadCSS, loadDeviceCSS:loadDeviceCSS, loadLanguageCSS:loadLanguageCSS, onGoogleLibraryLoaded:onGoogleLibraryLoaded, startLoading:startLoading, stopLoading:stopLoading, onCloseLoading:onCloseLoading, startLoadingInContainer:startLoadingInContainer, stopLoadingInContainer:stopLoadingInContainer}
}(VISH);
VISH.VideoPlayer.CustomPlayer = function(V, $, undefined) {
  var progressBarTimer;
  var init = function() {
  };
  var addCustomPlayerControls = function(videoId, loadEvents) {
    var video = document.getElementById(videoId);
    var customPlayerContainer = $("<div class='customPlayerContainer'>");
    $(video).parent().append(customPlayerContainer);
    $(video).remove();
    $(customPlayerContainer).append(video);
    $(customPlayerContainer).append($("<div class='customPlayerControls'><div class='customPlayerButton customPlayerPlay'></div></div>"));
    $(customPlayerContainer).append($("<div class='customPlayerProgressBar'><div class='progressBarElapsed'></div></div>"));
    var customPlayerControls = $(customPlayerContainer).find("div.customPlayerControls");
    $(customPlayerContainer).attr("style", $(video).attr("style"));
    $(video).attr("style", "width:100%; height:100%;");
    $(customPlayerControls).attr("style", "width: 100%; height:100%;");
    _adjustPlayerControls(customPlayerControls);
    $(video).attr("customPlayerStatus", "ready");
    if(loadEvents) {
      loadCustomPlayerControlEvents(video)
    }
  };
  var _adjustPlayerControls = function(customPlayerControls) {
    var width = $(customPlayerControls).width();
    var height = $(customPlayerControls).height();
    var min_width = 70;
    var originalBackgroundSize = 0.5;
    var icon_width = originalBackgroundSize * width;
    if(icon_width > height) {
      _applyBackgroundSize(customPlayerControls, height / width)
    }else {
      if(icon_width < min_width) {
        _applyBackgroundSize(customPlayerControls, Math.min(1, min_width / width))
      }else {
        _applyBackgroundSize(customPlayerControls, originalBackgroundSize)
      }
    }
  };
  var _applyBackgroundSize = function(customPlayerControls, bs) {
    $(customPlayerControls).find("div.customPlayerButton").css("background-size", bs * 100 + "%")
  };
  var loadCustomPlayerControlEvents = function(video) {
    var customPlayerContainer = $(video).parent();
    var customPlayerControls = $(customPlayerContainer).find("div.customPlayerControls");
    var progressBar = $(customPlayerContainer).parent().find("div.customPlayerProgressBar");
    $(customPlayerControls).bind("click", _onClickCustomPlayerControls);
    $(customPlayerContainer).bind("mouseenter", _onEnterCustomPlayer);
    $(customPlayerContainer).bind("mouseleave", _onLeaveCustomPlayer);
    $(progressBar).bind("click", _onClickProgressBar)
  };
  var _onClickCustomPlayerControls = function(event) {
    event.preventDefault();
    var video = $(this).parent().children()[0];
    onClickVideo(video)
  };
  var _onEnterCustomPlayer = function(event) {
    var video = $(event.target).parent().children()[0];
    if($(video).attr("customPlayerStatus") !== "ready") {
      var progressBar = $(video).parent().find("div.customPlayerProgressBar");
      $(progressBar).show()
    }
  };
  var _onLeaveCustomPlayer = function(event) {
    var progressBar = $(event.target).parent().find("div.customPlayerProgressBar");
    $(progressBar).hide()
  };
  var _startProgressBar = function(video) {
    var progressBar = $(video).parent().find("div.progressBarElapsed");
    var timer = progressBarTimer = setInterval(function() {
      try {
        var ratio = V.VideoPlayer.getCurrentTime(video) / V.VideoPlayer.getDuration(video) * 100;
        $(progressBar).width(ratio + "%");
        if(ratio === 100) {
          clearTimeout(timer)
        }
      }catch(e) {
        clearTimeout(timer)
      }
    }, 400)
  };
  var _onClickProgressBar = function(event) {
    if(V.Status.isSlaveMode()) {
      return
    }
    if($(event.target).hasClass("customPlayerProgressBar")) {
      var progressBar = event.target;
      var elapsed = $(progressBar).find("div.progressBarElapsed")[0]
    }else {
      if($(event.target).hasClass("progressBarElapsed")) {
        var elapsed = event.target;
        var progressBar = $(elapsed).parent()
      }else {
        return
      }
    }
    event.preventDefault();
    event.stopPropagation();
    var video = $(progressBar).parent().children()[0];
    var ratio = (event.pageX - $(progressBar).offset().left) / $(progressBar).outerWidth();
    var seekToPos = Math.round(V.VideoPlayer.getDuration(video) * ratio);
    V.VideoPlayer.seekVideo(video.id, seekToPos, true)
  };
  var onClickVideo = function(video) {
    if(V.Status.isSlaveMode()) {
      return
    }
    switch($(video).attr("customPlayerStatus")) {
      case "ready":
      ;
      case "pause":
        if(!V.Status.isPreventDefaultMode()) {
          onPlayVideo(video)
        }
        V.VideoPlayer.playVideo(video.id, null, true);
        break;
      case "playing":
        if(!V.Status.isPreventDefaultMode()) {
          onPauseVideo(video)
        }
        V.VideoPlayer.pauseVideo(video.id, null, true);
        break;
      default:
        break
    }
  };
  var onPlayVideo = function(video) {
    _startProgressBar(video);
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    var progressBar = $(video).parent().find("div.customPlayerProgressBar");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerButton customPlayerPause");
    $(customPlayerControlsButton).hide();
    $(video).attr("customPlayerStatus", "playing");
    $(progressBar).show()
  };
  var onPauseVideo = function(video) {
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerButton customPlayerPlay");
    $(customPlayerControlsButton).show();
    $(video).attr("customPlayerStatus", "pause")
  };
  var onEndVideo = function(video) {
    $(video).attr("customPlayerStatus", "pause");
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerButton customPlayerReplay");
    $(customPlayerControlsButton).show()
  };
  return{init:init, addCustomPlayerControls:addCustomPlayerControls, loadCustomPlayerControlEvents:loadCustomPlayerControlEvents, onPlayVideo:onPlayVideo, onPauseVideo:onPauseVideo, onEndVideo:onEndVideo}
}(VISH, jQuery);
VISH.VideoPlayer.HTML5 = function(V, $, undefined) {
  var playTriggeredByUser = true;
  var pauseTriggeredByUser = true;
  var seekTriggeredByUser = true;
  var init = function() {
  };
  var setVideoEvents = function() {
    var videos = $("video");
    $.each(videos, function(index, video) {
      video.addEventListener("play", function() {
        var params = new Object;
        params.type = "HTML5";
        params.videoId = video.id;
        params.currentTime = video.currentTime;
        params.slideNumber = V.Slides.getCurrentSlideNumber();
        V.EventsNotifier.notifyEvent(V.Constant.Event.onPlayVideo, params, playTriggeredByUser);
        playTriggeredByUser = true
      }, false);
      video.addEventListener("pause", function() {
        var params = new Object;
        params.type = "HTML5";
        params.videoId = video.id;
        params.currentTime = video.currentTime;
        params.slideNumber = V.Slides.getCurrentSlideNumber();
        V.EventsNotifier.notifyEvent(V.Constant.Event.onPauseVideo, params, pauseTriggeredByUser);
        pauseTriggeredByUser = true
      }, false);
      video.addEventListener("ended", function() {
      }, false);
      video.addEventListener("error", function(err) {
      }, false);
      video.addEventListener("seeked", function(err) {
        var params = new Object;
        params.type = "HTML5";
        params.videoId = video.id;
        params.currentTime = video.currentTime;
        params.slideNumber = V.Slides.getCurrentSlideNumber();
        V.EventsNotifier.notifyEvent(V.Constant.Event.onSeekVideo, params, seekTriggeredByUser);
        seekTriggeredByUser = true
      }, false);
      $(video).focus(function(event) {
        this.blur()
      })
    })
  };
  var playVideos = function(element) {
    var currentVideos = $(element).find("video");
    $.each(currentVideos, function(index, video) {
      if($(video).attr("wasplayingonslideleave") == "true") {
        video.play()
      }else {
        if($(video).attr("wasplayingonslideleave") == "false") {
        }else {
          if(typeof $(video).attr("wasplayingonslideleave") == "undefined") {
            if($(video).attr("autoplayonslideenter") == "true") {
              video.play()
            }
          }
        }
      }
    })
  };
  var stopVideos = function(element) {
    var currentVideos = $(element).find("video");
    $.each(currentVideos, function(index, video) {
      var playing = !video.paused;
      $(video).attr("wasplayingonslideleave", playing);
      if(playing) {
        video.pause()
      }
    })
  };
  var playVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
    if(video.paused) {
      playTriggeredByUser = false;
      video.play()
    }
  };
  var pauseVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
    if(!video.paused) {
      pauseTriggeredByUser = false;
      video.pause()
    }
  };
  var seekVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
  };
  var showControls = function(showControls) {
    var videos = $("video");
    $.each(videos, function(index, video) {
      if(!showControls) {
        $(video).removeAttr("controls")
      }else {
        $(video).attr("controls", true)
      }
    })
  };
  return{init:init, setVideoEvents:setVideoEvents, playVideos:playVideos, stopVideos:stopVideos, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, showControls:showControls}
}(VISH, jQuery);
var youtubePlayers = {};
var YT = YT || {};
YT.PlayerState = YT.PlayerState || {};
YT.PlayerState.UNSTARTED = -1;
YT.PlayerState.ENDED = 0;
YT.PlayerState.PLAYING = 1;
YT.PlayerState.PAUSED = 2;
YT.PlayerState.BUFFERING = 3;
YT.PlayerState.CUED = 5;
function onYouTubeIframeAPIReady() {
}
VISH.VideoPlayer.Youtube = function(V, $, undefined) {
  var init = function() {
  };
  var _isYouTubeIframeAPIReady = function() {
    if(window["YT"]) {
      return true
    }else {
      return false
    }
  };
  var loadYoutubeObject = function(article, zone) {
    if(V.Status.isOnline() === false) {
      $(zone).html("<img src='" + V.ImagesPath + "adverts/advert_new_grey_video.png'/>");
      return
    }
    if(!_isYouTubeIframeAPIReady()) {
      return
    }
    var youtubeVideoId = getYoutubeIdFromURL($(zone).attr("source"));
    if(youtubeVideoId === null) {
      return
    }
    var iframeId = $(zone).attr("ytContainerId");
    $(zone).html("<div id='" + iframeId + "' style='" + $(zone).attr("objectStyle") + "'></div>");
    youtubePlayers[iframeId] = new YT.Player(iframeId, {height:"100%", width:"100%", videoId:youtubeVideoId, playerVars:{"autoplay":0, "controls":0, "enablejsapi":1, "showinfo":0, wmode:"transparent", "rel":0}, events:{"onReady":onPlayerReady, "onStateChange":onPlayerStateChange, "onError":onPlayerError}});
    $("#" + iframeId).attr("wmode", "transparent");
    V.VideoPlayer.CustomPlayer.addCustomPlayerControls(iframeId, false)
  };
  var onPlayerReady = function(event) {
    var iframe = event.target.getIframe();
    V.VideoPlayer.CustomPlayer.loadCustomPlayerControlEvents(iframe)
  };
  var onPlayerStateChange = function(event) {
    var newState = event.data;
    var iframe = event.target.getIframe();
    switch(newState) {
      case -1:
        break;
      case 0:
        V.VideoPlayer.CustomPlayer.onEndVideo(iframe);
        break;
      case 1:
        V.VideoPlayer.CustomPlayer.onPlayVideo(iframe);
        break;
      case 2:
        V.VideoPlayer.CustomPlayer.onPauseVideo(iframe);
        break;
      case 3:
        break;
      case 4:
        break;
      case 5:
        break;
      default:
        break
    }
  };
  var onPlayerError = function(event) {
    V.Debugging.log("onPlayerError with error type " + event.data)
  };
  var playVideo = function(iframeId, currentTime, triggeredByUser) {
    var ytPlayer = youtubePlayers[iframeId];
    if(ytPlayer && ytPlayer.getPlayerState) {
      var params = new Object;
      params.videoId = iframeId;
      params.currentTime = ytPlayer.getCurrentTime();
      params.slideNumber = V.Slides.getCurrentSlideNumber();
      if(triggeredByUser && V.Status.isPreventDefaultMode()) {
        V.Messenger.notifyEventByMessage(V.Constant.Event.onPlayVideo, params);
        return
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onPlayVideo, params, triggeredByUser);
      _seekVideo(ytPlayer, iframeId, currentTime, false);
      if(ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING) {
        ytPlayer.playVideo()
      }
    }
  };
  var pauseVideo = function(iframeId, currentTime, triggeredByUser) {
    var ytPlayer = youtubePlayers[iframeId];
    if(ytPlayer && ytPlayer.getPlayerState) {
      var params = new Object;
      params.videoId = iframeId;
      params.currentTime = ytPlayer.getCurrentTime();
      params.slideNumber = V.Slides.getCurrentSlideNumber();
      if(triggeredByUser && V.Status.isPreventDefaultMode()) {
        V.Messenger.notifyEventByMessage(V.Constant.Event.onPauseVideo, params);
        return
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onPauseVideo, params, triggeredByUser);
      if(ytPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
        ytPlayer.pauseVideo()
      }
      _seekVideo(ytPlayer, iframeId, currentTime, false)
    }
  };
  var seekVideo = function(iframeId, seekTime, triggeredByUser) {
    var ytPlayer = youtubePlayers[iframeId];
    if(ytPlayer && ytPlayer.getPlayerState) {
      _seekVideo(ytPlayer, iframeId, seekTime, triggeredByUser)
    }
  };
  var _seekVideo = function(ytPlayer, iframeId, seekTime, triggeredByUser) {
    var changeCurrentTime = typeof seekTime === "number" && ytPlayer.getCurrentTime() !== seekTime;
    if(changeCurrentTime) {
      var params = new Object;
      params.videoId = iframeId;
      params.currentTime = seekTime;
      params.slideNumber = V.Slides.getCurrentSlideNumber();
      if(triggeredByUser && V.Status.isPreventDefaultMode()) {
        V.Messenger.notifyEventByMessage(V.Constant.Event.onSeekVideo, params);
        return
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onSeekVideo, params, triggeredByUser);
      ytPlayer.seekTo(seekTime)
    }
  };
  var getYoutubeIdFromURL = function(url) {
    var id = null;
    if(!url) {
      return id
    }
    var youtube_video_pattern_1 = /https?:\/\/?youtu.be\/([aA-zZ0-9-]+)/g;
    var youtube_video_pattern_2 = /(https?:\/\/)?(www.youtube.com\/watch\?v=|embed\/)([aA-zZ0-9-]+)[&=.]*/g;
    var youtube_video_pattern_3 = /(https?:\/\/)?(www.youtube.com\/v\/)([aA-zZ0-9-]+)/g;
    var youtube_video_pattern_4 = /(https?:\/\/)?(www.youtube.com\/embed\/)([aA-zZ0-9-]+)/g;
    if(url.match(youtube_video_pattern_1) != null) {
      var result = youtube_video_pattern_1.exec(url);
      if(result && result[1]) {
        id = result[1]
      }
      return id
    }
    if(url.match(youtube_video_pattern_2) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_2.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    if(url.match(youtube_video_pattern_3) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_3.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    if(url.match(youtube_video_pattern_4) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_4.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    return id
  };
  return{init:init, loadYoutubeObject:loadYoutubeObject, onPlayerReady:onPlayerReady, onPlayerStateChange:onPlayerStateChange, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, getYoutubeIdFromURL:getYoutubeIdFromURL}
}(VISH, jQuery);
VISH.Viewer = function(V, $, undefined) {
  var initOptions;
  var current_presentation;
  var init = function(options, presentation) {
    V.Editing = false;
    $("body").addClass("ViSHViewerBody");
    V.Debugging.init(options);
    if(options) {
      initOptions = options
    }else {
      initOptions = {}
    }
    if(options && options["configuration"] && V.Configuration) {
      V.Configuration.init(options["configuration"])
    }
    if(V.Debugging.isDevelopping()) {
      if(options["configuration"]["mode"] === V.Constant.NOSERVER && !presentation && V.Debugging.getPresentationSamples() !== null) {
        presentation = V.Debugging.getPresentationSamples()
      }
    }
    V.Debugging.log("\n\nViSH Viewer init with presentation:\n");
    V.Debugging.log(JSON.stringify(presentation));
    V.Utils.init();
    presentation = V.Utils.fixPresentation(presentation);
    if(presentation === null) {
      V.Utils.showPNotValidDialog();
      return
    }
    current_presentation = presentation;
    V.Status.init(function() {
      _initAferStatusLoaded(options, presentation)
    })
  };
  var _initAferStatusLoaded = function(options, presentation) {
    V.Flashcard.init();
    V.VirtualTour.init();
    V.Quiz.initBeforeRender(presentation);
    V.Renderer.init();
    V.Slides.init();
    V.Utils.Loader.loadDeviceCSS();
    V.I18n.init(options.lang);
    V.Utils.Loader.loadLanguageCSS();
    V.User.init(options);
    V.Storage.init();
    V.Recommendations.init(options);
    V.Events.init();
    V.EventsNotifier.init();
    V.VideoPlayer.init();
    V.Themes.loadTheme(presentation.theme);
    V.Animations.loadAnimation(presentation.animation);
    V.Presentation.init(presentation.slides);
    V.Quiz.init();
    if(options.addons) {
      V.Addons.init(options.addons)
    }
    V.ViewerAdapter.init(options);
    if(V.Slides.getCurrentSlideNumber() > 0) {
      V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
    }
    if(!V.Status.getIsEmbed()) {
      window.focus()
    }
  };
  var toggleFullScreen = function() {
    if(V.Status.isSlaveMode()) {
      return
    }
    if(V.Status.getIsInIframe()) {
      var myDoc = parent.document;
      var myElem = V.Status.getIframe()
    }else {
      var myDoc = document;
      var myElem = myDoc.getElementById("presentation_iframe")
    }
    if(myDoc.fullScreenElement && myDoc.fullScreenElement !== null || !myDoc.mozFullScreen && !myDoc.webkitIsFullScreen) {
      if(myDoc.documentElement.requestFullScreen) {
        myElem.requestFullScreen()
      }else {
        if(myDoc.documentElement.mozRequestFullScreen) {
          myElem.mozRequestFullScreen()
        }else {
          if(myDoc.documentElement.webkitRequestFullScreen) {
            myElem.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)
          }
        }
      }
    }else {
      if(myDoc.cancelFullScreen) {
        myDoc.cancelFullScreen()
      }else {
        if(myDoc.mozCancelFullScreen) {
          myDoc.mozCancelFullScreen()
        }else {
          if(myDoc.webkitCancelFullScreen) {
            myDoc.webkitCancelFullScreen()
          }
        }
      }
    }
  };
  var getOptions = function() {
    return initOptions
  };
  var onSlideEnterViewer = function(e) {
    var slide = e.target;
    var slideType = $(e.target).attr("type");
    var cSlideNumber = V.Slides.getCurrentSlideNumber();
    e.stopPropagation();
    V.ViewerAdapter.decideIfPageSwitcher();
    setTimeout(function() {
      if(cSlideNumber !== V.Slides.getCurrentSlideNumber()) {
        return
      }
      if($(slide).hasClass(V.Constant.OBJECT)) {
        V.ObjectPlayer.loadObject($(slide))
      }
      if($(slide).hasClass(V.Constant.SNAPSHOT)) {
        V.SnapshotPlayer.loadSnapshot($(slide))
      }
    }, 500);
    V.VideoPlayer.HTML5.playVideos(slide);
    if(slideType === V.Constant.FLASHCARD) {
      V.Flashcard.startAnimation(slide.id)
    }else {
      if(slideType === V.Constant.VTOUR) {
        V.VirtualTour.loadVirtualTour(slide.id)
      }
    }
    if(_isRecommendationMoment()) {
      V.Recommendations.generateFancybox()
    }
  };
  var onSlideLeaveViewer = function(e) {
    var slide = e.target;
    var slideType = $(e.target).attr("type");
    e.stopPropagation();
    if($(slide).hasClass(V.Constant.OBJECT)) {
      V.ObjectPlayer.unloadObject($(slide))
    }
    if($(slide).hasClass(V.Constant.SNAPSHOT)) {
      V.SnapshotPlayer.unloadSnapshot($(slide))
    }
    V.VideoPlayer.HTML5.stopVideos(slide);
    if(slideType === V.Constant.FLASHCARD) {
      V.Flashcard.stopAnimation(slide.id)
    }else {
      if(slideType === V.Constant.VTOUR) {
        V.VirtualTour.unloadVirtualTour(slide.id)
      }
    }
  };
  var _isRecommendationMoment = function() {
    var number_of_slides = V.Slides.getSlides().length;
    var slide_number = V.Slides.getCurrentSlideNumber();
    if(number_of_slides === 1 || slide_number === number_of_slides - 1) {
      return true
    }else {
      return false
    }
  };
  var updateSlideCounter = function() {
    var number_of_slides = V.Slides.getSlides().length;
    var slide_number = V.Slides.getCurrentSlideNumber();
    if(number_of_slides === 0) {
      slide_number = 0
    }
    $("#slide-counter-input").val(slide_number);
    $("#slide-counter-span").html("/" + number_of_slides)
  };
  var getCurrentPresentation = function() {
    return current_presentation
  };
  var getPresentationType = function() {
    var cPresentation = getCurrentPresentation();
    if(typeof cPresentation == "object") {
      return cPresentation.type
    }else {
      return undefined
    }
  };
  return{init:init, toggleFullScreen:toggleFullScreen, getOptions:getOptions, updateSlideCounter:updateSlideCounter, getCurrentPresentation:getCurrentPresentation, getPresentationType:getPresentationType, onSlideEnterViewer:onSlideEnterViewer, onSlideLeaveViewer:onSlideLeaveViewer}
}(VISH, jQuery);
VISH.ViewerAdapter = function(V, $, undefined) {
  var render_full;
  var is_preview;
  var is_preview_insertMode;
  var close_button;
  var fs_button;
  var can_use_nativeFs;
  var embed;
  var scorm;
  var showViewbar;
  var isInexternalSite;
  var isInVishSite;
  var enter_fs_button;
  var enter_fs_url;
  var exit_fs_button;
  var exit_fs_url;
  var page_is_fullscreen;
  var initialized = false;
  var _lastWidth;
  var _lastHeight;
  var init = function(options) {
    if(initialized) {
      return
    }else {
      _lastWidth = -1;
      _lastHeight = -1;
      initialized = true
    }
    embed = V.Status.getIsEmbed();
    showViewbar = _defaultViewbar();
    if(options) {
      if(typeof render_full != "boolean") {
        render_full = options["full"] === true && !V.Status.getIsInIframe() || options["forcefull"] === true
      }
      if(typeof options["preview"] == "boolean") {
        is_preview = options["preview"]
      }
      if(typeof options["scorm"] == "boolean") {
        scorm = options["scorm"]
      }
      close_button = V.Status.getDevice().mobile && !V.Status.getIsInIframe() && options["comeBackUrl"];
      can_use_nativeFs = V.Status.getDevice().features.fullscreen;
      enter_fs_button = typeof options["fullscreen"] !== "undefined" && !can_use_nativeFs;
      if(enter_fs_button) {
        enter_fs_url = options["fullscreen"]
      }
      exit_fs_button = typeof options["exitFullscreen"] !== "undefined" && !can_use_nativeFs;
      if(exit_fs_button) {
        exit_fs_url = options["exitFullscreen"]
      }
      fs_button = can_use_nativeFs && V.Status.getIsInIframe() || enter_fs_button && exit_fs_button;
      fs_button = fs_button && !is_preview;
      fs_button = fs_button && !embed;
      page_is_fullscreen = render_full && !V.Status.getIsInIframe()
    }else {
      render_full = false;
      is_preview = false;
      close_button = false;
      enter_fs_button = false;
      exit_fs_button = false;
      fs_button = false;
      can_use_nativeFs = false;
      scorm = false
    }
    isInexternalSite = embed || scorm;
    isInVishSite = !isInexternalSite && V.Configuration.getConfiguration()["mode"] === V.Constant.VISH;
    is_preview_insertMode = false;
    if(is_preview) {
      var presentation = V.Viewer.getCurrentPresentation();
      if(presentation.insertMode === true) {
        is_preview_insertMode = true
      }
    }
    if(V.Status.getDevice().mobile) {
      render_full = true;
      page_is_fullscreen = render_full && !V.Status.getIsInIframe();
      if(page_is_fullscreen) {
        fs_button = false;
        showViewbar = false
      }else {
        close_button = false
      }
    }
    if(V.Status.getDevice().desktop) {
      $("#back_arrow").html("");
      $("#forward_arrow").html("")
    }
    if(showViewbar) {
      V.Viewer.updateSlideCounter();
      $("#viewbar").show()
    }else {
      $("#viewbar").hide()
    }
    if(is_preview) {
      $("div#viewerpreview").show()
    }
    if(is_preview_insertMode) {
      $("#SelectedSlidesToAdd").attr("src", V.ImagesPath + "templatesthumbs/addt.png");
      $("#tutorialSelectAllImage").attr("src", V.ImagesPath + "tutorial/selectall.png");
      $("tutorialUnselectAllImage").attr("src", V.ImagesPath + "tutorial/unselectall.png");
      $("tutorialSelectSlidesImage").attr("src", V.ImagesPath + "tutorial/selectslides.png");
      $("#selectSlidesBar").show();
      $("#viewbar").css("bottom", $("#selectSlidesBar").height() + "px");
      $("#viewbar").css("border-bottom", "none");
      V.SlidesSelector.init()
    }
    if(isInexternalSite) {
      if(options && typeof options.watermarkURL == "string") {
        $("#embedWatermark").parent().attr("href", options.watermarkURL);
        $("#embedWatermark").show()
      }
    }
    if(isInVishSite || V.Configuration.getConfiguration()["mode"] === V.Constant.NOSERVER) {
      $(".rec-first-row").show()
    }else {
      $(".rec-first-row").hide()
    }
    if(close_button) {
      $("button#closeButton").show()
    }
    if(fs_button) {
      _enableFullScreen(page_is_fullscreen);
      $("#page-fullscreen").show()
    }else {
      $("#page-fullscreen").hide()
    }
    updateInterface();
    V.Text.init()
  };
  var decideIfPageSwitcher = function() {
    if(V.Viewer.getPresentationType() === V.Constant.PRESENTATION) {
      if(V.Slides.getCurrentSubSlide() !== null) {
        $("#forward_arrow").hide();
        $("#back_arrow").hide()
      }else {
        if(V.Slides.isCurrentFirstSlide()) {
          $("#back_arrow").hide()
        }else {
          $("#back_arrow").show()
        }
        $("#forward_arrow").show()
      }
    }else {
      if(V.Viewer.getPresentationType() === V.Constant.QUIZ_SIMPLE) {
        $("#forward_arrow").hide()
      }
    }
    if(V.Slides.isCurrentFirstSlide()) {
      $("#page-switcher-start").addClass("disabledarrow")
    }else {
      $("#page-switcher-start").removeClass("disabledarrow")
    }
    $("#page-switcher-end").show()
  };
  var _decideIfViewBarShow = function(fullScreen) {
    if(showViewbar) {
      $("#viewbar").show()
    }else {
      $("#viewbar").hide()
    }
  };
  var _defaultViewbar = function() {
    var presentationType = V.Viewer.getPresentationType();
    var slidesQuantity = V.Slides.getSlidesQuantity();
    if(presentationType === V.Constant.QUIZ_SIMPLE && slidesQuantity === 1) {
      return false
    }else {
      return true
    }
  };
  var updateInterface = function() {
    var cWidth = $(window).width();
    var cHeight = $(window).height();
    if(cWidth === _lastWidth && cHeight === _lastHeight) {
      return
    }
    _lastWidth = cWidth;
    _lastHeight = cHeight;
    _setupSize(render_full)
  };
  var _setupSize = function(fullscreen) {
    var reserved_px_for_menubar = _getDesiredVieweBarHeight(_lastHeight);
    var min_margin_height = 25;
    var min_margin_width = 60;
    if(!showViewbar) {
      reserved_px_for_menubar = 0;
      min_margin_height = 0;
      min_margin_width = 0
    }else {
      if(is_preview_insertMode) {
        reserved_px_for_menubar = 120
      }
    }
    if(fullscreen) {
      _onFullscreenEvent(true)
    }else {
      _onFullscreenEvent(false)
    }
    var height = _lastHeight - reserved_px_for_menubar;
    var width = _lastWidth;
    var finalW = 800;
    var finalH = 600;
    var aspectRatio = (width - min_margin_width) / (height - min_margin_height);
    var slidesRatio = 4 / 3;
    if(aspectRatio > slidesRatio) {
      finalH = height - min_margin_height;
      finalW = finalH * slidesRatio;
      var widthMargin = width - finalW;
      if(widthMargin < min_margin_width) {
        var marginWidthToAdd = min_margin_width - widthMargin;
        finalW = finalW - marginWidthToAdd
      }
    }else {
      finalW = width - min_margin_width;
      finalH = finalW / slidesRatio;
      var heightMargin = height - finalH;
      if(heightMargin < min_margin_height) {
        var marginHeightToAdd = min_margin_height - heightMargin;
        finalH = finalH - marginHeightToAdd
      }
    }
    if(!is_preview_insertMode) {
      $("#viewbar").height(reserved_px_for_menubar)
    }
    var topSlides = $(".slides > article");
    var subSlides = $(".slides > article > article");
    var allSlides = $(".slides article");
    $(allSlides).css("height", finalH);
    $(allSlides).css("width", finalW);
    var marginTop = finalH / 2 + reserved_px_for_menubar / 2;
    var marginLeft = finalW / 2;
    $(topSlides).css("margin-top", "-" + marginTop + "px");
    $(subSlides).css("margin-top", "-" + finalH / 2 + "px");
    $(allSlides).css("margin-left", "-" + marginLeft + "px");
    var increase = finalH / 600;
    var increaseW = finalW / 800;
    var paddingTopAndBottom = 3 / 100 * finalW;
    var paddingLeftAndRight = 5 / 100 * finalW;
    $(allSlides).css("padding-left", paddingLeftAndRight);
    $(allSlides).css("padding-right", paddingLeftAndRight);
    $(allSlides).css("padding-top", paddingTopAndBottom);
    $(allSlides).css("padding-bottom", paddingTopAndBottom);
    $(".fc_poi img").css("width", 50 * increase + "px");
    $(".fc_poi img").css("height", 50 * increase + "px");
    decideIfPageSwitcher();
    updateFancyboxAfterSetupSize();
    V.Text.aftersetupSize(increase, increaseW);
    V.SnapshotPlayer.aftersetupSize(increase, increaseW);
    V.ObjectPlayer.aftersetupSize(increase, increaseW);
    V.VirtualTour.aftersetupSize(increase, increaseW);
    V.Quiz.aftersetupSize(increase, increaseW)
  };
  var _getDesiredVieweBarHeight = function(windowHeight) {
    var minimumViewBarHeight = 20;
    var maxViewBarHeight = 40;
    var viewBarHeight = 40;
    return Math.min(Math.max(viewBarHeight, minimumViewBarHeight), maxViewBarHeight)
  };
  var updateFancyboxAfterSetupSize = function() {
    var fOverlay = $("#fancybox-overlay");
    if($(fOverlay).length < 1 || !$(fOverlay).is(":visible")) {
      return
    }
    var fwrap = $("#fancybox-wrap");
    var fcontent = $("#fancybox-content");
    var fccontentDivs = $("#" + $(fcontent).attr("id") + " > div");
    var currentSlide = $(".current");
    var paddingTop = $(currentSlide).cssNumber("padding-top");
    var paddingLeft = $(currentSlide).cssNumber("padding-left");
    var offset = $(currentSlide).offset();
    var fcClose = $("#fancybox-close");
    $(fcClose).height("22px");
    $(fcClose).css("padding", "10px");
    $(fcClose).css("padding-left", "4px");
    $(fwrap).css("margin-top", "0px");
    $(fwrap).width($(currentSlide).width() + paddingLeft);
    $(fwrap).height($(currentSlide).height() + 2 * paddingTop);
    $(fwrap).css("top", offset.top + "px");
    $(fwrap).css("left", offset.left + "px");
    $(fcontent).width("100%");
    $(fcontent).height("100%");
    $(fccontentDivs).width("100%");
    $(fccontentDivs).height("100%")
  };
  var _enableFullScreen = function(fullscreen) {
    if(can_use_nativeFs) {
      if(V.Status.getIsInIframe()) {
        var myDoc = parent.document
      }else {
        var myDoc = document
      }
      $(document).on("click", "#page-fullscreen", V.Viewer.toggleFullScreen);
      $(myDoc).on("webkitfullscreenchange mozfullscreenchange fullscreenchange", function(event) {
        setTimeout(function() {
          page_is_fullscreen = !page_is_fullscreen;
          render_full = page_is_fullscreen;
          _setupSize(page_is_fullscreen)
        }, 400)
      })
    }else {
      if(fullscreen && exit_fs_button) {
        $("#page-fullscreen").css("background-image", 'url("' + V.ImagesPath + 'vicons/fullscreen.png")');
        $("#page-fullscreen").css("background-position", "0px 0px");
        $(document).on("click", "#page-fullscreen", function() {
          if(exit_fs_url && !embed) {
            window.location = exit_fs_url
          }else {
            if(V.Status.getDevice().features.history) {
              history.back()
            }
          }
        })
      }else {
        if(!fullscreen && enter_fs_button) {
          $(document).on("click", "#page-fullscreen", function() {
            if(typeof window.parent.location.href !== "undefined") {
              V.Utils.sendParentToURL(enter_fs_url + "?orgUrl=" + window.parent.location.href)
            }else {
              V.Utils.sendParentToURL(enter_fs_url + "?embed=true")
            }
          })
        }
      }
    }
  };
  var _onFullscreenEvent = function(fullscreen) {
    if(typeof fullscreen === "undefined") {
      fullscreen = page_is_fullscreen
    }
    if(fullscreen) {
      _onEnterFullScreen()
    }else {
      _onLeaveFullScreen()
    }
  };
  var _onEnterFullScreen = function() {
    $("#page-fullscreen").css("background-image", 'url("' + V.ImagesPath + 'vicons/fullscreenback.png")');
    $("#page-fullscreen").css("background-position", "0px 0px");
    $("#page-fullscreen").hover(function() {
      $("#page-fullscreen").css("background-position", "-30px -40px")
    }, function() {
      $("#page-fullscreen").css("background-position", "0px 0px")
    });
    _decideIfViewBarShow(true)
  };
  var _onLeaveFullScreen = function() {
    $("#page-fullscreen").css("background-image", 'url("' + V.ImagesPath + 'vicons/fullscreen.png")');
    $("#page-fullscreen").css("background-position", "0px 0px");
    $("#page-fullscreen").hover(function() {
      $("#page-fullscreen").css("background-position", "-40px -40px")
    }, function() {
      $("#page-fullscreen").css("background-position", "0px 0px")
    });
    _decideIfViewBarShow(false)
  };
  var isFullScreen = function() {
    return page_is_fullscreen
  };
  var decideIfCloseButton = function() {
    if(close_button) {
      $("#closeButton").show()
    }
  };
  return{init:init, updateInterface:updateInterface, isFullScreen:isFullScreen, decideIfPageSwitcher:decideIfPageSwitcher, decideIfCloseButton:decideIfCloseButton, updateFancyboxAfterSetupSize:updateFancyboxAfterSetupSize}
}(VISH, jQuery);
VISH.VirtualTour = function(V, $, undefined) {
  var virtualTours;
  var gMlLoaded = false;
  var gMlLoading = false;
  var lastIncrease;
  var init = function(presentation) {
    virtualTours = new Array
  };
  var drawMap = function(vtJSON) {
    if(!gMlLoaded && !gMlLoading) {
      gMlLoading = true;
      V.Utils.Loader.loadGoogleLibrary("https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places", function() {
        gMlLoading = false;
        gMlLoaded = true;
        var el = document;
        var evt = document.createEvent("Event");
        evt.initEvent("googleMapsLibraryLoadedinVV", true, true);
        el.dispatchEvent(evt)
      })
    }
    if(!gMlLoaded) {
      $(document).on("googleMapsLibraryLoadedinVV", function() {
        drawMap(vtJSON)
      });
      return
    }
    if(vtJSON.type !== V.Constant.VTOUR) {
      return
    }
    if(typeof virtualTours[vtJSON.id] != "undefined") {
      return
    }
    virtualTours[vtJSON.id] = jQuery.extend({}, vtJSON);
    var canvasId = V.Utils.getId(vtJSON.id + "_canvas");
    var canvas = $("<div id='" + canvasId + "' class='map_canvas' style='height:" + "100%" + "; width:" + "100%" + "'></div>");
    var vtDOM = $("#" + vtJSON.id);
    $(vtDOM).append(canvas);
    $(vtDOM).addClass("temp_shown");
    var center = new google.maps.LatLng(vtJSON.center.lat, vtJSON.center.lng);
    var myOptions = {zoom:parseInt(vtJSON.zoom), center:center, mapTypeId:vtJSON.mapType};
    var map = new google.maps.Map(document.getElementById(canvasId), myOptions);
    virtualTours[vtJSON.id].map = map;
    $(vtJSON.pois).each(function(index, poi) {
      _addMarkerToCoordinates(map, poi.lat, poi.lng, poi.slide_id)
    });
    google.maps.event.addListenerOnce(map, "tilesloaded", function() {
      $(vtDOM).removeClass("temp_shown");
      google.maps.event.addListenerOnce(map, "tilesloaded", function() {
      })
    });
    google.maps.event.addDomListener(map, "idle", function() {
    });
    google.maps.event.addDomListener(window, "resize", function() {
    })
  };
  var loadVirtualTour = function(vtId) {
    var canvas = $("#" + vtId).find(".map_canvas");
    $(canvas).show()
  };
  var unloadVirtualTour = function(vtId) {
    var canvas = $("#" + vtId).find(".map_canvas");
    $(canvas).hide()
  };
  var _addMarkerToCoordinates = function(map, lat, lng, slide_id) {
    return _addMarkerToPosition(map, new google.maps.LatLng(lat, lng), slide_id)
  };
  var _addMarkerToPosition = function(map, myLatlng, slide_id) {
    var pinImage = new google.maps.MarkerImage(V.ImagesPath + "vicons/marker.png", new google.maps.Size(25, 40), new google.maps.Point(0, 0), new google.maps.Point(10, 34));
    var marker = new google.maps.Marker({position:myLatlng, map:map, draggable:false, icon:pinImage, title:"(" + myLatlng.lat().toFixed(3) + "," + myLatlng.lng().toFixed(3) + ")"});
    google.maps.event.addListener(marker, "click", function(event) {
      V.Slides.openSubslide(slide_id, true)
    });
    return marker
  };
  var aftersetupSize = function(increase) {
  };
  var _getZoomForIncreaseDiff = function(zoom, increaseDiff) {
    var absIncreaseDiff = Math.floor(Math.abs(increaseDiff) / 0.3);
    if(increaseDiff > 0) {
      var newZoom = zoom + absIncreaseDiff
    }else {
      var newZoom = zoom - absIncreaseDiff
    }
    return Math.max(Math.min(newZoom, 20), 1)
  };
  return{init:init, drawMap:drawMap, loadVirtualTour:loadVirtualTour, unloadVirtualTour:unloadVirtualTour, aftersetupSize:aftersetupSize}
}(VISH, jQuery);

