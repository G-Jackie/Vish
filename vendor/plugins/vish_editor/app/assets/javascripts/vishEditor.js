var i18n = {"vish":{"es":{"i.walk1":"Puedes utilizar el icono tutorial", "i.walk2":'durante las secciones de la aplicaci\u00f3n para servirte de ayuda a la hora de utilizar el "ViSH editor". De esta manera podras aprender a utilizar el programa desde sus funciones b\u00e1sicas hasta la publicaci\u00f3n final de tu excursi\u00f3n. Pulsa "Siguiente" para continuar.', "i.walk3":'Este espacio te permite a\u00f1adir el t\u00edtulo de tu excursi\u00f3n.El t\u00edtulo de la excursion es obligatorio ya que gracias a el, otros usuarios podran encontrala mas f\u00e1cilmente dentro del ViSH. Pulsa "Siguiente" para continuar.', 
"i.walk4":'En este espacio puedes explicar en mas detalle los conceptos e ideas de tu excursi\u00f3n, as\u00ed como los datos que consideres interesantes para que los usuarios sepan el contenido de esta. Pulsa "Siguiente" para continuar.', "i.walk5":'A\u00f1ade palabras que vayan acorde con el tema de tu excursion para que esta aparezca a la hora de que los usuarios busquen temas dentro del ViSH. Pulsa "Siguiente" para continuar.', "i.walk6":'Escoje una de estas imagenes para representar tu excursion dentro del ViSH.Utiliza las flechas de los laterales o los circulos en la parte inferior de la galer\u00eda para ver todas las imagenes y escojer una. Pulsa "Siguiente" para continuar.', 
"i.walk7":'Una vez que cierres el tutorial pulsando el bot\u00f3n "cerrar", haz click en el boton continuar situado debajo de este. De esta manera salvaras los detalles de tu excursi\u00f3n y podr\u00e1s comenzar a a\u00f1adir contenido a esta.', "i.walk8":'Recuerda que puedes utilizar el icono "tutorial" cada vez que necesites ayuda en la aplicaci\u00f3n. Esta zona, es el escritorio donde crear\u00e1s tus excursiones.Pulsa "Siguiente" para continuar.', "i.walk9":'En esta zona podr\u00e1s ver las opciones principales para crear y editar una excursi\u00f3n virtual dentro de ViSH.Pulsa "Siguiente" para continuar.', 
"i.walk9":'Haciendo click en este bot\u00f3n, podr\u00e1s volver a ver la pantalla principal donde a\u00f1adiste la informaci\u00f3n a tu excursi\u00f3n.Pulsa "Siguiente" para continuar.', "i.walk10":'Haciendo click en este bot\u00f3n, podr\u00e1s volver a ver la pantalla principal donde a\u00f1adiste la informaci\u00f3n a tu excursi\u00f3n.Pulsa "Siguiente" para continuar.', "i.walk11":'Esta zona se utiliza para definir el paginado de tu excursi\u00f3n, atraves de esta secci\u00f3n podras crear, moverte y editar cualquiera de las paginas de tu excursi\u00f3n.Pulsa "Siguiente" para continuar.', 
"i.walk12":'Atraves de este bot\u00f3n podr\u00e1s salvar y publicar tus excursiones en ViSH.Pulsa "Siguiente" para continuar.', "i.walk13":'Este icono te llevar\u00e1 a la ventana de selecci\u00f3n de plantillas para a\u00f1adir paginas a tu excursi\u00f3n. Cuando a\u00f1adas una nueva p\u00e1gina te aprecera a modo de icono en la l\u00ednea de tiempo para mostrarte su ubicaci\u00f3n dentro del paginado de la excursi\u00f3n.Pulsa "Cerrar" para continuar.', "i.walk14":'Esta zona te ofrece una variedad de plantillas para a\u00f1adir a tu excursi\u00f3n. Solo tienes que hacer click en la miniatura que mas se ajuste a la informaci\u00f3n que quieras transmitir.Pulsa "Cerrar" para continuar.', 
"i.walk15":"Para rellenar la plantilla que has escojido, solo tienes que hacer click en los espacios grises de esta. Si haces click dentro, te aparecer\u00e1n los siguientes iconos:", "i.walk16":"Si haces click en uno de estos iconos (dependiend de que tipo de contenido quieras a\u00f1adir a esa zona), te aparecer\u00e1 otra ventana que te ayudar\u00e1 en esta tarea, a excepci\u00f3n del icono de texto, que mostrar\u00e1 una barra en zona superior con herramientas para tratar tu tipograf\u00eda y definir el estilo de tu texto.", 
"i.walk17":"Una vez hayas rellenado una zona gris con contenido, podras editarla volviendo a hacer click en el espacio que contiene el contenido. En caso de que quieras borrar este contenido puedes hacer click en el icono inferior derecho de cada zona gris rellenacon contenido:", "i.walk18":"Si quisieras borrar una plantilla o cerrar ventanas en la aplicaci\u00f3n, deberas usar el icono superior derecho:", "i.walk19":'Si necesitas cualquier otra ayuda con el contenido, siempre puedes utilizar los iconos "tutorial".Pulsa "Cerrar" para continuar.', 
"i.walk20":"Esta ventana te ayudar\u00e1 a la hora de a\u00f1adir imagenes. Como puedes ver el la zona superior tienes las siguientes opciones:", "i.walk21":"(a\u00f1adir imagen desde un enlace)", "i.walk22":"(a\u00f1adir imagen subiendola al repositorio)", "i.walk23":"(a\u00f1adir imagen desde el repositorio)", "i.walk24":"(a\u00f1adir imagen desde flickr)", "i.walk25":'Ahora estas en la secci\u00f3n Url.Pulsa "Siguiente" para continuar.', "i.walk26":"Este espacio esta reservardo para escribir o pegar un enlace que contenga una imagen, por ejemplo:", 
"i.walk27":'Los formatos de imagen soportados por la aplicaci\u00f3n son muy variados (jpg, tiff, png, etc...) Una vez hayas rellenado el espacio, haz click en el bot\u00f3n "previsualizar".Haz click en "Continuar".', "i.walk28":'Esta zona te mostrar\u00e1 el contenido que has subido antes de a\u00f1adirlo a la presentaci\u00f3n, de esta manera puedes comprobarlo. Una vez estes listo, haz click en el bot\u00f3n de a\u00f1adir contenido (Este bot\u00f3n aparecer\u00e1 cuando pulses el bot\u00f3n previsualizar). Haz click en "cerrar" para terminar este tutorial.', 
"i.walk29":'Pulsa en examinar para acceder a una nueva ventana y buscar un archivo en tu disco duro.Una vez lo hayas elegido, haz click en el bot\u00f3n "previsualizar.Haz click en "Continuar".', "i.walk30":'En este espacio puedes buscar imagenes dentro del repositorio. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda de imagenes de las cuales solo debes pulsar encima de una de ellas para a\u00f1adirla a tu presentaci\u00f3n..Haz click en "cerrar" para terminar este tutorial.', 
"i.walk31":'En este espacio puedes buscar imagenes en la pagina Flickr. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda de imagenes de las cuales solo debes pulsar encima de una de ellas para a\u00f1adirla a tu presentaci\u00f3n..Haz click en "cerrar" para terminar este tutorial.', "i.walk32":"Esta ventana te ayudar\u00e1 a la hora de a\u00f1adir contenido en Flash. Como puedes ver el la zona superior tienes las siguientes opciones:", "i.walk33":"(a\u00f1adir contenido desde un enlace)", 
"i.walk34":"(a\u00f1adir contenido subiendolo al repositorio)", "i.walk35":"(a\u00f1adir contenido desde el repositorio)", "i.walk36":'Ahora estas en la secci\u00f3n Url.Haz click en "Continuar".', "i.walk37":"Este espacio esta reservardo para escribir o pegar un enlace que contenga un contenido flash, por ejemplo:", "i.walk38":'Los formatos flash soportados por la aplicaci\u00f3n son .swf.Una vez hayas rellenado el espacio, haz click en el bot\u00f3n "previsualizar".Haz click en "Continuar".', "i.walk39":'Pulsa en examinar para acceder a una nueva ventana y buscar un archivo en tu disco duro.Una vez lo hayas elegido, haz click en el bot\u00f3n "previsualizar".Haz click en "Continuar".', 
"i.walk40":'En este espacio puedes buscar contenido dentro del repositorio. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda de imagenes de las cuales solo debes pulsar encima de una de ellas para acceder a una peque\u00f1a ventana con t\u00edtulo y descripci\u00f3n mas detallada del contenido que te ofrecera la posibilidad de a\u00f1adir el contenido. Solo debes pulsar ese bot\u00f3n para realizar esa tarea..Haz click en "cerrar" para terminar este tutorial.', 
"i.walk41":"Esta ventana te ayudar\u00e1 a la hora de a\u00f1adir imagenes. Como puedes ver el la zona superior tienes las siguientes opciones:", "i.walk42":"(a\u00f1adir video desde un enlace)", "i.walk43":"(a\u00f1adir video desde el repositorio)", "i.walk44":"(a\u00f1adir video desde youtube)", "i.walk45":"(a\u00f1adir video desde vimeo)", "i.walk46":'Ahora estas en la secci\u00f3n Url.Haz click en "Continuar".', "i.walk47":"Este espacio esta reservardo para escribir o pegar un enlace que contenga una imagen, por ejemplo:", 
"i.walk48":'Los formatos de video soportados por la aplicaci\u00f3n son muy variados (avi, flv, mpg...).Una vez hayas rellenado el espacio, haz click en el bot\u00f3n "previsualizar".Haz click en "Continuar".', "i.walk49":'En este espacio puedes buscar videos dentro del repositorio. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda de videos de las cuales solo debes pulsar encima de uno de ellas para acceder a una peque\u00f1a ventana con t\u00edtulo y descripci\u00f3n mas detallada del contenido que te ofrecera la posibilidad de a\u00f1adir el video. Solo debes pulsar ese bot\u00f3n para realizar esa tarea..Haz click en "cerrar" para terminar este tutorial.', 
"i.walk50":'En este espacio puedes buscar videos dentro de youtube. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda de videos de las cuales solo debes pulsar encima de uno de ellas para acceder a una peque\u00f1a ventana con t\u00edtulo y descripci\u00f3n mas detallada del contenido que te ofrecera la posibilidad de a\u00f1adir el video. Solo debes pulsar ese bot\u00f3n para realizar esa tarea..Haz click en "cerrar" para terminar este tutorial.', "i.walk51":'En este espacio puedes buscar videos dentro de vimeo. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda de videos de las cuales solo debes pulsar encima de uno de ellas para acceder a una peque\u00f1a ventana con t\u00edtulo y descripci\u00f3n mas detallada del contenido que te ofrecera la posibilidad de a\u00f1adir el video. Solo debes pulsar ese bot\u00f3n para realizar esa tarea..Haz click en "cerrar" para terminar este tutorial.', 
"i.walk52":"Esta ventana te ayudar\u00e1 a la hora de a\u00f1adir contenido en directo. Como puedes ver el la zona superior tienes de momento la siguiente opci\u00f3n:", "i.walk53":"(a\u00f1adir video desde una camara en directo)", "i.walk54":'Ahora estas en la secci\u00f3n Webcam.Haz click en "Continuar"', "i.walk55":'En este espacio puedes buscar contenido en directo dentro del repositorio. Solamente escribe lo que busques y en la zona inferior te aparecer\u00e1 una galer\u00eda, desde la cual solo debes pulsar encima del contenido para acceder a una peque\u00f1a ventana con t\u00edtulo y descripci\u00f3n mas detallada del contenido que te ofrecera la posibilidad de a\u00f1adirlo. Solo debes pulsar ese bot\u00f3n para realizar esa tarea..Haz click en "cerrar" para terminar este tutorial.', 
"i.pic.add":"a\u00f1adir URL de imagen", "i.browserrequirements":"El navegador que estas utilizando no cumple los requisitos minimos para utilizar esta aplicaci\u00f3n. Por favor, actualiza tu navegador", "i.accept":"aceptar", "i.Add":"A\u00f1adir", "i.add":"a\u00f1adir", "i.AddContent":"A\u00f1adir Contenido", "i.AddSlide":"A\u00f1adir bot\u00f3n de nueva slide", "i.AddVideoUrl":"a\u00f1adir URL de video", "i.AddTags":"A\u00f1ade tags a tu excursi\u00f3n", "i.AddSlideContent":"A\u00f1adiendo contenido a una slide", 
"i.AddObjectContent":"A\u00f1adiendo contenido flash", "i.AddObjectContentUpload":"Subiendo contenido flash", "i.AddObjectContentUrl":"A\u00f1adiendo contenido flash por url", "i.AddImagesContent":"A\u00f1adiendo im\u00e1genes", "i.AddImagesContentUrl":"A\u00f1adiendo im\u00e1genes por url", "i.AddImagesContentUpload":"Subiendo im\u00e1genes", "i.AddVideoContent":"A\u00f1adiendo video", "i.AddVideoContentUrl":"A\u00f1adiendo video por url", "i.AddLiveContent":"A\u00f1adiendo Contenido en Directo", 
"i.sure":"\u00bfest\u00e1 seguro?", "i.cancel":"cancelar", "i.closeOrDelete":"Borrar o Cerrar", "i.close":"cerrar", "i.Close":"Cerrar", "i.continue":"Continuar", "i.Content":"Contenido", "i.oneSlideAlert":"Debe crear al menos una slide antes de salvar", "i.thumbnailsChoosing":"Elige una imagen que representar\u00e1 tu excursi\u00f3n", "i.configButton":"Bot\u00f3n de configuraci\u00f3n", "i.delete":"borrar", "i.deleteContent":"Borrar contenido", "i.presDescriptionPlaceHolder":"Describa la excursi\u00f3n en unas palabras", 
"i.Description":"Descripci\u00f3n", "i.Editdetails":"Editar detalles", "i.presTitle":"T\u00edtulo de la excursi\u00f3n", "i.objectContent":"Contenido Flash", "i.Image":"Imagen", "i.Images":"Im\u00e1genes", "i.Video":"Video", "i.Videos":"Videos", "i.Text":"Texto", "i.Object":"Objeto", "i.Live":"Contenidos en directo", "i.writeTitle":"Escribamos un t\u00edtulo (obligatorio)", "i.no":"no", "i.No":"No", "i.next":"siguiente", "i.Next":"Siguiente", "i.OK":"OK", "i.enterTitle":"Por favor, introduzca un t\u00edtulo", 
"i.preview":"Vista previa", "i.save":"guardar", "i.Save":"Guardar", "i.SaveButton":"Bot\u00f3n de salvar", "i.SaveSlides":"Salvar las diapositivas", "i.SavePresentationDetails":"Salva los detalles de tu excursi\u00f3n", "i.SearchContent":"Buscar contenido", "i.SearchObjectContent":"Buscar contenido flash", "i.SearchImagesFlickr":"Buscar im\u00e1genes en Flickr", "i.SearchImagesVish":"Buscar im\u00e1genes en el repositorio ViSH", "i.SearchVideosVimeo":"Buscar videos en Vimeo", "i.SearchVideosVish":"Buscar videos en el repositorio del ViSH", 
"i.SearchVideosYoutube":"Buscar videos en Youtube", "i.SearchLiveContent":"Buscar contenido en directo", "i.SeeContentBefore":"Puedes ver el contenido antes de a\u00f1adirlo", "i.SeeImageBefore":"Puedes ver las im\u00e1genes antes de a\u00f1adirlas", "i.SeeVideoBefore":"Puedes ver el video antes de a\u00f1adirlo", "i.selectPicture":"Seleccionar imagen para subir", "i.selectObject":"Seleccionar archivo swf para subir", "i.selectSlide":"Seleccionando una slide", "i.selectTheme":"Seleccionar tema", 
"i.Title":"T\u00edtulo", "i.thisIsVishEditor":"\u00a1Esto es el ViSH Editor!", "i.thisIsToolsMenu":"Esto es el men\u00fa de herramientas", "i.welcomeVishEditor":"\u00a1Bienvenido al ViSH editor!", "i.Url":"Enlace", "i.url":"enlace", "i.Upload":"Subir", "i.upload":"subir", "i.Thumbnail":"Miniatura", "i.WriteDescription":"Escribe una descripci\u00f3n (opcional)", "i.ConvertTo":"Convertir a", "i.Settings":"Ajustes", "i.Help":"Ayuda", "i.ExportAs":"Exportar como", "i.File":"Archivo", "i.Presentation":"Presentaci\u00f3n", 
"i.WysiwygInit":"Insertar texto aqu\u00ed", "i.embedObject":"embeber objeto", "i.embedWebsites":"embeber web", "i.html5App":"Aplicaci\u00f3n HTML5", "i.Import":"Importar", "i.Game":"Juego", "i.vExperiment":"Experimento virtual", "i.changeBackground":"Cambiar fondo", "i.Microscopes":"Microscopios", "i.AddTags":"A\u00f1adir etiquetas", "i.limitReached":"limite alcanzado", "i.Templates":"Plantillas", "i.Author":"Autor", "i.draft":"Borrador", "i.publish":"Publicar", "i.wysiwyg.addurl":"A\u00f1adir enlace", 
"i.exitConfirmation":"Vas a abandonar esta pagina. Se perder\u00e1n todos los cambios que no hayas salvado."}, "default":{"i.Author":"Author", "i.AddTags":"Add tags", "i.Add":"Add", "i.add":"add", "i.WysiwygInit":"Insert text here", "i.SearchContent":"Search Content", "i.Description":"Description", "i.limitReached":"limit reached", "i.wysiwyg.addurl":"Add link", "i.Title":"T\u00edtulo", "i.exitConfirmation":"You are about to leave this website. You will lose any changes you have not saved."}}, "standalone":{"es":{"i.save":"Standalone"}, 
"default":{"i.save":"Standalone"}}};
var VISH = VISH || {};
VISH.Mods || (VISH.Mods = {});
VISH.VERSION = "0.1";
VISH.AUTHORS = "GING";
VISH.Editing = false;
VISH.Constant = {};
VISH.Constant.Edit = "Edit";
VISH.Constant.Viewer = "Viewer";
VISH.Constant.AnyMode = "Both";
VISH.Constant.UA_IE = "Microsoft Internet Explorer";
VISH.Constant.UA_NETSCAPE = "Netscape";
VISH.Constant.IE = "Internet Explorer";
VISH.Constant.FIREFOX = "Mozilla Firefox";
VISH.Constant.CHROME = "Google Chrome";
VISH.Constant.UNKNOWN = "Unknown";
VISH.Constant.NOSERVER = "noserver";
VISH.Constant.VISH = "vish";
VISH.Constant.STANDALONE = "node";
VISH.Constant.SMALL = "small";
VISH.Constant.MEDIUM = "medium";
VISH.Constant.LARGE = "large";
VISH.Constant.PRESENTATION = "presentation";
VISH.Constant.FLASHCARD = "flashcard";
VISH.Constant.GAME = "game";
VISH.Constant.THUMBNAIL = "thumbnail";
VISH.Constant.NONE = "none";
VISH.Constant.Video = {};
VISH.Constant.Video.HTML5 = "HTML5";
VISH.Constant.Video.Youtube = "Youtube";
VISH.Constant.Event = {};
VISH.Constant.Event.onMessage = "onMessage";
VISH.Constant.Event.onGoToSlide = "onGoToSlide";
VISH.Constant.Event.onPlayVideo = "onPlayVideo";
VISH.Constant.Event.onPauseVideo = "onPauseVideo";
VISH.Constant.Event.onSeekVideo = "onSeekVideo";
VISH.Constant.Event.onSetSlave = "onSetSlave";
VISH.Constant.Event.onPreventDefault = "onPreventDefault";
(function(a, b) {
  function cy(a) {
    return f.isWindow(a) ? a : a.nodeType === 9 ? a.defaultView || a.parentWindow : !1
  }
  function cu(a) {
    if(!cj[a]) {
      var b = c.body, d = f("<" + a + ">").appendTo(b), e = d.css("display");
      d.remove();
      if(e === "none" || e === "") {
        ck || (ck = c.createElement("iframe"), ck.frameBorder = ck.width = ck.height = 0), b.appendChild(ck);
        if(!cl || !ck.createElement) {
          cl = (ck.contentWindow || ck.contentDocument).document, cl.write((f.support.boxModel ? "<!doctype html>" : "") + "<html><body>"), cl.close()
        }
        d = cl.createElement(a), cl.body.appendChild(d), e = f.css(d, "display"), b.removeChild(ck)
      }
      cj[a] = e
    }
    return cj[a]
  }
  function ct(a, b) {
    var c = {};
    f.each(cp.concat.apply([], cp.slice(0, b)), function() {
      c[this] = a
    });
    return c
  }
  function cs() {
    cq = b
  }
  function cr() {
    setTimeout(cs, 0);
    return cq = f.now()
  }
  function ci() {
    try {
      return new a.ActiveXObject("Microsoft.XMLHTTP")
    }catch(b) {
    }
  }
  function ch() {
    try {
      return new a.XMLHttpRequest
    }catch(b) {
    }
  }
  function cb(a, c) {
    a.dataFilter && (c = a.dataFilter(c, a.dataType));
    var d = a.dataTypes, e = {}, g, h, i = d.length, j, k = d[0], l, m, n, o, p;
    for(g = 1;g < i;g++) {
      if(g === 1) {
        for(h in a.converters) {
          typeof h == "string" && (e[h.toLowerCase()] = a.converters[h])
        }
      }
      l = k, k = d[g];
      if(k === "*") {
        k = l
      }else {
        if(l !== "*" && l !== k) {
          m = l + " " + k, n = e[m] || e["* " + k];
          if(!n) {
            p = b;
            for(o in e) {
              j = o.split(" ");
              if(j[0] === l || j[0] === "*") {
                p = e[j[1] + " " + k];
                if(p) {
                  o = e[o], o === !0 ? n = p : p === !0 && (n = o);
                  break
                }
              }
            }
          }
          !n && !p && f.error("No conversion from " + m.replace(" ", " to ")), n !== !0 && (c = n ? n(c) : p(o(c)))
        }
      }
    }
    return c
  }
  function ca(a, c, d) {
    var e = a.contents, f = a.dataTypes, g = a.responseFields, h, i, j, k;
    for(i in g) {
      i in d && (c[g[i]] = d[i])
    }
    while(f[0] === "*") {
      f.shift(), h === b && (h = a.mimeType || c.getResponseHeader("content-type"))
    }
    if(h) {
      for(i in e) {
        if(e[i] && e[i].test(h)) {
          f.unshift(i);
          break
        }
      }
    }
    if(f[0] in d) {
      j = f[0]
    }else {
      for(i in d) {
        if(!f[0] || a.converters[i + " " + f[0]]) {
          j = i;
          break
        }
        k || (k = i)
      }
      j = j || k
    }
    if(j) {
      j !== f[0] && f.unshift(j);
      return d[j]
    }
  }
  function b_(a, b, c, d) {
    if(f.isArray(b)) {
      f.each(b, function(b, e) {
        c || bD.test(a) ? d(a, e) : b_(a + "[" + (typeof e == "object" ? b : "") + "]", e, c, d)
      })
    }else {
      if(!c && f.type(b) === "object") {
        for(var e in b) {
          b_(a + "[" + e + "]", b[e], c, d)
        }
      }else {
        d(a, b)
      }
    }
  }
  function b$(a, c) {
    var d, e, g = f.ajaxSettings.flatOptions || {};
    for(d in c) {
      c[d] !== b && ((g[d] ? a : e || (e = {}))[d] = c[d])
    }
    e && f.extend(!0, a, e)
  }
  function bZ(a, c, d, e, f, g) {
    f = f || c.dataTypes[0], g = g || {}, g[f] = !0;
    var h = a[f], i = 0, j = h ? h.length : 0, k = a === bS, l;
    for(;i < j && (k || !l);i++) {
      l = h[i](c, d, e), typeof l == "string" && (!k || g[l] ? l = b : (c.dataTypes.unshift(l), l = bZ(a, c, d, e, l, g)))
    }
    (k || !l) && !g["*"] && (l = bZ(a, c, d, e, "*", g));
    return l
  }
  function bY(a) {
    return function(b, c) {
      typeof b != "string" && (c = b, b = "*");
      if(f.isFunction(c)) {
        var d = b.toLowerCase().split(bO), e = 0, g = d.length, h, i, j;
        for(;e < g;e++) {
          h = d[e], j = /^\+/.test(h), j && (h = h.substr(1) || "*"), i = a[h] = a[h] || [], i[j ? "unshift" : "push"](c)
        }
      }
    }
  }
  function bB(a, b, c) {
    var d = b === "width" ? a.offsetWidth : a.offsetHeight, e = b === "width" ? 1 : 0, g = 4;
    if(d > 0) {
      if(c !== "border") {
        for(;e < g;e += 2) {
          c || (d -= parseFloat(f.css(a, "padding" + bx[e])) || 0), c === "margin" ? d += parseFloat(f.css(a, c + bx[e])) || 0 : d -= parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0
        }
      }
      return d + "px"
    }
    d = by(a, b);
    if(d < 0 || d == null) {
      d = a.style[b]
    }
    if(bt.test(d)) {
      return d
    }
    d = parseFloat(d) || 0;
    if(c) {
      for(;e < g;e += 2) {
        d += parseFloat(f.css(a, "padding" + bx[e])) || 0, c !== "padding" && (d += parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0), c === "margin" && (d += parseFloat(f.css(a, c + bx[e])) || 0)
      }
    }
    return d + "px"
  }
  function bo(a) {
    var b = c.createElement("div");
    bh.appendChild(b), b.innerHTML = a.outerHTML;
    return b.firstChild
  }
  function bn(a) {
    var b = (a.nodeName || "").toLowerCase();
    b === "input" ? bm(a) : b !== "script" && typeof a.getElementsByTagName != "undefined" && f.grep(a.getElementsByTagName("input"), bm)
  }
  function bm(a) {
    if(a.type === "checkbox" || a.type === "radio") {
      a.defaultChecked = a.checked
    }
  }
  function bl(a) {
    return typeof a.getElementsByTagName != "undefined" ? a.getElementsByTagName("*") : typeof a.querySelectorAll != "undefined" ? a.querySelectorAll("*") : []
  }
  function bk(a, b) {
    var c;
    b.nodeType === 1 && (b.clearAttributes && b.clearAttributes(), b.mergeAttributes && b.mergeAttributes(a), c = b.nodeName.toLowerCase(), c === "object" ? b.outerHTML = a.outerHTML : c !== "input" || a.type !== "checkbox" && a.type !== "radio" ? c === "option" ? b.selected = a.defaultSelected : c === "input" || c === "textarea" ? b.defaultValue = a.defaultValue : c === "script" && b.text !== a.text && (b.text = a.text) : (a.checked && (b.defaultChecked = b.checked = a.checked), b.value !== a.value && 
    (b.value = a.value)), b.removeAttribute(f.expando), b.removeAttribute("_submit_attached"), b.removeAttribute("_change_attached"))
  }
  function bj(a, b) {
    if(b.nodeType === 1 && !!f.hasData(a)) {
      var c, d, e, g = f._data(a), h = f._data(b, g), i = g.events;
      if(i) {
        delete h.handle, h.events = {};
        for(c in i) {
          for(d = 0, e = i[c].length;d < e;d++) {
            f.event.add(b, c, i[c][d])
          }
        }
      }
      h.data && (h.data = f.extend({}, h.data))
    }
  }
  function bi(a, b) {
    return f.nodeName(a, "table") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
  }
  function U(a) {
    var b = V.split("|"), c = a.createDocumentFragment();
    if(c.createElement) {
      while(b.length) {
        c.createElement(b.pop())
      }
    }
    return c
  }
  function T(a, b, c) {
    b = b || 0;
    if(f.isFunction(b)) {
      return f.grep(a, function(a, d) {
        var e = !!b.call(a, d, a);
        return e === c
      })
    }
    if(b.nodeType) {
      return f.grep(a, function(a, d) {
        return a === b === c
      })
    }
    if(typeof b == "string") {
      var d = f.grep(a, function(a) {
        return a.nodeType === 1
      });
      if(O.test(b)) {
        return f.filter(b, d, !c)
      }
      b = f.filter(b, d)
    }
    return f.grep(a, function(a, d) {
      return f.inArray(a, b) >= 0 === c
    })
  }
  function S(a) {
    return!a || !a.parentNode || a.parentNode.nodeType === 11
  }
  function K() {
    return!0
  }
  function J() {
    return!1
  }
  function n(a, b, c) {
    var d = b + "defer", e = b + "queue", g = b + "mark", h = f._data(a, d);
    h && (c === "queue" || !f._data(a, e)) && (c === "mark" || !f._data(a, g)) && setTimeout(function() {
      !f._data(a, e) && !f._data(a, g) && (f.removeData(a, d, !0), h.fire())
    }, 0)
  }
  function m(a) {
    for(var b in a) {
      if(b === "data" && f.isEmptyObject(a[b])) {
        continue
      }
      if(b !== "toJSON") {
        return!1
      }
    }
    return!0
  }
  function l(a, c, d) {
    if(d === b && a.nodeType === 1) {
      var e = "data-" + c.replace(k, "-$1").toLowerCase();
      d = a.getAttribute(e);
      if(typeof d == "string") {
        try {
          d = d === "true" ? !0 : d === "false" ? !1 : d === "null" ? null : f.isNumeric(d) ? +d : j.test(d) ? f.parseJSON(d) : d
        }catch(g) {
        }
        f.data(a, c, d)
      }else {
        d = b
      }
    }
    return d
  }
  function h(a) {
    var b = g[a] = {}, c, d;
    a = a.split(/\s+/);
    for(c = 0, d = a.length;c < d;c++) {
      b[a[c]] = !0
    }
    return b
  }
  var c = a.document, d = a.navigator, e = a.location, f = function() {
    function J() {
      if(!e.isReady) {
        try {
          c.documentElement.doScroll("left")
        }catch(a) {
          setTimeout(J, 1);
          return
        }
        e.ready()
      }
    }
    var e = function(a, b) {
      return new e.fn.init(a, b, h)
    }, f = a.jQuery, g = a.$, h, i = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, j = /\S/, k = /^\s+/, l = /\s+$/, m = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, n = /^[\],:{}\s]*$/, o = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, p = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, q = /(?:^|:|,)(?:\s*\[)+/g, r = /(webkit)[ \/]([\w.]+)/, s = /(opera)(?:.*version)?[ \/]([\w.]+)/, t = /(msie) ([\w.]+)/, u = /(mozilla)(?:.*? rv:([\w.]+))?/, v = /-([a-z]|[0-9])/ig, w = /^-ms-/, x = function(a, b) {
      return(b + "").toUpperCase()
    }, y = d.userAgent, z, A, B, C = Object.prototype.toString, D = Object.prototype.hasOwnProperty, E = Array.prototype.push, F = Array.prototype.slice, G = String.prototype.trim, H = Array.prototype.indexOf, I = {};
    e.fn = e.prototype = {constructor:e, init:function(a, d, f) {
      var g, h, j, k;
      if(!a) {
        return this
      }
      if(a.nodeType) {
        this.context = this[0] = a, this.length = 1;
        return this
      }
      if(a === "body" && !d && c.body) {
        this.context = c, this[0] = c.body, this.selector = a, this.length = 1;
        return this
      }
      if(typeof a == "string") {
        a.charAt(0) !== "<" || a.charAt(a.length - 1) !== ">" || a.length < 3 ? g = i.exec(a) : g = [null, a, null];
        if(g && (g[1] || !d)) {
          if(g[1]) {
            d = d instanceof e ? d[0] : d, k = d ? d.ownerDocument || d : c, j = m.exec(a), j ? e.isPlainObject(d) ? (a = [c.createElement(j[1])], e.fn.attr.call(a, d, !0)) : a = [k.createElement(j[1])] : (j = e.buildFragment([g[1]], [k]), a = (j.cacheable ? e.clone(j.fragment) : j.fragment).childNodes);
            return e.merge(this, a)
          }
          h = c.getElementById(g[2]);
          if(h && h.parentNode) {
            if(h.id !== g[2]) {
              return f.find(a)
            }
            this.length = 1, this[0] = h
          }
          this.context = c, this.selector = a;
          return this
        }
        return!d || d.jquery ? (d || f).find(a) : this.constructor(d).find(a)
      }
      if(e.isFunction(a)) {
        return f.ready(a)
      }
      a.selector !== b && (this.selector = a.selector, this.context = a.context);
      return e.makeArray(a, this)
    }, selector:"", jquery:"1.7.2", length:0, size:function() {
      return this.length
    }, toArray:function() {
      return F.call(this, 0)
    }, get:function(a) {
      return a == null ? this.toArray() : a < 0 ? this[this.length + a] : this[a]
    }, pushStack:function(a, b, c) {
      var d = this.constructor();
      e.isArray(a) ? E.apply(d, a) : e.merge(d, a), d.prevObject = this, d.context = this.context, b === "find" ? d.selector = this.selector + (this.selector ? " " : "") + c : b && (d.selector = this.selector + "." + b + "(" + c + ")");
      return d
    }, each:function(a, b) {
      return e.each(this, a, b)
    }, ready:function(a) {
      e.bindReady(), A.add(a);
      return this
    }, eq:function(a) {
      a = +a;
      return a === -1 ? this.slice(a) : this.slice(a, a + 1)
    }, first:function() {
      return this.eq(0)
    }, last:function() {
      return this.eq(-1)
    }, slice:function() {
      return this.pushStack(F.apply(this, arguments), "slice", F.call(arguments).join(","))
    }, map:function(a) {
      return this.pushStack(e.map(this, function(b, c) {
        return a.call(b, c, b)
      }))
    }, end:function() {
      return this.prevObject || this.constructor(null)
    }, push:E, sort:[].sort, splice:[].splice}, e.fn.init.prototype = e.fn, e.extend = e.fn.extend = function() {
      var a, c, d, f, g, h, i = arguments[0] || {}, j = 1, k = arguments.length, l = !1;
      typeof i == "boolean" && (l = i, i = arguments[1] || {}, j = 2), typeof i != "object" && !e.isFunction(i) && (i = {}), k === j && (i = this, --j);
      for(;j < k;j++) {
        if((a = arguments[j]) != null) {
          for(c in a) {
            d = i[c], f = a[c];
            if(i === f) {
              continue
            }
            l && f && (e.isPlainObject(f) || (g = e.isArray(f))) ? (g ? (g = !1, h = d && e.isArray(d) ? d : []) : h = d && e.isPlainObject(d) ? d : {}, i[c] = e.extend(l, h, f)) : f !== b && (i[c] = f)
          }
        }
      }
      return i
    }, e.extend({noConflict:function(b) {
      a.$ === e && (a.$ = g), b && a.jQuery === e && (a.jQuery = f);
      return e
    }, isReady:!1, readyWait:1, holdReady:function(a) {
      a ? e.readyWait++ : e.ready(!0)
    }, ready:function(a) {
      if(a === !0 && !--e.readyWait || a !== !0 && !e.isReady) {
        if(!c.body) {
          return setTimeout(e.ready, 1)
        }
        e.isReady = !0;
        if(a !== !0 && --e.readyWait > 0) {
          return
        }
        A.fireWith(c, [e]), e.fn.trigger && e(c).trigger("ready").off("ready")
      }
    }, bindReady:function() {
      if(!A) {
        A = e.Callbacks("once memory");
        if(c.readyState === "complete") {
          return setTimeout(e.ready, 1)
        }
        if(c.addEventListener) {
          c.addEventListener("DOMContentLoaded", B, !1), a.addEventListener("load", e.ready, !1)
        }else {
          if(c.attachEvent) {
            c.attachEvent("onreadystatechange", B), a.attachEvent("onload", e.ready);
            var b = !1;
            try {
              b = a.frameElement == null
            }catch(d) {
            }
            c.documentElement.doScroll && b && J()
          }
        }
      }
    }, isFunction:function(a) {
      return e.type(a) === "function"
    }, isArray:Array.isArray || function(a) {
      return e.type(a) === "array"
    }, isWindow:function(a) {
      return a != null && a == a.window
    }, isNumeric:function(a) {
      return!isNaN(parseFloat(a)) && isFinite(a)
    }, type:function(a) {
      return a == null ? String(a) : I[C.call(a)] || "object"
    }, isPlainObject:function(a) {
      if(!a || e.type(a) !== "object" || a.nodeType || e.isWindow(a)) {
        return!1
      }
      try {
        if(a.constructor && !D.call(a, "constructor") && !D.call(a.constructor.prototype, "isPrototypeOf")) {
          return!1
        }
      }catch(c) {
        return!1
      }
      var d;
      for(d in a) {
      }
      return d === b || D.call(a, d)
    }, isEmptyObject:function(a) {
      for(var b in a) {
        return!1
      }
      return!0
    }, error:function(a) {
      throw new Error(a);
    }, parseJSON:function(b) {
      if(typeof b != "string" || !b) {
        return null
      }
      b = e.trim(b);
      if(a.JSON && a.JSON.parse) {
        return a.JSON.parse(b)
      }
      if(n.test(b.replace(o, "@").replace(p, "]").replace(q, ""))) {
        return(new Function("return " + b))()
      }
      e.error("Invalid JSON: " + b)
    }, parseXML:function(c) {
      if(typeof c != "string" || !c) {
        return null
      }
      var d, f;
      try {
        a.DOMParser ? (f = new DOMParser, d = f.parseFromString(c, "text/xml")) : (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(c))
      }catch(g) {
        d = b
      }
      (!d || !d.documentElement || d.getElementsByTagName("parsererror").length) && e.error("Invalid XML: " + c);
      return d
    }, noop:function() {
    }, globalEval:function(b) {
      b && j.test(b) && (a.execScript || function(b) {
        a.eval.call(a, b)
      })(b)
    }, camelCase:function(a) {
      return a.replace(w, "ms-").replace(v, x)
    }, nodeName:function(a, b) {
      return a.nodeName && a.nodeName.toUpperCase() === b.toUpperCase()
    }, each:function(a, c, d) {
      var f, g = 0, h = a.length, i = h === b || e.isFunction(a);
      if(d) {
        if(i) {
          for(f in a) {
            if(c.apply(a[f], d) === !1) {
              break
            }
          }
        }else {
          for(;g < h;) {
            if(c.apply(a[g++], d) === !1) {
              break
            }
          }
        }
      }else {
        if(i) {
          for(f in a) {
            if(c.call(a[f], f, a[f]) === !1) {
              break
            }
          }
        }else {
          for(;g < h;) {
            if(c.call(a[g], g, a[g++]) === !1) {
              break
            }
          }
        }
      }
      return a
    }, trim:G ? function(a) {
      return a == null ? "" : G.call(a)
    } : function(a) {
      return a == null ? "" : (a + "").replace(k, "").replace(l, "")
    }, makeArray:function(a, b) {
      var c = b || [];
      if(a != null) {
        var d = e.type(a);
        a.length == null || d === "string" || d === "function" || d === "regexp" || e.isWindow(a) ? E.call(c, a) : e.merge(c, a)
      }
      return c
    }, inArray:function(a, b, c) {
      var d;
      if(b) {
        if(H) {
          return H.call(b, a, c)
        }
        d = b.length, c = c ? c < 0 ? Math.max(0, d + c) : c : 0;
        for(;c < d;c++) {
          if(c in b && b[c] === a) {
            return c
          }
        }
      }
      return-1
    }, merge:function(a, c) {
      var d = a.length, e = 0;
      if(typeof c.length == "number") {
        for(var f = c.length;e < f;e++) {
          a[d++] = c[e]
        }
      }else {
        while(c[e] !== b) {
          a[d++] = c[e++]
        }
      }
      a.length = d;
      return a
    }, grep:function(a, b, c) {
      var d = [], e;
      c = !!c;
      for(var f = 0, g = a.length;f < g;f++) {
        e = !!b(a[f], f), c !== e && d.push(a[f])
      }
      return d
    }, map:function(a, c, d) {
      var f, g, h = [], i = 0, j = a.length, k = a instanceof e || j !== b && typeof j == "number" && (j > 0 && a[0] && a[j - 1] || j === 0 || e.isArray(a));
      if(k) {
        for(;i < j;i++) {
          f = c(a[i], i, d), f != null && (h[h.length] = f)
        }
      }else {
        for(g in a) {
          f = c(a[g], g, d), f != null && (h[h.length] = f)
        }
      }
      return h.concat.apply([], h)
    }, guid:1, proxy:function(a, c) {
      if(typeof c == "string") {
        var d = a[c];
        c = a, a = d
      }
      if(!e.isFunction(a)) {
        return b
      }
      var f = F.call(arguments, 2), g = function() {
        return a.apply(c, f.concat(F.call(arguments)))
      };
      g.guid = a.guid = a.guid || g.guid || e.guid++;
      return g
    }, access:function(a, c, d, f, g, h, i) {
      var j, k = d == null, l = 0, m = a.length;
      if(d && typeof d == "object") {
        for(l in d) {
          e.access(a, c, l, d[l], 1, h, f)
        }
        g = 1
      }else {
        if(f !== b) {
          j = i === b && e.isFunction(f), k && (j ? (j = c, c = function(a, b, c) {
            return j.call(e(a), c)
          }) : (c.call(a, f), c = null));
          if(c) {
            for(;l < m;l++) {
              c(a[l], d, j ? f.call(a[l], l, c(a[l], d)) : f, i)
            }
          }
          g = 1
        }
      }
      return g ? a : k ? c.call(a) : m ? c(a[0], d) : h
    }, now:function() {
      return(new Date).getTime()
    }, uaMatch:function(a) {
      a = a.toLowerCase();
      var b = r.exec(a) || s.exec(a) || t.exec(a) || a.indexOf("compatible") < 0 && u.exec(a) || [];
      return{browser:b[1] || "", version:b[2] || "0"}
    }, sub:function() {
      function a(b, c) {
        return new a.fn.init(b, c)
      }
      e.extend(!0, a, this), a.superclass = this, a.fn = a.prototype = this(), a.fn.constructor = a, a.sub = this.sub, a.fn.init = function(d, f) {
        f && f instanceof e && !(f instanceof a) && (f = a(f));
        return e.fn.init.call(this, d, f, b)
      }, a.fn.init.prototype = a.fn;
      var b = a(c);
      return a
    }, browser:{}}), e.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(a, b) {
      I["[object " + b + "]"] = b.toLowerCase()
    }), z = e.uaMatch(y), z.browser && (e.browser[z.browser] = !0, e.browser.version = z.version), e.browser.webkit && (e.browser.safari = !0), j.test("\u00a0") && (k = /^[\s\xA0]+/, l = /[\s\xA0]+$/), h = e(c), c.addEventListener ? B = function() {
      c.removeEventListener("DOMContentLoaded", B, !1), e.ready()
    } : c.attachEvent && (B = function() {
      c.readyState === "complete" && (c.detachEvent("onreadystatechange", B), e.ready())
    });
    return e
  }(), g = {};
  f.Callbacks = function(a) {
    a = a ? g[a] || h(a) : {};
    var c = [], d = [], e, i, j, k, l, m, n = function(b) {
      var d, e, g, h, i;
      for(d = 0, e = b.length;d < e;d++) {
        g = b[d], h = f.type(g), h === "array" ? n(g) : h === "function" && (!a.unique || !p.has(g)) && c.push(g)
      }
    }, o = function(b, f) {
      f = f || [], e = !a.memory || [b, f], i = !0, j = !0, m = k || 0, k = 0, l = c.length;
      for(;c && m < l;m++) {
        if(c[m].apply(b, f) === !1 && a.stopOnFalse) {
          e = !0;
          break
        }
      }
      j = !1, c && (a.once ? e === !0 ? p.disable() : c = [] : d && d.length && (e = d.shift(), p.fireWith(e[0], e[1])))
    }, p = {add:function() {
      if(c) {
        var a = c.length;
        n(arguments), j ? l = c.length : e && e !== !0 && (k = a, o(e[0], e[1]))
      }
      return this
    }, remove:function() {
      if(c) {
        var b = arguments, d = 0, e = b.length;
        for(;d < e;d++) {
          for(var f = 0;f < c.length;f++) {
            if(b[d] === c[f]) {
              j && f <= l && (l--, f <= m && m--), c.splice(f--, 1);
              if(a.unique) {
                break
              }
            }
          }
        }
      }
      return this
    }, has:function(a) {
      if(c) {
        var b = 0, d = c.length;
        for(;b < d;b++) {
          if(a === c[b]) {
            return!0
          }
        }
      }
      return!1
    }, empty:function() {
      c = [];
      return this
    }, disable:function() {
      c = d = e = b;
      return this
    }, disabled:function() {
      return!c
    }, lock:function() {
      d = b, (!e || e === !0) && p.disable();
      return this
    }, locked:function() {
      return!d
    }, fireWith:function(b, c) {
      d && (j ? a.once || d.push([b, c]) : (!a.once || !e) && o(b, c));
      return this
    }, fire:function() {
      p.fireWith(this, arguments);
      return this
    }, fired:function() {
      return!!i
    }};
    return p
  };
  var i = [].slice;
  f.extend({Deferred:function(a) {
    var b = f.Callbacks("once memory"), c = f.Callbacks("once memory"), d = f.Callbacks("memory"), e = "pending", g = {resolve:b, reject:c, notify:d}, h = {done:b.add, fail:c.add, progress:d.add, state:function() {
      return e
    }, isResolved:b.fired, isRejected:c.fired, then:function(a, b, c) {
      i.done(a).fail(b).progress(c);
      return this
    }, always:function() {
      i.done.apply(i, arguments).fail.apply(i, arguments);
      return this
    }, pipe:function(a, b, c) {
      return f.Deferred(function(d) {
        f.each({done:[a, "resolve"], fail:[b, "reject"], progress:[c, "notify"]}, function(a, b) {
          var c = b[0], e = b[1], g;
          f.isFunction(c) ? i[a](function() {
            g = c.apply(this, arguments), g && f.isFunction(g.promise) ? g.promise().then(d.resolve, d.reject, d.notify) : d[e + "With"](this === i ? d : this, [g])
          }) : i[a](d[e])
        })
      }).promise()
    }, promise:function(a) {
      if(a == null) {
        a = h
      }else {
        for(var b in h) {
          a[b] = h[b]
        }
      }
      return a
    }}, i = h.promise({}), j;
    for(j in g) {
      i[j] = g[j].fire, i[j + "With"] = g[j].fireWith
    }
    i.done(function() {
      e = "resolved"
    }, c.disable, d.lock).fail(function() {
      e = "rejected"
    }, b.disable, d.lock), a && a.call(i, i);
    return i
  }, when:function(a) {
    function m(a) {
      return function(b) {
        e[a] = arguments.length > 1 ? i.call(arguments, 0) : b, j.notifyWith(k, e)
      }
    }
    function l(a) {
      return function(c) {
        b[a] = arguments.length > 1 ? i.call(arguments, 0) : c, --g || j.resolveWith(j, b)
      }
    }
    var b = i.call(arguments, 0), c = 0, d = b.length, e = Array(d), g = d, h = d, j = d <= 1 && a && f.isFunction(a.promise) ? a : f.Deferred(), k = j.promise();
    if(d > 1) {
      for(;c < d;c++) {
        b[c] && b[c].promise && f.isFunction(b[c].promise) ? b[c].promise().then(l(c), j.reject, m(c)) : --g
      }
      g || j.resolveWith(j, b)
    }else {
      j !== a && j.resolveWith(j, d ? [a] : [])
    }
    return k
  }}), f.support = function() {
    var b, d, e, g, h, i, j, k, l, m, n, o, p = c.createElement("div"), q = c.documentElement;
    p.setAttribute("className", "t"), p.innerHTML = "   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>", d = p.getElementsByTagName("*"), e = p.getElementsByTagName("a")[0];
    if(!d || !d.length || !e) {
      return{}
    }
    g = c.createElement("select"), h = g.appendChild(c.createElement("option")), i = p.getElementsByTagName("input")[0], b = {leadingWhitespace:p.firstChild.nodeType === 3, tbody:!p.getElementsByTagName("tbody").length, htmlSerialize:!!p.getElementsByTagName("link").length, style:/top/.test(e.getAttribute("style")), hrefNormalized:e.getAttribute("href") === "/a", opacity:/^0.55/.test(e.style.opacity), cssFloat:!!e.style.cssFloat, checkOn:i.value === "on", optSelected:h.selected, getSetAttribute:p.className !== 
    "t", enctype:!!c.createElement("form").enctype, html5Clone:c.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>", submitBubbles:!0, changeBubbles:!0, focusinBubbles:!1, deleteExpando:!0, noCloneEvent:!0, inlineBlockNeedsLayout:!1, shrinkWrapBlocks:!1, reliableMarginRight:!0, pixelMargin:!0}, f.boxModel = b.boxModel = c.compatMode === "CSS1Compat", i.checked = !0, b.noCloneChecked = i.cloneNode(!0).checked, g.disabled = !0, b.optDisabled = !h.disabled;
    try {
      delete p.test
    }catch(r) {
      b.deleteExpando = !1
    }
    !p.addEventListener && p.attachEvent && p.fireEvent && (p.attachEvent("onclick", function() {
      b.noCloneEvent = !1
    }), p.cloneNode(!0).fireEvent("onclick")), i = c.createElement("input"), i.value = "t", i.setAttribute("type", "radio"), b.radioValue = i.value === "t", i.setAttribute("checked", "checked"), i.setAttribute("name", "t"), p.appendChild(i), j = c.createDocumentFragment(), j.appendChild(p.lastChild), b.checkClone = j.cloneNode(!0).cloneNode(!0).lastChild.checked, b.appendChecked = i.checked, j.removeChild(i), j.appendChild(p);
    if(p.attachEvent) {
      for(n in{submit:1, change:1, focusin:1}) {
        m = "on" + n, o = m in p, o || (p.setAttribute(m, "return;"), o = typeof p[m] == "function"), b[n + "Bubbles"] = o
      }
    }
    j.removeChild(p), j = g = h = p = i = null, f(function() {
      var d, e, g, h, i, j, l, m, n, q, r, s, t, u = c.getElementsByTagName("body")[0];
      !u || (m = 1, t = "padding:0;margin:0;border:", r = "position:absolute;top:0;left:0;width:1px;height:1px;", s = t + "0;visibility:hidden;", n = "style='" + r + t + "5px solid #000;", q = "<div " + n + "display:block;'><div style='" + t + "0;display:block;overflow:hidden;'></div></div>" + "<table " + n + "' cellpadding='0' cellspacing='0'>" + "<tr><td></td></tr></table>", d = c.createElement("div"), d.style.cssText = s + "width:0;height:0;position:static;top:0;margin-top:" + m + "px", u.insertBefore(d, 
      u.firstChild), p = c.createElement("div"), d.appendChild(p), p.innerHTML = "<table><tr><td style='" + t + "0;display:none'></td><td>t</td></tr></table>", k = p.getElementsByTagName("td"), o = k[0].offsetHeight === 0, k[0].style.display = "", k[1].style.display = "none", b.reliableHiddenOffsets = o && k[0].offsetHeight === 0, a.getComputedStyle && (p.innerHTML = "", l = c.createElement("div"), l.style.width = "0", l.style.marginRight = "0", p.style.width = "2px", p.appendChild(l), b.reliableMarginRight = 
      (parseInt((a.getComputedStyle(l, null) || {marginRight:0}).marginRight, 10) || 0) === 0), typeof p.style.zoom != "undefined" && (p.innerHTML = "", p.style.width = p.style.padding = "1px", p.style.border = 0, p.style.overflow = "hidden", p.style.display = "inline", p.style.zoom = 1, b.inlineBlockNeedsLayout = p.offsetWidth === 3, p.style.display = "block", p.style.overflow = "visible", p.innerHTML = "<div style='width:5px;'></div>", b.shrinkWrapBlocks = p.offsetWidth !== 3), p.style.cssText = 
      r + s, p.innerHTML = q, e = p.firstChild, g = e.firstChild, i = e.nextSibling.firstChild.firstChild, j = {doesNotAddBorder:g.offsetTop !== 5, doesAddBorderForTableAndCells:i.offsetTop === 5}, g.style.position = "fixed", g.style.top = "20px", j.fixedPosition = g.offsetTop === 20 || g.offsetTop === 15, g.style.position = g.style.top = "", e.style.overflow = "hidden", e.style.position = "relative", j.subtractsBorderForOverflowNotVisible = g.offsetTop === -5, j.doesNotIncludeMarginInBodyOffset = 
      u.offsetTop !== m, a.getComputedStyle && (p.style.marginTop = "1%", b.pixelMargin = (a.getComputedStyle(p, null) || {marginTop:0}).marginTop !== "1%"), typeof d.style.zoom != "undefined" && (d.style.zoom = 1), u.removeChild(d), l = p = d = null, f.extend(b, j))
    });
    return b
  }();
  var j = /^(?:\{.*\}|\[.*\])$/, k = /([A-Z])/g;
  f.extend({cache:{}, uuid:0, expando:"jQuery" + (f.fn.jquery + Math.random()).replace(/\D/g, ""), noData:{embed:!0, object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000", applet:!0}, hasData:function(a) {
    a = a.nodeType ? f.cache[a[f.expando]] : a[f.expando];
    return!!a && !m(a)
  }, data:function(a, c, d, e) {
    if(!!f.acceptData(a)) {
      var g, h, i, j = f.expando, k = typeof c == "string", l = a.nodeType, m = l ? f.cache : a, n = l ? a[j] : a[j] && j, o = c === "events";
      if((!n || !m[n] || !o && !e && !m[n].data) && k && d === b) {
        return
      }
      n || (l ? a[j] = n = ++f.uuid : n = j), m[n] || (m[n] = {}, l || (m[n].toJSON = f.noop));
      if(typeof c == "object" || typeof c == "function") {
        e ? m[n] = f.extend(m[n], c) : m[n].data = f.extend(m[n].data, c)
      }
      g = h = m[n], e || (h.data || (h.data = {}), h = h.data), d !== b && (h[f.camelCase(c)] = d);
      if(o && !h[c]) {
        return g.events
      }
      k ? (i = h[c], i == null && (i = h[f.camelCase(c)])) : i = h;
      return i
    }
  }, removeData:function(a, b, c) {
    if(!!f.acceptData(a)) {
      var d, e, g, h = f.expando, i = a.nodeType, j = i ? f.cache : a, k = i ? a[h] : h;
      if(!j[k]) {
        return
      }
      if(b) {
        d = c ? j[k] : j[k].data;
        if(d) {
          f.isArray(b) || (b in d ? b = [b] : (b = f.camelCase(b), b in d ? b = [b] : b = b.split(" ")));
          for(e = 0, g = b.length;e < g;e++) {
            delete d[b[e]]
          }
          if(!(c ? m : f.isEmptyObject)(d)) {
            return
          }
        }
      }
      if(!c) {
        delete j[k].data;
        if(!m(j[k])) {
          return
        }
      }
      f.support.deleteExpando || !j.setInterval ? delete j[k] : j[k] = null, i && (f.support.deleteExpando ? delete a[h] : a.removeAttribute ? a.removeAttribute(h) : a[h] = null)
    }
  }, _data:function(a, b, c) {
    return f.data(a, b, c, !0)
  }, acceptData:function(a) {
    if(a.nodeName) {
      var b = f.noData[a.nodeName.toLowerCase()];
      if(b) {
        return b !== !0 && a.getAttribute("classid") === b
      }
    }
    return!0
  }}), f.fn.extend({data:function(a, c) {
    var d, e, g, h, i, j = this[0], k = 0, m = null;
    if(a === b) {
      if(this.length) {
        m = f.data(j);
        if(j.nodeType === 1 && !f._data(j, "parsedAttrs")) {
          g = j.attributes;
          for(i = g.length;k < i;k++) {
            h = g[k].name, h.indexOf("data-") === 0 && (h = f.camelCase(h.substring(5)), l(j, h, m[h]))
          }
          f._data(j, "parsedAttrs", !0)
        }
      }
      return m
    }
    if(typeof a == "object") {
      return this.each(function() {
        f.data(this, a)
      })
    }
    d = a.split(".", 2), d[1] = d[1] ? "." + d[1] : "", e = d[1] + "!";
    return f.access(this, function(c) {
      if(c === b) {
        m = this.triggerHandler("getData" + e, [d[0]]), m === b && j && (m = f.data(j, a), m = l(j, a, m));
        return m === b && d[1] ? this.data(d[0]) : m
      }
      d[1] = c, this.each(function() {
        var b = f(this);
        b.triggerHandler("setData" + e, d), f.data(this, a, c), b.triggerHandler("changeData" + e, d)
      })
    }, null, c, arguments.length > 1, null, !1)
  }, removeData:function(a) {
    return this.each(function() {
      f.removeData(this, a)
    })
  }}), f.extend({_mark:function(a, b) {
    a && (b = (b || "fx") + "mark", f._data(a, b, (f._data(a, b) || 0) + 1))
  }, _unmark:function(a, b, c) {
    a !== !0 && (c = b, b = a, a = !1);
    if(b) {
      c = c || "fx";
      var d = c + "mark", e = a ? 0 : (f._data(b, d) || 1) - 1;
      e ? f._data(b, d, e) : (f.removeData(b, d, !0), n(b, c, "mark"))
    }
  }, queue:function(a, b, c) {
    var d;
    if(a) {
      b = (b || "fx") + "queue", d = f._data(a, b), c && (!d || f.isArray(c) ? d = f._data(a, b, f.makeArray(c)) : d.push(c));
      return d || []
    }
  }, dequeue:function(a, b) {
    b = b || "fx";
    var c = f.queue(a, b), d = c.shift(), e = {};
    d === "inprogress" && (d = c.shift()), d && (b === "fx" && c.unshift("inprogress"), f._data(a, b + ".run", e), d.call(a, function() {
      f.dequeue(a, b)
    }, e)), c.length || (f.removeData(a, b + "queue " + b + ".run", !0), n(a, b, "queue"))
  }}), f.fn.extend({queue:function(a, c) {
    var d = 2;
    typeof a != "string" && (c = a, a = "fx", d--);
    if(arguments.length < d) {
      return f.queue(this[0], a)
    }
    return c === b ? this : this.each(function() {
      var b = f.queue(this, a, c);
      a === "fx" && b[0] !== "inprogress" && f.dequeue(this, a)
    })
  }, dequeue:function(a) {
    return this.each(function() {
      f.dequeue(this, a)
    })
  }, delay:function(a, b) {
    a = f.fx ? f.fx.speeds[a] || a : a, b = b || "fx";
    return this.queue(b, function(b, c) {
      var d = setTimeout(b, a);
      c.stop = function() {
        clearTimeout(d)
      }
    })
  }, clearQueue:function(a) {
    return this.queue(a || "fx", [])
  }, promise:function(a, c) {
    function m() {
      --h || d.resolveWith(e, [e])
    }
    typeof a != "string" && (c = a, a = b), a = a || "fx";
    var d = f.Deferred(), e = this, g = e.length, h = 1, i = a + "defer", j = a + "queue", k = a + "mark", l;
    while(g--) {
      if(l = f.data(e[g], i, b, !0) || (f.data(e[g], j, b, !0) || f.data(e[g], k, b, !0)) && f.data(e[g], i, f.Callbacks("once memory"), !0)) {
        h++, l.add(m)
      }
    }
    m();
    return d.promise(c)
  }});
  var o = /[\n\t\r]/g, p = /\s+/, q = /\r/g, r = /^(?:button|input)$/i, s = /^(?:button|input|object|select|textarea)$/i, t = /^a(?:rea)?$/i, u = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, v = f.support.getSetAttribute, w, x, y;
  f.fn.extend({attr:function(a, b) {
    return f.access(this, f.attr, a, b, arguments.length > 1)
  }, removeAttr:function(a) {
    return this.each(function() {
      f.removeAttr(this, a)
    })
  }, prop:function(a, b) {
    return f.access(this, f.prop, a, b, arguments.length > 1)
  }, removeProp:function(a) {
    a = f.propFix[a] || a;
    return this.each(function() {
      try {
        this[a] = b, delete this[a]
      }catch(c) {
      }
    })
  }, addClass:function(a) {
    var b, c, d, e, g, h, i;
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).addClass(a.call(this, b, this.className))
      })
    }
    if(a && typeof a == "string") {
      b = a.split(p);
      for(c = 0, d = this.length;c < d;c++) {
        e = this[c];
        if(e.nodeType === 1) {
          if(!e.className && b.length === 1) {
            e.className = a
          }else {
            g = " " + e.className + " ";
            for(h = 0, i = b.length;h < i;h++) {
              ~g.indexOf(" " + b[h] + " ") || (g += b[h] + " ")
            }
            e.className = f.trim(g)
          }
        }
      }
    }
    return this
  }, removeClass:function(a) {
    var c, d, e, g, h, i, j;
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).removeClass(a.call(this, b, this.className))
      })
    }
    if(a && typeof a == "string" || a === b) {
      c = (a || "").split(p);
      for(d = 0, e = this.length;d < e;d++) {
        g = this[d];
        if(g.nodeType === 1 && g.className) {
          if(a) {
            h = (" " + g.className + " ").replace(o, " ");
            for(i = 0, j = c.length;i < j;i++) {
              h = h.replace(" " + c[i] + " ", " ")
            }
            g.className = f.trim(h)
          }else {
            g.className = ""
          }
        }
      }
    }
    return this
  }, toggleClass:function(a, b) {
    var c = typeof a, d = typeof b == "boolean";
    if(f.isFunction(a)) {
      return this.each(function(c) {
        f(this).toggleClass(a.call(this, c, this.className, b), b)
      })
    }
    return this.each(function() {
      if(c === "string") {
        var e, g = 0, h = f(this), i = b, j = a.split(p);
        while(e = j[g++]) {
          i = d ? i : !h.hasClass(e), h[i ? "addClass" : "removeClass"](e)
        }
      }else {
        if(c === "undefined" || c === "boolean") {
          this.className && f._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : f._data(this, "__className__") || ""
        }
      }
    })
  }, hasClass:function(a) {
    var b = " " + a + " ", c = 0, d = this.length;
    for(;c < d;c++) {
      if(this[c].nodeType === 1 && (" " + this[c].className + " ").replace(o, " ").indexOf(b) > -1) {
        return!0
      }
    }
    return!1
  }, val:function(a) {
    var c, d, e, g = this[0];
    if(!!arguments.length) {
      e = f.isFunction(a);
      return this.each(function(d) {
        var g = f(this), h;
        if(this.nodeType === 1) {
          e ? h = a.call(this, d, g.val()) : h = a, h == null ? h = "" : typeof h == "number" ? h += "" : f.isArray(h) && (h = f.map(h, function(a) {
            return a == null ? "" : a + ""
          })), c = f.valHooks[this.type] || f.valHooks[this.nodeName.toLowerCase()];
          if(!c || !("set" in c) || c.set(this, h, "value") === b) {
            this.value = h
          }
        }
      })
    }
    if(g) {
      c = f.valHooks[g.type] || f.valHooks[g.nodeName.toLowerCase()];
      if(c && "get" in c && (d = c.get(g, "value")) !== b) {
        return d
      }
      d = g.value;
      return typeof d == "string" ? d.replace(q, "") : d == null ? "" : d
    }
  }}), f.extend({valHooks:{option:{get:function(a) {
    var b = a.attributes.value;
    return!b || b.specified ? a.value : a.text
  }}, select:{get:function(a) {
    var b, c, d, e, g = a.selectedIndex, h = [], i = a.options, j = a.type === "select-one";
    if(g < 0) {
      return null
    }
    c = j ? g : 0, d = j ? g + 1 : i.length;
    for(;c < d;c++) {
      e = i[c];
      if(e.selected && (f.support.optDisabled ? !e.disabled : e.getAttribute("disabled") === null) && (!e.parentNode.disabled || !f.nodeName(e.parentNode, "optgroup"))) {
        b = f(e).val();
        if(j) {
          return b
        }
        h.push(b)
      }
    }
    if(j && !h.length && i.length) {
      return f(i[g]).val()
    }
    return h
  }, set:function(a, b) {
    var c = f.makeArray(b);
    f(a).find("option").each(function() {
      this.selected = f.inArray(f(this).val(), c) >= 0
    }), c.length || (a.selectedIndex = -1);
    return c
  }}}, attrFn:{val:!0, css:!0, html:!0, text:!0, data:!0, width:!0, height:!0, offset:!0}, attr:function(a, c, d, e) {
    var g, h, i, j = a.nodeType;
    if(!!a && j !== 3 && j !== 8 && j !== 2) {
      if(e && c in f.attrFn) {
        return f(a)[c](d)
      }
      if(typeof a.getAttribute == "undefined") {
        return f.prop(a, c, d)
      }
      i = j !== 1 || !f.isXMLDoc(a), i && (c = c.toLowerCase(), h = f.attrHooks[c] || (u.test(c) ? x : w));
      if(d !== b) {
        if(d === null) {
          f.removeAttr(a, c);
          return
        }
        if(h && "set" in h && i && (g = h.set(a, d, c)) !== b) {
          return g
        }
        a.setAttribute(c, "" + d);
        return d
      }
      if(h && "get" in h && i && (g = h.get(a, c)) !== null) {
        return g
      }
      g = a.getAttribute(c);
      return g === null ? b : g
    }
  }, removeAttr:function(a, b) {
    var c, d, e, g, h, i = 0;
    if(b && a.nodeType === 1) {
      d = b.toLowerCase().split(p), g = d.length;
      for(;i < g;i++) {
        e = d[i], e && (c = f.propFix[e] || e, h = u.test(e), h || f.attr(a, e, ""), a.removeAttribute(v ? e : c), h && c in a && (a[c] = !1))
      }
    }
  }, attrHooks:{type:{set:function(a, b) {
    if(r.test(a.nodeName) && a.parentNode) {
      f.error("type property can't be changed")
    }else {
      if(!f.support.radioValue && b === "radio" && f.nodeName(a, "input")) {
        var c = a.value;
        a.setAttribute("type", b), c && (a.value = c);
        return b
      }
    }
  }}, value:{get:function(a, b) {
    if(w && f.nodeName(a, "button")) {
      return w.get(a, b)
    }
    return b in a ? a.value : null
  }, set:function(a, b, c) {
    if(w && f.nodeName(a, "button")) {
      return w.set(a, b, c)
    }
    a.value = b
  }}}, propFix:{tabindex:"tabIndex", readonly:"readOnly", "for":"htmlFor", "class":"className", maxlength:"maxLength", cellspacing:"cellSpacing", cellpadding:"cellPadding", rowspan:"rowSpan", colspan:"colSpan", usemap:"useMap", frameborder:"frameBorder", contenteditable:"contentEditable"}, prop:function(a, c, d) {
    var e, g, h, i = a.nodeType;
    if(!!a && i !== 3 && i !== 8 && i !== 2) {
      h = i !== 1 || !f.isXMLDoc(a), h && (c = f.propFix[c] || c, g = f.propHooks[c]);
      return d !== b ? g && "set" in g && (e = g.set(a, d, c)) !== b ? e : a[c] = d : g && "get" in g && (e = g.get(a, c)) !== null ? e : a[c]
    }
  }, propHooks:{tabIndex:{get:function(a) {
    var c = a.getAttributeNode("tabindex");
    return c && c.specified ? parseInt(c.value, 10) : s.test(a.nodeName) || t.test(a.nodeName) && a.href ? 0 : b
  }}}}), f.attrHooks.tabindex = f.propHooks.tabIndex, x = {get:function(a, c) {
    var d, e = f.prop(a, c);
    return e === !0 || typeof e != "boolean" && (d = a.getAttributeNode(c)) && d.nodeValue !== !1 ? c.toLowerCase() : b
  }, set:function(a, b, c) {
    var d;
    b === !1 ? f.removeAttr(a, c) : (d = f.propFix[c] || c, d in a && (a[d] = !0), a.setAttribute(c, c.toLowerCase()));
    return c
  }}, v || (y = {name:!0, id:!0, coords:!0}, w = f.valHooks.button = {get:function(a, c) {
    var d;
    d = a.getAttributeNode(c);
    return d && (y[c] ? d.nodeValue !== "" : d.specified) ? d.nodeValue : b
  }, set:function(a, b, d) {
    var e = a.getAttributeNode(d);
    e || (e = c.createAttribute(d), a.setAttributeNode(e));
    return e.nodeValue = b + ""
  }}, f.attrHooks.tabindex.set = w.set, f.each(["width", "height"], function(a, b) {
    f.attrHooks[b] = f.extend(f.attrHooks[b], {set:function(a, c) {
      if(c === "") {
        a.setAttribute(b, "auto");
        return c
      }
    }})
  }), f.attrHooks.contenteditable = {get:w.get, set:function(a, b, c) {
    b === "" && (b = "false"), w.set(a, b, c)
  }}), f.support.hrefNormalized || f.each(["href", "src", "width", "height"], function(a, c) {
    f.attrHooks[c] = f.extend(f.attrHooks[c], {get:function(a) {
      var d = a.getAttribute(c, 2);
      return d === null ? b : d
    }})
  }), f.support.style || (f.attrHooks.style = {get:function(a) {
    return a.style.cssText.toLowerCase() || b
  }, set:function(a, b) {
    return a.style.cssText = "" + b
  }}), f.support.optSelected || (f.propHooks.selected = f.extend(f.propHooks.selected, {get:function(a) {
    var b = a.parentNode;
    b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex);
    return null
  }})), f.support.enctype || (f.propFix.enctype = "encoding"), f.support.checkOn || f.each(["radio", "checkbox"], function() {
    f.valHooks[this] = {get:function(a) {
      return a.getAttribute("value") === null ? "on" : a.value
    }}
  }), f.each(["radio", "checkbox"], function() {
    f.valHooks[this] = f.extend(f.valHooks[this], {set:function(a, b) {
      if(f.isArray(b)) {
        return a.checked = f.inArray(f(a).val(), b) >= 0
      }
    }})
  });
  var z = /^(?:textarea|input|select)$/i, A = /^([^\.]*)?(?:\.(.+))?$/, B = /(?:^|\s)hover(\.\S+)?\b/, C = /^key/, D = /^(?:mouse|contextmenu)|click/, E = /^(?:focusinfocus|focusoutblur)$/, F = /^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/, G = function(a) {
    var b = F.exec(a);
    b && (b[1] = (b[1] || "").toLowerCase(), b[3] = b[3] && new RegExp("(?:^|\\s)" + b[3] + "(?:\\s|$)"));
    return b
  }, H = function(a, b) {
    var c = a.attributes || {};
    return(!b[1] || a.nodeName.toLowerCase() === b[1]) && (!b[2] || (c.id || {}).value === b[2]) && (!b[3] || b[3].test((c["class"] || {}).value))
  }, I = function(a) {
    return f.event.special.hover ? a : a.replace(B, "mouseenter$1 mouseleave$1")
  };
  f.event = {add:function(a, c, d, e, g) {
    var h, i, j, k, l, m, n, o, p, q, r, s;
    if(!(a.nodeType === 3 || a.nodeType === 8 || !c || !d || !(h = f._data(a)))) {
      d.handler && (p = d, d = p.handler, g = p.selector), d.guid || (d.guid = f.guid++), j = h.events, j || (h.events = j = {}), i = h.handle, i || (h.handle = i = function(a) {
        return typeof f != "undefined" && (!a || f.event.triggered !== a.type) ? f.event.dispatch.apply(i.elem, arguments) : b
      }, i.elem = a), c = f.trim(I(c)).split(" ");
      for(k = 0;k < c.length;k++) {
        l = A.exec(c[k]) || [], m = l[1], n = (l[2] || "").split(".").sort(), s = f.event.special[m] || {}, m = (g ? s.delegateType : s.bindType) || m, s = f.event.special[m] || {}, o = f.extend({type:m, origType:l[1], data:e, handler:d, guid:d.guid, selector:g, quick:g && G(g), namespace:n.join(".")}, p), r = j[m];
        if(!r) {
          r = j[m] = [], r.delegateCount = 0;
          if(!s.setup || s.setup.call(a, e, n, i) === !1) {
            a.addEventListener ? a.addEventListener(m, i, !1) : a.attachEvent && a.attachEvent("on" + m, i)
          }
        }
        s.add && (s.add.call(a, o), o.handler.guid || (o.handler.guid = d.guid)), g ? r.splice(r.delegateCount++, 0, o) : r.push(o), f.event.global[m] = !0
      }
      a = null
    }
  }, global:{}, remove:function(a, b, c, d, e) {
    var g = f.hasData(a) && f._data(a), h, i, j, k, l, m, n, o, p, q, r, s;
    if(!!g && !!(o = g.events)) {
      b = f.trim(I(b || "")).split(" ");
      for(h = 0;h < b.length;h++) {
        i = A.exec(b[h]) || [], j = k = i[1], l = i[2];
        if(!j) {
          for(j in o) {
            f.event.remove(a, j + b[h], c, d, !0)
          }
          continue
        }
        p = f.event.special[j] || {}, j = (d ? p.delegateType : p.bindType) || j, r = o[j] || [], m = r.length, l = l ? new RegExp("(^|\\.)" + l.split(".").sort().join("\\.(?:.*\\.)?") + "(\\.|$)") : null;
        for(n = 0;n < r.length;n++) {
          s = r[n], (e || k === s.origType) && (!c || c.guid === s.guid) && (!l || l.test(s.namespace)) && (!d || d === s.selector || d === "**" && s.selector) && (r.splice(n--, 1), s.selector && r.delegateCount--, p.remove && p.remove.call(a, s))
        }
        r.length === 0 && m !== r.length && ((!p.teardown || p.teardown.call(a, l) === !1) && f.removeEvent(a, j, g.handle), delete o[j])
      }
      f.isEmptyObject(o) && (q = g.handle, q && (q.elem = null), f.removeData(a, ["events", "handle"], !0))
    }
  }, customEvent:{getData:!0, setData:!0, changeData:!0}, trigger:function(c, d, e, g) {
    if(!e || e.nodeType !== 3 && e.nodeType !== 8) {
      var h = c.type || c, i = [], j, k, l, m, n, o, p, q, r, s;
      if(E.test(h + f.event.triggered)) {
        return
      }
      h.indexOf("!") >= 0 && (h = h.slice(0, -1), k = !0), h.indexOf(".") >= 0 && (i = h.split("."), h = i.shift(), i.sort());
      if((!e || f.event.customEvent[h]) && !f.event.global[h]) {
        return
      }
      c = typeof c == "object" ? c[f.expando] ? c : new f.Event(h, c) : new f.Event(h), c.type = h, c.isTrigger = !0, c.exclusive = k, c.namespace = i.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + i.join("\\.(?:.*\\.)?") + "(\\.|$)") : null, o = h.indexOf(":") < 0 ? "on" + h : "";
      if(!e) {
        j = f.cache;
        for(l in j) {
          j[l].events && j[l].events[h] && f.event.trigger(c, d, j[l].handle.elem, !0)
        }
        return
      }
      c.result = b, c.target || (c.target = e), d = d != null ? f.makeArray(d) : [], d.unshift(c), p = f.event.special[h] || {};
      if(p.trigger && p.trigger.apply(e, d) === !1) {
        return
      }
      r = [[e, p.bindType || h]];
      if(!g && !p.noBubble && !f.isWindow(e)) {
        s = p.delegateType || h, m = E.test(s + h) ? e : e.parentNode, n = null;
        for(;m;m = m.parentNode) {
          r.push([m, s]), n = m
        }
        n && n === e.ownerDocument && r.push([n.defaultView || n.parentWindow || a, s])
      }
      for(l = 0;l < r.length && !c.isPropagationStopped();l++) {
        m = r[l][0], c.type = r[l][1], q = (f._data(m, "events") || {})[c.type] && f._data(m, "handle"), q && q.apply(m, d), q = o && m[o], q && f.acceptData(m) && q.apply(m, d) === !1 && c.preventDefault()
      }
      c.type = h, !g && !c.isDefaultPrevented() && (!p._default || p._default.apply(e.ownerDocument, d) === !1) && (h !== "click" || !f.nodeName(e, "a")) && f.acceptData(e) && o && e[h] && (h !== "focus" && h !== "blur" || c.target.offsetWidth !== 0) && !f.isWindow(e) && (n = e[o], n && (e[o] = null), f.event.triggered = h, e[h](), f.event.triggered = b, n && (e[o] = n));
      return c.result
    }
  }, dispatch:function(c) {
    c = f.event.fix(c || a.event);
    var d = (f._data(this, "events") || {})[c.type] || [], e = d.delegateCount, g = [].slice.call(arguments, 0), h = !c.exclusive && !c.namespace, i = f.event.special[c.type] || {}, j = [], k, l, m, n, o, p, q, r, s, t, u;
    g[0] = c, c.delegateTarget = this;
    if(!i.preDispatch || i.preDispatch.call(this, c) !== !1) {
      if(e && (!c.button || c.type !== "click")) {
        n = f(this), n.context = this.ownerDocument || this;
        for(m = c.target;m != this;m = m.parentNode || this) {
          if(m.disabled !== !0) {
            p = {}, r = [], n[0] = m;
            for(k = 0;k < e;k++) {
              s = d[k], t = s.selector, p[t] === b && (p[t] = s.quick ? H(m, s.quick) : n.is(t)), p[t] && r.push(s)
            }
            r.length && j.push({elem:m, matches:r})
          }
        }
      }
      d.length > e && j.push({elem:this, matches:d.slice(e)});
      for(k = 0;k < j.length && !c.isPropagationStopped();k++) {
        q = j[k], c.currentTarget = q.elem;
        for(l = 0;l < q.matches.length && !c.isImmediatePropagationStopped();l++) {
          s = q.matches[l];
          if(h || !c.namespace && !s.namespace || c.namespace_re && c.namespace_re.test(s.namespace)) {
            c.data = s.data, c.handleObj = s, o = ((f.event.special[s.origType] || {}).handle || s.handler).apply(q.elem, g), o !== b && (c.result = o, o === !1 && (c.preventDefault(), c.stopPropagation()))
          }
        }
      }
      i.postDispatch && i.postDispatch.call(this, c);
      return c.result
    }
  }, props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks:{}, keyHooks:{props:"char charCode key keyCode".split(" "), filter:function(a, b) {
    a.which == null && (a.which = b.charCode != null ? b.charCode : b.keyCode);
    return a
  }}, mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter:function(a, d) {
    var e, f, g, h = d.button, i = d.fromElement;
    a.pageX == null && d.clientX != null && (e = a.target.ownerDocument || c, f = e.documentElement, g = e.body, a.pageX = d.clientX + (f && f.scrollLeft || g && g.scrollLeft || 0) - (f && f.clientLeft || g && g.clientLeft || 0), a.pageY = d.clientY + (f && f.scrollTop || g && g.scrollTop || 0) - (f && f.clientTop || g && g.clientTop || 0)), !a.relatedTarget && i && (a.relatedTarget = i === a.target ? d.toElement : i), !a.which && h !== b && (a.which = h & 1 ? 1 : h & 2 ? 3 : h & 4 ? 2 : 0);
    return a
  }}, fix:function(a) {
    if(a[f.expando]) {
      return a
    }
    var d, e, g = a, h = f.event.fixHooks[a.type] || {}, i = h.props ? this.props.concat(h.props) : this.props;
    a = f.Event(g);
    for(d = i.length;d;) {
      e = i[--d], a[e] = g[e]
    }
    a.target || (a.target = g.srcElement || c), a.target.nodeType === 3 && (a.target = a.target.parentNode), a.metaKey === b && (a.metaKey = a.ctrlKey);
    return h.filter ? h.filter(a, g) : a
  }, special:{ready:{setup:f.bindReady}, load:{noBubble:!0}, focus:{delegateType:"focusin"}, blur:{delegateType:"focusout"}, beforeunload:{setup:function(a, b, c) {
    f.isWindow(this) && (this.onbeforeunload = c)
  }, teardown:function(a, b) {
    this.onbeforeunload === b && (this.onbeforeunload = null)
  }}}, simulate:function(a, b, c, d) {
    var e = f.extend(new f.Event, c, {type:a, isSimulated:!0, originalEvent:{}});
    d ? f.event.trigger(e, null, b) : f.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
  }}, f.event.handle = f.event.dispatch, f.removeEvent = c.removeEventListener ? function(a, b, c) {
    a.removeEventListener && a.removeEventListener(b, c, !1)
  } : function(a, b, c) {
    a.detachEvent && a.detachEvent("on" + b, c)
  }, f.Event = function(a, b) {
    if(!(this instanceof f.Event)) {
      return new f.Event(a, b)
    }
    a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault() ? K : J) : this.type = a, b && f.extend(this, b), this.timeStamp = a && a.timeStamp || f.now(), this[f.expando] = !0
  }, f.Event.prototype = {preventDefault:function() {
    this.isDefaultPrevented = K;
    var a = this.originalEvent;
    !a || (a.preventDefault ? a.preventDefault() : a.returnValue = !1)
  }, stopPropagation:function() {
    this.isPropagationStopped = K;
    var a = this.originalEvent;
    !a || (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0)
  }, stopImmediatePropagation:function() {
    this.isImmediatePropagationStopped = K, this.stopPropagation()
  }, isDefaultPrevented:J, isPropagationStopped:J, isImmediatePropagationStopped:J}, f.each({mouseenter:"mouseover", mouseleave:"mouseout"}, function(a, b) {
    f.event.special[a] = {delegateType:b, bindType:b, handle:function(a) {
      var c = this, d = a.relatedTarget, e = a.handleObj, g = e.selector, h;
      if(!d || d !== c && !f.contains(c, d)) {
        a.type = e.origType, h = e.handler.apply(this, arguments), a.type = b
      }
      return h
    }}
  }), f.support.submitBubbles || (f.event.special.submit = {setup:function() {
    if(f.nodeName(this, "form")) {
      return!1
    }
    f.event.add(this, "click._submit keypress._submit", function(a) {
      var c = a.target, d = f.nodeName(c, "input") || f.nodeName(c, "button") ? c.form : b;
      d && !d._submit_attached && (f.event.add(d, "submit._submit", function(a) {
        a._submit_bubble = !0
      }), d._submit_attached = !0)
    })
  }, postDispatch:function(a) {
    a._submit_bubble && (delete a._submit_bubble, this.parentNode && !a.isTrigger && f.event.simulate("submit", this.parentNode, a, !0))
  }, teardown:function() {
    if(f.nodeName(this, "form")) {
      return!1
    }
    f.event.remove(this, "._submit")
  }}), f.support.changeBubbles || (f.event.special.change = {setup:function() {
    if(z.test(this.nodeName)) {
      if(this.type === "checkbox" || this.type === "radio") {
        f.event.add(this, "propertychange._change", function(a) {
          a.originalEvent.propertyName === "checked" && (this._just_changed = !0)
        }), f.event.add(this, "click._change", function(a) {
          this._just_changed && !a.isTrigger && (this._just_changed = !1, f.event.simulate("change", this, a, !0))
        })
      }
      return!1
    }
    f.event.add(this, "beforeactivate._change", function(a) {
      var b = a.target;
      z.test(b.nodeName) && !b._change_attached && (f.event.add(b, "change._change", function(a) {
        this.parentNode && !a.isSimulated && !a.isTrigger && f.event.simulate("change", this.parentNode, a, !0)
      }), b._change_attached = !0)
    })
  }, handle:function(a) {
    var b = a.target;
    if(this !== b || a.isSimulated || a.isTrigger || b.type !== "radio" && b.type !== "checkbox") {
      return a.handleObj.handler.apply(this, arguments)
    }
  }, teardown:function() {
    f.event.remove(this, "._change");
    return z.test(this.nodeName)
  }}), f.support.focusinBubbles || f.each({focus:"focusin", blur:"focusout"}, function(a, b) {
    var d = 0, e = function(a) {
      f.event.simulate(b, a.target, f.event.fix(a), !0)
    };
    f.event.special[b] = {setup:function() {
      d++ === 0 && c.addEventListener(a, e, !0)
    }, teardown:function() {
      --d === 0 && c.removeEventListener(a, e, !0)
    }}
  }), f.fn.extend({on:function(a, c, d, e, g) {
    var h, i;
    if(typeof a == "object") {
      typeof c != "string" && (d = d || c, c = b);
      for(i in a) {
        this.on(i, c, d, a[i], g)
      }
      return this
    }
    d == null && e == null ? (e = c, d = c = b) : e == null && (typeof c == "string" ? (e = d, d = b) : (e = d, d = c, c = b));
    if(e === !1) {
      e = J
    }else {
      if(!e) {
        return this
      }
    }
    g === 1 && (h = e, e = function(a) {
      f().off(a);
      return h.apply(this, arguments)
    }, e.guid = h.guid || (h.guid = f.guid++));
    return this.each(function() {
      f.event.add(this, a, e, d, c)
    })
  }, one:function(a, b, c, d) {
    return this.on(a, b, c, d, 1)
  }, off:function(a, c, d) {
    if(a && a.preventDefault && a.handleObj) {
      var e = a.handleObj;
      f(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace : e.origType, e.selector, e.handler);
      return this
    }
    if(typeof a == "object") {
      for(var g in a) {
        this.off(g, c, a[g])
      }
      return this
    }
    if(c === !1 || typeof c == "function") {
      d = c, c = b
    }
    d === !1 && (d = J);
    return this.each(function() {
      f.event.remove(this, a, d, c)
    })
  }, bind:function(a, b, c) {
    return this.on(a, null, b, c)
  }, unbind:function(a, b) {
    return this.off(a, null, b)
  }, live:function(a, b, c) {
    f(this.context).on(a, this.selector, b, c);
    return this
  }, die:function(a, b) {
    f(this.context).off(a, this.selector || "**", b);
    return this
  }, delegate:function(a, b, c, d) {
    return this.on(b, a, c, d)
  }, undelegate:function(a, b, c) {
    return arguments.length == 1 ? this.off(a, "**") : this.off(b, a, c)
  }, trigger:function(a, b) {
    return this.each(function() {
      f.event.trigger(a, b, this)
    })
  }, triggerHandler:function(a, b) {
    if(this[0]) {
      return f.event.trigger(a, b, this[0], !0)
    }
  }, toggle:function(a) {
    var b = arguments, c = a.guid || f.guid++, d = 0, e = function(c) {
      var e = (f._data(this, "lastToggle" + a.guid) || 0) % d;
      f._data(this, "lastToggle" + a.guid, e + 1), c.preventDefault();
      return b[e].apply(this, arguments) || !1
    };
    e.guid = c;
    while(d < b.length) {
      b[d++].guid = c
    }
    return this.click(e)
  }, hover:function(a, b) {
    return this.mouseenter(a).mouseleave(b || a)
  }}), f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
    f.fn[b] = function(a, c) {
      c == null && (c = a, a = null);
      return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
    }, f.attrFn && (f.attrFn[b] = !0), C.test(b) && (f.event.fixHooks[b] = f.event.keyHooks), D.test(b) && (f.event.fixHooks[b] = f.event.mouseHooks)
  }), function() {
    function x(a, b, c, e, f, g) {
      for(var h = 0, i = e.length;h < i;h++) {
        var j = e[h];
        if(j) {
          var k = !1;
          j = j[a];
          while(j) {
            if(j[d] === c) {
              k = e[j.sizset];
              break
            }
            if(j.nodeType === 1) {
              g || (j[d] = c, j.sizset = h);
              if(typeof b != "string") {
                if(j === b) {
                  k = !0;
                  break
                }
              }else {
                if(m.filter(b, [j]).length > 0) {
                  k = j;
                  break
                }
              }
            }
            j = j[a]
          }
          e[h] = k
        }
      }
    }
    function w(a, b, c, e, f, g) {
      for(var h = 0, i = e.length;h < i;h++) {
        var j = e[h];
        if(j) {
          var k = !1;
          j = j[a];
          while(j) {
            if(j[d] === c) {
              k = e[j.sizset];
              break
            }
            j.nodeType === 1 && !g && (j[d] = c, j.sizset = h);
            if(j.nodeName.toLowerCase() === b) {
              k = j;
              break
            }
            j = j[a]
          }
          e[h] = k
        }
      }
    }
    var a = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, d = "sizcache" + (Math.random() + "").replace(".", ""), e = 0, g = Object.prototype.toString, h = !1, i = !0, j = /\\/g, k = /\r\n/g, l = /\W/;
    [0, 0].sort(function() {
      i = !1;
      return 0
    });
    var m = function(b, d, e, f) {
      e = e || [], d = d || c;
      var h = d;
      if(d.nodeType !== 1 && d.nodeType !== 9) {
        return[]
      }
      if(!b || typeof b != "string") {
        return e
      }
      var i, j, k, l, n, q, r, t, u = !0, v = m.isXML(d), w = [], x = b;
      do {
        a.exec(""), i = a.exec(x);
        if(i) {
          x = i[3], w.push(i[1]);
          if(i[2]) {
            l = i[3];
            break
          }
        }
      }while(i);
      if(w.length > 1 && p.exec(b)) {
        if(w.length === 2 && o.relative[w[0]]) {
          j = y(w[0] + w[1], d, f)
        }else {
          j = o.relative[w[0]] ? [d] : m(w.shift(), d);
          while(w.length) {
            b = w.shift(), o.relative[b] && (b += w.shift()), j = y(b, j, f)
          }
        }
      }else {
        !f && w.length > 1 && d.nodeType === 9 && !v && o.match.ID.test(w[0]) && !o.match.ID.test(w[w.length - 1]) && (n = m.find(w.shift(), d, v), d = n.expr ? m.filter(n.expr, n.set)[0] : n.set[0]);
        if(d) {
          n = f ? {expr:w.pop(), set:s(f)} : m.find(w.pop(), w.length === 1 && (w[0] === "~" || w[0] === "+") && d.parentNode ? d.parentNode : d, v), j = n.expr ? m.filter(n.expr, n.set) : n.set, w.length > 0 ? k = s(j) : u = !1;
          while(w.length) {
            q = w.pop(), r = q, o.relative[q] ? r = w.pop() : q = "", r == null && (r = d), o.relative[q](k, r, v)
          }
        }else {
          k = w = []
        }
      }
      k || (k = j), k || m.error(q || b);
      if(g.call(k) === "[object Array]") {
        if(!u) {
          e.push.apply(e, k)
        }else {
          if(d && d.nodeType === 1) {
            for(t = 0;k[t] != null;t++) {
              k[t] && (k[t] === !0 || k[t].nodeType === 1 && m.contains(d, k[t])) && e.push(j[t])
            }
          }else {
            for(t = 0;k[t] != null;t++) {
              k[t] && k[t].nodeType === 1 && e.push(j[t])
            }
          }
        }
      }else {
        s(k, e)
      }
      l && (m(l, h, e, f), m.uniqueSort(e));
      return e
    };
    m.uniqueSort = function(a) {
      if(u) {
        h = i, a.sort(u);
        if(h) {
          for(var b = 1;b < a.length;b++) {
            a[b] === a[b - 1] && a.splice(b--, 1)
          }
        }
      }
      return a
    }, m.matches = function(a, b) {
      return m(a, null, null, b)
    }, m.matchesSelector = function(a, b) {
      return m(b, null, null, [a]).length > 0
    }, m.find = function(a, b, c) {
      var d, e, f, g, h, i;
      if(!a) {
        return[]
      }
      for(e = 0, f = o.order.length;e < f;e++) {
        h = o.order[e];
        if(g = o.leftMatch[h].exec(a)) {
          i = g[1], g.splice(1, 1);
          if(i.substr(i.length - 1) !== "\\") {
            g[1] = (g[1] || "").replace(j, ""), d = o.find[h](g, b, c);
            if(d != null) {
              a = a.replace(o.match[h], "");
              break
            }
          }
        }
      }
      d || (d = typeof b.getElementsByTagName != "undefined" ? b.getElementsByTagName("*") : []);
      return{set:d, expr:a}
    }, m.filter = function(a, c, d, e) {
      var f, g, h, i, j, k, l, n, p, q = a, r = [], s = c, t = c && c[0] && m.isXML(c[0]);
      while(a && c.length) {
        for(h in o.filter) {
          if((f = o.leftMatch[h].exec(a)) != null && f[2]) {
            k = o.filter[h], l = f[1], g = !1, f.splice(1, 1);
            if(l.substr(l.length - 1) === "\\") {
              continue
            }
            s === r && (r = []);
            if(o.preFilter[h]) {
              f = o.preFilter[h](f, s, d, r, e, t);
              if(!f) {
                g = i = !0
              }else {
                if(f === !0) {
                  continue
                }
              }
            }
            if(f) {
              for(n = 0;(j = s[n]) != null;n++) {
                j && (i = k(j, f, n, s), p = e ^ i, d && i != null ? p ? g = !0 : s[n] = !1 : p && (r.push(j), g = !0))
              }
            }
            if(i !== b) {
              d || (s = r), a = a.replace(o.match[h], "");
              if(!g) {
                return[]
              }
              break
            }
          }
        }
        if(a === q) {
          if(g == null) {
            m.error(a)
          }else {
            break
          }
        }
        q = a
      }
      return s
    }, m.error = function(a) {
      throw new Error("Syntax error, unrecognized expression: " + a);
    };
    var n = m.getText = function(a) {
      var b, c, d = a.nodeType, e = "";
      if(d) {
        if(d === 1 || d === 9 || d === 11) {
          if(typeof a.textContent == "string") {
            return a.textContent
          }
          if(typeof a.innerText == "string") {
            return a.innerText.replace(k, "")
          }
          for(a = a.firstChild;a;a = a.nextSibling) {
            e += n(a)
          }
        }else {
          if(d === 3 || d === 4) {
            return a.nodeValue
          }
        }
      }else {
        for(b = 0;c = a[b];b++) {
          c.nodeType !== 8 && (e += n(c))
        }
      }
      return e
    }, o = m.selectors = {order:["ID", "NAME", "TAG"], match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/, ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/, TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/, CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/, POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/, 
    PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/}, leftMatch:{}, attrMap:{"class":"className", "for":"htmlFor"}, attrHandle:{href:function(a) {
      return a.getAttribute("href")
    }, type:function(a) {
      return a.getAttribute("type")
    }}, relative:{"+":function(a, b) {
      var c = typeof b == "string", d = c && !l.test(b), e = c && !d;
      d && (b = b.toLowerCase());
      for(var f = 0, g = a.length, h;f < g;f++) {
        if(h = a[f]) {
          while((h = h.previousSibling) && h.nodeType !== 1) {
          }
          a[f] = e || h && h.nodeName.toLowerCase() === b ? h || !1 : h === b
        }
      }
      e && m.filter(b, a, !0)
    }, ">":function(a, b) {
      var c, d = typeof b == "string", e = 0, f = a.length;
      if(d && !l.test(b)) {
        b = b.toLowerCase();
        for(;e < f;e++) {
          c = a[e];
          if(c) {
            var g = c.parentNode;
            a[e] = g.nodeName.toLowerCase() === b ? g : !1
          }
        }
      }else {
        for(;e < f;e++) {
          c = a[e], c && (a[e] = d ? c.parentNode : c.parentNode === b)
        }
        d && m.filter(b, a, !0)
      }
    }, "":function(a, b, c) {
      var d, f = e++, g = x;
      typeof b == "string" && !l.test(b) && (b = b.toLowerCase(), d = b, g = w), g("parentNode", b, f, a, d, c)
    }, "~":function(a, b, c) {
      var d, f = e++, g = x;
      typeof b == "string" && !l.test(b) && (b = b.toLowerCase(), d = b, g = w), g("previousSibling", b, f, a, d, c)
    }}, find:{ID:function(a, b, c) {
      if(typeof b.getElementById != "undefined" && !c) {
        var d = b.getElementById(a[1]);
        return d && d.parentNode ? [d] : []
      }
    }, NAME:function(a, b) {
      if(typeof b.getElementsByName != "undefined") {
        var c = [], d = b.getElementsByName(a[1]);
        for(var e = 0, f = d.length;e < f;e++) {
          d[e].getAttribute("name") === a[1] && c.push(d[e])
        }
        return c.length === 0 ? null : c
      }
    }, TAG:function(a, b) {
      if(typeof b.getElementsByTagName != "undefined") {
        return b.getElementsByTagName(a[1])
      }
    }}, preFilter:{CLASS:function(a, b, c, d, e, f) {
      a = " " + a[1].replace(j, "") + " ";
      if(f) {
        return a
      }
      for(var g = 0, h;(h = b[g]) != null;g++) {
        h && (e ^ (h.className && (" " + h.className + " ").replace(/[\t\n\r]/g, " ").indexOf(a) >= 0) ? c || d.push(h) : c && (b[g] = !1))
      }
      return!1
    }, ID:function(a) {
      return a[1].replace(j, "")
    }, TAG:function(a, b) {
      return a[1].replace(j, "").toLowerCase()
    }, CHILD:function(a) {
      if(a[1] === "nth") {
        a[2] || m.error(a[0]), a[2] = a[2].replace(/^\+|\s*/g, "");
        var b = /(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2] === "even" && "2n" || a[2] === "odd" && "2n+1" || !/\D/.test(a[2]) && "0n+" + a[2] || a[2]);
        a[2] = b[1] + (b[2] || 1) - 0, a[3] = b[3] - 0
      }else {
        a[2] && m.error(a[0])
      }
      a[0] = e++;
      return a
    }, ATTR:function(a, b, c, d, e, f) {
      var g = a[1] = a[1].replace(j, "");
      !f && o.attrMap[g] && (a[1] = o.attrMap[g]), a[4] = (a[4] || a[5] || "").replace(j, ""), a[2] === "~=" && (a[4] = " " + a[4] + " ");
      return a
    }, PSEUDO:function(b, c, d, e, f) {
      if(b[1] === "not") {
        if((a.exec(b[3]) || "").length > 1 || /^\w/.test(b[3])) {
          b[3] = m(b[3], null, null, c)
        }else {
          var g = m.filter(b[3], c, d, !0 ^ f);
          d || e.push.apply(e, g);
          return!1
        }
      }else {
        if(o.match.POS.test(b[0]) || o.match.CHILD.test(b[0])) {
          return!0
        }
      }
      return b
    }, POS:function(a) {
      a.unshift(!0);
      return a
    }}, filters:{enabled:function(a) {
      return a.disabled === !1 && a.type !== "hidden"
    }, disabled:function(a) {
      return a.disabled === !0
    }, checked:function(a) {
      return a.checked === !0
    }, selected:function(a) {
      a.parentNode && a.parentNode.selectedIndex;
      return a.selected === !0
    }, parent:function(a) {
      return!!a.firstChild
    }, empty:function(a) {
      return!a.firstChild
    }, has:function(a, b, c) {
      return!!m(c[3], a).length
    }, header:function(a) {
      return/h\d/i.test(a.nodeName)
    }, text:function(a) {
      var b = a.getAttribute("type"), c = a.type;
      return a.nodeName.toLowerCase() === "input" && "text" === c && (b === c || b === null)
    }, radio:function(a) {
      return a.nodeName.toLowerCase() === "input" && "radio" === a.type
    }, checkbox:function(a) {
      return a.nodeName.toLowerCase() === "input" && "checkbox" === a.type
    }, file:function(a) {
      return a.nodeName.toLowerCase() === "input" && "file" === a.type
    }, password:function(a) {
      return a.nodeName.toLowerCase() === "input" && "password" === a.type
    }, submit:function(a) {
      var b = a.nodeName.toLowerCase();
      return(b === "input" || b === "button") && "submit" === a.type
    }, image:function(a) {
      return a.nodeName.toLowerCase() === "input" && "image" === a.type
    }, reset:function(a) {
      var b = a.nodeName.toLowerCase();
      return(b === "input" || b === "button") && "reset" === a.type
    }, button:function(a) {
      var b = a.nodeName.toLowerCase();
      return b === "input" && "button" === a.type || b === "button"
    }, input:function(a) {
      return/input|select|textarea|button/i.test(a.nodeName)
    }, focus:function(a) {
      return a === a.ownerDocument.activeElement
    }}, setFilters:{first:function(a, b) {
      return b === 0
    }, last:function(a, b, c, d) {
      return b === d.length - 1
    }, even:function(a, b) {
      return b % 2 === 0
    }, odd:function(a, b) {
      return b % 2 === 1
    }, lt:function(a, b, c) {
      return b < c[3] - 0
    }, gt:function(a, b, c) {
      return b > c[3] - 0
    }, nth:function(a, b, c) {
      return c[3] - 0 === b
    }, eq:function(a, b, c) {
      return c[3] - 0 === b
    }}, filter:{PSEUDO:function(a, b, c, d) {
      var e = b[1], f = o.filters[e];
      if(f) {
        return f(a, c, b, d)
      }
      if(e === "contains") {
        return(a.textContent || a.innerText || n([a]) || "").indexOf(b[3]) >= 0
      }
      if(e === "not") {
        var g = b[3];
        for(var h = 0, i = g.length;h < i;h++) {
          if(g[h] === a) {
            return!1
          }
        }
        return!0
      }
      m.error(e)
    }, CHILD:function(a, b) {
      var c, e, f, g, h, i, j, k = b[1], l = a;
      switch(k) {
        case "only":
        ;
        case "first":
          while(l = l.previousSibling) {
            if(l.nodeType === 1) {
              return!1
            }
          }
          if(k === "first") {
            return!0
          }
          l = a;
        case "last":
          while(l = l.nextSibling) {
            if(l.nodeType === 1) {
              return!1
            }
          }
          return!0;
        case "nth":
          c = b[2], e = b[3];
          if(c === 1 && e === 0) {
            return!0
          }
          f = b[0], g = a.parentNode;
          if(g && (g[d] !== f || !a.nodeIndex)) {
            i = 0;
            for(l = g.firstChild;l;l = l.nextSibling) {
              l.nodeType === 1 && (l.nodeIndex = ++i)
            }
            g[d] = f
          }
          j = a.nodeIndex - e;
          return c === 0 ? j === 0 : j % c === 0 && j / c >= 0
      }
    }, ID:function(a, b) {
      return a.nodeType === 1 && a.getAttribute("id") === b
    }, TAG:function(a, b) {
      return b === "*" && a.nodeType === 1 || !!a.nodeName && a.nodeName.toLowerCase() === b
    }, CLASS:function(a, b) {
      return(" " + (a.className || a.getAttribute("class")) + " ").indexOf(b) > -1
    }, ATTR:function(a, b) {
      var c = b[1], d = m.attr ? m.attr(a, c) : o.attrHandle[c] ? o.attrHandle[c](a) : a[c] != null ? a[c] : a.getAttribute(c), e = d + "", f = b[2], g = b[4];
      return d == null ? f === "!=" : !f && m.attr ? d != null : f === "=" ? e === g : f === "*=" ? e.indexOf(g) >= 0 : f === "~=" ? (" " + e + " ").indexOf(g) >= 0 : g ? f === "!=" ? e !== g : f === "^=" ? e.indexOf(g) === 0 : f === "$=" ? e.substr(e.length - g.length) === g : f === "|=" ? e === g || e.substr(0, g.length + 1) === g + "-" : !1 : e && d !== !1
    }, POS:function(a, b, c, d) {
      var e = b[2], f = o.setFilters[e];
      if(f) {
        return f(a, c, b, d)
      }
    }}}, p = o.match.POS, q = function(a, b) {
      return"\\" + (b - 0 + 1)
    };
    for(var r in o.match) {
      o.match[r] = new RegExp(o.match[r].source + /(?![^\[]*\])(?![^\(]*\))/.source), o.leftMatch[r] = new RegExp(/(^(?:.|\r|\n)*?)/.source + o.match[r].source.replace(/\\(\d+)/g, q))
    }
    o.match.globalPOS = p;
    var s = function(a, b) {
      a = Array.prototype.slice.call(a, 0);
      if(b) {
        b.push.apply(b, a);
        return b
      }
      return a
    };
    try {
      Array.prototype.slice.call(c.documentElement.childNodes, 0)[0].nodeType
    }catch(t) {
      s = function(a, b) {
        var c = 0, d = b || [];
        if(g.call(a) === "[object Array]") {
          Array.prototype.push.apply(d, a)
        }else {
          if(typeof a.length == "number") {
            for(var e = a.length;c < e;c++) {
              d.push(a[c])
            }
          }else {
            for(;a[c];c++) {
              d.push(a[c])
            }
          }
        }
        return d
      }
    }
    var u, v;
    c.documentElement.compareDocumentPosition ? u = function(a, b) {
      if(a === b) {
        h = !0;
        return 0
      }
      if(!a.compareDocumentPosition || !b.compareDocumentPosition) {
        return a.compareDocumentPosition ? -1 : 1
      }
      return a.compareDocumentPosition(b) & 4 ? -1 : 1
    } : (u = function(a, b) {
      if(a === b) {
        h = !0;
        return 0
      }
      if(a.sourceIndex && b.sourceIndex) {
        return a.sourceIndex - b.sourceIndex
      }
      var c, d, e = [], f = [], g = a.parentNode, i = b.parentNode, j = g;
      if(g === i) {
        return v(a, b)
      }
      if(!g) {
        return-1
      }
      if(!i) {
        return 1
      }
      while(j) {
        e.unshift(j), j = j.parentNode
      }
      j = i;
      while(j) {
        f.unshift(j), j = j.parentNode
      }
      c = e.length, d = f.length;
      for(var k = 0;k < c && k < d;k++) {
        if(e[k] !== f[k]) {
          return v(e[k], f[k])
        }
      }
      return k === c ? v(a, f[k], -1) : v(e[k], b, 1)
    }, v = function(a, b, c) {
      if(a === b) {
        return c
      }
      var d = a.nextSibling;
      while(d) {
        if(d === b) {
          return-1
        }
        d = d.nextSibling
      }
      return 1
    }), function() {
      var a = c.createElement("div"), d = "script" + (new Date).getTime(), e = c.documentElement;
      a.innerHTML = "<a name='" + d + "'/>", e.insertBefore(a, e.firstChild), c.getElementById(d) && (o.find.ID = function(a, c, d) {
        if(typeof c.getElementById != "undefined" && !d) {
          var e = c.getElementById(a[1]);
          return e ? e.id === a[1] || typeof e.getAttributeNode != "undefined" && e.getAttributeNode("id").nodeValue === a[1] ? [e] : b : []
        }
      }, o.filter.ID = function(a, b) {
        var c = typeof a.getAttributeNode != "undefined" && a.getAttributeNode("id");
        return a.nodeType === 1 && c && c.nodeValue === b
      }), e.removeChild(a), e = a = null
    }(), function() {
      var a = c.createElement("div");
      a.appendChild(c.createComment("")), a.getElementsByTagName("*").length > 0 && (o.find.TAG = function(a, b) {
        var c = b.getElementsByTagName(a[1]);
        if(a[1] === "*") {
          var d = [];
          for(var e = 0;c[e];e++) {
            c[e].nodeType === 1 && d.push(c[e])
          }
          c = d
        }
        return c
      }), a.innerHTML = "<a href='#'></a>", a.firstChild && typeof a.firstChild.getAttribute != "undefined" && a.firstChild.getAttribute("href") !== "#" && (o.attrHandle.href = function(a) {
        return a.getAttribute("href", 2)
      }), a = null
    }(), c.querySelectorAll && function() {
      var a = m, b = c.createElement("div"), d = "__sizzle__";
      b.innerHTML = "<p class='TEST'></p>";
      if(!b.querySelectorAll || b.querySelectorAll(".TEST").length !== 0) {
        m = function(b, e, f, g) {
          e = e || c;
          if(!g && !m.isXML(e)) {
            var h = /^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);
            if(h && (e.nodeType === 1 || e.nodeType === 9)) {
              if(h[1]) {
                return s(e.getElementsByTagName(b), f)
              }
              if(h[2] && o.find.CLASS && e.getElementsByClassName) {
                return s(e.getElementsByClassName(h[2]), f)
              }
            }
            if(e.nodeType === 9) {
              if(b === "body" && e.body) {
                return s([e.body], f)
              }
              if(h && h[3]) {
                var i = e.getElementById(h[3]);
                if(!i || !i.parentNode) {
                  return s([], f)
                }
                if(i.id === h[3]) {
                  return s([i], f)
                }
              }
              try {
                return s(e.querySelectorAll(b), f)
              }catch(j) {
              }
            }else {
              if(e.nodeType === 1 && e.nodeName.toLowerCase() !== "object") {
                var k = e, l = e.getAttribute("id"), n = l || d, p = e.parentNode, q = /^\s*[+~]/.test(b);
                l ? n = n.replace(/'/g, "\\$&") : e.setAttribute("id", n), q && p && (e = e.parentNode);
                try {
                  if(!q || p) {
                    return s(e.querySelectorAll("[id='" + n + "'] " + b), f)
                  }
                }catch(r) {
                }finally {
                  l || k.removeAttribute("id")
                }
              }
            }
          }
          return a(b, e, f, g)
        };
        for(var e in a) {
          m[e] = a[e]
        }
        b = null
      }
    }(), function() {
      var a = c.documentElement, b = a.matchesSelector || a.mozMatchesSelector || a.webkitMatchesSelector || a.msMatchesSelector;
      if(b) {
        var d = !b.call(c.createElement("div"), "div"), e = !1;
        try {
          b.call(c.documentElement, "[test!='']:sizzle")
        }catch(f) {
          e = !0
        }
        m.matchesSelector = function(a, c) {
          c = c.replace(/\=\s*([^'"\]]*)\s*\]/g, "='$1']");
          if(!m.isXML(a)) {
            try {
              if(e || !o.match.PSEUDO.test(c) && !/!=/.test(c)) {
                var f = b.call(a, c);
                if(f || !d || a.document && a.document.nodeType !== 11) {
                  return f
                }
              }
            }catch(g) {
            }
          }
          return m(c, null, null, [a]).length > 0
        }
      }
    }(), function() {
      var a = c.createElement("div");
      a.innerHTML = "<div class='test e'></div><div class='test'></div>";
      if(!!a.getElementsByClassName && a.getElementsByClassName("e").length !== 0) {
        a.lastChild.className = "e";
        if(a.getElementsByClassName("e").length === 1) {
          return
        }
        o.order.splice(1, 0, "CLASS"), o.find.CLASS = function(a, b, c) {
          if(typeof b.getElementsByClassName != "undefined" && !c) {
            return b.getElementsByClassName(a[1])
          }
        }, a = null
      }
    }(), c.documentElement.contains ? m.contains = function(a, b) {
      return a !== b && (a.contains ? a.contains(b) : !0)
    } : c.documentElement.compareDocumentPosition ? m.contains = function(a, b) {
      return!!(a.compareDocumentPosition(b) & 16)
    } : m.contains = function() {
      return!1
    }, m.isXML = function(a) {
      var b = (a ? a.ownerDocument || a : 0).documentElement;
      return b ? b.nodeName !== "HTML" : !1
    };
    var y = function(a, b, c) {
      var d, e = [], f = "", g = b.nodeType ? [b] : b;
      while(d = o.match.PSEUDO.exec(a)) {
        f += d[0], a = a.replace(o.match.PSEUDO, "")
      }
      a = o.relative[a] ? a + "*" : a;
      for(var h = 0, i = g.length;h < i;h++) {
        m(a, g[h], e, c)
      }
      return m.filter(f, e)
    };
    m.attr = f.attr, m.selectors.attrMap = {}, f.find = m, f.expr = m.selectors, f.expr[":"] = f.expr.filters, f.unique = m.uniqueSort, f.text = m.getText, f.isXMLDoc = m.isXML, f.contains = m.contains
  }();
  var L = /Until$/, M = /^(?:parents|prevUntil|prevAll)/, N = /,/, O = /^.[^:#\[\.,]*$/, P = Array.prototype.slice, Q = f.expr.match.globalPOS, R = {children:!0, contents:!0, next:!0, prev:!0};
  f.fn.extend({find:function(a) {
    var b = this, c, d;
    if(typeof a != "string") {
      return f(a).filter(function() {
        for(c = 0, d = b.length;c < d;c++) {
          if(f.contains(b[c], this)) {
            return!0
          }
        }
      })
    }
    var e = this.pushStack("", "find", a), g, h, i;
    for(c = 0, d = this.length;c < d;c++) {
      g = e.length, f.find(a, this[c], e);
      if(c > 0) {
        for(h = g;h < e.length;h++) {
          for(i = 0;i < g;i++) {
            if(e[i] === e[h]) {
              e.splice(h--, 1);
              break
            }
          }
        }
      }
    }
    return e
  }, has:function(a) {
    var b = f(a);
    return this.filter(function() {
      for(var a = 0, c = b.length;a < c;a++) {
        if(f.contains(this, b[a])) {
          return!0
        }
      }
    })
  }, not:function(a) {
    return this.pushStack(T(this, a, !1), "not", a)
  }, filter:function(a) {
    return this.pushStack(T(this, a, !0), "filter", a)
  }, is:function(a) {
    return!!a && (typeof a == "string" ? Q.test(a) ? f(a, this.context).index(this[0]) >= 0 : f.filter(a, this).length > 0 : this.filter(a).length > 0)
  }, closest:function(a, b) {
    var c = [], d, e, g = this[0];
    if(f.isArray(a)) {
      var h = 1;
      while(g && g.ownerDocument && g !== b) {
        for(d = 0;d < a.length;d++) {
          f(g).is(a[d]) && c.push({selector:a[d], elem:g, level:h})
        }
        g = g.parentNode, h++
      }
      return c
    }
    var i = Q.test(a) || typeof a != "string" ? f(a, b || this.context) : 0;
    for(d = 0, e = this.length;d < e;d++) {
      g = this[d];
      while(g) {
        if(i ? i.index(g) > -1 : f.find.matchesSelector(g, a)) {
          c.push(g);
          break
        }
        g = g.parentNode;
        if(!g || !g.ownerDocument || g === b || g.nodeType === 11) {
          break
        }
      }
    }
    c = c.length > 1 ? f.unique(c) : c;
    return this.pushStack(c, "closest", a)
  }, index:function(a) {
    if(!a) {
      return this[0] && this[0].parentNode ? this.prevAll().length : -1
    }
    if(typeof a == "string") {
      return f.inArray(this[0], f(a))
    }
    return f.inArray(a.jquery ? a[0] : a, this)
  }, add:function(a, b) {
    var c = typeof a == "string" ? f(a, b) : f.makeArray(a && a.nodeType ? [a] : a), d = f.merge(this.get(), c);
    return this.pushStack(S(c[0]) || S(d[0]) ? d : f.unique(d))
  }, andSelf:function() {
    return this.add(this.prevObject)
  }}), f.each({parent:function(a) {
    var b = a.parentNode;
    return b && b.nodeType !== 11 ? b : null
  }, parents:function(a) {
    return f.dir(a, "parentNode")
  }, parentsUntil:function(a, b, c) {
    return f.dir(a, "parentNode", c)
  }, next:function(a) {
    return f.nth(a, 2, "nextSibling")
  }, prev:function(a) {
    return f.nth(a, 2, "previousSibling")
  }, nextAll:function(a) {
    return f.dir(a, "nextSibling")
  }, prevAll:function(a) {
    return f.dir(a, "previousSibling")
  }, nextUntil:function(a, b, c) {
    return f.dir(a, "nextSibling", c)
  }, prevUntil:function(a, b, c) {
    return f.dir(a, "previousSibling", c)
  }, siblings:function(a) {
    return f.sibling((a.parentNode || {}).firstChild, a)
  }, children:function(a) {
    return f.sibling(a.firstChild)
  }, contents:function(a) {
    return f.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : f.makeArray(a.childNodes)
  }}, function(a, b) {
    f.fn[a] = function(c, d) {
      var e = f.map(this, b, c);
      L.test(a) || (d = c), d && typeof d == "string" && (e = f.filter(d, e)), e = this.length > 1 && !R[a] ? f.unique(e) : e, (this.length > 1 || N.test(d)) && M.test(a) && (e = e.reverse());
      return this.pushStack(e, a, P.call(arguments).join(","))
    }
  }), f.extend({filter:function(a, b, c) {
    c && (a = ":not(" + a + ")");
    return b.length === 1 ? f.find.matchesSelector(b[0], a) ? [b[0]] : [] : f.find.matches(a, b)
  }, dir:function(a, c, d) {
    var e = [], g = a[c];
    while(g && g.nodeType !== 9 && (d === b || g.nodeType !== 1 || !f(g).is(d))) {
      g.nodeType === 1 && e.push(g), g = g[c]
    }
    return e
  }, nth:function(a, b, c, d) {
    b = b || 1;
    var e = 0;
    for(;a;a = a[c]) {
      if(a.nodeType === 1 && ++e === b) {
        break
      }
    }
    return a
  }, sibling:function(a, b) {
    var c = [];
    for(;a;a = a.nextSibling) {
      a.nodeType === 1 && a !== b && c.push(a)
    }
    return c
  }});
  var V = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", W = / jQuery\d+="(?:\d+|null)"/g, X = /^\s+/, Y = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig, Z = /<([\w:]+)/, $ = /<tbody/i, _ = /<|&#?\w+;/, ba = /<(?:script|style)/i, bb = /<(?:script|object|embed|option|style)/i, bc = new RegExp("<(?:" + V + ")[\\s/>]", "i"), bd = /checked\s*(?:[^=]|=\s*.checked.)/i, 
  be = /\/(java|ecma)script/i, bf = /^\s*<!(?:\[CDATA\[|\-\-)/, bg = {option:[1, "<select multiple='multiple'>", "</select>"], legend:[1, "<fieldset>", "</fieldset>"], thead:[1, "<table>", "</table>"], tr:[2, "<table><tbody>", "</tbody></table>"], td:[3, "<table><tbody><tr>", "</tr></tbody></table>"], col:[2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"], area:[1, "<map>", "</map>"], _default:[0, "", ""]}, bh = U(c);
  bg.optgroup = bg.option, bg.tbody = bg.tfoot = bg.colgroup = bg.caption = bg.thead, bg.th = bg.td, f.support.htmlSerialize || (bg._default = [1, "div<div>", "</div>"]), f.fn.extend({text:function(a) {
    return f.access(this, function(a) {
      return a === b ? f.text(this) : this.empty().append((this[0] && this[0].ownerDocument || c).createTextNode(a))
    }, null, a, arguments.length)
  }, wrapAll:function(a) {
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).wrapAll(a.call(this, b))
      })
    }
    if(this[0]) {
      var b = f(a, this[0].ownerDocument).eq(0).clone(!0);
      this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
        var a = this;
        while(a.firstChild && a.firstChild.nodeType === 1) {
          a = a.firstChild
        }
        return a
      }).append(this)
    }
    return this
  }, wrapInner:function(a) {
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).wrapInner(a.call(this, b))
      })
    }
    return this.each(function() {
      var b = f(this), c = b.contents();
      c.length ? c.wrapAll(a) : b.append(a)
    })
  }, wrap:function(a) {
    var b = f.isFunction(a);
    return this.each(function(c) {
      f(this).wrapAll(b ? a.call(this, c) : a)
    })
  }, unwrap:function() {
    return this.parent().each(function() {
      f.nodeName(this, "body") || f(this).replaceWith(this.childNodes)
    }).end()
  }, append:function() {
    return this.domManip(arguments, !0, function(a) {
      this.nodeType === 1 && this.appendChild(a)
    })
  }, prepend:function() {
    return this.domManip(arguments, !0, function(a) {
      this.nodeType === 1 && this.insertBefore(a, this.firstChild)
    })
  }, before:function() {
    if(this[0] && this[0].parentNode) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this)
      })
    }
    if(arguments.length) {
      var a = f.clean(arguments);
      a.push.apply(a, this.toArray());
      return this.pushStack(a, "before", arguments)
    }
  }, after:function() {
    if(this[0] && this[0].parentNode) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this.nextSibling)
      })
    }
    if(arguments.length) {
      var a = this.pushStack(this, "after", arguments);
      a.push.apply(a, f.clean(arguments));
      return a
    }
  }, remove:function(a, b) {
    for(var c = 0, d;(d = this[c]) != null;c++) {
      if(!a || f.filter(a, [d]).length) {
        !b && d.nodeType === 1 && (f.cleanData(d.getElementsByTagName("*")), f.cleanData([d])), d.parentNode && d.parentNode.removeChild(d)
      }
    }
    return this
  }, empty:function() {
    for(var a = 0, b;(b = this[a]) != null;a++) {
      b.nodeType === 1 && f.cleanData(b.getElementsByTagName("*"));
      while(b.firstChild) {
        b.removeChild(b.firstChild)
      }
    }
    return this
  }, clone:function(a, b) {
    a = a == null ? !1 : a, b = b == null ? a : b;
    return this.map(function() {
      return f.clone(this, a, b)
    })
  }, html:function(a) {
    return f.access(this, function(a) {
      var c = this[0] || {}, d = 0, e = this.length;
      if(a === b) {
        return c.nodeType === 1 ? c.innerHTML.replace(W, "") : null
      }
      if(typeof a == "string" && !ba.test(a) && (f.support.leadingWhitespace || !X.test(a)) && !bg[(Z.exec(a) || ["", ""])[1].toLowerCase()]) {
        a = a.replace(Y, "<$1></$2>");
        try {
          for(;d < e;d++) {
            c = this[d] || {}, c.nodeType === 1 && (f.cleanData(c.getElementsByTagName("*")), c.innerHTML = a)
          }
          c = 0
        }catch(g) {
        }
      }
      c && this.empty().append(a)
    }, null, a, arguments.length)
  }, replaceWith:function(a) {
    if(this[0] && this[0].parentNode) {
      if(f.isFunction(a)) {
        return this.each(function(b) {
          var c = f(this), d = c.html();
          c.replaceWith(a.call(this, b, d))
        })
      }
      typeof a != "string" && (a = f(a).detach());
      return this.each(function() {
        var b = this.nextSibling, c = this.parentNode;
        f(this).remove(), b ? f(b).before(a) : f(c).append(a)
      })
    }
    return this.length ? this.pushStack(f(f.isFunction(a) ? a() : a), "replaceWith", a) : this
  }, detach:function(a) {
    return this.remove(a, !0)
  }, domManip:function(a, c, d) {
    var e, g, h, i, j = a[0], k = [];
    if(!f.support.checkClone && arguments.length === 3 && typeof j == "string" && bd.test(j)) {
      return this.each(function() {
        f(this).domManip(a, c, d, !0)
      })
    }
    if(f.isFunction(j)) {
      return this.each(function(e) {
        var g = f(this);
        a[0] = j.call(this, e, c ? g.html() : b), g.domManip(a, c, d)
      })
    }
    if(this[0]) {
      i = j && j.parentNode, f.support.parentNode && i && i.nodeType === 11 && i.childNodes.length === this.length ? e = {fragment:i} : e = f.buildFragment(a, this, k), h = e.fragment, h.childNodes.length === 1 ? g = h = h.firstChild : g = h.firstChild;
      if(g) {
        c = c && f.nodeName(g, "tr");
        for(var l = 0, m = this.length, n = m - 1;l < m;l++) {
          d.call(c ? bi(this[l], g) : this[l], e.cacheable || m > 1 && l < n ? f.clone(h, !0, !0) : h)
        }
      }
      k.length && f.each(k, function(a, b) {
        b.src ? f.ajax({type:"GET", global:!1, url:b.src, async:!1, dataType:"script"}) : f.globalEval((b.text || b.textContent || b.innerHTML || "").replace(bf, "/*$0*/")), b.parentNode && b.parentNode.removeChild(b)
      })
    }
    return this
  }}), f.buildFragment = function(a, b, d) {
    var e, g, h, i, j = a[0];
    b && b[0] && (i = b[0].ownerDocument || b[0]), i.createDocumentFragment || (i = c), a.length === 1 && typeof j == "string" && j.length < 512 && i === c && j.charAt(0) === "<" && !bb.test(j) && (f.support.checkClone || !bd.test(j)) && (f.support.html5Clone || !bc.test(j)) && (g = !0, h = f.fragments[j], h && h !== 1 && (e = h)), e || (e = i.createDocumentFragment(), f.clean(a, i, e, d)), g && (f.fragments[j] = h ? e : 1);
    return{fragment:e, cacheable:g}
  }, f.fragments = {}, f.each({appendTo:"append", prependTo:"prepend", insertBefore:"before", insertAfter:"after", replaceAll:"replaceWith"}, function(a, b) {
    f.fn[a] = function(c) {
      var d = [], e = f(c), g = this.length === 1 && this[0].parentNode;
      if(g && g.nodeType === 11 && g.childNodes.length === 1 && e.length === 1) {
        e[b](this[0]);
        return this
      }
      for(var h = 0, i = e.length;h < i;h++) {
        var j = (h > 0 ? this.clone(!0) : this).get();
        f(e[h])[b](j), d = d.concat(j)
      }
      return this.pushStack(d, a, e.selector)
    }
  }), f.extend({clone:function(a, b, c) {
    var d, e, g, h = f.support.html5Clone || f.isXMLDoc(a) || !bc.test("<" + a.nodeName + ">") ? a.cloneNode(!0) : bo(a);
    if((!f.support.noCloneEvent || !f.support.noCloneChecked) && (a.nodeType === 1 || a.nodeType === 11) && !f.isXMLDoc(a)) {
      bk(a, h), d = bl(a), e = bl(h);
      for(g = 0;d[g];++g) {
        e[g] && bk(d[g], e[g])
      }
    }
    if(b) {
      bj(a, h);
      if(c) {
        d = bl(a), e = bl(h);
        for(g = 0;d[g];++g) {
          bj(d[g], e[g])
        }
      }
    }
    d = e = null;
    return h
  }, clean:function(a, b, d, e) {
    var g, h, i, j = [];
    b = b || c, typeof b.createElement == "undefined" && (b = b.ownerDocument || b[0] && b[0].ownerDocument || c);
    for(var k = 0, l;(l = a[k]) != null;k++) {
      typeof l == "number" && (l += "");
      if(!l) {
        continue
      }
      if(typeof l == "string") {
        if(!_.test(l)) {
          l = b.createTextNode(l)
        }else {
          l = l.replace(Y, "<$1></$2>");
          var m = (Z.exec(l) || ["", ""])[1].toLowerCase(), n = bg[m] || bg._default, o = n[0], p = b.createElement("div"), q = bh.childNodes, r;
          b === c ? bh.appendChild(p) : U(b).appendChild(p), p.innerHTML = n[1] + l + n[2];
          while(o--) {
            p = p.lastChild
          }
          if(!f.support.tbody) {
            var s = $.test(l), t = m === "table" && !s ? p.firstChild && p.firstChild.childNodes : n[1] === "<table>" && !s ? p.childNodes : [];
            for(i = t.length - 1;i >= 0;--i) {
              f.nodeName(t[i], "tbody") && !t[i].childNodes.length && t[i].parentNode.removeChild(t[i])
            }
          }
          !f.support.leadingWhitespace && X.test(l) && p.insertBefore(b.createTextNode(X.exec(l)[0]), p.firstChild), l = p.childNodes, p && (p.parentNode.removeChild(p), q.length > 0 && (r = q[q.length - 1], r && r.parentNode && r.parentNode.removeChild(r)))
        }
      }
      var u;
      if(!f.support.appendChecked) {
        if(l[0] && typeof(u = l.length) == "number") {
          for(i = 0;i < u;i++) {
            bn(l[i])
          }
        }else {
          bn(l)
        }
      }
      l.nodeType ? j.push(l) : j = f.merge(j, l)
    }
    if(d) {
      g = function(a) {
        return!a.type || be.test(a.type)
      };
      for(k = 0;j[k];k++) {
        h = j[k];
        if(e && f.nodeName(h, "script") && (!h.type || be.test(h.type))) {
          e.push(h.parentNode ? h.parentNode.removeChild(h) : h)
        }else {
          if(h.nodeType === 1) {
            var v = f.grep(h.getElementsByTagName("script"), g);
            j.splice.apply(j, [k + 1, 0].concat(v))
          }
          d.appendChild(h)
        }
      }
    }
    return j
  }, cleanData:function(a) {
    var b, c, d = f.cache, e = f.event.special, g = f.support.deleteExpando;
    for(var h = 0, i;(i = a[h]) != null;h++) {
      if(i.nodeName && f.noData[i.nodeName.toLowerCase()]) {
        continue
      }
      c = i[f.expando];
      if(c) {
        b = d[c];
        if(b && b.events) {
          for(var j in b.events) {
            e[j] ? f.event.remove(i, j) : f.removeEvent(i, j, b.handle)
          }
          b.handle && (b.handle.elem = null)
        }
        g ? delete i[f.expando] : i.removeAttribute && i.removeAttribute(f.expando), delete d[c]
      }
    }
  }});
  var bp = /alpha\([^)]*\)/i, bq = /opacity=([^)]*)/, br = /([A-Z]|^ms)/g, bs = /^[\-+]?(?:\d*\.)?\d+$/i, bt = /^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i, bu = /^([\-+])=([\-+.\de]+)/, bv = /^margin/, bw = {position:"absolute", visibility:"hidden", display:"block"}, bx = ["Top", "Right", "Bottom", "Left"], by, bz, bA;
  f.fn.css = function(a, c) {
    return f.access(this, function(a, c, d) {
      return d !== b ? f.style(a, c, d) : f.css(a, c)
    }, a, c, arguments.length > 1)
  }, f.extend({cssHooks:{opacity:{get:function(a, b) {
    if(b) {
      var c = by(a, "opacity");
      return c === "" ? "1" : c
    }
    return a.style.opacity
  }}}, cssNumber:{fillOpacity:!0, fontWeight:!0, lineHeight:!0, opacity:!0, orphans:!0, widows:!0, zIndex:!0, zoom:!0}, cssProps:{"float":f.support.cssFloat ? "cssFloat" : "styleFloat"}, style:function(a, c, d, e) {
    if(!!a && a.nodeType !== 3 && a.nodeType !== 8 && !!a.style) {
      var g, h, i = f.camelCase(c), j = a.style, k = f.cssHooks[i];
      c = f.cssProps[i] || i;
      if(d === b) {
        if(k && "get" in k && (g = k.get(a, !1, e)) !== b) {
          return g
        }
        return j[c]
      }
      h = typeof d, h === "string" && (g = bu.exec(d)) && (d = +(g[1] + 1) * +g[2] + parseFloat(f.css(a, c)), h = "number");
      if(d == null || h === "number" && isNaN(d)) {
        return
      }
      h === "number" && !f.cssNumber[i] && (d += "px");
      if(!k || !("set" in k) || (d = k.set(a, d)) !== b) {
        try {
          j[c] = d
        }catch(l) {
        }
      }
    }
  }, css:function(a, c, d) {
    var e, g;
    c = f.camelCase(c), g = f.cssHooks[c], c = f.cssProps[c] || c, c === "cssFloat" && (c = "float");
    if(g && "get" in g && (e = g.get(a, !0, d)) !== b) {
      return e
    }
    if(by) {
      return by(a, c)
    }
  }, swap:function(a, b, c) {
    var d = {}, e, f;
    for(f in b) {
      d[f] = a.style[f], a.style[f] = b[f]
    }
    e = c.call(a);
    for(f in b) {
      a.style[f] = d[f]
    }
    return e
  }}), f.curCSS = f.css, c.defaultView && c.defaultView.getComputedStyle && (bz = function(a, b) {
    var c, d, e, g, h = a.style;
    b = b.replace(br, "-$1").toLowerCase(), (d = a.ownerDocument.defaultView) && (e = d.getComputedStyle(a, null)) && (c = e.getPropertyValue(b), c === "" && !f.contains(a.ownerDocument.documentElement, a) && (c = f.style(a, b))), !f.support.pixelMargin && e && bv.test(b) && bt.test(c) && (g = h.width, h.width = c, c = e.width, h.width = g);
    return c
  }), c.documentElement.currentStyle && (bA = function(a, b) {
    var c, d, e, f = a.currentStyle && a.currentStyle[b], g = a.style;
    f == null && g && (e = g[b]) && (f = e), bt.test(f) && (c = g.left, d = a.runtimeStyle && a.runtimeStyle.left, d && (a.runtimeStyle.left = a.currentStyle.left), g.left = b === "fontSize" ? "1em" : f, f = g.pixelLeft + "px", g.left = c, d && (a.runtimeStyle.left = d));
    return f === "" ? "auto" : f
  }), by = bz || bA, f.each(["height", "width"], function(a, b) {
    f.cssHooks[b] = {get:function(a, c, d) {
      if(c) {
        return a.offsetWidth !== 0 ? bB(a, b, d) : f.swap(a, bw, function() {
          return bB(a, b, d)
        })
      }
    }, set:function(a, b) {
      return bs.test(b) ? b + "px" : b
    }}
  }), f.support.opacity || (f.cssHooks.opacity = {get:function(a, b) {
    return bq.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? parseFloat(RegExp.$1) / 100 + "" : b ? "1" : ""
  }, set:function(a, b) {
    var c = a.style, d = a.currentStyle, e = f.isNumeric(b) ? "alpha(opacity=" + b * 100 + ")" : "", g = d && d.filter || c.filter || "";
    c.zoom = 1;
    if(b >= 1 && f.trim(g.replace(bp, "")) === "") {
      c.removeAttribute("filter");
      if(d && !d.filter) {
        return
      }
    }
    c.filter = bp.test(g) ? g.replace(bp, e) : g + " " + e
  }}), f(function() {
    f.support.reliableMarginRight || (f.cssHooks.marginRight = {get:function(a, b) {
      return f.swap(a, {display:"inline-block"}, function() {
        return b ? by(a, "margin-right") : a.style.marginRight
      })
    }})
  }), f.expr && f.expr.filters && (f.expr.filters.hidden = function(a) {
    var b = a.offsetWidth, c = a.offsetHeight;
    return b === 0 && c === 0 || !f.support.reliableHiddenOffsets && (a.style && a.style.display || f.css(a, "display")) === "none"
  }, f.expr.filters.visible = function(a) {
    return!f.expr.filters.hidden(a)
  }), f.each({margin:"", padding:"", border:"Width"}, function(a, b) {
    f.cssHooks[a + b] = {expand:function(c) {
      var d, e = typeof c == "string" ? c.split(" ") : [c], f = {};
      for(d = 0;d < 4;d++) {
        f[a + bx[d] + b] = e[d] || e[d - 2] || e[0]
      }
      return f
    }}
  });
  var bC = /%20/g, bD = /\[\]$/, bE = /\r?\n/g, bF = /#.*$/, bG = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg, bH = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i, bI = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/, bJ = /^(?:GET|HEAD)$/, bK = /^\/\//, bL = /\?/, bM = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, bN = /^(?:select|textarea)/i, bO = /\s+/, bP = /([?&])_=[^&]*/, bQ = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/, 
  bR = f.fn.load, bS = {}, bT = {}, bU, bV, bW = ["*/"] + ["*"];
  try {
    bU = e.href
  }catch(bX) {
    bU = c.createElement("a"), bU.href = "", bU = bU.href
  }
  bV = bQ.exec(bU.toLowerCase()) || [], f.fn.extend({load:function(a, c, d) {
    if(typeof a != "string" && bR) {
      return bR.apply(this, arguments)
    }
    if(!this.length) {
      return this
    }
    var e = a.indexOf(" ");
    if(e >= 0) {
      var g = a.slice(e, a.length);
      a = a.slice(0, e)
    }
    var h = "GET";
    c && (f.isFunction(c) ? (d = c, c = b) : typeof c == "object" && (c = f.param(c, f.ajaxSettings.traditional), h = "POST"));
    var i = this;
    f.ajax({url:a, type:h, dataType:"html", data:c, complete:function(a, b, c) {
      c = a.responseText, a.isResolved() && (a.done(function(a) {
        c = a
      }), i.html(g ? f("<div>").append(c.replace(bM, "")).find(g) : c)), d && i.each(d, [c, b, a])
    }});
    return this
  }, serialize:function() {
    return f.param(this.serializeArray())
  }, serializeArray:function() {
    return this.map(function() {
      return this.elements ? f.makeArray(this.elements) : this
    }).filter(function() {
      return this.name && !this.disabled && (this.checked || bN.test(this.nodeName) || bH.test(this.type))
    }).map(function(a, b) {
      var c = f(this).val();
      return c == null ? null : f.isArray(c) ? f.map(c, function(a, c) {
        return{name:b.name, value:a.replace(bE, "\r\n")}
      }) : {name:b.name, value:c.replace(bE, "\r\n")}
    }).get()
  }}), f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function(a, b) {
    f.fn[b] = function(a) {
      return this.on(b, a)
    }
  }), f.each(["get", "post"], function(a, c) {
    f[c] = function(a, d, e, g) {
      f.isFunction(d) && (g = g || e, e = d, d = b);
      return f.ajax({type:c, url:a, data:d, success:e, dataType:g})
    }
  }), f.extend({getScript:function(a, c) {
    return f.get(a, b, c, "script")
  }, getJSON:function(a, b, c) {
    return f.get(a, b, c, "json")
  }, ajaxSetup:function(a, b) {
    b ? b$(a, f.ajaxSettings) : (b = a, a = f.ajaxSettings), b$(a, b);
    return a
  }, ajaxSettings:{url:bU, isLocal:bI.test(bV[1]), global:!0, type:"GET", contentType:"application/x-www-form-urlencoded; charset=UTF-8", processData:!0, async:!0, accepts:{xml:"application/xml, text/xml", html:"text/html", text:"text/plain", json:"application/json, text/javascript", "*":bW}, contents:{xml:/xml/, html:/html/, json:/json/}, responseFields:{xml:"responseXML", text:"responseText"}, converters:{"* text":a.String, "text html":!0, "text json":f.parseJSON, "text xml":f.parseXML}, flatOptions:{context:!0, 
  url:!0}}, ajaxPrefilter:bY(bS), ajaxTransport:bY(bT), ajax:function(a, c) {
    function w(a, c, l, m) {
      if(s !== 2) {
        s = 2, q && clearTimeout(q), p = b, n = m || "", v.readyState = a > 0 ? 4 : 0;
        var o, r, u, w = c, x = l ? ca(d, v, l) : b, y, z;
        if(a >= 200 && a < 300 || a === 304) {
          if(d.ifModified) {
            if(y = v.getResponseHeader("Last-Modified")) {
              f.lastModified[k] = y
            }
            if(z = v.getResponseHeader("Etag")) {
              f.etag[k] = z
            }
          }
          if(a === 304) {
            w = "notmodified", o = !0
          }else {
            try {
              r = cb(d, x), w = "success", o = !0
            }catch(A) {
              w = "parsererror", u = A
            }
          }
        }else {
          u = w;
          if(!w || a) {
            w = "error", a < 0 && (a = 0)
          }
        }
        v.status = a, v.statusText = "" + (c || w), o ? h.resolveWith(e, [r, w, v]) : h.rejectWith(e, [v, w, u]), v.statusCode(j), j = b, t && g.trigger("ajax" + (o ? "Success" : "Error"), [v, d, o ? r : u]), i.fireWith(e, [v, w]), t && (g.trigger("ajaxComplete", [v, d]), --f.active || f.event.trigger("ajaxStop"))
      }
    }
    typeof a == "object" && (c = a, a = b), c = c || {};
    var d = f.ajaxSetup({}, c), e = d.context || d, g = e !== d && (e.nodeType || e instanceof f) ? f(e) : f.event, h = f.Deferred(), i = f.Callbacks("once memory"), j = d.statusCode || {}, k, l = {}, m = {}, n, o, p, q, r, s = 0, t, u, v = {readyState:0, setRequestHeader:function(a, b) {
      if(!s) {
        var c = a.toLowerCase();
        a = m[c] = m[c] || a, l[a] = b
      }
      return this
    }, getAllResponseHeaders:function() {
      return s === 2 ? n : null
    }, getResponseHeader:function(a) {
      var c;
      if(s === 2) {
        if(!o) {
          o = {};
          while(c = bG.exec(n)) {
            o[c[1].toLowerCase()] = c[2]
          }
        }
        c = o[a.toLowerCase()]
      }
      return c === b ? null : c
    }, overrideMimeType:function(a) {
      s || (d.mimeType = a);
      return this
    }, abort:function(a) {
      a = a || "abort", p && p.abort(a), w(0, a);
      return this
    }};
    h.promise(v), v.success = v.done, v.error = v.fail, v.complete = i.add, v.statusCode = function(a) {
      if(a) {
        var b;
        if(s < 2) {
          for(b in a) {
            j[b] = [j[b], a[b]]
          }
        }else {
          b = a[v.status], v.then(b, b)
        }
      }
      return this
    }, d.url = ((a || d.url) + "").replace(bF, "").replace(bK, bV[1] + "//"), d.dataTypes = f.trim(d.dataType || "*").toLowerCase().split(bO), d.crossDomain == null && (r = bQ.exec(d.url.toLowerCase()), d.crossDomain = !(!r || r[1] == bV[1] && r[2] == bV[2] && (r[3] || (r[1] === "http:" ? 80 : 443)) == (bV[3] || (bV[1] === "http:" ? 80 : 443)))), d.data && d.processData && typeof d.data != "string" && (d.data = f.param(d.data, d.traditional)), bZ(bS, d, c, v);
    if(s === 2) {
      return!1
    }
    t = d.global, d.type = d.type.toUpperCase(), d.hasContent = !bJ.test(d.type), t && f.active++ === 0 && f.event.trigger("ajaxStart");
    if(!d.hasContent) {
      d.data && (d.url += (bL.test(d.url) ? "&" : "?") + d.data, delete d.data), k = d.url;
      if(d.cache === !1) {
        var x = f.now(), y = d.url.replace(bP, "$1_=" + x);
        d.url = y + (y === d.url ? (bL.test(d.url) ? "&" : "?") + "_=" + x : "")
      }
    }
    (d.data && d.hasContent && d.contentType !== !1 || c.contentType) && v.setRequestHeader("Content-Type", d.contentType), d.ifModified && (k = k || d.url, f.lastModified[k] && v.setRequestHeader("If-Modified-Since", f.lastModified[k]), f.etag[k] && v.setRequestHeader("If-None-Match", f.etag[k])), v.setRequestHeader("Accept", d.dataTypes[0] && d.accepts[d.dataTypes[0]] ? d.accepts[d.dataTypes[0]] + (d.dataTypes[0] !== "*" ? ", " + bW + "; q=0.01" : "") : d.accepts["*"]);
    for(u in d.headers) {
      v.setRequestHeader(u, d.headers[u])
    }
    if(d.beforeSend && (d.beforeSend.call(e, v, d) === !1 || s === 2)) {
      v.abort();
      return!1
    }
    for(u in{success:1, error:1, complete:1}) {
      v[u](d[u])
    }
    p = bZ(bT, d, c, v);
    if(!p) {
      w(-1, "No Transport")
    }else {
      v.readyState = 1, t && g.trigger("ajaxSend", [v, d]), d.async && d.timeout > 0 && (q = setTimeout(function() {
        v.abort("timeout")
      }, d.timeout));
      try {
        s = 1, p.send(l, w)
      }catch(z) {
        if(s < 2) {
          w(-1, z)
        }else {
          throw z;
        }
      }
    }
    return v
  }, param:function(a, c) {
    var d = [], e = function(a, b) {
      b = f.isFunction(b) ? b() : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
    };
    c === b && (c = f.ajaxSettings.traditional);
    if(f.isArray(a) || a.jquery && !f.isPlainObject(a)) {
      f.each(a, function() {
        e(this.name, this.value)
      })
    }else {
      for(var g in a) {
        b_(g, a[g], c, e)
      }
    }
    return d.join("&").replace(bC, "+")
  }}), f.extend({active:0, lastModified:{}, etag:{}});
  var cc = f.now(), cd = /(\=)\?(&|$)|\?\?/i;
  f.ajaxSetup({jsonp:"callback", jsonpCallback:function() {
    return f.expando + "_" + cc++
  }}), f.ajaxPrefilter("json jsonp", function(b, c, d) {
    var e = typeof b.data == "string" && /^application\/x\-www\-form\-urlencoded/.test(b.contentType);
    if(b.dataTypes[0] === "jsonp" || b.jsonp !== !1 && (cd.test(b.url) || e && cd.test(b.data))) {
      var g, h = b.jsonpCallback = f.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, i = a[h], j = b.url, k = b.data, l = "$1" + h + "$2";
      b.jsonp !== !1 && (j = j.replace(cd, l), b.url === j && (e && (k = k.replace(cd, l)), b.data === k && (j += (/\?/.test(j) ? "&" : "?") + b.jsonp + "=" + h))), b.url = j, b.data = k, a[h] = function(a) {
        g = [a]
      }, d.always(function() {
        a[h] = i, g && f.isFunction(i) && a[h](g[0])
      }), b.converters["script json"] = function() {
        g || f.error(h + " was not called");
        return g[0]
      }, b.dataTypes[0] = "json";
      return"script"
    }
  }), f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents:{script:/javascript|ecmascript/}, converters:{"text script":function(a) {
    f.globalEval(a);
    return a
  }}}), f.ajaxPrefilter("script", function(a) {
    a.cache === b && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1)
  }), f.ajaxTransport("script", function(a) {
    if(a.crossDomain) {
      var d, e = c.head || c.getElementsByTagName("head")[0] || c.documentElement;
      return{send:function(f, g) {
        d = c.createElement("script"), d.async = "async", a.scriptCharset && (d.charset = a.scriptCharset), d.src = a.url, d.onload = d.onreadystatechange = function(a, c) {
          if(c || !d.readyState || /loaded|complete/.test(d.readyState)) {
            d.onload = d.onreadystatechange = null, e && d.parentNode && e.removeChild(d), d = b, c || g(200, "success")
          }
        }, e.insertBefore(d, e.firstChild)
      }, abort:function() {
        d && d.onload(0, 1)
      }}
    }
  });
  var ce = a.ActiveXObject ? function() {
    for(var a in cg) {
      cg[a](0, 1)
    }
  } : !1, cf = 0, cg;
  f.ajaxSettings.xhr = a.ActiveXObject ? function() {
    return!this.isLocal && ch() || ci()
  } : ch, function(a) {
    f.extend(f.support, {ajax:!!a, cors:!!a && "withCredentials" in a})
  }(f.ajaxSettings.xhr()), f.support.ajax && f.ajaxTransport(function(c) {
    if(!c.crossDomain || f.support.cors) {
      var d;
      return{send:function(e, g) {
        var h = c.xhr(), i, j;
        c.username ? h.open(c.type, c.url, c.async, c.username, c.password) : h.open(c.type, c.url, c.async);
        if(c.xhrFields) {
          for(j in c.xhrFields) {
            h[j] = c.xhrFields[j]
          }
        }
        c.mimeType && h.overrideMimeType && h.overrideMimeType(c.mimeType), !c.crossDomain && !e["X-Requested-With"] && (e["X-Requested-With"] = "XMLHttpRequest");
        try {
          for(j in e) {
            h.setRequestHeader(j, e[j])
          }
        }catch(k) {
        }
        h.send(c.hasContent && c.data || null), d = function(a, e) {
          var j, k, l, m, n;
          try {
            if(d && (e || h.readyState === 4)) {
              d = b, i && (h.onreadystatechange = f.noop, ce && delete cg[i]);
              if(e) {
                h.readyState !== 4 && h.abort()
              }else {
                j = h.status, l = h.getAllResponseHeaders(), m = {}, n = h.responseXML, n && n.documentElement && (m.xml = n);
                try {
                  m.text = h.responseText
                }catch(a) {
                }
                try {
                  k = h.statusText
                }catch(o) {
                  k = ""
                }
                !j && c.isLocal && !c.crossDomain ? j = m.text ? 200 : 404 : j === 1223 && (j = 204)
              }
            }
          }catch(p) {
            e || g(-1, p)
          }
          m && g(j, k, m, l)
        }, !c.async || h.readyState === 4 ? d() : (i = ++cf, ce && (cg || (cg = {}, f(a).unload(ce)), cg[i] = d), h.onreadystatechange = d)
      }, abort:function() {
        d && d(0, 1)
      }}
    }
  });
  var cj = {}, ck, cl, cm = /^(?:toggle|show|hide)$/, cn = /^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i, co, cp = [["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"], ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"], ["opacity"]], cq;
  f.fn.extend({show:function(a, b, c) {
    var d, e;
    if(a || a === 0) {
      return this.animate(ct("show", 3), a, b, c)
    }
    for(var g = 0, h = this.length;g < h;g++) {
      d = this[g], d.style && (e = d.style.display, !f._data(d, "olddisplay") && e === "none" && (e = d.style.display = ""), (e === "" && f.css(d, "display") === "none" || !f.contains(d.ownerDocument.documentElement, d)) && f._data(d, "olddisplay", cu(d.nodeName)))
    }
    for(g = 0;g < h;g++) {
      d = this[g];
      if(d.style) {
        e = d.style.display;
        if(e === "" || e === "none") {
          d.style.display = f._data(d, "olddisplay") || ""
        }
      }
    }
    return this
  }, hide:function(a, b, c) {
    if(a || a === 0) {
      return this.animate(ct("hide", 3), a, b, c)
    }
    var d, e, g = 0, h = this.length;
    for(;g < h;g++) {
      d = this[g], d.style && (e = f.css(d, "display"), e !== "none" && !f._data(d, "olddisplay") && f._data(d, "olddisplay", e))
    }
    for(g = 0;g < h;g++) {
      this[g].style && (this[g].style.display = "none")
    }
    return this
  }, _toggle:f.fn.toggle, toggle:function(a, b, c) {
    var d = typeof a == "boolean";
    f.isFunction(a) && f.isFunction(b) ? this._toggle.apply(this, arguments) : a == null || d ? this.each(function() {
      var b = d ? a : f(this).is(":hidden");
      f(this)[b ? "show" : "hide"]()
    }) : this.animate(ct("toggle", 3), a, b, c);
    return this
  }, fadeTo:function(a, b, c, d) {
    return this.filter(":hidden").css("opacity", 0).show().end().animate({opacity:b}, a, c, d)
  }, animate:function(a, b, c, d) {
    function g() {
      e.queue === !1 && f._mark(this);
      var b = f.extend({}, e), c = this.nodeType === 1, d = c && f(this).is(":hidden"), g, h, i, j, k, l, m, n, o, p, q;
      b.animatedProperties = {};
      for(i in a) {
        g = f.camelCase(i), i !== g && (a[g] = a[i], delete a[i]);
        if((k = f.cssHooks[g]) && "expand" in k) {
          l = k.expand(a[g]), delete a[g];
          for(i in l) {
            i in a || (a[i] = l[i])
          }
        }
      }
      for(g in a) {
        h = a[g], f.isArray(h) ? (b.animatedProperties[g] = h[1], h = a[g] = h[0]) : b.animatedProperties[g] = b.specialEasing && b.specialEasing[g] || b.easing || "swing";
        if(h === "hide" && d || h === "show" && !d) {
          return b.complete.call(this)
        }
        c && (g === "height" || g === "width") && (b.overflow = [this.style.overflow, this.style.overflowX, this.style.overflowY], f.css(this, "display") === "inline" && f.css(this, "float") === "none" && (!f.support.inlineBlockNeedsLayout || cu(this.nodeName) === "inline" ? this.style.display = "inline-block" : this.style.zoom = 1))
      }
      b.overflow != null && (this.style.overflow = "hidden");
      for(i in a) {
        j = new f.fx(this, b, i), h = a[i], cm.test(h) ? (q = f._data(this, "toggle" + i) || (h === "toggle" ? d ? "show" : "hide" : 0), q ? (f._data(this, "toggle" + i, q === "show" ? "hide" : "show"), j[q]()) : j[h]()) : (m = cn.exec(h), n = j.cur(), m ? (o = parseFloat(m[2]), p = m[3] || (f.cssNumber[i] ? "" : "px"), p !== "px" && (f.style(this, i, (o || 1) + p), n = (o || 1) / j.cur() * n, f.style(this, i, n + p)), m[1] && (o = (m[1] === "-=" ? -1 : 1) * o + n), j.custom(n, o, p)) : j.custom(n, 
        h, ""))
      }
      return!0
    }
    var e = f.speed(b, c, d);
    if(f.isEmptyObject(a)) {
      return this.each(e.complete, [!1])
    }
    a = f.extend({}, a);
    return e.queue === !1 ? this.each(g) : this.queue(e.queue, g)
  }, stop:function(a, c, d) {
    typeof a != "string" && (d = c, c = a, a = b), c && a !== !1 && this.queue(a || "fx", []);
    return this.each(function() {
      function h(a, b, c) {
        var e = b[c];
        f.removeData(a, c, !0), e.stop(d)
      }
      var b, c = !1, e = f.timers, g = f._data(this);
      d || f._unmark(!0, this);
      if(a == null) {
        for(b in g) {
          g[b] && g[b].stop && b.indexOf(".run") === b.length - 4 && h(this, g, b)
        }
      }else {
        g[b = a + ".run"] && g[b].stop && h(this, g, b)
      }
      for(b = e.length;b--;) {
        e[b].elem === this && (a == null || e[b].queue === a) && (d ? e[b](!0) : e[b].saveState(), c = !0, e.splice(b, 1))
      }
      (!d || !c) && f.dequeue(this, a)
    })
  }}), f.each({slideDown:ct("show", 1), slideUp:ct("hide", 1), slideToggle:ct("toggle", 1), fadeIn:{opacity:"show"}, fadeOut:{opacity:"hide"}, fadeToggle:{opacity:"toggle"}}, function(a, b) {
    f.fn[a] = function(a, c, d) {
      return this.animate(b, a, c, d)
    }
  }), f.extend({speed:function(a, b, c) {
    var d = a && typeof a == "object" ? f.extend({}, a) : {complete:c || !c && b || f.isFunction(a) && a, duration:a, easing:c && b || b && !f.isFunction(b) && b};
    d.duration = f.fx.off ? 0 : typeof d.duration == "number" ? d.duration : d.duration in f.fx.speeds ? f.fx.speeds[d.duration] : f.fx.speeds._default;
    if(d.queue == null || d.queue === !0) {
      d.queue = "fx"
    }
    d.old = d.complete, d.complete = function(a) {
      f.isFunction(d.old) && d.old.call(this), d.queue ? f.dequeue(this, d.queue) : a !== !1 && f._unmark(this)
    };
    return d
  }, easing:{linear:function(a) {
    return a
  }, swing:function(a) {
    return-Math.cos(a * Math.PI) / 2 + 0.5
  }}, timers:[], fx:function(a, b, c) {
    this.options = b, this.elem = a, this.prop = c, b.orig = b.orig || {}
  }}), f.fx.prototype = {update:function() {
    this.options.step && this.options.step.call(this.elem, this.now, this), (f.fx.step[this.prop] || f.fx.step._default)(this)
  }, cur:function() {
    if(this.elem[this.prop] != null && (!this.elem.style || this.elem.style[this.prop] == null)) {
      return this.elem[this.prop]
    }
    var a, b = f.css(this.elem, this.prop);
    return isNaN(a = parseFloat(b)) ? !b || b === "auto" ? 0 : b : a
  }, custom:function(a, c, d) {
    function h(a) {
      return e.step(a)
    }
    var e = this, g = f.fx;
    this.startTime = cq || cr(), this.end = c, this.now = this.start = a, this.pos = this.state = 0, this.unit = d || this.unit || (f.cssNumber[this.prop] ? "" : "px"), h.queue = this.options.queue, h.elem = this.elem, h.saveState = function() {
      f._data(e.elem, "fxshow" + e.prop) === b && (e.options.hide ? f._data(e.elem, "fxshow" + e.prop, e.start) : e.options.show && f._data(e.elem, "fxshow" + e.prop, e.end))
    }, h() && f.timers.push(h) && !co && (co = setInterval(g.tick, g.interval))
  }, show:function() {
    var a = f._data(this.elem, "fxshow" + this.prop);
    this.options.orig[this.prop] = a || f.style(this.elem, this.prop), this.options.show = !0, a !== b ? this.custom(this.cur(), a) : this.custom(this.prop === "width" || this.prop === "height" ? 1 : 0, this.cur()), f(this.elem).show()
  }, hide:function() {
    this.options.orig[this.prop] = f._data(this.elem, "fxshow" + this.prop) || f.style(this.elem, this.prop), this.options.hide = !0, this.custom(this.cur(), 0)
  }, step:function(a) {
    var b, c, d, e = cq || cr(), g = !0, h = this.elem, i = this.options;
    if(a || e >= i.duration + this.startTime) {
      this.now = this.end, this.pos = this.state = 1, this.update(), i.animatedProperties[this.prop] = !0;
      for(b in i.animatedProperties) {
        i.animatedProperties[b] !== !0 && (g = !1)
      }
      if(g) {
        i.overflow != null && !f.support.shrinkWrapBlocks && f.each(["", "X", "Y"], function(a, b) {
          h.style["overflow" + b] = i.overflow[a]
        }), i.hide && f(h).hide();
        if(i.hide || i.show) {
          for(b in i.animatedProperties) {
            f.style(h, b, i.orig[b]), f.removeData(h, "fxshow" + b, !0), f.removeData(h, "toggle" + b, !0)
          }
        }
        d = i.complete, d && (i.complete = !1, d.call(h))
      }
      return!1
    }
    i.duration == Infinity ? this.now = e : (c = e - this.startTime, this.state = c / i.duration, this.pos = f.easing[i.animatedProperties[this.prop]](this.state, c, 0, 1, i.duration), this.now = this.start + (this.end - this.start) * this.pos), this.update();
    return!0
  }}, f.extend(f.fx, {tick:function() {
    var a, b = f.timers, c = 0;
    for(;c < b.length;c++) {
      a = b[c], !a() && b[c] === a && b.splice(c--, 1)
    }
    b.length || f.fx.stop()
  }, interval:13, stop:function() {
    clearInterval(co), co = null
  }, speeds:{slow:600, fast:200, _default:400}, step:{opacity:function(a) {
    f.style(a.elem, "opacity", a.now)
  }, _default:function(a) {
    a.elem.style && a.elem.style[a.prop] != null ? a.elem.style[a.prop] = a.now + a.unit : a.elem[a.prop] = a.now
  }}}), f.each(cp.concat.apply([], cp), function(a, b) {
    b.indexOf("margin") && (f.fx.step[b] = function(a) {
      f.style(a.elem, b, Math.max(0, a.now) + a.unit)
    })
  }), f.expr && f.expr.filters && (f.expr.filters.animated = function(a) {
    return f.grep(f.timers, function(b) {
      return a === b.elem
    }).length
  });
  var cv, cw = /^t(?:able|d|h)$/i, cx = /^(?:body|html)$/i;
  "getBoundingClientRect" in c.documentElement ? cv = function(a, b, c, d) {
    try {
      d = a.getBoundingClientRect()
    }catch(e) {
    }
    if(!d || !f.contains(c, a)) {
      return d ? {top:d.top, left:d.left} : {top:0, left:0}
    }
    var g = b.body, h = cy(b), i = c.clientTop || g.clientTop || 0, j = c.clientLeft || g.clientLeft || 0, k = h.pageYOffset || f.support.boxModel && c.scrollTop || g.scrollTop, l = h.pageXOffset || f.support.boxModel && c.scrollLeft || g.scrollLeft, m = d.top + k - i, n = d.left + l - j;
    return{top:m, left:n}
  } : cv = function(a, b, c) {
    var d, e = a.offsetParent, g = a, h = b.body, i = b.defaultView, j = i ? i.getComputedStyle(a, null) : a.currentStyle, k = a.offsetTop, l = a.offsetLeft;
    while((a = a.parentNode) && a !== h && a !== c) {
      if(f.support.fixedPosition && j.position === "fixed") {
        break
      }
      d = i ? i.getComputedStyle(a, null) : a.currentStyle, k -= a.scrollTop, l -= a.scrollLeft, a === e && (k += a.offsetTop, l += a.offsetLeft, f.support.doesNotAddBorder && (!f.support.doesAddBorderForTableAndCells || !cw.test(a.nodeName)) && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 0), g = e, e = a.offsetParent), f.support.subtractsBorderForOverflowNotVisible && d.overflow !== "visible" && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 
      0), j = d
    }
    if(j.position === "relative" || j.position === "static") {
      k += h.offsetTop, l += h.offsetLeft
    }
    f.support.fixedPosition && j.position === "fixed" && (k += Math.max(c.scrollTop, h.scrollTop), l += Math.max(c.scrollLeft, h.scrollLeft));
    return{top:k, left:l}
  }, f.fn.offset = function(a) {
    if(arguments.length) {
      return a === b ? this : this.each(function(b) {
        f.offset.setOffset(this, a, b)
      })
    }
    var c = this[0], d = c && c.ownerDocument;
    if(!d) {
      return null
    }
    if(c === d.body) {
      return f.offset.bodyOffset(c)
    }
    return cv(c, d, d.documentElement)
  }, f.offset = {bodyOffset:function(a) {
    var b = a.offsetTop, c = a.offsetLeft;
    f.support.doesNotIncludeMarginInBodyOffset && (b += parseFloat(f.css(a, "marginTop")) || 0, c += parseFloat(f.css(a, "marginLeft")) || 0);
    return{top:b, left:c}
  }, setOffset:function(a, b, c) {
    var d = f.css(a, "position");
    d === "static" && (a.style.position = "relative");
    var e = f(a), g = e.offset(), h = f.css(a, "top"), i = f.css(a, "left"), j = (d === "absolute" || d === "fixed") && f.inArray("auto", [h, i]) > -1, k = {}, l = {}, m, n;
    j ? (l = e.position(), m = l.top, n = l.left) : (m = parseFloat(h) || 0, n = parseFloat(i) || 0), f.isFunction(b) && (b = b.call(a, c, g)), b.top != null && (k.top = b.top - g.top + m), b.left != null && (k.left = b.left - g.left + n), "using" in b ? b.using.call(a, k) : e.css(k)
  }}, f.fn.extend({position:function() {
    if(!this[0]) {
      return null
    }
    var a = this[0], b = this.offsetParent(), c = this.offset(), d = cx.test(b[0].nodeName) ? {top:0, left:0} : b.offset();
    c.top -= parseFloat(f.css(a, "marginTop")) || 0, c.left -= parseFloat(f.css(a, "marginLeft")) || 0, d.top += parseFloat(f.css(b[0], "borderTopWidth")) || 0, d.left += parseFloat(f.css(b[0], "borderLeftWidth")) || 0;
    return{top:c.top - d.top, left:c.left - d.left}
  }, offsetParent:function() {
    return this.map(function() {
      var a = this.offsetParent || c.body;
      while(a && !cx.test(a.nodeName) && f.css(a, "position") === "static") {
        a = a.offsetParent
      }
      return a
    })
  }}), f.each({scrollLeft:"pageXOffset", scrollTop:"pageYOffset"}, function(a, c) {
    var d = /Y/.test(c);
    f.fn[a] = function(e) {
      return f.access(this, function(a, e, g) {
        var h = cy(a);
        if(g === b) {
          return h ? c in h ? h[c] : f.support.boxModel && h.document.documentElement[e] || h.document.body[e] : a[e]
        }
        h ? h.scrollTo(d ? f(h).scrollLeft() : g, d ? g : f(h).scrollTop()) : a[e] = g
      }, a, e, arguments.length, null)
    }
  }), f.each({Height:"height", Width:"width"}, function(a, c) {
    var d = "client" + a, e = "scroll" + a, g = "offset" + a;
    f.fn["inner" + a] = function() {
      var a = this[0];
      return a ? a.style ? parseFloat(f.css(a, c, "padding")) : this[c]() : null
    }, f.fn["outer" + a] = function(a) {
      var b = this[0];
      return b ? b.style ? parseFloat(f.css(b, c, a ? "margin" : "border")) : this[c]() : null
    }, f.fn[c] = function(a) {
      return f.access(this, function(a, c, h) {
        var i, j, k, l;
        if(f.isWindow(a)) {
          i = a.document, j = i.documentElement[d];
          return f.support.boxModel && j || i.body && i.body[d] || j
        }
        if(a.nodeType === 9) {
          i = a.documentElement;
          if(i[d] >= i[e]) {
            return i[d]
          }
          return Math.max(a.body[e], i[e], a.body[g], i[g])
        }
        if(h === b) {
          k = f.css(a, c), l = parseFloat(k);
          return f.isNumeric(l) ? l : k
        }
        f(a).css(c, h)
      }, c, a, arguments.length, null)
    }
  }), a.jQuery = a.$ = f, typeof define == "function" && define.amd && define.amd.jQuery && define("jquery", [], function() {
    return f
  })
})(window);
(function(a, b) {
  function c(b, c) {
    var e = b.nodeName.toLowerCase();
    if("area" === e) {
      var f = b.parentNode, g = f.name, h;
      return!b.href || !g || f.nodeName.toLowerCase() !== "map" ? !1 : (h = a("img[usemap=#" + g + "]")[0], !!h && d(h))
    }
    return(/input|select|textarea|button|object/.test(e) ? !b.disabled : "a" == e ? b.href || c : c) && d(b)
  }
  function d(b) {
    return!a(b).parents().andSelf().filter(function() {
      return a.curCSS(this, "visibility") === "hidden" || a.expr.filters.hidden(this)
    }).length
  }
  a.ui = a.ui || {};
  if(a.ui.version) {
    return
  }
  a.extend(a.ui, {version:"1.8.20", keyCode:{ALT:18, BACKSPACE:8, CAPS_LOCK:20, COMMA:188, COMMAND:91, COMMAND_LEFT:91, COMMAND_RIGHT:93, CONTROL:17, DELETE:46, DOWN:40, END:35, ENTER:13, ESCAPE:27, HOME:36, INSERT:45, LEFT:37, MENU:93, NUMPAD_ADD:107, NUMPAD_DECIMAL:110, NUMPAD_DIVIDE:111, NUMPAD_ENTER:108, NUMPAD_MULTIPLY:106, NUMPAD_SUBTRACT:109, PAGE_DOWN:34, PAGE_UP:33, PERIOD:190, RIGHT:39, SHIFT:16, SPACE:32, TAB:9, UP:38, WINDOWS:91}}), a.fn.extend({propAttr:a.fn.prop || a.fn.attr, _focus:a.fn.focus, 
  focus:function(b, c) {
    return typeof b == "number" ? this.each(function() {
      var d = this;
      setTimeout(function() {
        a(d).focus(), c && c.call(d)
      }, b)
    }) : this._focus.apply(this, arguments)
  }, scrollParent:function() {
    var b;
    return a.browser.msie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? b = this.parents().filter(function() {
      return/(relative|absolute|fixed)/.test(a.curCSS(this, "position", 1)) && /(auto|scroll)/.test(a.curCSS(this, "overflow", 1) + a.curCSS(this, "overflow-y", 1) + a.curCSS(this, "overflow-x", 1))
    }).eq(0) : b = this.parents().filter(function() {
      return/(auto|scroll)/.test(a.curCSS(this, "overflow", 1) + a.curCSS(this, "overflow-y", 1) + a.curCSS(this, "overflow-x", 1))
    }).eq(0), /fixed/.test(this.css("position")) || !b.length ? a(document) : b
  }, zIndex:function(c) {
    if(c !== b) {
      return this.css("zIndex", c)
    }
    if(this.length) {
      var d = a(this[0]), e, f;
      while(d.length && d[0] !== document) {
        e = d.css("position");
        if(e === "absolute" || e === "relative" || e === "fixed") {
          f = parseInt(d.css("zIndex"), 10);
          if(!isNaN(f) && f !== 0) {
            return f
          }
        }
        d = d.parent()
      }
    }
    return 0
  }, disableSelection:function() {
    return this.bind((a.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(a) {
      a.preventDefault()
    })
  }, enableSelection:function() {
    return this.unbind(".ui-disableSelection")
  }}), a.each(["Width", "Height"], function(c, d) {
    function h(b, c, d, f) {
      return a.each(e, function() {
        c -= parseFloat(a.curCSS(b, "padding" + this, !0)) || 0, d && (c -= parseFloat(a.curCSS(b, "border" + this + "Width", !0)) || 0), f && (c -= parseFloat(a.curCSS(b, "margin" + this, !0)) || 0)
      }), c
    }
    var e = d === "Width" ? ["Left", "Right"] : ["Top", "Bottom"], f = d.toLowerCase(), g = {innerWidth:a.fn.innerWidth, innerHeight:a.fn.innerHeight, outerWidth:a.fn.outerWidth, outerHeight:a.fn.outerHeight};
    a.fn["inner" + d] = function(c) {
      return c === b ? g["inner" + d].call(this) : this.each(function() {
        a(this).css(f, h(this, c) + "px")
      })
    }, a.fn["outer" + d] = function(b, c) {
      return typeof b != "number" ? g["outer" + d].call(this, b) : this.each(function() {
        a(this).css(f, h(this, b, !0, c) + "px")
      })
    }
  }), a.extend(a.expr[":"], {data:function(b, c, d) {
    return!!a.data(b, d[3])
  }, focusable:function(b) {
    return c(b, !isNaN(a.attr(b, "tabindex")))
  }, tabbable:function(b) {
    var d = a.attr(b, "tabindex"), e = isNaN(d);
    return(e || d >= 0) && c(b, !e)
  }}), a(function() {
    var b = document.body, c = b.appendChild(c = document.createElement("div"));
    c.offsetHeight, a.extend(c.style, {minHeight:"100px", height:"auto", padding:0, borderWidth:0}), a.support.minHeight = c.offsetHeight === 100, a.support.selectstart = "onselectstart" in c, b.removeChild(c).style.display = "none"
  }), a.extend(a.ui, {plugin:{add:function(b, c, d) {
    var e = a.ui[b].prototype;
    for(var f in d) {
      e.plugins[f] = e.plugins[f] || [], e.plugins[f].push([c, d[f]])
    }
  }, call:function(a, b, c) {
    var d = a.plugins[b];
    if(!d || !a.element[0].parentNode) {
      return
    }
    for(var e = 0;e < d.length;e++) {
      a.options[d[e][0]] && d[e][1].apply(a.element, c)
    }
  }}, contains:function(a, b) {
    return document.compareDocumentPosition ? a.compareDocumentPosition(b) & 16 : a !== b && a.contains(b)
  }, hasScroll:function(b, c) {
    if(a(b).css("overflow") === "hidden") {
      return!1
    }
    var d = c && c === "left" ? "scrollLeft" : "scrollTop", e = !1;
    return b[d] > 0 ? !0 : (b[d] = 1, e = b[d] > 0, b[d] = 0, e)
  }, isOverAxis:function(a, b, c) {
    return a > b && a < b + c
  }, isOver:function(b, c, d, e, f, g) {
    return a.ui.isOverAxis(b, d, f) && a.ui.isOverAxis(c, e, g)
  }})
})(jQuery);
(function(a, b) {
  if(a.cleanData) {
    var c = a.cleanData;
    a.cleanData = function(b) {
      for(var d = 0, e;(e = b[d]) != null;d++) {
        try {
          a(e).triggerHandler("remove")
        }catch(f) {
        }
      }
      c(b)
    }
  }else {
    var d = a.fn.remove;
    a.fn.remove = function(b, c) {
      return this.each(function() {
        return c || (!b || a.filter(b, [this]).length) && a("*", this).add([this]).each(function() {
          try {
            a(this).triggerHandler("remove")
          }catch(b) {
          }
        }), d.call(a(this), b, c)
      })
    }
  }
  a.widget = function(b, c, d) {
    var e = b.split(".")[0], f;
    b = b.split(".")[1], f = e + "-" + b, d || (d = c, c = a.Widget), a.expr[":"][f] = function(c) {
      return!!a.data(c, b)
    }, a[e] = a[e] || {}, a[e][b] = function(a, b) {
      arguments.length && this._createWidget(a, b)
    };
    var g = new c;
    g.options = a.extend(!0, {}, g.options), a[e][b].prototype = a.extend(!0, g, {namespace:e, widgetName:b, widgetEventPrefix:a[e][b].prototype.widgetEventPrefix || b, widgetBaseClass:f}, d), a.widget.bridge(b, a[e][b])
  }, a.widget.bridge = function(c, d) {
    a.fn[c] = function(e) {
      var f = typeof e == "string", g = Array.prototype.slice.call(arguments, 1), h = this;
      return e = !f && g.length ? a.extend.apply(null, [!0, e].concat(g)) : e, f && e.charAt(0) === "_" ? h : (f ? this.each(function() {
        var d = a.data(this, c), f = d && a.isFunction(d[e]) ? d[e].apply(d, g) : d;
        if(f !== d && f !== b) {
          return h = f, !1
        }
      }) : this.each(function() {
        var b = a.data(this, c);
        b ? b.option(e || {})._init() : a.data(this, c, new d(e, this))
      }), h)
    }
  }, a.Widget = function(a, b) {
    arguments.length && this._createWidget(a, b)
  }, a.Widget.prototype = {widgetName:"widget", widgetEventPrefix:"", options:{disabled:!1}, _createWidget:function(b, c) {
    a.data(c, this.widgetName, this), this.element = a(c), this.options = a.extend(!0, {}, this.options, this._getCreateOptions(), b);
    var d = this;
    this.element.bind("remove." + this.widgetName, function() {
      d.destroy()
    }), this._create(), this._trigger("create"), this._init()
  }, _getCreateOptions:function() {
    return a.metadata && a.metadata.get(this.element[0])[this.widgetName]
  }, _create:function() {
  }, _init:function() {
  }, destroy:function() {
    this.element.unbind("." + this.widgetName).removeData(this.widgetName), this.widget().unbind("." + this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass + "-disabled " + "ui-state-disabled")
  }, widget:function() {
    return this.element
  }, option:function(c, d) {
    var e = c;
    if(arguments.length === 0) {
      return a.extend({}, this.options)
    }
    if(typeof c == "string") {
      if(d === b) {
        return this.options[c]
      }
      e = {}, e[c] = d
    }
    return this._setOptions(e), this
  }, _setOptions:function(b) {
    var c = this;
    return a.each(b, function(a, b) {
      c._setOption(a, b)
    }), this
  }, _setOption:function(a, b) {
    return this.options[a] = b, a === "disabled" && this.widget()[b ? "addClass" : "removeClass"](this.widgetBaseClass + "-disabled" + " " + "ui-state-disabled").attr("aria-disabled", b), this
  }, enable:function() {
    return this._setOption("disabled", !1)
  }, disable:function() {
    return this._setOption("disabled", !0)
  }, _trigger:function(b, c, d) {
    var e, f, g = this.options[b];
    d = d || {}, c = a.Event(c), c.type = (b === this.widgetEventPrefix ? b : this.widgetEventPrefix + b).toLowerCase(), c.target = this.element[0], f = c.originalEvent;
    if(f) {
      for(e in f) {
        e in c || (c[e] = f[e])
      }
    }
    return this.element.trigger(c, d), !(a.isFunction(g) && g.call(this.element[0], c, d) === !1 || c.isDefaultPrevented())
  }}
})(jQuery);
(function(a, b) {
  var c = !1;
  a(document).mouseup(function(a) {
    c = !1
  }), a.widget("ui.mouse", {options:{cancel:":input,option", distance:1, delay:0}, _mouseInit:function() {
    var b = this;
    this.element.bind("mousedown." + this.widgetName, function(a) {
      return b._mouseDown(a)
    }).bind("click." + this.widgetName, function(c) {
      if(!0 === a.data(c.target, b.widgetName + ".preventClickEvent")) {
        return a.removeData(c.target, b.widgetName + ".preventClickEvent"), c.stopImmediatePropagation(), !1
      }
    }), this.started = !1
  }, _mouseDestroy:function() {
    this.element.unbind("." + this.widgetName), a(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
  }, _mouseDown:function(b) {
    if(c) {
      return
    }
    this._mouseStarted && this._mouseUp(b), this._mouseDownEvent = b;
    var d = this, e = b.which == 1, f = typeof this.options.cancel == "string" && b.target.nodeName ? a(b.target).closest(this.options.cancel).length : !1;
    if(!e || f || !this._mouseCapture(b)) {
      return!0
    }
    this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
      d.mouseDelayMet = !0
    }, this.options.delay));
    if(this._mouseDistanceMet(b) && this._mouseDelayMet(b)) {
      this._mouseStarted = this._mouseStart(b) !== !1;
      if(!this._mouseStarted) {
        return b.preventDefault(), !0
      }
    }
    return!0 === a.data(b.target, this.widgetName + ".preventClickEvent") && a.removeData(b.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(a) {
      return d._mouseMove(a)
    }, this._mouseUpDelegate = function(a) {
      return d._mouseUp(a)
    }, a(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), b.preventDefault(), c = !0, !0
  }, _mouseMove:function(b) {
    return!a.browser.msie || document.documentMode >= 9 || !!b.button ? this._mouseStarted ? (this._mouseDrag(b), b.preventDefault()) : (this._mouseDistanceMet(b) && this._mouseDelayMet(b) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, b) !== !1, this._mouseStarted ? this._mouseDrag(b) : this._mouseUp(b)), !this._mouseStarted) : this._mouseUp(b)
  }, _mouseUp:function(b) {
    return a(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, b.target == this._mouseDownEvent.target && a.data(b.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(b)), !1
  }, _mouseDistanceMet:function(a) {
    return Math.max(Math.abs(this._mouseDownEvent.pageX - a.pageX), Math.abs(this._mouseDownEvent.pageY - a.pageY)) >= this.options.distance
  }, _mouseDelayMet:function(a) {
    return this.mouseDelayMet
  }, _mouseStart:function(a) {
  }, _mouseDrag:function(a) {
  }, _mouseStop:function(a) {
  }, _mouseCapture:function(a) {
    return!0
  }})
})(jQuery);
(function(a, b) {
  a.ui = a.ui || {};
  var c = /left|center|right/, d = /top|center|bottom/, e = "center", f = {}, g = a.fn.position, h = a.fn.offset;
  a.fn.position = function(b) {
    if(!b || !b.of) {
      return g.apply(this, arguments)
    }
    b = a.extend({}, b);
    var h = a(b.of), i = h[0], j = (b.collision || "flip").split(" "), k = b.offset ? b.offset.split(" ") : [0, 0], l, m, n;
    return i.nodeType === 9 ? (l = h.width(), m = h.height(), n = {top:0, left:0}) : i.setTimeout ? (l = h.width(), m = h.height(), n = {top:h.scrollTop(), left:h.scrollLeft()}) : i.preventDefault ? (b.at = "left top", l = m = 0, n = {top:b.of.pageY, left:b.of.pageX}) : (l = h.outerWidth(), m = h.outerHeight(), n = h.offset()), a.each(["my", "at"], function() {
      var a = (b[this] || "").split(" ");
      a.length === 1 && (a = c.test(a[0]) ? a.concat([e]) : d.test(a[0]) ? [e].concat(a) : [e, e]), a[0] = c.test(a[0]) ? a[0] : e, a[1] = d.test(a[1]) ? a[1] : e, b[this] = a
    }), j.length === 1 && (j[1] = j[0]), k[0] = parseInt(k[0], 10) || 0, k.length === 1 && (k[1] = k[0]), k[1] = parseInt(k[1], 10) || 0, b.at[0] === "right" ? n.left += l : b.at[0] === e && (n.left += l / 2), b.at[1] === "bottom" ? n.top += m : b.at[1] === e && (n.top += m / 2), n.left += k[0], n.top += k[1], this.each(function() {
      var c = a(this), d = c.outerWidth(), g = c.outerHeight(), h = parseInt(a.curCSS(this, "marginLeft", !0)) || 0, i = parseInt(a.curCSS(this, "marginTop", !0)) || 0, o = d + h + (parseInt(a.curCSS(this, "marginRight", !0)) || 0), p = g + i + (parseInt(a.curCSS(this, "marginBottom", !0)) || 0), q = a.extend({}, n), r;
      b.my[0] === "right" ? q.left -= d : b.my[0] === e && (q.left -= d / 2), b.my[1] === "bottom" ? q.top -= g : b.my[1] === e && (q.top -= g / 2), f.fractions || (q.left = Math.round(q.left), q.top = Math.round(q.top)), r = {left:q.left - h, top:q.top - i}, a.each(["left", "top"], function(c, e) {
        a.ui.position[j[c]] && a.ui.position[j[c]][e](q, {targetWidth:l, targetHeight:m, elemWidth:d, elemHeight:g, collisionPosition:r, collisionWidth:o, collisionHeight:p, offset:k, my:b.my, at:b.at})
      }), a.fn.bgiframe && c.bgiframe(), c.offset(a.extend(q, {using:b.using}))
    })
  }, a.ui.position = {fit:{left:function(b, c) {
    var d = a(window), e = c.collisionPosition.left + c.collisionWidth - d.width() - d.scrollLeft();
    b.left = e > 0 ? b.left - e : Math.max(b.left - c.collisionPosition.left, b.left)
  }, top:function(b, c) {
    var d = a(window), e = c.collisionPosition.top + c.collisionHeight - d.height() - d.scrollTop();
    b.top = e > 0 ? b.top - e : Math.max(b.top - c.collisionPosition.top, b.top)
  }}, flip:{left:function(b, c) {
    if(c.at[0] === e) {
      return
    }
    var d = a(window), f = c.collisionPosition.left + c.collisionWidth - d.width() - d.scrollLeft(), g = c.my[0] === "left" ? -c.elemWidth : c.my[0] === "right" ? c.elemWidth : 0, h = c.at[0] === "left" ? c.targetWidth : -c.targetWidth, i = -2 * c.offset[0];
    b.left += c.collisionPosition.left < 0 ? g + h + i : f > 0 ? g + h + i : 0
  }, top:function(b, c) {
    if(c.at[1] === e) {
      return
    }
    var d = a(window), f = c.collisionPosition.top + c.collisionHeight - d.height() - d.scrollTop(), g = c.my[1] === "top" ? -c.elemHeight : c.my[1] === "bottom" ? c.elemHeight : 0, h = c.at[1] === "top" ? c.targetHeight : -c.targetHeight, i = -2 * c.offset[1];
    b.top += c.collisionPosition.top < 0 ? g + h + i : f > 0 ? g + h + i : 0
  }}}, a.offset.setOffset || (a.offset.setOffset = function(b, c) {
    /static/.test(a.curCSS(b, "position")) && (b.style.position = "relative");
    var d = a(b), e = d.offset(), f = parseInt(a.curCSS(b, "top", !0), 10) || 0, g = parseInt(a.curCSS(b, "left", !0), 10) || 0, h = {top:c.top - e.top + f, left:c.left - e.left + g};
    "using" in c ? c.using.call(b, h) : d.css(h)
  }, a.fn.offset = function(b) {
    var c = this[0];
    return!c || !c.ownerDocument ? null : b ? this.each(function() {
      a.offset.setOffset(this, b)
    }) : h.call(this)
  }), function() {
    var b = document.getElementsByTagName("body")[0], c = document.createElement("div"), d, e, g, h, i;
    d = document.createElement(b ? "div" : "body"), g = {visibility:"hidden", width:0, height:0, border:0, margin:0, background:"none"}, b && a.extend(g, {position:"absolute", left:"-1000px", top:"-1000px"});
    for(var j in g) {
      d.style[j] = g[j]
    }
    d.appendChild(c), e = b || document.documentElement, e.insertBefore(d, e.firstChild), c.style.cssText = "position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;", h = a(c).offset(function(a, b) {
      return b
    }).offset(), d.innerHTML = "", e.removeChild(d), i = h.top + h.left + (b ? 2E3 : 0), f.fractions = i > 21 && i < 22
  }()
})(jQuery);
(function(a, b) {
  a.widget("ui.draggable", a.ui.mouse, {widgetEventPrefix:"drag", options:{addClasses:!0, appendTo:"parent", axis:!1, connectToSortable:!1, containment:!1, cursor:"auto", cursorAt:!1, grid:!1, handle:!1, helper:"original", iframeFix:!1, opacity:!1, refreshPositions:!1, revert:!1, revertDuration:500, scope:"default", scroll:!0, scrollSensitivity:20, scrollSpeed:20, snap:!1, snapMode:"both", snapTolerance:20, stack:!1, zIndex:!1}, _create:function() {
    this.options.helper == "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
  }, destroy:function() {
    if(!this.element.data("draggable")) {
      return
    }
    return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy(), this
  }, _mouseCapture:function(b) {
    var c = this.options;
    return this.helper || c.disabled || a(b.target).is(".ui-resizable-handle") ? !1 : (this.handle = this._getHandle(b), this.handle ? (c.iframeFix && a(c.iframeFix === !0 ? "iframe" : c.iframeFix).each(function() {
      a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth + "px", height:this.offsetHeight + "px", position:"absolute", opacity:"0.001", zIndex:1E3}).css(a(this).offset()).appendTo("body")
    }), !0) : !1)
  }, _mouseStart:function(b) {
    var c = this.options;
    return this.helper = this._createHelper(b), this._cacheHelperProportions(), a.ui.ddmanager && (a.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, a.extend(this.offset, {click:{left:b.pageX - this.offset.left, top:b.pageY - this.offset.top}, parent:this._getParentOffset(), 
    relative:this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(b), this.originalPageX = b.pageX, this.originalPageY = b.pageY, c.cursorAt && this._adjustOffsetFromHelper(c.cursorAt), c.containment && this._setContainment(), this._trigger("start", b) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), a.ui.ddmanager && !c.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b), this.helper.addClass("ui-draggable-dragging"), this._mouseDrag(b, !0), 
    a.ui.ddmanager && a.ui.ddmanager.dragStart(this, b), !0)
  }, _mouseDrag:function(b, c) {
    this.position = this._generatePosition(b), this.positionAbs = this._convertPositionTo("absolute");
    if(!c) {
      var d = this._uiHash();
      if(this._trigger("drag", b, d) === !1) {
        return this._mouseUp({}), !1
      }
      this.position = d.position
    }
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    return a.ui.ddmanager && a.ui.ddmanager.drag(this, b), !1
  }, _mouseStop:function(b) {
    var c = !1;
    a.ui.ddmanager && !this.options.dropBehaviour && (c = a.ui.ddmanager.drop(this, b)), this.dropped && (c = this.dropped, this.dropped = !1);
    var d = this.element[0], e = !1;
    while(d && (d = d.parentNode)) {
      d == document && (e = !0)
    }
    if(!e && this.options.helper === "original") {
      return!1
    }
    if(this.options.revert == "invalid" && !c || this.options.revert == "valid" && c || this.options.revert === !0 || a.isFunction(this.options.revert) && this.options.revert.call(this.element, c)) {
      var f = this;
      a(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
        f._trigger("stop", b) !== !1 && f._clear()
      })
    }else {
      this._trigger("stop", b) !== !1 && this._clear()
    }
    return!1
  }, _mouseUp:function(b) {
    return this.options.iframeFix === !0 && a("div.ui-draggable-iframeFix").each(function() {
      this.parentNode.removeChild(this)
    }), a.ui.ddmanager && a.ui.ddmanager.dragStop(this, b), a.ui.mouse.prototype._mouseUp.call(this, b)
  }, cancel:function() {
    return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
  }, _getHandle:function(b) {
    var c = !this.options.handle || !a(this.options.handle, this.element).length ? !0 : !1;
    return a(this.options.handle, this.element).find("*").andSelf().each(function() {
      this == b.target && (c = !0)
    }), c
  }, _createHelper:function(b) {
    var c = this.options, d = a.isFunction(c.helper) ? a(c.helper.apply(this.element[0], [b])) : c.helper == "clone" ? this.element.clone().removeAttr("id") : this.element;
    return d.parents("body").length || d.appendTo(c.appendTo == "parent" ? this.element[0].parentNode : c.appendTo), d[0] != this.element[0] && !/(fixed|absolute)/.test(d.css("position")) && d.css("position", "absolute"), d
  }, _adjustOffsetFromHelper:function(b) {
    typeof b == "string" && (b = b.split(" ")), a.isArray(b) && (b = {left:+b[0], top:+b[1] || 0}), "left" in b && (this.offset.click.left = b.left + this.margins.left), "right" in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left), "top" in b && (this.offset.click.top = b.top + this.margins.top), "bottom" in b && (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var b = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && a.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop());
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && a.browser.msie) {
      b = {top:0, left:0}
    }
    return{top:b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var a = this.element.position();
      return{top:a.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:a.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.element.css("marginLeft"), 10) || 0, top:parseInt(this.element.css("marginTop"), 10) || 0, right:parseInt(this.element.css("marginRight"), 10) || 0, bottom:parseInt(this.element.css("marginBottom"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var b = this.options;
    b.containment == "parent" && (b.containment = this.helper[0].parentNode);
    if(b.containment == "document" || b.containment == "window") {
      this.containment = [b.containment == "document" ? 0 : a(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, b.containment == "document" ? 0 : a(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (b.containment == "document" ? 0 : a(window).scrollLeft()) + a(b.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (b.containment == "document" ? 0 : a(window).scrollTop()) + (a(b.containment == "document" ? 
      document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(b.containment) && b.containment.constructor != Array) {
      var c = a(b.containment), d = c[0];
      if(!d) {
        return
      }
      var e = c.offset(), f = a(d).css("overflow") != "hidden";
      this.containment = [(parseInt(a(d).css("borderLeftWidth"), 10) || 0) + (parseInt(a(d).css("paddingLeft"), 10) || 0), (parseInt(a(d).css("borderTopWidth"), 10) || 0) + (parseInt(a(d).css("paddingTop"), 10) || 0), (f ? Math.max(d.scrollWidth, d.offsetWidth) : d.offsetWidth) - (parseInt(a(d).css("borderLeftWidth"), 10) || 0) - (parseInt(a(d).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (f ? Math.max(d.scrollHeight, d.offsetHeight) : d.offsetHeight) - 
      (parseInt(a(d).css("borderTopWidth"), 10) || 0) - (parseInt(a(d).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = c
    }else {
      b.containment.constructor == Array && (this.containment = b.containment)
    }
  }, _convertPositionTo:function(b, c) {
    c || (c = this.position);
    var d = b == "absolute" ? 1 : -1, e = this.options, f = this.cssPosition == "absolute" && (this.scrollParent[0] == document || !a.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, g = /(html|body)/i.test(f[0].tagName);
    return{top:c.top + this.offset.relative.top * d + this.offset.parent.top * d - (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : g ? 0 : f.scrollTop()) * d), left:c.left + this.offset.relative.left * d + this.offset.parent.left * d - (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : g ? 0 : f.scrollLeft()) * 
    d)}
  }, _generatePosition:function(b) {
    var c = this.options, d = this.cssPosition == "absolute" && (this.scrollParent[0] == document || !a.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, e = /(html|body)/i.test(d[0].tagName), f = b.pageX, g = b.pageY;
    if(this.originalPosition) {
      var h;
      if(this.containment) {
        if(this.relative_container) {
          var i = this.relative_container.offset();
          h = [this.containment[0] + i.left, this.containment[1] + i.top, this.containment[2] + i.left, this.containment[3] + i.top]
        }else {
          h = this.containment
        }
        b.pageX - this.offset.click.left < h[0] && (f = h[0] + this.offset.click.left), b.pageY - this.offset.click.top < h[1] && (g = h[1] + this.offset.click.top), b.pageX - this.offset.click.left > h[2] && (f = h[2] + this.offset.click.left), b.pageY - this.offset.click.top > h[3] && (g = h[3] + this.offset.click.top)
      }
      if(c.grid) {
        var j = c.grid[1] ? this.originalPageY + Math.round((g - this.originalPageY) / c.grid[1]) * c.grid[1] : this.originalPageY;
        g = h ? j - this.offset.click.top < h[1] || j - this.offset.click.top > h[3] ? j - this.offset.click.top < h[1] ? j + c.grid[1] : j - c.grid[1] : j : j;
        var k = c.grid[0] ? this.originalPageX + Math.round((f - this.originalPageX) / c.grid[0]) * c.grid[0] : this.originalPageX;
        f = h ? k - this.offset.click.left < h[0] || k - this.offset.click.left > h[2] ? k - this.offset.click.left < h[0] ? k + c.grid[0] : k - c.grid[0] : k : k
      }
    }
    return{top:g - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : e ? 0 : d.scrollTop()), left:f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : e ? 
    0 : d.scrollLeft())}
  }, _clear:function() {
    this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
  }, _trigger:function(b, c, d) {
    return d = d || this._uiHash(), a.ui.plugin.call(this, b, [c, d]), b == "drag" && (this.positionAbs = this._convertPositionTo("absolute")), a.Widget.prototype._trigger.call(this, b, c, d)
  }, plugins:{}, _uiHash:function(a) {
    return{helper:this.helper, position:this.position, originalPosition:this.originalPosition, offset:this.positionAbs}
  }}), a.extend(a.ui.draggable, {version:"1.8.20"}), a.ui.plugin.add("draggable", "connectToSortable", {start:function(b, c) {
    var d = a(this).data("draggable"), e = d.options, f = a.extend({}, c, {item:d.element});
    d.sortables = [], a(e.connectToSortable).each(function() {
      var c = a.data(this, "sortable");
      c && !c.options.disabled && (d.sortables.push({instance:c, shouldRevert:c.options.revert}), c.refreshPositions(), c._trigger("activate", b, f))
    })
  }, stop:function(b, c) {
    var d = a(this).data("draggable"), e = a.extend({}, c, {item:d.element});
    a.each(d.sortables, function() {
      this.instance.isOver ? (this.instance.isOver = 0, d.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(b), this.instance.options.helper = this.instance.options._helper, d.options.helper == "original" && this.instance.currentItem.css({top:"auto", left:"auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", b, e))
    })
  }, drag:function(b, c) {
    var d = a(this).data("draggable"), e = this, f = function(b) {
      var c = this.offset.click.top, d = this.offset.click.left, e = this.positionAbs.top, f = this.positionAbs.left, g = b.height, h = b.width, i = b.top, j = b.left;
      return a.ui.isOver(e + c, f + d, i, j, g, h)
    };
    a.each(d.sortables, function(f) {
      this.instance.positionAbs = d.positionAbs, this.instance.helperProportions = d.helperProportions, this.instance.offset.click = d.offset.click, this.instance._intersectsWith(this.instance.containerCache) ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
        return c.helper[0]
      }, b.target = this.instance.currentItem[0], this.instance._mouseCapture(b, !0), this.instance._mouseStart(b, !0, !0), this.instance.offset.click.top = d.offset.click.top, this.instance.offset.click.left = d.offset.click.left, this.instance.offset.parent.left -= d.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= d.offset.parent.top - this.instance.offset.parent.top, d._trigger("toSortable", b), d.dropped = this.instance.element, d.currentItem = d.element, 
      this.instance.fromOutside = d), this.instance.currentItem && this.instance._mouseDrag(b)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", b, this.instance._uiHash(this.instance)), this.instance._mouseStop(b, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), d._trigger("fromSortable", 
      b), d.dropped = !1)
    })
  }}), a.ui.plugin.add("draggable", "cursor", {start:function(b, c) {
    var d = a("body"), e = a(this).data("draggable").options;
    d.css("cursor") && (e._cursor = d.css("cursor")), d.css("cursor", e.cursor)
  }, stop:function(b, c) {
    var d = a(this).data("draggable").options;
    d._cursor && a("body").css("cursor", d._cursor)
  }}), a.ui.plugin.add("draggable", "opacity", {start:function(b, c) {
    var d = a(c.helper), e = a(this).data("draggable").options;
    d.css("opacity") && (e._opacity = d.css("opacity")), d.css("opacity", e.opacity)
  }, stop:function(b, c) {
    var d = a(this).data("draggable").options;
    d._opacity && a(c.helper).css("opacity", d._opacity)
  }}), a.ui.plugin.add("draggable", "scroll", {start:function(b, c) {
    var d = a(this).data("draggable");
    d.scrollParent[0] != document && d.scrollParent[0].tagName != "HTML" && (d.overflowOffset = d.scrollParent.offset())
  }, drag:function(b, c) {
    var d = a(this).data("draggable"), e = d.options, f = !1;
    if(d.scrollParent[0] != document && d.scrollParent[0].tagName != "HTML") {
      if(!e.axis || e.axis != "x") {
        d.overflowOffset.top + d.scrollParent[0].offsetHeight - b.pageY < e.scrollSensitivity ? d.scrollParent[0].scrollTop = f = d.scrollParent[0].scrollTop + e.scrollSpeed : b.pageY - d.overflowOffset.top < e.scrollSensitivity && (d.scrollParent[0].scrollTop = f = d.scrollParent[0].scrollTop - e.scrollSpeed)
      }
      if(!e.axis || e.axis != "y") {
        d.overflowOffset.left + d.scrollParent[0].offsetWidth - b.pageX < e.scrollSensitivity ? d.scrollParent[0].scrollLeft = f = d.scrollParent[0].scrollLeft + e.scrollSpeed : b.pageX - d.overflowOffset.left < e.scrollSensitivity && (d.scrollParent[0].scrollLeft = f = d.scrollParent[0].scrollLeft - e.scrollSpeed)
      }
    }else {
      if(!e.axis || e.axis != "x") {
        b.pageY - a(document).scrollTop() < e.scrollSensitivity ? f = a(document).scrollTop(a(document).scrollTop() - e.scrollSpeed) : a(window).height() - (b.pageY - a(document).scrollTop()) < e.scrollSensitivity && (f = a(document).scrollTop(a(document).scrollTop() + e.scrollSpeed))
      }
      if(!e.axis || e.axis != "y") {
        b.pageX - a(document).scrollLeft() < e.scrollSensitivity ? f = a(document).scrollLeft(a(document).scrollLeft() - e.scrollSpeed) : a(window).width() - (b.pageX - a(document).scrollLeft()) < e.scrollSensitivity && (f = a(document).scrollLeft(a(document).scrollLeft() + e.scrollSpeed))
      }
    }
    f !== !1 && a.ui.ddmanager && !e.dropBehaviour && a.ui.ddmanager.prepareOffsets(d, b)
  }}), a.ui.plugin.add("draggable", "snap", {start:function(b, c) {
    var d = a(this).data("draggable"), e = d.options;
    d.snapElements = [], a(e.snap.constructor != String ? e.snap.items || ":data(draggable)" : e.snap).each(function() {
      var b = a(this), c = b.offset();
      this != d.element[0] && d.snapElements.push({item:this, width:b.outerWidth(), height:b.outerHeight(), top:c.top, left:c.left})
    })
  }, drag:function(b, c) {
    var d = a(this).data("draggable"), e = d.options, f = e.snapTolerance, g = c.offset.left, h = g + d.helperProportions.width, i = c.offset.top, j = i + d.helperProportions.height;
    for(var k = d.snapElements.length - 1;k >= 0;k--) {
      var l = d.snapElements[k].left, m = l + d.snapElements[k].width, n = d.snapElements[k].top, o = n + d.snapElements[k].height;
      if(!(l - f < g && g < m + f && n - f < i && i < o + f || l - f < g && g < m + f && n - f < j && j < o + f || l - f < h && h < m + f && n - f < i && i < o + f || l - f < h && h < m + f && n - f < j && j < o + f)) {
        d.snapElements[k].snapping && d.options.snap.release && d.options.snap.release.call(d.element, b, a.extend(d._uiHash(), {snapItem:d.snapElements[k].item})), d.snapElements[k].snapping = !1;
        continue
      }
      if(e.snapMode != "inner") {
        var p = Math.abs(n - j) <= f, q = Math.abs(o - i) <= f, r = Math.abs(l - h) <= f, s = Math.abs(m - g) <= f;
        p && (c.position.top = d._convertPositionTo("relative", {top:n - d.helperProportions.height, left:0}).top - d.margins.top), q && (c.position.top = d._convertPositionTo("relative", {top:o, left:0}).top - d.margins.top), r && (c.position.left = d._convertPositionTo("relative", {top:0, left:l - d.helperProportions.width}).left - d.margins.left), s && (c.position.left = d._convertPositionTo("relative", {top:0, left:m}).left - d.margins.left)
      }
      var t = p || q || r || s;
      if(e.snapMode != "outer") {
        var p = Math.abs(n - i) <= f, q = Math.abs(o - j) <= f, r = Math.abs(l - g) <= f, s = Math.abs(m - h) <= f;
        p && (c.position.top = d._convertPositionTo("relative", {top:n, left:0}).top - d.margins.top), q && (c.position.top = d._convertPositionTo("relative", {top:o - d.helperProportions.height, left:0}).top - d.margins.top), r && (c.position.left = d._convertPositionTo("relative", {top:0, left:l}).left - d.margins.left), s && (c.position.left = d._convertPositionTo("relative", {top:0, left:m - d.helperProportions.width}).left - d.margins.left)
      }
      !d.snapElements[k].snapping && (p || q || r || s || t) && d.options.snap.snap && d.options.snap.snap.call(d.element, b, a.extend(d._uiHash(), {snapItem:d.snapElements[k].item})), d.snapElements[k].snapping = p || q || r || s || t
    }
  }}), a.ui.plugin.add("draggable", "stack", {start:function(b, c) {
    var d = a(this).data("draggable").options, e = a.makeArray(a(d.stack)).sort(function(b, c) {
      return(parseInt(a(b).css("zIndex"), 10) || 0) - (parseInt(a(c).css("zIndex"), 10) || 0)
    });
    if(!e.length) {
      return
    }
    var f = parseInt(e[0].style.zIndex) || 0;
    a(e).each(function(a) {
      this.style.zIndex = f + a
    }), this[0].style.zIndex = f + e.length
  }}), a.ui.plugin.add("draggable", "zIndex", {start:function(b, c) {
    var d = a(c.helper), e = a(this).data("draggable").options;
    d.css("zIndex") && (e._zIndex = d.css("zIndex")), d.css("zIndex", e.zIndex)
  }, stop:function(b, c) {
    var d = a(this).data("draggable").options;
    d._zIndex && a(c.helper).css("zIndex", d._zIndex)
  }})
})(jQuery);
(function(a, b) {
  a.widget("ui.droppable", {widgetEventPrefix:"drop", options:{accept:"*", activeClass:!1, addClasses:!0, greedy:!1, hoverClass:!1, scope:"default", tolerance:"intersect"}, _create:function() {
    var b = this.options, c = b.accept;
    this.isover = 0, this.isout = 1, this.accept = a.isFunction(c) ? c : function(a) {
      return a.is(c)
    }, this.proportions = {width:this.element[0].offsetWidth, height:this.element[0].offsetHeight}, a.ui.ddmanager.droppables[b.scope] = a.ui.ddmanager.droppables[b.scope] || [], a.ui.ddmanager.droppables[b.scope].push(this), b.addClasses && this.element.addClass("ui-droppable")
  }, destroy:function() {
    var b = a.ui.ddmanager.droppables[this.options.scope];
    for(var c = 0;c < b.length;c++) {
      b[c] == this && b.splice(c, 1)
    }
    return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"), this
  }, _setOption:function(b, c) {
    b == "accept" && (this.accept = a.isFunction(c) ? c : function(a) {
      return a.is(c)
    }), a.Widget.prototype._setOption.apply(this, arguments)
  }, _activate:function(b) {
    var c = a.ui.ddmanager.current;
    this.options.activeClass && this.element.addClass(this.options.activeClass), c && this._trigger("activate", b, this.ui(c))
  }, _deactivate:function(b) {
    var c = a.ui.ddmanager.current;
    this.options.activeClass && this.element.removeClass(this.options.activeClass), c && this._trigger("deactivate", b, this.ui(c))
  }, _over:function(b) {
    var c = a.ui.ddmanager.current;
    if(!c || (c.currentItem || c.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], c.currentItem || c.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", b, this.ui(c)))
  }, _out:function(b) {
    var c = a.ui.ddmanager.current;
    if(!c || (c.currentItem || c.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], c.currentItem || c.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", b, this.ui(c)))
  }, _drop:function(b, c) {
    var d = c || a.ui.ddmanager.current;
    if(!d || (d.currentItem || d.element)[0] == this.element[0]) {
      return!1
    }
    var e = !1;
    return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function() {
      var b = a.data(this, "droppable");
      if(b.options.greedy && !b.options.disabled && b.options.scope == d.options.scope && b.accept.call(b.element[0], d.currentItem || d.element) && a.ui.intersect(d, a.extend(b, {offset:b.element.offset()}), b.options.tolerance)) {
        return e = !0, !1
      }
    }), e ? !1 : this.accept.call(this.element[0], d.currentItem || d.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", b, this.ui(d)), this.element) : !1
  }, ui:function(a) {
    return{draggable:a.currentItem || a.element, helper:a.helper, position:a.position, offset:a.positionAbs}
  }}), a.extend(a.ui.droppable, {version:"1.8.20"}), a.ui.intersect = function(b, c, d) {
    if(!c.offset) {
      return!1
    }
    var e = (b.positionAbs || b.position.absolute).left, f = e + b.helperProportions.width, g = (b.positionAbs || b.position.absolute).top, h = g + b.helperProportions.height, i = c.offset.left, j = i + c.proportions.width, k = c.offset.top, l = k + c.proportions.height;
    switch(d) {
      case "fit":
        return i <= e && f <= j && k <= g && h <= l;
      case "intersect":
        return i < e + b.helperProportions.width / 2 && f - b.helperProportions.width / 2 < j && k < g + b.helperProportions.height / 2 && h - b.helperProportions.height / 2 < l;
      case "pointer":
        var m = (b.positionAbs || b.position.absolute).left + (b.clickOffset || b.offset.click).left, n = (b.positionAbs || b.position.absolute).top + (b.clickOffset || b.offset.click).top, o = a.ui.isOver(n, m, k, i, c.proportions.height, c.proportions.width);
        return o;
      case "touch":
        return(g >= k && g <= l || h >= k && h <= l || g < k && h > l) && (e >= i && e <= j || f >= i && f <= j || e < i && f > j);
      default:
        return!1
    }
  }, a.ui.ddmanager = {current:null, droppables:{"default":[]}, prepareOffsets:function(b, c) {
    var d = a.ui.ddmanager.droppables[b.options.scope] || [], e = c ? c.type : null, f = (b.currentItem || b.element).find(":data(droppable)").andSelf();
    g:for(var h = 0;h < d.length;h++) {
      if(d[h].options.disabled || b && !d[h].accept.call(d[h].element[0], b.currentItem || b.element)) {
        continue
      }
      for(var i = 0;i < f.length;i++) {
        if(f[i] == d[h].element[0]) {
          d[h].proportions.height = 0;
          continue g
        }
      }
      d[h].visible = d[h].element.css("display") != "none";
      if(!d[h].visible) {
        continue
      }
      e == "mousedown" && d[h]._activate.call(d[h], c), d[h].offset = d[h].element.offset(), d[h].proportions = {width:d[h].element[0].offsetWidth, height:d[h].element[0].offsetHeight}
    }
  }, drop:function(b, c) {
    var d = !1;
    return a.each(a.ui.ddmanager.droppables[b.options.scope] || [], function() {
      if(!this.options) {
        return
      }
      !this.options.disabled && this.visible && a.ui.intersect(b, this, this.options.tolerance) && (d = this._drop.call(this, c) || d), !this.options.disabled && this.visible && this.accept.call(this.element[0], b.currentItem || b.element) && (this.isout = 1, this.isover = 0, this._deactivate.call(this, c))
    }), d
  }, dragStart:function(b, c) {
    b.element.parents(":not(body,html)").bind("scroll.droppable", function() {
      b.options.refreshPositions || a.ui.ddmanager.prepareOffsets(b, c)
    })
  }, drag:function(b, c) {
    b.options.refreshPositions && a.ui.ddmanager.prepareOffsets(b, c), a.each(a.ui.ddmanager.droppables[b.options.scope] || [], function() {
      if(this.options.disabled || this.greedyChild || !this.visible) {
        return
      }
      var d = a.ui.intersect(b, this, this.options.tolerance), e = !d && this.isover == 1 ? "isout" : d && this.isover == 0 ? "isover" : null;
      if(!e) {
        return
      }
      var f;
      if(this.options.greedy) {
        var g = this.element.parents(":data(droppable):eq(0)");
        g.length && (f = a.data(g[0], "droppable"), f.greedyChild = e == "isover" ? 1 : 0)
      }
      f && e == "isover" && (f.isover = 0, f.isout = 1, f._out.call(f, c)), this[e] = 1, this[e == "isout" ? "isover" : "isout"] = 0, this[e == "isover" ? "_over" : "_out"].call(this, c), f && e == "isout" && (f.isout = 0, f.isover = 1, f._over.call(f, c))
    })
  }, dragStop:function(b, c) {
    b.element.parents(":not(body,html)").unbind("scroll.droppable"), b.options.refreshPositions || a.ui.ddmanager.prepareOffsets(b, c)
  }}
})(jQuery);
(function(a, b) {
  a.widget("ui.selectable", a.ui.mouse, {options:{appendTo:"body", autoRefresh:!0, distance:0, filter:"*", tolerance:"touch"}, _create:function() {
    var b = this;
    this.element.addClass("ui-selectable"), this.dragged = !1;
    var c;
    this.refresh = function() {
      c = a(b.options.filter, b.element[0]), c.addClass("ui-selectee"), c.each(function() {
        var b = a(this), c = b.offset();
        a.data(this, "selectable-item", {element:this, $element:b, left:c.left, top:c.top, right:c.left + b.outerWidth(), bottom:c.top + b.outerHeight(), startselected:!1, selected:b.hasClass("ui-selected"), selecting:b.hasClass("ui-selecting"), unselecting:b.hasClass("ui-unselecting")})
      })
    }, this.refresh(), this.selectees = c.addClass("ui-selectee"), this._mouseInit(), this.helper = a("<div class='ui-selectable-helper'></div>")
  }, destroy:function() {
    return this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"), this._mouseDestroy(), this
  }, _mouseStart:function(b) {
    var c = this;
    this.opos = [b.pageX, b.pageY];
    if(this.options.disabled) {
      return
    }
    var d = this.options;
    this.selectees = a(d.filter, this.element[0]), this._trigger("start", b), a(d.appendTo).append(this.helper), this.helper.css({left:b.clientX, top:b.clientY, width:0, height:0}), d.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function() {
      var d = a.data(this, "selectable-item");
      d.startselected = !0, !b.metaKey && !b.ctrlKey && (d.$element.removeClass("ui-selected"), d.selected = !1, d.$element.addClass("ui-unselecting"), d.unselecting = !0, c._trigger("unselecting", b, {unselecting:d.element}))
    }), a(b.target).parents().andSelf().each(function() {
      var d = a.data(this, "selectable-item");
      if(d) {
        var e = !b.metaKey && !b.ctrlKey || !d.$element.hasClass("ui-selected");
        return d.$element.removeClass(e ? "ui-unselecting" : "ui-selected").addClass(e ? "ui-selecting" : "ui-unselecting"), d.unselecting = !e, d.selecting = e, d.selected = e, e ? c._trigger("selecting", b, {selecting:d.element}) : c._trigger("unselecting", b, {unselecting:d.element}), !1
      }
    })
  }, _mouseDrag:function(b) {
    var c = this;
    this.dragged = !0;
    if(this.options.disabled) {
      return
    }
    var d = this.options, e = this.opos[0], f = this.opos[1], g = b.pageX, h = b.pageY;
    if(e > g) {
      var i = g;
      g = e, e = i
    }
    if(f > h) {
      var i = h;
      h = f, f = i
    }
    return this.helper.css({left:e, top:f, width:g - e, height:h - f}), this.selectees.each(function() {
      var i = a.data(this, "selectable-item");
      if(!i || i.element == c.element[0]) {
        return
      }
      var j = !1;
      d.tolerance == "touch" ? j = !(i.left > g || i.right < e || i.top > h || i.bottom < f) : d.tolerance == "fit" && (j = i.left > e && i.right < g && i.top > f && i.bottom < h), j ? (i.selected && (i.$element.removeClass("ui-selected"), i.selected = !1), i.unselecting && (i.$element.removeClass("ui-unselecting"), i.unselecting = !1), i.selecting || (i.$element.addClass("ui-selecting"), i.selecting = !0, c._trigger("selecting", b, {selecting:i.element}))) : (i.selecting && ((b.metaKey || b.ctrlKey) && 
      i.startselected ? (i.$element.removeClass("ui-selecting"), i.selecting = !1, i.$element.addClass("ui-selected"), i.selected = !0) : (i.$element.removeClass("ui-selecting"), i.selecting = !1, i.startselected && (i.$element.addClass("ui-unselecting"), i.unselecting = !0), c._trigger("unselecting", b, {unselecting:i.element}))), i.selected && !b.metaKey && !b.ctrlKey && !i.startselected && (i.$element.removeClass("ui-selected"), i.selected = !1, i.$element.addClass("ui-unselecting"), i.unselecting = 
      !0, c._trigger("unselecting", b, {unselecting:i.element})))
    }), !1
  }, _mouseStop:function(b) {
    var c = this;
    this.dragged = !1;
    var d = this.options;
    return a(".ui-unselecting", this.element[0]).each(function() {
      var d = a.data(this, "selectable-item");
      d.$element.removeClass("ui-unselecting"), d.unselecting = !1, d.startselected = !1, c._trigger("unselected", b, {unselected:d.element})
    }), a(".ui-selecting", this.element[0]).each(function() {
      var d = a.data(this, "selectable-item");
      d.$element.removeClass("ui-selecting").addClass("ui-selected"), d.selecting = !1, d.selected = !0, d.startselected = !0, c._trigger("selected", b, {selected:d.element})
    }), this._trigger("stop", b), this.helper.remove(), !1
  }}), a.extend(a.ui.selectable, {version:"1.8.20"})
})(jQuery);
(function(a, b) {
  a.widget("ui.sortable", a.ui.mouse, {widgetEventPrefix:"sort", ready:!1, options:{appendTo:"parent", axis:!1, connectWith:!1, containment:!1, cursor:"auto", cursorAt:!1, dropOnEmpty:!0, forcePlaceholderSize:!1, forceHelperSize:!1, grid:!1, handle:!1, helper:"original", items:"> *", opacity:!1, placeholder:!1, revert:!1, scroll:!0, scrollSensitivity:20, scrollSpeed:20, scope:"default", tolerance:"intersect", zIndex:1E3}, _create:function() {
    var a = this.options;
    this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? a.axis === "x" || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
  }, destroy:function() {
    a.Widget.prototype.destroy.call(this), this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
    for(var b = this.items.length - 1;b >= 0;b--) {
      this.items[b].item.removeData(this.widgetName + "-item")
    }
    return this
  }, _setOption:function(b, c) {
    b === "disabled" ? (this.options[b] = c, this.widget()[c ? "addClass" : "removeClass"]("ui-sortable-disabled")) : a.Widget.prototype._setOption.apply(this, arguments)
  }, _mouseCapture:function(b, c) {
    var d = this;
    if(this.reverting) {
      return!1
    }
    if(this.options.disabled || this.options.type == "static") {
      return!1
    }
    this._refreshItems(b);
    var e = null, f = this, g = a(b.target).parents().each(function() {
      if(a.data(this, d.widgetName + "-item") == f) {
        return e = a(this), !1
      }
    });
    a.data(b.target, d.widgetName + "-item") == f && (e = a(b.target));
    if(!e) {
      return!1
    }
    if(this.options.handle && !c) {
      var h = !1;
      a(this.options.handle, e).find("*").andSelf().each(function() {
        this == b.target && (h = !0)
      });
      if(!h) {
        return!1
      }
    }
    return this.currentItem = e, this._removeCurrentsFromItems(), !0
  }, _mouseStart:function(b, c, d) {
    var e = this.options, f = this;
    this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(b), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), a.extend(this.offset, {click:{left:b.pageX - this.offset.left, top:b.pageY - 
    this.offset.top}, parent:this._getParentOffset(), relative:this._getRelativeOffset()}), this.originalPosition = this._generatePosition(b), this.originalPageX = b.pageX, this.originalPageY = b.pageY, e.cursorAt && this._adjustOffsetFromHelper(e.cursorAt), this.domPosition = {prev:this.currentItem.prev()[0], parent:this.currentItem.parent()[0]}, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), e.containment && this._setContainment(), e.cursor && (a("body").css("cursor") && 
    (this._storedCursor = a("body").css("cursor")), a("body").css("cursor", e.cursor)), e.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", e.opacity)), e.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", e.zIndex)), this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", 
    b, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
    if(!d) {
      for(var g = this.containers.length - 1;g >= 0;g--) {
        this.containers[g]._trigger("activate", b, f._uiHash(this))
      }
    }
    return a.ui.ddmanager && (a.ui.ddmanager.current = this), a.ui.ddmanager && !e.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(b), !0
  }, _mouseDrag:function(b) {
    this.position = this._generatePosition(b), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
    if(this.options.scroll) {
      var c = this.options, d = !1;
      this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - b.pageY < c.scrollSensitivity ? this.scrollParent[0].scrollTop = d = this.scrollParent[0].scrollTop + c.scrollSpeed : b.pageY - this.overflowOffset.top < c.scrollSensitivity && (this.scrollParent[0].scrollTop = d = this.scrollParent[0].scrollTop - c.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - b.pageX < c.scrollSensitivity ? 
      this.scrollParent[0].scrollLeft = d = this.scrollParent[0].scrollLeft + c.scrollSpeed : b.pageX - this.overflowOffset.left < c.scrollSensitivity && (this.scrollParent[0].scrollLeft = d = this.scrollParent[0].scrollLeft - c.scrollSpeed)) : (b.pageY - a(document).scrollTop() < c.scrollSensitivity ? d = a(document).scrollTop(a(document).scrollTop() - c.scrollSpeed) : a(window).height() - (b.pageY - a(document).scrollTop()) < c.scrollSensitivity && (d = a(document).scrollTop(a(document).scrollTop() + 
      c.scrollSpeed)), b.pageX - a(document).scrollLeft() < c.scrollSensitivity ? d = a(document).scrollLeft(a(document).scrollLeft() - c.scrollSpeed) : a(window).width() - (b.pageX - a(document).scrollLeft()) < c.scrollSensitivity && (d = a(document).scrollLeft(a(document).scrollLeft() + c.scrollSpeed))), d !== !1 && a.ui.ddmanager && !c.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b)
    }
    this.positionAbs = this._convertPositionTo("absolute");
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    for(var e = this.items.length - 1;e >= 0;e--) {
      var f = this.items[e], g = f.item[0], h = this._intersectsWithPointer(f);
      if(!h) {
        continue
      }
      if(g != this.currentItem[0] && this.placeholder[h == 1 ? "next" : "prev"]()[0] != g && !a.ui.contains(this.placeholder[0], g) && (this.options.type == "semi-dynamic" ? !a.ui.contains(this.element[0], g) : !0)) {
        this.direction = h == 1 ? "down" : "up";
        if(this.options.tolerance == "pointer" || this._intersectsWithSides(f)) {
          this._rearrange(b, f)
        }else {
          break
        }
        this._trigger("change", b, this._uiHash());
        break
      }
    }
    return this._contactContainers(b), a.ui.ddmanager && a.ui.ddmanager.drag(this, b), this._trigger("sort", b, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
  }, _mouseStop:function(b, c) {
    if(!b) {
      return
    }
    a.ui.ddmanager && !this.options.dropBehaviour && a.ui.ddmanager.drop(this, b);
    if(this.options.revert) {
      var d = this, e = d.placeholder.offset();
      d.reverting = !0, a(this.helper).animate({left:e.left - this.offset.parent.left - d.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft), top:e.top - this.offset.parent.top - d.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function() {
        d._clear(b)
      })
    }else {
      this._clear(b, c)
    }
    return!1
  }, cancel:function() {
    var b = this;
    if(this.dragging) {
      this._mouseUp({target:null}), this.options.helper == "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
      for(var c = this.containers.length - 1;c >= 0;c--) {
        this.containers[c]._trigger("deactivate", null, b._uiHash(this)), this.containers[c].containerCache.over && (this.containers[c]._trigger("out", null, b._uiHash(this)), this.containers[c].containerCache.over = 0)
      }
    }
    return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper != "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), a.extend(this, {helper:null, dragging:!1, reverting:!1, _noFinalSort:null}), this.domPosition.prev ? a(this.domPosition.prev).after(this.currentItem) : a(this.domPosition.parent).prepend(this.currentItem)), this
  }, serialize:function(b) {
    var c = this._getItemsAsjQuery(b && b.connected), d = [];
    return b = b || {}, a(c).each(function() {
      var c = (a(b.item || this).attr(b.attribute || "id") || "").match(b.expression || /(.+)[-=_](.+)/);
      c && d.push((b.key || c[1] + "[]") + "=" + (b.key && b.expression ? c[1] : c[2]))
    }), !d.length && b.key && d.push(b.key + "="), d.join("&")
  }, toArray:function(b) {
    var c = this._getItemsAsjQuery(b && b.connected), d = [];
    return b = b || {}, c.each(function() {
      d.push(a(b.item || this).attr(b.attribute || "id") || "")
    }), d
  }, _intersectsWith:function(a) {
    var b = this.positionAbs.left, c = b + this.helperProportions.width, d = this.positionAbs.top, e = d + this.helperProportions.height, f = a.left, g = f + a.width, h = a.top, i = h + a.height, j = this.offset.click.top, k = this.offset.click.left, l = d + j > h && d + j < i && b + k > f && b + k < g;
    return this.options.tolerance == "pointer" || this.options.forcePointerForContainers || this.options.tolerance != "pointer" && this.helperProportions[this.floating ? "width" : "height"] > a[this.floating ? "width" : "height"] ? l : f < b + this.helperProportions.width / 2 && c - this.helperProportions.width / 2 < g && h < d + this.helperProportions.height / 2 && e - this.helperProportions.height / 2 < i
  }, _intersectsWithPointer:function(b) {
    var c = this.options.axis === "x" || a.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, b.top, b.height), d = this.options.axis === "y" || a.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, b.left, b.width), e = c && d, f = this._getDragVerticalDirection(), g = this._getDragHorizontalDirection();
    return e ? this.floating ? g && g == "right" || f == "down" ? 2 : 1 : f && (f == "down" ? 2 : 1) : !1
  }, _intersectsWithSides:function(b) {
    var c = a.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, b.top + b.height / 2, b.height), d = a.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, b.left + b.width / 2, b.width), e = this._getDragVerticalDirection(), f = this._getDragHorizontalDirection();
    return this.floating && f ? f == "right" && d || f == "left" && !d : e && (e == "down" && c || e == "up" && !c)
  }, _getDragVerticalDirection:function() {
    var a = this.positionAbs.top - this.lastPositionAbs.top;
    return a != 0 && (a > 0 ? "down" : "up")
  }, _getDragHorizontalDirection:function() {
    var a = this.positionAbs.left - this.lastPositionAbs.left;
    return a != 0 && (a > 0 ? "right" : "left")
  }, refresh:function(a) {
    return this._refreshItems(a), this.refreshPositions(), this
  }, _connectWith:function() {
    var a = this.options;
    return a.connectWith.constructor == String ? [a.connectWith] : a.connectWith
  }, _getItemsAsjQuery:function(b) {
    var c = this, d = [], e = [], f = this._connectWith();
    if(f && b) {
      for(var g = f.length - 1;g >= 0;g--) {
        var h = a(f[g]);
        for(var i = h.length - 1;i >= 0;i--) {
          var j = a.data(h[i], this.widgetName);
          j && j != this && !j.options.disabled && e.push([a.isFunction(j.options.items) ? j.options.items.call(j.element) : a(j.options.items, j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), j])
        }
      }
    }
    e.push([a.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options:this.options, item:this.currentItem}) : a(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
    for(var g = e.length - 1;g >= 0;g--) {
      e[g][0].each(function() {
        d.push(this)
      })
    }
    return a(d)
  }, _removeCurrentsFromItems:function() {
    var a = this.currentItem.find(":data(" + this.widgetName + "-item)");
    for(var b = 0;b < this.items.length;b++) {
      for(var c = 0;c < a.length;c++) {
        a[c] == this.items[b].item[0] && this.items.splice(b, 1)
      }
    }
  }, _refreshItems:function(b) {
    this.items = [], this.containers = [this];
    var c = this.items, d = this, e = [[a.isFunction(this.options.items) ? this.options.items.call(this.element[0], b, {item:this.currentItem}) : a(this.options.items, this.element), this]], f = this._connectWith();
    if(f && this.ready) {
      for(var g = f.length - 1;g >= 0;g--) {
        var h = a(f[g]);
        for(var i = h.length - 1;i >= 0;i--) {
          var j = a.data(h[i], this.widgetName);
          j && j != this && !j.options.disabled && (e.push([a.isFunction(j.options.items) ? j.options.items.call(j.element[0], b, {item:this.currentItem}) : a(j.options.items, j.element), j]), this.containers.push(j))
        }
      }
    }
    for(var g = e.length - 1;g >= 0;g--) {
      var k = e[g][1], l = e[g][0];
      for(var i = 0, m = l.length;i < m;i++) {
        var n = a(l[i]);
        n.data(this.widgetName + "-item", k), c.push({item:n, instance:k, width:0, height:0, left:0, top:0})
      }
    }
  }, refreshPositions:function(b) {
    this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
    for(var c = this.items.length - 1;c >= 0;c--) {
      var d = this.items[c];
      if(d.instance != this.currentContainer && this.currentContainer && d.item[0] != this.currentItem[0]) {
        continue
      }
      var e = this.options.toleranceElement ? a(this.options.toleranceElement, d.item) : d.item;
      b || (d.width = e.outerWidth(), d.height = e.outerHeight());
      var f = e.offset();
      d.left = f.left, d.top = f.top
    }
    if(this.options.custom && this.options.custom.refreshContainers) {
      this.options.custom.refreshContainers.call(this)
    }else {
      for(var c = this.containers.length - 1;c >= 0;c--) {
        var f = this.containers[c].element.offset();
        this.containers[c].containerCache.left = f.left, this.containers[c].containerCache.top = f.top, this.containers[c].containerCache.width = this.containers[c].element.outerWidth(), this.containers[c].containerCache.height = this.containers[c].element.outerHeight()
      }
    }
    return this
  }, _createPlaceholder:function(b) {
    var c = b || this, d = c.options;
    if(!d.placeholder || d.placeholder.constructor == String) {
      var e = d.placeholder;
      d.placeholder = {element:function() {
        var b = a(document.createElement(c.currentItem[0].nodeName)).addClass(e || c.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
        return e || (b.style.visibility = "hidden"), b
      }, update:function(a, b) {
        if(e && !d.forcePlaceholderSize) {
          return
        }
        b.height() || b.height(c.currentItem.innerHeight() - parseInt(c.currentItem.css("paddingTop") || 0, 10) - parseInt(c.currentItem.css("paddingBottom") || 0, 10)), b.width() || b.width(c.currentItem.innerWidth() - parseInt(c.currentItem.css("paddingLeft") || 0, 10) - parseInt(c.currentItem.css("paddingRight") || 0, 10))
      }}
    }
    c.placeholder = a(d.placeholder.element.call(c.element, c.currentItem)), c.currentItem.after(c.placeholder), d.placeholder.update(c, c.placeholder)
  }, _contactContainers:function(b) {
    var c = null, d = null;
    for(var e = this.containers.length - 1;e >= 0;e--) {
      if(a.ui.contains(this.currentItem[0], this.containers[e].element[0])) {
        continue
      }
      if(this._intersectsWith(this.containers[e].containerCache)) {
        if(c && a.ui.contains(this.containers[e].element[0], c.element[0])) {
          continue
        }
        c = this.containers[e], d = e
      }else {
        this.containers[e].containerCache.over && (this.containers[e]._trigger("out", b, this._uiHash(this)), this.containers[e].containerCache.over = 0)
      }
    }
    if(!c) {
      return
    }
    if(this.containers.length === 1) {
      this.containers[d]._trigger("over", b, this._uiHash(this)), this.containers[d].containerCache.over = 1
    }else {
      if(this.currentContainer != this.containers[d]) {
        var f = 1E4, g = null, h = this.positionAbs[this.containers[d].floating ? "left" : "top"];
        for(var i = this.items.length - 1;i >= 0;i--) {
          if(!a.ui.contains(this.containers[d].element[0], this.items[i].item[0])) {
            continue
          }
          var j = this.items[i][this.containers[d].floating ? "left" : "top"];
          Math.abs(j - h) < f && (f = Math.abs(j - h), g = this.items[i])
        }
        if(!g && !this.options.dropOnEmpty) {
          return
        }
        this.currentContainer = this.containers[d], g ? this._rearrange(b, g, null, !0) : this._rearrange(b, null, this.containers[d].element, !0), this._trigger("change", b, this._uiHash()), this.containers[d]._trigger("change", b, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[d]._trigger("over", b, this._uiHash(this)), this.containers[d].containerCache.over = 1
      }
    }
  }, _createHelper:function(b) {
    var c = this.options, d = a.isFunction(c.helper) ? a(c.helper.apply(this.element[0], [b, this.currentItem])) : c.helper == "clone" ? this.currentItem.clone() : this.currentItem;
    return d.parents("body").length || a(c.appendTo != "parent" ? c.appendTo : this.currentItem[0].parentNode)[0].appendChild(d[0]), d[0] == this.currentItem[0] && (this._storedCSS = {width:this.currentItem[0].style.width, height:this.currentItem[0].style.height, position:this.currentItem.css("position"), top:this.currentItem.css("top"), left:this.currentItem.css("left")}), (d[0].style.width == "" || c.forceHelperSize) && d.width(this.currentItem.width()), (d[0].style.height == "" || c.forceHelperSize) && 
    d.height(this.currentItem.height()), d
  }, _adjustOffsetFromHelper:function(b) {
    typeof b == "string" && (b = b.split(" ")), a.isArray(b) && (b = {left:+b[0], top:+b[1] || 0}), "left" in b && (this.offset.click.left = b.left + this.margins.left), "right" in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left), "top" in b && (this.offset.click.top = b.top + this.margins.top), "bottom" in b && (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var b = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && a.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop());
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && a.browser.msie) {
      b = {top:0, left:0}
    }
    return{top:b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var a = this.currentItem.position();
      return{top:a.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:a.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.currentItem.css("marginLeft"), 10) || 0, top:parseInt(this.currentItem.css("marginTop"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var b = this.options;
    b.containment == "parent" && (b.containment = this.helper[0].parentNode);
    if(b.containment == "document" || b.containment == "window") {
      this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, a(b.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (a(b.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(b.containment)) {
      var c = a(b.containment)[0], d = a(b.containment).offset(), e = a(c).css("overflow") != "hidden";
      this.containment = [d.left + (parseInt(a(c).css("borderLeftWidth"), 10) || 0) + (parseInt(a(c).css("paddingLeft"), 10) || 0) - this.margins.left, d.top + (parseInt(a(c).css("borderTopWidth"), 10) || 0) + (parseInt(a(c).css("paddingTop"), 10) || 0) - this.margins.top, d.left + (e ? Math.max(c.scrollWidth, c.offsetWidth) : c.offsetWidth) - (parseInt(a(c).css("borderLeftWidth"), 10) || 0) - (parseInt(a(c).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, d.top + 
      (e ? Math.max(c.scrollHeight, c.offsetHeight) : c.offsetHeight) - (parseInt(a(c).css("borderTopWidth"), 10) || 0) - (parseInt(a(c).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
    }
  }, _convertPositionTo:function(b, c) {
    c || (c = this.position);
    var d = b == "absolute" ? 1 : -1, e = this.options, f = this.cssPosition == "absolute" && (this.scrollParent[0] == document || !a.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, g = /(html|body)/i.test(f[0].tagName);
    return{top:c.top + this.offset.relative.top * d + this.offset.parent.top * d - (a.browser.safari && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : g ? 0 : f.scrollTop()) * d), left:c.left + this.offset.relative.left * d + this.offset.parent.left * d - (a.browser.safari && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : g ? 0 : f.scrollLeft()) * d)}
  }, _generatePosition:function(b) {
    var c = this.options, d = this.cssPosition == "absolute" && (this.scrollParent[0] == document || !a.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, e = /(html|body)/i.test(d[0].tagName);
    this.cssPosition == "relative" && (this.scrollParent[0] == document || this.scrollParent[0] == this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset());
    var f = b.pageX, g = b.pageY;
    if(this.originalPosition) {
      this.containment && (b.pageX - this.offset.click.left < this.containment[0] && (f = this.containment[0] + this.offset.click.left), b.pageY - this.offset.click.top < this.containment[1] && (g = this.containment[1] + this.offset.click.top), b.pageX - this.offset.click.left > this.containment[2] && (f = this.containment[2] + this.offset.click.left), b.pageY - this.offset.click.top > this.containment[3] && (g = this.containment[3] + this.offset.click.top));
      if(c.grid) {
        var h = this.originalPageY + Math.round((g - this.originalPageY) / c.grid[1]) * c.grid[1];
        g = this.containment ? h - this.offset.click.top < this.containment[1] || h - this.offset.click.top > this.containment[3] ? h - this.offset.click.top < this.containment[1] ? h + c.grid[1] : h - c.grid[1] : h : h;
        var i = this.originalPageX + Math.round((f - this.originalPageX) / c.grid[0]) * c.grid[0];
        f = this.containment ? i - this.offset.click.left < this.containment[0] || i - this.offset.click.left > this.containment[2] ? i - this.offset.click.left < this.containment[0] ? i + c.grid[0] : i - c.grid[0] : i : i
      }
    }
    return{top:g - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (a.browser.safari && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : e ? 0 : d.scrollTop()), left:f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (a.browser.safari && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : e ? 0 : d.scrollLeft())}
  }, _rearrange:function(a, b, c, d) {
    c ? c[0].appendChild(this.placeholder[0]) : b.item[0].parentNode.insertBefore(this.placeholder[0], this.direction == "down" ? b.item[0] : b.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
    var e = this, f = this.counter;
    window.setTimeout(function() {
      f == e.counter && e.refreshPositions(!d)
    }, 0)
  }, _clear:function(b, c) {
    this.reverting = !1;
    var d = [], e = this;
    !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;
    if(this.helper[0] == this.currentItem[0]) {
      for(var f in this._storedCSS) {
        if(this._storedCSS[f] == "auto" || this._storedCSS[f] == "static") {
          this._storedCSS[f] = ""
        }
      }
      this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
    }else {
      this.currentItem.show()
    }
    this.fromOutside && !c && d.push(function(a) {
      this._trigger("receive", a, this._uiHash(this.fromOutside))
    }), (this.fromOutside || this.domPosition.prev != this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent != this.currentItem.parent()[0]) && !c && d.push(function(a) {
      this._trigger("update", a, this._uiHash())
    });
    if(!a.ui.contains(this.element[0], this.currentItem[0])) {
      c || d.push(function(a) {
        this._trigger("remove", a, this._uiHash())
      });
      for(var f = this.containers.length - 1;f >= 0;f--) {
        a.ui.contains(this.containers[f].element[0], this.currentItem[0]) && !c && (d.push(function(a) {
          return function(b) {
            a._trigger("receive", b, this._uiHash(this))
          }
        }.call(this, this.containers[f])), d.push(function(a) {
          return function(b) {
            a._trigger("update", b, this._uiHash(this))
          }
        }.call(this, this.containers[f])))
      }
    }
    for(var f = this.containers.length - 1;f >= 0;f--) {
      c || d.push(function(a) {
        return function(b) {
          a._trigger("deactivate", b, this._uiHash(this))
        }
      }.call(this, this.containers[f])), this.containers[f].containerCache.over && (d.push(function(a) {
        return function(b) {
          a._trigger("out", b, this._uiHash(this))
        }
      }.call(this, this.containers[f])), this.containers[f].containerCache.over = 0)
    }
    this._storedCursor && a("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex == "auto" ? "" : this._storedZIndex), this.dragging = !1;
    if(this.cancelHelperRemoval) {
      if(!c) {
        this._trigger("beforeStop", b, this._uiHash());
        for(var f = 0;f < d.length;f++) {
          d[f].call(this, b)
        }
        this._trigger("stop", b, this._uiHash())
      }
      return!1
    }
    c || this._trigger("beforeStop", b, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null;
    if(!c) {
      for(var f = 0;f < d.length;f++) {
        d[f].call(this, b)
      }
      this._trigger("stop", b, this._uiHash())
    }
    return this.fromOutside = !1, !0
  }, _trigger:function() {
    a.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
  }, _uiHash:function(b) {
    var c = b || this;
    return{helper:c.helper, placeholder:c.placeholder || a([]), position:c.position, originalPosition:c.originalPosition, offset:c.positionAbs, item:c.currentItem, sender:b ? b.element : null}
  }}), a.extend(a.ui.sortable, {version:"1.8.20"})
})(jQuery);
(function(a, b) {
  var c = 0;
  a.widget("ui.autocomplete", {options:{appendTo:"body", autoFocus:!1, delay:300, minLength:1, position:{my:"left top", at:"left bottom", collision:"none"}, source:null}, pending:0, _create:function() {
    var b = this, c = this.element[0].ownerDocument, d;
    this.isMultiLine = this.element.is("textarea"), this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off").attr({role:"textbox", "aria-autocomplete":"list", "aria-haspopup":"true"}).bind("keydown.autocomplete", function(c) {
      if(b.options.disabled || b.element.propAttr("readOnly")) {
        return
      }
      d = !1;
      var e = a.ui.keyCode;
      switch(c.keyCode) {
        case e.PAGE_UP:
          b._move("previousPage", c);
          break;
        case e.PAGE_DOWN:
          b._move("nextPage", c);
          break;
        case e.UP:
          b._keyEvent("previous", c);
          break;
        case e.DOWN:
          b._keyEvent("next", c);
          break;
        case e.ENTER:
        ;
        case e.NUMPAD_ENTER:
          b.menu.active && (d = !0, c.preventDefault());
        case e.TAB:
          if(!b.menu.active) {
            return
          }
          b.menu.select(c);
          break;
        case e.ESCAPE:
          b.element.val(b.term), b.close(c);
          break;
        default:
          clearTimeout(b.searching), b.searching = setTimeout(function() {
            b.term != b.element.val() && (b.selectedItem = null, b.search(null, c))
          }, b.options.delay)
      }
    }).bind("keypress.autocomplete", function(a) {
      d && (d = !1, a.preventDefault())
    }).bind("focus.autocomplete", function() {
      if(b.options.disabled) {
        return
      }
      b.selectedItem = null, b.previous = b.element.val()
    }).bind("blur.autocomplete", function(a) {
      if(b.options.disabled) {
        return
      }
      clearTimeout(b.searching), b.closing = setTimeout(function() {
        b.close(a), b._change(a)
      }, 150)
    }), this._initSource(), this.menu = a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo || "body", c)[0]).mousedown(function(c) {
      var d = b.menu.element[0];
      a(c.target).closest(".ui-menu-item").length || setTimeout(function() {
        a(document).one("mousedown", function(c) {
          c.target !== b.element[0] && c.target !== d && !a.ui.contains(d, c.target) && b.close()
        })
      }, 1), setTimeout(function() {
        clearTimeout(b.closing)
      }, 13)
    }).menu({focus:function(a, c) {
      var d = c.item.data("item.autocomplete");
      !1 !== b._trigger("focus", a, {item:d}) && /^key/.test(a.originalEvent.type) && b.element.val(d.value)
    }, selected:function(a, d) {
      var e = d.item.data("item.autocomplete"), f = b.previous;
      b.element[0] !== c.activeElement && (b.element.focus(), b.previous = f, setTimeout(function() {
        b.previous = f, b.selectedItem = e
      }, 1)), !1 !== b._trigger("select", a, {item:e}) && b.element.val(e.value), b.term = b.element.val(), b.close(a), b.selectedItem = e
    }, blur:function(a, c) {
      b.menu.element.is(":visible") && b.element.val() !== b.term && b.element.val(b.term)
    }}).zIndex(this.element.zIndex() + 1).css({top:0, left:0}).hide().data("menu"), a.fn.bgiframe && this.menu.element.bgiframe(), b.beforeunloadHandler = function() {
      b.element.removeAttr("autocomplete")
    }, a(window).bind("beforeunload", b.beforeunloadHandler)
  }, destroy:function() {
    this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"), this.menu.element.remove(), a(window).unbind("beforeunload", this.beforeunloadHandler), a.Widget.prototype.destroy.call(this)
  }, _setOption:function(b, c) {
    a.Widget.prototype._setOption.apply(this, arguments), b === "source" && this._initSource(), b === "appendTo" && this.menu.element.appendTo(a(c || "body", this.element[0].ownerDocument)[0]), b === "disabled" && c && this.xhr && this.xhr.abort()
  }, _initSource:function() {
    var b = this, c, d;
    a.isArray(this.options.source) ? (c = this.options.source, this.source = function(b, d) {
      d(a.ui.autocomplete.filter(c, b.term))
    }) : typeof this.options.source == "string" ? (d = this.options.source, this.source = function(c, e) {
      b.xhr && b.xhr.abort(), b.xhr = a.ajax({url:d, data:c, dataType:"json", success:function(a, b) {
        e(a)
      }, error:function() {
        e([])
      }})
    }) : this.source = this.options.source
  }, search:function(a, b) {
    a = a != null ? a : this.element.val(), this.term = this.element.val();
    if(a.length < this.options.minLength) {
      return this.close(b)
    }
    clearTimeout(this.closing);
    if(this._trigger("search", b) === !1) {
      return
    }
    return this._search(a)
  }, _search:function(a) {
    this.pending++, this.element.addClass("ui-autocomplete-loading"), this.source({term:a}, this._response())
  }, _response:function() {
    var a = this, b = ++c;
    return function(d) {
      b === c && a.__response(d), a.pending--, a.pending || a.element.removeClass("ui-autocomplete-loading")
    }
  }, __response:function(a) {
    !this.options.disabled && a && a.length ? (a = this._normalize(a), this._suggest(a), this._trigger("open")) : this.close()
  }, close:function(a) {
    clearTimeout(this.closing), this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.deactivate(), this._trigger("close", a))
  }, _change:function(a) {
    this.previous !== this.element.val() && this._trigger("change", a, {item:this.selectedItem})
  }, _normalize:function(b) {
    return b.length && b[0].label && b[0].value ? b : a.map(b, function(b) {
      return typeof b == "string" ? {label:b, value:b} : a.extend({label:b.label || b.value, value:b.value || b.label}, b)
    })
  }, _suggest:function(b) {
    var c = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
    this._renderMenu(c, b), this.menu.deactivate(), this.menu.refresh(), c.show(), this._resizeMenu(), c.position(a.extend({of:this.element}, this.options.position)), this.options.autoFocus && this.menu.next(new a.Event("mouseover"))
  }, _resizeMenu:function() {
    var a = this.menu.element;
    a.outerWidth(Math.max(a.width("").outerWidth() + 1, this.element.outerWidth()))
  }, _renderMenu:function(b, c) {
    var d = this;
    a.each(c, function(a, c) {
      d._renderItem(b, c)
    })
  }, _renderItem:function(b, c) {
    return a("<li></li>").data("item.autocomplete", c).append(a("<a></a>").text(c.label)).appendTo(b)
  }, _move:function(a, b) {
    if(!this.menu.element.is(":visible")) {
      this.search(null, b);
      return
    }
    if(this.menu.first() && /^previous/.test(a) || this.menu.last() && /^next/.test(a)) {
      this.element.val(this.term), this.menu.deactivate();
      return
    }
    this.menu[a](b)
  }, widget:function() {
    return this.menu.element
  }, _keyEvent:function(a, b) {
    if(!this.isMultiLine || this.menu.element.is(":visible")) {
      this._move(a, b), b.preventDefault()
    }
  }}), a.extend(a.ui.autocomplete, {escapeRegex:function(a) {
    return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
  }, filter:function(b, c) {
    var d = new RegExp(a.ui.autocomplete.escapeRegex(c), "i");
    return a.grep(b, function(a) {
      return d.test(a.label || a.value || a)
    })
  }})
})(jQuery), function(a) {
  a.widget("ui.menu", {_create:function() {
    var b = this;
    this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox", "aria-activedescendant":"ui-active-menuitem"}).click(function(c) {
      if(!a(c.target).closest(".ui-menu-item a").length) {
        return
      }
      c.preventDefault(), b.select(c)
    }), this.refresh()
  }, refresh:function() {
    var b = this, c = this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "menuitem");
    c.children("a").addClass("ui-corner-all").attr("tabindex", -1).mouseenter(function(c) {
      b.activate(c, a(this).parent())
    }).mouseleave(function() {
      b.deactivate()
    })
  }, activate:function(a, b) {
    this.deactivate();
    if(this.hasScroll()) {
      var c = b.offset().top - this.element.offset().top, d = this.element.scrollTop(), e = this.element.height();
      c < 0 ? this.element.scrollTop(d + c) : c >= e && this.element.scrollTop(d + c - e + b.height())
    }
    this.active = b.eq(0).children("a").addClass("ui-state-hover").attr("id", "ui-active-menuitem").end(), this._trigger("focus", a, {item:b})
  }, deactivate:function() {
    if(!this.active) {
      return
    }
    this.active.children("a").removeClass("ui-state-hover").removeAttr("id"), this._trigger("blur"), this.active = null
  }, next:function(a) {
    this.move("next", ".ui-menu-item:first", a)
  }, previous:function(a) {
    this.move("prev", ".ui-menu-item:last", a)
  }, first:function() {
    return this.active && !this.active.prevAll(".ui-menu-item").length
  }, last:function() {
    return this.active && !this.active.nextAll(".ui-menu-item").length
  }, move:function(a, b, c) {
    if(!this.active) {
      this.activate(c, this.element.children(b));
      return
    }
    var d = this.active[a + "All"](".ui-menu-item").eq(0);
    d.length ? this.activate(c, d) : this.activate(c, this.element.children(b))
  }, nextPage:function(b) {
    if(this.hasScroll()) {
      if(!this.active || this.last()) {
        this.activate(b, this.element.children(".ui-menu-item:first"));
        return
      }
      var c = this.active.offset().top, d = this.element.height(), e = this.element.children(".ui-menu-item").filter(function() {
        var b = a(this).offset().top - c - d + a(this).height();
        return b < 10 && b > -10
      });
      e.length || (e = this.element.children(".ui-menu-item:last")), this.activate(b, e)
    }else {
      this.activate(b, this.element.children(".ui-menu-item").filter(!this.active || this.last() ? ":first" : ":last"))
    }
  }, previousPage:function(b) {
    if(this.hasScroll()) {
      if(!this.active || this.first()) {
        this.activate(b, this.element.children(".ui-menu-item:last"));
        return
      }
      var c = this.active.offset().top, d = this.element.height(), e = this.element.children(".ui-menu-item").filter(function() {
        var b = a(this).offset().top - c + d - a(this).height();
        return b < 10 && b > -10
      });
      e.length || (e = this.element.children(".ui-menu-item:first")), this.activate(b, e)
    }else {
      this.activate(b, this.element.children(".ui-menu-item").filter(!this.active || this.first() ? ":last" : ":first"))
    }
  }, hasScroll:function() {
    return this.element.height() < this.element[a.fn.prop ? "prop" : "attr"]("scrollHeight")
  }, select:function(a) {
    this._trigger("selected", a, {item:this.active})
  }})
}(jQuery);
jQuery.effects || function(a, b) {
  function c(b) {
    var c;
    return b && b.constructor == Array && b.length == 3 ? b : (c = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b)) ? [parseInt(c[1], 10), parseInt(c[2], 10), parseInt(c[3], 10)] : (c = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b)) ? [parseFloat(c[1]) * 2.55, parseFloat(c[2]) * 2.55, parseFloat(c[3]) * 2.55] : (c = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b)) ? [parseInt(c[1], 16), parseInt(c[2], 
    16), parseInt(c[3], 16)] : (c = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b)) ? [parseInt(c[1] + c[1], 16), parseInt(c[2] + c[2], 16), parseInt(c[3] + c[3], 16)] : (c = /rgba\(0, 0, 0, 0\)/.exec(b)) ? e.transparent : e[a.trim(b).toLowerCase()]
  }
  function d(b, d) {
    var e;
    do {
      e = a.curCSS(b, d);
      if(e != "" && e != "transparent" || a.nodeName(b, "body")) {
        break
      }
      d = "backgroundColor"
    }while(b = b.parentNode);
    return c(e)
  }
  function h() {
    var a = document.defaultView ? document.defaultView.getComputedStyle(this, null) : this.currentStyle, b = {}, c, d;
    if(a && a.length && a[0] && a[a[0]]) {
      var e = a.length;
      while(e--) {
        c = a[e], typeof a[c] == "string" && (d = c.replace(/\-(\w)/g, function(a, b) {
          return b.toUpperCase()
        }), b[d] = a[c])
      }
    }else {
      for(c in a) {
        typeof a[c] == "string" && (b[c] = a[c])
      }
    }
    return b
  }
  function i(b) {
    var c, d;
    for(c in b) {
      d = b[c], (d == null || a.isFunction(d) || c in g || /scrollbar/.test(c) || !/color/i.test(c) && isNaN(parseFloat(d))) && delete b[c]
    }
    return b
  }
  function j(a, b) {
    var c = {_:0}, d;
    for(d in b) {
      a[d] != b[d] && (c[d] = b[d])
    }
    return c
  }
  function k(b, c, d, e) {
    typeof b == "object" && (e = c, d = null, c = b, b = c.effect), a.isFunction(c) && (e = c, d = null, c = {});
    if(typeof c == "number" || a.fx.speeds[c]) {
      e = d, d = c, c = {}
    }
    return a.isFunction(d) && (e = d, d = null), c = c || {}, d = d || c.duration, d = a.fx.off ? 0 : typeof d == "number" ? d : d in a.fx.speeds ? a.fx.speeds[d] : a.fx.speeds._default, e = e || c.complete, [b, c, d, e]
  }
  function l(b) {
    return!b || typeof b == "number" || a.fx.speeds[b] ? !0 : typeof b == "string" && !a.effects[b] ? !0 : !1
  }
  a.effects = {}, a.each(["backgroundColor", "borderBottomColor", "borderLeftColor", "borderRightColor", "borderTopColor", "borderColor", "color", "outlineColor"], function(b, e) {
    a.fx.step[e] = function(a) {
      a.colorInit || (a.start = d(a.elem, e), a.end = c(a.end), a.colorInit = !0), a.elem.style[e] = "rgb(" + Math.max(Math.min(parseInt(a.pos * (a.end[0] - a.start[0]) + a.start[0], 10), 255), 0) + "," + Math.max(Math.min(parseInt(a.pos * (a.end[1] - a.start[1]) + a.start[1], 10), 255), 0) + "," + Math.max(Math.min(parseInt(a.pos * (a.end[2] - a.start[2]) + a.start[2], 10), 255), 0) + ")"
    }
  });
  var e = {aqua:[0, 255, 255], azure:[240, 255, 255], beige:[245, 245, 220], black:[0, 0, 0], blue:[0, 0, 255], brown:[165, 42, 42], cyan:[0, 255, 255], darkblue:[0, 0, 139], darkcyan:[0, 139, 139], darkgrey:[169, 169, 169], darkgreen:[0, 100, 0], darkkhaki:[189, 183, 107], darkmagenta:[139, 0, 139], darkolivegreen:[85, 107, 47], darkorange:[255, 140, 0], darkorchid:[153, 50, 204], darkred:[139, 0, 0], darksalmon:[233, 150, 122], darkviolet:[148, 0, 211], fuchsia:[255, 0, 255], gold:[255, 215, 0], 
  green:[0, 128, 0], indigo:[75, 0, 130], khaki:[240, 230, 140], lightblue:[173, 216, 230], lightcyan:[224, 255, 255], lightgreen:[144, 238, 144], lightgrey:[211, 211, 211], lightpink:[255, 182, 193], lightyellow:[255, 255, 224], lime:[0, 255, 0], magenta:[255, 0, 255], maroon:[128, 0, 0], navy:[0, 0, 128], olive:[128, 128, 0], orange:[255, 165, 0], pink:[255, 192, 203], purple:[128, 0, 128], violet:[128, 0, 128], red:[255, 0, 0], silver:[192, 192, 192], white:[255, 255, 255], yellow:[255, 255, 0], 
  transparent:[255, 255, 255]}, f = ["add", "remove", "toggle"], g = {border:1, borderBottom:1, borderColor:1, borderLeft:1, borderRight:1, borderTop:1, borderWidth:1, margin:1, padding:1};
  a.effects.animateClass = function(b, c, d, e) {
    return a.isFunction(d) && (e = d, d = null), this.queue(function() {
      var g = a(this), k = g.attr("style") || " ", l = i(h.call(this)), m, n = g.attr("class") || "";
      a.each(f, function(a, c) {
        b[c] && g[c + "Class"](b[c])
      }), m = i(h.call(this)), g.attr("class", n), g.animate(j(l, m), {queue:!1, duration:c, easing:d, complete:function() {
        a.each(f, function(a, c) {
          b[c] && g[c + "Class"](b[c])
        }), typeof g.attr("style") == "object" ? (g.attr("style").cssText = "", g.attr("style").cssText = k) : g.attr("style", k), e && e.apply(this, arguments), a.dequeue(this)
      }})
    })
  }, a.fn.extend({_addClass:a.fn.addClass, addClass:function(b, c, d, e) {
    return c ? a.effects.animateClass.apply(this, [{add:b}, c, d, e]) : this._addClass(b)
  }, _removeClass:a.fn.removeClass, removeClass:function(b, c, d, e) {
    return c ? a.effects.animateClass.apply(this, [{remove:b}, c, d, e]) : this._removeClass(b)
  }, _toggleClass:a.fn.toggleClass, toggleClass:function(c, d, e, f, g) {
    return typeof d == "boolean" || d === b ? e ? a.effects.animateClass.apply(this, [d ? {add:c} : {remove:c}, e, f, g]) : this._toggleClass(c, d) : a.effects.animateClass.apply(this, [{toggle:c}, d, e, f])
  }, switchClass:function(b, c, d, e, f) {
    return a.effects.animateClass.apply(this, [{add:c, remove:b}, d, e, f])
  }}), a.extend(a.effects, {version:"1.8.20", save:function(a, b) {
    for(var c = 0;c < b.length;c++) {
      b[c] !== null && a.data("ec.storage." + b[c], a[0].style[b[c]])
    }
  }, restore:function(a, b) {
    for(var c = 0;c < b.length;c++) {
      b[c] !== null && a.css(b[c], a.data("ec.storage." + b[c]))
    }
  }, setMode:function(a, b) {
    return b == "toggle" && (b = a.is(":hidden") ? "show" : "hide"), b
  }, getBaseline:function(a, b) {
    var c, d;
    switch(a[0]) {
      case "top":
        c = 0;
        break;
      case "middle":
        c = 0.5;
        break;
      case "bottom":
        c = 1;
        break;
      default:
        c = a[0] / b.height
    }
    switch(a[1]) {
      case "left":
        d = 0;
        break;
      case "center":
        d = 0.5;
        break;
      case "right":
        d = 1;
        break;
      default:
        d = a[1] / b.width
    }
    return{x:d, y:c}
  }, createWrapper:function(b) {
    if(b.parent().is(".ui-effects-wrapper")) {
      return b.parent()
    }
    var c = {width:b.outerWidth(!0), height:b.outerHeight(!0), "float":b.css("float")}, d = a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%", background:"transparent", border:"none", margin:0, padding:0}), e = document.activeElement;
    return b.wrap(d), (b[0] === e || a.contains(b[0], e)) && a(e).focus(), d = b.parent(), b.css("position") == "static" ? (d.css({position:"relative"}), b.css({position:"relative"})) : (a.extend(c, {position:b.css("position"), zIndex:b.css("z-index")}), a.each(["top", "left", "bottom", "right"], function(a, d) {
      c[d] = b.css(d), isNaN(parseInt(c[d], 10)) && (c[d] = "auto")
    }), b.css({position:"relative", top:0, left:0, right:"auto", bottom:"auto"})), d.css(c).show()
  }, removeWrapper:function(b) {
    var c, d = document.activeElement;
    return b.parent().is(".ui-effects-wrapper") ? (c = b.parent().replaceWith(b), (b[0] === d || a.contains(b[0], d)) && a(d).focus(), c) : b
  }, setTransition:function(b, c, d, e) {
    return e = e || {}, a.each(c, function(a, c) {
      var f = b.cssUnit(c);
      f[0] > 0 && (e[c] = f[0] * d + f[1])
    }), e
  }}), a.fn.extend({effect:function(b, c, d, e) {
    var f = k.apply(this, arguments), g = {options:f[1], duration:f[2], callback:f[3]}, h = g.options.mode, i = a.effects[b];
    return a.fx.off || !i ? h ? this[h](g.duration, g.callback) : this.each(function() {
      g.callback && g.callback.call(this)
    }) : i.call(this, g)
  }, _show:a.fn.show, show:function(a) {
    if(l(a)) {
      return this._show.apply(this, arguments)
    }
    var b = k.apply(this, arguments);
    return b[1].mode = "show", this.effect.apply(this, b)
  }, _hide:a.fn.hide, hide:function(a) {
    if(l(a)) {
      return this._hide.apply(this, arguments)
    }
    var b = k.apply(this, arguments);
    return b[1].mode = "hide", this.effect.apply(this, b)
  }, __toggle:a.fn.toggle, toggle:function(b) {
    if(l(b) || typeof b == "boolean" || a.isFunction(b)) {
      return this.__toggle.apply(this, arguments)
    }
    var c = k.apply(this, arguments);
    return c[1].mode = "toggle", this.effect.apply(this, c)
  }, cssUnit:function(b) {
    var c = this.css(b), d = [];
    return a.each(["em", "px", "%", "pt"], function(a, b) {
      c.indexOf(b) > 0 && (d = [parseFloat(c), b])
    }), d
  }}), a.easing.jswing = a.easing.swing, a.extend(a.easing, {def:"easeOutQuad", swing:function(b, c, d, e, f) {
    return a.easing[a.easing.def](b, c, d, e, f)
  }, easeInQuad:function(a, b, c, d, e) {
    return d * (b /= e) * b + c
  }, easeOutQuad:function(a, b, c, d, e) {
    return-d * (b /= e) * (b - 2) + c
  }, easeInOutQuad:function(a, b, c, d, e) {
    return(b /= e / 2) < 1 ? d / 2 * b * b + c : -d / 2 * (--b * (b - 2) - 1) + c
  }, easeInCubic:function(a, b, c, d, e) {
    return d * (b /= e) * b * b + c
  }, easeOutCubic:function(a, b, c, d, e) {
    return d * ((b = b / e - 1) * b * b + 1) + c
  }, easeInOutCubic:function(a, b, c, d, e) {
    return(b /= e / 2) < 1 ? d / 2 * b * b * b + c : d / 2 * ((b -= 2) * b * b + 2) + c
  }, easeInQuart:function(a, b, c, d, e) {
    return d * (b /= e) * b * b * b + c
  }, easeOutQuart:function(a, b, c, d, e) {
    return-d * ((b = b / e - 1) * b * b * b - 1) + c
  }, easeInOutQuart:function(a, b, c, d, e) {
    return(b /= e / 2) < 1 ? d / 2 * b * b * b * b + c : -d / 2 * ((b -= 2) * b * b * b - 2) + c
  }, easeInQuint:function(a, b, c, d, e) {
    return d * (b /= e) * b * b * b * b + c
  }, easeOutQuint:function(a, b, c, d, e) {
    return d * ((b = b / e - 1) * b * b * b * b + 1) + c
  }, easeInOutQuint:function(a, b, c, d, e) {
    return(b /= e / 2) < 1 ? d / 2 * b * b * b * b * b + c : d / 2 * ((b -= 2) * b * b * b * b + 2) + c
  }, easeInSine:function(a, b, c, d, e) {
    return-d * Math.cos(b / e * (Math.PI / 2)) + d + c
  }, easeOutSine:function(a, b, c, d, e) {
    return d * Math.sin(b / e * (Math.PI / 2)) + c
  }, easeInOutSine:function(a, b, c, d, e) {
    return-d / 2 * (Math.cos(Math.PI * b / e) - 1) + c
  }, easeInExpo:function(a, b, c, d, e) {
    return b == 0 ? c : d * Math.pow(2, 10 * (b / e - 1)) + c
  }, easeOutExpo:function(a, b, c, d, e) {
    return b == e ? c + d : d * (-Math.pow(2, -10 * b / e) + 1) + c
  }, easeInOutExpo:function(a, b, c, d, e) {
    return b == 0 ? c : b == e ? c + d : (b /= e / 2) < 1 ? d / 2 * Math.pow(2, 10 * (b - 1)) + c : d / 2 * (-Math.pow(2, -10 * --b) + 2) + c
  }, easeInCirc:function(a, b, c, d, e) {
    return-d * (Math.sqrt(1 - (b /= e) * b) - 1) + c
  }, easeOutCirc:function(a, b, c, d, e) {
    return d * Math.sqrt(1 - (b = b / e - 1) * b) + c
  }, easeInOutCirc:function(a, b, c, d, e) {
    return(b /= e / 2) < 1 ? -d / 2 * (Math.sqrt(1 - b * b) - 1) + c : d / 2 * (Math.sqrt(1 - (b -= 2) * b) + 1) + c
  }, easeInElastic:function(a, b, c, d, e) {
    var f = 1.70158, g = 0, h = d;
    if(b == 0) {
      return c
    }
    if((b /= e) == 1) {
      return c + d
    }
    g || (g = e * 0.3);
    if(h < Math.abs(d)) {
      h = d;
      var f = g / 4
    }else {
      var f = g / (2 * Math.PI) * Math.asin(d / h)
    }
    return-(h * Math.pow(2, 10 * (b -= 1)) * Math.sin((b * e - f) * 2 * Math.PI / g)) + c
  }, easeOutElastic:function(a, b, c, d, e) {
    var f = 1.70158, g = 0, h = d;
    if(b == 0) {
      return c
    }
    if((b /= e) == 1) {
      return c + d
    }
    g || (g = e * 0.3);
    if(h < Math.abs(d)) {
      h = d;
      var f = g / 4
    }else {
      var f = g / (2 * Math.PI) * Math.asin(d / h)
    }
    return h * Math.pow(2, -10 * b) * Math.sin((b * e - f) * 2 * Math.PI / g) + d + c
  }, easeInOutElastic:function(a, b, c, d, e) {
    var f = 1.70158, g = 0, h = d;
    if(b == 0) {
      return c
    }
    if((b /= e / 2) == 2) {
      return c + d
    }
    g || (g = e * 0.3 * 1.5);
    if(h < Math.abs(d)) {
      h = d;
      var f = g / 4
    }else {
      var f = g / (2 * Math.PI) * Math.asin(d / h)
    }
    return b < 1 ? -0.5 * h * Math.pow(2, 10 * (b -= 1)) * Math.sin((b * e - f) * 2 * Math.PI / g) + c : h * Math.pow(2, -10 * (b -= 1)) * Math.sin((b * e - f) * 2 * Math.PI / g) * 0.5 + d + c
  }, easeInBack:function(a, c, d, e, f, g) {
    return g == b && (g = 1.70158), e * (c /= f) * c * ((g + 1) * c - g) + d
  }, easeOutBack:function(a, c, d, e, f, g) {
    return g == b && (g = 1.70158), e * ((c = c / f - 1) * c * ((g + 1) * c + g) + 1) + d
  }, easeInOutBack:function(a, c, d, e, f, g) {
    return g == b && (g = 1.70158), (c /= f / 2) < 1 ? e / 2 * c * c * (((g *= 1.525) + 1) * c - g) + d : e / 2 * ((c -= 2) * c * (((g *= 1.525) + 1) * c + g) + 2) + d
  }, easeInBounce:function(b, c, d, e, f) {
    return e - a.easing.easeOutBounce(b, f - c, 0, e, f) + d
  }, easeOutBounce:function(a, b, c, d, e) {
    return(b /= e) < 1 / 2.75 ? d * 7.5625 * b * b + c : b < 2 / 2.75 ? d * (7.5625 * (b -= 1.5 / 2.75) * b + 0.75) + c : b < 2.5 / 2.75 ? d * (7.5625 * (b -= 2.25 / 2.75) * b + 0.9375) + c : d * (7.5625 * (b -= 2.625 / 2.75) * b + 0.984375) + c
  }, easeInOutBounce:function(b, c, d, e, f) {
    return c < f / 2 ? a.easing.easeInBounce(b, c * 2, 0, e, f) * 0.5 + d : a.easing.easeOutBounce(b, c * 2 - f, 0, e, f) * 0.5 + e * 0.5 + d
  }})
}(jQuery);
(function(a, b) {
  a.effects.blind = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right"], e = a.effects.setMode(c, b.options.mode || "hide"), f = b.options.direction || "vertical";
      a.effects.save(c, d), c.show();
      var g = a.effects.createWrapper(c).css({overflow:"hidden"}), h = f == "vertical" ? "height" : "width", i = f == "vertical" ? g.height() : g.width();
      e == "show" && g.css(h, 0);
      var j = {};
      j[h] = e == "show" ? i : 0, g.animate(j, b.duration, b.options.easing, function() {
        e == "hide" && c.hide(), a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(c[0], arguments), c.dequeue()
      })
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.bounce = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right"], e = a.effects.setMode(c, b.options.mode || "effect"), f = b.options.direction || "up", g = b.options.distance || 20, h = b.options.times || 5, i = b.duration || 250;
      /show|hide/.test(e) && d.push("opacity"), a.effects.save(c, d), c.show(), a.effects.createWrapper(c);
      var j = f == "up" || f == "down" ? "top" : "left", k = f == "up" || f == "left" ? "pos" : "neg", g = b.options.distance || (j == "top" ? c.outerHeight({margin:!0}) / 3 : c.outerWidth({margin:!0}) / 3);
      e == "show" && c.css("opacity", 0).css(j, k == "pos" ? -g : g), e == "hide" && (g = g / (h * 2)), e != "hide" && h--;
      if(e == "show") {
        var l = {opacity:1};
        l[j] = (k == "pos" ? "+=" : "-=") + g, c.animate(l, i / 2, b.options.easing), g = g / 2, h--
      }
      for(var m = 0;m < h;m++) {
        var n = {}, p = {};
        n[j] = (k == "pos" ? "-=" : "+=") + g, p[j] = (k == "pos" ? "+=" : "-=") + g, c.animate(n, i / 2, b.options.easing).animate(p, i / 2, b.options.easing), g = e == "hide" ? g * 2 : g / 2
      }
      if(e == "hide") {
        var l = {opacity:0};
        l[j] = (k == "pos" ? "-=" : "+=") + g, c.animate(l, i / 2, b.options.easing, function() {
          c.hide(), a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(this, arguments)
        })
      }else {
        var n = {}, p = {};
        n[j] = (k == "pos" ? "-=" : "+=") + g, p[j] = (k == "pos" ? "+=" : "-=") + g, c.animate(n, i / 2, b.options.easing).animate(p, i / 2, b.options.easing, function() {
          a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(this, arguments)
        })
      }
      c.queue("fx", function() {
        c.dequeue()
      }), c.dequeue()
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.clip = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right", "height", "width"], e = a.effects.setMode(c, b.options.mode || "hide"), f = b.options.direction || "vertical";
      a.effects.save(c, d), c.show();
      var g = a.effects.createWrapper(c).css({overflow:"hidden"}), h = c[0].tagName == "IMG" ? g : c, i = {size:f == "vertical" ? "height" : "width", position:f == "vertical" ? "top" : "left"}, j = f == "vertical" ? h.height() : h.width();
      e == "show" && (h.css(i.size, 0), h.css(i.position, j / 2));
      var k = {};
      k[i.size] = e == "show" ? j : 0, k[i.position] = e == "show" ? 0 : j / 2, h.animate(k, {queue:!1, duration:b.duration, easing:b.options.easing, complete:function() {
        e == "hide" && c.hide(), a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(c[0], arguments), c.dequeue()
      }})
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.drop = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right", "opacity"], e = a.effects.setMode(c, b.options.mode || "hide"), f = b.options.direction || "left";
      a.effects.save(c, d), c.show(), a.effects.createWrapper(c);
      var g = f == "up" || f == "down" ? "top" : "left", h = f == "up" || f == "left" ? "pos" : "neg", i = b.options.distance || (g == "top" ? c.outerHeight({margin:!0}) / 2 : c.outerWidth({margin:!0}) / 2);
      e == "show" && c.css("opacity", 0).css(g, h == "pos" ? -i : i);
      var j = {opacity:e == "show" ? 1 : 0};
      j[g] = (e == "show" ? h == "pos" ? "+=" : "-=" : h == "pos" ? "-=" : "+=") + i, c.animate(j, {queue:!1, duration:b.duration, easing:b.options.easing, complete:function() {
        e == "hide" && c.hide(), a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(this, arguments), c.dequeue()
      }})
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.explode = function(b) {
    return this.queue(function() {
      var c = b.options.pieces ? Math.round(Math.sqrt(b.options.pieces)) : 3, d = b.options.pieces ? Math.round(Math.sqrt(b.options.pieces)) : 3;
      b.options.mode = b.options.mode == "toggle" ? a(this).is(":visible") ? "hide" : "show" : b.options.mode;
      var e = a(this).show().css("visibility", "hidden"), f = e.offset();
      f.top -= parseInt(e.css("marginTop"), 10) || 0, f.left -= parseInt(e.css("marginLeft"), 10) || 0;
      var g = e.outerWidth(!0), h = e.outerHeight(!0);
      for(var i = 0;i < c;i++) {
        for(var j = 0;j < d;j++) {
          e.clone().appendTo("body").wrap("<div></div>").css({position:"absolute", visibility:"visible", left:-j * (g / d), top:-i * (h / c)}).parent().addClass("ui-effects-explode").css({position:"absolute", overflow:"hidden", width:g / d, height:h / c, left:f.left + j * (g / d) + (b.options.mode == "show" ? (j - Math.floor(d / 2)) * (g / d) : 0), top:f.top + i * (h / c) + (b.options.mode == "show" ? (i - Math.floor(c / 2)) * (h / c) : 0), opacity:b.options.mode == "show" ? 0 : 1}).animate({left:f.left + 
          j * (g / d) + (b.options.mode == "show" ? 0 : (j - Math.floor(d / 2)) * (g / d)), top:f.top + i * (h / c) + (b.options.mode == "show" ? 0 : (i - Math.floor(c / 2)) * (h / c)), opacity:b.options.mode == "show" ? 1 : 0}, b.duration || 500)
        }
      }
      setTimeout(function() {
        b.options.mode == "show" ? e.css({visibility:"visible"}) : e.css({visibility:"visible"}).hide(), b.callback && b.callback.apply(e[0]), e.dequeue(), a("div.ui-effects-explode").remove()
      }, b.duration || 500)
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.fade = function(b) {
    return this.queue(function() {
      var c = a(this), d = a.effects.setMode(c, b.options.mode || "hide");
      c.animate({opacity:d}, {queue:!1, duration:b.duration, easing:b.options.easing, complete:function() {
        b.callback && b.callback.apply(this, arguments), c.dequeue()
      }})
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.fold = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right"], e = a.effects.setMode(c, b.options.mode || "hide"), f = b.options.size || 15, g = !!b.options.horizFirst, h = b.duration ? b.duration / 2 : a.fx.speeds._default / 2;
      a.effects.save(c, d), c.show();
      var i = a.effects.createWrapper(c).css({overflow:"hidden"}), j = e == "show" != g, k = j ? ["width", "height"] : ["height", "width"], l = j ? [i.width(), i.height()] : [i.height(), i.width()], m = /([0-9]+)%/.exec(f);
      m && (f = parseInt(m[1], 10) / 100 * l[e == "hide" ? 0 : 1]), e == "show" && i.css(g ? {height:0, width:f} : {height:f, width:0});
      var n = {}, p = {};
      n[k[0]] = e == "show" ? l[0] : f, p[k[1]] = e == "show" ? l[1] : 0, i.animate(n, h, b.options.easing).animate(p, h, b.options.easing, function() {
        e == "hide" && c.hide(), a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(c[0], arguments), c.dequeue()
      })
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.highlight = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["backgroundImage", "backgroundColor", "opacity"], e = a.effects.setMode(c, b.options.mode || "show"), f = {backgroundColor:c.css("backgroundColor")};
      e == "hide" && (f.opacity = 0), a.effects.save(c, d), c.show().css({backgroundImage:"none", backgroundColor:b.options.color || "#ffff99"}).animate(f, {queue:!1, duration:b.duration, easing:b.options.easing, complete:function() {
        e == "hide" && c.hide(), a.effects.restore(c, d), e == "show" && !a.support.opacity && this.style.removeAttribute("filter"), b.callback && b.callback.apply(this, arguments), c.dequeue()
      }})
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.pulsate = function(b) {
    return this.queue(function() {
      var c = a(this), d = a.effects.setMode(c, b.options.mode || "show"), e = (b.options.times || 5) * 2 - 1, f = b.duration ? b.duration / 2 : a.fx.speeds._default / 2, g = c.is(":visible"), h = 0;
      g || (c.css("opacity", 0).show(), h = 1), (d == "hide" && g || d == "show" && !g) && e--;
      for(var i = 0;i < e;i++) {
        c.animate({opacity:h}, f, b.options.easing), h = (h + 1) % 2
      }
      c.animate({opacity:h}, f, b.options.easing, function() {
        h == 0 && c.hide(), b.callback && b.callback.apply(this, arguments)
      }), c.queue("fx", function() {
        c.dequeue()
      }).dequeue()
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.puff = function(b) {
    return this.queue(function() {
      var c = a(this), d = a.effects.setMode(c, b.options.mode || "hide"), e = parseInt(b.options.percent, 10) || 150, f = e / 100, g = {height:c.height(), width:c.width()};
      a.extend(b.options, {fade:!0, mode:d, percent:d == "hide" ? e : 100, from:d == "hide" ? g : {height:g.height * f, width:g.width * f}}), c.effect("scale", b.options, b.duration, b.callback), c.dequeue()
    })
  }, a.effects.scale = function(b) {
    return this.queue(function() {
      var c = a(this), d = a.extend(!0, {}, b.options), e = a.effects.setMode(c, b.options.mode || "effect"), f = parseInt(b.options.percent, 10) || (parseInt(b.options.percent, 10) == 0 ? 0 : e == "hide" ? 0 : 100), g = b.options.direction || "both", h = b.options.origin;
      e != "effect" && (d.origin = h || ["middle", "center"], d.restore = !0);
      var i = {height:c.height(), width:c.width()};
      c.from = b.options.from || (e == "show" ? {height:0, width:0} : i);
      var j = {y:g != "horizontal" ? f / 100 : 1, x:g != "vertical" ? f / 100 : 1};
      c.to = {height:i.height * j.y, width:i.width * j.x}, b.options.fade && (e == "show" && (c.from.opacity = 0, c.to.opacity = 1), e == "hide" && (c.from.opacity = 1, c.to.opacity = 0)), d.from = c.from, d.to = c.to, d.mode = e, c.effect("size", d, b.duration, b.callback), c.dequeue()
    })
  }, a.effects.size = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"], e = ["position", "top", "bottom", "left", "right", "overflow", "opacity"], f = ["width", "height", "overflow"], g = ["fontSize"], h = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"], i = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"], j = a.effects.setMode(c, b.options.mode || "effect"), k = b.options.restore || !1, l = b.options.scale || 
      "both", m = b.options.origin, n = {height:c.height(), width:c.width()};
      c.from = b.options.from || n, c.to = b.options.to || n;
      if(m) {
        var p = a.effects.getBaseline(m, n);
        c.from.top = (n.height - c.from.height) * p.y, c.from.left = (n.width - c.from.width) * p.x, c.to.top = (n.height - c.to.height) * p.y, c.to.left = (n.width - c.to.width) * p.x
      }
      var q = {from:{y:c.from.height / n.height, x:c.from.width / n.width}, to:{y:c.to.height / n.height, x:c.to.width / n.width}};
      if(l == "box" || l == "both") {
        q.from.y != q.to.y && (d = d.concat(h), c.from = a.effects.setTransition(c, h, q.from.y, c.from), c.to = a.effects.setTransition(c, h, q.to.y, c.to)), q.from.x != q.to.x && (d = d.concat(i), c.from = a.effects.setTransition(c, i, q.from.x, c.from), c.to = a.effects.setTransition(c, i, q.to.x, c.to))
      }
      (l == "content" || l == "both") && q.from.y != q.to.y && (d = d.concat(g), c.from = a.effects.setTransition(c, g, q.from.y, c.from), c.to = a.effects.setTransition(c, g, q.to.y, c.to)), a.effects.save(c, k ? d : e), c.show(), a.effects.createWrapper(c), c.css("overflow", "hidden").css(c.from);
      if(l == "content" || l == "both") {
        h = h.concat(["marginTop", "marginBottom"]).concat(g), i = i.concat(["marginLeft", "marginRight"]), f = d.concat(h).concat(i), c.find("*[width]").each(function() {
          var c = a(this);
          k && a.effects.save(c, f);
          var d = {height:c.height(), width:c.width()};
          c.from = {height:d.height * q.from.y, width:d.width * q.from.x}, c.to = {height:d.height * q.to.y, width:d.width * q.to.x}, q.from.y != q.to.y && (c.from = a.effects.setTransition(c, h, q.from.y, c.from), c.to = a.effects.setTransition(c, h, q.to.y, c.to)), q.from.x != q.to.x && (c.from = a.effects.setTransition(c, i, q.from.x, c.from), c.to = a.effects.setTransition(c, i, q.to.x, c.to)), c.css(c.from), c.animate(c.to, b.duration, b.options.easing, function() {
            k && a.effects.restore(c, f)
          })
        })
      }
      c.animate(c.to, {queue:!1, duration:b.duration, easing:b.options.easing, complete:function() {
        c.to.opacity === 0 && c.css("opacity", c.from.opacity), j == "hide" && c.hide(), a.effects.restore(c, k ? d : e), a.effects.removeWrapper(c), b.callback && b.callback.apply(this, arguments), c.dequeue()
      }})
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.shake = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right"], e = a.effects.setMode(c, b.options.mode || "effect"), f = b.options.direction || "left", g = b.options.distance || 20, h = b.options.times || 3, i = b.duration || b.options.duration || 140;
      a.effects.save(c, d), c.show(), a.effects.createWrapper(c);
      var j = f == "up" || f == "down" ? "top" : "left", k = f == "up" || f == "left" ? "pos" : "neg", l = {}, m = {}, n = {};
      l[j] = (k == "pos" ? "-=" : "+=") + g, m[j] = (k == "pos" ? "+=" : "-=") + g * 2, n[j] = (k == "pos" ? "-=" : "+=") + g * 2, c.animate(l, i, b.options.easing);
      for(var p = 1;p < h;p++) {
        c.animate(m, i, b.options.easing).animate(n, i, b.options.easing)
      }
      c.animate(m, i, b.options.easing).animate(l, i / 2, b.options.easing, function() {
        a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(this, arguments)
      }), c.queue("fx", function() {
        c.dequeue()
      }), c.dequeue()
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.slide = function(b) {
    return this.queue(function() {
      var c = a(this), d = ["position", "top", "bottom", "left", "right"], e = a.effects.setMode(c, b.options.mode || "show"), f = b.options.direction || "left";
      a.effects.save(c, d), c.show(), a.effects.createWrapper(c).css({overflow:"hidden"});
      var g = f == "up" || f == "down" ? "top" : "left", h = f == "up" || f == "left" ? "pos" : "neg", i = b.options.distance || (g == "top" ? c.outerHeight({margin:!0}) : c.outerWidth({margin:!0}));
      e == "show" && c.css(g, h == "pos" ? isNaN(i) ? "-" + i : -i : i);
      var j = {};
      j[g] = (e == "show" ? h == "pos" ? "+=" : "-=" : h == "pos" ? "-=" : "+=") + i, c.animate(j, {queue:!1, duration:b.duration, easing:b.options.easing, complete:function() {
        e == "hide" && c.hide(), a.effects.restore(c, d), a.effects.removeWrapper(c), b.callback && b.callback.apply(this, arguments), c.dequeue()
      }})
    })
  }
})(jQuery);
(function(a, b) {
  a.effects.transfer = function(b) {
    return this.queue(function() {
      var c = a(this), d = a(b.options.to), e = d.offset(), f = {top:e.top, left:e.left, height:d.innerHeight(), width:d.innerWidth()}, g = c.offset(), h = a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:g.top, left:g.left, height:c.innerHeight(), width:c.innerWidth(), position:"absolute"}).animate(f, b.duration, b.options.easing, function() {
        h.remove(), b.callback && b.callback.apply(c[0], arguments), c.dequeue()
      })
    })
  }
})(jQuery);
(function($) {
  if($.fn.carouFredSel) {
    return
  }
  $.fn.carouFredSel = function(options, configs) {
    if(this.length == 0) {
      debug(true, 'No element found for "' + this.selector + '".');
      return this
    }
    if(this.length > 1) {
      return this.each(function() {
        $(this).carouFredSel(options, configs)
      })
    }
    var $cfs = this, $tt0 = this[0];
    if($cfs.data("cfs_isCarousel")) {
      var starting_position = $cfs.triggerHandler("_cfs_currentPosition");
      $cfs.trigger("_cfs_destroy", true)
    }else {
      var starting_position = false
    }
    $cfs._cfs_init = function(o, setOrig, start) {
      o = go_getObject($tt0, o);
      if(o.debug) {
        conf.debug = o.debug;
        debug(conf, 'The "debug" option should be moved to the second configuration-object.')
      }
      var obs = ["items", "scroll", "auto", "prev", "next", "pagination"];
      for(var a = 0, l = obs.length;a < l;a++) {
        o[obs[a]] = go_getObject($tt0, o[obs[a]])
      }
      if(typeof o.scroll == "number") {
        if(o.scroll <= 50) {
          o.scroll = {"items":o.scroll}
        }else {
          o.scroll = {"duration":o.scroll}
        }
      }else {
        if(typeof o.scroll == "string") {
          o.scroll = {"easing":o.scroll}
        }
      }
      if(typeof o.items == "number") {
        o.items = {"visible":o.items}
      }else {
        if(o.items == "variable") {
          o.items = {"visible":o.items, "width":o.items, "height":o.items}
        }
      }
      if(typeof o.items != "object") {
        o.items = {}
      }
      if(setOrig) {
        opts_orig = $.extend(true, {}, $.fn.carouFredSel.defaults, o)
      }
      opts = $.extend(true, {}, $.fn.carouFredSel.defaults, o);
      if(typeof opts.items.visibleConf != "object") {
        opts.items.visibleConf = {}
      }
      if(opts.items.start == 0 && typeof start == "number") {
        opts.items.start = start
      }
      crsl.upDateOnWindowResize = opts.responsive;
      crsl.direction = opts.direction == "up" || opts.direction == "left" ? "next" : "prev";
      var dims = [["width", "innerWidth", "outerWidth", "height", "innerHeight", "outerHeight", "left", "top", "marginRight", 0, 1, 2, 3], ["height", "innerHeight", "outerHeight", "width", "innerWidth", "outerWidth", "top", "left", "marginBottom", 3, 2, 1, 0]];
      var dn = dims[0].length, dx = opts.direction == "right" || opts.direction == "left" ? 0 : 1;
      opts.d = {};
      for(var d = 0;d < dn;d++) {
        opts.d[dims[0][d]] = dims[dx][d]
      }
      var all_itm = $cfs.children();
      switch(typeof opts.items.visible) {
        case "object":
          opts.items.visibleConf.min = opts.items.visible.min;
          opts.items.visibleConf.max = opts.items.visible.max;
          opts.items.visible = false;
          break;
        case "string":
          if(opts.items.visible == "variable") {
            opts.items.visibleConf.variable = true
          }else {
            opts.items.visibleConf.adjust = opts.items.visible
          }
          opts.items.visible = false;
          break;
        case "function":
          opts.items.visibleConf.adjust = opts.items.visible;
          opts.items.visible = false;
          break
      }
      if(typeof opts.items.filter == "undefined") {
        opts.items.filter = all_itm.filter(":hidden").length > 0 ? ":visible" : "*"
      }
      if(opts[opts.d["width"]] == "auto") {
        opts[opts.d["width"]] = ms_getTrueLargestSize(all_itm, opts, "outerWidth")
      }
      if(ms_isPercentage(opts[opts.d["width"]]) && !opts.responsive) {
        opts[opts.d["width"]] = ms_getPercentage(ms_getTrueInnerSize($wrp.parent(), opts, "innerWidth"), opts[opts.d["width"]]);
        crsl.upDateOnWindowResize = true
      }
      if(opts[opts.d["height"]] == "auto") {
        opts[opts.d["height"]] = ms_getTrueLargestSize(all_itm, opts, "outerHeight")
      }
      if(!opts.items[opts.d["width"]]) {
        if(opts.responsive) {
          debug(true, "Set a " + opts.d["width"] + " for the items!");
          opts.items[opts.d["width"]] = ms_getTrueLargestSize(all_itm, opts, "outerWidth")
        }else {
          opts.items[opts.d["width"]] = ms_hasVariableSizes(all_itm, opts, "outerWidth") ? "variable" : all_itm[opts.d["outerWidth"]](true)
        }
      }
      if(!opts.items[opts.d["height"]]) {
        opts.items[opts.d["height"]] = ms_hasVariableSizes(all_itm, opts, "outerHeight") ? "variable" : all_itm[opts.d["outerHeight"]](true)
      }
      if(!opts[opts.d["height"]]) {
        opts[opts.d["height"]] = opts.items[opts.d["height"]]
      }
      if(!opts.items.visible && !opts.responsive) {
        if(opts.items[opts.d["width"]] == "variable") {
          opts.items.visibleConf.variable = true
        }
        if(!opts.items.visibleConf.variable) {
          if(typeof opts[opts.d["width"]] == "number") {
            opts.items.visible = Math.floor(opts[opts.d["width"]] / opts.items[opts.d["width"]])
          }else {
            var maxS = ms_getTrueInnerSize($wrp.parent(), opts, "innerWidth");
            opts.items.visible = Math.floor(maxS / opts.items[opts.d["width"]]);
            opts[opts.d["width"]] = opts.items.visible * opts.items[opts.d["width"]];
            if(!opts.items.visibleConf.adjust) {
              opts.align = false
            }
          }
          if(opts.items.visible == "Infinity" || opts.items.visible < 1) {
            debug(true, 'Not a valid number of visible items: Set to "variable".');
            opts.items.visibleConf.variable = true
          }
        }
      }
      if(!opts[opts.d["width"]]) {
        opts[opts.d["width"]] = "variable";
        if(!opts.responsive && opts.items.filter == "*" && !opts.items.visibleConf.variable && opts.items[opts.d["width"]] != "variable") {
          opts[opts.d["width"]] = opts.items.visible * opts.items[opts.d["width"]];
          opts.align = false
        }
      }
      if(opts.items.visibleConf.variable) {
        opts.maxDimention = opts[opts.d["width"]] == "variable" ? ms_getTrueInnerSize($wrp.parent(), opts, "innerWidth") : opts[opts.d["width"]];
        if(opts.align === false) {
          opts[opts.d["width"]] = "variable"
        }
        opts.items.visible = gn_getVisibleItemsNext(all_itm, opts, 0)
      }else {
        if(opts.items.filter != "*") {
          opts.items.visibleConf.org = opts.items.visible;
          opts.items.visible = gn_getVisibleItemsNextFilter(all_itm, opts, 0)
        }
      }
      if(typeof opts.align == "undefined") {
        opts.align = opts[opts.d["width"]] == "variable" ? false : "center"
      }
      opts.items.visible = cf_getItemsAdjust(opts.items.visible, opts, opts.items.visibleConf.adjust, $tt0);
      opts.items.visibleConf.old = opts.items.visible;
      opts.usePadding = false;
      if(opts.responsive) {
        if(!opts.items.visibleConf.min) {
          opts.items.visibleConf.min = opts.items.visible
        }
        if(!opts.items.visibleConf.max) {
          opts.items.visibleConf.max = opts.items.visible
        }
        opts.align = false;
        opts.padding = [0, 0, 0, 0];
        var isVisible = $wrp.is(":visible");
        if(isVisible) {
          $wrp.hide()
        }
        var fullS = ms_getPercentage(ms_getTrueInnerSize($wrp.parent(), opts, "innerWidth"), opts[opts.d["width"]]);
        if(typeof opts[opts.d["width"]] == "number" && fullS < opts[opts.d["width"]]) {
          fullS = opts[opts.d["width"]]
        }
        if(isVisible) {
          $wrp.show()
        }
        var visb = cf_getItemAdjustMinMax(Math.ceil(fullS / opts.items[opts.d["width"]]), opts.items.visibleConf);
        if(visb > all_itm.length) {
          visb = all_itm.length
        }
        var newS = Math.floor(fullS / visb), seco = opts[opts.d["height"]], secp = ms_isPercentage(seco);
        all_itm.each(function() {
          var $t = $(this), nw = newS - ms_getPaddingBorderMargin($t, opts, "Width");
          $t[opts.d["width"]](nw);
          if(secp) {
            $t[opts.d["height"]](ms_getPercentage(nw, seco))
          }
        });
        opts.items.visible = visb;
        opts.items[opts.d["width"]] = newS;
        opts[opts.d["width"]] = visb * newS
      }else {
        opts.padding = cf_getPadding(opts.padding);
        if(opts.align == "top") {
          opts.align = "left"
        }
        if(opts.align == "bottom") {
          opts.align = "right"
        }
        switch(opts.align) {
          case "center":
          ;
          case "left":
          ;
          case "right":
            if(opts[opts.d["width"]] != "variable") {
              var p = cf_getAlignPadding(gi_getCurrentItems(all_itm, opts), opts);
              opts.usePadding = true;
              opts.padding[opts.d[1]] = p[1];
              opts.padding[opts.d[3]] = p[0]
            }
            break;
          default:
            opts.align = false;
            opts.usePadding = opts.padding[0] == 0 && opts.padding[1] == 0 && opts.padding[2] == 0 && opts.padding[3] == 0 ? false : true;
            break
        }
      }
      if(typeof opts.cookie == "boolean" && opts.cookie) {
        opts.cookie = "caroufredsel_cookie_" + $cfs.attr("id")
      }
      if(typeof opts.items.minimum != "number") {
        opts.items.minimum = opts.items.visible
      }
      if(typeof opts.scroll.duration != "number") {
        opts.scroll.duration = 500
      }
      if(typeof opts.scroll.items == "undefined") {
        opts.scroll.items = opts.items.visibleConf.variable || opts.items.filter != "*" ? "visible" : opts.items.visible
      }
      opts.auto = go_getNaviObject($tt0, opts.auto, "auto");
      opts.prev = go_getNaviObject($tt0, opts.prev);
      opts.next = go_getNaviObject($tt0, opts.next);
      opts.pagination = go_getNaviObject($tt0, opts.pagination, "pagination");
      opts.auto = $.extend(true, {}, opts.scroll, opts.auto);
      opts.prev = $.extend(true, {}, opts.scroll, opts.prev);
      opts.next = $.extend(true, {}, opts.scroll, opts.next);
      opts.pagination = $.extend(true, {}, opts.scroll, opts.pagination);
      if(typeof opts.pagination.keys != "boolean") {
        opts.pagination.keys = false
      }
      if(typeof opts.pagination.anchorBuilder != "function" && opts.pagination.anchorBuilder !== false) {
        opts.pagination.anchorBuilder = $.fn.carouFredSel.pageAnchorBuilder
      }
      if(typeof opts.auto.play != "boolean") {
        opts.auto.play = true
      }
      if(typeof opts.auto.delay != "number") {
        opts.auto.delay = 0
      }
      if(typeof opts.auto.pauseOnEvent == "undefined") {
        opts.auto.pauseOnEvent = true
      }
      if(typeof opts.auto.pauseOnResize != "boolean") {
        opts.auto.pauseOnResize = true
      }
      if(typeof opts.auto.pauseDuration != "number") {
        opts.auto.pauseDuration = opts.auto.duration < 10 ? 2500 : opts.auto.duration * 5
      }
      if(opts.synchronise) {
        opts.synchronise = cf_getSynchArr(opts.synchronise)
      }
      if(conf.debug) {
        debug(conf, "Carousel width: " + opts.width);
        debug(conf, "Carousel height: " + opts.height);
        if(opts.maxDimention) {
          debug(conf, "Available " + opts.d["width"] + ": " + opts.maxDimention)
        }
        debug(conf, "Item widths: " + opts.items.width);
        debug(conf, "Item heights: " + opts.items.height);
        debug(conf, "Number of items visible: " + opts.items.visible);
        if(opts.auto.play) {
          debug(conf, "Number of items scrolled automatically: " + opts.auto.items)
        }
        if(opts.prev.button) {
          debug(conf, "Number of items scrolled backward: " + opts.prev.items)
        }
        if(opts.next.button) {
          debug(conf, "Number of items scrolled forward: " + opts.next.items)
        }
      }
    };
    $cfs._cfs_build = function() {
      $cfs.data("cfs_isCarousel", true);
      var orgCSS = {"textAlign":$cfs.css("textAlign"), "float":$cfs.css("float"), "position":$cfs.css("position"), "top":$cfs.css("top"), "right":$cfs.css("right"), "bottom":$cfs.css("bottom"), "left":$cfs.css("left"), "width":$cfs.css("width"), "height":$cfs.css("height"), "marginTop":$cfs.css("marginTop"), "marginRight":$cfs.css("marginRight"), "marginBottom":$cfs.css("marginBottom"), "marginLeft":$cfs.css("marginLeft")};
      switch(orgCSS.position) {
        case "absolute":
          var newPosition = "absolute";
          break;
        case "fixed":
          var newPosition = "fixed";
          break;
        default:
          var newPosition = "relative"
      }
      $wrp.css(orgCSS).css({"position":newPosition});
      $cfs.data("cfs_origCss", orgCSS).css({"textAlign":"left", "float":"none", "position":"absolute", "top":0, "left":0, "marginTop":0, "marginRight":0, "marginBottom":0, "marginLeft":0});
      if(opts.usePadding) {
        $cfs.children().each(function() {
          var m = parseInt($(this).css(opts.d["marginRight"]));
          if(isNaN(m)) {
            m = 0
          }
          $(this).data("cfs_origCssMargin", m)
        })
      }
    };
    $cfs._cfs_bind_events = function() {
      $cfs._cfs_unbind_events();
      $cfs.bind(cf_e("stop", conf), function(e, imm) {
        e.stopPropagation();
        if(!crsl.isStopped) {
          if(opts.auto.button) {
            opts.auto.button.addClass(cf_c("stopped", conf))
          }
        }
        crsl.isStopped = true;
        if(opts.auto.play) {
          opts.auto.play = false;
          $cfs.trigger(cf_e("pause", conf), imm)
        }
        return true
      });
      $cfs.bind(cf_e("finish", conf), function(e) {
        e.stopPropagation();
        if(crsl.isScrolling) {
          sc_stopScroll(scrl)
        }
        return true
      });
      $cfs.bind(cf_e("pause", conf), function(e, imm, res) {
        e.stopPropagation();
        tmrs = sc_clearTimers(tmrs);
        if(imm && crsl.isScrolling) {
          scrl.isStopped = true;
          var nst = getTime() - scrl.startTime;
          scrl.duration -= nst;
          if(scrl.pre) {
            scrl.pre.duration -= nst
          }
          if(scrl.post) {
            scrl.post.duration -= nst
          }
          sc_stopScroll(scrl, false)
        }
        if(!crsl.isPaused && !crsl.isScrolling) {
          if(res) {
            tmrs.timePassed += getTime() - tmrs.startTime
          }
        }
        if(!crsl.isPaused) {
          if(opts.auto.button) {
            opts.auto.button.addClass(cf_c("paused", conf))
          }
        }
        crsl.isPaused = true;
        if(opts.auto.onPausePause) {
          var dur1 = opts.auto.pauseDuration - tmrs.timePassed, perc = 100 - Math.ceil(dur1 * 100 / opts.auto.pauseDuration);
          opts.auto.onPausePause.call($tt0, perc, dur1)
        }
        return true
      });
      $cfs.bind(cf_e("play", conf), function(e, dir, del, res) {
        e.stopPropagation();
        tmrs = sc_clearTimers(tmrs);
        var v = [dir, del, res], t = ["string", "number", "boolean"], a = cf_sortParams(v, t);
        var dir = a[0], del = a[1], res = a[2];
        if(dir != "prev" && dir != "next") {
          dir = crsl.direction
        }
        if(typeof del != "number") {
          del = 0
        }
        if(typeof res != "boolean") {
          res = false
        }
        if(res) {
          crsl.isStopped = false;
          opts.auto.play = true
        }
        if(!opts.auto.play) {
          e.stopImmediatePropagation();
          return debug(conf, "Carousel stopped: Not scrolling.")
        }
        if(crsl.isPaused) {
          if(opts.auto.button) {
            opts.auto.button.removeClass(cf_c("stopped", conf));
            opts.auto.button.removeClass(cf_c("paused", conf))
          }
        }
        crsl.isPaused = false;
        tmrs.startTime = getTime();
        var dur1 = opts.auto.pauseDuration + del;
        dur2 = dur1 - tmrs.timePassed;
        perc = 100 - Math.ceil(dur2 * 100 / dur1);
        tmrs.auto = setTimeout(function() {
          if(opts.auto.onPauseEnd) {
            opts.auto.onPauseEnd.call($tt0, perc, dur2)
          }
          if(crsl.isScrolling) {
            $cfs.trigger(cf_e("play", conf), dir)
          }else {
            $cfs.trigger(cf_e(dir, conf), opts.auto)
          }
        }, dur2);
        if(opts.auto.onPauseStart) {
          opts.auto.onPauseStart.call($tt0, perc, dur2)
        }
        return true
      });
      $cfs.bind(cf_e("resume", conf), function(e) {
        e.stopPropagation();
        if(scrl.isStopped) {
          scrl.isStopped = false;
          crsl.isPaused = false;
          crsl.isScrolling = true;
          scrl.startTime = getTime();
          sc_startScroll(scrl)
        }else {
          $cfs.trigger(cf_e("play", conf))
        }
        return true
      });
      $cfs.bind(cf_e("prev", conf) + " " + cf_e("next", conf), function(e, obj, num, clb) {
        e.stopPropagation();
        if(crsl.isStopped || $cfs.is(":hidden")) {
          e.stopImmediatePropagation();
          return debug(conf, "Carousel stopped or hidden: Not scrolling.")
        }
        if(opts.items.minimum >= itms.total) {
          e.stopImmediatePropagation();
          return debug(conf, "Not enough items (" + itms.total + ", " + opts.items.minimum + " needed): Not scrolling.")
        }
        var v = [obj, num, clb], t = ["object", "number/string", "function"], a = cf_sortParams(v, t);
        var obj = a[0], num = a[1], clb = a[2];
        var eType = e.type.substr(conf.events.prefix.length);
        if(typeof obj != "object" || obj == null) {
          obj = opts[eType]
        }
        if(typeof clb == "function") {
          obj.onAfter = clb
        }
        if(typeof num != "number") {
          if(opts.items.filter != "*") {
            num = "visible"
          }else {
            var arr = [num, obj.items, opts[eType].items];
            for(var a = 0, l = arr.length;a < l;a++) {
              if(typeof arr[a] == "number" || arr[a] == "page" || arr[a] == "visible") {
                num = arr[a];
                break
              }
            }
          }
          switch(num) {
            case "page":
              e.stopImmediatePropagation();
              return $cfs.triggerHandler(eType + "Page", [obj, clb]);
              break;
            case "visible":
              if(!opts.items.visibleConf.variable && opts.items.filter == "*") {
                num = opts.items.visible
              }
              break
          }
        }
        if(scrl.isStopped) {
          $cfs.trigger(cf_e("resume", conf));
          $cfs.trigger(cf_e("queue", conf), [eType, [obj, num, clb]]);
          e.stopImmediatePropagation();
          return debug(conf, "Carousel resumed scrolling.")
        }
        if(obj.duration > 0) {
          if(crsl.isScrolling) {
            if(obj.queue) {
              $cfs.trigger(cf_e("queue", conf), [eType, [obj, num, clb]])
            }
            e.stopImmediatePropagation();
            return debug(conf, "Carousel currently scrolling.")
          }
        }
        if(obj.conditions && !obj.conditions.call($tt0)) {
          e.stopImmediatePropagation();
          return debug(conf, 'Callback "conditions" returned false.')
        }
        tmrs.timePassed = 0;
        $cfs.trigger("_cfs_slide_" + eType, [obj, num]);
        if(opts.synchronise) {
          var s = opts.synchronise, c = [obj, num];
          for(var j = 0, l = s.length;j < l;j++) {
            var d = eType;
            if(!s[j][1]) {
              c[0] = s[j][0].triggerHandler("_cfs_configuration", eType)
            }
            if(!s[j][2]) {
              d = d == "prev" ? "next" : "prev"
            }
            c[1] = num + s[j][3];
            s[j][0].trigger("_cfs_slide_" + d, c)
          }
        }
        return true
      });
      $cfs.bind(cf_e("_cfs_slide_prev", conf, false), function(e, sO, nI) {
        e.stopPropagation();
        var a_itm = $cfs.children();
        if(!opts.circular) {
          if(itms.first == 0) {
            if(opts.infinite) {
              $cfs.trigger(cf_e("next", conf), itms.total - 1)
            }
            return e.stopImmediatePropagation()
          }
        }
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts)
        }
        if(typeof nI != "number") {
          if(opts.items.visibleConf.variable) {
            nI = gn_getVisibleItemsPrev(a_itm, opts, itms.total - 1)
          }else {
            if(opts.items.filter != "*") {
              var xI = typeof sO.items == "number" ? sO.items : gn_getVisibleOrg($cfs, opts);
              nI = gn_getScrollItemsPrevFilter(a_itm, opts, itms.total - 1, xI)
            }else {
              nI = opts.items.visible
            }
          }
          nI = cf_getAdjust(nI, opts, sO.items, $tt0)
        }
        if(!opts.circular) {
          if(itms.total - nI < itms.first) {
            nI = itms.total - itms.first
          }
        }
        opts.items.visibleConf.old = opts.items.visible;
        if(opts.items.visibleConf.variable) {
          var vI = gn_getVisibleItemsNext(a_itm, opts, itms.total - nI);
          if(opts.items.visible + nI <= vI && nI < itms.total) {
            nI++;
            vI = gn_getVisibleItemsNext(a_itm, opts, itms.total - nI)
          }
          opts.items.visible = cf_getItemsAdjust(vI, opts, opts.items.visibleConf.adjust, $tt0)
        }else {
          if(opts.items.filter != "*") {
            var vI = gn_getVisibleItemsNextFilter(a_itm, opts, itms.total - nI);
            opts.items.visible = cf_getItemsAdjust(vI, opts, opts.items.visibleConf.adjust, $tt0)
          }
        }
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts, true)
        }
        if(nI == 0) {
          e.stopImmediatePropagation();
          return debug(conf, "0 items to scroll: Not scrolling.")
        }
        debug(conf, "Scrolling " + nI + " items backward.");
        itms.first += nI;
        while(itms.first >= itms.total) {
          itms.first -= itms.total
        }
        if(!opts.circular) {
          if(itms.first == 0 && sO.onEnd) {
            sO.onEnd.call($tt0)
          }
          if(!opts.infinite) {
            nv_enableNavi(opts, itms.first, conf)
          }
        }
        $cfs.children().slice(itms.total - nI, itms.total).prependTo($cfs);
        if(itms.total < opts.items.visible + nI) {
          $cfs.children().slice(0, opts.items.visible + nI - itms.total).clone(true).appendTo($cfs)
        }
        var a_itm = $cfs.children(), c_old = gi_getOldItemsPrev(a_itm, opts, nI), c_new = gi_getNewItemsPrev(a_itm, opts), l_cur = a_itm.eq(nI - 1), l_old = c_old.last(), l_new = c_new.last();
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts)
        }
        if(opts.align) {
          var p = cf_getAlignPadding(c_new, opts), pL = p[0], pR = p[1]
        }else {
          var pL = 0, pR = 0
        }
        var oL = pL < 0 ? opts.padding[opts.d[3]] : 0;
        if(sO.fx == "directscroll" && opts.items.visible < nI) {
          var hiddenitems = a_itm.slice(opts.items.visibleConf.old, nI), orgW = opts.items[opts.d["width"]];
          hiddenitems.each(function() {
            var hi = $(this);
            hi.data("isHidden", hi.is(":hidden")).hide()
          });
          opts.items[opts.d["width"]] = "variable"
        }else {
          var hiddenitems = false
        }
        var i_siz = ms_getTotalSize(a_itm.slice(0, nI), opts, "width"), w_siz = cf_mapWrapperSizes(ms_getSizes(c_new, opts, true), opts, !opts.usePadding);
        if(hiddenitems) {
          opts.items[opts.d["width"]] = orgW
        }
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts, true);
          if(pR >= 0) {
            sz_resetMargin(l_old, opts, opts.padding[opts.d[1]])
          }
          sz_resetMargin(l_cur, opts, opts.padding[opts.d[3]])
        }
        if(opts.align) {
          opts.padding[opts.d[1]] = pR;
          opts.padding[opts.d[3]] = pL
        }
        var a_cfs = {}, a_dur = sO.duration;
        if(sO.fx == "none") {
          a_dur = 0
        }else {
          if(a_dur == "auto") {
            a_dur = opts.scroll.duration / opts.scroll.items * nI
          }else {
            if(a_dur <= 0) {
              a_dur = 0
            }else {
              if(a_dur < 10) {
                a_dur = i_siz / a_dur
              }
            }
          }
        }
        scrl = sc_setScroll(a_dur, sO.easing);
        if(opts[opts.d["width"]] == "variable" || opts[opts.d["height"]] == "variable") {
          scrl.anims.push([$wrp, w_siz])
        }
        if(opts.usePadding) {
          var new_m = opts.padding[opts.d[3]];
          if(l_new.not(l_cur).length) {
            var a_cur = {};
            a_cur[opts.d["marginRight"]] = l_cur.data("cfs_origCssMargin");
            if(pL < 0) {
              l_cur.css(a_cur)
            }else {
              scrl.anims.push([l_cur, a_cur])
            }
          }
          if(l_new.not(l_old).length) {
            var a_old = {};
            a_old[opts.d["marginRight"]] = l_old.data("cfs_origCssMargin");
            scrl.anims.push([l_old, a_old])
          }
          if(pR >= 0) {
            var a_new = {};
            a_new[opts.d["marginRight"]] = l_new.data("cfs_origCssMargin") + opts.padding[opts.d[1]];
            scrl.anims.push([l_new, a_new])
          }
        }else {
          var new_m = 0
        }
        a_cfs[opts.d["left"]] = new_m;
        var args = [c_old, c_new, w_siz, a_dur];
        if(sO.onBefore) {
          sO.onBefore.apply($tt0, args)
        }
        clbk.onBefore = sc_callCallbacks(clbk.onBefore, $tt0, args);
        switch(sO.fx) {
          case "fade":
          ;
          case "crossfade":
          ;
          case "cover":
          ;
          case "uncover":
            scrl.pre = sc_setScroll(scrl.duration, scrl.easing);
            scrl.post = sc_setScroll(scrl.duration, scrl.easing);
            scrl.duration = 0;
            break
        }
        switch(sO.fx) {
          case "crossfade":
          ;
          case "cover":
          ;
          case "uncover":
            var $cf2 = $cfs.clone().appendTo($wrp);
            break
        }
        switch(sO.fx) {
          case "uncover":
            $cf2.children().slice(0, nI).remove();
          case "crossfade":
          ;
          case "cover":
            $cf2.children().slice(opts.items.visible).remove();
            break
        }
        switch(sO.fx) {
          case "fade":
            scrl.pre.anims.push([$cfs, {"opacity":0}]);
            break;
          case "crossfade":
            $cf2.css({"opacity":0});
            scrl.pre.anims.push([$cfs, {"width":"+=0"}, function() {
              $cf2.remove()
            }]);
            scrl.post.anims.push([$cf2, {"opacity":1}]);
            break;
          case "cover":
            scrl = fx_cover(scrl, $cfs, $cf2, opts, true);
            break;
          case "uncover":
            scrl = fx_uncover(scrl, $cfs, $cf2, opts, true, nI);
            break
        }
        var a_complete = function() {
          var overFill = opts.items.visible + nI - itms.total;
          if(overFill > 0) {
            $cfs.children().slice(itms.total).remove();
            c_old = $cfs.children().slice(itms.total - (nI - overFill)).get().concat($cfs.children().slice(0, overFill).get())
          }
          if(hiddenitems) {
            hiddenitems.each(function() {
              var hi = $(this);
              if(!hi.data("isHidden")) {
                hi.show()
              }
            })
          }
          if(opts.usePadding) {
            var l_itm = $cfs.children().eq(opts.items.visible + nI - 1);
            l_itm.css(opts.d["marginRight"], l_itm.data("cfs_origCssMargin"))
          }
          scrl.anims = [];
          if(scrl.pre) {
            scrl.pre = sc_setScroll(scrl.orgDuration, scrl.easing)
          }
          var fn = function() {
            switch(sO.fx) {
              case "fade":
              ;
              case "crossfade":
                $cfs.css("filter", "");
                break
            }
            scrl.post = sc_setScroll(0, null);
            crsl.isScrolling = false;
            var args = [c_old, c_new, w_siz];
            if(sO.onAfter) {
              sO.onAfter.apply($tt0, args)
            }
            clbk.onAfter = sc_callCallbacks(clbk.onAfter, $tt0, args);
            if(queu.length) {
              $cfs.trigger(cf_e(queu[0][0], conf), queu[0][1]);
              queu.shift()
            }
            if(!crsl.isPaused) {
              $cfs.trigger(cf_e("play", conf))
            }
          };
          switch(sO.fx) {
            case "fade":
              scrl.pre.anims.push([$cfs, {"opacity":1}, fn]);
              sc_startScroll(scrl.pre);
              break;
            case "uncover":
              scrl.pre.anims.push([$cfs, {"width":"+=0"}, fn]);
              sc_startScroll(scrl.pre);
              break;
            default:
              fn();
              break
          }
        };
        scrl.anims.push([$cfs, a_cfs, a_complete]);
        crsl.isScrolling = true;
        $cfs.css(opts.d["left"], -(i_siz - oL));
        tmrs = sc_clearTimers(tmrs);
        sc_startScroll(scrl);
        cf_setCookie(opts.cookie, $cfs.triggerHandler(cf_e("currentPosition", conf)));
        $cfs.trigger(cf_e("updatePageStatus", conf), [false, w_siz]);
        return true
      });
      $cfs.bind(cf_e("_cfs_slide_next", conf, false), function(e, sO, nI) {
        e.stopPropagation();
        var a_itm = $cfs.children();
        if(!opts.circular) {
          if(itms.first == opts.items.visible) {
            if(opts.infinite) {
              $cfs.trigger(cf_e("prev", conf), itms.total - 1)
            }
            return e.stopImmediatePropagation()
          }
        }
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts)
        }
        if(typeof nI != "number") {
          if(opts.items.filter != "*") {
            var xI = typeof sO.items == "number" ? sO.items : gn_getVisibleOrg($cfs, opts);
            nI = gn_getScrollItemsNextFilter(a_itm, opts, 0, xI)
          }else {
            nI = opts.items.visible
          }
          nI = cf_getAdjust(nI, opts, sO.items, $tt0)
        }
        var lastItemNr = itms.first == 0 ? itms.total : itms.first;
        if(!opts.circular) {
          if(opts.items.visibleConf.variable) {
            var vI = gn_getVisibleItemsNext(a_itm, opts, nI), xI = gn_getVisibleItemsPrev(a_itm, opts, lastItemNr - 1)
          }else {
            var vI = opts.items.visible, xI = opts.items.visible
          }
          if(nI + vI > lastItemNr) {
            nI = lastItemNr - xI
          }
        }
        opts.items.visibleConf.old = opts.items.visible;
        if(opts.items.visibleConf.variable) {
          var vI = gn_getVisibleItemsNextTestCircular(a_itm, opts, nI, lastItemNr);
          while(opts.items.visible - nI >= vI && nI < itms.total) {
            nI++;
            vI = gn_getVisibleItemsNextTestCircular(a_itm, opts, nI, lastItemNr)
          }
          opts.items.visible = cf_getItemsAdjust(vI, opts, opts.items.visibleConf.adjust, $tt0)
        }else {
          if(opts.items.filter != "*") {
            var vI = gn_getVisibleItemsNextFilter(a_itm, opts, nI);
            opts.items.visible = cf_getItemsAdjust(vI, opts, opts.items.visibleConf.adjust, $tt0)
          }
        }
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts, true)
        }
        if(nI == 0) {
          e.stopImmediatePropagation();
          return debug(conf, "0 items to scroll: Not scrolling.")
        }
        debug(conf, "Scrolling " + nI + " items forward.");
        itms.first -= nI;
        while(itms.first < 0) {
          itms.first += itms.total
        }
        if(!opts.circular) {
          if(itms.first == opts.items.visible && sO.onEnd) {
            sO.onEnd.call($tt0)
          }
          if(!opts.infinite) {
            nv_enableNavi(opts, itms.first, conf)
          }
        }
        if(itms.total < opts.items.visible + nI) {
          $cfs.children().slice(0, opts.items.visible + nI - itms.total).clone(true).appendTo($cfs)
        }
        var a_itm = $cfs.children(), c_old = gi_getOldItemsNext(a_itm, opts), c_new = gi_getNewItemsNext(a_itm, opts, nI), l_cur = a_itm.eq(nI - 1), l_old = c_old.last(), l_new = c_new.last();
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts)
        }
        if(opts.align) {
          var p = cf_getAlignPadding(c_new, opts), pL = p[0], pR = p[1]
        }else {
          var pL = 0, pR = 0
        }
        if(sO.fx == "directscroll" && opts.items.visibleConf.old < nI) {
          var hiddenitems = a_itm.slice(opts.items.visibleConf.old, nI), orgW = opts.items[opts.d["width"]];
          hiddenitems.each(function() {
            var hi = $(this);
            hi.data("isHidden", hi.is(":hidden")).hide()
          });
          opts.items[opts.d["width"]] = "variable"
        }else {
          var hiddenitems = false
        }
        var i_siz = ms_getTotalSize(a_itm.slice(0, nI), opts, "width"), w_siz = cf_mapWrapperSizes(ms_getSizes(c_new, opts, true), opts, !opts.usePadding);
        if(hiddenitems) {
          opts.items[opts.d["width"]] = orgW
        }
        if(opts.align) {
          if(opts.padding[opts.d[1]] < 0) {
            opts.padding[opts.d[1]] = 0
          }
        }
        if(opts.usePadding) {
          sz_resetMargin(a_itm, opts, true);
          sz_resetMargin(l_old, opts, opts.padding[opts.d[1]])
        }
        if(opts.align) {
          opts.padding[opts.d[1]] = pR;
          opts.padding[opts.d[3]] = pL
        }
        var a_cfs = {}, a_dur = sO.duration;
        if(sO.fx == "none") {
          a_dur = 0
        }else {
          if(a_dur == "auto") {
            a_dur = opts.scroll.duration / opts.scroll.items * nI
          }else {
            if(a_dur <= 0) {
              a_dur = 0
            }else {
              if(a_dur < 10) {
                a_dur = i_siz / a_dur
              }
            }
          }
        }
        scrl = sc_setScroll(a_dur, sO.easing);
        if(opts[opts.d["width"]] == "variable" || opts[opts.d["height"]] == "variable") {
          scrl.anims.push([$wrp, w_siz])
        }
        if(opts.usePadding) {
          var l_new_m = l_new.data("cfs_origCssMargin");
          if(pR >= 0) {
            l_new_m += opts.padding[opts.d[1]]
          }
          l_new.css(opts.d["marginRight"], l_new_m);
          if(l_cur.not(l_old).length) {
            var a_old = {};
            a_old[opts.d["marginRight"]] = l_old.data("cfs_origCssMargin");
            scrl.anims.push([l_old, a_old])
          }
          var c_new_m = l_cur.data("cfs_origCssMargin");
          if(pL >= 0) {
            c_new_m += opts.padding[opts.d[3]]
          }
          var a_cur = {};
          a_cur[opts.d["marginRight"]] = c_new_m;
          scrl.anims.push([l_cur, a_cur])
        }
        a_cfs[opts.d["left"]] = -i_siz;
        if(pL < 0) {
          a_cfs[opts.d["left"]] += pL
        }
        var args = [c_old, c_new, w_siz, a_dur];
        if(sO.onBefore) {
          sO.onBefore.apply($tt0, args)
        }
        clbk.onBefore = sc_callCallbacks(clbk.onBefore, $tt0, args);
        switch(sO.fx) {
          case "fade":
          ;
          case "crossfade":
          ;
          case "cover":
          ;
          case "uncover":
            scrl.pre = sc_setScroll(scrl.duration, scrl.easing);
            scrl.post = sc_setScroll(scrl.duration, scrl.easing);
            scrl.duration = 0;
            break
        }
        switch(sO.fx) {
          case "crossfade":
          ;
          case "cover":
          ;
          case "uncover":
            var $cf2 = $cfs.clone().appendTo($wrp);
            break
        }
        switch(sO.fx) {
          case "uncover":
            $cf2.children().slice(opts.items.visibleConf.old).remove();
            break;
          case "crossfade":
          ;
          case "cover":
            $cf2.children().slice(0, nI).remove();
            $cf2.children().slice(opts.items.visible).remove();
            break
        }
        switch(sO.fx) {
          case "fade":
            scrl.pre.anims.push([$cfs, {"opacity":0}]);
            break;
          case "crossfade":
            $cf2.css({"opacity":0});
            scrl.pre.anims.push([$cfs, {"width":"+=0"}, function() {
              $cf2.remove()
            }]);
            scrl.post.anims.push([$cf2, {"opacity":1}]);
            break;
          case "cover":
            scrl = fx_cover(scrl, $cfs, $cf2, opts, false);
            break;
          case "uncover":
            scrl = fx_uncover(scrl, $cfs, $cf2, opts, false, nI);
            break
        }
        var a_complete = function() {
          var overFill = opts.items.visible + nI - itms.total, new_m = opts.usePadding ? opts.padding[opts.d[3]] : 0;
          $cfs.css(opts.d["left"], new_m);
          if(overFill > 0) {
            $cfs.children().slice(itms.total).remove()
          }
          var l_itm = $cfs.children().slice(0, nI).appendTo($cfs).last();
          if(overFill > 0) {
            c_new = gi_getCurrentItems(a_itm, opts)
          }
          if(hiddenitems) {
            hiddenitems.each(function() {
              var hi = $(this);
              if(!hi.data("isHidden")) {
                hi.show()
              }
            })
          }
          if(opts.usePadding) {
            if(itms.total < opts.items.visible + nI) {
              var l_cur = $cfs.children().eq(opts.items.visible - 1);
              l_cur.css(opts.d["marginRight"], l_cur.data("cfs_origCssMargin") + opts.padding[opts.d[3]])
            }
            l_itm.css(opts.d["marginRight"], l_itm.data("cfs_origCssMargin"))
          }
          scrl.anims = [];
          if(scrl.pre) {
            scrl.pre = sc_setScroll(scrl.orgDuration, scrl.easing)
          }
          var fn = function() {
            switch(sO.fx) {
              case "fade":
              ;
              case "crossfade":
                $cfs.css("filter", "");
                break
            }
            scrl.post = sc_setScroll(0, null);
            crsl.isScrolling = false;
            var args = [c_old, c_new, w_siz];
            if(sO.onAfter) {
              sO.onAfter.apply($tt0, args)
            }
            clbk.onAfter = sc_callCallbacks(clbk.onAfter, $tt0, args);
            if(queu.length) {
              $cfs.trigger(cf_e(queu[0][0], conf), queu[0][1]);
              queu.shift()
            }
            if(!crsl.isPaused) {
              $cfs.trigger(cf_e("play", conf))
            }
          };
          switch(sO.fx) {
            case "fade":
              scrl.pre.anims.push([$cfs, {"opacity":1}, fn]);
              sc_startScroll(scrl.pre);
              break;
            case "uncover":
              scrl.pre.anims.push([$cfs, {"width":"+=0"}, fn]);
              sc_startScroll(scrl.pre);
              break;
            default:
              fn();
              break
          }
        };
        scrl.anims.push([$cfs, a_cfs, a_complete]);
        crsl.isScrolling = true;
        tmrs = sc_clearTimers(tmrs);
        sc_startScroll(scrl);
        cf_setCookie(opts.cookie, $cfs.triggerHandler(cf_e("currentPosition", conf)));
        $cfs.trigger(cf_e("updatePageStatus", conf), [false, w_siz]);
        return true
      });
      $cfs.bind(cf_e("slideTo", conf), function(e, num, dev, org, obj, dir, clb) {
        e.stopPropagation();
        var v = [num, dev, org, obj, dir, clb], t = ["string/number/object", "number", "boolean", "object", "string", "function"], a = cf_sortParams(v, t);
        var obj = a[3], dir = a[4], clb = a[5];
        num = gn_getItemIndex(a[0], a[1], a[2], itms, $cfs);
        if(num == 0) {
          return
        }
        if(typeof obj != "object") {
          obj = false
        }
        if(crsl.isScrolling) {
          if(typeof obj != "object" || obj.duration > 0) {
            return false
          }
        }
        if(dir != "prev" && dir != "next") {
          if(opts.circular) {
            if(num <= itms.total / 2) {
              dir = "next"
            }else {
              dir = "prev"
            }
          }else {
            if(itms.first == 0 || itms.first > num) {
              dir = "next"
            }else {
              dir = "prev"
            }
          }
        }
        if(dir == "prev") {
          num = itms.total - num
        }
        $cfs.trigger(cf_e(dir, conf), [obj, num, clb]);
        return true
      });
      $cfs.bind(cf_e("prevPage", conf), function(e, obj, clb) {
        e.stopPropagation();
        var cur = $cfs.triggerHandler(cf_e("currentPage", conf));
        return $cfs.triggerHandler(cf_e("slideToPage", conf), [cur - 1, obj, "prev", clb])
      });
      $cfs.bind(cf_e("nextPage", conf), function(e, obj, clb) {
        e.stopPropagation();
        var cur = $cfs.triggerHandler(cf_e("currentPage", conf));
        return $cfs.triggerHandler(cf_e("slideToPage", conf), [cur + 1, obj, "next", clb])
      });
      $cfs.bind(cf_e("slideToPage", conf), function(e, pag, obj, dir, clb) {
        e.stopPropagation();
        if(typeof pag != "number") {
          pag = $cfs.triggerHandler(cf_e("currentPage", conf))
        }
        var ipp = opts.pagination.items || opts.items.visible, max = Math.floor(itms.total / ipp) - 1;
        if(pag < 0) {
          pag = max
        }
        if(pag > max) {
          pag = 0
        }
        return $cfs.triggerHandler(cf_e("slideTo", conf), [pag * ipp, 0, true, obj, dir, clb])
      });
      $cfs.bind(cf_e("jumpToStart", conf), function(e, s) {
        e.stopPropagation();
        if(s) {
          s = gn_getItemIndex(s, 0, true, itms, $cfs)
        }else {
          s = 0
        }
        s += itms.first;
        if(s != 0) {
          while(s > itms.total) {
            s -= itms.total
          }
          $cfs.prepend($cfs.children().slice(s, itms.total))
        }
        return true
      });
      $cfs.bind(cf_e("synchronise", conf), function(e, s) {
        e.stopPropagation();
        if(s) {
          s = cf_getSynchArr(s)
        }else {
          if(opts.synchronise) {
            s = opts.synchronise
          }else {
            return debug(conf, "No carousel to synchronise.")
          }
        }
        var n = $cfs.triggerHandler(cf_e("currentPosition", conf)), x = true;
        for(var j = 0, l = s.length;j < l;j++) {
          if(!s[j][0].triggerHandler(cf_e("slideTo", conf), [n, s[j][3], true])) {
            x = false
          }
        }
        return x
      });
      $cfs.bind(cf_e("queue", conf), function(e, dir, opt) {
        e.stopPropagation();
        if(typeof dir == "function") {
          dir.call($tt0, queu)
        }else {
          if(is_array(dir)) {
            queu = dir
          }else {
            if(typeof dir != "undefined") {
              queu.push([dir, opt])
            }
          }
        }
        return queu
      });
      $cfs.bind(cf_e("insertItem", conf), function(e, itm, num, org, dev) {
        e.stopPropagation();
        var v = [itm, num, org, dev], t = ["string/object", "string/number/object", "boolean", "number"], a = cf_sortParams(v, t);
        var itm = a[0], num = a[1], org = a[2], dev = a[3];
        if(typeof itm == "object" && typeof itm.jquery == "undefined") {
          itm = $(itm)
        }
        if(typeof itm == "string") {
          itm = $(itm)
        }
        if(typeof itm != "object" || typeof itm.jquery == "undefined" || itm.length == 0) {
          return debug(conf, "Not a valid object.")
        }
        if(typeof num == "undefined") {
          num = "end"
        }
        if(opts.usePadding) {
          itm.each(function() {
            var m = parseInt($(this).css(opts.d["marginRight"]));
            if(isNaN(m)) {
              m = 0
            }
            $(this).data("cfs_origCssMargin", m)
          })
        }
        var orgNum = num, before = "before";
        if(num == "end") {
          if(org) {
            if(itms.first == 0) {
              num = itms.total - 1;
              before = "after"
            }else {
              num = itms.first;
              itms.first += itm.length
            }
            if(num < 0) {
              num = 0
            }
          }else {
            num = itms.total - 1;
            before = "after"
          }
        }else {
          num = gn_getItemIndex(num, dev, org, itms, $cfs)
        }
        if(orgNum != "end" && !org) {
          if(num < itms.first) {
            itms.first += itm.length
          }
        }
        if(itms.first >= itms.total) {
          itms.first -= itms.total
        }
        var $cit = $cfs.children().eq(num);
        if($cit.length) {
          $cit[before](itm)
        }else {
          $cfs.append(itm)
        }
        itms.total = $cfs.children().length;
        var sz = $cfs.triggerHandler("updateSizes");
        nv_showNavi(opts, itms.total, conf);
        nv_enableNavi(opts, itms.first, conf);
        $cfs.trigger(cf_e("linkAnchors", conf));
        $cfs.trigger(cf_e("updatePageStatus", conf), [true, sz]);
        return true
      });
      $cfs.bind(cf_e("removeItem", conf), function(e, num, org, dev) {
        e.stopPropagation();
        var v = [num, org, dev], t = ["string/number/object", "boolean", "number"], a = cf_sortParams(v, t);
        var num = a[0], org = a[1], dev = a[2];
        if(typeof num == "undefined" || num == "end") {
          $cfs.children().last().remove()
        }else {
          num = gn_getItemIndex(num, dev, org, itms, $cfs);
          var $cit = $cfs.children().eq(num);
          if($cit.length) {
            if(num < itms.first) {
              itms.first -= $cit.length
            }
            $cit.remove()
          }
        }
        itms.total = $cfs.children().length;
        var sz = $cfs.triggerHandler("updateSizes");
        nv_showNavi(opts, itms.total, conf);
        nv_enableNavi(opts, itms.first, conf);
        $cfs.trigger(cf_e("updatePageStatus", conf), [true, sz]);
        return true
      });
      $cfs.bind(cf_e("onBefore", conf) + " " + cf_e("onAfter", conf), function(e, fn) {
        e.stopPropagation();
        var eType = e.type.substr(conf.events.prefix.length);
        if(is_array(fn)) {
          clbk[eType] = fn
        }
        if(typeof fn == "function") {
          clbk[eType].push(fn)
        }
        return clbk[eType]
      });
      $cfs.bind(cf_e("_cfs_currentPosition", conf, false), function(e, fn) {
        e.stopPropagation();
        return $cfs.triggerHandler(cf_e("currentPosition", conf), fn)
      });
      $cfs.bind(cf_e("currentPosition", conf), function(e, fn) {
        e.stopPropagation();
        if(itms.first == 0) {
          var val = 0
        }else {
          var val = itms.total - itms.first
        }
        if(typeof fn == "function") {
          fn.call($tt0, val)
        }
        return val
      });
      $cfs.bind(cf_e("currentPage", conf), function(e, fn) {
        e.stopPropagation();
        var ipp = opts.pagination.items || opts.items.visible;
        var max = Math.ceil(itms.total / ipp - 1);
        if(itms.first == 0) {
          var nr = 0
        }else {
          if(itms.first < itms.total % ipp) {
            var nr = 0
          }else {
            if(itms.first == ipp && !opts.circular) {
              var nr = max
            }else {
              var nr = Math.round((itms.total - itms.first) / ipp)
            }
          }
        }
        if(nr < 0) {
          nr = 0
        }
        if(nr > max) {
          nr = max
        }
        if(typeof fn == "function") {
          fn.call($tt0, nr)
        }
        return nr
      });
      $cfs.bind(cf_e("currentVisible", conf), function(e, fn) {
        e.stopPropagation();
        $i = gi_getCurrentItems($cfs.children(), opts);
        if(typeof fn == "function") {
          fn.call($tt0, $i)
        }
        return $i
      });
      $cfs.bind(cf_e("slice", conf), function(e, f, l, fn) {
        e.stopPropagation();
        var v = [f, l, fn], t = ["number", "number", "function"], a = cf_sortParams(v, t);
        f = typeof a[0] == "number" ? a[0] : 0, l = typeof a[1] == "number" ? a[1] : itms.total, fn = a[2];
        f += itms.first;
        l += itms.first;
        while(f > itms.total) {
          f -= itms.total
        }
        while(l > itms.total) {
          l -= itms.total
        }
        while(f < 0) {
          f += itms.total
        }
        while(l < 0) {
          l += itms.total
        }
        var $iA = $cfs.children();
        if(l > f) {
          var $i = $iA.slice(f, l)
        }else {
          var $i = $iA.slice(f, itms.total).get().concat($iA.slice(0, l).get())
        }
        if(typeof fn == "function") {
          fn.call($tt0, $i)
        }
        return $i
      });
      $cfs.bind(cf_e("isPaused", conf) + " " + cf_e("isStopped", conf) + " " + cf_e("isScrolling", conf), function(e, fn) {
        e.stopPropagation();
        var eType = e.type.substr(conf.events.prefix.length);
        if(typeof fn == "function") {
          fn.call($tt0, crsl[eType])
        }
        return crsl[eType]
      });
      $cfs.bind(cf_e("_cfs_configuration", conf, false), function(e, a, b, c) {
        e.stopPropagation();
        return $cfs.triggerHandler(cf_e("configuration", conf), [a, b, c])
      });
      $cfs.bind(cf_e("configuration", conf), function(e, a, b, c) {
        e.stopPropagation();
        var reInit = false;
        if(typeof a == "function") {
          a.call($tt0, opts)
        }else {
          if(typeof a == "object") {
            opts_orig = $.extend(true, {}, opts_orig, a);
            if(b !== false) {
              reInit = true
            }else {
              opts = $.extend(true, {}, opts, a)
            }
          }else {
            if(typeof a != "undefined") {
              if(typeof b == "function") {
                var val = eval("opts." + a);
                if(typeof val == "undefined") {
                  val = ""
                }
                b.call($tt0, val)
              }else {
                if(typeof b != "undefined") {
                  if(typeof c !== "boolean") {
                    c = true
                  }
                  eval("opts_orig." + a + " = b");
                  if(c !== false) {
                    reInit = true
                  }else {
                    eval("opts." + a + " = b")
                  }
                }else {
                  return eval("opts." + a)
                }
              }
            }
          }
        }
        if(reInit) {
          sz_resetMargin($cfs.children(), opts);
          $cfs._cfs_init(opts_orig);
          $cfs._cfs_bind_buttons();
          var siz = sz_setSizes($cfs, opts, false);
          $cfs.trigger(cf_e("updatePageStatus", conf), [true, siz])
        }
        return opts
      });
      $cfs.bind(cf_e("linkAnchors", conf), function(e, $con, sel) {
        e.stopPropagation();
        if(typeof $con == "undefined" || $con.length == 0) {
          $con = $("body")
        }else {
          if(typeof $con == "string") {
            $con = $($con)
          }
        }
        if(typeof $con != "object") {
          return debug(conf, "Not a valid object.")
        }
        if(typeof sel != "string" || sel.length == 0) {
          sel = "a.caroufredsel"
        }
        $con.find(sel).each(function() {
          var h = this.hash || "";
          if(h.length > 0 && $cfs.children().index($(h)) != -1) {
            $(this).unbind("click").click(function(e) {
              e.preventDefault();
              $cfs.trigger(cf_e("slideTo", conf), h)
            })
          }
        });
        return true
      });
      $cfs.bind(cf_e("updatePageStatus", conf), function(e, build, sizes) {
        e.stopPropagation();
        if(!opts.pagination.container) {
          return
        }
        if(build) {
          var ipp = opts.pagination.items || opts.items.visible, l = Math.ceil(itms.total / ipp);
          if(opts.pagination.anchorBuilder) {
            opts.pagination.container.children().remove();
            opts.pagination.container.each(function() {
              for(var a = 0;a < l;a++) {
                var i = $cfs.children().eq(gn_getItemIndex(a * ipp, 0, true, itms, $cfs));
                $(this).append(opts.pagination.anchorBuilder(a + 1, i))
              }
            })
          }
          opts.pagination.container.each(function() {
            $(this).children().unbind(opts.pagination.event).each(function(a) {
              $(this).bind(opts.pagination.event, function(e) {
                e.preventDefault();
                $cfs.trigger(cf_e("slideTo", conf), [a * ipp, 0, true, opts.pagination])
              })
            })
          })
        }
        opts.pagination.container.each(function() {
          $(this).children().removeClass(cf_c("selected", conf)).eq($cfs.triggerHandler(cf_e("currentPage", conf))).addClass(cf_c("selected", conf))
        });
        return true
      });
      $cfs.bind(cf_e("updateSizes", conf), function(e) {
        var a_itm = $cfs.children(), vI = opts.items.visible;
        if(opts.items.visibleConf.variable) {
          vI = gn_getVisibleItemsNext(a_itm, opts, 0)
        }else {
          if(opts.items.filter != "*") {
            vI = gn_getVisibleItemsNextFilter(a_itm, opts, 0)
          }
        }
        if(!opts.circular && itms.first != 0 && vI > itms.first) {
          if(opts.items.visibleConf.variable) {
            var nI = gn_getVisibleItemsPrev(a_itm, opts, itms.first) - itms.first
          }else {
            if(opts.items.filter != "*") {
              var nI = gn_getVisibleItemsPrevFilter(a_itm, opts, itms.first) - itms.first
            }else {
              nI = opts.items.visible - itms.first
            }
          }
          debug(conf, "Preventing non-circular: sliding " + nI + " items backward.");
          $cfs.trigger("prev", nI)
        }
        opts.items.visible = cf_getItemsAdjust(vI, opts, opts.items.visibleConf.adjust, $tt0);
        return sz_setSizes($cfs, opts)
      });
      $cfs.bind(cf_e("_cfs_destroy", conf, false), function(e, orgOrder) {
        e.stopPropagation();
        $cfs.trigger(cf_e("destroy", conf), orgOrder);
        return true
      });
      $cfs.bind(cf_e("destroy", conf), function(e, orgOrder) {
        e.stopPropagation();
        tmrs = sc_clearTimers(tmrs);
        $cfs.data("cfs_isCarousel", false);
        $cfs.trigger(cf_e("finish", conf));
        if(orgOrder) {
          $cfs.trigger(cf_e("jumpToStart", conf))
        }
        if(opts.usePadding) {
          sz_resetMargin($cfs.children(), opts)
        }
        $cfs.css($cfs.data("cfs_origCss"));
        $cfs._cfs_unbind_events();
        $cfs._cfs_unbind_buttons();
        $wrp.replaceWith($cfs);
        return true
      })
    };
    $cfs._cfs_unbind_events = function() {
      $cfs.unbind(cf_e("", conf));
      $cfs.unbind(cf_e("", conf, false))
    };
    $cfs._cfs_bind_buttons = function() {
      $cfs._cfs_unbind_buttons();
      nv_showNavi(opts, itms.total, conf);
      nv_enableNavi(opts, itms.first, conf);
      if(opts.auto.pauseOnHover) {
        var pC = bt_pauseOnHoverConfig(opts.auto.pauseOnHover);
        $wrp.bind(cf_e("mouseenter", conf, false), function() {
          $cfs.trigger(cf_e("pause", conf), pC)
        }).bind(cf_e("mouseleave", conf, false), function() {
          $cfs.trigger(cf_e("resume", conf))
        })
      }
      if(opts.auto.button) {
        opts.auto.button.bind(cf_e(opts.auto.event, conf, false), function(e) {
          e.preventDefault();
          var ev = false, pC = null;
          if(crsl.isPaused) {
            ev = "play"
          }else {
            if(opts.auto.pauseOnEvent) {
              ev = "pause";
              pC = bt_pauseOnHoverConfig(opts.auto.pauseOnEvent)
            }
          }
          if(ev) {
            $cfs.trigger(cf_e(ev, conf), pC)
          }
        })
      }
      if(opts.prev.button) {
        opts.prev.button.bind(cf_e(opts.prev.event, conf, false), function(e) {
          e.preventDefault();
          $cfs.trigger(cf_e("prev", conf))
        });
        if(opts.prev.pauseOnHover) {
          var pC = bt_pauseOnHoverConfig(opts.prev.pauseOnHover);
          opts.prev.button.bind(cf_e("mouseenter", conf, false), function() {
            $cfs.trigger(cf_e("pause", conf), pC)
          }).bind(cf_e("mouseleave", conf, false), function() {
            $cfs.trigger(cf_e("resume", conf))
          })
        }
      }
      if(opts.next.button) {
        opts.next.button.bind(cf_e(opts.next.event, conf, false), function(e) {
          e.preventDefault();
          $cfs.trigger(cf_e("next", conf))
        });
        if(opts.next.pauseOnHover) {
          var pC = bt_pauseOnHoverConfig(opts.next.pauseOnHover);
          opts.next.button.bind(cf_e("mouseenter", conf, false), function() {
            $cfs.trigger(cf_e("pause", conf), pC)
          }).bind(cf_e("mouseleave", conf, false), function() {
            $cfs.trigger(cf_e("resume", conf))
          })
        }
      }
      if($.fn.mousewheel) {
        if(opts.prev.mousewheel) {
          if(!crsl.mousewheelPrev) {
            crsl.mousewheelPrev = true;
            $wrp.mousewheel(function(e, delta) {
              if(delta > 0) {
                e.preventDefault();
                var num = bt_mousesheelNumber(opts.prev.mousewheel);
                $cfs.trigger(cf_e("prev", conf), num)
              }
            })
          }
        }
        if(opts.next.mousewheel) {
          if(!crsl.mousewheelNext) {
            crsl.mousewheelNext = true;
            $wrp.mousewheel(function(e, delta) {
              if(delta < 0) {
                e.preventDefault();
                var num = bt_mousesheelNumber(opts.next.mousewheel);
                $cfs.trigger(cf_e("next", conf), num)
              }
            })
          }
        }
      }
      if($.fn.touchwipe) {
        var wP = opts.prev.wipe ? function() {
          $cfs.trigger(cf_e("prev", conf))
        } : null, wN = opts.next.wipe ? function() {
          $cfs.trigger(cf_e("next", conf))
        } : null;
        if(wN || wN) {
          if(!crsl.touchwipe) {
            crsl.touchwipe = true;
            var twOps = {"min_move_x":30, "min_move_y":30, "preventDefaultEvents":true};
            switch(opts.direction) {
              case "up":
              ;
              case "down":
                twOps.wipeUp = wN;
                twOps.wipeDown = wP;
                break;
              default:
                twOps.wipeLeft = wN;
                twOps.wipeRight = wP
            }
            $wrp.touchwipe(twOps)
          }
        }
      }
      if(opts.pagination.container) {
        if(opts.pagination.pauseOnHover) {
          var pC = bt_pauseOnHoverConfig(opts.pagination.pauseOnHover);
          opts.pagination.container.bind(cf_e("mouseenter", conf, false), function() {
            $cfs.trigger(cf_e("pause", conf), pC)
          }).bind(cf_e("mouseleave", conf, false), function() {
            $cfs.trigger(cf_e("resume", conf))
          })
        }
      }
      if(opts.prev.key || opts.next.key) {
        $(document).bind(cf_e("keyup", conf, false, true, true), function(e) {
          var k = e.keyCode;
          if(k == opts.next.key) {
            e.preventDefault();
            $cfs.trigger(cf_e("next", conf))
          }
          if(k == opts.prev.key) {
            e.preventDefault();
            $cfs.trigger(cf_e("prev", conf))
          }
        })
      }
      if(opts.pagination.keys) {
        $(document).bind(cf_e("keyup", conf, false, true, true), function(e) {
          var k = e.keyCode;
          if(k >= 49 && k < 58) {
            k = (k - 49) * opts.items.visible;
            if(k <= itms.total) {
              e.preventDefault();
              $cfs.trigger(cf_e("slideTo", conf), [k, 0, true, opts.pagination])
            }
          }
        })
      }
      if(opts.auto.play) {
        $cfs.trigger(cf_e("play", conf), opts.auto.delay)
      }
      if(crsl.upDateOnWindowResize) {
        $(window).bind(cf_e("resize", conf, false, true, true), function(e) {
          $cfs.trigger(cf_e("finish", conf));
          if(opts.auto.pauseOnResize && !crsl.isPaused) {
            $cfs.trigger(cf_e("play", conf))
          }
          sz_resetMargin($cfs.children(), opts);
          $cfs._cfs_init(opts_orig);
          var siz = sz_setSizes($cfs, opts, false);
          $cfs.trigger(cf_e("updatePageStatus", conf), [true, siz])
        })
      }
    };
    $cfs._cfs_unbind_buttons = function() {
      var ns1 = cf_e("", conf), ns2 = cf_e("", conf, false);
      ns3 = cf_e("", conf, false, true, true);
      $(document).unbind(ns3);
      $(window).unbind(ns3);
      $wrp.unbind(ns2);
      if(opts.auto.button) {
        opts.auto.button.unbind(ns2)
      }
      if(opts.prev.button) {
        opts.prev.button.unbind(ns2)
      }
      if(opts.next.button) {
        opts.next.button.unbind(ns2)
      }
      if(opts.pagination.container) {
        opts.pagination.container.unbind(ns2);
        if(opts.pagination.anchorBuilder) {
          opts.pagination.container.children().remove()
        }
      }
      nv_showNavi(opts, "hide", conf);
      nv_enableNavi(opts, "removeClass", conf)
    };
    var crsl = {"direction":"next", "isPaused":true, "isScrolling":false, "isStopped":false, "mousewheelNext":false, "mousewheelPrev":false, "touchwipe":false}, itms = {"total":$cfs.children().length, "first":0}, tmrs = {"timer":null, "auto":null, "queue":null, "startTime":getTime(), "timePassed":0}, scrl = {"isStopped":false, "duration":0, "startTime":0, "easing":"", "anims":[]}, clbk = {"onBefore":[], "onAfter":[]}, queu = [], conf = $.extend(true, {}, $.fn.carouFredSel.configs, configs), opts = 
    {}, opts_orig = options, $wrp = $cfs.wrap("<" + conf.wrapper.element + ' class="' + conf.wrapper.classname + '" />').parent();
    conf.selector = $cfs.selector;
    conf.serialNumber = $.fn.carouFredSel.serialNumber++;
    $cfs._cfs_init(opts_orig, true, starting_position);
    $cfs._cfs_build();
    $cfs._cfs_bind_events();
    $cfs._cfs_bind_buttons();
    if(is_array(opts.items.start)) {
      var start_arr = opts.items.start
    }else {
      var start_arr = [];
      if(opts.items.start != 0) {
        start_arr.push(opts.items.start)
      }
    }
    if(opts.cookie) {
      start_arr.unshift(cf_readCookie(opts.cookie))
    }
    if(start_arr.length > 0) {
      for(var a = 0, l = start_arr.length;a < l;a++) {
        var s = start_arr[a];
        if(s == 0) {
          continue
        }
        if(s === true) {
          s = window.location.hash;
          if(s.length < 1) {
            continue
          }
        }else {
          if(s === "random") {
            s = Math.floor(Math.random() * itms.total)
          }
        }
        if($cfs.triggerHandler(cf_e("slideTo", conf), [s, 0, true, {fx:"none"}])) {
          break
        }
      }
    }
    var siz = sz_setSizes($cfs, opts, false), itm = gi_getCurrentItems($cfs.children(), opts);
    if(opts.onCreate) {
      opts.onCreate.call($tt0, itm, siz)
    }
    $cfs.trigger(cf_e("updatePageStatus", conf), [true, siz]);
    $cfs.trigger(cf_e("linkAnchors", conf));
    return $cfs
  };
  $.fn.carouFredSel.serialNumber = 1;
  $.fn.carouFredSel.defaults = {"synchronise":false, "infinite":true, "circular":true, "responsive":false, "direction":"left", "items":{"start":0}, "scroll":{"easing":"swing", "duration":500, "pauseOnHover":false, "mousewheel":false, "wipe":false, "event":"click", "queue":false}};
  $.fn.carouFredSel.configs = {"debug":false, "events":{"prefix":"", "namespace":"cfs"}, "wrapper":{"element":"div", "classname":"caroufredsel_wrapper"}, "classnames":{}};
  $.fn.carouFredSel.pageAnchorBuilder = function(nr, itm) {
    return'<a href="#"><span>' + nr + "</span></a>"
  };
  function sc_setScroll(d, e) {
    return{anims:[], duration:d, orgDuration:d, easing:e, startTime:getTime()}
  }
  function sc_startScroll(s) {
    if(typeof s.pre == "object") {
      sc_startScroll(s.pre)
    }
    for(var a = 0, l = s.anims.length;a < l;a++) {
      var b = s.anims[a];
      if(!b) {
        continue
      }
      if(b[3]) {
        b[0].stop()
      }
      b[0].animate(b[1], {complete:b[2], duration:s.duration, easing:s.easing})
    }
    if(typeof s.post == "object") {
      sc_startScroll(s.post)
    }
  }
  function sc_stopScroll(s, finish) {
    if(typeof finish != "boolean") {
      finish = true
    }
    if(typeof s.pre == "object") {
      sc_stopScroll(s.pre, finish)
    }
    for(var a = 0, l = s.anims.length;a < l;a++) {
      var b = s.anims[a];
      b[0].stop(true);
      if(finish) {
        b[0].css(b[1]);
        if(typeof b[2] == "function") {
          b[2]()
        }
      }
    }
    if(typeof s.post == "object") {
      sc_stopScroll(s.post, finish)
    }
  }
  function sc_clearTimers(t) {
    if(t.auto) {
      clearTimeout(t.auto)
    }
    return t
  }
  function sc_callCallbacks(cbs, t, args) {
    if(cbs.length) {
      for(var a = 0, l = cbs.length;a < l;a++) {
        cbs[a].apply(t, args)
      }
    }
    return[]
  }
  function fx_fade(sO, c, x, d, f) {
    var o = {"duration":d, "easing":sO.easing};
    if(typeof f == "function") {
      o.complete = f
    }
    c.animate({opacity:x}, o)
  }
  function fx_cover(sc, c1, c2, o, prev) {
    var old_w = ms_getSizes(gi_getOldItemsNext(c1.children(), o), o, true)[0], new_w = ms_getSizes(c2.children(), o, true)[0], cur_l = prev ? -new_w : old_w, css_o = {}, ani_o = {};
    css_o[o.d["width"]] = new_w;
    css_o[o.d["left"]] = cur_l;
    ani_o[o.d["left"]] = 0;
    sc.pre.anims.push([c1, {"opacity":1}]);
    sc.post.anims.push([c2, ani_o, function() {
      $(this).remove()
    }]);
    c2.css(css_o);
    return sc
  }
  function fx_uncover(sc, c1, c2, o, prev, n) {
    var new_w = ms_getSizes(gi_getNewItemsNext(c1.children(), o, n), o, true)[0], old_w = ms_getSizes(c2.children(), o, true)[0], cur_l = prev ? -old_w : new_w, css_o = {}, ani_o = {};
    css_o[o.d["width"]] = old_w;
    css_o[o.d["left"]] = 0;
    ani_o[o.d["left"]] = cur_l;
    sc.post.anims.push([c2, ani_o, function() {
      $(this).remove()
    }]);
    c2.css(css_o);
    return sc
  }
  function nv_showNavi(o, t, c) {
    if(t == "show" || t == "hide") {
      var f = t
    }else {
      if(o.items.minimum >= t) {
        debug(c, "Not enough items: hiding navigation (" + t + " items, " + o.items.minimum + " needed).");
        var f = "hide"
      }else {
        var f = "show"
      }
    }
    var s = f == "show" ? "removeClass" : "addClass", h = cf_c("hidden", c);
    if(o.auto.button) {
      o.auto.button[f]()[s](h)
    }
    if(o.prev.button) {
      o.prev.button[f]()[s](h)
    }
    if(o.next.button) {
      o.next.button[f]()[s](h)
    }
    if(o.pagination.container) {
      o.pagination.container[f]()[s](h)
    }
  }
  function nv_enableNavi(o, f, c) {
    if(o.circular || o.infinite) {
      return
    }
    var fx = f == "removeClass" || f == "addClass" ? f : false, di = cf_c("disabled", c);
    if(o.auto.button && fx) {
      o.auto.button[fx](di)
    }
    if(o.prev.button) {
      var fn = fx || f == 0 ? "addClass" : "removeClass";
      o.prev.button[fn](di)
    }
    if(o.next.button) {
      var fn = fx || f == o.items.visible ? "addClass" : "removeClass";
      o.next.button[fn](di)
    }
  }
  function go_getObject($tt, obj) {
    if(typeof obj == "function") {
      obj = obj.call($tt)
    }
    if(typeof obj == "undefined") {
      obj = {}
    }
    return obj
  }
  function go_getNaviObject($tt, obj, type) {
    if(typeof type != "string") {
      type = ""
    }
    obj = go_getObject($tt, obj);
    if(typeof obj == "string") {
      var temp = cf_getKeyCode(obj);
      if(temp == -1) {
        obj = $(obj)
      }else {
        obj = temp
      }
    }
    if(type == "pagination") {
      if(typeof obj == "boolean") {
        obj = {"keys":obj}
      }
      if(typeof obj.jquery != "undefined") {
        obj = {"container":obj}
      }
      if(typeof obj.container == "function") {
        obj.container = obj.container.call($tt)
      }
      if(typeof obj.container == "string") {
        obj.container = $(obj.container)
      }
      if(typeof obj.items != "number") {
        obj.items = false
      }
    }else {
      if(type == "auto") {
        if(typeof obj.jquery != "undefined") {
          obj = {"button":obj}
        }
        if(typeof obj == "boolean") {
          obj = {"play":obj}
        }
        if(typeof obj == "number") {
          obj = {"pauseDuration":obj}
        }
        if(typeof obj.button == "function") {
          obj.button = obj.button.call($tt)
        }
        if(typeof obj.button == "string") {
          obj.button = $(obj.button)
        }
      }else {
        if(typeof obj.jquery != "undefined") {
          obj = {"button":obj}
        }
        if(typeof obj == "number") {
          obj = {"key":obj}
        }
        if(typeof obj.button == "function") {
          obj.button = obj.button.call($tt)
        }
        if(typeof obj.button == "string") {
          obj.button = $(obj.button)
        }
        if(typeof obj.key == "string") {
          obj.key = cf_getKeyCode(obj.key)
        }
      }
    }
    return obj
  }
  function gn_getItemIndex(num, dev, org, items, $cfs) {
    if(typeof num == "string") {
      if(isNaN(num)) {
        num = $(num)
      }else {
        num = parseInt(num)
      }
    }
    if(typeof num == "object") {
      if(typeof num.jquery == "undefined") {
        num = $(num)
      }
      num = $cfs.children().index(num);
      if(num == -1) {
        num = 0
      }
      if(typeof org != "boolean") {
        org = false
      }
    }else {
      if(typeof org != "boolean") {
        org = true
      }
    }
    if(isNaN(num)) {
      num = 0
    }else {
      num = parseInt(num)
    }
    if(isNaN(dev)) {
      dev = 0
    }else {
      dev = parseInt(dev)
    }
    if(org) {
      num += items.first
    }
    num += dev;
    if(items.total > 0) {
      while(num >= items.total) {
        num -= items.total
      }
      while(num < 0) {
        num += items.total
      }
    }
    return num
  }
  function gn_getVisibleItemsPrev(i, o, s) {
    var t = 0, x = 0;
    for(var a = s;a >= 0;a--) {
      var j = i.eq(a);
      t += j.is(":visible") ? j[o.d["outerWidth"]](true) : 0;
      if(t > o.maxDimention) {
        return x
      }
      if(a == 0) {
        a = i.length
      }
      x++
    }
  }
  function gn_getVisibleItemsPrevFilter(i, o, s) {
    return gn_getItemsPrevFilter(i, o.items.filter, o.items.visibleConf.org, s)
  }
  function gn_getScrollItemsPrevFilter(i, o, s, m) {
    return gn_getItemsPrevFilter(i, o.items.filter, m, s)
  }
  function gn_getItemsPrevFilter(i, f, m, s) {
    var t = 0, x = 0;
    for(var a = s, l = i.length - 1;a >= 0;a--) {
      x++;
      if(x == l) {
        return x
      }
      var j = i.eq(a);
      if(j.is(f)) {
        t++;
        if(t == m) {
          return x
        }
      }
      if(a == 0) {
        a = i.length
      }
    }
  }
  function gn_getVisibleOrg($c, o) {
    return o.items.visibleConf.org || $c.children().slice(0, o.items.visible).filter(o.items.filter).length
  }
  function gn_getVisibleItemsNext(i, o, s) {
    var t = 0, x = 0;
    for(var a = s, l = i.length - 1;a <= l;a++) {
      var j = i.eq(a);
      t += j.is(":visible") ? j[o.d["outerWidth"]](true) : 0;
      if(t > o.maxDimention) {
        return x
      }
      x++;
      if(x == l) {
        return x
      }
      if(a == l) {
        a = -1
      }
    }
  }
  function gn_getVisibleItemsNextTestCircular(i, o, s, l) {
    var v = gn_getVisibleItemsNext(i, o, s);
    if(!o.circular) {
      if(s + v > l) {
        v = l - s
      }
    }
    return v
  }
  function gn_getVisibleItemsNextFilter(i, o, s) {
    return gn_getItemsNextFilter(i, o.items.filter, o.items.visibleConf.org, s, o.circular)
  }
  function gn_getScrollItemsNextFilter(i, o, s, m) {
    return gn_getItemsNextFilter(i, o.items.filter, m + 1, s, o.circular) - 1
  }
  function gn_getItemsNextFilter(i, f, m, s, c) {
    var t = 0, x = 0;
    for(var a = s, l = i.length - 1;a <= l;a++) {
      x++;
      if(x == l) {
        return x
      }
      var j = i.eq(a);
      if(j.is(f)) {
        t++;
        if(t == m) {
          return x
        }
      }
      if(a == l) {
        a = -1
      }
    }
  }
  function gi_getCurrentItems(i, o) {
    return i.slice(0, o.items.visible)
  }
  function gi_getOldItemsPrev(i, o, n) {
    return i.slice(n, o.items.visibleConf.old + n)
  }
  function gi_getNewItemsPrev(i, o) {
    return i.slice(0, o.items.visible)
  }
  function gi_getOldItemsNext(i, o) {
    return i.slice(0, o.items.visibleConf.old)
  }
  function gi_getNewItemsNext(i, o, n) {
    return i.slice(n, o.items.visible + n)
  }
  function sz_resetMargin(i, o, m) {
    var x = typeof m == "boolean" ? m : false;
    if(typeof m != "number") {
      m = 0
    }
    i.each(function() {
      var j = $(this);
      var t = parseInt(j.css(o.d["marginRight"]));
      if(isNaN(t)) {
        t = 0
      }
      j.data("cfs_tempCssMargin", t);
      j.css(o.d["marginRight"], x ? j.data("cfs_tempCssMargin") : m + j.data("cfs_origCssMargin"))
    })
  }
  function sz_setSizes($c, o, p) {
    var $w = $c.parent(), $i = $c.children(), $v = gi_getCurrentItems($i, o), sz = cf_mapWrapperSizes(ms_getSizes($v, o, true), o, p);
    $w.css(sz);
    if(o.usePadding) {
      var p = o.padding, r = p[o.d[1]];
      if(o.align) {
        if(r < 0) {
          r = 0
        }
      }
      var $l = $v.last();
      $l.css(o.d["marginRight"], $l.data("cfs_origCssMargin") + r);
      $c.css(o.d["top"], p[o.d[0]]);
      $c.css(o.d["left"], p[o.d[3]])
    }
    $c.css(o.d["width"], sz[o.d["width"]] + ms_getTotalSize($i, o, "width") * 2);
    $c.css(o.d["height"], ms_getLargestSize($i, o, "height"));
    return sz
  }
  function ms_getSizes(i, o, wrapper) {
    var s1 = ms_getTotalSize(i, o, "width", wrapper), s2 = ms_getLargestSize(i, o, "height", wrapper);
    return[s1, s2]
  }
  function ms_getLargestSize(i, o, dim, wrapper) {
    if(typeof wrapper != "boolean") {
      wrapper = false
    }
    if(typeof o[o.d[dim]] == "number" && wrapper) {
      return o[o.d[dim]]
    }
    if(typeof o.items[o.d[dim]] == "number") {
      return o.items[o.d[dim]]
    }
    var di2 = dim.toLowerCase().indexOf("width") > -1 ? "outerWidth" : "outerHeight";
    return ms_getTrueLargestSize(i, o, di2)
  }
  function ms_getTrueLargestSize(i, o, dim) {
    var s = 0;
    for(var a = 0, l = i.length;a < l;a++) {
      var j = i.eq(a);
      var m = j.is(":visible") ? j[o.d[dim]](true) : 0;
      if(s < m) {
        s = m
      }
    }
    return s
  }
  function ms_getTrueInnerSize($el, o, dim) {
    if(!$el.is(":visible")) {
      return 0
    }
    var siz = $el[o.d[dim]](), arr = o.d[dim].toLowerCase().indexOf("width") > -1 ? ["paddingLeft", "paddingRight"] : ["paddingTop", "paddingBottom"];
    for(var a = 0, l = arr.length;a < l;a++) {
      var m = parseInt($el.css(arr[a]));
      siz -= isNaN(m) ? 0 : m
    }
    return siz
  }
  function ms_getTotalSize(i, o, dim, wrapper) {
    if(typeof wrapper != "boolean") {
      wrapper = false
    }
    if(typeof o[o.d[dim]] == "number" && wrapper) {
      return o[o.d[dim]]
    }
    if(typeof o.items[o.d[dim]] == "number") {
      return o.items[o.d[dim]] * i.length
    }
    var d = dim.toLowerCase().indexOf("width") > -1 ? "outerWidth" : "outerHeight", s = 0;
    for(var a = 0, l = i.length;a < l;a++) {
      var j = i.eq(a);
      s += j.is(":visible") ? j[o.d[d]](true) : 0
    }
    return s
  }
  function ms_hasVariableSizes(i, o, dim) {
    var s = false, v = false;
    for(var a = 0, l = i.length;a < l;a++) {
      var j = i.eq(a);
      var c = j.is(":visible") ? j[o.d[dim]](true) : 0;
      if(s === false) {
        s = c
      }else {
        if(s != c) {
          v = true
        }
      }
      if(s == 0) {
        v = true
      }
    }
    return v
  }
  function ms_getPaddingBorderMargin(i, o, d) {
    return i[o.d["outer" + d]](true) - ms_getTrueInnerSize(i, o, "inner" + d)
  }
  function ms_isPercentage(x) {
    return typeof x == "string" && x.substr(-1) == "%"
  }
  function ms_getPercentage(s, o) {
    if(ms_isPercentage(o)) {
      o = o.substring(0, o.length - 1);
      if(isNaN(o)) {
        return s
      }
      s *= o / 100
    }
    return s
  }
  function cf_e(n, c, pf, ns, rd) {
    if(typeof pf != "boolean") {
      pf = true
    }
    if(typeof ns != "boolean") {
      ns = true
    }
    if(typeof rd != "boolean") {
      rd = false
    }
    if(pf) {
      n = c.events.prefix + n
    }
    if(ns) {
      n = n + "." + c.events.namespace
    }
    if(ns && rd) {
      n += c.serialNumber
    }
    return n
  }
  function cf_c(n, c) {
    return typeof c.classnames[n] == "string" ? c.classnames[n] : n
  }
  function cf_mapWrapperSizes(ws, o, p) {
    if(typeof p != "boolean") {
      p = true
    }
    var pad = o.usePadding && p ? o.padding : [0, 0, 0, 0];
    var wra = {};
    wra[o.d["width"]] = ws[0] + pad[1] + pad[3];
    wra[o.d["height"]] = ws[1] + pad[0] + pad[2];
    return wra
  }
  function cf_sortParams(vals, typs) {
    var arr = [];
    for(var a = 0, l1 = vals.length;a < l1;a++) {
      for(var b = 0, l2 = typs.length;b < l2;b++) {
        if(typs[b].indexOf(typeof vals[a]) > -1 && typeof arr[b] == "undefined") {
          arr[b] = vals[a];
          break
        }
      }
    }
    return arr
  }
  function cf_getPadding(p) {
    if(typeof p == "undefined") {
      return[0, 0, 0, 0]
    }
    if(typeof p == "number") {
      return[p, p, p, p]
    }else {
      if(typeof p == "string") {
        p = p.split("px").join("").split("em").join("").split(" ")
      }
    }
    if(!is_array(p)) {
      return[0, 0, 0, 0]
    }
    for(var i = 0;i < 4;i++) {
      p[i] = parseInt(p[i])
    }
    switch(p.length) {
      case 0:
        return[0, 0, 0, 0];
      case 1:
        return[p[0], p[0], p[0], p[0]];
      case 2:
        return[p[0], p[1], p[0], p[1]];
      case 3:
        return[p[0], p[1], p[2], p[1]];
      default:
        return[p[0], p[1], p[2], p[3]]
    }
  }
  function cf_getAlignPadding(itm, o) {
    var x = typeof o[o.d["width"]] == "number" ? Math.ceil(o[o.d["width"]] - ms_getTotalSize(itm, o, "width")) : 0;
    switch(o.align) {
      case "left":
        return[0, x];
      case "right":
        return[x, 0];
      case "center":
      ;
      default:
        return[Math.ceil(x / 2), Math.floor(x / 2)]
    }
  }
  function cf_getAdjust(x, o, a, $t) {
    var v = x;
    if(typeof a == "function") {
      v = a.call($t, v)
    }else {
      if(typeof a == "string") {
        var p = a.split("+"), m = a.split("-");
        if(m.length > p.length) {
          var neg = true, sta = m[0], adj = m[1]
        }else {
          var neg = false, sta = p[0], adj = p[1]
        }
        switch(sta) {
          case "even":
            v = x % 2 == 1 ? x - 1 : x;
            break;
          case "odd":
            v = x % 2 == 0 ? x - 1 : x;
            break;
          default:
            v = x;
            break
        }
        adj = parseInt(adj);
        if(!isNaN(adj)) {
          if(neg) {
            adj = -adj
          }
          v += adj
        }
      }
    }
    if(typeof v != "number") {
      v = 1
    }
    if(v < 1) {
      v = 1
    }
    return v
  }
  function cf_getItemsAdjust(x, o, a, $t) {
    return cf_getItemAdjustMinMax(cf_getAdjust(x, o, a, $t), o.items.visibleConf)
  }
  function cf_getItemAdjustMinMax(v, i) {
    if(typeof i.min == "number" && v < i.min) {
      v = i.min
    }
    if(typeof i.max == "number" && v > i.max) {
      v = i.max
    }
    if(v < 1) {
      v = 1
    }
    return v
  }
  function cf_getSynchArr(s) {
    if(!is_array(s)) {
      s = [[s]]
    }
    if(!is_array(s[0])) {
      s = [s]
    }
    for(var j = 0, l = s.length;j < l;j++) {
      if(typeof s[j][0] == "string") {
        s[j][0] = $(s[j][0])
      }
      if(typeof s[j][1] != "boolean") {
        s[j][1] = true
      }
      if(typeof s[j][2] != "boolean") {
        s[j][2] = true
      }
      if(typeof s[j][3] != "number") {
        s[j][3] = 0
      }
    }
    return s
  }
  function cf_getKeyCode(k) {
    if(k == "right") {
      return 39
    }
    if(k == "left") {
      return 37
    }
    if(k == "up") {
      return 38
    }
    if(k == "down") {
      return 40
    }
    return-1
  }
  function cf_setCookie(n, v) {
    if(n) {
      document.cookie = n + "=" + v + "; path=/"
    }
  }
  function cf_readCookie(n) {
    n += "=";
    var ca = document.cookie.split(";");
    for(var a = 0, l = ca.length;a < l;a++) {
      var c = ca[a];
      while(c.charAt(0) == " ") {
        c = c.substring(1, c.length)
      }
      if(c.indexOf(n) == 0) {
        return c.substring(n.length, c.length)
      }
    }
    return 0
  }
  function bt_pauseOnHoverConfig(p) {
    if(p && typeof p == "string") {
      var i = p.indexOf("immediate") > -1 ? true : false, r = p.indexOf("resume") > -1 ? true : false
    }else {
      var i = r = false
    }
    return[i, r]
  }
  function bt_mousesheelNumber(mw) {
    return typeof mw == "number" ? mw : null
  }
  function is_array(a) {
    return typeof a == "object" && a instanceof Array
  }
  function getTime() {
    return(new Date).getTime()
  }
  function debug(d, m) {
    if(typeof d == "object") {
      var s = " (" + d.selector + ")";
      d = d.debug
    }else {
      var s = ""
    }
    if(!d) {
      return false
    }
    if(typeof m == "string") {
      m = "carouFredSel" + s + ": " + m
    }else {
      m = ["carouFredSel" + s + ":", m]
    }
    if(window.console && window.console.log) {
      window.console.log(m)
    }
    return false
  }
  $.fn.caroufredsel = function(o, c) {
    return this.carouFredSel(o, c)
  };
  $.extend($.easing, {"quadratic":function(t) {
    var t2 = t * t;
    return t * (-t2 * t + 4 * t2 - 6 * t + 4)
  }, "cubic":function(t) {
    return t * (4 * t * t - 9 * t + 6)
  }, "elastic":function(t) {
    var t2 = t * t;
    return t * (33 * t2 * t2 - 106 * t2 * t + 126 * t2 - 67 * t + 15)
  }})
})(jQuery);
jQuery.cookie = function(key, value, options) {
  if(arguments.length > 1 && String(value) !== "[object Object]") {
    options = jQuery.extend({}, options);
    if(value === null || value === undefined) {
      options.expires = -1
    }
    if(typeof options.expires === "number") {
      var days = options.expires, t = options.expires = new Date;
      t.setDate(t.getDate() + days)
    }
    value = String(value);
    return document.cookie = [encodeURIComponent(key), "=", options.raw ? value : encodeURIComponent(value), options.expires ? "; expires=" + options.expires.toUTCString() : "", options.path ? "; path=" + options.path : "", options.domain ? "; domain=" + options.domain : "", options.secure ? "; secure" : ""].join("")
  }
  options = value || {};
  var result, decode = options.raw ? function(s) {
    return s
  } : decodeURIComponent;
  return(result = (new RegExp("(?:^|; )" + encodeURIComponent(key) + "=([^;]*)")).exec(document.cookie)) ? decode(result[1]) : null
};
(function($) {
  var tmp, loading, overlay, wrap, outer, content, close, title, nav_left, nav_right, selectedIndex = 0, selectedOpts = {}, selectedArray = [], currentIndex = 0, currentOpts = {}, currentArray = [], ajaxLoader = null, imgPreloader = new Image, imgRegExp = /\.(jpg|gif|png|bmp|jpeg)(.*)?$/i, swfRegExp = /[^\.]\.(swf)\s*$/i, loadingTimer, loadingFrame = 1, titleHeight = 0, titleStr = "", start_pos, final_pos, busy = false, fx = $.extend($("<div/>")[0], {prop:0}), isIE6 = $.browser.msie && $.browser.version < 
  7 && !window.XMLHttpRequest, _abort = function() {
    loading.hide();
    imgPreloader.onerror = imgPreloader.onload = null;
    if(ajaxLoader) {
      ajaxLoader.abort()
    }
    tmp.empty()
  }, _error = function() {
    if(false === selectedOpts.onError(selectedArray, selectedIndex, selectedOpts)) {
      loading.hide();
      busy = false;
      return
    }
    selectedOpts.titleShow = false;
    selectedOpts.width = "auto";
    selectedOpts.height = "auto";
    tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');
    _process_inline()
  }, _start = function() {
    var obj = selectedArray[selectedIndex], href, type, title, str, emb, ret;
    _abort();
    selectedOpts = $.extend({}, $.fn.fancybox.defaults, typeof $(obj).data("fancybox") == "undefined" ? selectedOpts : $(obj).data("fancybox"));
    ret = selectedOpts.onStart(selectedArray, selectedIndex, selectedOpts);
    if(ret === false) {
      busy = false;
      return
    }else {
      if(typeof ret == "object") {
        selectedOpts = $.extend(selectedOpts, ret)
      }
    }
    title = selectedOpts.title || (obj.nodeName ? $(obj).attr("title") : obj.title) || "";
    if(obj.nodeName && !selectedOpts.orig) {
      selectedOpts.orig = $(obj).children("img:first").length ? $(obj).children("img:first") : $(obj)
    }
    if(title === "" && selectedOpts.orig && selectedOpts.titleFromAlt) {
      title = selectedOpts.orig.attr("alt")
    }
    href = selectedOpts.href || (obj.nodeName ? $(obj).attr("href") : obj.href) || null;
    if(/^(?:javascript)/i.test(href) || href == "#") {
      href = null
    }
    if(selectedOpts.type) {
      type = selectedOpts.type;
      if(!href) {
        href = selectedOpts.content
      }
    }else {
      if(selectedOpts.content) {
        type = "html"
      }else {
        if(href) {
          if(href.match(imgRegExp)) {
            type = "image"
          }else {
            if(href.match(swfRegExp)) {
              type = "swf"
            }else {
              if($(obj).hasClass("iframe")) {
                type = "iframe"
              }else {
                if(href.indexOf("#") === 0) {
                  type = "inline"
                }else {
                  type = "ajax"
                }
              }
            }
          }
        }
      }
    }
    if(!type) {
      _error();
      return
    }
    if(type == "inline") {
      obj = href.substr(href.indexOf("#"));
      type = $(obj).length > 0 ? "inline" : "ajax"
    }
    selectedOpts.type = type;
    selectedOpts.href = href;
    selectedOpts.title = title;
    if(selectedOpts.autoDimensions) {
      if(selectedOpts.type == "html" || selectedOpts.type == "inline" || selectedOpts.type == "ajax") {
        selectedOpts.width = "auto";
        selectedOpts.height = "auto"
      }else {
        selectedOpts.autoDimensions = false
      }
    }
    if(selectedOpts.modal) {
      selectedOpts.overlayShow = true;
      selectedOpts.hideOnOverlayClick = false;
      selectedOpts.hideOnContentClick = false;
      selectedOpts.enableEscapeButton = false;
      selectedOpts.showCloseButton = false
    }
    selectedOpts.padding = parseInt(selectedOpts.padding, 10);
    selectedOpts.margin = parseInt(selectedOpts.margin, 10);
    tmp.css("padding", selectedOpts.padding + selectedOpts.margin);
    $(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change", function() {
      $(this).replaceWith(content.children())
    });
    switch(type) {
      case "html":
        tmp.html(selectedOpts.content);
        _process_inline();
        break;
      case "inline":
        if($(obj).parent().is("#fancybox-content") === true) {
          busy = false;
          return
        }
        $('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup", function() {
          $(this).replaceWith(content.children())
        }).bind("fancybox-cancel", function() {
          $(this).replaceWith(tmp.children())
        });
        $(obj).appendTo(tmp);
        _process_inline();
        break;
      case "image":
        busy = false;
        $.fancybox.showActivity();
        imgPreloader = new Image;
        imgPreloader.onerror = function() {
          _error()
        };
        imgPreloader.onload = function() {
          busy = true;
          imgPreloader.onerror = imgPreloader.onload = null;
          _process_image()
        };
        imgPreloader.src = href;
        break;
      case "swf":
        selectedOpts.scrolling = "no";
        str = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"><param name="movie" value="' + href + '"></param>';
        emb = "";
        $.each(selectedOpts.swf, function(name, val) {
          str += '<param name="' + name + '" value="' + val + '"></param>';
          emb += " " + name + '="' + val + '"'
        });
        str += '<embed src="' + href + '" type="application/x-shockwave-flash" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"' + emb + "></embed></object>";
        tmp.html(str);
        _process_inline();
        break;
      case "ajax":
        busy = false;
        $.fancybox.showActivity();
        selectedOpts.ajax.win = selectedOpts.ajax.success;
        ajaxLoader = $.ajax($.extend({}, selectedOpts.ajax, {url:href, data:selectedOpts.ajax.data || {}, error:function(XMLHttpRequest, textStatus, errorThrown) {
          if(XMLHttpRequest.status > 0) {
            _error()
          }
        }, success:function(data, textStatus, XMLHttpRequest) {
          var o = typeof XMLHttpRequest == "object" ? XMLHttpRequest : ajaxLoader;
          if(o.status == 200) {
            if(typeof selectedOpts.ajax.win == "function") {
              ret = selectedOpts.ajax.win(href, data, textStatus, XMLHttpRequest);
              if(ret === false) {
                loading.hide();
                return
              }else {
                if(typeof ret == "string" || typeof ret == "object") {
                  data = ret
                }
              }
            }
            tmp.html(data);
            _process_inline()
          }
        }}));
        break;
      case "iframe":
        _show();
        break
    }
  }, _process_inline = function() {
    var w = selectedOpts.width, h = selectedOpts.height;
    if(w.toString().indexOf("%") > -1) {
      w = parseInt(($(window).width() - selectedOpts.margin * 2) * parseFloat(w) / 100, 10) + "px"
    }else {
      w = w == "auto" ? "auto" : w + "px"
    }
    if(h.toString().indexOf("%") > -1) {
      h = parseInt(($(window).height() - selectedOpts.margin * 2) * parseFloat(h) / 100, 10) + "px"
    }else {
      h = h == "auto" ? "auto" : h + "px"
    }
    tmp.wrapInner('<div style="width:' + w + ";height:" + h + ";overflow: " + (selectedOpts.scrolling == "auto" ? "auto" : selectedOpts.scrolling == "yes" ? "scroll" : "hidden") + ';position:relative;"></div>');
    selectedOpts.width = tmp.width();
    selectedOpts.height = tmp.height();
    _show()
  }, _process_image = function() {
    selectedOpts.width = imgPreloader.width;
    selectedOpts.height = imgPreloader.height;
    $("<img />").attr({"id":"fancybox-img", "src":imgPreloader.src, "alt":selectedOpts.title}).appendTo(tmp);
    _show()
  }, _show = function() {
    $(".joyride-close-tip").click();
    var pos, equal;
    loading.hide();
    if(wrap.is(":visible") && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
      $.event.trigger("fancybox-cancel");
      busy = false;
      return
    }
    busy = true;
    $(content.add(overlay)).unbind();
    $(window).unbind("resize.fb scroll.fb");
    $(document).unbind("keydown.fb");
    if(wrap.is(":visible") && currentOpts.titlePosition !== "outside") {
      wrap.css("height", wrap.height())
    }
    currentArray = selectedArray;
    currentIndex = selectedIndex;
    currentOpts = selectedOpts;
    if(currentOpts.overlayShow) {
      overlay.css({"background-color":currentOpts.overlayColor, "opacity":currentOpts.overlayOpacity, "cursor":currentOpts.hideOnOverlayClick ? "pointer" : "auto", "height":$(document).height()});
      if(!overlay.is(":visible")) {
        if(isIE6) {
          $("select:not(#fancybox-tmp select)").filter(function() {
            return this.style.visibility !== "hidden"
          }).css({"visibility":"hidden"}).one("fancybox-cleanup", function() {
            this.style.visibility = "inherit"
          })
        }
        overlay.show()
      }
    }else {
      overlay.hide()
    }
    final_pos = _get_zoom_to();
    _process_title();
    if(wrap.is(":visible")) {
      $(close.add(nav_left).add(nav_right)).hide();
      pos = wrap.position(), start_pos = {top:pos.top, left:pos.left, width:wrap.width(), height:wrap.height()};
      equal = start_pos.width == final_pos.width && start_pos.height == final_pos.height;
      content.fadeTo(currentOpts.changeFade, 0.3, function() {
        var finish_resizing = function() {
          content.html(tmp.contents()).fadeTo(currentOpts.changeFade, 1, _finish)
        };
        $.event.trigger("fancybox-change");
        content.empty().removeAttr("filter").css({"border-width":currentOpts.padding, "width":final_pos.width - currentOpts.padding * 2, "height":selectedOpts.autoDimensions ? "auto" : final_pos.height - titleHeight - currentOpts.padding * 2});
        if(equal) {
          finish_resizing()
        }else {
          fx.prop = 0;
          $(fx).animate({prop:1}, {duration:currentOpts.changeSpeed, easing:currentOpts.easingChange, step:_draw, complete:finish_resizing})
        }
      });
      return
    }
    wrap.removeAttr("style");
    content.css("border-width", currentOpts.padding);
    if(currentOpts.transitionIn == "elastic") {
      start_pos = _get_zoom_from();
      content.html(tmp.contents());
      wrap.show();
      if(currentOpts.opacity) {
        final_pos.opacity = 0
      }
      fx.prop = 0;
      $(fx).animate({prop:1}, {duration:currentOpts.speedIn, easing:currentOpts.easingIn, step:_draw, complete:_finish});
      return
    }
    if(currentOpts.titlePosition == "inside" && titleHeight > 0) {
      title.show()
    }
    content.css({"width":final_pos.width - currentOpts.padding * 2, "height":selectedOpts.autoDimensions ? "auto" : final_pos.height - titleHeight - currentOpts.padding * 2}).html(tmp.contents());
    wrap.css(final_pos).fadeIn(currentOpts.transitionIn == "none" ? 0 : currentOpts.speedIn, _finish)
  }, _format_title = function(title) {
    if(title && title.length) {
      if(currentOpts.titlePosition == "float") {
        return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">' + title + '</td><td id="fancybox-title-float-right"></td></tr></table>'
      }
      return'<div id="fancybox-title-' + currentOpts.titlePosition + '">' + title + "</div>"
    }
    return false
  }, _process_title = function() {
    titleStr = currentOpts.title || "";
    titleHeight = 0;
    title.empty().removeAttr("style").removeClass();
    if(currentOpts.titleShow === false) {
      title.hide();
      return
    }
    titleStr = $.isFunction(currentOpts.titleFormat) ? currentOpts.titleFormat(titleStr, currentArray, currentIndex, currentOpts) : _format_title(titleStr);
    if(!titleStr || titleStr === "") {
      title.hide();
      return
    }
    title.addClass("fancybox-title-" + currentOpts.titlePosition).html(titleStr).appendTo("body").show();
    switch(currentOpts.titlePosition) {
      case "inside":
        title.css({"width":final_pos.width - currentOpts.padding * 2, "marginLeft":currentOpts.padding, "marginRight":currentOpts.padding});
        titleHeight = title.outerHeight(true);
        title.appendTo(outer);
        final_pos.height += titleHeight;
        break;
      case "over":
        title.css({"marginLeft":currentOpts.padding, "width":final_pos.width - currentOpts.padding * 2, "bottom":currentOpts.padding}).appendTo(outer);
        break;
      case "float":
        title.css("left", parseInt((title.width() - final_pos.width - 40) / 2, 10) * -1).appendTo(wrap);
        break;
      default:
        title.css({"width":final_pos.width - currentOpts.padding * 2, "paddingLeft":currentOpts.padding, "paddingRight":currentOpts.padding}).appendTo(wrap);
        break
    }
    title.hide()
  }, _set_navigation = function() {
    if(currentOpts.enableEscapeButton || currentOpts.enableKeyboardNav) {
      $(document).bind("keydown.fb", function(e) {
        if(e.keyCode == 27 && currentOpts.enableEscapeButton) {
          e.preventDefault();
          $.fancybox.close()
        }else {
          if((e.keyCode == 37 || e.keyCode == 39) && currentOpts.enableKeyboardNav && e.target.tagName !== "INPUT" && e.target.tagName !== "TEXTAREA" && e.target.tagName !== "SELECT") {
            e.preventDefault();
            $.fancybox[e.keyCode == 37 ? "prev" : "next"]()
          }
        }
      })
    }
    if(!currentOpts.showNavArrows) {
      nav_left.hide();
      nav_right.hide();
      return
    }
    if(currentOpts.cyclic && currentArray.length > 1 || currentIndex !== 0) {
      nav_left.show()
    }
    if(currentOpts.cyclic && currentArray.length > 1 || currentIndex != currentArray.length - 1) {
      nav_right.show()
    }
  }, _finish = function() {
    if(!$.support.opacity) {
      content.get(0).style.removeAttribute("filter");
      wrap.get(0).style.removeAttribute("filter")
    }
    if(selectedOpts.autoDimensions) {
      content.css("height", "auto")
    }
    wrap.css("height", "auto");
    if(titleStr && titleStr.length) {
      title.show()
    }
    if(currentOpts.showCloseButton) {
      close.show()
    }
    _set_navigation();
    if(currentOpts.hideOnContentClick) {
      content.bind("click", $.fancybox.close)
    }
    if(currentOpts.hideOnOverlayClick) {
      overlay.bind("click", $.fancybox.close)
    }
    $(window).bind("resize.fb", $.fancybox.resize);
    if(currentOpts.centerOnScroll) {
      $(window).bind("scroll.fb", $.fancybox.center)
    }
    if(currentOpts.type == "iframe") {
      $('<iframe id="fancybox-frame" name="fancybox-frame' + (new Date).getTime() + '" frameborder="0" hspace="0" ' + ($.browser.msie ? 'allowtransparency="true""' : "") + ' scrolling="' + selectedOpts.scrolling + '" src="' + currentOpts.href + '"></iframe>').appendTo(content)
    }
    wrap.show();
    busy = false;
    $.fancybox.center();
    currentOpts.onComplete(currentArray, currentIndex, currentOpts);
    _preload_images()
  }, _preload_images = function() {
    var href, objNext;
    if(currentArray.length - 1 > currentIndex) {
      href = currentArray[currentIndex + 1].href;
      if(typeof href !== "undefined" && href.match(imgRegExp)) {
        objNext = new Image;
        objNext.src = href
      }
    }
    if(currentIndex > 0) {
      href = currentArray[currentIndex - 1].href;
      if(typeof href !== "undefined" && href.match(imgRegExp)) {
        objNext = new Image;
        objNext.src = href
      }
    }
  }, _draw = function(pos) {
    var dim = {width:parseInt(start_pos.width + (final_pos.width - start_pos.width) * pos, 10), height:parseInt(start_pos.height + (final_pos.height - start_pos.height) * pos, 10), top:parseInt(start_pos.top + (final_pos.top - start_pos.top) * pos, 10), left:parseInt(start_pos.left + (final_pos.left - start_pos.left) * pos, 10)};
    if(typeof final_pos.opacity !== "undefined") {
      dim.opacity = pos < 0.5 ? 0.5 : pos
    }
    wrap.css(dim);
    content.css({"width":dim.width - currentOpts.padding * 2, "height":dim.height - titleHeight * pos - currentOpts.padding * 2})
  }, _get_viewport = function() {
    return[$(window).width() - currentOpts.margin * 2, $(window).height() - currentOpts.margin * 2, $(document).scrollLeft() + currentOpts.margin, $(document).scrollTop() + currentOpts.margin]
  }, _get_zoom_to = function() {
    var view = _get_viewport(), to = {}, resize = currentOpts.autoScale, double_padding = currentOpts.padding * 2, ratio;
    if(currentOpts.width.toString().indexOf("%") > -1) {
      to.width = parseInt(view[0] * parseFloat(currentOpts.width) / 100, 10)
    }else {
      to.width = currentOpts.width + double_padding
    }
    if(currentOpts.height.toString().indexOf("%") > -1) {
      to.height = parseInt(view[1] * parseFloat(currentOpts.height) / 100, 10)
    }else {
      to.height = currentOpts.height + double_padding
    }
    if(resize && (to.width > view[0] || to.height > view[1])) {
      if(selectedOpts.type == "image" || selectedOpts.type == "swf") {
        ratio = currentOpts.width / currentOpts.height;
        if(to.width > view[0]) {
          to.width = view[0];
          to.height = parseInt((to.width - double_padding) / ratio + double_padding, 10)
        }
        if(to.height > view[1]) {
          to.height = view[1];
          to.width = parseInt((to.height - double_padding) * ratio + double_padding, 10)
        }
      }else {
        to.width = Math.min(to.width, view[0]);
        to.height = Math.min(to.height, view[1])
      }
    }
    to.top = parseInt(Math.max(view[3] - 20, view[3] + (view[1] - to.height - 40) * 0.5), 10);
    to.left = parseInt(Math.max(view[2] - 20, view[2] + (view[0] - to.width - 40) * 0.5), 10);
    return to
  }, _get_obj_pos = function(obj) {
    var pos = obj.offset();
    pos.top += parseInt(obj.css("paddingTop"), 10) || 0;
    pos.left += parseInt(obj.css("paddingLeft"), 10) || 0;
    pos.top += parseInt(obj.css("border-top-width"), 10) || 0;
    pos.left += parseInt(obj.css("border-left-width"), 10) || 0;
    pos.width = obj.width();
    pos.height = obj.height();
    return pos
  }, _get_zoom_from = function() {
    var orig = selectedOpts.orig ? $(selectedOpts.orig) : false, from = {}, pos, view;
    if(orig && orig.length) {
      pos = _get_obj_pos(orig);
      from = {width:pos.width + currentOpts.padding * 2, height:pos.height + currentOpts.padding * 2, top:pos.top - currentOpts.padding - 20, left:pos.left - currentOpts.padding - 20}
    }else {
      view = _get_viewport();
      from = {width:currentOpts.padding * 2, height:currentOpts.padding * 2, top:parseInt(view[3] + view[1] * 0.5, 10), left:parseInt(view[2] + view[0] * 0.5, 10)}
    }
    return from
  }, _animate_loading = function() {
    if(!loading.is(":visible")) {
      clearInterval(loadingTimer);
      return
    }
    $("div", loading).css("top", loadingFrame * -40 + "px");
    loadingFrame = (loadingFrame + 1) % 12
  };
  $.fn.fancybox = function(options) {
    if(!$(this).length) {
      return this
    }
    $(this).data("fancybox", $.extend({}, options, $.metadata ? $(this).metadata() : {})).unbind("click.fb").bind("click.fb", function(e) {
      e.preventDefault();
      if(busy) {
        return
      }
      busy = true;
      $(this).blur();
      selectedArray = [];
      selectedIndex = 0;
      var rel = $(this).attr("rel") || "";
      if(!rel || rel == "" || rel === "nofollow") {
        selectedArray.push(this)
      }else {
        selectedArray = $("a[rel=" + rel + "], area[rel=" + rel + "]");
        selectedIndex = selectedArray.index(this)
      }
      _start();
      return
    });
    return this
  };
  $.fancybox = function(obj) {
    var opts;
    if(busy) {
      return
    }
    busy = true;
    opts = typeof arguments[1] !== "undefined" ? arguments[1] : {};
    selectedArray = [];
    selectedIndex = parseInt(opts.index, 10) || 0;
    if($.isArray(obj)) {
      for(var i = 0, j = obj.length;i < j;i++) {
        if(typeof obj[i] == "object") {
          $(obj[i]).data("fancybox", $.extend({}, opts, obj[i]))
        }else {
          obj[i] = $({}).data("fancybox", $.extend({content:obj[i]}, opts))
        }
      }
      selectedArray = jQuery.merge(selectedArray, obj)
    }else {
      if(typeof obj == "object") {
        $(obj).data("fancybox", $.extend({}, opts, obj))
      }else {
        obj = $({}).data("fancybox", $.extend({content:obj}, opts))
      }
      selectedArray.push(obj)
    }
    if(selectedIndex > selectedArray.length || selectedIndex < 0) {
      selectedIndex = 0
    }
    _start()
  };
  $.fancybox.showActivity = function() {
    clearInterval(loadingTimer);
    loading.show();
    loadingTimer = setInterval(_animate_loading, 66)
  };
  $.fancybox.hideActivity = function() {
    loading.hide()
  };
  $.fancybox.next = function() {
    return $.fancybox.pos(currentIndex + 1)
  };
  $.fancybox.prev = function() {
    return $.fancybox.pos(currentIndex - 1)
  };
  $.fancybox.pos = function(pos) {
    if(busy) {
      return
    }
    pos = parseInt(pos);
    selectedArray = currentArray;
    if(pos > -1 && pos < currentArray.length) {
      selectedIndex = pos;
      _start()
    }else {
      if(currentOpts.cyclic && currentArray.length > 1) {
        selectedIndex = pos >= currentArray.length ? 0 : currentArray.length - 1;
        _start()
      }
    }
    return
  };
  $.fancybox.cancel = function() {
    if(busy) {
      return
    }
    busy = true;
    $.event.trigger("fancybox-cancel");
    _abort();
    selectedOpts.onCancel(selectedArray, selectedIndex, selectedOpts);
    busy = false
  };
  $.fancybox.close = function() {
    $(".joyride-close-tip").click();
    if(busy || wrap.is(":hidden")) {
      return
    }
    busy = true;
    if(currentOpts && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
      busy = false;
      return
    }
    _abort();
    $(close.add(nav_left).add(nav_right)).hide();
    $(content.add(overlay)).unbind();
    $(window).unbind("resize.fb scroll.fb");
    $(document).unbind("keydown.fb");
    content.find("iframe").attr("src", isIE6 && /^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank");
    if(currentOpts.titlePosition !== "inside") {
      title.empty()
    }
    wrap.stop();
    function _cleanup() {
      overlay.fadeOut("fast");
      title.empty().hide();
      wrap.hide();
      $.event.trigger("fancybox-cleanup");
      content.empty();
      currentOpts.onClosed(currentArray, currentIndex, currentOpts);
      currentArray = selectedOpts = [];
      currentIndex = selectedIndex = 0;
      currentOpts = selectedOpts = {};
      busy = false
    }
    if(currentOpts.transitionOut == "elastic") {
      start_pos = _get_zoom_from();
      var pos = wrap.position();
      final_pos = {top:pos.top, left:pos.left, width:wrap.width(), height:wrap.height()};
      if(currentOpts.opacity) {
        final_pos.opacity = 1
      }
      title.empty().hide();
      fx.prop = 1;
      $(fx).animate({prop:0}, {duration:currentOpts.speedOut, easing:currentOpts.easingOut, step:_draw, complete:_cleanup})
    }else {
      wrap.fadeOut(currentOpts.transitionOut == "none" ? 0 : currentOpts.speedOut, _cleanup)
    }
  };
  $.fancybox.resize = function() {
    if(overlay.is(":visible")) {
      overlay.css("height", $(document).height())
    }
    $.fancybox.center(true)
  };
  $.fancybox.center = function() {
    var view, align;
    if(busy) {
      return
    }
    align = arguments[0] === true ? 1 : 0;
    view = _get_viewport();
    if(!align && (wrap.width() > view[0] || wrap.height() > view[1])) {
      return
    }
    wrap.stop().animate({"top":parseInt(Math.max(view[3] - 20, view[3] + (view[1] - content.height() - 40) * 0.5 - currentOpts.padding)), "left":parseInt(Math.max(view[2] - 20, view[2] + (view[0] - content.width() - 40) * 0.5 - currentOpts.padding))}, typeof arguments[0] == "number" ? arguments[0] : 200)
  };
  $.fancybox.init = function() {
    if($("#fancybox-wrap").length) {
      return
    }
    $("body").append(tmp = $('<div id="fancybox-tmp"></div>'), loading = $('<div id="fancybox-loading"><div></div></div>'), overlay = $('<div id="fancybox-overlay"></div>'), wrap = $('<div id="fancybox-wrap"></div>'));
    outer = $('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);
    outer.append(content = $('<div id="fancybox-content"></div>'), close = $('<a id="fancybox-close"></a>'), title = $('<div id="fancybox-title"></div>'), nav_left = $('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'), nav_right = $('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));
    close.click($.fancybox.close);
    loading.click($.fancybox.cancel);
    nav_left.click(function(e) {
      e.preventDefault();
      $.fancybox.prev()
    });
    nav_right.click(function(e) {
      e.preventDefault();
      $.fancybox.next()
    });
    if($.fn.mousewheel) {
      wrap.bind("mousewheel.fb", function(e, delta) {
        if(busy) {
          e.preventDefault()
        }else {
          if($(e.target).get(0).clientHeight == 0 || $(e.target).get(0).scrollHeight === $(e.target).get(0).clientHeight) {
            e.preventDefault();
            $.fancybox[delta > 0 ? "prev" : "next"]()
          }
        }
      })
    }
    if(!$.support.opacity) {
      wrap.addClass("fancybox-ie")
    }
    if(isIE6) {
      loading.addClass("fancybox-ie6");
      wrap.addClass("fancybox-ie6");
      $('<iframe id="fancybox-hide-sel-frame" src="' + (/^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank") + '" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)
    }
  };
  $.fn.fancybox.defaults = {padding:10, margin:40, opacity:false, modal:false, cyclic:false, scrolling:"auto", width:560, height:340, autoScale:true, autoDimensions:true, centerOnScroll:false, ajax:{}, swf:{wmode:"transparent"}, hideOnOverlayClick:true, hideOnContentClick:false, overlayShow:true, overlayOpacity:0.7, overlayColor:"#777", titleShow:true, titlePosition:"float", titleFormat:null, titleFromAlt:false, transitionIn:"fade", transitionOut:"fade", speedIn:300, speedOut:300, changeSpeed:300, 
  changeFade:"fast", easingIn:"swing", easingOut:"swing", showCloseButton:true, showNavArrows:true, enableEscapeButton:true, enableKeyboardNav:true, onStart:function() {
  }, onCancel:function() {
  }, onComplete:function() {
  }, onCleanup:function() {
  }, onClosed:function() {
  }, onError:function() {
  }};
  $(document).ready(function() {
    $.fancybox.init()
  })
})(jQuery);
(function($) {
  var feature = {};
  feature.fileapi = $("<input type='file'/>").get(0).files !== undefined;
  feature.formdata = window.FormData !== undefined;
  $.fn.ajaxSubmit = function(options) {
    if(!this.length) {
      log("ajaxSubmit: skipping submit process - no element selected");
      return this
    }
    var method, action, url, $form = this;
    if(typeof options == "function") {
      options = {success:options}
    }
    method = this.attr("method");
    action = this.attr("action");
    url = typeof action === "string" ? $.trim(action) : "";
    url = url || window.location.href || "";
    if(url) {
      url = (url.match(/^([^#]+)/) || [])[1]
    }
    options = $.extend(true, {url:url, success:$.ajaxSettings.success, type:method || "GET", iframeSrc:/^https/i.test(window.location.href || "") ? "javascript:false" : "about:blank"}, options);
    var veto = {};
    this.trigger("form-pre-serialize", [this, options, veto]);
    if(veto.veto) {
      log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");
      return this
    }
    if(options.beforeSerialize && options.beforeSerialize(this, options) === false) {
      log("ajaxSubmit: submit aborted via beforeSerialize callback");
      return this
    }
    var traditional = options.traditional;
    if(traditional === undefined) {
      traditional = $.ajaxSettings.traditional
    }
    var elements = [];
    var qx, a = this.formToArray(options.semantic, elements);
    if(options.data) {
      options.extraData = options.data;
      qx = $.param(options.data, traditional)
    }
    if(options.beforeSubmit && options.beforeSubmit(a, this, options) === false) {
      log("ajaxSubmit: submit aborted via beforeSubmit callback");
      return this
    }
    this.trigger("form-submit-validate", [a, this, options, veto]);
    if(veto.veto) {
      log("ajaxSubmit: submit vetoed via form-submit-validate trigger");
      return this
    }
    var q = $.param(a, traditional);
    if(qx) {
      q = q ? q + "&" + qx : qx
    }
    if(options.type.toUpperCase() == "GET") {
      options.url += (options.url.indexOf("?") >= 0 ? "&" : "?") + q;
      options.data = null
    }else {
      options.data = q
    }
    var callbacks = [];
    if(options.resetForm) {
      callbacks.push(function() {
        $form.resetForm()
      })
    }
    if(options.clearForm) {
      callbacks.push(function() {
        $form.clearForm(options.includeHidden)
      })
    }
    if(!options.dataType && options.target) {
      var oldSuccess = options.success || function() {
      };
      callbacks.push(function(data) {
        var fn = options.replaceTarget ? "replaceWith" : "html";
        $(options.target)[fn](data).each(oldSuccess, arguments)
      })
    }else {
      if(options.success) {
        callbacks.push(options.success)
      }
    }
    options.success = function(data, status, xhr) {
      var context = options.context || options;
      for(var i = 0, max = callbacks.length;i < max;i++) {
        callbacks[i].apply(context, [data, status, xhr || $form, $form])
      }
    };
    var fileInputs = $("input:file:enabled[value]", this);
    var hasFileInputs = fileInputs.length > 0;
    var mp = "multipart/form-data";
    var multipart = $form.attr("enctype") == mp || $form.attr("encoding") == mp;
    var fileAPI = feature.fileapi && feature.formdata;
    log("fileAPI :" + fileAPI);
    var shouldUseFrame = (hasFileInputs || multipart) && !fileAPI;
    if(options.iframe !== false && (options.iframe || shouldUseFrame)) {
      if(options.closeKeepAlive) {
        $.get(options.closeKeepAlive, function() {
          fileUploadIframe(a)
        })
      }else {
        fileUploadIframe(a)
      }
    }else {
      if((hasFileInputs || multipart) && fileAPI) {
        fileUploadXhr(a)
      }else {
        $.ajax(options)
      }
    }
    for(var k = 0;k < elements.length;k++) {
      elements[k] = null
    }
    this.trigger("form-submit-notify", [this, options]);
    return this;
    function fileUploadXhr(a) {
      var formdata = new FormData;
      for(var i = 0;i < a.length;i++) {
        formdata.append(a[i].name, a[i].value)
      }
      if(options.extraData) {
        for(var p in options.extraData) {
          if(options.extraData.hasOwnProperty(p)) {
            formdata.append(p, options.extraData[p])
          }
        }
      }
      options.data = null;
      var s = $.extend(true, {}, $.ajaxSettings, options, {contentType:false, processData:false, cache:false, type:"POST"});
      if(options.uploadProgress) {
        s.xhr = function() {
          var xhr = jQuery.ajaxSettings.xhr();
          if(xhr.upload) {
            xhr.upload.onprogress = function(event) {
              var percent = 0;
              var position = event.loaded || event.position;
              var total = event.total;
              if(event.lengthComputable) {
                percent = Math.ceil(position / total * 100)
              }
              options.uploadProgress(event, position, total, percent)
            }
          }
          return xhr
        }
      }
      s.data = null;
      var beforeSend = s.beforeSend;
      s.beforeSend = function(xhr, o) {
        o.data = formdata;
        if(beforeSend) {
          beforeSend.call(o, xhr, options)
        }
      };
      $.ajax(s)
    }
    function fileUploadIframe(a) {
      var form = $form[0], el, i, s, g, id, $io, io, xhr, sub, n, timedOut, timeoutHandle;
      var useProp = !!$.fn.prop;
      if($(":input[name=submit],:input[id=submit]", form).length) {
        alert('Error: Form elements must not have name or id of "submit".');
        return
      }
      if(a) {
        for(i = 0;i < elements.length;i++) {
          el = $(elements[i]);
          if(useProp) {
            el.prop("disabled", false)
          }else {
            el.removeAttr("disabled")
          }
        }
      }
      s = $.extend(true, {}, $.ajaxSettings, options);
      s.context = s.context || s;
      id = "jqFormIO" + (new Date).getTime();
      if(s.iframeTarget) {
        $io = $(s.iframeTarget);
        n = $io.attr("name");
        if(!n) {
          $io.attr("name", id)
        }else {
          id = n
        }
      }else {
        $io = $('<iframe name="' + id + '" src="' + s.iframeSrc + '" />');
        $io.css({position:"absolute", top:"-1000px", left:"-1000px"})
      }
      io = $io[0];
      xhr = {aborted:0, responseText:null, responseXML:null, status:0, statusText:"n/a", getAllResponseHeaders:function() {
      }, getResponseHeader:function() {
      }, setRequestHeader:function() {
      }, abort:function(status) {
        var e = status === "timeout" ? "timeout" : "aborted";
        log("aborting upload... " + e);
        this.aborted = 1;
        $io.attr("src", s.iframeSrc);
        xhr.error = e;
        if(s.error) {
          s.error.call(s.context, xhr, e, status)
        }
        if(g) {
          $.event.trigger("ajaxError", [xhr, s, e])
        }
        if(s.complete) {
          s.complete.call(s.context, xhr, e)
        }
      }};
      g = s.global;
      if(g && 0 === $.active++) {
        $.event.trigger("ajaxStart")
      }
      if(g) {
        $.event.trigger("ajaxSend", [xhr, s])
      }
      if(s.beforeSend && s.beforeSend.call(s.context, xhr, s) === false) {
        if(s.global) {
          $.active--
        }
        return
      }
      if(xhr.aborted) {
        return
      }
      sub = form.clk;
      if(sub) {
        n = sub.name;
        if(n && !sub.disabled) {
          s.extraData = s.extraData || {};
          s.extraData[n] = sub.value;
          if(sub.type == "image") {
            s.extraData[n + ".x"] = form.clk_x;
            s.extraData[n + ".y"] = form.clk_y
          }
        }
      }
      var CLIENT_TIMEOUT_ABORT = 1;
      var SERVER_ABORT = 2;
      function getDoc(frame) {
        var doc = frame.contentWindow ? frame.contentWindow.document : frame.contentDocument ? frame.contentDocument : frame.document;
        return doc
      }
      var csrf_token = $("meta[name=csrf-token]").attr("content");
      var csrf_param = $("meta[name=csrf-param]").attr("content");
      if(csrf_param && csrf_token) {
        s.extraData = s.extraData || {};
        s.extraData[csrf_param] = csrf_token
      }
      function doSubmit() {
        var t = $form.attr("target"), a = $form.attr("action");
        form.setAttribute("target", id);
        if(!method) {
          form.setAttribute("method", "POST")
        }
        if(a != s.url) {
          form.setAttribute("action", s.url)
        }
        if(!s.skipEncodingOverride && (!method || /post/i.test(method))) {
          $form.attr({encoding:"multipart/form-data", enctype:"multipart/form-data"})
        }
        if(s.timeout) {
          timeoutHandle = setTimeout(function() {
            timedOut = true;
            cb(CLIENT_TIMEOUT_ABORT)
          }, s.timeout)
        }
        function checkState() {
          try {
            var state = getDoc(io).readyState;
            log("state = " + state);
            if(state && state.toLowerCase() == "uninitialized") {
              setTimeout(checkState, 50)
            }
          }catch(e) {
            log("Server abort: ", e, " (", e.name, ")");
            cb(SERVER_ABORT);
            if(timeoutHandle) {
              clearTimeout(timeoutHandle)
            }
            timeoutHandle = undefined
          }
        }
        var extraInputs = [];
        try {
          if(s.extraData) {
            for(var n in s.extraData) {
              if(s.extraData.hasOwnProperty(n)) {
                extraInputs.push($('<input type="hidden" name="' + n + '">').attr("value", s.extraData[n]).appendTo(form)[0])
              }
            }
          }
          if(!s.iframeTarget) {
            $io.appendTo("body");
            if(io.attachEvent) {
              io.attachEvent("onload", cb)
            }else {
              io.addEventListener("load", cb, false)
            }
          }
          setTimeout(checkState, 15);
          form.submit()
        }finally {
          form.setAttribute("action", a);
          if(t) {
            form.setAttribute("target", t)
          }else {
            $form.removeAttr("target")
          }
          $(extraInputs).remove()
        }
      }
      if(s.forceSync) {
        doSubmit()
      }else {
        setTimeout(doSubmit, 10)
      }
      var data, doc, domCheckCount = 50, callbackProcessed;
      function cb(e) {
        if(xhr.aborted || callbackProcessed) {
          return
        }
        try {
          doc = getDoc(io)
        }catch(ex) {
          log("cannot access response document: ", ex);
          e = SERVER_ABORT
        }
        if(e === CLIENT_TIMEOUT_ABORT && xhr) {
          xhr.abort("timeout");
          return
        }else {
          if(e == SERVER_ABORT && xhr) {
            xhr.abort("server abort");
            return
          }
        }
        if(!doc || doc.location.href == s.iframeSrc) {
          if(!timedOut) {
            return
          }
        }
        if(io.detachEvent) {
          io.detachEvent("onload", cb)
        }else {
          io.removeEventListener("load", cb, false)
        }
        var status = "success", errMsg;
        try {
          if(timedOut) {
            throw"timeout";
          }
          var isXml = s.dataType == "xml" || doc.XMLDocument || $.isXMLDoc(doc);
          log("isXml=" + isXml);
          if(!isXml && window.opera && (doc.body === null || !doc.body.innerHTML)) {
            if(--domCheckCount) {
              log("requeing onLoad callback, DOM not available");
              setTimeout(cb, 250);
              return
            }
          }
          var docRoot = doc.body ? doc.body : doc.documentElement;
          xhr.responseText = docRoot ? docRoot.innerHTML : null;
          xhr.responseXML = doc.XMLDocument ? doc.XMLDocument : doc;
          if(isXml) {
            s.dataType = "xml"
          }
          xhr.getResponseHeader = function(header) {
            var headers = {"content-type":s.dataType};
            return headers[header]
          };
          if(docRoot) {
            xhr.status = Number(docRoot.getAttribute("status")) || xhr.status;
            xhr.statusText = docRoot.getAttribute("statusText") || xhr.statusText
          }
          var dt = (s.dataType || "").toLowerCase();
          var scr = /(json|script|text)/.test(dt);
          if(scr || s.textarea) {
            var ta = doc.getElementsByTagName("textarea")[0];
            if(ta) {
              xhr.responseText = ta.value;
              xhr.status = Number(ta.getAttribute("status")) || xhr.status;
              xhr.statusText = ta.getAttribute("statusText") || xhr.statusText
            }else {
              if(scr) {
                var pre = doc.getElementsByTagName("pre")[0];
                var b = doc.getElementsByTagName("body")[0];
                if(pre) {
                  xhr.responseText = pre.textContent ? pre.textContent : pre.innerText
                }else {
                  if(b) {
                    xhr.responseText = b.textContent ? b.textContent : b.innerText
                  }
                }
              }
            }
          }else {
            if(dt == "xml" && !xhr.responseXML && xhr.responseText) {
              xhr.responseXML = toXml(xhr.responseText)
            }
          }
          try {
            data = httpData(xhr, dt, s)
          }catch(e) {
            status = "parsererror";
            xhr.error = errMsg = e || status
          }
        }catch(e) {
          log("error caught: ", e);
          status = "error";
          xhr.error = errMsg = e || status
        }
        if(xhr.aborted) {
          log("upload aborted");
          status = null
        }
        if(xhr.status) {
          status = xhr.status >= 200 && xhr.status < 300 || xhr.status === 304 ? "success" : "error"
        }
        if(status === "success") {
          if(s.success) {
            s.success.call(s.context, data, "success", xhr)
          }
          if(g) {
            $.event.trigger("ajaxSuccess", [xhr, s])
          }
        }else {
          if(status) {
            if(errMsg === undefined) {
              errMsg = xhr.statusText
            }
            if(s.error) {
              s.error.call(s.context, xhr, status, errMsg)
            }
            if(g) {
              $.event.trigger("ajaxError", [xhr, s, errMsg])
            }
          }
        }
        if(g) {
          $.event.trigger("ajaxComplete", [xhr, s])
        }
        if(g && !--$.active) {
          $.event.trigger("ajaxStop")
        }
        if(s.complete) {
          s.complete.call(s.context, xhr, status)
        }
        callbackProcessed = true;
        if(s.timeout) {
          clearTimeout(timeoutHandle)
        }
        setTimeout(function() {
          if(!s.iframeTarget) {
            $io.remove()
          }
          xhr.responseXML = null
        }, 100)
      }
      var toXml = $.parseXML || function(s, doc) {
        if(window.ActiveXObject) {
          doc = new ActiveXObject("Microsoft.XMLDOM");
          doc.async = "false";
          doc.loadXML(s)
        }else {
          doc = (new DOMParser).parseFromString(s, "text/xml")
        }
        return doc && doc.documentElement && doc.documentElement.nodeName != "parsererror" ? doc : null
      };
      var parseJSON = $.parseJSON || function(s) {
        return window["eval"]("(" + s + ")")
      };
      var httpData = function(xhr, type, s) {
        var ct = xhr.getResponseHeader("content-type") || "", xml = type === "xml" || !type && ct.indexOf("xml") >= 0, data = xml ? xhr.responseXML : xhr.responseText;
        if(xml && data.documentElement.nodeName === "parsererror") {
          if($.error) {
            $.error("parsererror")
          }
        }
        if(s && s.dataFilter) {
          data = s.dataFilter(data, type)
        }
        if(typeof data === "string") {
          if(type === "json" || !type && ct.indexOf("json") >= 0) {
            data = parseJSON(data)
          }else {
            if(type === "script" || !type && ct.indexOf("javascript") >= 0) {
              $.globalEval(data)
            }
          }
        }
        return data
      }
    }
  };
  $.fn.ajaxForm = function(options) {
    options = options || {};
    options.delegation = options.delegation && $.isFunction($.fn.on);
    if(!options.delegation && this.length === 0) {
      var o = {s:this.selector, c:this.context};
      if(!$.isReady && o.s) {
        log("DOM not ready, queuing ajaxForm");
        $(function() {
          $(o.s, o.c).ajaxForm(options)
        });
        return this
      }
      log("terminating; zero elements found by selector" + ($.isReady ? "" : " (DOM not ready)"));
      return this
    }
    if(options.delegation) {
      $(document).off("submit.form-plugin", this.selector, doAjaxSubmit).off("click.form-plugin", this.selector, captureSubmittingElement).on("submit.form-plugin", this.selector, options, doAjaxSubmit).on("click.form-plugin", this.selector, options, captureSubmittingElement);
      return this
    }
    return this.ajaxFormUnbind().bind("submit.form-plugin", options, doAjaxSubmit).bind("click.form-plugin", options, captureSubmittingElement)
  };
  function doAjaxSubmit(e) {
    var options = e.data;
    if(!e.isDefaultPrevented()) {
      e.preventDefault();
      $(this).ajaxSubmit(options)
    }
  }
  function captureSubmittingElement(e) {
    var target = e.target;
    var $el = $(target);
    if(!$el.is(":submit,input:image")) {
      var t = $el.closest(":submit");
      if(t.length === 0) {
        return
      }
      target = t[0]
    }
    var form = this;
    form.clk = target;
    if(target.type == "image") {
      if(e.offsetX !== undefined) {
        form.clk_x = e.offsetX;
        form.clk_y = e.offsetY
      }else {
        if(typeof $.fn.offset == "function") {
          var offset = $el.offset();
          form.clk_x = e.pageX - offset.left;
          form.clk_y = e.pageY - offset.top
        }else {
          form.clk_x = e.pageX - target.offsetLeft;
          form.clk_y = e.pageY - target.offsetTop
        }
      }
    }
    setTimeout(function() {
      form.clk = form.clk_x = form.clk_y = null
    }, 100)
  }
  $.fn.ajaxFormUnbind = function() {
    return this.unbind("submit.form-plugin click.form-plugin")
  };
  $.fn.formToArray = function(semantic, elements) {
    var a = [];
    if(this.length === 0) {
      return a
    }
    var form = this[0];
    var els = semantic ? form.getElementsByTagName("*") : form.elements;
    if(!els) {
      return a
    }
    var i, j, n, v, el, max, jmax;
    for(i = 0, max = els.length;i < max;i++) {
      el = els[i];
      n = el.name;
      if(!n) {
        continue
      }
      if(semantic && form.clk && el.type == "image") {
        if(!el.disabled && form.clk == el) {
          a.push({name:n, value:$(el).val(), type:el.type});
          a.push({name:n + ".x", value:form.clk_x}, {name:n + ".y", value:form.clk_y})
        }
        continue
      }
      v = $.fieldValue(el, true);
      if(v && v.constructor == Array) {
        if(elements) {
          elements.push(el)
        }
        for(j = 0, jmax = v.length;j < jmax;j++) {
          a.push({name:n, value:v[j]})
        }
      }else {
        if(feature.fileapi && el.type == "file" && !el.disabled) {
          if(elements) {
            elements.push(el)
          }
          var files = el.files;
          if(files.length) {
            for(j = 0;j < files.length;j++) {
              a.push({name:n, value:files[j], type:el.type})
            }
          }else {
            a.push({name:n, value:"", type:el.type})
          }
        }else {
          if(v !== null && typeof v != "undefined") {
            if(elements) {
              elements.push(el)
            }
            a.push({name:n, value:v, type:el.type, required:el.required})
          }
        }
      }
    }
    if(!semantic && form.clk) {
      var $input = $(form.clk), input = $input[0];
      n = input.name;
      if(n && !input.disabled && input.type == "image") {
        a.push({name:n, value:$input.val()});
        a.push({name:n + ".x", value:form.clk_x}, {name:n + ".y", value:form.clk_y})
      }
    }
    return a
  };
  $.fn.formSerialize = function(semantic) {
    return $.param(this.formToArray(semantic))
  };
  $.fn.fieldSerialize = function(successful) {
    var a = [];
    this.each(function() {
      var n = this.name;
      if(!n) {
        return
      }
      var v = $.fieldValue(this, successful);
      if(v && v.constructor == Array) {
        for(var i = 0, max = v.length;i < max;i++) {
          a.push({name:n, value:v[i]})
        }
      }else {
        if(v !== null && typeof v != "undefined") {
          a.push({name:this.name, value:v})
        }
      }
    });
    return $.param(a)
  };
  $.fn.fieldValue = function(successful) {
    for(var val = [], i = 0, max = this.length;i < max;i++) {
      var el = this[i];
      var v = $.fieldValue(el, successful);
      if(v === null || typeof v == "undefined" || v.constructor == Array && !v.length) {
        continue
      }
      if(v.constructor == Array) {
        $.merge(val, v)
      }else {
        val.push(v)
      }
    }
    return val
  };
  $.fieldValue = function(el, successful) {
    var n = el.name, t = el.type, tag = el.tagName.toLowerCase();
    if(successful === undefined) {
      successful = true
    }
    if(successful && (!n || el.disabled || t == "reset" || t == "button" || (t == "checkbox" || t == "radio") && !el.checked || (t == "submit" || t == "image") && el.form && el.form.clk != el || tag == "select" && el.selectedIndex == -1)) {
      return null
    }
    if(tag == "select") {
      var index = el.selectedIndex;
      if(index < 0) {
        return null
      }
      var a = [], ops = el.options;
      var one = t == "select-one";
      var max = one ? index + 1 : ops.length;
      for(var i = one ? index : 0;i < max;i++) {
        var op = ops[i];
        if(op.selected) {
          var v = op.value;
          if(!v) {
            v = op.attributes && op.attributes["value"] && !op.attributes["value"].specified ? op.text : op.value
          }
          if(one) {
            return v
          }
          a.push(v)
        }
      }
      return a
    }
    return $(el).val()
  };
  $.fn.clearForm = function(includeHidden) {
    return this.each(function() {
      $("input,select,textarea", this).clearFields(includeHidden)
    })
  };
  $.fn.clearFields = $.fn.clearInputs = function(includeHidden) {
    var re = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
    return this.each(function() {
      var t = this.type, tag = this.tagName.toLowerCase();
      if(re.test(t) || tag == "textarea") {
        this.value = ""
      }else {
        if(t == "checkbox" || t == "radio") {
          this.checked = false
        }else {
          if(tag == "select") {
            this.selectedIndex = -1
          }else {
            if(includeHidden) {
              if(includeHidden === true && /hidden/.test(t) || typeof includeHidden == "string" && $(this).is(includeHidden)) {
                this.value = ""
              }
            }
          }
        }
      }
    })
  };
  $.fn.resetForm = function() {
    return this.each(function() {
      if(typeof this.reset == "function" || typeof this.reset == "object" && !this.reset.nodeType) {
        this.reset()
      }
    })
  };
  $.fn.enable = function(b) {
    if(b === undefined) {
      b = true
    }
    return this.each(function() {
      this.disabled = !b
    })
  };
  $.fn.selected = function(select) {
    if(select === undefined) {
      select = true
    }
    return this.each(function() {
      var t = this.type;
      if(t == "checkbox" || t == "radio") {
        this.checked = select
      }else {
        if(this.tagName.toLowerCase() == "option") {
          var $sel = $(this).parent("select");
          if(select && $sel[0] && $sel[0].type == "select-one") {
            $sel.find("option").selected(false)
          }
          this.selected = select
        }
      }
    })
  };
  $.fn.ajaxSubmit.debug = false;
  function log() {
    if(!$.fn.ajaxSubmit.debug) {
      return
    }
    var msg = "[jquery.form] " + Array.prototype.join.call(arguments, "");
    if(window.console && window.console.log) {
      window.console.log(msg)
    }else {
      if(window.opera && window.opera.postError) {
        window.opera.postError(msg)
      }
    }
  }
})(jQuery);
(function($) {
  $.fn.joyride = function(options) {
    var settings = {"tipLocation":"bottom", "scrollSpeed":300, "timer":0, "startTimerOnClick":false, "nextButton":true, "tipAnimation":"fade", "tipAnimationFadeSpeed":300, "cookieMonster":false, "cookieName":"JoyRide", "cookieDomain":false, "tipContainer":"body", "inline":false, "tipContent":"#joyRideTipContent", "postRideCallback":$.noop, "postStepCallback":$.noop};
    var options = $.extend(settings, options);
    return this.each(function() {
      if($(options.tipContent).length === 0) {
        return
      }
      $(options.tipContent).hide();
      var bodyOffset = $(options.tipContainer).children("*").first().position(), tipContent = $(options.tipContent + " li"), count = skipCount = 0, prevCount = -1, timerIndicatorInstance, timerIndicatorTemplate = '<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>';
      var tipTemplate = function(tipClass, index, buttonText, self) {
        return'<div class="joyride-tip-guide ' + tipClass + '" id="joyRidePopup' + index + '"><span class="joyride-nub"></span><div class="joyride-content-wrapper">' + $(self).html() + buttonText + '<a href="#close" class="joyride-close-tip"></a>' + timerIndicatorInstance + "</div></div>"
      };
      var tipLayout = function(tipClass, index, buttonText, self) {
        if(index == 0 && settings.startTimerOnClick && settings.timer > 0 || settings.timer == 0) {
          timerIndicatorInstance = ""
        }else {
          timerIndicatorInstance = timerIndicatorTemplate
        }
        if(!tipClass) {
          tipClass = ""
        }
        if(buttonText) {
          buttonText = '<a href="#" class="joyride-next-tip small nice radius yellow button">' + buttonText + "</a>"
        }else {
          buttonText = ""
        }
        if(settings.inline) {
          $(tipTemplate(tipClass, index, buttonText, self)).insertAfter("#" + $(self).data("id"))
        }else {
          $(options.tipContainer).append(tipTemplate(tipClass, index, buttonText, self))
        }
      };
      if(!settings.cookieMonster || !$.cookie(settings.cookieName)) {
        tipContent.each(function(index) {
          var buttonText = $(this).data("text"), tipClass = $(this).attr("class"), self = this;
          if(settings.nextButton && !buttonText) {
            buttonText = "Next"
          }
          if(settings.nextButton || !settings.nextButton && settings.startTimerOnClick) {
            if($(this).attr("class")) {
              tipLayout(tipClass, index, buttonText, self)
            }else {
              tipLayout(false, index, buttonText, self)
            }
          }else {
            if(!settings.nextButton) {
              if($(this).attr("class")) {
                tipLayout(tipClass, index, "", self)
              }else {
                tipLayout(false, index, "", self)
              }
            }
          }
          $("#joyRidePopup" + index).hide()
        })
      }
      showNextTip = function() {
        var parentElementID = $(tipContent[count]).data("id"), parentElement = $("#" + parentElementID), opt = {};
        $.each(($(tipContent[count]).data("options") || ":").split(";"), function(i, s) {
          var p = s.split(":");
          if(p.length == 2) {
            opt[$.trim(p[0])] = $.trim(p[1])
          }
        });
        var tipSettings = $.extend({}, settings, opt);
        while(parentElement.offset() === null) {
          count++;
          skipCount++;
          if(tipContent.length - 1 > prevCount) {
            prevCount++
          }
          parentElementID = $(tipContent[count]).data("id"), parentElement = $("#" + parentElementID);
          if($(tipContent).length < count) {
            break
          }
        }
        var windowHalf = Math.ceil($(window).height() / 2), currentTip = $("#joyRidePopup" + count), currentTipPosition = parentElement.offset(), currentParentHeight = parentElement.outerHeight(), currentTipHeight = currentTip.outerHeight(), nubHeight = Math.ceil($(".joyride-nub").outerHeight() / 2), tipOffset = 0;
        if(currentTip.length === 0) {
          return
        }
        if(count < tipContent.length) {
          if(settings.tipAnimation == "pop") {
            $(".joyride-timer-indicator").width(0);
            if(settings.timer > 0) {
              currentTip.show().children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:$(".joyride-timer-indicator-wrap").width()}, settings.timer)
            }else {
              currentTip.show()
            }
          }else {
            if(settings.tipAnimation == "fade") {
              $(".joyride-timer-indicator").width(0);
              if(settings.timer > 0) {
                currentTip.fadeIn(settings.tipAnimationFadeSpeed).children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:$(".joyride-timer-indicator-wrap").width()}, settings.timer)
              }else {
                currentTip.fadeIn(settings.tipAnimationFadeSpeed)
              }
            }
          }
          var nub = currentTip.children(".joyride-nub");
          var left = currentTipPosition.left - bodyOffset.left;
          nub.removeClass("bottom").removeClass("top").removeClass("right");
          if($(window).scrollLeft() + $(window).width() < left + currentTip.width()) {
            left -= currentTip.width() - nub.offset().left * 2;
            nub.addClass("right")
          }
          if(Modernizr.mq("only screen and (max-width: 769px)")) {
            if(tipSettings.tipLocation.indexOf("top") != -1) {
              if(currentTipHeight >= currentTipPosition.top) {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight - bodyOffset.top});
                nub.addClass("top").css({left:left})
              }else {
                currentTip.offset({top:currentTipPosition.top - (currentTipHeight + bodyOffset.top + nubHeight)});
                nub.addClass("bottom").css({left:left})
              }
            }else {
              currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight});
              nub.addClass("top").css({left:left})
            }
          }else {
            if(tipSettings.tipLocation == "top") {
              if(currentTipHeight >= currentTipPosition.top) {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight - bodyOffset.top, left:left});
                nub.addClass("top")
              }else {
                currentTip.offset({top:currentTipPosition.top - (currentTipHeight + bodyOffset.top + nubHeight), left:left});
                nub.addClass("bottom")
              }
            }else {
              if(tipSettings.tipLocation == "bottom") {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:left});
                nub.addClass("top")
              }
            }
          }
          if(tipSettings.tipLocation.indexOf("right") != -1) {
            currentTip.offset({left:currentTipPosition.left - bodyOffset.left - currentTip.width() + parentElement.width()});
            currentTip.children(".joyride-nub").addClass("right")
          }
          tipOffset = Math.ceil(currentTip.offset().top - windowHalf);
          $("html, body").animate({scrollTop:tipOffset}, settings.scrollSpeed);
          if(count > 0) {
            if(skipCount > 0) {
              var hideCount = prevCount - skipCount;
              skipCount = 0
            }else {
              var hideCount = prevCount
            }
            if(settings.tipAnimation == "pop") {
              $("#joyRidePopup" + hideCount).hide()
            }else {
              if(settings.tipAnimation == "fade") {
                $("#joyRidePopup" + hideCount).fadeOut(settings.tipAnimationFadeSpeed)
              }
            }
          }
        }else {
          if(tipContent.length - 1 < count) {
            var hideCnt;
            if(skipCount > 0) {
              hideCount = prevCount - skipCount;
              skipCount = 0
            }else {
              hideCount = prevCount
            }
            if(settings.cookieMonster == true) {
              $.cookie(settings.cookieName, "ridden", {expires:365, domain:settings.cookieDomain})
            }
            if(settings.tipAnimation == "pop") {
              $("#joyRidePopup" + hideCount).fadeTo(0, 0)
            }else {
              if(settings.tipAnimation == "fade") {
                $("#joyRidePopup" + hideCount).fadeTo(settings.tipAnimationFadeSpeed, 0)
              }
            }
          }
        }
        count++;
        if(prevCount < 0) {
          prevCount = 0
        }else {
          if(tipContent.length - 1 > prevCount) {
            prevCount++
          }
        }
        if(settings.postStepCallback != $.noop) {
          settings.postStepCallback(prevCount)
        }
      };
      if(!settings.inline || !settings.cookieMonster || !$.cookie(settings.cookieName)) {
        $(window).resize(function() {
          var parentElementID = $(tipContent[prevCount]).data("id"), currentTipPosition = $("#" + parentElementID).offset(), currentParentHeight = $("#" + parentElementID).outerHeight(), currentTipHeight = $("#joyRidePopup" + prevCount).outerHeight(), nubHeight = Math.ceil($(".joyride-nub").outerHeight() / 2);
          if(Modernizr.mq("only screen and (max-width: 769px)")) {
            if(settings.tipLocation == "bottom") {
              $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:0});
              $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:currentTipPosition.left - bodyOffset.left})
            }else {
              if(settings.tipLocation == "top") {
                if(currentTipPosition.top <= currentTipHeight) {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + nubHeight + currentParentHeight, left:0});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:currentTipPosition.left - bodyOffset.left})
                }else {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top - (currentTipHeight + nubHeight), left:0});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:currentTipPosition.left - bodyOffset.left})
                }
              }
            }
          }else {
            if(settings.tipLocation == "bottom") {
              $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:currentTipPosition.left});
              $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})
            }else {
              if(settings.tipLocation == "top") {
                if(currentTipPosition.top <= currentTipHeight) {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + nubHeight + currentParentHeight, left:currentTipPosition.left});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})
                }else {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top - (currentTipHeight + nubHeight), left:currentTipPosition.left});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:""})
                }
              }
            }
          }
        })
      }
      var interval_id = null, showTimerState = false;
      if(!settings.startTimerOnClick && settings.timer > 0) {
        showNextTip();
        interval_id = setInterval(function() {
          showNextTip()
        }, settings.timer)
      }else {
        showNextTip()
      }
      var endTip = function(e, interval_id, cookie, self) {
        e.preventDefault();
        clearInterval(interval_id);
        if(cookie) {
          $.cookie(settings.cookieName, "ridden", {expires:365, domain:settings.cookieDomain})
        }
        $(self).parent().parent().hide();
        if(settings.postRideCallback != $.noop) {
          settings.postRideCallback()
        }
      };
      $(".joyride-close-tip").click(function(e) {
        endTip(e, interval_id, settings.cookieMonster, this)
      });
      $(".joyride-next-tip").click(function(e) {
        e.preventDefault();
        if(count >= tipContent.length) {
          endTip(e, interval_id, settings.cookieMonster, this)
        }
        if(settings.timer > 0 && settings.startTimerOnClick) {
          showNextTip();
          clearInterval(interval_id);
          interval_id = setInterval(function() {
            showNextTip()
          }, settings.timer)
        }else {
          if(settings.timer > 0 && !settings.startTimerOnClick) {
            clearInterval(interval_id);
            interval_id = setInterval(function() {
              showNextTip()
            }, settings.timer)
          }else {
            showNextTip()
          }
        }
      })
    })
  }
})(jQuery);
(function(d) {
  function g(a) {
    var b = a || window.event, i = [].slice.call(arguments, 1), c = 0, h = 0, e = 0;
    a = d.event.fix(b);
    a.type = "mousewheel";
    if(a.wheelDelta) {
      c = a.wheelDelta / 120
    }
    if(a.detail) {
      c = -a.detail / 3
    }
    e = c;
    if(b.axis !== undefined && b.axis === b.HORIZONTAL_AXIS) {
      e = 0;
      h = -1 * c
    }
    if(b.wheelDeltaY !== undefined) {
      e = b.wheelDeltaY / 120
    }
    if(b.wheelDeltaX !== undefined) {
      h = -1 * b.wheelDeltaX / 120
    }
    i.unshift(a, c, h, e);
    return d.event.handle.apply(this, i)
  }
  var f = ["DOMMouseScroll", "mousewheel"];
  d.event.special.mousewheel = {setup:function() {
    if(this.addEventListener) {
      for(var a = f.length;a;) {
        this.addEventListener(f[--a], g, false)
      }
    }else {
      this.onmousewheel = g
    }
  }, teardown:function() {
    if(this.removeEventListener) {
      for(var a = f.length;a;) {
        this.removeEventListener(f[--a], g, false)
      }
    }else {
      this.onmousewheel = null
    }
  }};
  d.fn.extend({mousewheel:function(a) {
    return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
  }, unmousewheel:function(a) {
    return this.unbind("mousewheel", a)
  }})
})(jQuery);
(function(r) {
  r.fn.qrcode = function(h) {
    var s;
    function u(a) {
      this.mode = s;
      this.data = a
    }
    function o(a, c) {
      this.typeNumber = a;
      this.errorCorrectLevel = c;
      this.modules = null;
      this.moduleCount = 0;
      this.dataCache = null;
      this.dataList = []
    }
    function q(a, c) {
      if(void 0 == a.length) {
        throw Error(a.length + "/" + c);
      }
      for(var d = 0;d < a.length && 0 == a[d];) {
        d++
      }
      this.num = Array(a.length - d + c);
      for(var b = 0;b < a.length - d;b++) {
        this.num[b] = a[b + d]
      }
    }
    function p(a, c) {
      this.totalCount = a;
      this.dataCount = c
    }
    function t() {
      this.buffer = [];
      this.length = 0
    }
    u.prototype = {getLength:function() {
      return this.data.length
    }, write:function(a) {
      for(var c = 0;c < this.data.length;c++) {
        a.put(this.data.charCodeAt(c), 8)
      }
    }};
    o.prototype = {addData:function(a) {
      this.dataList.push(new u(a));
      this.dataCache = null
    }, isDark:function(a, c) {
      if(0 > a || this.moduleCount <= a || 0 > c || this.moduleCount <= c) {
        throw Error(a + "," + c);
      }
      return this.modules[a][c]
    }, getModuleCount:function() {
      return this.moduleCount
    }, make:function() {
      if(1 > this.typeNumber) {
        for(var a = 1, a = 1;40 > a;a++) {
          for(var c = p.getRSBlocks(a, this.errorCorrectLevel), d = new t, b = 0, e = 0;e < c.length;e++) {
            b += c[e].dataCount
          }
          for(e = 0;e < this.dataList.length;e++) {
            c = this.dataList[e], d.put(c.mode, 4), d.put(c.getLength(), j.getLengthInBits(c.mode, a)), c.write(d)
          }
          if(d.getLengthInBits() <= 8 * b) {
            break
          }
        }
        this.typeNumber = a
      }
      this.makeImpl(!1, this.getBestMaskPattern())
    }, makeImpl:function(a, c) {
      this.moduleCount = 4 * this.typeNumber + 17;
      this.modules = Array(this.moduleCount);
      for(var d = 0;d < this.moduleCount;d++) {
        this.modules[d] = Array(this.moduleCount);
        for(var b = 0;b < this.moduleCount;b++) {
          this.modules[d][b] = null
        }
      }
      this.setupPositionProbePattern(0, 0);
      this.setupPositionProbePattern(this.moduleCount - 7, 0);
      this.setupPositionProbePattern(0, this.moduleCount - 7);
      this.setupPositionAdjustPattern();
      this.setupTimingPattern();
      this.setupTypeInfo(a, c);
      7 <= this.typeNumber && this.setupTypeNumber(a);
      null == this.dataCache && (this.dataCache = o.createData(this.typeNumber, this.errorCorrectLevel, this.dataList));
      this.mapData(this.dataCache, c)
    }, setupPositionProbePattern:function(a, c) {
      for(var d = -1;7 >= d;d++) {
        if(!(-1 >= a + d || this.moduleCount <= a + d)) {
          for(var b = -1;7 >= b;b++) {
            -1 >= c + b || this.moduleCount <= c + b || (this.modules[a + d][c + b] = 0 <= d && 6 >= d && (0 == b || 6 == b) || 0 <= b && 6 >= b && (0 == d || 6 == d) || 2 <= d && 4 >= d && 2 <= b && 4 >= b ? !0 : !1)
          }
        }
      }
    }, getBestMaskPattern:function() {
      for(var a = 0, c = 0, d = 0;8 > d;d++) {
        this.makeImpl(!0, d);
        var b = j.getLostPoint(this);
        if(0 == d || a > b) {
          a = b, c = d
        }
      }
      return c
    }, createMovieClip:function(a, c, d) {
      a = a.createEmptyMovieClip(c, d);
      this.make();
      for(c = 0;c < this.modules.length;c++) {
        for(var d = 1 * c, b = 0;b < this.modules[c].length;b++) {
          var e = 1 * b;
          this.modules[c][b] && (a.beginFill(0, 100), a.moveTo(e, d), a.lineTo(e + 1, d), a.lineTo(e + 1, d + 1), a.lineTo(e, d + 1), a.endFill())
        }
      }
      return a
    }, setupTimingPattern:function() {
      for(var a = 8;a < this.moduleCount - 8;a++) {
        null == this.modules[a][6] && (this.modules[a][6] = 0 == a % 2)
      }
      for(a = 8;a < this.moduleCount - 8;a++) {
        null == this.modules[6][a] && (this.modules[6][a] = 0 == a % 2)
      }
    }, setupPositionAdjustPattern:function() {
      for(var a = j.getPatternPosition(this.typeNumber), c = 0;c < a.length;c++) {
        for(var d = 0;d < a.length;d++) {
          var b = a[c], e = a[d];
          if(null == this.modules[b][e]) {
            for(var f = -2;2 >= f;f++) {
              for(var i = -2;2 >= i;i++) {
                this.modules[b + f][e + i] = -2 == f || 2 == f || -2 == i || 2 == i || 0 == f && 0 == i ? !0 : !1
              }
            }
          }
        }
      }
    }, setupTypeNumber:function(a) {
      for(var c = j.getBCHTypeNumber(this.typeNumber), d = 0;18 > d;d++) {
        var b = !a && 1 == (c >> d & 1);
        this.modules[Math.floor(d / 3)][d % 3 + this.moduleCount - 8 - 3] = b
      }
      for(d = 0;18 > d;d++) {
        b = !a && 1 == (c >> d & 1), this.modules[d % 3 + this.moduleCount - 8 - 3][Math.floor(d / 3)] = b
      }
    }, setupTypeInfo:function(a, c) {
      for(var d = j.getBCHTypeInfo(this.errorCorrectLevel << 3 | c), b = 0;15 > b;b++) {
        var e = !a && 1 == (d >> b & 1);
        6 > b ? this.modules[b][8] = e : 8 > b ? this.modules[b + 1][8] = e : this.modules[this.moduleCount - 15 + b][8] = e
      }
      for(b = 0;15 > b;b++) {
        e = !a && 1 == (d >> b & 1), 8 > b ? this.modules[8][this.moduleCount - b - 1] = e : 9 > b ? this.modules[8][15 - b - 1 + 1] = e : this.modules[8][15 - b - 1] = e
      }
      this.modules[this.moduleCount - 8][8] = !a
    }, mapData:function(a, c) {
      for(var d = -1, b = this.moduleCount - 1, e = 7, f = 0, i = this.moduleCount - 1;0 < i;i -= 2) {
        for(6 == i && i--;;) {
          for(var g = 0;2 > g;g++) {
            if(null == this.modules[b][i - g]) {
              var n = !1;
              f < a.length && (n = 1 == (a[f] >>> e & 1));
              j.getMask(c, b, i - g) && (n = !n);
              this.modules[b][i - g] = n;
              e--;
               -1 == e && (f++, e = 7)
            }
          }
          b += d;
          if(0 > b || this.moduleCount <= b) {
            b -= d;
            d = -d;
            break
          }
        }
      }
    }};
    o.PAD0 = 236;
    o.PAD1 = 17;
    o.createData = function(a, c, d) {
      for(var c = p.getRSBlocks(a, c), b = new t, e = 0;e < d.length;e++) {
        var f = d[e];
        b.put(f.mode, 4);
        b.put(f.getLength(), j.getLengthInBits(f.mode, a));
        f.write(b)
      }
      for(e = a = 0;e < c.length;e++) {
        a += c[e].dataCount
      }
      if(b.getLengthInBits() > 8 * a) {
        throw Error("code length overflow. (" + b.getLengthInBits() + ">" + 8 * a + ")");
      }
      for(b.getLengthInBits() + 4 <= 8 * a && b.put(0, 4);0 != b.getLengthInBits() % 8;) {
        b.putBit(!1)
      }
      for(;!(b.getLengthInBits() >= 8 * a);) {
        b.put(o.PAD0, 8);
        if(b.getLengthInBits() >= 8 * a) {
          break
        }
        b.put(o.PAD1, 8)
      }
      return o.createBytes(b, c)
    };
    o.createBytes = function(a, c) {
      for(var d = 0, b = 0, e = 0, f = Array(c.length), i = Array(c.length), g = 0;g < c.length;g++) {
        var n = c[g].dataCount, h = c[g].totalCount - n, b = Math.max(b, n), e = Math.max(e, h);
        f[g] = Array(n);
        for(var k = 0;k < f[g].length;k++) {
          f[g][k] = 255 & a.buffer[k + d]
        }
        d += n;
        k = j.getErrorCorrectPolynomial(h);
        n = (new q(f[g], k.getLength() - 1)).mod(k);
        i[g] = Array(k.getLength() - 1);
        for(k = 0;k < i[g].length;k++) {
          h = k + n.getLength() - i[g].length, i[g][k] = 0 <= h ? n.get(h) : 0
        }
      }
      for(k = g = 0;k < c.length;k++) {
        g += c[k].totalCount
      }
      d = Array(g);
      for(k = n = 0;k < b;k++) {
        for(g = 0;g < c.length;g++) {
          k < f[g].length && (d[n++] = f[g][k])
        }
      }
      for(k = 0;k < e;k++) {
        for(g = 0;g < c.length;g++) {
          k < i[g].length && (d[n++] = i[g][k])
        }
      }
      return d
    };
    s = 4;
    for(var j = {PATTERN_POSITION_TABLE:[[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], 
    [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]], G15:1335, G18:7973, G15_MASK:21522, getBCHTypeInfo:function(a) {
      for(var c = a << 10;0 <= j.getBCHDigit(c) - j.getBCHDigit(j.G15);) {
        c ^= j.G15 << j.getBCHDigit(c) - j.getBCHDigit(j.G15)
      }
      return(a << 10 | c) ^ j.G15_MASK
    }, getBCHTypeNumber:function(a) {
      for(var c = a << 12;0 <= j.getBCHDigit(c) - j.getBCHDigit(j.G18);) {
        c ^= j.G18 << j.getBCHDigit(c) - j.getBCHDigit(j.G18)
      }
      return a << 12 | c
    }, getBCHDigit:function(a) {
      for(var c = 0;0 != a;) {
        c++, a >>>= 1
      }
      return c
    }, getPatternPosition:function(a) {
      return j.PATTERN_POSITION_TABLE[a - 1]
    }, getMask:function(a, c, d) {
      switch(a) {
        case 0:
          return 0 == (c + d) % 2;
        case 1:
          return 0 == c % 2;
        case 2:
          return 0 == d % 3;
        case 3:
          return 0 == (c + d) % 3;
        case 4:
          return 0 == (Math.floor(c / 2) + Math.floor(d / 3)) % 2;
        case 5:
          return 0 == c * d % 2 + c * d % 3;
        case 6:
          return 0 == (c * d % 2 + c * d % 3) % 2;
        case 7:
          return 0 == (c * d % 3 + (c + d) % 2) % 2;
        default:
          throw Error("bad maskPattern:" + a);
      }
    }, getErrorCorrectPolynomial:function(a) {
      for(var c = new q([1], 0), d = 0;d < a;d++) {
        c = c.multiply(new q([1, l.gexp(d)], 0))
      }
      return c
    }, getLengthInBits:function(a, c) {
      if(1 <= c && 10 > c) {
        switch(a) {
          case 1:
            return 10;
          case 2:
            return 9;
          case s:
            return 8;
          case 8:
            return 8;
          default:
            throw Error("mode:" + a);
        }
      }else {
        if(27 > c) {
          switch(a) {
            case 1:
              return 12;
            case 2:
              return 11;
            case s:
              return 16;
            case 8:
              return 10;
            default:
              throw Error("mode:" + a);
          }
        }else {
          if(41 > c) {
            switch(a) {
              case 1:
                return 14;
              case 2:
                return 13;
              case s:
                return 16;
              case 8:
                return 12;
              default:
                throw Error("mode:" + a);
            }
          }else {
            throw Error("type:" + c);
          }
        }
      }
    }, getLostPoint:function(a) {
      for(var c = a.getModuleCount(), d = 0, b = 0;b < c;b++) {
        for(var e = 0;e < c;e++) {
          for(var f = 0, i = a.isDark(b, e), g = -1;1 >= g;g++) {
            if(!(0 > b + g || c <= b + g)) {
              for(var h = -1;1 >= h;h++) {
                0 > e + h || c <= e + h || 0 == g && 0 == h || i == a.isDark(b + g, e + h) && f++
              }
            }
          }
          5 < f && (d += 3 + f - 5)
        }
      }
      for(b = 0;b < c - 1;b++) {
        for(e = 0;e < c - 1;e++) {
          if(f = 0, a.isDark(b, e) && f++, a.isDark(b + 1, e) && f++, a.isDark(b, e + 1) && f++, a.isDark(b + 1, e + 1) && f++, 0 == f || 4 == f) {
            d += 3
          }
        }
      }
      for(b = 0;b < c;b++) {
        for(e = 0;e < c - 6;e++) {
          a.isDark(b, e) && !a.isDark(b, e + 1) && a.isDark(b, e + 2) && a.isDark(b, e + 3) && a.isDark(b, e + 4) && !a.isDark(b, e + 5) && a.isDark(b, e + 6) && (d += 40)
        }
      }
      for(e = 0;e < c;e++) {
        for(b = 0;b < c - 6;b++) {
          a.isDark(b, e) && !a.isDark(b + 1, e) && a.isDark(b + 2, e) && a.isDark(b + 3, e) && a.isDark(b + 4, e) && !a.isDark(b + 5, e) && a.isDark(b + 6, e) && (d += 40)
        }
      }
      for(e = f = 0;e < c;e++) {
        for(b = 0;b < c;b++) {
          a.isDark(b, e) && f++
        }
      }
      a = Math.abs(100 * f / c / c - 50) / 5;
      return d + 10 * a
    }}, l = {glog:function(a) {
      if(1 > a) {
        throw Error("glog(" + a + ")");
      }
      return l.LOG_TABLE[a]
    }, gexp:function(a) {
      for(;0 > a;) {
        a += 255
      }
      for(;256 <= a;) {
        a -= 255
      }
      return l.EXP_TABLE[a]
    }, EXP_TABLE:Array(256), LOG_TABLE:Array(256)}, m = 0;8 > m;m++) {
      l.EXP_TABLE[m] = 1 << m
    }
    for(m = 8;256 > m;m++) {
      l.EXP_TABLE[m] = l.EXP_TABLE[m - 4] ^ l.EXP_TABLE[m - 5] ^ l.EXP_TABLE[m - 6] ^ l.EXP_TABLE[m - 8]
    }
    for(m = 0;255 > m;m++) {
      l.LOG_TABLE[l.EXP_TABLE[m]] = m
    }
    q.prototype = {get:function(a) {
      return this.num[a]
    }, getLength:function() {
      return this.num.length
    }, multiply:function(a) {
      for(var c = Array(this.getLength() + a.getLength() - 1), d = 0;d < this.getLength();d++) {
        for(var b = 0;b < a.getLength();b++) {
          c[d + b] ^= l.gexp(l.glog(this.get(d)) + l.glog(a.get(b)))
        }
      }
      return new q(c, 0)
    }, mod:function(a) {
      if(0 > this.getLength() - a.getLength()) {
        return this
      }
      for(var c = l.glog(this.get(0)) - l.glog(a.get(0)), d = Array(this.getLength()), b = 0;b < this.getLength();b++) {
        d[b] = this.get(b)
      }
      for(b = 0;b < a.getLength();b++) {
        d[b] ^= l.gexp(l.glog(a.get(b)) + c)
      }
      return(new q(d, 0)).mod(a)
    }};
    p.RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 
    14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 116], 
    [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], [3, 
    70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 
    74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 
    117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 
    145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], 
    [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]];
    p.getRSBlocks = function(a, c) {
      var d = p.getRsBlockTable(a, c);
      if(void 0 == d) {
        throw Error("bad rs block @ typeNumber:" + a + "/errorCorrectLevel:" + c);
      }
      for(var b = d.length / 3, e = [], f = 0;f < b;f++) {
        for(var h = d[3 * f + 0], g = d[3 * f + 1], j = d[3 * f + 2], l = 0;l < h;l++) {
          e.push(new p(g, j))
        }
      }
      return e
    };
    p.getRsBlockTable = function(a, c) {
      switch(c) {
        case 1:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 0];
        case 0:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 1];
        case 3:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 2];
        case 2:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 3]
      }
    };
    t.prototype = {get:function(a) {
      return 1 == (this.buffer[Math.floor(a / 8)] >>> 7 - a % 8 & 1)
    }, put:function(a, c) {
      for(var d = 0;d < c;d++) {
        this.putBit(1 == (a >>> c - d - 1 & 1))
      }
    }, getLengthInBits:function() {
      return this.length
    }, putBit:function(a) {
      var c = Math.floor(this.length / 8);
      this.buffer.length <= c && this.buffer.push(0);
      a && (this.buffer[c] |= 128 >>> this.length % 8);
      this.length++
    }};
    "string" === typeof h && (h = {text:h});
    h = r.extend({}, {render:"canvas", width:256, height:256, typeNumber:-1, correctLevel:2, background:"#ffffff", foreground:"#000000"}, h);
    return this.each(function() {
      var a;
      if("canvas" == h.render) {
        a = new o(h.typeNumber, h.correctLevel);
        a.addData(h.text);
        a.make();
        var c = document.createElement("canvas");
        c.width = h.width;
        c.height = h.height;
        for(var d = c.getContext("2d"), b = h.width / a.getModuleCount(), e = h.height / a.getModuleCount(), f = 0;f < a.getModuleCount();f++) {
          for(var i = 0;i < a.getModuleCount();i++) {
            d.fillStyle = a.isDark(f, i) ? h.foreground : h.background;
            var g = Math.ceil((i + 1) * b) - Math.floor(i * b), j = Math.ceil((f + 1) * b) - Math.floor(f * b);
            d.fillRect(Math.round(i * b), Math.round(f * e), g, j)
          }
        }
      }else {
        a = new o(h.typeNumber, h.correctLevel);
        a.addData(h.text);
        a.make();
        c = r("<table></table>").css("width", h.width + "px").css("height", h.height + "px").css("border", "0px").css("border-collapse", "collapse").css("background-color", h.background);
        d = h.width / a.getModuleCount();
        b = h.height / a.getModuleCount();
        for(e = 0;e < a.getModuleCount();e++) {
          f = r("<tr></tr>").css("height", b + "px").appendTo(c);
          for(i = 0;i < a.getModuleCount();i++) {
            r("<td></td>").css("width", d + "px").css("background-color", a.isDark(e, i) ? h.foreground : h.background).appendTo(f)
          }
        }
      }
      a = c;
      jQuery(a).appendTo(this)
    })
  }
})(jQuery);
var Hashtable = function() {
  function c(b) {
    var d;
    if(typeof b == "string") {
      return b
    }
    if(typeof b.hashCode == a) {
      return d = b.hashCode(), typeof d == "string" ? d : c(d)
    }
    if(typeof b.toString == a) {
      return b.toString()
    }
    try {
      return String(b)
    }catch(e) {
      return Object.prototype.toString.call(b)
    }
  }
  function d(a, b) {
    return a.equals(b)
  }
  function e(b, c) {
    return typeof c.equals == a ? c.equals(b) : b === c
  }
  function f(a) {
    return function(b) {
      if(b === null) {
        throw new Error("null is not a valid " + a);
      }
      if(typeof b == "undefined") {
        throw new Error(a + " must not be undefined");
      }
    }
  }
  function i(a, b, c, d) {
    this[0] = a, this.entries = [], this.addEntry(b, c), d !== null && (this.getEqualityFunction = function() {
      return d
    })
  }
  function m(a) {
    return function(b) {
      var c = this.entries.length, d, e = this.getEqualityFunction(b);
      while(c--) {
        d = this.entries[c];
        if(e(b, d[0])) {
          switch(a) {
            case j:
              return!0;
            case k:
              return d;
            case l:
              return[c, d[1]]
          }
        }
      }
      return!1
    }
  }
  function n(a) {
    return function(b) {
      var c = b.length;
      for(var d = 0, e = this.entries.length;d < e;++d) {
        b[c + d] = this.entries[d][a]
      }
    }
  }
  function o(a, b) {
    var c = a.length, d;
    while(c--) {
      d = a[c];
      if(b === d[0]) {
        return c
      }
    }
    return null
  }
  function p(a, b) {
    var c = a[b];
    return c && c instanceof i ? c : null
  }
  function q(d, e) {
    var f = this, j = [], k = {}, l = typeof d == a ? d : c, m = typeof e == a ? e : null;
    this.put = function(a, b) {
      g(a), h(b);
      var c = l(a), d, e, f = null;
      return d = p(k, c), d ? (e = d.getEntryForKey(a), e ? (f = e[1], e[1] = b) : d.addEntry(a, b)) : (d = new i(c, a, b, m), j[j.length] = d, k[c] = d), f
    }, this.get = function(a) {
      g(a);
      var b = l(a), c = p(k, b);
      if(c) {
        var d = c.getEntryForKey(a);
        if(d) {
          return d[1]
        }
      }
      return null
    }, this.containsKey = function(a) {
      g(a);
      var b = l(a), c = p(k, b);
      return c ? c.containsKey(a) : !1
    }, this.containsValue = function(a) {
      h(a);
      var b = j.length;
      while(b--) {
        if(j[b].containsValue(a)) {
          return!0
        }
      }
      return!1
    }, this.clear = function() {
      j.length = 0, k = {}
    }, this.isEmpty = function() {
      return!j.length
    };
    var n = function(a) {
      return function() {
        var b = [], c = j.length;
        while(c--) {
          j[c][a](b)
        }
        return b
      }
    };
    this.keys = n("keys"), this.values = n("values"), this.entries = n("getEntries"), this.remove = function(a) {
      g(a);
      var c = l(a), d, e = null, f = p(k, c);
      return f && (e = f.removeEntryForKey(a), e !== null && (f.entries.length || (d = o(j, c), b(j, d), delete k[c]))), e
    }, this.size = function() {
      var a = 0, b = j.length;
      while(b--) {
        a += j[b].entries.length
      }
      return a
    }, this.each = function(a) {
      var b = f.entries(), c = b.length, d;
      while(c--) {
        d = b[c], a(d[0], d[1])
      }
    }, this.putAll = function(b, c) {
      var d = b.entries(), e, g, h, i, j = d.length, k = typeof c == a;
      while(j--) {
        e = d[j], g = e[0], h = e[1], k && (i = f.get(g)) && (h = c(g, i, h)), f.put(g, h)
      }
    }, this.clone = function() {
      var a = new q(d, e);
      return a.putAll(f), a
    }
  }
  var a = "function", b = typeof Array.prototype.splice == a ? function(a, b) {
    a.splice(b, 1)
  } : function(a, b) {
    var c, d, e;
    if(b === a.length - 1) {
      a.length = b
    }else {
      c = a.slice(b + 1), a.length = b;
      for(d = 0, e = c.length;d < e;++d) {
        a[b + d] = c[d]
      }
    }
  }, g = f("key"), h = f("value"), j = 0, k = 1, l = 2;
  return i.prototype = {getEqualityFunction:function(b) {
    return typeof b.equals == a ? d : e
  }, getEntryForKey:m(k), getEntryAndIndexForKey:m(l), removeEntryForKey:function(a) {
    var c = this.getEntryAndIndexForKey(a);
    return c ? (b(this.entries, c[0]), c[1]) : null
  }, addEntry:function(a, b) {
    this.entries[this.entries.length] = [a, b]
  }, keys:n(0), values:n(1), getEntries:function(a) {
    var b = a.length;
    for(var c = 0, d = this.entries.length;c < d;++c) {
      a[b + c] = this.entries[c].slice(0)
    }
  }, containsKey:m(j), containsValue:function(a) {
    var b = this.entries.length;
    while(b--) {
      if(a === this.entries[b][1]) {
        return!0
      }
    }
    return!1
  }}, q
}();
(function(a) {
  function i(a, b, c) {
    this.dec = a, this.group = b, this.neg = c
  }
  function j() {
    for(var a = 0;a < h.length;a++) {
      localeGroup = h[a];
      for(var c = 0;c < localeGroup.length;c++) {
        b.put(localeGroup[c], a)
      }
    }
  }
  function k(a) {
    b.size() == 0 && j();
    var c = ".", d = ",", e = "-", f = b.get(a);
    if(f) {
      var h = g[f];
      h && (c = h[0], d = h[1])
    }
    return new i(c, d, e)
  }
  var b = new Hashtable, c = ["ae", "au", "ca", "cn", "eg", "gb", "hk", "il", "in", "jp", "sk", "th", "tw", "us"], d = ["at", "br", "de", "dk", "es", "gr", "it", "nl", "pt", "tr", "vn"], e = ["cz", "fi", "fr", "ru", "se", "pl"], f = ["ch"], g = [[".", ","], [",", "."], [",", " "], [".", "'"]], h = [c, d, e, f];
  a.fn.formatNumber = function(b, c, d) {
    return this.each(function() {
      c == null && (c = !0), d == null && (d = !0);
      var e;
      a(this).is(":input") ? e = new String(a(this).val()) : e = new String(a(this).text());
      var f = a.formatNumber(e, b);
      c && (a(this).is(":input") ? a(this).val(f) : a(this).text(f));
      if(d) {
        return f
      }
    })
  }, a.formatNumber = function(b, c) {
    var c = a.extend({}, a.fn.formatNumber.defaults, c), d = k(c.locale.toLowerCase()), e = d.dec, f = d.group, g = d.neg, h = "0#-,.", i = "", j = !1;
    for(var l = 0;l < c.format.length;l++) {
      if(h.indexOf(c.format.charAt(l)) != -1) {
        if(l == 0 && c.format.charAt(l) == "-") {
          j = !0;
          continue
        }
        break
      }
      i += c.format.charAt(l)
    }
    var m = "";
    for(var l = c.format.length - 1;l >= 0;l--) {
      if(h.indexOf(c.format.charAt(l)) != -1) {
        break
      }
      m = c.format.charAt(l) + m
    }
    c.format = c.format.substring(i.length), c.format = c.format.substring(0, c.format.length - m.length);
    var n = new Number(b);
    return a._formatNumber(n, c, m, i, j)
  }, a._formatNumber = function(b, c, d, e, f) {
    var c = a.extend({}, a.fn.formatNumber.defaults, c), g = k(c.locale.toLowerCase()), h = g.dec, i = g.group, j = g.neg, l = !1;
    if(isNaN(b)) {
      if(c.nanForceZero != 1) {
        return null
      }
      b = 0, l = !0
    }
    d == "%" && (b *= 100);
    var m = "";
    if(c.format.indexOf(".") > -1) {
      var n = h, o = c.format.substring(c.format.lastIndexOf(".") + 1);
      if(c.round == 1) {
        b = new Number(b.toFixed(o.length))
      }else {
        var p = b.toString();
        p = p.substring(0, p.lastIndexOf(".") + o.length + 1), b = new Number(p)
      }
      var q = b % 1, r = new String(q.toFixed(o.length));
      r = r.substring(r.lastIndexOf(".") + 1);
      for(var s = 0;s < o.length;s++) {
        if(o.charAt(s) == "#" && r.charAt(s) != "0") {
          n += r.charAt(s);
          continue
        }
        if(o.charAt(s) == "#" && r.charAt(s) == "0") {
          var t = r.substring(s);
          if(t.match("[1-9]")) {
            n += r.charAt(s);
            continue
          }
          break
        }
        o.charAt(s) == "0" && (n += r.charAt(s))
      }
      m += n
    }else {
      b = Math.round(b)
    }
    var u = Math.floor(b);
    b < 0 && (u = Math.ceil(b));
    var v = "";
    c.format.indexOf(".") == -1 ? v = c.format : v = c.format.substring(0, c.format.indexOf("."));
    var w = "";
    if(u != 0 || v.substr(v.length - 1) != "#" || l) {
      var x = new String(Math.abs(u)), y = 9999;
      v.lastIndexOf(",") != -1 && (y = v.length - v.lastIndexOf(",") - 1);
      var z = 0;
      for(var s = x.length - 1;s > -1;s--) {
        w = x.charAt(s) + w, z++, z == y && s != 0 && (w = i + w, z = 0)
      }
      if(v.length > w.length) {
        var A = v.indexOf("0");
        if(A != -1) {
          var B = v.length - A;
          while(w.length < B) {
            w = "0" + w
          }
        }
      }
    }
    return!w && v.indexOf("0", v.length - 1) !== -1 && (w = "0"), m = w + m, b < 0 && f && e.length > 0 ? e = j + e : b < 0 && (m = j + m), c.decimalSeparatorAlwaysShown || m.lastIndexOf(h) == m.length - 1 && (m = m.substring(0, m.length - 1)), m = e + m + d, m
  }, a.fn.parseNumber = function(b, c, d) {
    c == null && (c = !0), d == null && (d = !0);
    var e;
    a(this).is(":input") ? e = new String(a(this).val()) : e = new String(a(this).text());
    var f = a.parseNumber(e, b);
    if(f) {
      c && (a(this).is(":input") ? a(this).val(f.toString()) : a(this).text(f.toString()));
      if(d) {
        return f
      }
    }
  }, a.parseNumber = function(b, c) {
    var c = a.extend({}, a.fn.parseNumber.defaults, c), d = k(c.locale.toLowerCase()), e = d.dec, f = d.group, g = d.neg, h = "1234567890.-";
    while(b.indexOf(f) > -1) {
      b = b.replace(f, "")
    }
    b = b.replace(e, ".").replace(g, "-");
    var i = "", j = !1;
    b.charAt(b.length - 1) == "%" && (j = !0);
    for(var l = 0;l < b.length;l++) {
      h.indexOf(b.charAt(l)) > -1 && (i += b.charAt(l))
    }
    var m = new Number(i);
    return j && (m /= 100, m = m.toFixed(i.length - 1)), m
  }, a.fn.parseNumber.defaults = {locale:"us", decimalSeparatorAlwaysShown:!1}, a.fn.formatNumber.defaults = {format:"#,###.00", locale:"us", decimalSeparatorAlwaysShown:!1, nanForceZero:!0, round:!0}, Number.prototype.toFixed = function(a) {
    return $._roundNumber(this, a)
  }, a._roundNumber = function(a, b) {
    var c = Math.pow(10, b || 0), d = String(Math.round(a * c) / c);
    if(b > 0) {
      var e = d.indexOf(".");
      e == -1 ? (d += ".", e = 0) : e = d.length - (e + 1);
      while(e < b) {
        d += "0", e++
      }
    }
    return d
  }
})(jQuery), function() {
  var a = {};
  this.tmpl = function b(c, d) {
    var e = /\W/.test(c) ? new Function("obj", "var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('" + c.replace(/[\r\t\n]/g, " ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g, "$1\r").replace(/\t=(.*?)%>/g, "',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'") + "');}return p.join('');") : a[c] = a[c] || b(document.getElementById(c).innerHTML);
    return d ? e(d) : e
  }
}(), function(a) {
  a.baseClass = function(b) {
    return b = a(b), b.get(0).className.match(/([^ ]+)/)[1]
  }, a.fn.addDependClass = function(b, c) {
    var d = {delimiter:c ? c : "-"};
    return this.each(function() {
      var c = a.baseClass(this);
      c && a(this).addClass(c + d.delimiter + b)
    })
  }, a.fn.removeDependClass = function(b, c) {
    var d = {delimiter:c ? c : "-"};
    return this.each(function() {
      var c = a.baseClass(this);
      c && a(this).removeClass(c + d.delimiter + b)
    })
  }, a.fn.toggleDependClass = function(b, c) {
    var d = {delimiter:c ? c : "-"};
    return this.each(function() {
      var c = a.baseClass(this);
      c && (a(this).is("." + c + d.delimiter + b) ? a(this).removeClass(c + d.delimiter + b) : a(this).addClass(c + d.delimiter + b))
    })
  }
}(jQuery), function(a) {
  function b() {
    this._init.apply(this, arguments)
  }
  b.prototype.oninit = function() {
  }, b.prototype.events = function() {
  }, b.prototype.onmousedown = function() {
    this.ptr.css({position:"absolute"})
  }, b.prototype.onmousemove = function(a, b, c) {
    this.ptr.css({left:b, top:c})
  }, b.prototype.onmouseup = function() {
  }, b.prototype.isDefault = {drag:!1, clicked:!1, toclick:!0, mouseup:!1}, b.prototype._init = function() {
    if(arguments.length > 0) {
      this.ptr = a(arguments[0]), this.outer = a(".draggable-outer"), this.is = {}, a.extend(this.is, this.isDefault);
      var b = this.ptr.offset();
      this.d = {left:b.left, top:b.top, width:this.ptr.width(), height:this.ptr.height()}, this.oninit.apply(this, arguments), this._events()
    }
  }, b.prototype._getPageCoords = function(a) {
    return a.targetTouches && a.targetTouches[0] ? {x:a.targetTouches[0].pageX, y:a.targetTouches[0].pageY} : {x:a.pageX, y:a.pageY}
  }, b.prototype._bindEvent = function(a, b, c) {
    var d = this;
    this.supportTouches_ ? a.get(0).addEventListener(this.events_[b], c, !1) : a.bind(this.events_[b], c)
  }, b.prototype._events = function() {
    var b = this;
    this.supportTouches_ = a.browser.webkit && navigator.userAgent.indexOf("Mobile") != -1, this.events_ = {click:this.supportTouches_ ? "touchstart" : "click", down:this.supportTouches_ ? "touchstart" : "mousedown", move:this.supportTouches_ ? "touchmove" : "mousemove", up:this.supportTouches_ ? "touchend" : "mouseup"}, this._bindEvent(a(document), "move", function(a) {
      b.is.drag && (a.stopPropagation(), a.preventDefault(), b._mousemove(a))
    }), this._bindEvent(a(document), "down", function(a) {
      b.is.drag && (a.stopPropagation(), a.preventDefault())
    }), this._bindEvent(a(document), "up", function(a) {
      b._mouseup(a)
    }), this._bindEvent(this.ptr, "down", function(a) {
      return b._mousedown(a), !1
    }), this._bindEvent(this.ptr, "up", function(a) {
      b._mouseup(a)
    }), this.ptr.find("a").click(function() {
      b.is.clicked = !0;
      if(!b.is.toclick) {
        return b.is.toclick = !0, !1
      }
    }).mousedown(function(a) {
      return b._mousedown(a), !1
    }), this.events()
  }, b.prototype._mousedown = function(b) {
    this.is.drag = !0, this.is.clicked = !1, this.is.mouseup = !1;
    var c = this.ptr.offset(), d = this._getPageCoords(b);
    this.cx = d.x - c.left, this.cy = d.y - c.top, a.extend(this.d, {left:c.left, top:c.top, width:this.ptr.width(), height:this.ptr.height()}), this.outer && this.outer.get(0) && this.outer.css({height:Math.max(this.outer.height(), a(document.body).height()), overflow:"hidden"}), this.onmousedown(b)
  }, b.prototype._mousemove = function(a) {
    this.is.toclick = !1;
    var b = this._getPageCoords(a);
    this.onmousemove(a, b.x - this.cx, b.y - this.cy)
  }, b.prototype._mouseup = function(b) {
    var c = this;
    this.is.drag && (this.is.drag = !1, this.outer && this.outer.get(0) && (a.browser.mozilla ? this.outer.css({overflow:"hidden"}) : this.outer.css({overflow:"visible"}), a.browser.msie && a.browser.version == "6.0" ? this.outer.css({height:"100%"}) : this.outer.css({height:"auto"})), this.onmouseup(b))
  }, window.Draggable = b
}(jQuery), function(a) {
  function b(a) {
    return typeof a == "undefined" ? !1 : a instanceof Array || !(a instanceof Object) && Object.prototype.toString.call(a) == "[object Array]" || typeof a.length == "number" && typeof a.splice != "undefined" && typeof a.propertyIsEnumerable != "undefined" && !a.propertyIsEnumerable("splice") ? !0 : !1
  }
  function d() {
    return this.init.apply(this, arguments)
  }
  function e() {
    Draggable.apply(this, arguments)
  }
  a.slider = function(b, c) {
    var e = a(b);
    return e.data("jslider") || e.data("jslider", new d(b, c)), e.data("jslider")
  }, a.fn.slider = function(c, d) {
    function g(a) {
      return a !== undefined
    }
    function h(a) {
      return a != null
    }
    var e, f = arguments;
    return this.each(function() {
      var i = a.slider(this, c);
      if(typeof c == "string") {
        switch(c) {
          case "value":
            if(g(f[1]) && g(f[2])) {
              var j = i.getPointers();
              h(j[0]) && h(f[1]) && (j[0].set(f[1]), j[0].setIndexOver()), h(j[1]) && h(f[2]) && (j[1].set(f[2]), j[1].setIndexOver())
            }else {
              if(g(f[1])) {
                var j = i.getPointers();
                h(j[0]) && h(f[1]) && (j[0].set(f[1]), j[0].setIndexOver())
              }else {
                e = i.getValue()
              }
            }
            break;
          case "prc":
            if(g(f[1]) && g(f[2])) {
              var j = i.getPointers();
              h(j[0]) && h(f[1]) && (j[0]._set(f[1]), j[0].setIndexOver()), h(j[1]) && h(f[2]) && (j[1]._set(f[2]), j[1].setIndexOver())
            }else {
              if(g(f[1])) {
                var j = i.getPointers();
                h(j[0]) && h(f[1]) && (j[0]._set(f[1]), j[0].setIndexOver())
              }else {
                e = i.getPrcValue()
              }
            }
            break;
          case "calculatedValue":
            var k = i.getValue().split(";");
            e = "";
            for(var l = 0;l < k.length;l++) {
              e += (l > 0 ? ";" : "") + i.nice(k[l])
            }
            break;
          case "skin":
            i.setSkin(f[1])
        }
      }else {
        !c && !d && (b(e) || (e = []), e.push(slider))
      }
    }), b(e) && e.length == 1 && (e = e[0]), e || this
  };
  var c = {settings:{from:1, to:10, step:1, smooth:!0, limits:!0, round:0, format:{format:"#,###.##"}, value:"5;7", dimension:""}, className:"jslider", selector:".jslider-", template:tmpl('<span class="<%=className%>"><table><tr><td><div class="<%=className%>-bg"><i class="l"></i><i class="r"></i><i class="v"></i></div><div class="<%=className%>-pointer"></div><div class="<%=className%>-pointer <%=className%>-pointer-to"></div><div class="<%=className%>-label"><span><%=settings.from%></span></div><div class="<%=className%>-label <%=className%>-label-to"><span><%=settings.to%></span><%=settings.dimension%></div><div class="<%=className%>-value"><span></span><%=settings.dimension%></div><div class="<%=className%>-value <%=className%>-value-to"><span></span><%=settings.dimension%></div><div class="<%=className%>-scale"><%=scale%></div></td></tr></table></span>')};
  d.prototype.init = function(b, d) {
    this.settings = a.extend(!0, {}, c.settings, d ? d : {}), this.inputNode = a(b).hide(), this.settings.interval = this.settings.to - this.settings.from, this.settings.value = this.inputNode.attr("value"), this.settings.calculate && a.isFunction(this.settings.calculate) && (this.nice = this.settings.calculate), this.settings.onstatechange && a.isFunction(this.settings.onstatechange) && (this.onstatechange = this.settings.onstatechange), this.is = {init:!1}, this.o = {}, this.create()
  }, d.prototype.onstatechange = function() {
  }, d.prototype.create = function() {
    var b = this;
    this.domNode = a(c.template({className:c.className, settings:{from:this.nice(this.settings.from), to:this.nice(this.settings.to), dimension:this.settings.dimension}, scale:this.generateScale()})), this.inputNode.after(this.domNode), this.drawScale(), this.settings.skin && this.settings.skin.length > 0 && this.setSkin(this.settings.skin), this.sizes = {domWidth:this.domNode.width(), domOffset:this.domNode.offset()}, a.extend(this.o, {pointers:{}, labels:{"0":{o:this.domNode.find(c.selector + "value").not(c.selector + 
    "value-to")}, 1:{o:this.domNode.find(c.selector + "value").filter(c.selector + "value-to")}}, limits:{"0":this.domNode.find(c.selector + "label").not(c.selector + "label-to"), 1:this.domNode.find(c.selector + "label").filter(c.selector + "label-to")}}), a.extend(this.o.labels[0], {value:this.o.labels[0].o.find("span")}), a.extend(this.o.labels[1], {value:this.o.labels[1].o.find("span")}), b.settings.value.split(";")[1] || (this.settings.single = !0, this.domNode.addDependClass("single")), b.settings.limits || 
    this.domNode.addDependClass("limitless"), this.domNode.find(c.selector + "pointer").each(function(a) {
      var c = b.settings.value.split(";")[a];
      if(c) {
        b.o.pointers[a] = new e(this, a, b);
        var d = b.settings.value.split(";")[a - 1];
        d && new Number(c) < new Number(d) && (c = d), c = c < b.settings.from ? b.settings.from : c, c = c > b.settings.to ? b.settings.to : c, b.o.pointers[a].set(c, !0)
      }
    }), this.o.value = this.domNode.find(".v"), this.is.init = !0, a.each(this.o.pointers, function(a) {
      b.redraw(this)
    }), function(b) {
      a(window).resize(function() {
        b.onresize()
      })
    }(this)
  }, d.prototype.setSkin = function(a) {
    this.skin_ && this.domNode.removeDependClass(this.skin_, "_"), this.domNode.addDependClass(this.skin_ = a, "_")
  }, d.prototype.setPointersIndex = function(b) {
    a.each(this.getPointers(), function(a) {
      this.index(a)
    })
  }, d.prototype.getPointers = function() {
    return this.o.pointers
  }, d.prototype.generateScale = function() {
    if(this.settings.scale && this.settings.scale.length > 0) {
      var a = "", b = this.settings.scale, c = Math.round(100 / (b.length - 1) * 10) / 10;
      for(var d = 0;d < b.length;d++) {
        a += '<span style="left: ' + d * c + '%">' + (b[d] != "|" ? "<ins>" + b[d] + "</ins>" : "") + "</span>"
      }
      return a
    }
    return""
  }, d.prototype.drawScale = function() {
    this.domNode.find(c.selector + "scale span ins").each(function() {
      a(this).css({marginLeft:-a(this).outerWidth() / 2})
    })
  }, d.prototype.onresize = function() {
    var b = this;
    this.sizes = {domWidth:this.domNode.width(), domOffset:this.domNode.offset()}, a.each(this.o.pointers, function(a) {
      b.redraw(this)
    })
  }, d.prototype.limits = function(a, b) {
    if(!this.settings.smooth) {
      var c = this.settings.step * 100 / this.settings.interval;
      a = Math.round(a / c) * c
    }
    var d = this.o.pointers[1 - b.uid];
    return d && b.uid && a < d.value.prc && (a = d.value.prc), d && !b.uid && a > d.value.prc && (a = d.value.prc), a < 0 && (a = 0), a > 100 && (a = 100), Math.round(a * 10) / 10
  }, d.prototype.redraw = function(a) {
    if(!this.is.init) {
      return!1
    }
    this.setValue(), this.o.pointers[0] && this.o.pointers[1] && this.o.value.css({left:this.o.pointers[0].value.prc + "%", width:this.o.pointers[1].value.prc - this.o.pointers[0].value.prc + "%"}), this.o.labels[a.uid].value.html(this.nice(a.value.origin)), this.redrawLabels(a)
  }, d.prototype.redrawLabels = function(a) {
    function b(a, b, d) {
      return b.margin = -b.label / 2, label_left = b.border + b.margin, label_left < 0 && (b.margin -= label_left), b.border + b.label / 2 > c.sizes.domWidth ? (b.margin = 0, b.right = !0) : b.right = !1, a.o.css({left:d + "%", marginLeft:b.margin, right:"auto"}), b.right && a.o.css({left:"auto", right:0}), b
    }
    var c = this, d = this.o.labels[a.uid], e = a.value.prc, f = {label:d.o.outerWidth(), right:!1, border:e * this.sizes.domWidth / 100};
    if(!this.settings.single) {
      var g = this.o.pointers[1 - a.uid], h = this.o.labels[g.uid];
      switch(a.uid) {
        case 0:
          f.border + f.label / 2 > h.o.offset().left - this.sizes.domOffset.left ? (h.o.css({visibility:"hidden"}), h.value.html(this.nice(g.value.origin)), d.o.css({visibility:"visible"}), e = (g.value.prc - e) / 2 + e, g.value.prc != a.value.prc && (d.value.html(this.nice(a.value.origin) + "&nbsp;&ndash;&nbsp;" + this.nice(g.value.origin)), f.label = d.o.outerWidth(), f.border = e * this.sizes.domWidth / 100)) : h.o.css({visibility:"visible"});
          break;
        case 1:
          f.border - f.label / 2 < h.o.offset().left - this.sizes.domOffset.left + h.o.outerWidth() ? (h.o.css({visibility:"hidden"}), h.value.html(this.nice(g.value.origin)), d.o.css({visibility:"visible"}), e = (e - g.value.prc) / 2 + g.value.prc, g.value.prc != a.value.prc && (d.value.html(this.nice(g.value.origin) + "&nbsp;&ndash;&nbsp;" + this.nice(a.value.origin)), f.label = d.o.outerWidth(), f.border = e * this.sizes.domWidth / 100)) : h.o.css({visibility:"visible"})
      }
    }
    f = b(d, f, e);
    if(h) {
      var f = {label:h.o.outerWidth(), right:!1, border:g.value.prc * this.sizes.domWidth / 100};
      f = b(h, f, g.value.prc)
    }
    this.redrawLimits()
  }, d.prototype.redrawLimits = function() {
    if(this.settings.limits) {
      var a = [!0, !0];
      for(key in this.o.pointers) {
        if(!this.settings.single || key == 0) {
          var b = this.o.pointers[key], c = this.o.labels[b.uid], d = c.o.offset().left - this.sizes.domOffset.left, e = this.o.limits[0];
          d < e.outerWidth() && (a[0] = !1);
          var e = this.o.limits[1];
          d + c.o.outerWidth() > this.sizes.domWidth - e.outerWidth() && (a[1] = !1)
        }
      }
      for(var f = 0;f < a.length;f++) {
        a[f] ? this.o.limits[f].fadeIn("fast") : this.o.limits[f].fadeOut("fast")
      }
    }
  }, d.prototype.setValue = function() {
    var a = this.getValue();
    this.inputNode.attr("value", a), this.onstatechange.call(this, a)
  }, d.prototype.getValue = function() {
    if(!this.is.init) {
      return!1
    }
    var b = this, c = "";
    return a.each(this.o.pointers, function(a) {
      this.value.prc != undefined && !isNaN(this.value.prc) && (c += (a > 0 ? ";" : "") + b.prcToValue(this.value.prc))
    }), c
  }, d.prototype.getPrcValue = function() {
    if(!this.is.init) {
      return!1
    }
    var b = this, c = "";
    return a.each(this.o.pointers, function(a) {
      this.value.prc != undefined && !isNaN(this.value.prc) && (c += (a > 0 ? ";" : "") + this.value.prc)
    }), c
  }, d.prototype.prcToValue = function(a) {
    if(this.settings.heterogeneity && this.settings.heterogeneity.length > 0) {
      var b = this.settings.heterogeneity, c = 0, d = this.settings.from;
      for(var e = 0;e <= b.length;e++) {
        if(b[e]) {
          var f = b[e].split("/")
        }else {
          var f = [100, this.settings.to]
        }
        f[0] = new Number(f[0]), f[1] = new Number(f[1]);
        if(a >= c && a <= f[0]) {
          var g = d + (a - c) * (f[1] - d) / (f[0] - c)
        }
        c = f[0], d = f[1]
      }
    }else {
      var g = this.settings.from + a * this.settings.interval / 100
    }
    return this.round(g)
  }, d.prototype.valueToPrc = function(a, b) {
    if(this.settings.heterogeneity && this.settings.heterogeneity.length > 0) {
      var c = this.settings.heterogeneity, d = 0, e = this.settings.from;
      for(var f = 0;f <= c.length;f++) {
        if(c[f]) {
          var g = c[f].split("/")
        }else {
          var g = [100, this.settings.to]
        }
        g[0] = new Number(g[0]), g[1] = new Number(g[1]);
        if(a >= e && a <= g[1]) {
          var h = b.limits(d + (a - e) * (g[0] - d) / (g[1] - e))
        }
        d = g[0], e = g[1]
      }
    }else {
      var h = b.limits((a - this.settings.from) * 100 / this.settings.interval)
    }
    return h
  }, d.prototype.round = function(a) {
    return a = Math.round(a / this.settings.step) * this.settings.step, this.settings.round ? a = Math.round(a * Math.pow(10, this.settings.round)) / Math.pow(10, this.settings.round) : a = Math.round(a), a
  }, d.prototype.nice = function(b) {
    return b = b.toString().replace(/,/gi, ".").replace(/ /gi, ""), a.formatNumber ? a.formatNumber(new Number(b), this.settings.format || {}).replace(/-/gi, "&minus;") : new Number(b)
  }, e.prototype = new Draggable, e.prototype.oninit = function(a, b, c) {
    this.uid = b, this.parent = c, this.value = {}, this.settings = this.parent.settings
  }, e.prototype.onmousedown = function(a) {
    this._parent = {offset:this.parent.domNode.offset(), width:this.parent.domNode.width()}, this.ptr.addDependClass("hover"), this.setIndexOver()
  }, e.prototype.onmousemove = function(a, b) {
    var c = this._getPageCoords(a);
    this._set(this.calc(c.x))
  }, e.prototype.onmouseup = function(b) {
    this.parent.settings.callback && a.isFunction(this.parent.settings.callback) && this.parent.settings.callback.call(this.parent, this.parent.getValue()), this.ptr.removeDependClass("hover")
  }, e.prototype.setIndexOver = function() {
    this.parent.setPointersIndex(1), this.index(2)
  }, e.prototype.index = function(a) {
    this.ptr.css({zIndex:a})
  }, e.prototype.limits = function(a) {
    return this.parent.limits(a, this)
  }, e.prototype.calc = function(a) {
    var b = this.limits((a - this._parent.offset.left) * 100 / this._parent.width);
    return b
  }, e.prototype.set = function(a, b) {
    this.value.origin = this.parent.round(a), this._set(this.parent.valueToPrc(a, this), b)
  }, e.prototype._set = function(a, b) {
    b || (this.value.origin = this.parent.prcToValue(a)), this.value.prc = a, this.ptr.css({left:a + "%"}), this.parent.redraw(this)
  }
}(jQuery);
(function(a, b) {
  function d(b) {
    return!a(b).parents().andSelf().filter(function() {
      return a.curCSS(this, "visibility") === "hidden" || a.expr.filters.hidden(this)
    }).length
  }
  function c(b, c) {
    var e = b.nodeName.toLowerCase();
    if("area" === e) {
      var f = b.parentNode, g = f.name, h;
      if(!b.href || !g || f.nodeName.toLowerCase() !== "map") {
        return!1
      }
      h = a("img[usemap=#" + g + "]")[0];
      return!!h && d(h)
    }
    return(/input|select|textarea|button|object/.test(e) ? !b.disabled : "a" == e ? b.href || c : c) && d(b)
  }
  a.ui = a.ui || {};
  a.ui.version || (a.extend(a.ui, {version:"1.8.18", keyCode:{ALT:18, BACKSPACE:8, CAPS_LOCK:20, COMMA:188, COMMAND:91, COMMAND_LEFT:91, COMMAND_RIGHT:93, CONTROL:17, DELETE:46, DOWN:40, END:35, ENTER:13, ESCAPE:27, HOME:36, INSERT:45, LEFT:37, MENU:93, NUMPAD_ADD:107, NUMPAD_DECIMAL:110, NUMPAD_DIVIDE:111, NUMPAD_ENTER:108, NUMPAD_MULTIPLY:106, NUMPAD_SUBTRACT:109, PAGE_DOWN:34, PAGE_UP:33, PERIOD:190, RIGHT:39, SHIFT:16, SPACE:32, TAB:9, UP:38, WINDOWS:91}}), a.fn.extend({propAttr:a.fn.prop || 
  a.fn.attr, _focus:a.fn.focus, focus:function(b, c) {
    return typeof b == "number" ? this.each(function() {
      var d = this;
      setTimeout(function() {
        a(d).focus(), c && c.call(d)
      }, b)
    }) : this._focus.apply(this, arguments)
  }, scrollParent:function() {
    var b;
    a.browser.msie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? b = this.parents().filter(function() {
      return/(relative|absolute|fixed)/.test(a.curCSS(this, "position", 1)) && /(auto|scroll)/.test(a.curCSS(this, "overflow", 1) + a.curCSS(this, "overflow-y", 1) + a.curCSS(this, "overflow-x", 1))
    }).eq(0) : b = this.parents().filter(function() {
      return/(auto|scroll)/.test(a.curCSS(this, "overflow", 1) + a.curCSS(this, "overflow-y", 1) + a.curCSS(this, "overflow-x", 1))
    }).eq(0);
    return/fixed/.test(this.css("position")) || !b.length ? a(document) : b
  }, zIndex:function(c) {
    if(c !== b) {
      return this.css("zIndex", c)
    }
    if(this.length) {
      var d = a(this[0]), e, f;
      while(d.length && d[0] !== document) {
        e = d.css("position");
        if(e === "absolute" || e === "relative" || e === "fixed") {
          f = parseInt(d.css("zIndex"), 10);
          if(!isNaN(f) && f !== 0) {
            return f
          }
        }
        d = d.parent()
      }
    }
    return 0
  }, disableSelection:function() {
    return this.bind((a.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(a) {
      a.preventDefault()
    })
  }, enableSelection:function() {
    return this.unbind(".ui-disableSelection")
  }}), a.each(["Width", "Height"], function(c, d) {
    function h(b, c, d, f) {
      a.each(e, function() {
        c -= parseFloat(a.curCSS(b, "padding" + this, !0)) || 0, d && (c -= parseFloat(a.curCSS(b, "border" + this + "Width", !0)) || 0), f && (c -= parseFloat(a.curCSS(b, "margin" + this, !0)) || 0)
      });
      return c
    }
    var e = d === "Width" ? ["Left", "Right"] : ["Top", "Bottom"], f = d.toLowerCase(), g = {innerWidth:a.fn.innerWidth, innerHeight:a.fn.innerHeight, outerWidth:a.fn.outerWidth, outerHeight:a.fn.outerHeight};
    a.fn["inner" + d] = function(c) {
      if(c === b) {
        return g["inner" + d].call(this)
      }
      return this.each(function() {
        a(this).css(f, h(this, c) + "px")
      })
    }, a.fn["outer" + d] = function(b, c) {
      if(typeof b != "number") {
        return g["outer" + d].call(this, b)
      }
      return this.each(function() {
        a(this).css(f, h(this, b, !0, c) + "px")
      })
    }
  }), a.extend(a.expr[":"], {data:function(b, c, d) {
    return!!a.data(b, d[3])
  }, focusable:function(b) {
    return c(b, !isNaN(a.attr(b, "tabindex")))
  }, tabbable:function(b) {
    var d = a.attr(b, "tabindex"), e = isNaN(d);
    return(e || d >= 0) && c(b, !e)
  }}), a(function() {
    var b = document.body, c = b.appendChild(c = document.createElement("div"));
    c.offsetHeight, a.extend(c.style, {minHeight:"100px", height:"auto", padding:0, borderWidth:0}), a.support.minHeight = c.offsetHeight === 100, a.support.selectstart = "onselectstart" in c, b.removeChild(c).style.display = "none"
  }), a.extend(a.ui, {plugin:{add:function(b, c, d) {
    var e = a.ui[b].prototype;
    for(var f in d) {
      e.plugins[f] = e.plugins[f] || [], e.plugins[f].push([c, d[f]])
    }
  }, call:function(a, b, c) {
    var d = a.plugins[b];
    if(!!d && !!a.element[0].parentNode) {
      for(var e = 0;e < d.length;e++) {
        a.options[d[e][0]] && d[e][1].apply(a.element, c)
      }
    }
  }}, contains:function(a, b) {
    return document.compareDocumentPosition ? a.compareDocumentPosition(b) & 16 : a !== b && a.contains(b)
  }, hasScroll:function(b, c) {
    if(a(b).css("overflow") === "hidden") {
      return!1
    }
    var d = c && c === "left" ? "scrollLeft" : "scrollTop", e = !1;
    if(b[d] > 0) {
      return!0
    }
    b[d] = 1, e = b[d] > 0, b[d] = 0;
    return e
  }, isOverAxis:function(a, b, c) {
    return a > b && a < b + c
  }, isOver:function(b, c, d, e, f, g) {
    return a.ui.isOverAxis(b, d, f) && a.ui.isOverAxis(c, e, g)
  }}))
})(jQuery);
(function(a, b) {
  a.widget("ui.draggable", a.ui.mouse, {widgetEventPrefix:"drag", options:{addClasses:!0, appendTo:"parent", axis:!1, connectToSortable:!1, containment:!1, cursor:"auto", cursorAt:!1, grid:!1, handle:!1, helper:"original", iframeFix:!1, opacity:!1, refreshPositions:!1, revert:!1, revertDuration:500, scope:"default", scroll:!0, scrollSensitivity:20, scrollSpeed:20, snap:!1, snapMode:"both", snapTolerance:20, stack:!1, zIndex:!1}, _create:function() {
    this.options.helper == "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
  }, destroy:function() {
    if(!!this.element.data("draggable")) {
      this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy();
      return this
    }
  }, _mouseCapture:function(b) {
    var c = this.options;
    if(this.helper || c.disabled || a(b.target).is(".ui-resizable-handle")) {
      return!1
    }
    this.handle = this._getHandle(b);
    if(!this.handle) {
      return!1
    }
    c.iframeFix && a(c.iframeFix === !0 ? "iframe" : c.iframeFix).each(function() {
      a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth + "px", height:this.offsetHeight + "px", position:"absolute", opacity:"0.001", zIndex:1E3}).css(a(this).offset()).appendTo("body")
    });
    return!0
  }, _mouseStart:function(b) {
    var c = this.options;
    this.helper = this._createHelper(b), this._cacheHelperProportions(), a.ui.ddmanager && (a.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, a.extend(this.offset, {click:{left:b.pageX - this.offset.left, top:b.pageY - this.offset.top}, parent:this._getParentOffset(), 
    relative:this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(b), this.originalPageX = b.pageX, this.originalPageY = b.pageY, c.cursorAt && this._adjustOffsetFromHelper(c.cursorAt), c.containment && this._setContainment();
    if(this._trigger("start", b) === !1) {
      this._clear();
      return!1
    }
    this._cacheHelperProportions(), a.ui.ddmanager && !c.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b), this.helper.addClass("ui-draggable-dragging"), this._mouseDrag(b, !0), a.ui.ddmanager && a.ui.ddmanager.dragStart(this, b);
    return!0
  }, _mouseDrag:function(b, c) {
    this.position = this._generatePosition(b), this.positionAbs = this._convertPositionTo("absolute");
    if(!c) {
      var d = this._uiHash();
      if(this._trigger("drag", b, d) === !1) {
        this._mouseUp({});
        return!1
      }
      this.position = d.position
    }
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    a.ui.ddmanager && a.ui.ddmanager.drag(this, b);
    return!1
  }, _mouseStop:function(b) {
    var c = !1;
    a.ui.ddmanager && !this.options.dropBehaviour && (c = a.ui.ddmanager.drop(this, b)), this.dropped && (c = this.dropped, this.dropped = !1);
    if((!this.element[0] || !this.element[0].parentNode) && this.options.helper == "original") {
      return!1
    }
    if(this.options.revert == "invalid" && !c || this.options.revert == "valid" && c || this.options.revert === !0 || a.isFunction(this.options.revert) && this.options.revert.call(this.element, c)) {
      var d = this;
      a(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
        d._trigger("stop", b) !== !1 && d._clear()
      })
    }else {
      this._trigger("stop", b) !== !1 && this._clear()
    }
    return!1
  }, _mouseUp:function(b) {
    this.options.iframeFix === !0 && a("div.ui-draggable-iframeFix").each(function() {
      this.parentNode.removeChild(this)
    }), a.ui.ddmanager && a.ui.ddmanager.dragStop(this, b);
    return a.ui.mouse.prototype._mouseUp.call(this, b)
  }, cancel:function() {
    this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear();
    return this
  }, _getHandle:function(b) {
    var c = !this.options.handle || !a(this.options.handle, this.element).length ? !0 : !1;
    a(this.options.handle, this.element).find("*").andSelf().each(function() {
      this == b.target && (c = !0)
    });
    return c
  }, _createHelper:function(b) {
    var c = this.options, d = a.isFunction(c.helper) ? a(c.helper.apply(this.element[0], [b])) : c.helper == "clone" ? this.element.clone().removeAttr("id") : this.element;
    d.parents("body").length || d.appendTo(c.appendTo == "parent" ? this.element[0].parentNode : c.appendTo), d[0] != this.element[0] && !/(fixed|absolute)/.test(d.css("position")) && d.css("position", "absolute");
    return d
  }, _adjustOffsetFromHelper:function(b) {
    typeof b == "string" && (b = b.split(" ")), a.isArray(b) && (b = {left:+b[0], top:+b[1] || 0}), "left" in b && (this.offset.click.left = b.left + this.margins.left), "right" in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left), "top" in b && (this.offset.click.top = b.top + this.margins.top), "bottom" in b && (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var b = this.offsetParent.offset();
    this.cssPosition == "absolute" && this.scrollParent[0] != document && a.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop());
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && a.browser.msie) {
      b = {top:0, left:0}
    }
    return{top:b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var a = this.element.position();
      return{top:a.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:a.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.element.css("marginLeft"), 10) || 0, top:parseInt(this.element.css("marginTop"), 10) || 0, right:parseInt(this.element.css("marginRight"), 10) || 0, bottom:parseInt(this.element.css("marginBottom"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var b = this.options;
    b.containment == "parent" && (b.containment = this.helper[0].parentNode);
    if(b.containment == "document" || b.containment == "window") {
      this.containment = [b.containment == "document" ? 0 : a(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, b.containment == "document" ? 0 : a(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (b.containment == "document" ? 0 : a(window).scrollLeft()) + a(b.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (b.containment == "document" ? 0 : a(window).scrollTop()) + (a(b.containment == "document" ? 
      document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(b.containment) && b.containment.constructor != Array) {
      var c = a(b.containment), d = c[0];
      if(!d) {
        return
      }
      var e = c.offset(), f = a(d).css("overflow") != "hidden";
      this.containment = [(parseInt(a(d).css("borderLeftWidth"), 10) || 0) + (parseInt(a(d).css("paddingLeft"), 10) || 0), (parseInt(a(d).css("borderTopWidth"), 10) || 0) + (parseInt(a(d).css("paddingTop"), 10) || 0), (f ? Math.max(d.scrollWidth, d.offsetWidth) : d.offsetWidth) - (parseInt(a(d).css("borderLeftWidth"), 10) || 0) - (parseInt(a(d).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (f ? Math.max(d.scrollHeight, d.offsetHeight) : d.offsetHeight) - 
      (parseInt(a(d).css("borderTopWidth"), 10) || 0) - (parseInt(a(d).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = c
    }else {
      b.containment.constructor == Array && (this.containment = b.containment)
    }
  }, _convertPositionTo:function(b, c) {
    c || (c = this.position);
    var d = b == "absolute" ? 1 : -1, e = this.options, f = this.cssPosition == "absolute" && (this.scrollParent[0] == document || !a.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, g = /(html|body)/i.test(f[0].tagName);
    return{top:c.top + this.offset.relative.top * d + this.offset.parent.top * d - (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : g ? 0 : f.scrollTop()) * d), left:c.left + this.offset.relative.left * d + this.offset.parent.left * d - (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : g ? 0 : f.scrollLeft()) * 
    d)}
  }, _generatePosition:function(b) {
    var c = this.options, d = this.cssPosition == "absolute" && (this.scrollParent[0] == document || !a.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, e = /(html|body)/i.test(d[0].tagName), f = b.pageX, g = b.pageY;
    if(this.originalPosition) {
      var h;
      if(this.containment) {
        if(this.relative_container) {
          var i = this.relative_container.offset();
          h = [this.containment[0] + i.left, this.containment[1] + i.top, this.containment[2] + i.left, this.containment[3] + i.top]
        }else {
          h = this.containment
        }
        b.pageX - this.offset.click.left < h[0] && (f = h[0] + this.offset.click.left), b.pageY - this.offset.click.top < h[1] && (g = h[1] + this.offset.click.top), b.pageX - this.offset.click.left > h[2] && (f = h[2] + this.offset.click.left), b.pageY - this.offset.click.top > h[3] && (g = h[3] + this.offset.click.top)
      }
      if(c.grid) {
        var j = c.grid[1] ? this.originalPageY + Math.round((g - this.originalPageY) / c.grid[1]) * c.grid[1] : this.originalPageY;
        g = h ? j - this.offset.click.top < h[1] || j - this.offset.click.top > h[3] ? j - this.offset.click.top < h[1] ? j + c.grid[1] : j - c.grid[1] : j : j;
        var k = c.grid[0] ? this.originalPageX + Math.round((f - this.originalPageX) / c.grid[0]) * c.grid[0] : this.originalPageX;
        f = h ? k - this.offset.click.left < h[0] || k - this.offset.click.left > h[2] ? k - this.offset.click.left < h[0] ? k + c.grid[0] : k - c.grid[0] : k : k
      }
    }
    return{top:g - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : e ? 0 : d.scrollTop()), left:f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (a.browser.safari && a.browser.version < 526 && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : e ? 
    0 : d.scrollLeft())}
  }, _clear:function() {
    this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
  }, _trigger:function(b, c, d) {
    d = d || this._uiHash(), a.ui.plugin.call(this, b, [c, d]), b == "drag" && (this.positionAbs = this._convertPositionTo("absolute"));
    return a.Widget.prototype._trigger.call(this, b, c, d)
  }, plugins:{}, _uiHash:function(a) {
    return{helper:this.helper, position:this.position, originalPosition:this.originalPosition, offset:this.positionAbs}
  }}), a.extend(a.ui.draggable, {version:"1.8.18"}), a.ui.plugin.add("draggable", "connectToSortable", {start:function(b, c) {
    var d = a(this).data("draggable"), e = d.options, f = a.extend({}, c, {item:d.element});
    d.sortables = [], a(e.connectToSortable).each(function() {
      var c = a.data(this, "sortable");
      c && !c.options.disabled && (d.sortables.push({instance:c, shouldRevert:c.options.revert}), c.refreshPositions(), c._trigger("activate", b, f))
    })
  }, stop:function(b, c) {
    var d = a(this).data("draggable"), e = a.extend({}, c, {item:d.element});
    a.each(d.sortables, function() {
      this.instance.isOver ? (this.instance.isOver = 0, d.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(b), this.instance.options.helper = this.instance.options._helper, d.options.helper == "original" && this.instance.currentItem.css({top:"auto", left:"auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", b, e))
    })
  }, drag:function(b, c) {
    var d = a(this).data("draggable"), e = this, f = function(b) {
      var c = this.offset.click.top, d = this.offset.click.left, e = this.positionAbs.top, f = this.positionAbs.left, g = b.height, h = b.width, i = b.top, j = b.left;
      return a.ui.isOver(e + c, f + d, i, j, g, h)
    };
    a.each(d.sortables, function(f) {
      this.instance.positionAbs = d.positionAbs, this.instance.helperProportions = d.helperProportions, this.instance.offset.click = d.offset.click, this.instance._intersectsWith(this.instance.containerCache) ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
        return c.helper[0]
      }, b.target = this.instance.currentItem[0], this.instance._mouseCapture(b, !0), this.instance._mouseStart(b, !0, !0), this.instance.offset.click.top = d.offset.click.top, this.instance.offset.click.left = d.offset.click.left, this.instance.offset.parent.left -= d.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= d.offset.parent.top - this.instance.offset.parent.top, d._trigger("toSortable", b), d.dropped = this.instance.element, d.currentItem = d.element, 
      this.instance.fromOutside = d), this.instance.currentItem && this.instance._mouseDrag(b)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", b, this.instance._uiHash(this.instance)), this.instance._mouseStop(b, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), d._trigger("fromSortable", 
      b), d.dropped = !1)
    })
  }}), a.ui.plugin.add("draggable", "cursor", {start:function(b, c) {
    var d = a("body"), e = a(this).data("draggable").options;
    d.css("cursor") && (e._cursor = d.css("cursor")), d.css("cursor", e.cursor)
  }, stop:function(b, c) {
    var d = a(this).data("draggable").options;
    d._cursor && a("body").css("cursor", d._cursor)
  }}), a.ui.plugin.add("draggable", "opacity", {start:function(b, c) {
    var d = a(c.helper), e = a(this).data("draggable").options;
    d.css("opacity") && (e._opacity = d.css("opacity")), d.css("opacity", e.opacity)
  }, stop:function(b, c) {
    var d = a(this).data("draggable").options;
    d._opacity && a(c.helper).css("opacity", d._opacity)
  }}), a.ui.plugin.add("draggable", "scroll", {start:function(b, c) {
    var d = a(this).data("draggable");
    d.scrollParent[0] != document && d.scrollParent[0].tagName != "HTML" && (d.overflowOffset = d.scrollParent.offset())
  }, drag:function(b, c) {
    var d = a(this).data("draggable"), e = d.options, f = !1;
    if(d.scrollParent[0] != document && d.scrollParent[0].tagName != "HTML") {
      if(!e.axis || e.axis != "x") {
        d.overflowOffset.top + d.scrollParent[0].offsetHeight - b.pageY < e.scrollSensitivity ? d.scrollParent[0].scrollTop = f = d.scrollParent[0].scrollTop + e.scrollSpeed : b.pageY - d.overflowOffset.top < e.scrollSensitivity && (d.scrollParent[0].scrollTop = f = d.scrollParent[0].scrollTop - e.scrollSpeed)
      }
      if(!e.axis || e.axis != "y") {
        d.overflowOffset.left + d.scrollParent[0].offsetWidth - b.pageX < e.scrollSensitivity ? d.scrollParent[0].scrollLeft = f = d.scrollParent[0].scrollLeft + e.scrollSpeed : b.pageX - d.overflowOffset.left < e.scrollSensitivity && (d.scrollParent[0].scrollLeft = f = d.scrollParent[0].scrollLeft - e.scrollSpeed)
      }
    }else {
      if(!e.axis || e.axis != "x") {
        b.pageY - a(document).scrollTop() < e.scrollSensitivity ? f = a(document).scrollTop(a(document).scrollTop() - e.scrollSpeed) : a(window).height() - (b.pageY - a(document).scrollTop()) < e.scrollSensitivity && (f = a(document).scrollTop(a(document).scrollTop() + e.scrollSpeed))
      }
      if(!e.axis || e.axis != "y") {
        b.pageX - a(document).scrollLeft() < e.scrollSensitivity ? f = a(document).scrollLeft(a(document).scrollLeft() - e.scrollSpeed) : a(window).width() - (b.pageX - a(document).scrollLeft()) < e.scrollSensitivity && (f = a(document).scrollLeft(a(document).scrollLeft() + e.scrollSpeed))
      }
    }
    f !== !1 && a.ui.ddmanager && !e.dropBehaviour && a.ui.ddmanager.prepareOffsets(d, b)
  }}), a.ui.plugin.add("draggable", "snap", {start:function(b, c) {
    var d = a(this).data("draggable"), e = d.options;
    d.snapElements = [], a(e.snap.constructor != String ? e.snap.items || ":data(draggable)" : e.snap).each(function() {
      var b = a(this), c = b.offset();
      this != d.element[0] && d.snapElements.push({item:this, width:b.outerWidth(), height:b.outerHeight(), top:c.top, left:c.left})
    })
  }, drag:function(b, c) {
    var d = a(this).data("draggable"), e = d.options, f = e.snapTolerance, g = c.offset.left, h = g + d.helperProportions.width, i = c.offset.top, j = i + d.helperProportions.height;
    for(var k = d.snapElements.length - 1;k >= 0;k--) {
      var l = d.snapElements[k].left, m = l + d.snapElements[k].width, n = d.snapElements[k].top, o = n + d.snapElements[k].height;
      if(!(l - f < g && g < m + f && n - f < i && i < o + f || l - f < g && g < m + f && n - f < j && j < o + f || l - f < h && h < m + f && n - f < i && i < o + f || l - f < h && h < m + f && n - f < j && j < o + f)) {
        d.snapElements[k].snapping && d.options.snap.release && d.options.snap.release.call(d.element, b, a.extend(d._uiHash(), {snapItem:d.snapElements[k].item})), d.snapElements[k].snapping = !1;
        continue
      }
      if(e.snapMode != "inner") {
        var p = Math.abs(n - j) <= f, q = Math.abs(o - i) <= f, r = Math.abs(l - h) <= f, s = Math.abs(m - g) <= f;
        p && (c.position.top = d._convertPositionTo("relative", {top:n - d.helperProportions.height, left:0}).top - d.margins.top), q && (c.position.top = d._convertPositionTo("relative", {top:o, left:0}).top - d.margins.top), r && (c.position.left = d._convertPositionTo("relative", {top:0, left:l - d.helperProportions.width}).left - d.margins.left), s && (c.position.left = d._convertPositionTo("relative", {top:0, left:m}).left - d.margins.left)
      }
      var t = p || q || r || s;
      if(e.snapMode != "outer") {
        var p = Math.abs(n - i) <= f, q = Math.abs(o - j) <= f, r = Math.abs(l - g) <= f, s = Math.abs(m - h) <= f;
        p && (c.position.top = d._convertPositionTo("relative", {top:n, left:0}).top - d.margins.top), q && (c.position.top = d._convertPositionTo("relative", {top:o - d.helperProportions.height, left:0}).top - d.margins.top), r && (c.position.left = d._convertPositionTo("relative", {top:0, left:l}).left - d.margins.left), s && (c.position.left = d._convertPositionTo("relative", {top:0, left:m - d.helperProportions.width}).left - d.margins.left)
      }
      !d.snapElements[k].snapping && (p || q || r || s || t) && d.options.snap.snap && d.options.snap.snap.call(d.element, b, a.extend(d._uiHash(), {snapItem:d.snapElements[k].item})), d.snapElements[k].snapping = p || q || r || s || t
    }
  }}), a.ui.plugin.add("draggable", "stack", {start:function(b, c) {
    var d = a(this).data("draggable").options, e = a.makeArray(a(d.stack)).sort(function(b, c) {
      return(parseInt(a(b).css("zIndex"), 10) || 0) - (parseInt(a(c).css("zIndex"), 10) || 0)
    });
    if(!!e.length) {
      var f = parseInt(e[0].style.zIndex) || 0;
      a(e).each(function(a) {
        this.style.zIndex = f + a
      }), this[0].style.zIndex = f + e.length
    }
  }}), a.ui.plugin.add("draggable", "zIndex", {start:function(b, c) {
    var d = a(c.helper), e = a(this).data("draggable").options;
    d.css("zIndex") && (e._zIndex = d.css("zIndex")), d.css("zIndex", e.zIndex)
  }, stop:function(b, c) {
    var d = a(this).data("draggable").options;
    d._zIndex && a(c.helper).css("zIndex", d._zIndex)
  }})
})(jQuery);
(function(a, b) {
  var c = !1;
  a(document).mouseup(function(a) {
    c = !1
  }), a.widget("ui.mouse", {options:{cancel:":input,option", distance:1, delay:0}, _mouseInit:function() {
    var b = this;
    this.element.bind("mousedown." + this.widgetName, function(a) {
      return b._mouseDown(a)
    }).bind("click." + this.widgetName, function(c) {
      if(!0 === a.data(c.target, b.widgetName + ".preventClickEvent")) {
        a.removeData(c.target, b.widgetName + ".preventClickEvent"), c.stopImmediatePropagation();
        return!1
      }
    }), this.started = !1
  }, _mouseDestroy:function() {
    this.element.unbind("." + this.widgetName)
  }, _mouseDown:function(b) {
    if(!c) {
      this._mouseStarted && this._mouseUp(b), this._mouseDownEvent = b;
      var d = this, e = b.which == 1, f = typeof this.options.cancel == "string" && b.target.nodeName ? a(b.target).closest(this.options.cancel).length : !1;
      if(!e || f || !this._mouseCapture(b)) {
        return!0
      }
      this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
        d.mouseDelayMet = !0
      }, this.options.delay));
      if(this._mouseDistanceMet(b) && this._mouseDelayMet(b)) {
        this._mouseStarted = this._mouseStart(b) !== !1;
        if(!this._mouseStarted) {
          b.preventDefault();
          return!0
        }
      }
      !0 === a.data(b.target, this.widgetName + ".preventClickEvent") && a.removeData(b.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(a) {
        return d._mouseMove(a)
      }, this._mouseUpDelegate = function(a) {
        return d._mouseUp(a)
      }, a(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), b.preventDefault(), c = !0;
      return!0
    }
  }, _mouseMove:function(b) {
    if(a.browser.msie && !(document.documentMode >= 9) && !b.button) {
      return this._mouseUp(b)
    }
    if(this._mouseStarted) {
      this._mouseDrag(b);
      return b.preventDefault()
    }
    this._mouseDistanceMet(b) && this._mouseDelayMet(b) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, b) !== !1, this._mouseStarted ? this._mouseDrag(b) : this._mouseUp(b));
    return!this._mouseStarted
  }, _mouseUp:function(b) {
    a(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, b.target == this._mouseDownEvent.target && a.data(b.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(b));
    return!1
  }, _mouseDistanceMet:function(a) {
    return Math.max(Math.abs(this._mouseDownEvent.pageX - a.pageX), Math.abs(this._mouseDownEvent.pageY - a.pageY)) >= this.options.distance
  }, _mouseDelayMet:function(a) {
    return this.mouseDelayMet
  }, _mouseStart:function(a) {
  }, _mouseDrag:function(a) {
  }, _mouseStop:function(a) {
  }, _mouseCapture:function(a) {
    return!0
  }})
})(jQuery);
(function(a, b) {
  if(a.cleanData) {
    var c = a.cleanData;
    a.cleanData = function(b) {
      for(var d = 0, e;(e = b[d]) != null;d++) {
        try {
          a(e).triggerHandler("remove")
        }catch(f) {
        }
      }
      c(b)
    }
  }else {
    var d = a.fn.remove;
    a.fn.remove = function(b, c) {
      return this.each(function() {
        c || (!b || a.filter(b, [this]).length) && a("*", this).add([this]).each(function() {
          try {
            a(this).triggerHandler("remove")
          }catch(b) {
          }
        });
        return d.call(a(this), b, c)
      })
    }
  }
  a.widget = function(b, c, d) {
    var e = b.split(".")[0], f;
    b = b.split(".")[1], f = e + "-" + b, d || (d = c, c = a.Widget), a.expr[":"][f] = function(c) {
      return!!a.data(c, b)
    }, a[e] = a[e] || {}, a[e][b] = function(a, b) {
      arguments.length && this._createWidget(a, b)
    };
    var g = new c;
    g.options = a.extend(!0, {}, g.options), a[e][b].prototype = a.extend(!0, g, {namespace:e, widgetName:b, widgetEventPrefix:a[e][b].prototype.widgetEventPrefix || b, widgetBaseClass:f}, d), a.widget.bridge(b, a[e][b])
  }, a.widget.bridge = function(c, d) {
    a.fn[c] = function(e) {
      var f = typeof e == "string", g = Array.prototype.slice.call(arguments, 1), h = this;
      e = !f && g.length ? a.extend.apply(null, [!0, e].concat(g)) : e;
      if(f && e.charAt(0) === "_") {
        return h
      }
      f ? this.each(function() {
        var d = a.data(this, c), f = d && a.isFunction(d[e]) ? d[e].apply(d, g) : d;
        if(f !== d && f !== b) {
          h = f;
          return!1
        }
      }) : this.each(function() {
        var b = a.data(this, c);
        b ? b.option(e || {})._init() : a.data(this, c, new d(e, this))
      });
      return h
    }
  }, a.Widget = function(a, b) {
    arguments.length && this._createWidget(a, b)
  }, a.Widget.prototype = {widgetName:"widget", widgetEventPrefix:"", options:{disabled:!1}, _createWidget:function(b, c) {
    a.data(c, this.widgetName, this), this.element = a(c), this.options = a.extend(!0, {}, this.options, this._getCreateOptions(), b);
    var d = this;
    this.element.bind("remove." + this.widgetName, function() {
      d.destroy()
    }), this._create(), this._trigger("create"), this._init()
  }, _getCreateOptions:function() {
    return a.metadata && a.metadata.get(this.element[0])[this.widgetName]
  }, _create:function() {
  }, _init:function() {
  }, destroy:function() {
    this.element.unbind("." + this.widgetName).removeData(this.widgetName), this.widget().unbind("." + this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass + "-disabled " + "ui-state-disabled")
  }, widget:function() {
    return this.element
  }, option:function(c, d) {
    var e = c;
    if(arguments.length === 0) {
      return a.extend({}, this.options)
    }
    if(typeof c == "string") {
      if(d === b) {
        return this.options[c]
      }
      e = {}, e[c] = d
    }
    this._setOptions(e);
    return this
  }, _setOptions:function(b) {
    var c = this;
    a.each(b, function(a, b) {
      c._setOption(a, b)
    });
    return this
  }, _setOption:function(a, b) {
    this.options[a] = b, a === "disabled" && this.widget()[b ? "addClass" : "removeClass"](this.widgetBaseClass + "-disabled" + " " + "ui-state-disabled").attr("aria-disabled", b);
    return this
  }, enable:function() {
    return this._setOption("disabled", !1)
  }, disable:function() {
    return this._setOption("disabled", !0)
  }, _trigger:function(b, c, d) {
    var e, f, g = this.options[b];
    d = d || {}, c = a.Event(c), c.type = (b === this.widgetEventPrefix ? b : this.widgetEventPrefix + b).toLowerCase(), c.target = this.element[0], f = c.originalEvent;
    if(f) {
      for(e in f) {
        e in c || (c[e] = f[e])
      }
    }
    this.element.trigger(c, d);
    return!(a.isFunction(g) && g.call(this.element[0], c, d) === !1 || c.isDefaultPrevented())
  }}
})(jQuery);
(function(a, h, y) {
  var w = "function", v = "password", j = "maxLength", n = "type", b = "", c = true, u = "placeholder", i = false, t = "watermark", g = t, f = "watermarkClass", q = "watermarkFocus", l = "watermarkSubmit", o = "watermarkMaxLength", e = "watermarkPassword", d = "watermarkText", k = /\r/g, s = "input:data(" + g + "),textarea:data(" + g + ")", m = "input:text,input:password,input[type=search],input:not([type]),textarea", p = ["Page_ClientValidate"], r = i, x = u in document.createElement("input");
  a.watermark = a.watermark || {version:"3.1.3", runOnce:c, options:{className:t, useNative:c, hideBeforeUnload:c}, hide:function(b) {
    a(b).filter(s).each(function() {
      a.watermark._hide(a(this))
    })
  }, _hide:function(a, r) {
    var p = a[0], q = (p.value || b).replace(k, b), l = a.data(d) || b, m = a.data(o) || 0, i = a.data(f);
    if(l.length && q == l) {
      p.value = b;
      if(a.data(e)) {
        if((a.attr(n) || b) === "text") {
          var g = a.data(e) || [], c = a.parent() || [];
          if(g.length && c.length) {
            c[0].removeChild(a[0]);
            c[0].appendChild(g[0]);
            a = g
          }
        }
      }
      if(m) {
        a.attr(j, m);
        a.removeData(o)
      }
      if(r) {
        a.attr("autocomplete", "off");
        h.setTimeout(function() {
          a.select()
        }, 1)
      }
    }
    i && a.removeClass(i)
  }, show:function(b) {
    a(b).filter(s).each(function() {
      a.watermark._show(a(this))
    })
  }, _show:function(g) {
    var p = g[0], u = (p.value || b).replace(k, b), h = g.data(d) || b, s = g.attr(n) || b, t = g.data(f);
    if((u.length == 0 || u == h) && !g.data(q)) {
      r = c;
      if(g.data(e)) {
        if(s === v) {
          var m = g.data(e) || [], l = g.parent() || [];
          if(m.length && l.length) {
            l[0].removeChild(g[0]);
            l[0].appendChild(m[0]);
            g = m;
            g.attr(j, h.length);
            p = g[0]
          }
        }
      }
      if(s === "text" || s === "search") {
        var i = g.attr(j) || 0;
        if(i > 0 && h.length > i) {
          g.data(o, i);
          g.attr(j, h.length)
        }
      }
      t && g.addClass(t);
      p.value = h
    }else {
      a.watermark._hide(g)
    }
  }, hideAll:function() {
    if(r) {
      a.watermark.hide(m);
      r = i
    }
  }, showAll:function() {
    a.watermark.show(m)
  }};
  a.fn.watermark = a.fn.watermark || function(p, o) {
    var t = "string";
    if(!this.length) {
      return this
    }
    var s = i, r = typeof p === t;
    if(r) {
      p = p.replace(k, b)
    }
    if(typeof o === "object") {
      s = typeof o.className === t;
      o = a.extend({}, a.watermark.options, o)
    }else {
      if(typeof o === t) {
        s = c;
        o = a.extend({}, a.watermark.options, {className:o})
      }else {
        o = a.watermark.options
      }
    }
    if(typeof o.useNative !== w) {
      o.useNative = o.useNative ? function() {
        return c
      } : function() {
        return i
      }
    }
    return this.each(function() {
      var B = "dragleave", A = "dragenter", z = this, i = a(z);
      if(!i.is(m)) {
        return
      }
      if(i.data(g)) {
        if(r || s) {
          a.watermark._hide(i);
          r && i.data(d, p);
          s && i.data(f, o.className)
        }
      }else {
        if(x && o.useNative.call(z, i) && (i.attr("tagName") || b) !== "TEXTAREA") {
          r && i.attr(u, p);
          return
        }
        i.data(d, r ? p : b);
        i.data(f, o.className);
        i.data(g, 1);
        if((i.attr(n) || b) === v) {
          var C = i.wrap("<span>").parent(), t = a(C.html().replace(/type=["']?password["']?/i, 'type="text"'));
          t.data(d, i.data(d));
          t.data(f, i.data(f));
          t.data(g, 1);
          t.attr(j, p.length);
          t.focus(function() {
            a.watermark._hide(t, c)
          }).bind(A, function() {
            a.watermark._hide(t)
          }).bind("dragend", function() {
            h.setTimeout(function() {
              t.blur()
            }, 1)
          });
          i.blur(function() {
            a.watermark._show(i)
          }).bind(B, function() {
            a.watermark._show(i)
          });
          t.data(e, i);
          i.data(e, t)
        }else {
          i.focus(function() {
            i.data(q, 1);
            a.watermark._hide(i, c)
          }).blur(function() {
            i.data(q, 0);
            a.watermark._show(i)
          }).bind(A, function() {
            a.watermark._hide(i)
          }).bind(B, function() {
            a.watermark._show(i)
          }).bind("dragend", function() {
            h.setTimeout(function() {
              a.watermark._show(i)
            }, 1)
          }).bind("drop", function(e) {
            var c = i[0], a = e.originalEvent.dataTransfer.getData("Text");
            if((c.value || b).replace(k, b).replace(a, b) === i.data(d)) {
              c.value = a
            }
            i.focus()
          })
        }
        if(z.form) {
          var w = z.form, y = a(w);
          if(!y.data(l)) {
            y.submit(a.watermark.hideAll);
            if(w.submit) {
              y.data(l, w.submit);
              w.submit = function(c, b) {
                return function() {
                  var d = b.data(l);
                  a.watermark.hideAll();
                  if(d.apply) {
                    d.apply(c, Array.prototype.slice.call(arguments))
                  }else {
                    d()
                  }
                }
              }(w, y)
            }else {
              y.data(l, 1);
              w.submit = function(b) {
                return function() {
                  a.watermark.hideAll();
                  delete b.submit;
                  b.submit()
                }
              }(w)
            }
          }
        }
      }
      a.watermark._show(i)
    })
  };
  if(a.watermark.runOnce) {
    a.watermark.runOnce = i;
    a.extend(a.expr[":"], {data:function(c, d, b) {
      return!!a.data(c, b[3])
    }});
    (function(c) {
      a.fn.val = function() {
        var e = this;
        if(!e.length) {
          return arguments.length ? e : y
        }
        if(!arguments.length) {
          if(e.data(g)) {
            var f = (e[0].value || b).replace(k, b);
            return f === (e.data(d) || b) ? b : f
          }else {
            return c.apply(e, arguments)
          }
        }else {
          c.apply(e, arguments);
          a.watermark.show(e);
          return e
        }
      }
    })(a.fn.val);
    p.length && a(function() {
      for(var b, c, d = p.length - 1;d >= 0;d--) {
        b = p[d];
        c = h[b];
        if(typeof c === w) {
          h[b] = function(b) {
            return function() {
              a.watermark.hideAll();
              return b.apply(null, Array.prototype.slice.call(arguments))
            }
          }(c)
        }
      }
    });
    a(h).bind("beforeunload", function() {
      a.watermark.options.hideBeforeUnload && a.watermark.hideAll()
    })
  }
})(jQuery, window);
var JSON;
if(!JSON) {
  JSON = {}
}
(function() {
  function f(n) {
    return n < 10 ? "0" + n : n
  }
  if(typeof Date.prototype.toJSON !== "function") {
    Date.prototype.toJSON = function(key) {
      return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null
    };
    String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function(key) {
      return this.valueOf()
    }
  }
  var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = {"\b":"\\b", "\t":"\\t", "\n":"\\n", "\f":"\\f", "\r":"\\r", '"':'\\"', "\\":"\\\\"}, rep;
  function quote(string) {
    escapable.lastIndex = 0;
    return escapable.test(string) ? '"' + string.replace(escapable, function(a) {
      var c = meta[a];
      return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
    }) + '"' : '"' + string + '"'
  }
  function str(key, holder) {
    var i, k, v, length, mind = gap, partial, value = holder[key];
    if(value && typeof value === "object" && typeof value.toJSON === "function") {
      value = value.toJSON(key)
    }
    if(typeof rep === "function") {
      value = rep.call(holder, key, value)
    }
    switch(typeof value) {
      case "string":
        return quote(value);
      case "number":
        return isFinite(value) ? String(value) : "null";
      case "boolean":
      ;
      case "null":
        return String(value);
      case "object":
        if(!value) {
          return"null"
        }
        gap += indent;
        partial = [];
        if(Object.prototype.toString.apply(value) === "[object Array]") {
          length = value.length;
          for(i = 0;i < length;i += 1) {
            partial[i] = str(i, value) || "null"
          }
          v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]";
          gap = mind;
          return v
        }
        if(rep && typeof rep === "object") {
          length = rep.length;
          for(i = 0;i < length;i += 1) {
            if(typeof rep[i] === "string") {
              k = rep[i];
              v = str(k, value);
              if(v) {
                partial.push(quote(k) + (gap ? ": " : ":") + v)
              }
            }
          }
        }else {
          for(k in value) {
            if(Object.prototype.hasOwnProperty.call(value, k)) {
              v = str(k, value);
              if(v) {
                partial.push(quote(k) + (gap ? ": " : ":") + v)
              }
            }
          }
        }
        v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}";
        gap = mind;
        return v
    }
  }
  if(typeof JSON.stringify !== "function") {
    JSON.stringify = function(value, replacer, space) {
      var i;
      gap = "";
      indent = "";
      if(typeof space === "number") {
        for(i = 0;i < space;i += 1) {
          indent += " "
        }
      }else {
        if(typeof space === "string") {
          indent = space
        }
      }
      rep = replacer;
      if(replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) {
        throw new Error("JSON.stringify");
      }
      return str("", {"":value})
    }
  }
  if(typeof JSON.parse !== "function") {
    JSON.parse = function(text, reviver) {
      var j;
      function walk(holder, key) {
        var k, v, value = holder[key];
        if(value && typeof value === "object") {
          for(k in value) {
            if(Object.prototype.hasOwnProperty.call(value, k)) {
              v = walk(value, k);
              if(v !== undefined) {
                value[k] = v
              }else {
                delete value[k]
              }
            }
          }
        }
        return reviver.call(holder, key, value)
      }
      text = String(text);
      cx.lastIndex = 0;
      if(cx.test(text)) {
        text = text.replace(cx, function(a) {
          return"\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
        })
      }
      if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) {
        j = eval("(" + text + ")");
        return typeof reviver === "function" ? walk({"":j}, "") : j
      }
      throw new SyntaxError("JSON.parse");
    }
  }
})();
window.Modernizr = function(a, b, c) {
  function x(a) {
    j.cssText = a
  }
  function y(a, b) {
    return x(m.join(a + ";") + (b || ""))
  }
  function z(a, b) {
    return typeof a === b
  }
  function A(a, b) {
    return!!~("" + a).indexOf(b)
  }
  function B(a, b, d) {
    for(var e in a) {
      var f = b[a[e]];
      if(f !== c) {
        return d === !1 ? a[e] : z(f, "function") ? f.bind(d || b) : f
      }
    }
    return!1
  }
  var d = "2.5.2", e = {}, f = !0, g = b.documentElement, h = "modernizr", i = b.createElement(h), j = i.style, k, l = {}.toString, m = " -webkit- -moz- -o- -ms- ".split(" "), n = {}, o = {}, p = {}, q = [], r = q.slice, s, t = function(a, c, d, e) {
    var f, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body");
    if(parseInt(d, 10)) {
      while(d--) {
        j = b.createElement("div"), j.id = e ? e[d] : h + (d + 1), k.appendChild(j)
      }
    }
    return f = ["&#173;", "<style>", a, "</style>"].join(""), k.id = h, m.innerHTML += f, m.appendChild(k), l || g.appendChild(m), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i
  }, u = function(b) {
    var c = a.matchMedia || a.msMatchMedia;
    if(c) {
      return c(b).matches
    }
    var d;
    return t("@media " + b + " { #" + h + " { position: absolute; } }", function(b) {
      d = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle)["position"] == "absolute"
    }), d
  }, v = {}.hasOwnProperty, w;
  !z(v, "undefined") && !z(v.call, "undefined") ? w = function(a, b) {
    return v.call(a, b)
  } : w = function(a, b) {
    return b in a && z(a.constructor.prototype[b], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(b) {
    var c = this;
    if(typeof c != "function") {
      throw new TypeError;
    }
    var d = r.call(arguments, 1), e = function() {
      if(this instanceof e) {
        var a = function() {
        };
        a.prototype = c.prototype;
        var f = new a, g = c.apply(f, d.concat(r.call(arguments)));
        return Object(g) === g ? g : f
      }
      return c.apply(b, d.concat(r.call(arguments)))
    };
    return e
  });
  var C = function(c, d) {
    var f = c.join(""), g = d.length;
    t(f, function(c, d) {
      var f = b.styleSheets[b.styleSheets.length - 1], h = f ? f.cssRules && f.cssRules[0] ? f.cssRules[0].cssText : f.cssText || "" : "", i = c.childNodes, j = {};
      while(g--) {
        j[i[g].id] = i[g]
      }
      e.touch = "ontouchstart" in a || a.DocumentTouch && b instanceof DocumentTouch || (j.touch && j.touch.offsetTop) === 9
    }, g, d)
  }([, ["@media (", m.join("touch-enabled),("), h, ")", "{#touch{top:9px;position:absolute}}"].join("")], [, "touch"]);
  n.touch = function() {
    return e.touch
  };
  for(var D in n) {
    w(n, D) && (s = D.toLowerCase(), e[s] = n[D](), q.push((e[s] ? "" : "no-") + s))
  }
  return e.addTest = function(a, b) {
    if(typeof a == "object") {
      for(var d in a) {
        w(a, d) && e.addTest(d, a[d])
      }
    }else {
      a = a.toLowerCase();
      if(e[a] !== c) {
        return e
      }
      b = typeof b == "function" ? b() : b, g.className += " " + (b ? "" : "no-") + a, e[a] = b
    }
    return e
  }, x(""), i = k = null, e._version = d, e._prefixes = m, e.mq = u, e.testStyles = t, g.className = g.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (f ? " js " + q.join(" ") : ""), e
}(this, this.document), function(a, b, c) {
  function d(a) {
    return o.call(a) == "[object Function]"
  }
  function e(a) {
    return typeof a == "string"
  }
  function f() {
  }
  function g(a) {
    return!a || a == "loaded" || a == "complete" || a == "uninitialized"
  }
  function h() {
    var a = p.shift();
    q = 1, a ? a.t ? m(function() {
      (a.t == "c" ? B.injectCss : B.injectJs)(a.s, 0, a.a, a.x, a.e, 1)
    }, 0) : (a(), h()) : q = 0
  }
  function i(a, c, d, e, f, i, j) {
    function k(b) {
      if(!o && g(l.readyState) && (u.r = o = 1, !q && h(), l.onload = l.onreadystatechange = null, b)) {
        a != "img" && m(function() {
          t.removeChild(l)
        }, 50);
        for(var d in y[c]) {
          y[c].hasOwnProperty(d) && y[c][d].onload()
        }
      }
    }
    var j = j || B.errorTimeout, l = {}, o = 0, r = 0, u = {t:d, s:c, e:f, a:i, x:j};
    y[c] === 1 && (r = 1, y[c] = [], l = b.createElement(a)), a == "object" ? l.data = c : (l.src = c, l.type = a), l.width = l.height = "0", l.onerror = l.onload = l.onreadystatechange = function() {
      k.call(this, r)
    }, p.splice(e, 0, u), a != "img" && (r || y[c] === 2 ? (t.insertBefore(l, s ? null : n), m(k, j)) : y[c].push(l))
  }
  function j(a, b, c, d, f) {
    return q = 0, b = b || "j", e(a) ? i(b == "c" ? v : u, a, b, this.i++, c, d, f) : (p.splice(this.i++, 0, a), p.length == 1 && h()), this
  }
  function k() {
    var a = B;
    return a.loader = {load:j, i:0}, a
  }
  var l = b.documentElement, m = a.setTimeout, n = b.getElementsByTagName("script")[0], o = {}.toString, p = [], q = 0, r = "MozAppearance" in l.style, s = r && !!b.createRange().compareNode, t = s ? l : n.parentNode, l = !!b.attachEvent, u = r ? "object" : l ? "script" : "img", v = l ? "script" : u, w = Array.isArray || function(a) {
    return o.call(a) == "[object Array]"
  }, x = [], y = {}, z = {timeout:function(a, b) {
    return b.length && (a.timeout = b[0]), a
  }}, A, B;
  B = function(a) {
    function b(a) {
      var a = a.split("!"), b = x.length, c = a.pop(), d = a.length, c = {url:c, origUrl:c, prefixes:a}, e, f, g;
      for(f = 0;f < d;f++) {
        g = a[f].split("="), (e = z[g.shift()]) && (c = e(c, g))
      }
      for(f = 0;f < b;f++) {
        c = x[f](c)
      }
      return c
    }
    function g(a, e, f, g, i) {
      var j = b(a), l = j.autoCallback;
      j.url.split(".").pop().split("?").shift(), j.bypass || (e && (e = d(e) ? e : e[a] || e[g] || e[a.split("/").pop().split("?")[0]] || h), j.instead ? j.instead(a, e, f, g, i) : (y[j.url] ? j.noexec = !0 : y[j.url] = 1, f.load(j.url, j.forceCSS || !j.forceJS && "css" == j.url.split(".").pop().split("?").shift() ? "c" : c, j.noexec, j.attrs, j.timeout), (d(e) || d(l)) && f.load(function() {
        k(), e && e(j.origUrl, i, g), l && l(j.origUrl, i, g), y[j.url] = 2
      })))
    }
    function i(a, b) {
      function c(a, c) {
        if(a) {
          if(e(a)) {
            c || (j = function() {
              var a = [].slice.call(arguments);
              k.apply(this, a), l()
            }), g(a, j, b, 0, h)
          }else {
            if(Object(a) === a) {
              for(n in m = function() {
                var b = 0, c;
                for(c in a) {
                  a.hasOwnProperty(c) && b++
                }
                return b
              }(), a) {
                a.hasOwnProperty(n) && (!c && !--m && (d(j) ? j = function() {
                  var a = [].slice.call(arguments);
                  k.apply(this, a), l()
                } : j[n] = function(a) {
                  return function() {
                    var b = [].slice.call(arguments);
                    a && a.apply(this, b), l()
                  }
                }(k[n])), g(a[n], j, b, n, h))
              }
            }
          }
        }else {
          !c && l()
        }
      }
      var h = !!a.test, i = a.load || a.both, j = a.callback || f, k = j, l = a.complete || f, m, n;
      c(h ? a.yep : a.nope, !!i), i && c(i)
    }
    var j, l, m = this.yepnope.loader;
    if(e(a)) {
      g(a, 0, m, 0)
    }else {
      if(w(a)) {
        for(j = 0;j < a.length;j++) {
          l = a[j], e(l) ? g(l, 0, m, 0) : w(l) ? B(l) : Object(l) === l && i(l, m)
        }
      }else {
        Object(a) === a && i(a, m)
      }
    }
  }, B.addPrefix = function(a, b) {
    z[a] = b
  }, B.addFilter = function(a) {
    x.push(a)
  }, B.errorTimeout = 1E4, b.readyState == null && b.addEventListener && (b.readyState = "loading", b.addEventListener("DOMContentLoaded", A = function() {
    b.removeEventListener("DOMContentLoaded", A, 0), b.readyState = "complete"
  }, 0)), a.yepnope = k(), a.yepnope.executeStack = h, a.yepnope.injectJs = function(a, c, d, e, i, j) {
    var k = b.createElement("script"), l, o, e = e || B.errorTimeout;
    k.src = a;
    for(o in d) {
      k.setAttribute(o, d[o])
    }
    c = j ? h : c || f, k.onreadystatechange = k.onload = function() {
      !l && g(k.readyState) && (l = 1, c(), k.onload = k.onreadystatechange = null)
    }, m(function() {
      l || (l = 1, c(1))
    }, e), i ? k.onload() : n.parentNode.insertBefore(k, n)
  }, a.yepnope.injectCss = function(a, c, d, e, g, i) {
    var e = b.createElement("link"), j, c = i ? h : c || f;
    e.href = a, e.rel = "stylesheet", e.type = "text/css";
    for(j in d) {
      e.setAttribute(j, d[j])
    }
    g || (n.parentNode.insertBefore(e, n), m(c, 0))
  }
}(this, document), Modernizr.load = function() {
  yepnope.apply(window, [].slice.call(arguments, 0))
}, Modernizr.addTest("ie8compat", function() {
  return!window.addEventListener && document.documentMode && document.documentMode === 7
});
window.Modernizr = function(a, b, c) {
  function v(a) {
    i.cssText = a
  }
  function w(a, b) {
    return v(prefixes.join(a + ";") + (b || ""))
  }
  function x(a, b) {
    return typeof a === b
  }
  function y(a, b) {
    return!!~("" + a).indexOf(b)
  }
  function z(a, b, d) {
    for(var e in a) {
      var f = b[a[e]];
      if(f !== c) {
        return d === !1 ? a[e] : x(f, "function") ? f.bind(d || b) : f
      }
    }
    return!1
  }
  var d = "2.5.3", e = {}, f = b.documentElement, g = "modernizr", h = b.createElement(g), i = h.style, j, k = {}.toString, l = {}, m = {}, n = {}, o = [], p = o.slice, q, r = function(a, c, d, e) {
    var h, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body");
    if(parseInt(d, 10)) {
      while(d--) {
        j = b.createElement("div"), j.id = e ? e[d] : g + (d + 1), k.appendChild(j)
      }
    }
    return h = ["&#173;", "<style>", a, "</style>"].join(""), k.id = g, (l ? k : m).innerHTML += h, m.appendChild(k), l || (m.style.background = "", f.appendChild(m)), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i
  }, s = function(b) {
    var c = a.matchMedia || a.msMatchMedia;
    if(c) {
      return c(b).matches
    }
    var d;
    return r("@media " + b + " { #" + g + " { position: absolute; } }", function(b) {
      d = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle)["position"] == "absolute"
    }), d
  }, t = {}.hasOwnProperty, u;
  !x(t, "undefined") && !x(t.call, "undefined") ? u = function(a, b) {
    return t.call(a, b)
  } : u = function(a, b) {
    return b in a && x(a.constructor.prototype[b], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(b) {
    var c = this;
    if(typeof c != "function") {
      throw new TypeError;
    }
    var d = p.call(arguments, 1), e = function() {
      if(this instanceof e) {
        var a = function() {
        };
        a.prototype = c.prototype;
        var f = new a, g = c.apply(f, d.concat(p.call(arguments)));
        return Object(g) === g ? g : f
      }
      return c.apply(b, d.concat(p.call(arguments)))
    };
    return e
  });
  for(var A in l) {
    u(l, A) && (q = A.toLowerCase(), e[q] = l[A](), o.push((e[q] ? "" : "no-") + q))
  }
  return v(""), h = j = null, e._version = d, e.mq = s, e.testStyles = r, e
}(this, this.document);
var getTrans = function(s) {
  if(typeof VISH !== "undefined" && typeof VISH.Editor !== "undefined" && typeof VISH.Editor.I18n !== "undefined") {
    var translate = VISH.Editor.I18n.getTrans(s);
    if(translate != null) {
      return translate
    }
  }
  return s
};
var bkExtend = function() {
  var args = arguments;
  if(args.length == 1) {
    args = [this, args[0]]
  }
  for(var prop in args[1]) {
    args[0][prop] = args[1][prop]
  }
  return args[0]
};
function bkClass() {
}
bkClass.prototype.construct = function() {
};
bkClass.extend = function(def) {
  var classDef = function() {
    if(arguments[0] !== bkClass) {
      return this.construct.apply(this, arguments)
    }
  };
  var proto = new this(bkClass);
  bkExtend(proto, def);
  classDef.prototype = proto;
  classDef.extend = this.extend;
  return classDef
};
var bkElement = bkClass.extend({construct:function(elm, d) {
  if(typeof elm == "string") {
    elm = (d || document).createElement(elm)
  }
  elm = $BK(elm);
  return elm
}, appendTo:function(elm) {
  elm.appendChild(this);
  return this
}, appendBefore:function(elm) {
  elm.parentNode.insertBefore(this, elm);
  return this
}, addEvent:function(type, fn) {
  bkLib.addEvent(this, type, fn);
  return this
}, setContent:function(c) {
  this.innerHTML = c;
  return this
}, pos:function() {
  var curleft = curtop = 0;
  var o = obj = this;
  if(obj.offsetParent) {
    do {
      curleft += obj.offsetLeft;
      curtop += obj.offsetTop
    }while(obj = obj.offsetParent)
  }
  var b = !window.opera ? parseInt(this.getStyle("border-width") || this.style.border) || 0 : 0;
  return[curleft + b, curtop + b + this.offsetHeight]
}, noSelect:function() {
  bkLib.noSelect(this);
  return this
}, parentTag:function(t) {
  var elm = this;
  do {
    if(elm && elm.nodeName && elm.nodeName.toUpperCase() == t) {
      return elm
    }
    elm = elm.parentNode
  }while(elm);
  return false
}, hasClass:function(cls) {
  return this.className.match(new RegExp("(\\s|^)nicEdit-" + cls + "(\\s|$)"))
}, addClass:function(cls) {
  if(!this.hasClass(cls)) {
    this.className += " nicEdit-" + cls
  }
  return this
}, removeClass:function(cls) {
  if(this.hasClass(cls)) {
    this.className = this.className.replace(new RegExp("(\\s|^)nicEdit-" + cls + "(\\s|$)"), " ")
  }
  return this
}, setStyle:function(st) {
  var elmStyle = this.style;
  for(var itm in st) {
    switch(itm) {
      case "float":
        elmStyle["cssFloat"] = elmStyle["styleFloat"] = st[itm];
        break;
      case "opacity":
        elmStyle.opacity = st[itm];
        elmStyle.filter = "alpha(opacity=" + Math.round(st[itm] * 100) + ")";
        break;
      case "className":
        this.className = st[itm];
        break;
      default:
        elmStyle[itm] = st[itm]
    }
  }
  return this
}, getStyle:function(cssRule, d) {
  var doc = !d ? document.defaultView : d;
  if(this.nodeType == 1) {
    return doc && doc.getComputedStyle ? doc.getComputedStyle(this, null).getPropertyValue(cssRule) : this.currentStyle[bkLib.camelize(cssRule)]
  }
}, remove:function() {
  this.parentNode.removeChild(this);
  return this
}, setAttributes:function(at) {
  for(var itm in at) {
    this[itm] = at[itm]
  }
  return this
}});
var bkLib = {isMSIE:navigator.appVersion.indexOf("MSIE") != -1, addEvent:function(obj, type, fn) {
  obj.addEventListener ? obj.addEventListener(type, fn, false) : obj.attachEvent("on" + type, fn)
}, toArray:function(iterable) {
  var length = iterable.length, results = new Array(length);
  while(length--) {
    results[length] = iterable[length]
  }
  return results
}, noSelect:function(element) {
  if(element.setAttribute && element.nodeName.toLowerCase() != "input" && element.nodeName.toLowerCase() != "textarea") {
    element.setAttribute("unselectable", "on")
  }
  for(var i = 0;i < element.childNodes.length;i++) {
    bkLib.noSelect(element.childNodes[i])
  }
}, camelize:function(s) {
  return s.replace(/\-(.)/g, function(m, l) {
    return l.toUpperCase()
  })
}, inArray:function(arr, item) {
  return bkLib.search(arr, item) != null
}, search:function(arr, itm) {
  for(var i = 0;i < arr.length;i++) {
    if(arr[i] == itm) {
      return i
    }
  }
  return null
}, cancelEvent:function(e) {
  e = e || window.event;
  if(e.preventDefault && e.stopPropagation) {
    e.preventDefault();
    e.stopPropagation()
  }
  return false
}, domLoad:[], domLoaded:function() {
  if(arguments.callee.done) {
    return
  }
  arguments.callee.done = true;
  for(i = 0;i < bkLib.domLoad.length;i++) {
    bkLib.domLoad[i]()
  }
}, onDomLoaded:function(fireThis) {
  this.domLoad.push(fireThis);
  if(document.addEventListener) {
    document.addEventListener("DOMContentLoaded", bkLib.domLoaded, null)
  }else {
    if(bkLib.isMSIE) {
      document.write("<style>.nicEdit-main p { margin: 0; }</style><scr" + "ipt id=__ie_onload defer " + (location.protocol == "https:" ? "src='javascript:void(0)'" : "src=//0") + "></scr" + "ipt>");
      $BK("__ie_onload").onreadystatechange = function() {
        if(this.readyState == "complete") {
          bkLib.domLoaded()
        }
      }
    }
  }
  window.onload = bkLib.domLoaded
}};
function $BK(elm) {
  if(typeof elm == "string") {
    elm = document.getElementById(elm)
  }
  return elm && !elm.appendTo ? bkExtend(elm, bkElement.prototype) : elm
}
var bkEvent = {addEvent:function(evType, evFunc) {
  if(evFunc) {
    this.eventList = this.eventList || {};
    this.eventList[evType] = this.eventList[evType] || [];
    this.eventList[evType].push(evFunc)
  }
  return this
}, fireEvent:function() {
  var args = bkLib.toArray(arguments), evType = args.shift();
  if(this.eventList && this.eventList[evType]) {
    for(var i = 0;i < this.eventList[evType].length;i++) {
      this.eventList[evType][i].apply(this, args)
    }
  }
}};
function __(s) {
  return s
}
Function.prototype.closure = function() {
  var __method = this, args = bkLib.toArray(arguments), obj = args.shift();
  return function() {
    if(typeof bkLib != "undefined") {
      return __method.apply(obj, args.concat(bkLib.toArray(arguments)))
    }
  }
};
Function.prototype.closureListener = function() {
  var __method = this, args = bkLib.toArray(arguments), object = args.shift();
  return function(e) {
    e = e || window.event;
    if(e.target) {
      var target = e.target
    }else {
      var target = e.srcElement
    }
    return __method.apply(object, [e, target].concat(args))
  }
};
var nicEditorInit = function() {
  nicEditorConfig = bkClass.extend({buttons:{"bold":{name:__("Click to Bold"), command:"Bold", tags:["B", "STRONG"], css:{"font-weight":"bold"}, key:"b"}, "italic":{name:__("Click to Italic"), command:"Italic", tags:["EM", "I"], css:{"font-style":"italic"}, key:"i"}, "underline":{name:__("Click to Underline"), command:"Underline", tags:["U"], css:{"text-decoration":"underline"}, key:"u"}, "left":{name:__("Left Align"), command:"justifyleft", noActive:true}, "center":{name:__("Center Align"), command:"justifycenter", 
  noActive:true}, "right":{name:__("Right Align"), command:"justifyright", noActive:true}, "justify":{name:__("Justify Align"), command:"justifyfull", noActive:true}, "ol":{name:__("Insert Ordered List"), command:"insertorderedlist", tags:["OL"]}, "ul":{name:__("Insert Unordered List"), command:"insertunorderedlist", tags:["UL"]}, "subscript":{name:__("Click to Subscript"), command:"subscript", tags:["SUB"]}, "superscript":{name:__("Click to Superscript"), command:"superscript", tags:["SUP"]}, "strikethrough":{name:__("Click to Strike Through"), 
  command:"strikeThrough", css:{"text-decoration":"line-through"}}, "removeformat":{name:__("Remove Formatting"), command:"removeformat", noActive:true}, "indent":{name:__("Indent Text"), command:"indent", noActive:true}, "outdent":{name:__("Remove Indent"), command:"outdent", noActive:true}, "hr":{name:__("Horizontal Rule"), command:"insertHorizontalRule", noActive:true}}, iconsPath:VISH.ImagesPath + "nicEditorIcons.gif", buttonList:["save", "bold", "italic", "underline", "left", "center", "right", 
  "justify", "ol", "ul", "fontSize", "fontFamily", "upload", "link", "unlink", "forecolor", "bgcolor"], iconList:{"bgcolor":1, "forecolor":2, "bold":3, "center":4, "hr":5, "indent":6, "italic":7, "justify":8, "left":9, "ol":10, "outdent":11, "removeformat":12, "right":13, "save":24, "strikethrough":15, "subscript":16, "superscript":17, "ul":18, "underline":19, "image":20, "link":21, "unlink":22, "close":23, "arrow":25}})
};
var nicEditorConfig = bkClass.extend({buttons:{"bold":{name:__("Click to Bold"), command:"Bold", tags:["B", "STRONG"], css:{"font-weight":"bold"}, key:"b"}, "italic":{name:__("Click to Italic"), command:"Italic", tags:["EM", "I"], css:{"font-style":"italic"}, key:"i"}, "underline":{name:__("Click to Underline"), command:"Underline", tags:["U"], css:{"text-decoration":"underline"}, key:"u"}, "left":{name:__("Left Align"), command:"justifyleft", noActive:true}, "center":{name:__("Center Align"), command:"justifycenter", 
noActive:true}, "right":{name:__("Right Align"), command:"justifyright", noActive:true}, "justify":{name:__("Justify Align"), command:"justifyfull", noActive:true}, "ol":{name:__("Insert Ordered List"), command:"insertorderedlist", tags:["OL"]}, "ul":{name:__("Insert Unordered List"), command:"insertunorderedlist", tags:["UL"]}, "subscript":{name:__("Click to Subscript"), command:"subscript", tags:["SUB"]}, "superscript":{name:__("Click to Superscript"), command:"superscript", tags:["SUP"]}, "strikethrough":{name:__("Click to Strike Through"), 
command:"strikeThrough", css:{"text-decoration":"line-through"}}, "removeformat":{name:__("Remove Formatting"), command:"removeformat", noActive:true}, "indent":{name:__("Indent Text"), command:"indent", noActive:true}, "outdent":{name:__("Remove Indent"), command:"outdent", noActive:true}, "hr":{name:__("Horizontal Rule"), command:"insertHorizontalRule", noActive:true}}, buttonList:["save", "bold", "italic", "underline", "left", "center", "right", "justify", "ol", "ul", "fontSize", "fontFamily", 
"upload", "link", "unlink", "forecolor", "bgcolor"], iconList:{"bgcolor":1, "forecolor":2, "bold":3, "center":4, "hr":5, "indent":6, "italic":7, "justify":8, "left":9, "ol":10, "outdent":11, "removeformat":12, "right":13, "save":24, "strikethrough":15, "subscript":16, "superscript":17, "ul":18, "underline":19, "image":20, "link":21, "unlink":22, "close":23, "arrow":25}});
var nicEditors = {nicPlugins:[], editors:[], registerPlugin:function(plugin, options) {
  this.nicPlugins.push({p:plugin, o:options})
}, allTextAreas:function(nicOptions) {
  var textareas = document.getElementsByTagName("textarea");
  for(var i = 0;i < textareas.length;i++) {
    nicEditors.editors.push((new nicEditor(nicOptions)).panelInstance(textareas[i]))
  }
  return nicEditors.editors
}, findEditor:function(e) {
  var editors = nicEditors.editors;
  for(var i = 0;i < editors.length;i++) {
    if(editors[i].instanceById(e)) {
      return editors[i].instanceById(e)
    }
  }
}};
var nicEditor = bkClass.extend({construct:function(o) {
  this.options = new nicEditorConfig;
  bkExtend(this.options, o);
  this.nicInstances = new Array;
  this.loadedPlugins = new Array;
  var plugins = nicEditors.nicPlugins;
  for(var i = 0;i < plugins.length;i++) {
    this.loadedPlugins.push(new plugins[i].p(this, plugins[i].o))
  }
  nicEditors.editors.push(this);
  bkLib.addEvent(document.body, "mousedown", this.selectCheck.closureListener(this))
}, panelInstance:function(e, o) {
  e = this.checkReplace($BK(e));
  var panelElm = (new bkElement("DIV")).setStyle({width:(parseInt(e.getStyle("width")) || e.clientWidth) + "px"}).appendBefore(e);
  this.setPanel(panelElm);
  return this.addInstance(e, o)
}, checkReplace:function(e) {
  var r = nicEditors.findEditor(e);
  if(r) {
    r.removeInstance(e);
    r.removePanel()
  }
  return e
}, addInstance:function(e, o) {
  e = this.checkReplace($BK(e));
  if(e.contentEditable || !!window.opera) {
    var newInstance = new nicEditorInstance(e, o, this)
  }else {
    var newInstance = new nicEditorIFrameInstance(e, o, this)
  }
  this.nicInstances.push(newInstance);
  return this
}, removeInstance:function(e) {
  e = $BK(e);
  var instances = this.nicInstances;
  for(var i = 0;i < instances.length;i++) {
    if(instances[i].e == e) {
      instances[i].remove();
      this.nicInstances.splice(i, 1)
    }
  }
}, removePanel:function(e) {
  if(this.nicPanel) {
    this.nicPanel.remove();
    this.nicPanel = null
  }
}, instanceById:function(e) {
  e = $BK(e);
  var instances = this.nicInstances;
  for(var i = 0;i < instances.length;i++) {
    if(instances[i].e == e) {
      return instances[i]
    }
  }
}, setPanel:function(e) {
  this.nicPanel = new nicEditorPanel($BK(e), this.options, this);
  this.fireEvent("panel", this.nicPanel);
  return this
}, nicCommand:function(cmd, args) {
  if(this.selectedInstance) {
    this.selectedInstance.nicCommand(cmd, args)
  }
}, getIcon:function(iconName, options) {
  var icon = this.options.iconList[iconName];
  var file = options.iconFiles ? options.iconFiles[iconName] : "";
  return{backgroundImage:"url('" + (icon ? this.options.iconsPath : file) + "')", backgroundPosition:(icon ? (icon - 1) * -18 : 0) + "px 0px"}
}, selectCheck:function(e, t) {
  var found = false;
  do {
    if(t.className && t.className.indexOf("nicEdit") != -1) {
      return false
    }
  }while(t = t.parentNode);
  this.fireEvent("blur", this.selectedInstance, t);
  this.lastSelectedInstance = this.selectedInstance;
  this.selectedInstance = null;
  return false
}});
nicEditor = nicEditor.extend(bkEvent);
var nicEditorInstance = bkClass.extend({isSelected:false, construct:function(G, D, C) {
  this.ne = C;
  this.elm = this.e = G;
  this.options = D || {};
  newX = parseInt(G.getStyle("width")) || G.clientWidth;
  newY = parseInt(G.getStyle("height")) || G.clientHeight;
  this.initialHeight = newY - 8;
  var H = G.nodeName.toLowerCase() == "textarea";
  if(H || this.options.hasPanel) {
    var B = bkLib.isMSIE && !(typeof document.body.style.maxHeight != "undefined" && document.compatMode == "CSS1Compat");
    var E = {width:newX + "px", border:"1px solid #ccc", borderTop:0, overflowY:"auto", overflowX:"hidden"};
    E[B ? "height" : "maxHeight"] = this.ne.options.maxHeight ? this.ne.options.maxHeight + "px" : null;
    this.editorContain = (new bkElement("DIV")).setStyle(E).appendBefore(G);
    var A = (new bkElement("DIV")).setStyle({width:newX - 8 + "px", margin:"4px", minHeight:newY + "px"}).addClass("main").appendTo(this.editorContain);
    G.setStyle({display:"none"});
    A.innerHTML = G.innerHTML;
    if(H) {
      A.setContent(G.value);
      this.copyElm = G;
      var F = G.parentTag("FORM");
      if(F) {
        bkLib.addEvent(F, "submit", this.saveContent.closure(this))
      }
    }
    A.setStyle(B ? {height:newY + "px"} : {overflow:"hidden"});
    this.elm = A
  }
  this.ne.addEvent("blur", this.blur.closure(this));
  this.init();
  this.blur()
}, init:function() {
  this.elm.setAttribute("contentEditable", "true");
  if(this.getContent() == "") {
    this.setContent("<br />")
  }
  this.instanceDoc = document.defaultView;
  this.elm.addEvent("mousedown", this.selected.closureListener(this)).addEvent("keypress", this.keyDown.closureListener(this)).addEvent("focus", this.selected.closure(this)).addEvent("blur", this.blur.closure(this)).addEvent("keyup", this.selected.closure(this));
  this.ne.fireEvent("add", this)
}, remove:function() {
  this.saveContent();
  if(this.copyElm || this.options.hasPanel) {
    this.editorContain.remove();
    this.e.setStyle({display:"block"});
    this.ne.removePanel()
  }
  this.disable();
  this.ne.fireEvent("remove", this)
}, disable:function() {
  this.elm.setAttribute("contentEditable", "false")
}, getSel:function() {
  return window.getSelection ? window.getSelection() : document.selection
}, getRng:function() {
  var A = this.getSel();
  if(!A) {
    return null
  }
  if(A.rangeCount && A.rangeCount > 0) {
    return A.getRangeAt(0)
  }
  if(A.createRange) {
    return A.createRange()
  }
  return null
}, selRng:function(A, B) {
  if(window.getSelection) {
    B.removeAllRanges();
    B.addRange(A)
  }else {
    A.select()
  }
}, selElm:function() {
  var C = this.getRng();
  if(!C) {
    return null
  }
  if(C.startContainer) {
    var D = C.startContainer;
    if(C.cloneContents().childNodes.length == 1) {
      for(var B = 0;B < D.childNodes.length;B++) {
        var A = D.childNodes[B].ownerDocument.createRange();
        A.selectNode(D.childNodes[B]);
        if(C.compareBoundaryPoints(Range.START_TO_START, A) != 1 && C.compareBoundaryPoints(Range.END_TO_END, A) != -1) {
          return $BK(D.childNodes[B])
        }
      }
    }
    return $BK(D)
  }else {
    return $BK(this.getSel().type == "Control" ? C.item(0) : C.parentElement())
  }
}, saveRng:function() {
  this.savedRange = this.getRng();
  this.savedSel = this.getSel()
}, restoreRng:function() {
  if(this.savedRange) {
    this.selRng(this.savedRange, this.savedSel)
  }
}, keyDown:function(B, A) {
  if(B.ctrlKey) {
    this.ne.fireEvent("key", this, B)
  }
}, selected:function(C, A) {
  if(!A) {
    A = this.selElm()
  }
  if(!C.ctrlKey) {
    var B = this.ne.selectedInstance;
    if(B != this) {
      if(B) {
        this.ne.fireEvent("blur", B, A)
      }
      this.ne.selectedInstance = this;
      this.ne.fireEvent("focus", B, A)
    }
    this.ne.fireEvent("selected", B, A);
    this.isFocused = true;
    this.elm.addClass("selected")
  }
  return false
}, blur:function() {
  this.isFocused = false;
  this.elm.removeClass("selected")
}, saveContent:function() {
  if(this.copyElm || this.options.hasPanel) {
    this.ne.fireEvent("save", this);
    this.copyElm ? this.copyElm.value = this.getContent() : this.e.innerHTML = this.getContent()
  }
}, getElm:function() {
  return this.elm
}, getContent:function() {
  this.content = this.getElm().innerHTML;
  this.ne.fireEvent("get", this);
  return this.content
}, setContent:function(A) {
  this.content = A;
  this.ne.fireEvent("set", this);
  this.elm.innerHTML = this.content
}, nicCommand:function(B, A) {
  document.execCommand(B, false, A)
}});
var nicEditorIFrameInstance = nicEditorInstance.extend({savedStyles:[], init:function() {
  var c = this.elm.innerHTML.replace(/^\s+|\s+$/g, "");
  this.elm.innerHTML = "";
  !c ? c = "<br />" : c;
  this.initialContent = c;
  this.elmFrame = (new bkElement("iframe")).setAttributes({"src":"javascript:;", "frameBorder":0, "allowTransparency":"true", "scrolling":"no"}).setStyle({height:"100px", width:"100%"}).addClass("frame").appendTo(this.elm);
  if(this.copyElm) {
    this.elmFrame.setStyle({width:this.elm.offsetWidth - 4 + "px"})
  }
  var styleList = ["font-size", "font-family", "font-weight", "color"];
  for(itm in styleList) {
    this.savedStyles[bkLib.camelize(itm)] = this.elm.getStyle(itm)
  }
  setTimeout(this.initFrame.closure(this), 50)
}, disable:function() {
  this.elm.innerHTML = this.getContent()
}, initFrame:function() {
  var fd = $BK(this.elmFrame.contentWindow.document);
  fd.designMode = "on";
  fd.open();
  var css = this.ne.options.externalCSS;
  fd.write("<html><head>" + (css ? '<link href="' + css + '" rel="stylesheet" type="text/css" />' : "") + '</head><body id="nicEditContent" style="margin: 0 !important; background-color: transparent !important;">' + this.initialContent + "</body></html>");
  fd.close();
  this.frameDoc = fd;
  this.frameWin = $BK(this.elmFrame.contentWindow);
  this.frameContent = $BK(this.frameWin.document.body).setStyle(this.savedStyles);
  this.instanceDoc = this.frameWin.document.defaultView;
  this.heightUpdate();
  this.frameDoc.addEvent("mousedown", this.selected.closureListener(this)).addEvent("keyup", this.heightUpdate.closureListener(this)).addEvent("keydown", this.keyDown.closureListener(this)).addEvent("keyup", this.selected.closure(this));
  this.ne.fireEvent("add", this)
}, getElm:function() {
  return this.frameContent
}, setContent:function(c) {
  this.content = c;
  this.ne.fireEvent("set", this);
  this.frameContent.innerHTML = this.content;
  this.heightUpdate()
}, getSel:function() {
  return this.frameWin ? this.frameWin.getSelection() : this.frameDoc.selection
}, heightUpdate:function() {
  this.elmFrame.style.height = Math.max(this.frameContent.offsetHeight, this.initialHeight) + "px"
}, nicCommand:function(cmd, args) {
  this.frameDoc.execCommand(cmd, false, args);
  setTimeout(this.heightUpdate.closure(this), 100)
}});
var nicEditorPanel = bkClass.extend({construct:function(e, options, nicEditor) {
  this.elm = e;
  this.options = options;
  this.ne = nicEditor;
  this.panelButtons = new Array;
  this.buttonList = bkExtend([], this.ne.options.buttonList);
  this.panelContain = (new bkElement("DIV")).addClass("panelContain");
  this.panelElm = (new bkElement("DIV")).addClass("panel").appendTo(this.panelContain);
  this.panelContain.appendTo($("#toolbar_element")[0]);
  var opt = this.ne.options;
  var buttons = opt.buttons;
  for(button in buttons) {
    this.addButton(button, opt, true)
  }
  this.reorder();
  if(typeof e.noSelect != "undefined") {
    e.noSelect()
  }
}, addButton:function(buttonName, options, noOrder) {
  var button = options.buttons[buttonName];
  var type = button["type"] ? eval("(typeof(" + button["type"] + ') == "undefined") ? null : ' + button["type"] + ";") : nicEditorButton;
  var hasButton = bkLib.inArray(this.buttonList, buttonName);
  if(type && (hasButton || this.ne.options.fullPanel)) {
    this.panelButtons.push(new type(this.panelElm, buttonName, options, this.ne));
    if(!hasButton) {
      this.buttonList.push(buttonName)
    }
  }
}, findButton:function(itm) {
  for(var i = 0;i < this.panelButtons.length;i++) {
    if(this.panelButtons[i].name == itm) {
      return this.panelButtons[i]
    }
  }
}, reorder:function() {
  var bl = this.buttonList;
  for(var i = 0;i < bl.length;i++) {
    var button = this.findButton(bl[i]);
    if(button) {
      this.panelElm.appendChild(button.margin)
    }
  }
}, remove:function() {
  this.elm.remove()
}});
var nicEditorButton = bkClass.extend({construct:function(e, buttonName, options, nicEditor) {
  this.options = options.buttons[buttonName];
  this.name = buttonName;
  this.ne = nicEditor;
  this.elm = e;
  this.margin = (new bkElement("DIV")).setStyle({"float":"left", marginTop:"2px"}).appendTo(e);
  this.contain = (new bkElement("DIV")).setStyle({width:"20px", height:"20px"}).addClass("buttonContain").appendTo(this.margin);
  this.border = (new bkElement("DIV")).setStyle({backgroundColor:"#efefef", border:"1px solid #efefef"}).appendTo(this.contain);
  this.button = (new bkElement("DIV")).setStyle({width:"18px", height:"18px", overflow:"hidden", zoom:1, cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(buttonName, options)).appendTo(this.border);
  this.button.addEvent("mouseover", this.hoverOn.closure(this)).addEvent("mouseout", this.hoverOff.closure(this)).addEvent("mousedown", this.mouseClick.closure(this)).noSelect();
  if(!window.opera) {
    this.button.onmousedown = this.button.onclick = bkLib.cancelEvent
  }
  nicEditor.addEvent("selected", this.enable.closure(this)).addEvent("blur", this.disable.closure(this)).addEvent("key", this.key.closure(this));
  this.disable();
  this.init()
}, init:function() {
}, hide:function() {
  this.contain.setStyle({display:"none"})
}, updateState:function() {
  if(this.isDisabled) {
    this.setBg()
  }else {
    if(this.isHover) {
      this.setBg("hover")
    }else {
      if(this.isActive) {
        this.setBg("active")
      }else {
        this.setBg()
      }
    }
  }
}, setBg:function(state) {
  switch(state) {
    case "hover":
      var stateStyle = {border:"1px solid #666", backgroundColor:"#ddd"};
      break;
    case "active":
      var stateStyle = {border:"1px solid #666", backgroundColor:"#ccc"};
      break;
    default:
      var stateStyle = {border:"1px solid #efefef", backgroundColor:"#efefef"}
  }
  this.border.setStyle(stateStyle).addClass("button-" + state)
}, checkNodes:function(e) {
  if(!e) {
    return
  }
  var elm = e;
  do {
    if(this.options.tags && bkLib.inArray(this.options.tags, elm.nodeName)) {
      this.activate();
      return true
    }
  }while(elm = elm.parentNode && elm.className != "nicEdit");
  elm = $BK(e);
  while(elm.nodeType == 3) {
    elm = $BK(elm.parentNode)
  }
  if(this.options.css) {
    for(itm in this.options.css) {
      if(elm.getStyle(itm, this.ne.selectedInstance.instanceDoc) == this.options.css[itm]) {
        this.activate();
        return true
      }
    }
  }
  this.deactivate();
  return false
}, activate:function() {
  if(!this.isDisabled) {
    this.isActive = true;
    this.updateState();
    this.ne.fireEvent("buttonActivate", this)
  }
}, deactivate:function() {
  this.isActive = false;
  this.updateState();
  if(!this.isDisabled) {
    this.ne.fireEvent("buttonDeactivate", this)
  }
}, enable:function(ins, t) {
  this.isDisabled = false;
  this.contain.setStyle({"opacity":1}).addClass("buttonEnabled");
  this.updateState();
  this.checkNodes(t)
}, disable:function(ins, t) {
  this.isDisabled = true;
  this.contain.setStyle({"opacity":0.6}).removeClass("buttonEnabled");
  this.updateState()
}, toggleActive:function() {
  this.isActive ? this.deactivate() : this.activate()
}, hoverOn:function() {
  if(!this.isDisabled) {
    this.isHover = true;
    this.updateState();
    this.ne.fireEvent("buttonOver", this)
  }
}, hoverOff:function() {
  this.isHover = false;
  this.updateState();
  this.ne.fireEvent("buttonOut", this)
}, mouseClick:function() {
  if(this.options.command) {
    this.ne.nicCommand(this.options.command, this.options.commandArgs);
    if(!this.options.noActive) {
      this.toggleActive()
    }
  }
  this.ne.fireEvent("buttonClick", this)
}, key:function(nicInstance, e) {
  if(this.options.key && e.ctrlKey && String.fromCharCode(e.keyCode || e.charCode).toLowerCase() == this.options.key) {
    this.mouseClick();
    if(e.preventDefault) {
      e.preventDefault()
    }
  }
}});
var nicPlugin = bkClass.extend({construct:function(nicEditor, options) {
  this.options = options;
  this.ne = nicEditor;
  this.ne.addEvent("panel", this.loadPanel.closure(this));
  this.init()
}, loadPanel:function(np) {
  var buttons = this.options.buttons;
  for(var button in buttons) {
    np.addButton(button, this.options)
  }
  np.reorder()
}, init:function() {
}});
var nicPaneOptions = {};
var nicEditorPane = bkClass.extend({construct:function(elm, nicEditor, options, openButton) {
  this.ne = nicEditor;
  this.elm = elm;
  this.pos = elm.pos();
  this.contain = (new bkElement("div")).setStyle({zIndex:"99999", overflow:"hidden", position:"absolute", left:this.pos[0] + "px", top:this.pos[1] + "px"});
  this.pane = (new bkElement("div")).setStyle({fontSize:"12px", border:"1px solid #ccc", "overflow":"hidden", padding:"4px", textAlign:"left", backgroundColor:"#ffffc9"}).addClass("pane").setStyle(options).appendTo(this.contain);
  if(openButton && !openButton.options.noClose) {
    this.close = (new bkElement("div")).setStyle({"float":"right", height:"16px", width:"16px", cursor:"pointer"}).setStyle(this.ne.getIcon("close", nicPaneOptions)).addEvent("mousedown", openButton.removePane.closure(this)).appendTo(this.pane)
  }
  this.contain.noSelect().appendTo(document.body);
  this.position();
  this.init()
}, init:function() {
}, position:function() {
  if(this.ne.nicPanel) {
    var panelElm = this.ne.nicPanel.elm;
    var panelPos = panelElm.pos();
    var newLeft = panelPos[0] + parseInt(panelElm.getStyle("width")) - (parseInt(this.pane.getStyle("width")) + 8);
    if(newLeft < this.pos[0]) {
      this.contain.setStyle({left:newLeft + "px"})
    }
  }
}, toggle:function() {
  this.isVisible = !this.isVisible;
  this.contain.setStyle({display:this.isVisible ? "block" : "none"})
}, remove:function() {
  if(this.contain) {
    this.contain.remove();
    this.contain = null
  }
}, append:function(c) {
  c.appendTo(this.pane)
}, setContent:function(c) {
  this.pane.setContent(c)
}});
var nicEditorAdvancedButton = nicEditorButton.extend({init:function() {
  this.ne.addEvent("selected", this.removePane.closure(this)).addEvent("blur", this.removePane.closure(this))
}, mouseClick:function() {
  if(!this.isDisabled) {
    if(this.pane && this.pane.pane) {
      this.removePane()
    }else {
      this.pane = new nicEditorPane(this.contain, this.ne, {width:this.width || "270px", backgroundColor:"#fff"}, this);
      this.addPane();
      this.ne.selectedInstance.saveRng()
    }
  }
}, addForm:function(f, elm) {
  this.form = (new bkElement("form")).addEvent("submit", this.submit.closureListener(this));
  this.pane.append(this.form);
  this.inputs = {};
  for(itm in f) {
    var field = f[itm];
    var val = "";
    if(elm) {
      val = elm.getAttribute(itm)
    }
    if(!val) {
      val = field["value"] || ""
    }
    var type = f[itm].type;
    if(type == "title") {
      (new bkElement("div")).setContent(field.txt).setStyle({fontSize:"14px", fontWeight:"bold", padding:"0px", margin:"2px 0"}).appendTo(this.form)
    }else {
      var contain = (new bkElement("div")).setStyle({overflow:"hidden", clear:"both"}).appendTo(this.form);
      if(field.txt) {
        (new bkElement("label")).setAttributes({"for":itm}).setContent(field.txt).setStyle({margin:"2px 4px", fontSize:"13px", width:"50px", lineHeight:"20px", textAlign:"right", "float":"left"}).appendTo(contain)
      }
      switch(type) {
        case "text":
          this.inputs[itm] = (new bkElement("input")).setAttributes({id:itm, "value":val, "type":"text"}).setStyle({margin:"2px 0", fontSize:"13px", "float":"left", height:"20px", border:"1px solid #ccc", overflow:"hidden"}).setStyle(field.style).appendTo(contain);
          break;
        case "select":
          this.inputs[itm] = (new bkElement("select")).setAttributes({id:itm}).setStyle({border:"1px solid #ccc", "float":"left", margin:"2px 0"}).appendTo(contain);
          for(opt in field.options) {
            var o = (new bkElement("option")).setAttributes({value:opt, selected:opt == val ? "selected" : ""}).setContent(field.options[opt]).appendTo(this.inputs[itm])
          }
          break;
        case "content":
          this.inputs[itm] = (new bkElement("textarea")).setAttributes({id:itm}).setStyle({border:"1px solid #ccc", "float":"left"}).setStyle(field.style).appendTo(contain);
          this.inputs[itm].value = val
      }
    }
  }
  (new bkElement("input")).setAttributes({value:getTrans("i.add"), type:"submit"}).setStyle({backgroundColor:"#efefef", border:"1px solid #ccc", margin:"3px 0", "float":"left", "clear":"both"}).appendTo(this.form);
  this.form.onsubmit = bkLib.cancelEvent
}, submit:function() {
}, findElm:function(tag, attr, val) {
  var list = this.ne.selectedInstance.getElm().getElementsByTagName(tag);
  for(var i = 0;i < list.length;i++) {
    if(list[i].getAttribute(attr) == val) {
      return $BK(list[i])
    }
  }
}, removePane:function() {
  if(this.pane) {
    this.pane.remove();
    this.pane = null;
    this.ne.selectedInstance.restoreRng()
  }
}});
var nicButtonTips = bkClass.extend({construct:function(A) {
  this.ne = A;
  A.addEvent("buttonOver", this.show.closure(this)).addEvent("buttonOut", this.hide.closure(this))
}, show:function(A) {
  this.timer = setTimeout(this.create.closure(this, A), 400)
}, create:function(A) {
  this.timer = null;
  if(!this.pane) {
    this.pane = new nicEditorPane(A.button, this.ne, {fontSize:"12px", marginTop:"5px"});
    this.pane.setContent(A.options.name)
  }
}, hide:function(A) {
  if(this.timer) {
    clearTimeout(this.timer)
  }
  if(this.pane) {
    this.pane = this.pane.remove()
  }
}});
nicEditors.registerPlugin(nicButtonTips);
var nicSelectOptions = {buttons:{"fontSize":{name:__("Select Font Size"), type:"nicEditorFontSizeSelect", command:"fontsize"}, "fontFamily":{name:__("Select Font Family"), type:"nicEditorFontFamilySelect", command:"fontname"}, "fontFormat":{name:__("Select Font Format"), type:"nicEditorFontFormatSelect", command:"formatBlock"}}};
var nicEditorSelect = bkClass.extend({construct:function(e, buttonName, options, nicEditor) {
  this.options = options.buttons[buttonName];
  this.elm = e;
  this.ne = nicEditor;
  this.name = buttonName;
  this.selOptions = new Array;
  this.margin = (new bkElement("div")).setStyle({"float":"left", margin:"2px 1px 0 1px"}).appendTo(this.elm);
  this.contain = (new bkElement("div")).setStyle({width:"90px", height:"20px", cursor:"pointer", overflow:"hidden"}).addClass("selectContain").addEvent("click", this.toggle.closure(this)).appendTo(this.margin);
  this.items = (new bkElement("div")).setStyle({overflow:"hidden", zoom:1, border:"1px solid #ccc", paddingLeft:"3px", backgroundColor:"#fff"}).appendTo(this.contain);
  this.control = (new bkElement("div")).setStyle({overflow:"hidden", "float":"right", height:"18px", width:"16px"}).addClass("selectControl").setStyle(this.ne.getIcon("arrow", options)).appendTo(this.items);
  this.txt = (new bkElement("div")).setStyle({overflow:"hidden", "float":"left", width:"66px", height:"14px", marginTop:"1px", fontFamily:"sans-serif", textAlign:"center", fontSize:"12px"}).addClass("selectTxt").appendTo(this.items);
  if(!window.opera) {
    this.contain.onmousedown = this.control.onmousedown = this.txt.onmousedown = bkLib.cancelEvent
  }
  this.margin.noSelect();
  this.ne.addEvent("selected", this.enable.closure(this)).addEvent("blur", this.disable.closure(this));
  this.disable();
  this.init()
}, disable:function() {
  this.isDisabled = true;
  this.close();
  this.contain.setStyle({opacity:0.6})
}, enable:function(t) {
  this.isDisabled = false;
  this.close();
  this.contain.setStyle({opacity:1})
}, setDisplay:function(txt) {
  this.txt.setContent(txt)
}, toggle:function() {
  if(!this.isDisabled) {
    this.pane ? this.close() : this.open()
  }
}, open:function() {
  this.pane = new nicEditorPane(this.items, this.ne, {width:"88px", padding:"0px", borderTop:0, borderLeft:"1px solid #ccc", borderRight:"1px solid #ccc", borderBottom:"0px", backgroundColor:"#fff"});
  for(var i = 0;i < this.selOptions.length;i++) {
    var opt = this.selOptions[i];
    var itmContain = (new bkElement("div")).setStyle({overflow:"hidden", borderBottom:"1px solid #ccc", width:"88px", textAlign:"left", overflow:"hidden", cursor:"pointer"});
    var itm = (new bkElement("div")).setStyle({padding:"0px 4px"}).setContent(opt[1]).appendTo(itmContain).noSelect();
    itm.addEvent("click", this.update.closure(this, opt[0])).addEvent("mouseover", this.over.closure(this, itm)).addEvent("mouseout", this.out.closure(this, itm)).setAttributes("id", opt[0]);
    this.pane.append(itmContain);
    if(!window.opera) {
      itm.onmousedown = bkLib.cancelEvent
    }
  }
}, close:function() {
  if(this.pane) {
    this.pane = this.pane.remove()
  }
}, over:function(opt) {
  opt.setStyle({backgroundColor:"#ccc"})
}, out:function(opt) {
  opt.setStyle({backgroundColor:"#fff"})
}, add:function(k, v) {
  this.selOptions.push(new Array(k, v))
}, update:function(elm) {
  this.ne.nicCommand(this.options.command, elm);
  this.close()
}});
var nicEditorFontSizeSelect = nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)", 2:"2&nbsp;(10pt)", 3:"3&nbsp;(12pt)", 4:"4&nbsp;(14pt)", 5:"5&nbsp;(18pt)", 6:"6&nbsp;(24pt)", 7:"7&nbsp;(48pt)"}, init:function() {
  this.setDisplay("Font&nbsp;Size...");
  for(itm in this.sel) {
    this.add(itm, '<font size="' + itm + '">' + this.sel[itm] + "</font>")
  }
}});
var nicEditorFontFamilySelect = nicEditorSelect.extend({sel:{"arial":"Arial", "comic sans ms":"Comic Sans", "courier new":"Courier New", "georgia":"Georgia", "helvetica":"Helvetica", "impact":"Impact", "times new roman":"Times", "trebuchet ms":"Trebuchet", "verdana":"Verdana"}, init:function() {
  this.setDisplay("Font&nbsp;Family...");
  for(itm in this.sel) {
    this.add(itm, '<font face="' + itm + '">' + this.sel[itm] + "</font>")
  }
}});
var nicEditorFontFormatSelect = nicEditorSelect.extend({sel:{"p":"Paragraph", "pre":"Pre", "h6":"Heading&nbsp;6", "h5":"Heading&nbsp;5", "h4":"Heading&nbsp;4", "h3":"Heading&nbsp;3", "h2":"Heading&nbsp;2", "h1":"Heading&nbsp;1"}, init:function() {
  this.setDisplay("Font&nbsp;Format...");
  for(itm in this.sel) {
    var tag = itm.toUpperCase();
    this.add("<" + tag + ">", "<" + itm + ' style="padding: 0px; margin: 0px;">' + this.sel[itm] + "</" + tag + ">")
  }
}});
nicEditors.registerPlugin(nicPlugin, nicSelectOptions);
var nicLinkOptions = {buttons:{"link":{name:"Add Link", type:"nicLinkButton", tags:["A"]}, "unlink":{name:"Remove Link", command:"unlink", noActive:true}}};
var nicLinkButton = nicEditorAdvancedButton.extend({addPane:function() {
  this.ln = this.ne.selectedInstance.selElm().parentTag("A");
  this.addForm({"":{type:"title", txt:getTrans("i.wysiwyg.addurl")}, "href":{type:"text", txt:"Url", value:"http://", style:{width:"150px"}}, "title":{type:"text", txt:getTrans("i.Title")}}, this.ln)
}, submit:function(e) {
  var url = this.inputs["href"].value;
  if(url == "http://" || url == "") {
    return false
  }
  var titleParam = typeof this.inputs["title"].value == "string" && this.inputs["title"].value != "";
  if(titleParam) {
    title = this.inputs["title"].value
  }else {
    title = url
  }
  this.removePane();
  if(!this.ln) {
    var tmp = title;
    this.ne.nicCommand("createlink", tmp);
    this.ln = this.findElm("A", "href", tmp)
  }
  var linkTxtParam = typeof $(this.ln).val() == "string" && $(this.ln).val() != "";
  if(!titleParam && linkTxtParam) {
    title = $(this.ln).val()
  }
  if(this.ln) {
    this.ln.setAttributes({href:url, title:title, target:"blank_"})
  }
}});
nicEditors.registerPlugin(nicPlugin, nicLinkOptions);
var nicColorOptions = {buttons:{"forecolor":{name:__("Change Text Color"), type:"nicEditorColorButton", noClose:true}, "bgcolor":{name:__("Change Background Color"), type:"nicEditorBgColorButton", noClose:true}}};
var nicEditorColorButton = nicEditorAdvancedButton.extend({addPane:function() {
  var D = {"0":"transparent", 1:"#ffffff", 2:"#201815", 3:"#BF0310", 4:"#008F44", 5:"#009ADA", 6:"#001C7D", 7:"#BA007C", 8:"#A01127", 9:"#C54832", 10:"#CB6120", 11:"#DB9600", 12:"#E5B449", 13:"#F7EC45", 14:"#DDDC1C", 15:"#A2BD31", 16:"#70A73A", 17:"#4F8E3A", 18:"#326534", 19:"#6EAA6E", 20:"#5EA099", 21:"#75AADB", 22:"#4A72B1", 23:"#002D81", 24:"#001A5A", 25:"#57157D", 26:"#7B047D", 27:"#840E5A", 28:"#B10052", 29:"#BF3276", 30:"#C4BA9E", 31:"#9B897A", 32:"#716858", 33:"#584E40", 34:"#BC9D6C", 35:"#A27F51", 
  36:"#82613C", 37:"#6D5128", 38:"#5A3F09", 39:"#3B2B16", 40:"#434142", 41:"#5B5B5E", 42:"#717175", 43:"#86858A", 44:"#9A999D", 45:"#ADADB2", 46:"#C2C3C8", 47:"#D7D8DC", 48:"#ECEDEF"};
  var H = (new bkElement("DIV")).setStyle({width:"270px"});
  for(var A in D) {
    var I = D[A];
    var C = (new bkElement("DIV")).setStyle({cursor:"pointer", height:"15px", "float":"left"}).appendTo(H);
    var G = (new bkElement("DIV")).setStyle({border:"2px solid " + I}).appendTo(C);
    if(I === "transparent") {
      var B = (new bkElement("DIV")).setStyle({backgroundImage:"url('" + VISH.ImagesPath + "transparent_wysiwyg.png')", overflow:"hidden", width:"11px", height:"11px"}).addEvent("click", this.colorSelect.closure(this, I)).addEvent("mouseover", this.on.closure(this, G)).addEvent("mouseout", this.off.closure(this, G, I)).setAttributes({"title":"set color to " + I}).appendTo(G)
    }else {
      var B = (new bkElement("DIV")).setStyle({backgroundColor:I, overflow:"hidden", width:"11px", height:"11px"}).addEvent("click", this.colorSelect.closure(this, I)).addEvent("mouseover", this.on.closure(this, G)).addEvent("mouseout", this.off.closure(this, G, I)).setAttributes({"title":"set color to " + I}).appendTo(G)
    }
    if(!window.opera) {
      C.onmousedown = B.onmousedown = bkLib.cancelEvent
    }
  }
  this.pane.append(H.noSelect())
}, colorSelect:function(A) {
  this.ne.nicCommand("foreColor", A);
  this.removePane()
}, on:function(A) {
  A.setStyle({border:"2px solid #000"})
}, off:function(A, B) {
  A.setStyle({border:"2px solid " + B})
}});
var nicEditorBgColorButton = nicEditorColorButton.extend({colorSelect:function(c) {
  this.ne.nicCommand("hiliteColor", c);
  this.removePane()
}});
nicEditors.registerPlugin(nicPlugin, nicColorOptions);
var nicImageOptions = {buttons:{"image":{name:"Add Image", type:"nicImageButton", tags:["IMG"]}}};
var nicImageButton = nicEditorAdvancedButton.extend({addPane:function() {
  this.im = this.ne.selectedInstance.selElm().parentTag("IMG");
  this.addForm({"":{type:"title", txt:"Add/Edit Image"}, "src":{type:"text", txt:"URL", "value":"http://", style:{width:"150px"}}, "alt":{type:"text", txt:"Alt Text", style:{width:"100px"}}, "align":{type:"select", txt:"Align", options:{none:"Default", "left":"Left", "right":"Right"}}}, this.im)
}, submit:function(e) {
  var src = this.inputs["src"].value;
  if(src == "" || src == "http://") {
    alert("You must enter a Image URL to insert");
    return false
  }
  this.removePane();
  if(!this.im) {
    var tmp = "javascript:nicImTemp();";
    this.ne.nicCommand("insertImage", tmp);
    this.im = this.findElm("IMG", "src", tmp)
  }
  if(this.im) {
    this.im.setAttributes({src:this.inputs["src"].value, alt:this.inputs["alt"].value, align:this.inputs["align"].value})
  }
}});
nicEditors.registerPlugin(nicPlugin, nicImageOptions);
var nicSaveOptions = {buttons:{"save":{name:__("Save this content"), type:"nicEditorSaveButton"}}};
var nicEditorSaveButton = nicEditorButton.extend({init:function() {
  if(!this.ne.options.onSave) {
    this.margin.setStyle({"display":"none"})
  }
}, mouseClick:function() {
  var onSave = this.ne.options.onSave;
  var selectedInstance = this.ne.selectedInstance;
  onSave(selectedInstance.getContent(), selectedInstance.elm.id, selectedInstance)
}});
nicEditors.registerPlugin(nicPlugin, nicSaveOptions);
var swfobject = function() {
  var D = "undefined", r = "object", S = "Shockwave Flash", W = "ShockwaveFlash.ShockwaveFlash", q = "application/x-shockwave-flash", R = "SWFObjectExprInst", x = "onreadystatechange", O = window, j = document, t = navigator, T = false, U = [h], o = [], N = [], I = [], l, Q, E, B, J = false, a = false, n, G, m = true, M = function() {
    var aa = typeof j.getElementById != D && typeof j.getElementsByTagName != D && typeof j.createElement != D, ah = t.userAgent.toLowerCase(), Y = t.platform.toLowerCase(), ae = Y ? /win/.test(Y) : /win/.test(ah), ac = Y ? /mac/.test(Y) : /mac/.test(ah), af = /webkit/.test(ah) ? parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/, "$1")) : false, X = !+"\v1", ag = [0, 0, 0], ab = null;
    if(typeof t.plugins != D && typeof t.plugins[S] == r) {
      ab = t.plugins[S].description;
      if(ab && !(typeof t.mimeTypes != D && t.mimeTypes[q] && !t.mimeTypes[q].enabledPlugin)) {
        T = true;
        X = false;
        ab = ab.replace(/^.*\s+(\S+\s+\S+$)/, "$1");
        ag[0] = parseInt(ab.replace(/^(.*)\..*$/, "$1"), 10);
        ag[1] = parseInt(ab.replace(/^.*\.(.*)\s.*$/, "$1"), 10);
        ag[2] = /[a-zA-Z]/.test(ab) ? parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/, "$1"), 10) : 0
      }
    }else {
      if(typeof O.ActiveXObject != D) {
        try {
          var ad = new ActiveXObject(W);
          if(ad) {
            ab = ad.GetVariable("$version");
            if(ab) {
              X = true;
              ab = ab.split(" ")[1].split(",");
              ag = [parseInt(ab[0], 10), parseInt(ab[1], 10), parseInt(ab[2], 10)]
            }
          }
        }catch(Z) {
        }
      }
    }
    return{w3:aa, pv:ag, wk:af, ie:X, win:ae, mac:ac}
  }(), k = function() {
    if(!M.w3) {
      return
    }
    if(typeof j.readyState != D && j.readyState == "complete" || typeof j.readyState == D && (j.getElementsByTagName("body")[0] || j.body)) {
      f()
    }
    if(!J) {
      if(typeof j.addEventListener != D) {
        j.addEventListener("DOMContentLoaded", f, false)
      }
      if(M.ie && M.win) {
        j.attachEvent(x, function() {
          if(j.readyState == "complete") {
            j.detachEvent(x, arguments.callee);
            f()
          }
        });
        if(O == top) {
          (function() {
            if(J) {
              return
            }
            try {
              j.documentElement.doScroll("left")
            }catch(X) {
              setTimeout(arguments.callee, 0);
              return
            }
            f()
          })()
        }
      }
      if(M.wk) {
        (function() {
          if(J) {
            return
          }
          if(!/loaded|complete/.test(j.readyState)) {
            setTimeout(arguments.callee, 0);
            return
          }
          f()
        })()
      }
      s(f)
    }
  }();
  function f() {
    if(J) {
      return
    }
    try {
      var Z = j.getElementsByTagName("body")[0].appendChild(C("span"));
      Z.parentNode.removeChild(Z)
    }catch(aa) {
      return
    }
    J = true;
    var X = U.length;
    for(var Y = 0;Y < X;Y++) {
      U[Y]()
    }
  }
  function K(X) {
    if(J) {
      X()
    }else {
      U[U.length] = X
    }
  }
  function s(Y) {
    if(typeof O.addEventListener != D) {
      O.addEventListener("load", Y, false)
    }else {
      if(typeof j.addEventListener != D) {
        j.addEventListener("load", Y, false)
      }else {
        if(typeof O.attachEvent != D) {
          i(O, "onload", Y)
        }else {
          if(typeof O.onload == "function") {
            var X = O.onload;
            O.onload = function() {
              X();
              Y()
            }
          }else {
            O.onload = Y
          }
        }
      }
    }
  }
  function h() {
    if(T) {
      V()
    }else {
      H()
    }
  }
  function V() {
    var X = j.getElementsByTagName("body")[0];
    var aa = C(r);
    aa.setAttribute("type", q);
    var Z = X.appendChild(aa);
    if(Z) {
      var Y = 0;
      (function() {
        if(typeof Z.GetVariable != D) {
          var ab = Z.GetVariable("$version");
          if(ab) {
            ab = ab.split(" ")[1].split(",");
            M.pv = [parseInt(ab[0], 10), parseInt(ab[1], 10), parseInt(ab[2], 10)]
          }
        }else {
          if(Y < 10) {
            Y++;
            setTimeout(arguments.callee, 10);
            return
          }
        }
        X.removeChild(aa);
        Z = null;
        H()
      })()
    }else {
      H()
    }
  }
  function H() {
    var ag = o.length;
    if(ag > 0) {
      for(var af = 0;af < ag;af++) {
        var Y = o[af].id;
        var ab = o[af].callbackFn;
        var aa = {success:false, id:Y};
        if(M.pv[0] > 0) {
          var ae = c(Y);
          if(ae) {
            if(F(o[af].swfVersion) && !(M.wk && M.wk < 312)) {
              w(Y, true);
              if(ab) {
                aa.success = true;
                aa.ref = z(Y);
                ab(aa)
              }
            }else {
              if(o[af].expressInstall && A()) {
                var ai = {};
                ai.data = o[af].expressInstall;
                ai.width = ae.getAttribute("width") || "0";
                ai.height = ae.getAttribute("height") || "0";
                if(ae.getAttribute("class")) {
                  ai.styleclass = ae.getAttribute("class")
                }
                if(ae.getAttribute("align")) {
                  ai.align = ae.getAttribute("align")
                }
                var ah = {};
                var X = ae.getElementsByTagName("param");
                var ac = X.length;
                for(var ad = 0;ad < ac;ad++) {
                  if(X[ad].getAttribute("name").toLowerCase() != "movie") {
                    ah[X[ad].getAttribute("name")] = X[ad].getAttribute("value")
                  }
                }
                P(ai, ah, Y, ab)
              }else {
                p(ae);
                if(ab) {
                  ab(aa)
                }
              }
            }
          }
        }else {
          w(Y, true);
          if(ab) {
            var Z = z(Y);
            if(Z && typeof Z.SetVariable != D) {
              aa.success = true;
              aa.ref = Z
            }
            ab(aa)
          }
        }
      }
    }
  }
  function z(aa) {
    var X = null;
    var Y = c(aa);
    if(Y && Y.nodeName == "OBJECT") {
      if(typeof Y.SetVariable != D) {
        X = Y
      }else {
        var Z = Y.getElementsByTagName(r)[0];
        if(Z) {
          X = Z
        }
      }
    }
    return X
  }
  function A() {
    return!a && F("6.0.65") && (M.win || M.mac) && !(M.wk && M.wk < 312)
  }
  function P(aa, ab, X, Z) {
    a = true;
    E = Z || null;
    B = {success:false, id:X};
    var ae = c(X);
    if(ae) {
      if(ae.nodeName == "OBJECT") {
        l = g(ae);
        Q = null
      }else {
        l = ae;
        Q = X
      }
      aa.id = R;
      if(typeof aa.width == D || !/%$/.test(aa.width) && parseInt(aa.width, 10) < 310) {
        aa.width = "310"
      }
      if(typeof aa.height == D || !/%$/.test(aa.height) && parseInt(aa.height, 10) < 137) {
        aa.height = "137"
      }
      j.title = j.title.slice(0, 47) + " - Flash Player Installation";
      var ad = M.ie && M.win ? "ActiveX" : "PlugIn", ac = "MMredirectURL=" + O.location.toString().replace(/&/g, "%26") + "&MMplayerType=" + ad + "&MMdoctitle=" + j.title;
      if(typeof ab.flashvars != D) {
        ab.flashvars += "&" + ac
      }else {
        ab.flashvars = ac
      }
      if(M.ie && M.win && ae.readyState != 4) {
        var Y = C("div");
        X += "SWFObjectNew";
        Y.setAttribute("id", X);
        ae.parentNode.insertBefore(Y, ae);
        ae.style.display = "none";
        (function() {
          if(ae.readyState == 4) {
            ae.parentNode.removeChild(ae)
          }else {
            setTimeout(arguments.callee, 10)
          }
        })()
      }
      u(aa, ab, X)
    }
  }
  function p(Y) {
    if(M.ie && M.win && Y.readyState != 4) {
      var X = C("div");
      Y.parentNode.insertBefore(X, Y);
      X.parentNode.replaceChild(g(Y), X);
      Y.style.display = "none";
      (function() {
        if(Y.readyState == 4) {
          Y.parentNode.removeChild(Y)
        }else {
          setTimeout(arguments.callee, 10)
        }
      })()
    }else {
      Y.parentNode.replaceChild(g(Y), Y)
    }
  }
  function g(ab) {
    var aa = C("div");
    if(M.win && M.ie) {
      aa.innerHTML = ab.innerHTML
    }else {
      var Y = ab.getElementsByTagName(r)[0];
      if(Y) {
        var ad = Y.childNodes;
        if(ad) {
          var X = ad.length;
          for(var Z = 0;Z < X;Z++) {
            if(!(ad[Z].nodeType == 1 && ad[Z].nodeName == "PARAM") && !(ad[Z].nodeType == 8)) {
              aa.appendChild(ad[Z].cloneNode(true))
            }
          }
        }
      }
    }
    return aa
  }
  function u(ai, ag, Y) {
    var X, aa = c(Y);
    if(M.wk && M.wk < 312) {
      return X
    }
    if(aa) {
      if(typeof ai.id == D) {
        ai.id = Y
      }
      if(M.ie && M.win) {
        var ah = "";
        for(var ae in ai) {
          if(ai[ae] != Object.prototype[ae]) {
            if(ae.toLowerCase() == "data") {
              ag.movie = ai[ae]
            }else {
              if(ae.toLowerCase() == "styleclass") {
                ah += ' class="' + ai[ae] + '"'
              }else {
                if(ae.toLowerCase() != "classid") {
                  ah += " " + ae + '="' + ai[ae] + '"'
                }
              }
            }
          }
        }
        var af = "";
        for(var ad in ag) {
          if(ag[ad] != Object.prototype[ad]) {
            af += '<param name="' + ad + '" value="' + ag[ad] + '" />'
          }
        }
        aa.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"' + ah + ">" + af + "</object>";
        N[N.length] = ai.id;
        X = c(ai.id)
      }else {
        var Z = C(r);
        Z.setAttribute("type", q);
        for(var ac in ai) {
          if(ai[ac] != Object.prototype[ac]) {
            if(ac.toLowerCase() == "styleclass") {
              Z.setAttribute("class", ai[ac])
            }else {
              if(ac.toLowerCase() != "classid") {
                Z.setAttribute(ac, ai[ac])
              }
            }
          }
        }
        for(var ab in ag) {
          if(ag[ab] != Object.prototype[ab] && ab.toLowerCase() != "movie") {
            e(Z, ab, ag[ab])
          }
        }
        aa.parentNode.replaceChild(Z, aa);
        X = Z
      }
    }
    return X
  }
  function e(Z, X, Y) {
    var aa = C("param");
    aa.setAttribute("name", X);
    aa.setAttribute("value", Y);
    Z.appendChild(aa)
  }
  function y(Y) {
    var X = c(Y);
    if(X && X.nodeName == "OBJECT") {
      if(M.ie && M.win) {
        X.style.display = "none";
        (function() {
          if(X.readyState == 4) {
            b(Y)
          }else {
            setTimeout(arguments.callee, 10)
          }
        })()
      }else {
        X.parentNode.removeChild(X)
      }
    }
  }
  function b(Z) {
    var Y = c(Z);
    if(Y) {
      for(var X in Y) {
        if(typeof Y[X] == "function") {
          Y[X] = null
        }
      }
      Y.parentNode.removeChild(Y)
    }
  }
  function c(Z) {
    var X = null;
    try {
      X = j.getElementById(Z)
    }catch(Y) {
    }
    return X
  }
  function C(X) {
    return j.createElement(X)
  }
  function i(Z, X, Y) {
    Z.attachEvent(X, Y);
    I[I.length] = [Z, X, Y]
  }
  function F(Z) {
    var Y = M.pv, X = Z.split(".");
    X[0] = parseInt(X[0], 10);
    X[1] = parseInt(X[1], 10) || 0;
    X[2] = parseInt(X[2], 10) || 0;
    return Y[0] > X[0] || Y[0] == X[0] && Y[1] > X[1] || Y[0] == X[0] && Y[1] == X[1] && Y[2] >= X[2] ? true : false
  }
  function v(ac, Y, ad, ab) {
    if(M.ie && M.mac) {
      return
    }
    var aa = j.getElementsByTagName("head")[0];
    if(!aa) {
      return
    }
    var X = ad && typeof ad == "string" ? ad : "screen";
    if(ab) {
      n = null;
      G = null
    }
    if(!n || G != X) {
      var Z = C("style");
      Z.setAttribute("type", "text/css");
      Z.setAttribute("media", X);
      n = aa.appendChild(Z);
      if(M.ie && M.win && typeof j.styleSheets != D && j.styleSheets.length > 0) {
        n = j.styleSheets[j.styleSheets.length - 1]
      }
      G = X
    }
    if(M.ie && M.win) {
      if(n && typeof n.addRule == r) {
        n.addRule(ac, Y)
      }
    }else {
      if(n && typeof j.createTextNode != D) {
        n.appendChild(j.createTextNode(ac + " {" + Y + "}"))
      }
    }
  }
  function w(Z, X) {
    if(!m) {
      return
    }
    var Y = X ? "visible" : "hidden";
    if(J && c(Z)) {
      c(Z).style.visibility = Y
    }else {
      v("#" + Z, "visibility:" + Y)
    }
  }
  function L(Y) {
    var Z = /[\\\"<>\.;]/;
    var X = Z.exec(Y) != null;
    return X && typeof encodeURIComponent != D ? encodeURIComponent(Y) : Y
  }
  var d = function() {
    if(M.ie && M.win) {
      window.attachEvent("onunload", function() {
        var ac = I.length;
        for(var ab = 0;ab < ac;ab++) {
          I[ab][0].detachEvent(I[ab][1], I[ab][2])
        }
        var Z = N.length;
        for(var aa = 0;aa < Z;aa++) {
          y(N[aa])
        }
        for(var Y in M) {
          M[Y] = null
        }
        M = null;
        for(var X in swfobject) {
          swfobject[X] = null
        }
        swfobject = null
      })
    }
  }();
  return{registerObject:function(ab, X, aa, Z) {
    if(M.w3 && ab && X) {
      var Y = {};
      Y.id = ab;
      Y.swfVersion = X;
      Y.expressInstall = aa;
      Y.callbackFn = Z;
      o[o.length] = Y;
      w(ab, false)
    }else {
      if(Z) {
        Z({success:false, id:ab})
      }
    }
  }, getObjectById:function(X) {
    if(M.w3) {
      return z(X)
    }
  }, embedSWF:function(ab, ah, ae, ag, Y, aa, Z, ad, af, ac) {
    var X = {success:false, id:ah};
    if(M.w3 && !(M.wk && M.wk < 312) && ab && ah && ae && ag && Y) {
      w(ah, false);
      K(function() {
        ae += "";
        ag += "";
        var aj = {};
        if(af && typeof af === r) {
          for(var al in af) {
            aj[al] = af[al]
          }
        }
        aj.data = ab;
        aj.width = ae;
        aj.height = ag;
        var am = {};
        if(ad && typeof ad === r) {
          for(var ak in ad) {
            am[ak] = ad[ak]
          }
        }
        if(Z && typeof Z === r) {
          for(var ai in Z) {
            if(typeof am.flashvars != D) {
              am.flashvars += "&" + ai + "=" + Z[ai]
            }else {
              am.flashvars = ai + "=" + Z[ai]
            }
          }
        }
        if(F(Y)) {
          var an = u(aj, am, ah);
          if(aj.id == ah) {
            w(ah, true)
          }
          X.success = true;
          X.ref = an
        }else {
          if(aa && A()) {
            aj.data = aa;
            P(aj, am, ah, ac);
            return
          }else {
            w(ah, true)
          }
        }
        if(ac) {
          ac(X)
        }
      })
    }else {
      if(ac) {
        ac(X)
      }
    }
  }, switchOffAutoHideShow:function() {
    m = false
  }, ua:M, getFlashPlayerVersion:function() {
    return{major:M.pv[0], minor:M.pv[1], release:M.pv[2]}
  }, hasFlashPlayerVersion:F, createSWF:function(Z, Y, X) {
    if(M.w3) {
      return u(Z, Y, X)
    }else {
      return undefined
    }
  }, showExpressInstall:function(Z, aa, X, Y) {
    if(M.w3 && A()) {
      P(Z, aa, X, Y)
    }
  }, removeSWF:function(X) {
    if(M.w3) {
      y(X)
    }
  }, createCSS:function(aa, Z, Y, X) {
    if(M.w3) {
      v(aa, Z, Y, X)
    }
  }, addDomLoadEvent:K, addLoadEvent:s, getQueryParamValue:function(aa) {
    var Z = j.location.search || j.location.hash;
    if(Z) {
      if(/\?/.test(Z)) {
        Z = Z.split("?")[1]
      }
      if(aa == null) {
        return L(Z)
      }
      var Y = Z.split("&");
      for(var X = 0;X < Y.length;X++) {
        if(Y[X].substring(0, Y[X].indexOf("=")) == aa) {
          return L(Y[X].substring(Y[X].indexOf("=") + 1))
        }
      }
    }
    return""
  }, expressInstallCallback:function() {
    if(a) {
      var X = c(R);
      if(X && l) {
        X.parentNode.replaceChild(l, X);
        if(Q) {
          w(Q, true);
          if(M.ie && M.win) {
            l.style.display = "block"
          }
        }
        if(E) {
          E(B)
        }
      }
      a = false
    }
  }}
}();
(function($) {
  $.widget("ui.tagit", {options:{tagSource:[], triggerKeys:["enter", "space", "comma", "tab"], initialTags:[], minLength:1, select:false, allowNewTags:true, caseSensitive:false, sortable:false, highlightOnExistColor:"#0F0", emptySearch:true, watermarkAllowMessage:"Add tags", watermarkDenyMessage:"Tags limit reached", tagsChanged:function(tagValue, action, element) {
  }}, _splitAt:/\ |,/g, _existingAtIndex:0, _pasteMetaKeyPressed:false, _keys:{backspace:[8], enter:[13], space:[32], comma:[44, 188], tab:[9]}, _sortable:{sorting:-1}, _create:function() {
    var self = this;
    this.tagsArray = [];
    this.timer = null;
    this.element.addClass("tagit");
    this.element.children("li").each(function() {
      var tag = $(this);
      var tagValue = tag.attr("tagValue");
      self.options.initialTags.push({label:tag.text(), value:tagValue ? tagValue : tag.text()})
    });
    self._splitAt = null;
    if($.inArray("space", self.options.triggerKeys) > 0 && $.inArray("comma", self.options.triggerKeys) > 0) {
      self._splitAt = /\ |,/g
    }else {
      if($.inArray("space", self.options.triggerKeys) > 0) {
        self._splitAt = /\ /g
      }else {
        if($.inArray("comma", self.options.triggerKeys) > 0) {
          self._splitAt = /,/g
        }
      }
    }
    this.element.html('<li class="tagit-new"><input class="tagit-input" type="text" /></li>');
    this.input = this.element.find(".tagit-input");
    if(typeof $().watermark == "function") {
      this.input.watermark(this.options.watermarkAllowMessage)
    }
    $(this.element).click(function(e) {
      if($(e.target).hasClass("tagit-close")) {
        var parent = $(e.target).parent();
        var tag = self.tagsArray[parent.index()];
        tag.element.remove();
        self._popTag(tag)
      }else {
        self.input.focus();
        if(self.options.emptySearch && $(e.target).hasClass("tagit-input") && self.input.val() == "" && self.input.autocomplete != undefined) {
          self.input.autocomplete("search")
        }
      }
    });
    var os = this.options.select;
    this.options.appendTo = this.element;
    this.options.source = this.options.tagSource;
    this.options.select = function(event, ui) {
      self.input.data("autoCompleteTag", true);
      clearTimeout(self.timer);
      if(ui.item.label === undefined) {
        self._addTag(ui.item.value)
      }else {
        self._addTag(ui.item.label, ui.item.value)
      }
      event.stopPropagation();
      return false
    };
    this.options.focus = function(event, ui) {
      if(ui.item.label !== undefined && /^key/.test(event.originalEvent.originalEvent.type)) {
        self.input.val(ui.item.label);
        self.input.attr("tagValue", ui.item.value);
        return false
      }
    };
    this.options.autoFocus = !this.options.allowNewTags;
    this.input.autocomplete(this.options);
    this.options.select = os;
    this.input.keydown(function(e) {
      var lastLi = self.element.children(".tagit-choice:last");
      if(e.which == self._keys.backspace) {
        return self._backspace(lastLi)
      }
      if(self._isInitKey(e.which) && !(self._isTabKey(e.which) && this.value == "" && !self.input.data("autoCompleteTag"))) {
        e.preventDefault();
        self.input.data("autoCompleteTag", false);
        if(self.options.allowNewTags && $(this).val().length >= self.options.minLength) {
          self._addTag($(this).val())
        }
      }
      if(self.options.maxLength !== undefined && self.input.val().length == self.options.maxLength) {
        e.preventDefault()
      }
      if(lastLi.hasClass("selected")) {
        lastLi.removeClass("selected")
      }
      _pasteMetaKeyPressed = e.metaKey;
      self.lastKey = e.which
    });
    this.input.keyup(function(e) {
      if(_pasteMetaKeyPressed && (e.which == 91 || e.which == 86)) {
        $(this).blur()
      }
      window.setTimeout(function() {
        _pasteMetaKeyPressed = e.metaKey
      }, 250)
    });
    this.input.blur(function(e) {
      self.currentLabel = $(this).val();
      self.currentValue = $(this).attr("tagValue");
      if(self.options.allowNewTags && self.currentLabel) {
        self.timer = setTimeout(function() {
          self._addTag(self.currentLabel, self.currentValue);
          self.currentValue = "";
          self.currentLabel = ""
        }, 400)
      }
      $(this).val("").removeAttr("tagValue");
      return true
    });
    if(!String.prototype.trim) {
      String.prototype.trim = function() {
        return this.replace(/^\s+|\s+$/g, "")
      }
    }
    if(this.options.select) {
      this.select = $('<select class="tagit-hiddenSelect" name="' + this.element.attr("name") + '" multiple="multiple"></select>');
      this.element.after(this.select)
    }
    this._initialTags();
    if(self.options.sortable !== false) {
      var soptions = {items:".tagit-choice", containment:"parent", opacity:0.6, tolerance:"pointer", start:function(event, ui) {
        self._sortable.tag = $(ui.item);
        self._sortable.origIndex = self._sortable.tag.index()
      }, update:function(event, ui) {
        self._sortable.newIndex = self._sortable.tag.index();
        self._moveTag(self._sortable.origIndex, self._sortable.newIndex);
        if(self.options.tagsChanged) {
          var tag = self.tagsArray[self._sortable.newIndex];
          self.options.tagsChanged(tag.value, "moved", tag.element)
        }
      }};
      if(self.options.sortable == "handle") {
        soptions.handle = "a.ui-icon";
        soptions.cursor = "move"
      }
      self.element.sortable(soptions)
    }
  }, _popSelect:function(tag) {
    $("option:eq(" + tag.index + ")", this.select).remove();
    this.select.change()
  }, _addSelect:function(tag) {
    this.select.append('<option selected="selected" value="' + tag.value + '">' + tag.label + "</option>");
    this.select.change()
  }, _popTag:function(tag) {
    if(tag === undefined) {
      tag = this.tagsArray.pop()
    }else {
      this.tagsArray.splice(tag.index, 1)
    }
    if(typeof $().watermark == "function") {
      this.input.watermark(this.options.watermarkAllowMessage)
    }
    for(var ind in this.tagsArray) {
      this.tagsArray[ind].index = ind
    }
    if(this.options.select) {
      this._popSelect(tag)
    }
    if(this.options.tagsChanged) {
      this.options.tagsChanged(tag.value || tag.label, "popped", null)
    }
    return
  }, _addTag:function(label, value) {
    if(this.tagsArray.length > this.options.maxTags - 1) {
      $(this.input).blur();
      return false
    }
    this.input.autocomplete("close").val("");
    if(this._splitAt && label.search(this._splitAt) > 0) {
      var result = label.split(this._splitAt);
      for(var i = 0;i < result.length;i++) {
        this._addTag(result[i], value)
      }
      return
    }
    label = label.replace(/,+$/, "").trim();
    if(label == "") {
      return false
    }
    var tagExists = this._exists(label, value);
    if(tagExists !== false) {
      this._highlightExisting(tagExists);
      return false
    }
    if(this.tagsArray.length == this.options.maxTags - 1) {
      if(typeof $().watermark == "function") {
        this.input.watermark(this.options.watermarkDenyMessage)
      }
      $(this.input).blur()
    }
    var tag = this.tag(label, value);
    tag.element = $('<li class="tagit-choice"' + (value !== undefined ? ' tagValue="' + value + '"' : "") + ">" + (this.options.sortable == "handle" ? '<a class="ui-icon ui-icon-grip-dotted-vertical" style="float:left"></a>' : "") + label + '<a class="tagit-close">x</a></li>');
    tag.element.insertBefore(this.input.parent());
    this.tagsArray.push(tag);
    this.input.val("");
    if(this.options.select) {
      this._addSelect(tag)
    }
    if(this.options.tagsChanged) {
      this.options.tagsChanged(tag.label, "added", tag.element)
    }
    return true
  }, _removeTagWithValue:function(label, value) {
    var index = this._exists(label, value);
    if(index != false) {
      var tag = this.tagsArray[index];
      tag.element.remove();
      this._popTag(tag)
    }
  }, _exists:function(label, value) {
    if(this.tagsArray.length == 0) {
      return false
    }
    label = this._lowerIfCaseInsensitive(label);
    value = this._lowerIfCaseInsensitive(value);
    for(var ind in this.tagsArray) {
      if(this._lowerIfCaseInsensitive(this.tagsArray[ind].label) == label) {
        if(value !== undefined) {
          if(this._lowerIfCaseInsensitive(this.tagsArray[ind].value) == value) {
            return ind
          }
        }else {
          return ind
        }
      }
    }
    return false
  }, _highlightExisting:function(index) {
    if(this.options.highlightOnExistColor === undefined) {
      return
    }
    var tag = this.tagsArray[index];
    tag.element.stop();
    var initialColor = tag.element.css("color");
    tag.element.animate({color:this.options.highlightOnExistColor}, 100).animate({"color":initialColor}, 800)
  }, _isInitKey:function(keyCode) {
    var keyName = "";
    for(var key in this._keys) {
      if($.inArray(keyCode, this._keys[key]) != -1) {
        keyName = key
      }
    }
    if($.inArray(keyName, this.options.triggerKeys) != -1) {
      return true
    }
    return false
  }, _isTabKey:function(keyCode) {
    var tabKeys = this._keys["tab"];
    return $.inArray(keyCode, tabKeys) > -1
  }, _removeTag:function() {
    this._popTag();
    this.element.children(".tagit-choice:last").remove()
  }, _backspace:function(li) {
    if(this.input.val() == "") {
      if(this.lastKey == this._keys.backspace) {
        this._popTag();
        li.remove();
        this.lastKey = null
      }else {
        li.addClass("selected");
        this.lastKey = this._keys.backspace
      }
    }
    return true
  }, _initialTags:function() {
    var input = this;
    var _temp;
    if(this.options.tagsChanged) {
      _temp = this.options.tagsChanged
    }
    this.options.tagsChanged = null;
    if(this.options.initialTags.length != 0) {
      $(this.options.initialTags).each(function(i, element) {
        if(typeof element == "object") {
          input._addTag(element.label, element.value)
        }else {
          input._addTag(element)
        }
      })
    }
    this.options.tagsChanged = _temp
  }, _lowerIfCaseInsensitive:function(inp) {
    if(inp === undefined || typeof inp != typeof"a") {
      return inp
    }
    if(this.options.caseSensitive) {
      return inp
    }
    return inp.toLowerCase()
  }, _moveTag:function(old_index, new_index) {
    this.tagsArray.splice(new_index, 0, this.tagsArray.splice(old_index, 1)[0]);
    for(var ind in this.tagsArray) {
      this.tagsArray[ind].index = ind
    }
    if(this.options.select) {
      $("option:eq(" + old_index + ")", this.select).insertBefore($("option:eq(" + new_index + ")", this.select))
    }
  }, tags:function() {
    return this.tagsArray
  }, destroy:function() {
    $.Widget.prototype.destroy.apply(this, arguments);
    this.tagsArray = []
  }, reset:function() {
    this.element.find(".tagit-choice").remove();
    this.tagsArray = [];
    if(this.options.select) {
      this.select.children().remove();
      this.select.change()
    }
    this._initialTags();
    if(this.options.tagsChanged) {
      this.options.tagsChanged(null, "reset", null)
    }
    if(typeof $().watermark == "function") {
      this.input.watermark(this.options.watermarkAllowMessage)
    }
  }, fill:function(tags) {
    if(tags !== undefined) {
      this.options.initialTags = tags
    }
    this.reset()
  }, add:function(label, value) {
    if(typeof label == "object") {
      return this._addTag({label:label, value:value})
    }else {
      return this._addTag(label, value)
    }
  }, remove:function(value) {
    this._removeTagWithValue(value, value)
  }, tag:function(label, value, element) {
    var self = this;
    return{label:label, value:value === undefined ? label : value, element:element, index:self.tagsArray.length}
  }})
})(jQuery);
VISH.Renderer = function(V, $, undefined) {
  var SLIDE_CONTAINER = null;
  var init = function() {
    SLIDE_CONTAINER = $(".slides");
    VISH.Renderer.Filter.init()
  };
  var renderSlide = function(slide) {
    var content = "";
    var classes = "";
    var buttons = "";
    for(el in slide.elements) {
      if(!VISH.Renderer.Filter.allowElement(slide.elements[el])) {
        content += VISH.Renderer.Filter.renderContentFiltered(slide.elements[el], slide.template)
      }else {
        if(slide.elements[el].type === "text") {
          content += _renderText(slide.elements[el], slide.template)
        }else {
          if(slide.elements[el].type === "image") {
            content += _renderImage(slide.elements[el], slide.template)
          }else {
            if(slide.elements[el].type === "video") {
              content += renderVideo(slide.elements[el], slide.template)
            }else {
              if(slide.elements[el].type === "object") {
                content += _renderObject(slide.elements[el], slide.template);
                classes += "object "
              }else {
                if(slide.elements[el].type === "snapshot") {
                  content += _renderSnapshot(slide.elements[el], slide.template);
                  classes += "snapshot "
                }else {
                  if(slide.elements[el].type === "applet") {
                    content += _renderApplet(slide.elements[el], slide.template);
                    classes += "applet "
                  }else {
                    if(slide.elements[el].type === "flashcard") {
                      content = _renderFlashcard(slide.elements[el], slide.template);
                      classes += "flashcard"
                    }else {
                      if(slide.elements[el].type === "quiz") {
                        content += V.Quiz.Renderer.renderQuiz(slide.elements[el].quiztype, slide.elements[el], slide.template + "_" + slide.elements[el].areaid, slide.id, slide.elements[el].id);
                        classes += "quiz"
                      }else {
                        content += _renderEmpty(slide.elements[el], slide.template)
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    if(V.SlideManager.getPresentationType() === "flashcard") {
      buttons = "<div class='close_slide' id='close" + slide.id + "'></div>"
    }
    var article = $("<article class='" + classes + "' id='" + slide.id + "'>" + buttons + content + "</article>");
    SLIDE_CONTAINER.append(article)
  };
  var _renderText = function(element, template) {
    return"<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + " " + template + "_text" + "'>" + element["body"] + "</div>"
  };
  var _renderEmpty = function(element, template) {
    return"<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + " " + template + "_text" + "'></div>"
  };
  var _renderImage = function(element, template) {
    var div = $("<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + "'></div>");
    var img = $("<img class='" + template + "_image' src='" + element["body"] + "' style='" + element["style"] + "' />");
    if(element["hyperlink"]) {
      var a = $("<a href='" + element["hyperlink"] + "' target='blank_'></a>");
      $(a).append(img);
      $(div).append(a)
    }else {
      $(div).append(img)
    }
    return VISH.Utils.getOuterHTML(div)
  };
  var renderVideo = function(element, template) {
    var rendered = "<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + "'>";
    var style = element["style"] ? "style='" + element["style"] + "'" : "";
    var controls = element["controls"] ? "controls='" + element["controls"] + "' " : "controls='controls' ";
    var autoplay = element["autoplay"] ? "autoplayonslideenter='" + element["autoplay"] + "' " : "";
    var poster = element["poster"] ? "poster='" + element["poster"] + "' " : "";
    var loop = element["loop"] ? "loop='loop' " : "";
    var sources = element["sources"];
    var videoId = VISH.Utils.getId();
    if(typeof sources == "string") {
      sources = JSON.parse(sources)
    }
    rendered = rendered + "<video id='" + videoId + "' class='" + template + "_video' preload='metadata' " + style + controls + autoplay + poster + loop + ">";
    $.each(sources, function(index, source) {
      var type = source.type ? "type='" + source.type + "' " : "";
      rendered = rendered + "<source src='" + source.src + "' " + type + ">"
    });
    if(sources.length > 0) {
      rendered = rendered + "<p>Your browser does not support HTML5 video.</p>"
    }
    rendered = rendered + "</video>";
    return rendered
  };
  var _renderObject = function(element, template) {
    var objectInfo = VISH.Object.getObjectInfo(element.body);
    switch(objectInfo.type) {
      case "youtube":
        return _renderYoutubeVideo(element, template, objectInfo.source);
        break;
      default:
        var style = element["style"] ? element["style"] : "";
        var body = element["body"];
        var zoomInStyle = element["zoomInStyle"] ? element["zoomInStyle"] : "";
        return"<div id='" + element["id"] + "' class='objectelement " + template + "_" + element["areaid"] + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' objectWrapper='" + body + "'>" + "" + "</div>";
        break
    }
  };
  var _renderYoutubeVideo = function(element, template, source) {
    var ytVideoId = VISH.Utils.getId();
    var style = element["style"] ? element["style"] : "";
    var body = element["body"];
    var zoomInStyle = element["zoomInStyle"] ? element["zoomInStyle"] : "";
    source = source.replace("http://www.youtube.com/embed/", "http://www.youtube.com/v/");
    return"<div id='" + element["id"] + "' class='objectelement youtubeelement " + template + "_" + element["areaid"] + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' source='" + source + "' ytVideoId='" + ytVideoId + "'>" + "</div>"
  };
  var _renderSnapshot = function(element, template) {
    var style = element["style"] ? element["style"] : "";
    var body = element["body"];
    var scrollTop = element["scrollTop"] ? element["scrollTop"] : 0;
    var scrollLeft = element["scrollLeft"] ? element["scrollLeft"] : 0;
    return"<div id='" + element["id"] + "' class='snapshotelement " + template + "_" + element["areaid"] + "' template='" + template + "' objectStyle='" + style + "' scrollTop='" + scrollTop + "' scrollTopOrigin='" + scrollTop + "' scrollLeft='" + scrollLeft + "' scrollLeftOrigin='" + scrollLeft + "' objectWrapper='" + body + "'>" + "" + "</div>"
  };
  var _renderApplet = function(element, template) {
    return"<div id='" + element["id"] + "' class='appletelement " + template + "_" + element["areaid"] + "' code='" + element["code"] + "' width='" + element["width"] + "' height='" + element["height"] + "' archive='" + element["archive"] + "' params='" + element["params"] + "' ></div>"
  };
  var _renderFlashcard = function(element, template) {
    return"<div id='" + element["id"] + "' class='template_flashcard'><canvas id='" + element["canvasid"] + "'>Your browser does not support canvas</canvas></div>"
  };
  return{init:init, renderVideo:renderVideo, renderSlide:renderSlide}
}(VISH, jQuery);
VISH.Status = function(V, $, undefined) {
  var device;
  var isInIframe;
  var isOnline;
  var isSlave;
  var isPreventDefault;
  var init = function() {
    device = {};
    device.browser = {};
    device.features = {};
    fillBrowser();
    fillUserAgent();
    fillFeatures();
    _checkOnline()
  };
  var _checkOnline = function() {
    $.ajax({async:true, cache:false, error:function(req, status, ex) {
      console.log("Error: " + ex);
      isOnline = false
    }, success:function(data, status, req) {
      isOnline = true
    }, timeout:5E3, type:"GET", url:VISH.ImagesPath + "blank.png"})
  };
  var fillFeatures = function() {
    setIsInIframe(window.location != window.parent.location ? true : false);
    var elem = document.getElementById("page-fullscreen");
    if(elem && (elem.requestFullScreen || elem.mozRequestFullScreen || elem.webkitRequestFullScreen)) {
      if(!isInIframe) {
        device.features.fullscreen = true
      }else {
        try {
          if(window.parent.location.host === window.location.host && (!window.parent.VISH || !window.parent.VISH.Editor || !(typeof window.parent.VISH.Editor.Preview.getPreview === "function"))) {
            device.features.fullscreen = true
          }
        }catch(e) {
          device.features.fullscreen = false
        }
      }
    }
    device.features.touchScreen = !!("ontouchstart" in window)
  };
  var fillUserAgent = function() {
    device.pixelRatio = window.devicePixelRatio || 1;
    device.viewport = {width:window.innerWidth, height:window.innerHeight};
    device.screen = {width:window.screen.availWidth * device.pixelRatio, height:window.screen.availHeight * device.pixelRatio};
    device.iPhone = /iPhone/i.test(navigator.userAgent);
    device.iPhone4 = device.iPhone && device.pixelRatio == 2;
    device.iPad = /iPad/i.test(navigator.userAgent);
    device.iOS = device.iPhone || device.iPad;
    device.applePhone = device.iPhone || device.iPhone4;
    device.appleTablet = device.iPad;
    device.android = /android/i.test(navigator.userAgent);
    if(device.android) {
      device.androidPhone = false;
      device.androidTablet = false;
      if(/tablet/i.test(navigator.userAgent)) {
        device.androidTablet = true
      }else {
        var maxWidth = 1024 * 1.5;
        var maxHeight = 720 * 1.5;
        var landscape = window.screen.availWidth > window.screen.availHeight;
        if(landscape) {
          if(window.screen.availWidth >= maxWidth && window.screen.availHeight >= maxHeight) {
            device.androidTablet = true
          }else {
            device.androidPhone = true
          }
        }else {
          if(window.screen.availHeight >= maxWidth && window.screen.availWidth >= maxHeight) {
            device.androidTablet = true
          }else {
            device.androidPhone = true
          }
        }
      }
    }else {
      device.androidPhone = false;
      device.androidTablet = false
    }
    device.mobile = device.applePhone || device.androidPhone;
    device.tablet = device.appleTablet || device.androidTablet;
    if(!device.mobile && !device.tablet) {
      device.desktop = true
    }else {
      device.desktop = false
    }
  };
  var fillBrowser = function() {
    var version;
    version = _getInternetExplorerVersion();
    if(version != -1) {
      device.browser.name = VISH.Constant.IE;
      device.browser.version = version;
      return
    }
    version = _getFirefoxVersion();
    if(version != -1) {
      device.browser.name = VISH.Constant.FIREFOX;
      device.browser.version = version;
      return
    }
    version = _getGoogleChromeVersion();
    if(version != -1) {
      device.browser.name = VISH.Constant.CHROME;
      device.browser.version = version;
      return
    }
    device.browser.name = VISH.Constant.UNKNOWN;
    device.browser.name = -1
  };
  var _getInternetExplorerVersion = function() {
    var rv = -1;
    if(navigator.appName === VISH.Constant.UA_IE) {
      var ua = navigator.userAgent;
      var re = new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getFirefoxVersion = function() {
    var rv = -1;
    if(navigator.appName === VISH.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      var re = new RegExp(".* Firefox/([0-9.]+)");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getGoogleChromeVersion = function() {
    var rv = -1;
    if(navigator.appName === VISH.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      var re = new RegExp(".* Chrome/([0-9.]+)");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var getIsInIframe = function() {
    return isInIframe
  };
  var setIsInIframe = function(isIframe) {
    isInIframe = isIframe
  };
  var getIframe = function() {
    if(isInIframe) {
      return window.frameElement
    }else {
      return null
    }
  };
  var getDevice = function() {
    return device
  };
  var getOnline = function() {
    return isOnline
  };
  var setSlaveMode = function(slaveMode) {
    if(slaveMode !== isSlave) {
      if(slaveMode === true) {
        VISH.Events.unbindAllEventListeners();
        VISH.VideoPlayer.HTML5.showControls(false);
        isSlave = true
      }else {
        VISH.Events.bindAllEventListeners();
        VISH.VideoPlayer.HTML5.showControls(true);
        isSlave = false
      }
    }
  };
  var isSlaveMode = function() {
    if(typeof isSlave !== "undefined") {
      return isSlave
    }else {
      return false
    }
  };
  var setPreventDefaultMode = function(preventDefault) {
    if(preventDefault !== isPreventDefault) {
      if(preventDefault === true) {
        isPreventDefault = true
      }else {
        isPreventDefault = false
      }
    }
  };
  var isPreventDefaultMode = function() {
    if(typeof isPreventDefault !== "undefined") {
      return isPreventDefault
    }else {
      return false
    }
  };
  return{init:init, getIsInIframe:getIsInIframe, getIframe:getIframe, getDevice:getDevice, getOnline:getOnline, setSlaveMode:setSlaveMode, isSlaveMode:isSlaveMode, setPreventDefaultMode:setPreventDefaultMode, isPreventDefaultMode:isPreventDefaultMode}
}(VISH, jQuery);
VISH.Utils = function(V, undefined) {
  var init = function() {
  };
  var domId = 0;
  var getId = function() {
    domId = domId + 1;
    return"unicID_" + domId
  };
  var getOuterHTML = function(tag) {
    if(typeof $(tag)[0].outerHTML == "undefined") {
      return $(tag).clone().wrap("<div></div>").parent().html()
    }else {
      return $(tag)[0].outerHTML
    }
  };
  var loadDeviceCSS = function() {
    if(VISH.Status.getDevice().desktop) {
      loadCSS("device/desktop.css")
    }else {
      if(VISH.Status.getDevice().mobile) {
        loadCSS("device/mobile.css")
      }else {
        if(VISH.Status.getDevice().tablet) {
          loadCSS("device/tablet.css")
        }
      }
    }
    switch(VISH.Status.getDevice().browser.name) {
      case VISH.Constant.FIREFOX:
        loadCSS("browser/firefox.css");
        break;
      case VISH.Constant.IE:
        loadCSS("browser/ie.css");
        break;
      case VISH.Constant.CHROME:
        loadCSS("browser/chrome.css");
        break
    }
  };
  var loadCSS = function(path) {
    $("head").append('<link rel="stylesheet" href="' + VISH.StylesheetsPath + path + '" type="text/css" />')
  };
  var generateTable = function(author, title, description) {
    if(!author) {
      author = ""
    }
    if(!title) {
      title = ""
    }
    if(!description) {
      description = ""
    }
    return'<table class="metadata">' + '<tr class="even">' + '<td class="title header_left">' + VISH.Editor.I18n.getTrans("i.Author") + "</td>" + '<td class="title header_right"><div class="height_wrapper">' + author + "</div></td>" + "</tr>" + '<tr class="odd">' + '<td class="title">' + VISH.Editor.I18n.getTrans("i.Title") + "</td>" + '<td class="info"><div class="height_wrapper">' + title + "</div></td>" + "</tr>" + '<tr class="even">' + '<td colspan="2" class="title_description">' + VISH.Editor.I18n.getTrans("i.Description") + 
    "</td>" + "</tr>" + '<tr class="odd">' + '<td colspan="2" class="info_description"><div class="height_wrapper_description">' + description + "</div></td>" + "</tr>" + "</table>"
  };
  var checkMiniumRequirements = function() {
    var browserRequirements = true;
    var device = VISH.Status.getDevice();
    switch(device.browser.name) {
      case VISH.Constant.IE:
        if(VISH.Editing) {
          if(device.browser.version < 9) {
            browserRequirements = false
          }
        }else {
          if(device.browser.version < 8) {
            browserRequirements = false
          }
        }
        break;
      case VISH.Constant.FIREFOX:
        break;
      case VISH.Constant.CHROME:
        break;
      default:
        break
    }
    if(!browserRequirements) {
      $.fancybox($("#requirements_form_wrapper").html(), {"autoDimensions":false, "width":650, "height":400, "showCloseButton":false, "padding":0, "onClosed":function() {
      }});
      return false
    }
    return true
  };
  var convertToTagsArray = function(tags) {
    var tagsArray = [];
    if(!tags || tags.length == 0) {
      return tagsArray
    }
    $.each(tags, function(index, tag) {
      tagsArray.push(tag.value)
    });
    return tagsArray
  };
  var getURLParameter = function(name) {
    return decodeURIComponent((location.search.match(RegExp("[?|&]" + name + "=(.+?)(&|$)")) || [, null])[1])
  };
  var autocompleteUrls = function(input) {
    var http_urls_pattern = /(^http(s)?:\/\/)/g;
    var objectInfo = VISH.Object.getObjectInfo();
    if(objectInfo.wrapper == null && input.match(http_urls_pattern) == null) {
      return"http://" + input
    }else {
      return input
    }
  };
  var filterFilePath = function(path) {
    return path.replace("C:\\fakepath\\", "")
  };
  var getZoomInStyle = function(zoom) {
    var style = "";
    style = style + "-ms-transform: scale(" + zoom + "); ";
    style = style + "-ms-transform-origin: 0 0; ";
    style = style + "-moz-transform: scale(" + zoom + "); ";
    style = style + "-moz-transform-origin: 0 0; ";
    style = style + "-o-transform: scale(" + zoom + "); ";
    style = style + "-o-transform-origin: 0 0; ";
    style = style + "-webkit-transform: scale(" + zoom + "); ";
    style = style + "-webkit-transform-origin: 0 0; ";
    return style
  };
  var getZoomFromStyle = function(style) {
    var zoom = 1;
    if(!style) {
      return zoom
    }
    var moz_zoom_pattern = /-moz-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var webkit_zoom_pattern = /-webkit-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var opera_zoom_pattern = /-o-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var ie_zoom_pattern = /-ms-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    $.each(style.split(";"), function(index, property) {
      if(property.match(moz_zoom_pattern) != null) {
        var result = moz_zoom_pattern.exec(property);
        if(result[1]) {
          zoom = parseFloat(result[1]);
          return false
        }
      }else {
        if(property.match(webkit_zoom_pattern) != null) {
          var result = webkit_zoom_pattern.exec(property);
          if(result[1]) {
            zoom = parseFloat(result[1]);
            return false
          }
        }else {
          if(property.match(opera_zoom_pattern) != null) {
            var result = opera_zoom_pattern.exec(property);
            if(result[1]) {
              zoom = parseFloat(result[1]);
              return false
            }
          }else {
            if(property.match(ie_zoom_pattern) != null) {
              var result = ie_zoom_pattern.exec(property);
              if(result[1]) {
                zoom = parseFloat(result[1]);
                return false
              }
            }
          }
        }
      }
    });
    return zoom
  };
  var loadTab = function(tab_id) {
    V.Debugging.log("load tab id: " + tab_id);
    $(".joyride-close-tip").click();
    $(".fancy_tab_content").hide();
    $("#" + tab_id + "_content").show();
    $(".fancy_tab").removeClass("fancy_selected");
    $("#" + tab_id).addClass("fancy_selected");
    $(".help_in_fancybox").hide();
    $("#" + tab_id + "_help").show();
    switch(tab_id) {
      case "tab_pic_from_url":
        V.Editor.Image.onLoadTab("url");
        break;
      case "tab_pic_upload":
        V.Editor.Image.onLoadTab("upload");
        break;
      case "tab_pic_repo":
        V.Editor.Image.Repository.onLoadTab();
        break;
      case "tab_pic_flikr":
        V.Editor.Image.Flikr.onLoadTab();
        break;
      case "tab_video_from_url":
        VISH.Editor.Video.onLoadTab();
        break;
      case "tab_video_repo":
        VISH.Editor.Video.Repository.onLoadTab();
        break;
      case "tab_video_youtube":
        VISH.Editor.Video.Youtube.onLoadTab();
        break;
      case "tab_video_vimeo":
        VISH.Editor.Video.Vimeo.onLoadTab();
        break;
      case "tab_object_from_url":
        VISH.Editor.Object.onLoadTab("url");
        break;
      case "tab_object_from_web":
        VISH.Editor.Object.Web.onLoadTab();
        break;
      case "tab_object_snapshot":
        VISH.Editor.Object.Snapshot.onLoadTab();
        break;
      case "tab_object_upload":
        VISH.Editor.Object.onLoadTab("upload");
        break;
      case "tab_object_repo":
        VISH.Editor.Object.Repository.onLoadTab();
        break;
      case "tab_live_webcam":
        VISH.Editor.Object.Live.onLoadTab("webcam");
        break;
      case "tab_live_micro":
        VISH.Editor.Object.Live.onLoadTab("micro");
        break;
      default:
        break
    }
  };
  return{init:init, getId:getId, getOuterHTML:getOuterHTML, generateTable:generateTable, loadDeviceCSS:loadDeviceCSS, loadCSS:loadCSS, checkMiniumRequirements:checkMiniumRequirements, convertToTagsArray:convertToTagsArray, getURLParameter:getURLParameter, getZoomFromStyle:getZoomFromStyle, getZoomInStyle:getZoomInStyle, autocompleteUrls:autocompleteUrls, filterFilePath:filterFilePath, loadTab:loadTab}
}(VISH);
VISH.Editor = function(V, $, undefined) {
  var initialPresentation = false;
  var initOptions;
  var currentZone;
  var eventsLoaded = false;
  var confirmOnExit;
  var draftPresentation = null;
  var savedPresentation = null;
  var init = function(options, presentation) {
    VISH.Debugging.init(options);
    VISH.Editing = true;
    if(options) {
      initOptions = options;
      if(options["configuration"] && VISH.Configuration) {
        VISH.Configuration.init(options["configuration"]);
        VISH.Configuration.applyConfiguration()
      }
    }else {
      initOptions = {}
    }
    VISH.Status.init();
    if(!VISH.Utils.checkMiniumRequirements()) {
      return
    }
    VISH.Utils.loadDeviceCSS();
    VISH.Dummies.init();
    VISH.Slides.init();
    VISH.User.init(options);
    if(VISH.Debugging.isDevelopping()) {
      if(options["configuration"]["mode"] == "noserver" && VISH.Debugging.getActionInit() == "loadSamples" && !presentation) {
        presentation = VISH.Debugging.getPresentationSamples()
      }
    }
    if(presentation) {
      initialPresentation = true;
      setPresentation(presentation);
      VISH.Editor.Renderer.init(presentation);
      _removeSelectableProperties();
      if(presentation.type === "flashcard") {
        VISH.Editor.Flashcard.loadFlashcard(presentation)
      }
    }
    $("a#addSlideFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":640, "height":350, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      setCurrentArea($("#" + clickedZoneId));
      VISH.Utils.loadTab("tab_templates")
    }});
    $("a#addQuizFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":385, "height":340, "padding":0, "onStart":function(data) {
      VISH.Utils.loadTab("tab_quizes")
    }});
    if(!eventsLoaded) {
      eventsLoaded = true;
      $(document).on("click", "#edit_presentation_details", VISH.Editor.Tools.Menu.onSettings);
      $(document).on("click", "#save", VISH.Editor.Tools.Menu.onSaveButtonClicked);
      $(document).on("click", "#save_presentation_details", VISH.Editor.Tools.Menu.onSavePresentationDetailsButtonClicked);
      $(document).on("click", ".templatethumb", _onTemplateThumbClicked);
      $(document).on("click", ".editable", _onEditableClicked);
      $(document).on("click", ".selectable", _onSelectableClicked);
      $(document).on("click", ".delete_content", _onDeleteItemClicked);
      $(document).on("click", ".delete_slide", _onDeleteSlideClicked);
      $(document).on("click", "#arrow_left_div", _onArrowLeftClicked);
      $(document).on("click", "#arrow_right_div", _onArrowRightClicked);
      $(document).on("click", "#fc_change_bg_big", V.Editor.Tools.changeFlashcardBackground);
      _addEditorEnterLeaveEvents();
      VISH.Editor.Utils.redrawSlides();
      VISH.Editor.Thumbnails.redrawThumbnails();
      _addTutorialEvents();
      window.onbeforeunload = exitConfirmation;
      confirmOnExit = true
    }
    if(presentation) {
      $(".object_wrapper").hide()
    }
    VISH.Editor.I18n.init(options["lang"]);
    VISH.Editor.Text.init();
    VISH.Editor.Image.init();
    VISH.Editor.Video.init();
    VISH.Editor.Object.init();
    VISH.Editor.Thumbnails.init();
    VISH.Editor.AvatarPicker.init();
    VISH.Editor.Quiz.init();
    VISH.Editor.Tools.init();
    VISH.Editor.Filter.init();
    if(options.addons) {
      VISH.Addons.init(options.addons)
    }
  };
  var getOptions = function() {
    return initOptions
  };
  var addDeleteButton = function(element) {
    element.append("<div class='delete_content'></div>")
  };
  var _addTutorialEvents = function() {
    $(document).on("click", "#start_tutorial", function() {
      VISH.Editor.Tour.startTourWithId("initial_screen_help", "top")
    });
    $(document).on("click", "#help_right", function() {
      VISH.Editor.Tour.startTourWithId("menubar_help", "top")
    });
    $(document).on("click", "#help_flashcard", function() {
      VISH.Editor.Tour.startTourWithId("fc_help", "top")
    });
    $(document).on("click", "#help_template_image", function() {
      VISH.Editor.Tour.startTourWithId("template_help", "bottom")
    });
    $(document).on("click", "#tab_quizes_help", function() {
      V.Debugging.log("click tab_quizes_help detected");
      VISH.Editor.Tour.startTourWithId("help_quiz_selection_help", "bottom")
    });
    $(document).on("click", "#help_themes_selection", function() {
      VISH.Editor.Tour.startTourWithId("themes_help", "bottom")
    });
    $(document).on("click", "#help_template_selection", function() {
      VISH.Editor.Tour.startTourWithId("help_template_selection_help", "bottom")
    });
    $(document).on("click", "#tab_pic_from_url_help", function() {
      VISH.Editor.Tour.startTourWithId("images_fancy_tabs_id_help", "top")
    });
    $(document).on("click", "#tab_pic_upload_help", function() {
      VISH.Editor.Tour.startTourWithId("upload_picture_form_help", "top")
    });
    $(document).on("click", "#tab_pic_repo_help", function() {
      VISH.Editor.Tour.startTourWithId("search_picture_help", "bottom")
    });
    $(document).on("click", "#tab_pic_flikr_help", function() {
      VISH.Editor.Tour.startTourWithId("search_flickr_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_object_from_url_help", function() {
      VISH.Editor.Tour.startTourWithId("object_fancy_tabs_id_help", "top")
    });
    $(document).on("click", "#tab_object_from_web_help", function() {
      VISH.Editor.Tour.startTourWithId("object_fancy_tabs_web_help", "top")
    });
    $(document).on("click", "#tab_object_upload_help", function() {
      VISH.Editor.Tour.startTourWithId("upload_object_form_help", "top")
    });
    $(document).on("click", "#tab_object_repo_help", function() {
      VISH.Editor.Tour.startTourWithId("search_object_help", "bottom")
    });
    $(document).on("click", "#tab_object_snapshot_help", function() {
      VISH.Editor.Tour.startTourWithId("object_fancy_tabs_websnapshot_help", "bottom")
    });
    $(document).on("click", "#tab_video_from_url_help", function() {
      VISH.Editor.Tour.startTourWithId("video_fancy_tabs_id_help", "top")
    });
    $(document).on("click", "#tab_video_repo_help", function() {
      VISH.Editor.Tour.startTourWithId("search_video_help", "top")
    });
    $(document).on("click", "#tab_video_youtube_help", function() {
      VISH.Editor.Tour.startTourWithId("search_youtube_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_video_vimeo_help", function() {
      VISH.Editor.Tour.startTourWithId("search_vimeo_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_live_webcam_help", function() {
      VISH.Editor.Tour.startTourWithId("tab_live_webcam_id", "bottom")
    })
  };
  var _addEditorEnterLeaveEvents = function() {
    $("article").live("slideenter", _onslideenterEditor);
    $("article").live("slideleave", _onslideleaveEditor)
  };
  var _onslideenterEditor = function(e) {
    setTimeout(function() {
      $(e.target).find(".object_wrapper").show()
    }, 500)
  };
  var _onslideleaveEditor = function() {
    $(".object_wrapper").hide()
  };
  var _onTemplateThumbClicked = function(event) {
    var theid = draftPresentation ? draftPresentation.id : "";
    var slide = VISH.Dummies.getDummy($(this).attr("template"), VISH.Slides.getSlides().length, theid, false);
    VISH.Editor.Utils.addSlide(slide);
    $.fancybox.close();
    VISH.Editor.Utils.redrawSlides();
    VISH.Editor.Thumbnails.redrawThumbnails();
    setTimeout("VISH.Slides.lastSlide()", 300)
  };
  var _onEditableClicked = function(event) {
    $(this).removeClass("editable");
    setCurrentArea($(this));
    var content = $("#menuselect").clone().attr("id", "current_menu");
    $(content).find("a").css("display", "none");
    $(content).find("a.all").css("display", "inline");
    switch($(this).attr("size")) {
      case VISH.Constant.SMALL:
        $(content).find("a.small").css("display", "inline");
        $(content).find("a > div").addClass("thumb_small");
        break;
      case VISH.Constant.MEDIUM:
        $(content).find("a.medium").css("display", "inline");
        $(content).find("a > div").addClass("thumb_medium");
        break;
      case VISH.Constant.LARGE:
        $(content).find("a.large").css("display", "inline");
        $(content).find("a > div").addClass("thumb_large");
        break
    }
    $(this).html(content);
    $("a.addpicture").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      setCurrentArea($("#" + clickedZoneId));
      VISH.Utils.loadTab("tab_pic_from_url")
    }});
    $("a.addobject").fancybox({"autoDimensions":false, "width":800, "height":600, "scrolling":"no", "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      setCurrentArea($("#" + clickedZoneId));
      VISH.Utils.loadTab("tab_object_from_url")
    }});
    $("a.addvideo").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      setCurrentArea($("#" + clickedZoneId));
      VISH.Utils.loadTab("tab_video_from_url")
    }});
    $("a.addLive").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      setCurrentArea($("#" + clickedZoneId));
      VISH.Utils.loadTab("tab_live_webcam")
    }});
    $("a.addQuiz").click(function(event) {
      $("a#addQuizFancybox").trigger("click")
    })
  };
  var _onDeleteItemClicked = function() {
    setCurrentArea($(this).parent());
    $("#image_template_prompt").attr("src", VISH.ImagesPath + getCurrentArea().attr("type") + ".png");
    $.fancybox($("#prompt_form").html(), {"autoDimensions":false, "scrolling":"no", "width":350, "height":150, "showCloseButton":false, "padding":0, "onClosed":function() {
      if($("#prompt_answer").val() === "true") {
        $("#prompt_answer").val("false");
        getCurrentArea().html("");
        $(".theslider").hide();
        getCurrentArea().removeAttr("type");
        getCurrentArea().addClass("editable")
      }
    }})
  };
  var _onDeleteSlideClicked = function() {
    var article_to_delete = $(this).parent();
    $("#image_template_prompt").attr("src", VISH.ImagesPath + "templatesthumbs/" + article_to_delete.attr("template") + ".png");
    $.fancybox($("#prompt_form").html(), {"autoDimensions":false, "width":350, "scrolling":"no", "height":150, "showCloseButton":false, "padding":0, "onClosed":function() {
      if($("#prompt_answer").val() === "true") {
        $("#prompt_answer").val("false");
        $(".theslider").hide();
        article_to_delete.remove();
        VISH.Slides.onDeleteSlide();
        VISH.Editor.Utils.redrawSlides();
        VISH.Editor.Thumbnails.redrawThumbnails()
      }
    }})
  };
  var _onSelectableClicked = function() {
    setCurrentArea($(this));
    _removeSelectableProperties($(this));
    _addSelectableProperties($(this));
    VISH.Editor.Tools.loadToolsForZone($(this))
  };
  var _addSelectableProperties = function(zone) {
    $(zone).css("cursor", "auto");
    $(zone).css("border-color", "rgb(255, 2, 94)");
    $(zone).css("-webkit-box-shadow", "inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(255, 100, 100, 0.6)");
    $(zone).css("-moz-box-shadow", "inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(255, 100, 100, 0.6)");
    $(zone).css("box-shadow", "inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(255, 100, 100, 0.6)");
    $(zone).css("outline", "0");
    $(zone).css("outline", "thin dotted 9")
  };
  var _removeSelectableProperties = function(zone) {
    $(".selectable").css("border-color", "none");
    $(".selectable").css("-webkit-box-shadow", "none");
    $(".selectable").css("-moz-box-shadow", "none");
    $(".selectable").css("box-shadow", "none");
    $(".selectable").css("outline", "0");
    $(".selectable").css("cursor", "pointer")
  };
  var savePresentation = function(forcePresentation) {
    $(".object_wrapper").show();
    var presentation = {};
    if(draftPresentation) {
      presentation.id = draftPresentation.id
    }else {
      presentation.id = ""
    }
    if(forcePresentation) {
      presentation.type = "presentation"
    }else {
      presentation.type = getPresentationType()
    }
    if(presentation.type === "flashcard") {
      presentation.background = {};
      presentation.background.src = $("#flashcard-background").css("background-image");
      presentation.background.pois = VISH.Editor.Flashcard.savePois()
    }
    if(draftPresentation) {
      presentation.title = draftPresentation.title;
      presentation.description = draftPresentation.description;
      presentation.avatar = draftPresentation.avatar;
      presentation.tags = draftPresentation.tags;
      presentation.theme = draftPresentation.theme
    }
    presentation.author = "";
    presentation.slides = [];
    presentation.contain_quiz = false;
    var slide = {};
    $(".slides > article").each(function(index, s) {
      slide.id = $(s).attr("id");
      slide.type = "standard";
      slide.template = $(s).attr("template");
      slide.elements = [];
      var element = {};
      $(s).addClass("temp_shown");
      $(s).find("div").each(function(i, div) {
        if($(div).attr("areaid") !== undefined) {
          element.id = $(div).attr("id");
          element.type = $(div).attr("type");
          element.areaid = $(div).attr("areaid");
          if(element.type == "text") {
            element.body = VISH.Editor.Text.changeFontPropertiesToSpan($(div).find(".wysiwygInstance"))
          }else {
            if(element.type == "image") {
              element.body = $(div).find("img").attr("src");
              element.style = VISH.Editor.Utils.getStylesInPercentages($(div), $(div).find("img"));
              if($(div).attr("hyperlink")) {
                element.hyperlink = $(div).attr("hyperlink")
              }
            }else {
              if(element.type == "video") {
                var video = $(div).find("video");
                element.poster = $(video).attr("poster");
                element.style = VISH.Editor.Utils.getStylesInPercentages($(div), $(video));
                var sources = "";
                $(video).find("source").each(function(index, source) {
                  if(index != 0) {
                    sources = sources + ","
                  }
                  var type = typeof $(source).attr("type") != "undefined" ? ' "type": "' + $(source).attr("type") + '", ' : "";
                  sources = sources + "{" + type + '"src": "' + $(source).attr("src") + '"}'
                });
                sources = "[" + sources + "]";
                element.sources = sources
              }else {
                if(element.type == "object") {
                  var object = $(div).find(".object_wrapper").children()[0];
                  var myObject = $(object).clone();
                  $(myObject).removeAttr("style");
                  element.body = VISH.Utils.getOuterHTML(myObject);
                  element.style = VISH.Editor.Utils.getStylesInPercentages($(div), $(object).parent());
                  var zoom = VISH.Utils.getZoomFromStyle($(object).attr("style"));
                  if(zoom != 1) {
                    element.zoomInStyle = VISH.Utils.getZoomInStyle(zoom)
                  }
                }else {
                  if(element.type == "quiz") {
                    presentation.contain_quiz = true;
                    V.Debugging.log("div value:" + $(div));
                    element.question = VISH.Editor.Text.changeFontPropertiesToSpan($(div).find(".wysiwygInstance").parent().find("div > div"));
                    if($(div).find(".multiplechoice_text_in_zone")) {
                      element.quiztype = "multiplechoice";
                      element.options = [];
                      $(div).find(".multiplechoice_text_in_zone").each(function(i, input_text) {
                        if(input_text && input_text.value != "") {
                          element.options.push(input_text.value)
                        }
                      })
                    }else {
                      V.Debugging.log("another kind of quiz detected")
                    }
                  }else {
                    if(element.type == "openquestion") {
                      element.title = $(div).find(".title_openquestion").val();
                      element.question = $(div).find(".value_openquestion").val()
                    }else {
                      if(element.type == "mcquestion") {
                        element.question = $(div).find(".value_multiplechoice_question").val();
                        element.options = [];
                        $(div).find(".multiplechoice_text").each(function(i, input_text) {
                          if(input_text && input_text.value != "") {
                            element.options.push(input_text.value)
                          }
                        })
                      }else {
                        if(element.type == "truefalsequestion") {
                          V.Debugging.log("element type truefalsequestion detected");
                          element.questions = [];
                          var question = {};
                          $(div).find(".true_false_question").each(function(i, input_text) {
                            question.id = i;
                            question.text_question = input_text.value;
                            if($(".current").find("input:radio[name='answer_" + (i + 1) + "']:checked").val() == undefined) {
                              question.answer = "null"
                            }else {
                              question.answer = $(".current").find("input:radio[name='answer_" + (i + 1) + "']:checked").val()
                            }
                            element.questions.push(question);
                            question = {}
                          })
                        }else {
                          if(element.type === "snapshot") {
                            var snapshotWrapper = $(div).find(".snapshot_wrapper");
                            var snapshotIframe = $(snapshotWrapper).children()[0];
                            $(snapshotIframe).removeAttr("style");
                            element.body = VISH.Utils.getOuterHTML(snapshotIframe);
                            element.style = VISH.Editor.Utils.getStylesInPercentages($(div), snapshotWrapper);
                            element.scrollTop = $(snapshotWrapper).scrollTop();
                            element.scrollLeft = $(snapshotWrapper).scrollLeft()
                          }else {
                            if(typeof element.type == "undefined") {
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          slide.elements.push(element);
          element = {}
        }
        if(slide.type == "quiz") {
          var quizSlide = $.extend(true, new Object, slide);
          var quizPresentation = new Object;
          quizPresentation.title = presentation.title;
          quizPresentation.description = presentation.description;
          quizPresentation.author = "";
          quizPresentation.slides = [quizSlide];
          quizPresentation.type = "quiz_simple";
          slide.quiz_simple_json = quizPresentation;
          VISH.Debugging.log(JSON.stringify(quizPresentation))
        }
      });
      presentation.slides.push(slide);
      slide = {};
      $(s).removeClass("temp_shown")
    });
    savedPresentation = presentation;
    console.log(JSON.stringify(presentation));
    return savedPresentation
  };
  var afterSavePresentation = function(presentation, order) {
    VISH.Debugging.log("VISH.Configuration.getConfiguration()[mode]: " + VISH.Configuration.getConfiguration()["mode"]);
    switch(VISH.Configuration.getConfiguration()["mode"]) {
      case VISH.Constant.NOSERVER:
        if(VISH.Debugging && VISH.Debugging.isDevelopping()) {
          if(VISH.Debugging.getActionSave() == "view") {
            VISH.Debugging.initVishViewer()
          }else {
            if(VISH.Debugging.getActionSave() == "edit") {
              VISH.Debugging.initVishEditor()
            }
          }
        }
        break;
      case VISH.Constant.VISH:
        var send_type;
        if(initialPresentation) {
          send_type = "PUT"
        }else {
          send_type = "POST"
        }
        var draft = order === "draft";
        var jsonPresentation = JSON.stringify(presentation);
        VISH.Debugging.log(jsonPresentation);
        var params = {"excursion[json]":jsonPresentation, "authenticity_token":initOptions["token"], "draft":draft, "contain_quiz":presentation.contain_quiz};
        $.ajax({type:send_type, url:VISH.UploadPresentationPath, data:params, success:function(data) {
          allowExitWithoutConfirmation();
          window.top.location.href = data.url
        }});
        break;
      case VISH.Constant.STANDALONE:
        uploadPresentationWithNode(presentation);
        break
    }
  };
  var uploadPresentationWithNode = function(presentation) {
    var send_type;
    var url = VISH.UploadPresentationPath;
    if(draftPresentation) {
      send_type = "PUT";
      url = url + draftPresentation.id
    }else {
      send_type = "POST"
    }
    var jsonPresentation = JSON.stringify(presentation);
    var params = {"presentation[json]":jsonPresentation};
    $.ajax({type:send_type, url:url, data:params, success:function(data) {
      allowExitWithoutConfirmation();
      window.top.location.href = data.url
    }})
  };
  var _onArrowLeftClicked = function() {
    VISH.Slides.backwardOneSlide()
  };
  var _onArrowRightClicked = function() {
    VISH.Slides.forwardOneSlide()
  };
  var getTemplate = function(area) {
    if(area) {
      return area.parent().attr("template")
    }else {
      if(getCurrentArea()) {
        return getCurrentArea().parent().attr("template")
      }
    }
    return null
  };
  var getCurrentArea = function() {
    if(currentZone) {
      return currentZone
    }
    return null
  };
  var setCurrentArea = function(area) {
    currentZone = area
  };
  var getPresentation = function() {
    return draftPresentation
  };
  var setPresentation = function(presentation) {
    draftPresentation = presentation
  };
  var getSavedPresentation = function() {
    if(savedPresentation) {
      return savedPresentation
    }else {
      return null
    }
  };
  var hasInitialPresentation = function() {
    return initialPresentation
  };
  var loadFancyBox = function(fancy) {
    var fancyBoxes = {1:"templates", 2:"quizes"};
    for(tab in fancyBoxes) {
      $("#tab_" + fancyBoxes[tab] + "_content").hide();
      $("#tab_" + fancyBoxes[tab]).attr("class", "");
      $("#tab_" + fancyBoxes[tab]).attr("class", "fancy_tab")
    }
    $("#tab_" + fancy + "_content").show();
    $("#tab_" + fancy).attr("class", "fancy_tab fancy_selected")
  };
  var getPresentationType = function() {
    if(!draftPresentation || !draftPresentation.type) {
      return"presentation"
    }
    return draftPresentation.type
  };
  var setPresentationType = function(type) {
    if(!draftPresentation) {
      draftPresentation = new Object
    }
    if(type) {
      draftPresentation.type = type
    }else {
      draftPresentation.type = "presentation"
    }
  };
  var isPresentationStandard = function() {
    var type = getPresentationType();
    if(type != "presentation") {
      return false
    }
    if($("article[template]").length === 0) {
      return true
    }
    var isStandard = true;
    presentation = savePresentation();
    $.each(presentation.slides, function(index, slide) {
      if(slide.type && slide.type != "standard") {
        isStandard = false;
        return
      }
    });
    return isStandard
  };
  var isPresentationDraft = function() {
    if(initialPresentation) {
      if(initOptions["draft"] && typeof initOptions["draft"] === "boolean") {
        return initOptions["draft"]
      }else {
        return false
      }
    }else {
      return true
    }
  };
  var exitConfirmation = function() {
    if(VISH.Configuration.getConfiguration()["mode"] === VISH.Constant.VISH && confirmOnExit) {
      return VISH.Editor.I18n.getTrans("i.exitConfirmation")
    }else {
      return
    }
  };
  var allowExitWithoutConfirmation = function() {
    confirmOnExit = false
  };
  return{init:init, addDeleteButton:addDeleteButton, getTemplate:getTemplate, getCurrentArea:getCurrentArea, getPresentationType:getPresentationType, getOptions:getOptions, loadFancyBox:loadFancyBox, getPresentation:getPresentation, setPresentation:setPresentation, isPresentationStandard:isPresentationStandard, isPresentationDraft:isPresentationDraft, getSavedPresentation:getSavedPresentation, hasInitialPresentation:hasInitialPresentation, savePresentation:savePresentation, afterSavePresentation:afterSavePresentation, 
  setPresentationType:setPresentationType, allowExitWithoutConfirmation:allowExitWithoutConfirmation}
}(VISH, jQuery);
VISH.Editor.Video = function(V, $, undefined) {
  var urlDivId = "tab_video_from_url_content";
  var urlInputId = "video_url";
  var init = function() {
    VISH.Editor.Video.HTML5.init();
    VISH.Editor.Video.Repository.init();
    VISH.Editor.Video.Youtube.init();
    VISH.Editor.Video.Vimeo.init();
    var urlInput = $("#" + urlInputId);
    $(urlInput).watermark("Paste video URL");
    $("#tab_video_from_url_content .previewButton").click(function(event) {
      if(VISH.Police.validateObject($(urlInput).val())[0]) {
        contentToAdd = VISH.Utils.autocompleteUrls($("#" + urlInputId).val());
        VISH.Editor.Object.drawPreview("tab_video_from_url_content", contentToAdd)
      }else {
        contentToAdd = null
      }
    })
  };
  var onLoadTab = function(tab) {
    $("#tab_video_from_url_content").find("input").val("");
    VISH.Editor.Object.resetPreview("tab_video_from_url_content")
  };
  var drawPreviewElement = function() {
    VISH.Editor.Object.drawPreviewObject(contentToAdd)
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement}
}(VISH, jQuery);
VISH.Editor.Image = function(V, $, undefined) {
  var contentToAdd = null;
  var contentAddMode = VISH.Constant.NONE;
  var uploadDivId = "tab_pic_upload_content";
  var urlDivId = "tab_pic_from_url_content";
  var urlInputId = "picture_url";
  var init = function() {
    VISH.Editor.Image.Flikr.init();
    VISH.Editor.Image.Repository.init();
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(VISH.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = VISH.Utils.autocompleteUrls($("#" + urlInputId).val());
        VISH.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    });
    var options = VISH.Editor.getOptions();
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = VISH.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_document_submit").click(function(event) {
      if(!VISH.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          var description = "Uploaded by " + VISH.User.getName() + " via Vish Editor";
          $("#" + uploadDivId + " input[name='document[description]']").val(description);
          $("#" + uploadDivId + " input[name='document[owner_id]']").val(VISH.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(VISH.User.getToken());
          $("#" + uploadDivId + " .documentsForm").attr("action", VISH.UploadImagePath);
          $("#" + uploadDivId + " input[name='tags']").val(VISH.Utils.convertToTagsArray($(tagList).tagit("tags")));
          var tagList = $("#" + uploadDivId + " .tagList");
          $(tagList).parent().hide();
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      processResponse(xhr.responseText);
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }})
  };
  var onLoadTab = function(tab) {
    if(tab == "upload") {
      _onLoadUploadTab()
    }
    if(tab == "url") {
      _onLoadURLTab()
    }
  };
  var _onLoadURLTab = function() {
    contentToAdd = null;
    VISH.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var _onLoadUploadTab = function() {
    contentToAdd = null;
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    VISH.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    VISH.Editor.Object.resetPreview(uploadDivId);
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).tagit("reset")
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:15, maxTags:8, watermarkAllowMessage:VISH.Editor.I18n.getTrans("i.AddTags"), watermarkDenyMessage:VISH.Editor.I18n.getTrans("i.limitReached")})
    }
  };
  var processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(VISH.Police.validateObject(jsonResponse.src)[0]) {
          VISH.Editor.Object.drawPreview(uploadDivId, jsonResponse.src);
          contentToAdd = jsonResponse.src
        }
      }
    }catch(e) {
    }
  };
  var addContent = function(content) {
    if(content) {
      contentToAdd = content
    }
    switch(contentAddMode) {
      case VISH.Constant.FLASHCARD:
        VISH.Editor.Flashcard.onBackgroundSelected(contentToAdd);
        break;
      case VISH.Constant.THUMBNAIL:
        VISH.Editor.AvatarPicker.onCustomThumbnailSelected(contentToAdd);
        break;
      default:
        VISH.Editor.Object.drawPreviewObject(contentToAdd)
    }
    contentAddMode = VISH.Constant.NONE
  };
  var drawImage = function(image_url, area, style, hyperlink) {
    _drawImageInArea(image_url, area, style, hyperlink)
  };
  var _drawImageInArea = function(image_url, area, style, hyperlink) {
    var current_area;
    var reference_width = 100;
    var image_width = 300;
    var image_height = null;
    if(area) {
      current_area = area
    }else {
      current_area = VISH.Editor.getCurrentArea()
    }
    if(style) {
      style = V.Editor.Utils.setStyleInPixels(style, current_area);
      image_width = V.Editor.Utils.getWidthFromStyle(style, current_area)
    }
    var template = VISH.Editor.getTemplate();
    var nextImageId = VISH.Utils.getId();
    var idToDragAndResize = "draggable" + nextImageId;
    current_area.attr("type", "image");
    if(hyperlink) {
      current_area.attr("hyperlink", hyperlink)
    }
    current_area.html("<img class='" + template + "_image' id='" + idToDragAndResize + "' title='Click to drag' src='" + image_url + "' style='" + style + "'/>");
    V.Editor.addDeleteButton(current_area);
    var scaleFactor = image_width / reference_width;
    $("#menubar").before("<div id='sliderId" + nextImageId + "' class='theslider'><input id='imageSlider" + nextImageId + "' type='slider' name='size' value='" + scaleFactor + "' style='display: none; '></div>");
    $("#imageSlider" + nextImageId).slider({from:1, to:15, step:0.25, round:1, dimension:"x", skin:"blue", onstatechange:function(value) {
      var originalHeight = $("#" + idToDragAndResize).height();
      var originalWidth = $("#" + idToDragAndResize).width();
      var newWidth = reference_width * value;
      $("#" + idToDragAndResize).width(newWidth);
      if(originalHeight === $("#" + idToDragAndResize).height()) {
        var aspectRatio = originalHeight / originalWidth;
        if(aspectRatio != 0) {
          $("#" + idToDragAndResize).height(newWidth * aspectRatio)
        }
      }
    }});
    $("#" + idToDragAndResize).draggable({cursor:"move", stop:function() {
      $(this).parent().click()
    }})
  };
  var setAddContentMode = function(mode) {
    contentAddMode = mode
  };
  return{init:init, onLoadTab:onLoadTab, drawImage:drawImage, addContent:addContent, setAddContentMode:setAddContentMode}
}(VISH, jQuery);
VISH.Editor.Object = function(V, $, undefined) {
  var contentToAdd = null;
  var uploadDivId = "tab_object_upload_content";
  var urlDivId = "tab_object_from_url_content";
  var urlInputId = "object_embed_code";
  var init = function() {
    VISH.Editor.Object.Repository.init();
    VISH.Editor.Object.Live.init();
    VISH.Editor.Object.Web.init();
    VISH.Editor.Object.PDF.init();
    VISH.Editor.Object.Snapshot.init();
    var urlInput = $(urlDivId).find("input");
    $(urlInput).watermark("Paste SWF file URL");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(VISH.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = VISH.Utils.autocompleteUrls($("#" + urlInputId).val());
        drawPreview(urlDivId, contentToAdd)
      }
    });
    var options = VISH.Editor.getOptions();
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = VISH.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_document_submit").click(function(event) {
      if(!VISH.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          var description = "Uploaded by " + VISH.User.getName() + " via Vish Editor";
          $("#" + uploadDivId + " input[name='document[description]']").val(description);
          $("#" + uploadDivId + " input[name='document[owner_id]']").val(VISH.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(VISH.User.getToken());
          $("#" + uploadDivId + " .documentsForm").attr("action", VISH.UploadObjectPath);
          $("#" + uploadDivId + " input[name='tags']").val(VISH.Utils.convertToTagsArray($(tagList).tagit("tags")));
          var tagList = $("#" + uploadDivId + " .tagList");
          $(tagList).parent().hide();
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      processResponse(xhr.responseText);
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }})
  };
  var onLoadTab = function(tab) {
    if(tab == "upload") {
      _onLoadUploadTab()
    }
    if(tab == "url") {
      _onLoadURLTab()
    }
  };
  var _onLoadURLTab = function() {
    contentToAdd = null;
    resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var _onLoadUploadTab = function() {
    contentToAdd = null;
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    VISH.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    resetPreview(uploadDivId);
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).tagit("reset")
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:15, maxTags:8, watermarkAllowMessage:VISH.Editor.I18n.getTrans("i.AddTags"), watermarkDenyMessage:VISH.Editor.I18n.getTrans("i.limitReached")})
    }
  };
  var processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(VISH.Police.validateObject(jsonResponse.src)[0]) {
          drawPreview(uploadDivId, jsonResponse.src);
          contentToAdd = jsonResponse.src
        }
      }
    }catch(e) {
    }
  };
  var previewBackground;
  var drawPreview = function(divId, src) {
    previewBackground = $("#" + divId + " .previewimgbox").css("background-image");
    $("#" + divId + " .previewimgbox").css("background-image", "none");
    $("#" + divId + " .previewimgbox img.imagePreview").remove();
    var wrapper = renderObjectPreview(src);
    if($("#" + divId + " .previewimgbox .objectPreview").length > 0) {
      $("#" + divId + " .previewimgbox .objectPreview").remove()
    }
    $("#" + divId + " .previewimgbox").append(wrapper);
    $("#" + divId + " .previewimgbox button").show();
    $("#" + divId + " .documentblank").addClass("documentblank_extraMargin");
    $("#" + divId + " .buttonaddfancy").addClass("buttonaddfancy_extraMargin")
  };
  var resetPreview = function(divId) {
    $("#" + divId + " .previewimgbox button").hide();
    $("#" + divId + " .previewimgbox img.imagePreview").remove();
    $("#" + divId + " .previewimgbox .objectPreview").remove();
    if(previewBackground) {
      $("#" + divId + " .previewimgbox").css("background-image", previewBackground)
    }
    $("#" + divId + " .documentblank").removeClass("documentblank_extraMargin");
    $("#" + divId + " .buttonaddfancy").removeClass("buttonaddfancy_extraMargin")
  };
  var drawPreviewElement = function() {
    drawPreviewObject(contentToAdd)
  };
  var drawPreviewObject = function(content) {
    if(content) {
      drawObject(content);
      $.fancybox.close()
    }
  };
  var resizeObject = function(id, newWidth) {
    var parent = $("#" + id).parent();
    var aspectRatio = $("#" + id).width() / $("#" + id).height();
    var newWrapperHeight = Math.round(newWidth / aspectRatio);
    var newWrapperWidth = Math.round(newWidth);
    $(parent).width(newWrapperWidth);
    $(parent).height(newWrapperHeight);
    var zoom = V.Utils.getZoomFromStyle($("#" + id).attr("style"));
    if(zoom != 1) {
      newWidth = newWidth / zoom;
      var newHeight = Math.round(newWidth / aspectRatio);
      newWidth = Math.round(newWidth)
    }else {
      var newHeight = newWrapperHeight;
      var newWidth = newWrapperWidth
    }
    $("#" + id).width(newWidth);
    $("#" + id).height(newHeight)
  };
  var _adjustWrapperOfObject = function(objectID, current_area) {
    var proportion = $("#" + objectID).height() / $("#" + objectID).width();
    var maxWidth = current_area.width();
    var maxHeight = current_area.height();
    var width = $("#" + objectID).width();
    var height = $("#" + objectID).height();
    if(width > maxWidth) {
      $("#" + objectID).width(maxWidth);
      $("#" + objectID).height(width * proportion);
      width = maxWidth;
      height = $("#" + objectID).height()
    }
    if(height > maxHeight) {
      $("#" + objectID).height(maxHeight);
      $("#" + objectID).width(height / proportion);
      width = $("#" + objectID).width();
      height = maxHeight
    }
    var wrapper = $("#" + objectID).parent();
    if($(wrapper).hasClass("object_wrapper")) {
      $(wrapper).height($("#" + objectID).height());
      $(wrapper).width($("#" + objectID).width())
    }
  };
  var autofixWrapperedObjectAfterZoom = function(object, zoom) {
    var wrapper = $(object).parent();
    $(object).height($(wrapper).height() / zoom);
    $(object).width($(wrapper).width() / zoom)
  };
  var renderObjectPreview = function(object) {
    var objectInfo = VISH.Object.getObjectInfo(object);
    switch(objectInfo.wrapper) {
      case null:
        switch(objectInfo.type) {
          case "image":
            return"<img class='imagePreview' src='" + object + "'></img>";
            break;
          case "swf":
            return"<embed class='objectPreview' src='" + object + "' wmode='opaque' ></embed>";
            break;
          case "pdf":
            return VISH.Editor.Object.PDF.generatePreviewWrapperForPdf(object);
            break;
          case "youtube":
            return VISH.Editor.Video.Youtube.generatePreviewWrapperForYoutubeVideoUrl(object);
            break;
          case "HTML5":
            return VISH.Editor.Video.HTML5.renderVideoFromSources([object]);
            break;
          case "web":
            return VISH.Editor.Object.Web.generatePreviewWrapperForWeb(object);
            break;
          default:
            VISH.Debugging.log("Unrecognized object source type");
            break
        }
        break;
      case "EMBED":
        return _genericWrapperPreview(object);
        break;
      case "OBJECT":
        return _genericWrapperPreview(object);
        break;
      case "IFRAME":
        return _genericWrapperPreview(object);
        break;
      default:
        VISH.Debugging.log("Unrecognized object wrapper: " + objectInfo.wrapper);
        break
    }
  };
  var _genericWrapperPreview = function(object) {
    var wrapperPreview = $(object);
    $(wrapperPreview).addClass("objectPreview");
    $(wrapperPreview).attr("wmode", "opaque");
    $(wrapperPreview).removeAttr("width");
    $(wrapperPreview).removeAttr("height");
    return wrapperPreview
  };
  var drawObject = function(object, area, style, zoomInStyle) {
    if(!VISH.Police.validateObject(object)[0]) {
      return
    }
    var current_area;
    var object_style = "";
    if(area) {
      current_area = area
    }else {
      current_area = VISH.Editor.getCurrentArea()
    }
    if(style) {
      object_style = style
    }
    var objectInfo = VISH.Object.getObjectInfo(object);
    switch(objectInfo.wrapper) {
      case null:
        switch(objectInfo.type) {
          case "image":
            V.Editor.Image.drawImage(object);
            break;
          case "swf":
            V.Editor.Object.Flash.drawFlashObjectWithSource(object, object_style);
            break;
          case "pdf":
            V.Editor.Object.drawObject(V.Editor.Object.PDF.generateWrapperForPdf(object));
            break;
          case "youtube":
            V.Editor.Object.drawObject(V.Editor.Video.Youtube.generateWrapperForYoutubeVideoUrl(object));
            break;
          case "HTML5":
            V.Editor.Video.HTML5.drawVideoWithUrl(object);
            break;
          case "web":
            V.Editor.Object.drawObject(V.Editor.Object.Web.generateWrapperForWeb(object));
            break;
          default:
            V.Debugging.log("Unrecognized object source type: " + objectInfo.type);
            break
        }
        break;
      case "EMBED":
        drawObjectWithWrapper(object, current_area, object_style);
        break;
      case "OBJECT":
        drawObjectWithWrapper(object, current_area, object_style);
        break;
      case "IFRAME":
        drawObjectWithWrapper(object, current_area, object_style, zoomInStyle);
        break;
      default:
        VISH.Debugging.log("Unrecognized object wrapper: " + objectInfo.wrapper);
        break
    }
  };
  var drawObjectWithWrapper = function(wrapper, current_area, style, zoomInStyle) {
    var template = V.Editor.getTemplate(current_area);
    var nextWrapperId = V.Utils.getId();
    var idToDrag = "draggable" + nextWrapperId;
    var idToResize = "resizable" + nextWrapperId;
    current_area.attr("type", "object");
    var wrapperDiv = document.createElement("div");
    wrapperDiv.setAttribute("id", idToDrag);
    if(style) {
      wrapperDiv.setAttribute("style", style)
    }
    $(wrapperDiv).addClass("object_wrapper");
    var wrapperTag = $(wrapper);
    $(wrapperTag).attr("id", idToResize);
    $(wrapperTag).attr("class", template + "_object");
    $(wrapperTag).attr("wmode", "opaque");
    $(current_area).html("");
    $(current_area).append(wrapperDiv);
    VISH.Editor.addDeleteButton($(current_area));
    $(wrapperDiv).append(wrapperTag);
    var width, value;
    if(style) {
      width = V.Editor.Utils.getWidthFromStyle(style, current_area);
      value = 10 * width / $(current_area).width()
    }else {
      value = 10
    }
    var mystep = $(current_area).width() / 10;
    $("#menubar").before("<div id='sliderId" + nextWrapperId + "' class='theslider'><input id='imageSlider" + nextWrapperId + "' type='slider' name='size' value='" + value + "' style='display: none; '></div>");
    $("#imageSlider" + nextWrapperId).slider({from:1, to:10, step:0.2, round:1, dimension:"x", skin:"blue", onstatechange:function(value) {
      resizeObject(idToResize, mystep * value)
    }});
    $("#" + idToDrag).draggable({cursor:"move"});
    _adjustWrapperOfObject(idToResize, current_area);
    VISH.Editor.Tools.loadToolbarForObject(wrapper);
    if(zoomInStyle) {
      $(wrapperTag).attr("style", zoomInStyle);
      VISH.ObjectPlayer.adjustDimensionsAfterZoom($(wrapperTag))
    }
  };
  return{init:init, onLoadTab:onLoadTab, drawObject:drawObject, renderObjectPreview:renderObjectPreview, resizeObject:resizeObject, autofixWrapperedObjectAfterZoom:autofixWrapperedObjectAfterZoom, drawPreview:drawPreview, resetPreview:resetPreview, drawPreviewElement:drawPreviewElement, drawPreviewObject:drawPreviewObject}
}(VISH, jQuery);
VISH.Samples = function(V, undefined) {
  var samples = {"id":"2", "type":"presentation", "title":"Chess: The Art of Learning2", "description":"The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by Vish Editor.", "avatar":"http://static.betazeta.com/www.veoverde.com/wp-content/uploads/2011/07/fotos-gatos.jpg", "tags":["Samples", "Test", "Development"], "author":"", "theme":"theme1", "slides":[{"id":"articlearticle1", "template":"t1", "elements":[{"id":"zone1", 
  "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"vish5", "template":"t2", "elements":[{"id":"325", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, 
  {"id":"7335", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="" type="application/x-shockwave-flash"></embed>'}]}, {"id":"articlearticle4", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article__4", "type":"standard", "template":"t2", "elements":[{"id":"zone11", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]};
  var samples_sync = {"id":"2", "type":"presentation", "title":"Chess: The Art of Learning2", "description":"The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by Vish Editor.", "avatar":"http://static.betazeta.com/www.veoverde.com/wp-content/uploads/2011/07/fotos-gatos.jpg", "tags":["Samples", "Test", "Development"], "author":"", "theme":"theme1", "slides":[{"id":"articlearticle1", "template":"t1", "elements":[{"id":"zone1", 
  "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"vish5", "template":"t2", "elements":[{"id":"325", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, 
  {"id":"7335", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="" type="application/x-shockwave-flash"></embed>'}]}, {"id":"articlearticle4", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article__4", "type":"standard", "template":"t2", "elements":[{"id":"zone11", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/bT2yo3_R51o?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}, {"id":"vish10", "template":"t2", "elements":[{"id":"331", "type":"text", "areaid":"header", 
  "body":"Sublime HTML5 video!"}, {"id":"332", "type":"video", "areaid":"left", "controls":true, "autoplay":false, "loop":false, "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":'[{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},{"type": "video/mp4","src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4"}]'}]}]};
  var samples_flashcard = {"id":"", "title":"Chess: The Art of Learning", "description":"The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by Vish Editor.", "avatar":"/vishEditor/images/excursion_thumbnails/excursion-10.png", "author":"", "type":"flashcard", "background":{"src":"url(http://html.rincondelvago.com/000563580.png)", "pois":[{"id":"poi1", "x":"11", "y":"4.5", "slide_id":"1"}, {"id":"poi2", "x":"47", "y":"34", 
  "slide_id":"2"}, {"id":"poi3", "x":"84", "y":"81", "slide_id":"3"}]}, "slides":[{"id":"1", "template":"t1", "elements":[{"id":"zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"2", "template":"t2", "elements":[{"id":"325", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, {"id":"7335", 
  "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"3", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"4", "template":"t1", "elements":[{"id":"zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"5", "template":"t3", "elements":[{"id":"zone4", "type":"text", "areaid":"header", "body":"Puesta de sol..."}, {"id":"zone5", 
  "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:44.31314623338257%; height:50.90909090909091%; top:0%; left:0%;"}]}, {"id":"6", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"7", "template":"t1", "elements":[{"id":"zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"8", "template":"t3", "elements":[{"id":"zone4", "type":"text", "areaid":"header", "body":"Puesta de sol..."}, {"id":"zone5", 
  "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:44.31314623338257%; height:50.90909090909091%; top:0%; left:0%;"}]}, {"id":"9", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}]};
  var samples_game = {"id":"", "title":"Chess: The Art of Learning", "description":"The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by Vish Editor.", "avatar":"/vishEditor/images/excursion_thumbnails/excursion-10.png", "author":"", "type":"game", "game":{"src":"games/sokoban/sokoban.html", "actions":{"devil":{"slide_id":"1", "when":"after"}, "diamond":{"slide_id":"2", "when":"before"}}}, "slides":[{"id":"1", "template":"t1", 
  "elements":[{"id":"zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"2", "template":"t3", "elements":[{"id":"zone4", "type":"text", "areaid":"header", "body":"Puesta de sol..."}, {"id":"zone5", 
  "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:44.31314623338257%; height:50.90909090909091%; top:0%; left:0%;"}]}, {"id":"3", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}]};
  var full_samples = {"id":"1", "type":"presentation", "title":"Nanoyou", "description":"This excursion is about nanotechnology", "avatar":"/vishEditor/images/excursion_thumbnails/excursion-02.png", "author":"Enrique Barra", "slides":[{"id":"vish1", "author":"John Doe", "template":"t1", "elements":[{"id":"315", "type":"text", "areaid":"header", "body":"Ejemplo de flora"}, {"id":"316", "type":"text", "areaid":"left", "body":'<div><ol><li>lolo<br></li><li>perrito<br></li></ol><div><font size="6">gato</font></div></div>'}, 
  {"id":"317", "type":"image", "areaid":"right", "body":"http://www.asturtalla.com/arbol.jpg"}]}, {"id":"vish2", "template":"t2", "elements":[{"id":"318", "type":"text", "areaid":"header", "body":"Ejemplo de fauna..."}, {"id":"319", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg"}]}, {"id":"vish3", "template":"t1", "elements":[{"id":"320", "type":"text", "areaid":"header", "body":"Sensores"}, {"id":"321", "type":"text", 
  "areaid":"left", "body":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas orci nisl, euismod a posuere ac, commodo quis ipsum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec sollicitudin risus laoreet velit dapibus bibendum. Nullam cursus sollicitudin hendrerit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nunc ullamcorper tempor bibendum. Morbi gravida pretium leo, vitae scelerisque quam mattis eu. Sed hendrerit molestie magna, sit amet porttitor nulla facilisis in. Donec vel massa mauris, sit amet condimentum lacus.</p>"}, 
  {"id":"322", "type":"image", "areaid":"right", "body":"http://www.satec.es/es-ES/NuestraActividad/CasosdeExito/PublishingImages/IMG%20Do%C3%B1ana/do%C3%B1ana_fig2.png"}]}, {"id":"vish4", "template":"t2", "elements":[{"id":"323", "type":"text", "areaid":"header", "body":"Puesta de sol..."}, {"id":"324", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg"}]}, {"id":"vish5", "template":"t2", "elements":[{"id":"325", "type":"text", 
  "areaid":"header", "body":"Experimento virtual1"}, {"id":"7335", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"vish8", "template":"t2", "elements":[{"id":"329", "type":"openquestion", "areaid":"header", "body":"Do you like this slide?", "posturl":"http://localhost/quiz/adfklkdf"}]}, {"id":"vish9", "template":"t2", "elements":[{"id":"330", "type":"mcquestion", "areaid":"header", 
  "body":"Do you like this slide?", "posturl":"http://localhost/quiz/adfklkdf", "options":["yes", "no", "maybe"], "rightanswer":0}]}, {"id":"vish10", "template":"t2", "elements":[{"id":"331", "type":"text", "areaid":"header", "body":"Sublime HTML5 video!"}, {"id":"332", "type":"video", "areaid":"left", "controls":true, "autoplay":false, "loop":false, "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":'[{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},{"type": "video/mp4","src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4"}]'}]}, 
  {"id":"vish11", "template":"t1", "elements":[{"id":"333", "type":"text", "areaid":"header", "body":"Example of HTML5 video with autostart"}, {"id":"334", "type":"text", "areaid":"left", "body":"<p> HTML5 is a language for structuring and presenting content for the World Wide Web, and is a core technology of the Internet originally proposed by Opera Software. It is the fifth revision of the HTML standard (created in 1990 and standardized as HTML4 as of 1997) and as of March 2012 is still under development. Its core aims have been to improve the language with support for the latest multimedia while keeping it easily readable by humans and consistently understood by computers and devices (web browsers, parsers, etc.). HTML5 is intended to subsume not only HTML 4, but XHTML 1 and DOM Level 2 HTML as well.</p>"}, 
  {"id":"335", "type":"video", "areaid":"right", "controls":true, "autoplay":true, "sources":'[{ "type": "video/webm", "src": "videos/kids.webm"},{"type": "video/mp4","src": "videos/kids.mp4"}]'}]}, {"id":"vish12", "template":"t2", "elements":[{"id":"393", "type":"text", "areaid":"header", "body":"Example of Youtube video"}, {"id":"394", "type":"object", "areaid":"left", "body":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns" frameborder="0" allowfullscreen></iframe>'}]}, 
  {"id":"vish13", "template":"t2", "elements":[{"id":"393", "type":"text", "areaid":"header", "body":"Example of Youtube video with style param"}, {"id":"335", "type":"object", "areaid":"left", "body":'<iframe width="324" height="243" src="http://www.youtube.com/embed/_jvDzfTRP4E" frameborder="0" allowfullscreen></iframe>', "style":"position: relative; left: 163px; top: 110px; width: 325px; height: 215px;"}]}, {"id":"vish14", "template":"t1", "elements":[{"id":"7393", "type":"text", "areaid":"header", 
  "body":"Example of generic Object visualization"}, {"id":"7334", "type":"text", "areaid":"left", "body":"<p> HTML5 is a language for structuring and presenting content for the World Wide Web, and is a core technology of the Internet originally proposed by Opera Software. It is the fifth revision of the HTML standard (created in 1990 and standardized as HTML4 as of 1997) and as of March 2012 is still under development. Its core aims have been to improve the language with support for the latest multimedia while keeping it easily readable by humans and consistently understood by computers and devices (web browsers, parsers, etc.). HTML5 is intended to subsume not only HTML 4, but XHTML 1 and DOM Level 2 HTML as well.</p>"}, 
  {"id":"7335", "type":"object", "areaid":"right", "body":'<embed width="100%" height="80%" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash"></embed>'}]}]};
  var quizes_samples = {"type":"presentation", "id":12313, "author":"", "slides":[{"id":"article1", "type":"quiz", "quiz_id":"1112", "template":"t11", "elements":[{"id":"zone1", "areaid":"header"}, {"id":"zone2", "type":"mcquestion", "areaid":"left", "question":"\u00bfFuncionara los Multiple Choice Quiz ?", "options":["Si", "Claro que si", "Siempre", "No"]}]}]};
  var quizes_samples_2 = {"type":"presentation", "id":5555, "author":"V\u00edctor Hugo", "slides":[{"id":"article1", "quiz_id":"1112", "template":"t11", "elements":[{"id":"zone1", "areaid":"header"}, {"id":"zone2", "type":"mcquestion", "areaid":"left", "question":"Which is the capital of Brazil", "options":["Lima", "Santiago", "R\u00edo De Janeiro", "Brasilia", "Bogota"], "quiz_simple_json":{"type":"quiz_simple", "id":12313, "author":"", "slides":[{"id":"article1", "type":"quiz", "template":"t11", 
  "elements":[{"id":"zone1", "areaid":"header"}, {"id":"zone2", "type":"mcquestion", "areaid":"left", "question":"\u00bfFuncionara los Multiple Choice Quiz ?", "options":["Si", "Claro que si", "Siempre", "No"]}]}]}}]}]};
  var quizes_samples_3 = {"id":12314, "type":"presentation", "author":"V. Hugo", "slides":[{"id":"article12312", "type":"standard", "template":"t8", "elements":[{"id":"zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:undefined;undefined;"><u><i><b>Testing Quiz Inside Template</b></i></u></span></div>'}, {"id":"zone2", "type":"image", "areaid":"left", 
  "body":"http://farm9.staticflickr.com/8309/8039451611_e4bb74e963_m.jpg", "style":"position: relative; width:135.13513513513513%; height:97.0873786407767%; top:0%; left:0%;"}, {"id":"zone3", "type":"quiz", "quizid":12, "areaid":"center", "question":"What are <b> you  <u>talking</u> <i> <font size='7'> about </font> bla bla bla bla ... large textttttt </i></b> ?", "quiztype":"multiplechoice", "options":["Something", "Nothing", "Everything", "Option D"]}, {"id":"zone4", "areaid":"right"}]}, {"id":"article_12314_1", 
  "type":"standard", "template":"t7", "elements":[{"id":"zone5", "type":"text", "areaid":"header", "body":'<div style="text-align: center; font-weight: normal; " class="vish-parent-font6"><i><b><span class="vish-font6 vish-fontgeorgia" style="color:undefined;undefined;">Titling ... one two three</span></b></i></div><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"zone6", "type":"text", "areaid":"left", "body":'<div class="initTextDiv vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div><div class="initTextDiv vish-parent-font5"><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;">The code that has</span><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"><br></span></div>'}, 
  {"id":"zone7", "type":"quiz", "quizid":13, "areaid":"center", "question":'<b style="font-weight: normal; "><i><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Second </span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;undefined;">question</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"> quiz quiz quiz ... ?</span></i></b>', "quiztype":"multiplechoice", "options":["aaa ... mucha a ", "bbb ... mucha b ", "ccc ... mucha c"]}, 
  {"id":"zone8", "type":"image", "areaid":"subheader", "body":"http://farm3.staticflickr.com/2653/3950938406_8a2429bf14_m.jpg", "style":"position: relative; width:68.18181818181819%; height:333.3333333333333%; top:-126.3157894736842%; left:14.242428866299717%;"}]}]};
  return{full_samples:full_samples, samples:samples, samples_flashcard:samples_flashcard, samples_game:samples_game, samples_sync:samples_sync, quizes_samples:quizes_samples, quizes_samples_2:quizes_samples_2, quizes_samples_3:quizes_samples_3}
}(VISH);
VISH.Samples.API = function(V, undefined) {
  var imageList = {"pictures":[{"id":54, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.dan-dare.org/dan%20simpsons/TheSimpsonsEveryoneEver800.jpg"}, {"id":55, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://3.bp.blogspot.com/--H0o8mc28bA/TxrsnMAFMDI/AAAAAAAAARs/eOCVIXKlm9I/s1600/sala-cine.jpg"}, {"id":56, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, 
  {"id":57, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.granadablogs.com/pateandoelmundo/wp-content/uploads/2009/10/_061.jpg"}, {"id":58, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.revistaintime.com/wp-content/uploads/2012/03/el-padrino-2.jpg"}, {"id":59, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://cinealdesnudo.files.wordpress.com/2011/12/el-indomable-will-hunting.jpg"}, {"id":60, 
  "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://politicamenteconservador.blogia.com/upload/20060818041914-el-senor-de-los-anillos2.jpg"}, {"id":61, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://despertando.me/wp-content/uploads/2012/04/el-se%C3%B1or-de-los-anillos.jpg"}, {"id":62, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://4.bp.blogspot.com/-Fh_v8PYbVg0/TyGdKEiYmKI/AAAAAAAAAPI/MKdfZ224aEQ/s1600/el_senor_de_los_anillos_la_batalla_por_la_tierra_media_2_the_rise_of_the_witchking-181035.jpg"}, 
  {"id":63, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://1.bp.blogspot.com/_9PpLM82o3g0/S8uPONu3kaI/AAAAAAAAC9A/thHNALuFxdE/s1600/Gandalf-vs-El-Balrog-gandalf-7018563-1280-960.jpg"}, {"id":64, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"NOVAACARGAR"}, {"id":65, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":66, "title":"ClintEastwood.jpg", 
  "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":67, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":68, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}, {"id":69, "title":"ClintEastwoooood.jpg", "description":"this is clint", 
  "author":"Demo", "src":"http://upload.wikimedia.org/wikipedia/en/4/47/Simpsons_on_Tracey_Ullman.png"}]};
  var imageListLittle = {"pictures":[{"id":54, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.dan-dare.org/dan%20simpsons/TheSimpsonsEveryoneEver800.jpg"}, {"id":55, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://3.bp.blogspot.com/--H0o8mc28bA/TxrsnMAFMDI/AAAAAAAAARs/eOCVIXKlm9I/s1600/sala-cine.jpg"}, {"id":56, "title":"ClintEastwood.jpg", "description":null, "author":"Demo", "src":"http://www.deviantart.com/download/46036660/The_Simpsonzu_by_spacecoyote.jpg"}]};
  var imageListDummy = {"pictures":[]};
  var video = {"id":"1534", "title":"Midnight Sun", "description":"Awesome HTML5 video example", "author":"John Doe", "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"};
  var videoList = {"videos":[{"id":"1534", "title":"HTML5 Demo", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML. HTML5 especifica dos variantes de sintaxis para HTML: un clasico HTML (text/html), la variante conocida como HTML5 y una variante XHTML conocida como sintaxis XHTML5 que debera ser servida como XML (XHTML) (application/xhtml+xml).1 2 Esta es la primera vez que HTML y XHTML se han desarrollado en paralelo.", 
  "author":"Awesome Videos", "poster":"http://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Sasso_lungo_da_passo_pordoi.jpg/250px-Sasso_lungo_da_passo_pordoi.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1535", "title":"Paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1536", "title":"Otro paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://1.bp.blogspot.com/-DFj9INluj80/TfiNl7q3DbI/AAAAAAAAAws/hVJu13VbKEY/s1600/paisaje.jpg", 
  "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1537", "title":"Verde", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://www.forodefotos.com/attachments/naturaleza/12983d1281113830-fotos-de-paisaje-fotos-de-paisaje.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + 
  '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1538", "title":"Noche", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://ro18.blogspot.es/img/paisaje.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1539", 
  "title":"Puesta de sol", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://walpaper.es/images/wallpapers/Paisaje-fotografia-HDR-656343.jpeg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1540", "title":"Cayuco", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://3.bp.blogspot.com/-a-WrZZf0WJo/TsEBPXjUQXI/AAAAAAAAFBg/kh0aS9Kemag/s1600/PAISAJE+JUANMA.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1541", "title":"Aves", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://images.artelista.com/artelista/obras/fichas/8/3/3/8619208014133041.JPG", 
  "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1542", "title":"Delfines", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://4.bp.blogspot.com/-CfZKEdXcXtg/TijG57sIFWI/AAAAAAAAARQ/O8FP1OQ0a0w/s1600/delfines-saltando.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + 
  '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1543", "title":"Gato", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://www.10puntos.com/wp-content/uploads/2010/09/gato-lindo.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + 
  "]"}, {"id":"1544", "title":"Otro gato", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://neko.koiora.net/files/2011/06/Gato17.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1545", "title":"Gato ninja", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://www.sarda.es/fotos/gato_volador/gato_volador.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}]};
  var videoListLittle = {"videos":[{"id":"1534", "title":"HTML5 Demo", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML. HTML5 especifica dos variantes de sintaxis para HTML: un clasico HTML (text/html), la variante conocida como HTML5 y una variante XHTML conocida como sintaxis XHTML5 que debera ser servida como XML (XHTML) (application/xhtml+xml).1 2 Esta es la primera vez que HTML y XHTML se han desarrollado en paralelo.", 
  "author":"Awesome Videos", "poster":"http://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Sasso_lungo_da_passo_pordoi.jpg/250px-Sasso_lungo_da_passo_pordoi.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1535", "title":"Paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", 
  "poster":"http://d1p69vb2iuddhr.cloudfront.net/assets/www/demo/midnight_sun_800-e460322294501e1d5db9ab3859dd859a.jpg", "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}, {"id":"1536", "title":"Otro paisaje bonito", "description":"Awesome HTML5 video example", "author":"Aldo Gordillo", "poster":"http://1.bp.blogspot.com/-DFj9INluj80/TfiNl7q3DbI/AAAAAAAAAws/hVJu13VbKEY/s1600/paisaje.jpg", 
  "sources":"[" + '{ "type": "video/webm", "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_720p.webm"},' + '{ "type": "video/mp4",  "src": "http://media.jilion.com/videos/demo/midnight_sun_sv1_360p.mp4" }' + "]"}]};
  var videoListDummy = {"videos":[]};
  var flashList = {"flashes":[{"id":"1534", "title":"Profe", "description":"Flash Object Test", "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1535", "title":"Youtube video about HTML5", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML.", "author":"W3C", "content":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns?wmode=opaque" frameborder="0" allowfullscreen></iframe>'}, 
  {"id":"1536", "title":"Global excursion", "description":"Iframe example", "author":"Vish", "content":'<iframe width="100%" height="100%" src="http://www.globalexcursion-project.eu"></iframe>'}, {"id":"1537", "title":"Image", "description":"Image Embed", "author":"Globedia", "content":'<embed width="100%" src="http://globedia.com/imagenes/noticias/2011/2/10/encuentran-octava-maravilla-mundo-destruida-125-anos_2_585286.jpg"></embed>'}, {"id":"1538", "title":"Profe Demo", "description":"Flash Object Test 2", 
  "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1539", "title":"Profe Demo", "description":"Flash Object Test 2", "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1540", "title":"Profe Demo", "description":"Flash Object Test 2", 
  "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1541", "title":"Profe Demo", "description":"Flash Object Test 2", "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1542", "title":"Profe Demo", "description":"Flash Object Test 2", 
  "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1543", "title":"Youtube video", "description":"Flash Object Test 2", "author":"FlashMan", "content":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns" frameborder="0" allowfullscreen></iframe>'}]};
  var flashListLittle = {"flashes":[{"id":"1534", "title":"Profe", "description":"Flash Object Test", "author":"FlashMan", "content":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1535", "title":"Youtube video about HTML5", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML.", "author":"W3C", 
  "content":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns?wmode=opaque" frameborder="0" allowfullscreen></iframe>'}, {"id":"1536", "title":"Global excursion", "description":"Iframe example", "author":"Vish", "content":'<iframe width="100%" height="100%" src="http://www.globalexcursion-project.eu"></iframe>'}]};
  var flashListDummy = {"flashes":[]};
  var liveList = [{"id":"1534", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1535", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1536", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1537", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1538", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1539", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1540", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1541", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1542", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1543", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1544", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1545", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, 
  {"id":"1546", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1547", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1548", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}];
  var liveListLittle = [{"id":"1534", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1535", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}, {"id":"1548", "title":"Do\u00f1ana Test", "description":"Parque Nacional de Do\u00f1ana (Spain) ", "author":"Demo", "fulltext":"http://www.youtube.com/watch?v=5TVrUFxzOk8"}];
  var liveListDummy = [];
  var objectList = [{"id":"1534", "title":"Game Strauss", "description":"Fichero PDF", "author":"Conspirazzi", "object":"http://www.conspirazzi.com/e-books/game-strauss.pdf"}, {"id":"1536", "title":"Profe", "description":"Flash Object Test", "author":"FlashMan", "object":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1537", "title":"Youtube video about HTML5", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML.", 
  "author":"W3C", "object":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns?wmode=opaque" frameborder="0" allowfullscreen></iframe>'}, {"id":"1538", "title":"Global excursion", "description":"Iframe example", "author":"Vish", "object":'<iframe width="100%" height="100%" src="http://www.globalexcursion-project.eu"></iframe>'}, {"id":"1539", "title":"Image", "description":"Image Embed", "author":"Globedia", "object":'<embed width="100%" src="http://globedia.com/imagenes/noticias/2011/2/10/encuentran-octava-maravilla-mundo-destruida-125-anos_2_585286.jpg"></embed>'}, 
  {"id":"1540", "title":"Profe Demo", "description":"Flash Object Test 2", "author":"FlashMan", "object":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}];
  var objectListLittle = [{"id":"1534", "title":"Game Strauss", "description":"Fichero PDF", "author":"Conspirazzi", "object":"http://www.conspirazzi.com/e-books/game-strauss.pdf"}, {"id":"1536", "title":"Profe", "description":"Flash Object Test", "author":"FlashMan", "object":'<embed width="100%" height="100%" id="player_api" src="contents/swf/virtualexperiment_1.swf" type="application/x-shockwave-flash" wmode="opaque"></embed>'}, {"id":"1537", "title":"Youtube video about HTML5", "description":"HTML5 (HyperText Markup Language, version 5) es la quinta revision importante del lenguaje basico de la World Wide Web, HTML.", 
  "author":"W3C", "object":'<iframe width="560" height="315" src="http://www.youtube.com/embed/1hR7EtD6Bns?wmode=opaque" frameborder="0" allowfullscreen></iframe>'}];
  var objectListDummy = [];
  var tagsList = {"tags":["ActionScript", "AppleScript", "Asp", "BASIC", "C", "C++", "Clojure", "COBOL", "ColdFusion", "Erlang", "Fortran", "Groovy", "Haskell", "Java", "JavaScript", "Lisp", "Perl", "PHP", "Python", "Ruby", "Scala", "Scheme"]};
  var thumbnailsList = {"pictures":[{"title":"Thumbnail 1", "description":"Sample excursion thumbnail 1", "src":"/vishEditor/images/excursion_thumbnails/excursion-01.png"}, {"title":"Thumbnail 2", "description":"Sample excursion thumbnail 2", "src":"/vishEditor/images/excursion_thumbnails/excursion-02.png"}, {"title":"Thumbnail 3", "description":"Sample excursion thumbnail 3", "src":"/vishEditor/images/excursion_thumbnails/excursion-03.png"}, {"title":"Thumbnail 4", "description":"Sample excursion thumbnail 4", 
  "src":"/vishEditor/images/excursion_thumbnails/excursion-04.png"}, {"title":"Thumbnail 5", "description":"Sample excursion thumbnail 5", "src":"/vishEditor/images/excursion_thumbnails/excursion-05.png"}, {"title":"Thumbnail 6", "description":"Sample excursion thumbnail 6", "src":"/vishEditor/images/excursion_thumbnails/excursion-06.png"}, {"title":"Thumbnail 7", "description":"Sample excursion thumbnail 7", "src":"/vishEditor/images/excursion_thumbnails/excursion-07.png"}, {"title":"Thumbnail 8", 
  "description":"Sample excursion thumbnail 8", "src":"/vishEditor/images/excursion_thumbnails/excursion-08.png"}, {"title":"Thumbnail 9", "description":"Sample excursion thumbnail 9", "src":"/vishEditor/images/excursion_thumbnails/excursion-09.png"}, {"title":"Thumbnail 10", "description":"Sample excursion thumbnail 10", "src":"/vishEditor/images/excursion_thumbnails/excursion-10.png"}, {"title":"Thumbnail 11", "description":"Sample excursion thumbnail 11", "src":"/vishEditor/images/excursion_thumbnails/excursion-11.png"}, 
  {"title":"Thumbnail 12", "description":"Sample excursion thumbnail 12", "src":"/vishEditor/images/excursion_thumbnails/excursion-12.png"}, {"title":"Thumbnail 13", "description":"Sample excursion thumbnail 13", "src":"/vishEditor/images/excursion_thumbnails/excursion-13.png"}, {"title":"Thumbnail 14", "description":"Sample excursion thumbnail 14", "src":"/vishEditor/images/excursion_thumbnails/excursion-14.png"}, {"title":"Thumbnail 15", "description":"Sample excursion thumbnail 15", "src":"/vishEditor/images/excursion_thumbnails/excursion-15.png"}, 
  {"title":"Thumbnail 16", "description":"Sample excursion thumbnail 16", "src":"/vishEditor/images/excursion_thumbnails/excursion-16.png"}, {"title":"Thumbnail 17", "description":"Sample excursion thumbnail 17", "src":"/vishEditor/images/excursion_thumbnails/excursion-17.png"}, {"title":"Thumbnail 18", "description":"Sample excursion thumbnail 18", "src":"/vishEditor/images/excursion_thumbnails/excursion-18.png"}, {"title":"Thumbnail 19", "description":"Sample excursion thumbnail 19", "src":"/vishEditor/images/excursion_thumbnails/excursion-19.png"}, 
  {"title":"Thumbnail 20", "description":"Sample excursion thumbnail 20", "src":"/vishEditor/images/excursion_thumbnails/excursion-20.png"}, {"title":"Thumbnail 21", "description":"Sample excursion thumbnail 21", "src":"/vishEditor/images/excursion_thumbnails/excursion-21.png"}, {"title":"Thumbnail 22", "description":"Sample excursion thumbnail 22", "src":"/vishEditor/images/excursion_thumbnails/excursion-22.png"}, {"title":"Thumbnail 23", "description":"Sample excursion thumbnail 23", "src":"/vishEditor/images/excursion_thumbnails/excursion-23.png"}, 
  {"title":"Thumbnail 24", "description":"Sample excursion thumbnail 24", "src":"/vishEditor/images/excursion_thumbnails/excursion-24.png"}, {"title":"Thumbnail 25", "description":"Sample excursion thumbnail 25", "src":"/vishEditor/images/excursion_thumbnails/excursion-25.png"}, {"title":"Thumbnail 26", "description":"Sample excursion thumbnail 26", "src":"/vishEditor/images/excursion_thumbnails/excursion-26.png"}, {"title":"Thumbnail 27", "description":"Sample excursion thumbnail 27", "src":"/vishEditor/images/excursion_thumbnails/excursion-27.png"}, 
  {"title":"Thumbnail 28", "description":"Sample excursion thumbnail 28", "src":"/vishEditor/images/excursion_thumbnails/excursion-28.png"}, {"title":"Thumbnail 29", "description":"Sample excursion thumbnail 29", "src":"/vishEditor/images/excursion_thumbnails/excursion-29.png"}, {"title":"Thumbnail 30", "description":"Sample excursion thumbnail 30", "src":"/vishEditor/images/excursion_thumbnails/excursion-30.png"}]};
  return{imageList:imageList, imageListLittle:imageListLittle, imageListDummy:imageListDummy, videoList:videoList, videoListLittle:videoListLittle, videoListDummy:videoListDummy, flashList:flashList, flashListLittle:flashListLittle, flashListDummy:flashListDummy, liveList:liveList, liveListLittle:liveListLittle, liveListDummy:liveListDummy, objectList:objectList, objectListLittle:objectListLittle, objectListDummy:objectListDummy, tagsList:tagsList, thumbnailsList:thumbnailsList}
}(VISH);
VISH.Slides = function(V, $, undefined) {
  var slideEls;
  var curSlideIndex;
  var SLIDE_CLASSES = ["far-past", "past", "current", "next", "far-next"];
  var init = function() {
    getcurSlideIndexFromHash();
    $(document).bind("OURDOMContentLoaded", handleDomLoaded)
  };
  var handleDomLoaded = function() {
    slideEls = document.querySelectorAll("section.slides > article");
    addFontStyle();
    updateSlides();
    $("body").addClass("loaded")
  };
  var getCurrentSlide = function() {
    return slideEls[curSlideIndex]
  };
  var getCurrentSlideNumber = function() {
    return curSlideIndex + 1
  };
  var setCurrentSlideNumber = function(currentSlideNumber) {
    curSlideIndex = currentSlideNumber - 1
  };
  var getSlides = function() {
    return slideEls
  };
  var isCurrentFirstSlide = function() {
    return curSlideIndex === 0
  };
  var isCurrentLastSlide = function() {
    return curSlideIndex === slideEls.length - 1
  };
  var isSlideSelected = function() {
    if(curSlideIndex > -1) {
      return true
    }
  };
  var onDeleteSlide = function() {
    setCurrentSlideNumber(getCurrentSlideNumber() - 1)
  };
  var getNumberOfSlide = function(slide) {
    if(slideEls) {
      var result = 0;
      $.each(slideEls, function(index, value) {
        if($(value).attr("id") == $(slide).attr("id")) {
          result = index;
          return
        }
      });
      return result
    }else {
      return 0
    }
  };
  var _getSlide = function(no) {
    return getSlideWithNumber(no + 1)
  };
  var getSlideWithNumber = function(slideNumber) {
    var no = slideNumber - 1;
    if(no < 0 || no >= slideEls.length) {
      return null
    }else {
      return slideEls[no]
    }
  };
  var updateSlideClass = function(slideNo, className) {
    var el = _getSlide(slideNo);
    if(!el) {
      return
    }
    if(className) {
      $(el).addClass(className)
    }
    for(var i in SLIDE_CLASSES) {
      if(className != SLIDE_CLASSES[i]) {
        $(el).removeClass(SLIDE_CLASSES[i])
      }
    }
  };
  var updateSlides = function(goingRight) {
    _updateSlideEls();
    if(goingRight) {
      triggerLeaveEvent(curSlideIndex - 1)
    }else {
      triggerLeaveEvent(curSlideIndex + 1)
    }
    triggerEnterEvent(curSlideIndex);
    updateHash()
  };
  var _updateSlideEls = function() {
    for(var i = 0;i < slideEls.length;i++) {
      switch(i) {
        case curSlideIndex - 2:
          updateSlideClass(i, "far-past");
          break;
        case curSlideIndex - 1:
          updateSlideClass(i, "past");
          break;
        case curSlideIndex:
          updateSlideClass(i, "current");
          break;
        case curSlideIndex + 1:
          updateSlideClass(i, "next");
          break;
        case curSlideIndex + 2:
          updateSlideClass(i, "far-next");
          break;
        default:
          updateSlideClass(i);
          break
      }
    }
  };
  var _prevSlide = function() {
    if(curSlideIndex > 0) {
      curSlideIndex--;
      updateSlides(false)
    }
  };
  var _nextSlide = function() {
    if(curSlideIndex < slideEls.length - 1) {
      curSlideIndex++;
      updateSlides(true)
    }
  };
  var triggerEnterEvent = function(no) {
    var el = _getSlide(no);
    if(!el) {
      return
    }
    var onEnter = el.getAttribute("onslideenter");
    if(onEnter) {
      (new Function(onEnter)).call(el)
    }
    var evt = document.createEvent("Event");
    evt.initEvent("slideenter", true, true);
    evt.slideNumber = no + 1;
    el.dispatchEvent(evt)
  };
  var triggerLeaveEvent = function(no) {
    var el = _getSlide(no);
    if(!el) {
      return
    }
    var onLeave = el.getAttribute("onslideleave");
    if(onLeave) {
      (new Function(onLeave)).call(el)
    }
    var evt = document.createEvent("Event");
    evt.initEvent("slideleave", true, true);
    evt.slideNumber = no + 1;
    el.dispatchEvent(evt)
  };
  var getcurSlideIndexFromHash = function() {
    var slideNo = parseInt(location.hash.substr(1));
    if(slideNo) {
      curSlideIndex = slideNo - 1
    }else {
      if(VISH.Editing) {
        curSlideIndex = -1
      }else {
        curSlideIndex = 0
      }
    }
  };
  var updateHash = function() {
    location.replace("#" + (curSlideIndex + 1))
  };
  var addFontStyle = function() {
    var el = document.createElement("link");
    el.rel = "stylesheet";
    el.type = "text/css";
    el.href = "http://fonts.googleapis.com/css?family=" + "Open+Sans:regular,semibold,italic,italicsemibold|Droid+Sans+Mono";
    document.body.appendChild(el)
  };
  var addGeneralStyle = function() {
    var el = document.createElement("meta");
    el.name = "viewport";
    el.content = "width=900,height=750";
    document.querySelector("head").appendChild(el);
    var el = document.createElement("meta");
    el.name = "apple-mobile-web-app-capable";
    el.content = "yes";
    document.querySelector("head").appendChild(el)
  };
  var lastSlide = function() {
    goToSlide(slideEls.length)
  };
  var goToSlide = function(no, triggeredByUser) {
    if(no === getCurrentSlideNumber()) {
      return
    }
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && VISH.Status.isPreventDefaultMode() && VISH.Messenger) {
      var params = new Object;
      params.slideNumber = no;
      VISH.Messenger.notifyEventByMessage(VISH.Constant.Event.onGoToSlide, params);
      return
    }
    if(no > slideEls.length || no <= 0) {
      return
    }else {
      if(no > curSlideIndex + 1) {
        while(curSlideIndex + 1 < no) {
          _nextSlide()
        }
      }else {
        if(no < curSlideIndex + 1) {
          while(curSlideIndex + 1 > no) {
            _prevSlide()
          }
        }
      }
    }
    if(VISH.Editing) {
      $(".selectable").css("border-style", "none");
      VISH.Editor.Tools.cleanZoneTools();
      V.Editor.Thumbnails.selectThumbnail(no)
    }else {
      V.SlideManager.updateSlideCounter()
    }
    var params = new Object;
    params.slideNumber = no;
    VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onGoToSlide, params, triggeredByUser)
  };
  var backwardOneSlide = function() {
    goToSlide(curSlideIndex)
  };
  var forwardOneSlide = function() {
    goToSlide(curSlideIndex + 2)
  };
  var isSlideFocused = function() {
    if($(".wysiwygInstance").is(":focus")) {
      return false
    }
    return true
  };
  var showSlide = function(slide_id) {
    if(slideEls.length >= slide_id - 1) {
      $(slideEls[slide_id - 1]).show();
      triggerEnterEvent(slide_id - 1)
    }
  };
  var closeSlide = function(slide_id) {
    $("#" + slide_id).hide();
    var slideNumber = $.inArray($("#" + slide_id)[0], slideEls);
    triggerLeaveEvent(slideNumber)
  };
  var closeAllSlides = function() {
    $(".slides > article").hide()
  };
  var moveSlideTo = function(slide_to_move, reference_slide, movement) {
    if(typeof slide_to_move === "undefined" || typeof reference_slide === "undefined") {
      return
    }
    if(typeof slide_to_move.length !== undefined) {
      slide_to_move = $(slide_to_move)[0];
      if(typeof slide_to_move === "undefined") {
        return
      }
    }
    if(typeof reference_slide.length !== undefined) {
      reference_slide = $(reference_slide)[0];
      if(typeof reference_slide === "undefined") {
        return
      }
    }
    if(slide_to_move.tagName != "ARTICLE" || reference_slide.tagName != "ARTICLE" || slide_to_move == reference_slide) {
      return
    }
    var article_to_move = slide_to_move;
    var article_reference = reference_slide;
    var moving_current_slide = false;
    if(getCurrentSlide() === article_to_move) {
      moving_current_slide = true
    }
    $(article_to_move).remove();
    if(movement == "after") {
      $(article_reference).after(article_to_move)
    }else {
      if(movement == "before") {
        $(article_reference).before(article_to_move)
      }else {
        VISH.Debugging.log("VISH.Slides: Error. Movement not defined... !");
        return
      }
    }
    slideEls = document.querySelectorAll("section.slides > article");
    if(moving_current_slide) {
      curSlideIndex = getNumberOfSlide(article_to_move)
    }
    _updateSlideEls()
  };
  return{init:init, getCurrentSlide:getCurrentSlide, getCurrentSlideNumber:getCurrentSlideNumber, setCurrentSlideNumber:setCurrentSlideNumber, isCurrentFirstSlide:isCurrentFirstSlide, isCurrentLastSlide:isCurrentLastSlide, isSlideSelected:isSlideSelected, onDeleteSlide:onDeleteSlide, getNumberOfSlide:getNumberOfSlide, getSlides:getSlides, getSlideWithNumber:getSlideWithNumber, backwardOneSlide:backwardOneSlide, closeSlide:closeSlide, closeAllSlides:closeAllSlides, forwardOneSlide:forwardOneSlide, 
  goToSlide:goToSlide, lastSlide:lastSlide, isSlideFocused:isSlideFocused, moveSlideTo:moveSlideTo, showSlide:showSlide}
}(VISH, jQuery);
VISH.Events = function(V, $, undefined) {
  var bindedEventListeners = false;
  var PM_TOUCH_SENSITIVITY = 200;
  var MINIMUM_ZOOM_TO_ENABLE_SCROLL = 1.2;
  var registeredEvents = [];
  var init = function() {
    bindAllEventListeners();
    if(!V.Editing) {
      if(typeof V.Events.Mashme != "undefined") {
        window.addEventListener("message", V.Events.Mashme.onMashmeHello, false)
      }
    }
  };
  var _registerEvent = function(eventTargetId) {
    if(registeredEvents.indexOf(eventTargetId) == -1) {
      registeredEvents.push(eventTargetId)
    }
  };
  var _unregisterEvent = function(eventTargetId) {
    if(registeredEvents.indexOf(eventTargetId) != -1) {
      registeredEvents.splice(registeredEvents.indexOf(eventTargetId), 1)
    }
  };
  var handleBodyKeyDown = function(event) {
    switch(event.keyCode) {
      case 39:
      ;
      case 40:
        if(V.Slides.isSlideFocused()) {
          V.Slides.forwardOneSlide();
          event.preventDefault()
        }
        break;
      case 37:
      ;
      case 38:
        if(V.Slides.isSlideFocused()) {
          V.Slides.backwardOneSlide();
          event.preventDefault()
        }
        break
    }
  };
  var getTouches = function(event) {
    if(event.touches) {
      return event.touches
    }else {
      if(event.originalEvent.touches) {
        return event.originalEvent.touches
      }else {
        return null
      }
    }
  };
  var handleTouchStart = function(event) {
    if(V.SlideManager.getPresentationType() === "presentation") {
      var touches = getTouches(event);
      if(touches.length === 1) {
        touchDX = 0;
        touchDY = 0;
        touchStartX = touches[0].pageX;
        touchStartY = touches[0].pageY;
        document.body.addEventListener("touchmove", handleTouchMove, true);
        document.body.addEventListener("touchend", handleTouchEnd, true);
        var zoom = document.documentElement.clientWidth / window.innerWidth;
        var eventNotRegister = registeredEvents.indexOf(event.target.id) == -1;
        if(zoom < MINIMUM_ZOOM_TO_ENABLE_SCROLL && eventNotRegister) {
          event.preventDefault()
        }
      }
    }
  };
  var handleTouchMove = function(event) {
    if(V.SlideManager.getPresentationType() === "presentation") {
      var touches = getTouches(event);
      if(touches.length > 1) {
        cancelTouch()
      }else {
        touchDX = touches[0].pageX - touchStartX;
        touchDY = touches[0].pageY - touchStartY;
        var zoom = document.documentElement.clientWidth / window.innerWidth;
        if(zoom < MINIMUM_ZOOM_TO_ENABLE_SCROLL) {
          event.preventDefault()
        }
      }
    }
  };
  var handleTouchEnd = function(event) {
    if(V.SlideManager.getPresentationType() === "presentation") {
      var dx = Math.abs(touchDX);
      var dy = Math.abs(touchDY);
      if(dx > PM_TOUCH_SENSITIVITY && dy < dx * 2 / 3) {
        if(touchDX > 0) {
          V.Slides.backwardOneSlide()
        }else {
          V.Slides.forwardOneSlide()
        }
      }
      cancelTouch()
    }
  };
  var cancelTouch = function() {
    document.body.removeEventListener("touchmove", handleTouchMove, true);
    document.body.removeEventListener("touchend", handleTouchEnd, true)
  };
  var _onFlashcardPoiClicked = function(event) {
    V.Debugging.log("Show slide " + event.data.slide_id);
    V.Slides.showSlide(event.data.slide_id)
  };
  var _onFlashcardCloseSlideClicked = function(event) {
    var close_slide = event.target.id.substring(5);
    V.Debugging.log("Close slide " + close_slide);
    V.Slides.closeSlide(close_slide)
  };
  var bindAllEventListeners = function() {
    if(!bindedEventListeners) {
      if(V.SlideManager.getPresentationType() === "presentation") {
        $(document).bind("keydown", handleBodyKeyDown);
        $(document).on("click", "#page-switcher-start", isActiveQuizSession);
        $(document).on("click", "#page-switcher-end", isActiveQuizSession);
        _registerEvent("mobile_back_arrow");
        $(document).on("click", "#mobile_back_arrow", V.Slides.backwardOneSlide);
        _registerEvent("mobile_forward_arrow");
        $(document).on("click", "#mobile_forward_arrow", V.Slides.forwardOneSlide);
        _registerEvent("closeButton");
        _registerEvent("closeButtonImg");
        $(document).on("click", "#closeButton", function() {
          window.top.location.href = V.SlideManager.getOptions()["comeBackUrl"]
        });
        $(document).bind("touchstart", handleTouchStart)
      }else {
        if(V.SlideManager.getPresentationType() === "flashcard") {
          var presentation = V.SlideManager.getCurrentPresentation();
          for(index in presentation.background.pois) {
            var poi = presentation.background.pois[index];
            $(document).on("click", "#" + poi.id, {slide_id:poi.slide_id}, _onFlashcardPoiClicked)
          }
          $(document).on("click", ".close_slide", _onFlashcardCloseSlideClicked)
        }
      }
    }
    bindedEventListeners = true
  };
  var unbindAllEventListeners = function() {
    if(bindedEventListeners) {
      if(V.SlideManager.getPresentationType() === "presentation") {
        $(document).unbind("keydown", handleBodyKeyDown);
        $(document).off("click", "#page-switcher-start", isActiveQuizSession);
        $(document).off("click", "#page-switcher-end", isActiveQuizSession);
        $(document).off("click", "#page-switcher-start", V.Slides.backwardOneSlide);
        $(document).off("click", "#page-switcher-end", V.Slides.forwardOneSlide);
        _unregisterEvent("mobile_back_arrow");
        $(document).off("click", "#mobile_back_arrow", V.Slides.backwardOneSlide);
        _unregisterEvent("mobile_forward_arrow");
        $(document).off("click", "#mobile_forward_arrow", V.Slides.forwardOneSlide);
        _unregisterEvent("closeButton");
        _unregisterEvent("closeButtonImg");
        $(document).off("click", "#closeButton");
        $(document).unbind("touchstart", handleTouchStart)
      }else {
        if(V.SlideManager.getPresentationType() === "flashcard") {
          var presentation = V.SlideManager.getCurrentPresentation();
          for(index in presentation.background.pois) {
            var poi = presentation.background.pois[index];
            $(document).off("click", "#" + poi.id, {slide_id:poi.slide_id}, _onFlashcardPoiClicked)
          }
          $(document).off("click", ".close_slide", _onFlashcardCloseSlideClicked)
        }
      }
      bindedEventListeners = false
    }
  };
  var isActiveQuizSession = function(event) {
    V.Debugging.log("event id : " + event.srcElement.id);
    if(event.srcElement.id == "page-switcher-end") {
      if(V.Quiz.getIsQuizSessionStarted()) {
        VISH.Quiz.setIsWaitingForwardOneSlide(true);
        VISH.Quiz.onStopMcQuizButtonClicked()
      }else {
        V.Slides.forwardOneSlide()
      }
    }else {
      if(event.srcElement.id == "page-switcher-start") {
        if(V.Quiz.getIsQuizSessionStarted()) {
          VISH.Quiz.setIsWaitingBackwardOneSlide(true);
          VISH.Quiz.onStopMcQuizButtonClicked()
        }else {
          V.Slides.backwardOneSlide()
        }
      }
    }
  };
  return{init:init, bindAllEventListeners:bindAllEventListeners, unbindAllEventListeners:unbindAllEventListeners}
}(VISH, jQuery);
VISH.Flashcard = function(V, $, undefined) {
  var init = function(presentation) {
    var fileref = document.createElement("link");
    fileref.setAttribute("rel", "stylesheet");
    fileref.setAttribute("type", "text/css");
    fileref.setAttribute("href", VISH.StylesheetsPath + "flashcard/flashcard.css");
    document.getElementsByTagName("body")[0].appendChild(fileref);
    var flashcard_div = $("#flashcard-background");
    flashcard_div.css("background-image", presentation.background.src);
    for(index in presentation.background.pois) {
      var poi = presentation.background.pois[index];
      V.Flashcard.Arrow.addArrow(poi, false)
    }
    V.Flashcard.Arrow.init()
  };
  return{init:init}
}(VISH, jQuery);
VISH.Quiz = function(V, $, undefined) {
  var quizMode;
  var quizSessionStarted = false;
  var mcOptionsHash = new Array;
  mcOptionsHash["a"] = 0;
  mcOptionsHash["b"] = 1;
  mcOptionsHash["c"] = 2;
  mcOptionsHash["d"] = 3;
  mcOptionsHash["e"] = 4;
  mcOptionsHash["f"] = 5;
  var startButtonClass = "quiz_session_start_button";
  var optionsButtonClass = "quiz_session_options_button";
  var stopSessionButtonClass = "quiz_session_stop_button";
  var statisticsButtonClass = "mch_statistics_icon";
  var tabQuizSessionContent = "tab_quiz_session_content";
  var tabQuizStatsBarsContentId = "quiz_stats_bars_content_id";
  var tabQuizStatsPieContentId = "quiz_stats_pie_content_id";
  var getResultsPeriod = 3E3;
  var getResultsTimeOut;
  var isWaitingBackwardOneSlide = false;
  var isWaitingForwardOneSlide = false;
  var init = function(presentation) {
    if(presentation.type == "quiz_simple") {
      quizMode = "answer";
      _loadAnswerEvents()
    }else {
      quizMode = "question";
      _loadEvents()
    }
    VISH.Quiz.Renderer.init();
    VISH.Quiz.API.init();
    $("a#addQuizSessionFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":"80%", "height":"80%", "padding":0, "onStart":function(data) {
      VISH.Utils.loadTab("tab_quiz_session")
    }})
  };
  var getQuizMode = function() {
    return quizMode
  };
  var prepareQuiz = function() {
    if(quizMode == "answer") {
      $("." + startButtonClass).show();
      $("." + startButtonClass).val("Send")
    }else {
      if(quizMode == "question") {
        if(!VISH.User.isLogged()) {
          $("." + startButtonClass).hide()
        }else {
          $("." + startButtonClass).show()
        }
      }
    }
  };
  var showQuizStats = function() {
    $("a#addQuizSessionFancybox").trigger("click")
  };
  var _loadEvents = function() {
    $(document).on("click", "." + startButtonClass, startMcQuizButtonClicked);
    $(document).on("click", "." + stopSessionButtonClass, onStopMcQuizButtonClicked);
    $(document).on("click", "." + optionsButtonClass, showQuizStats);
    $(document).on("click", "#mask_stop_quiz", _hideStopQuizPopup);
    $(document).on("click", ".quiz_stop_session_cancel", _hideStopQuizPopup);
    $(document).on("click", ".quiz_stop_session_save", _stopAndSaveQuiz);
    $(document).on("click", ".quiz_stop_session_dont_save", _stopAndDontSaveQuiz);
    $(document).on("click", "#quiz_full_screen", VISH.SlideManager.toggleFullScreen);
    $(document).on("click", ".hide_qrcode", _hideQRCode);
    $(document).on("click", ".show_qrcode", _showQRCode)
  };
  var startMcQuizButtonClicked = function() {
    if(V.User.isLogged()) {
      V.Debugging.log("User logged");
      var quizId = $(VISH.Slides.getCurrentSlide()).find(".quizId").val();
      $("a#addQuizSessionFancybox").trigger("click");
      V.Quiz.API.postStartQuizSession(quizId, _onQuizSessionReceived, _OnQuizSessionReceivedError);
      _startStats();
      _updateBarsStats()
    }else {
      V.Debugging.log("User not logged")
    }
  };
  var _startStats = function() {
    if($("#" + tabQuizStatsBarsContentId).find(".quiz_question_container").contents()) {
      $("#" + tabQuizStatsBarsContentId).find(".quiz_question_container").children().remove()
    }
    if($("#" + tabQuizStatsBarsContentId).find(".quiz_options_container").contents()) {
      $("#" + tabQuizStatsBarsContentId).find(".quiz_options_container").children().remove()
    }
    if($("#" + tabQuizStatsPieContentId).find(".quiz_question_container").children()) {
      $("#" + tabQuizStatsPieContentId).find(".quiz_question_container").children().remove()
    }
    $("#" + tabQuizStatsBarsContentId).find(".quiz_question_container").append($(VISH.Slides.getCurrentSlide()).find("div.mcquestion_body").clone().find(".question"));
    $("#" + tabQuizStatsPieContentId).find(".quiz_question_container").append($(VISH.Slides.getCurrentSlide()).find("div.mcquestion_body").clone().find(".question"));
    $("#" + tabQuizStatsBarsContentId).find(".quiz_options_container").append($(VISH.Slides.getCurrentSlide()).find("div.mcquestion_body").clone().find(".mcquestion_form"));
    $("#" + tabQuizStatsBarsContentId).find("div.mcquestion_body").addClass("quiz_in_satistics");
    $("#tab_quiz_stats_bars_content").addClass("resized_fancybox_for_stats");
    $("#tab_quiz_stats_pie_content").addClass("resized_fancybox_for_stats");
    $("#tab_quiz_session_content").addClass("resized_fancybox_for_stats")
  };
  var _updateBarsStats = function(data) {
    if(data) {
      V.Debugging.log("_updateBarsStats with  data: " + JSON.stringify(data))
    }else {
      V.Debugging.log("_updateBarsStats with no data params");
      $("#" + tabQuizStatsBarsContentId).find(".mc_meter").css("display", "block");
      $("#" + tabQuizStatsBarsContentId).find(".mcoption_label").css("display", "block");
      $("#" + tabQuizStatsBarsContentId).find(".mcoption_label").text("0%");
      $("#" + tabQuizStatsBarsContentId).find(".mc_meter > span").css("width", "0%");
      _getResults();
      getResultsTimeOut = setInterval(_getResults, getResultsPeriod)
    }
  };
  var _getResults = function(quiz_session_active_id) {
    if(quiz_session_active_id) {
      var quizSessionActiveId = quiz_session_active_id
    }else {
      var quizSessionActiveId = $("#" + tabQuizSessionContent).find("input.quiz_session_id").val()
    }
    V.Quiz.API.getQuizSessionResults(quizSessionActiveId, _showResults, _onQuizSessionResultsReceivedError)
  };
  var _onQuizSessionReceived = function(quiz_session_id) {
    V.Debugging.log("_onQuizSessionReceived with  quiz_session_id: " + quiz_session_id);
    var quizUrlForSession = "http://" + window.location.host.toString() + "/quiz_sessions/";
    var url = quizUrlForSession + quiz_session_id;
    var current_slide = V.Slides.getCurrentSlide();
    var header = $("#" + tabQuizSessionContent).find(".quiz_session_header");
    var divURLShare = "<div class='url_share'><span><a target='blank_' href=" + url + ">" + url + "</a></span></div>";
    $(header).html(divURLShare);
    $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container").children().remove();
    $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container").qrcode(url.toString());
    $(current_slide).find("input." + startButtonClass).hide();
    $(current_slide).find("input." + optionsButtonClass).show();
    quizSessionStarted = true;
    $("#" + tabQuizSessionContent).find("input.quiz_session_id").attr("value", quiz_session_id);
    $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container").append(" <img class='qr_background' src='/vishEditor/images/VISH_frontpage.png' />")
  };
  var _OnQuizSessionReceivedError = function(error) {
    var received = JSON.stringify(error);
    V.Debugging.log("_OnQuizSessionReceivedError:  " + received)
  };
  var onStopMcQuizButtonClicked = function() {
    V.Debugging.log("onStopMcQuizButtonClicked");
    var id = $("a[name=modal_fancybox]").attr("href");
    var maskHeight = $(document).height();
    var maskWidth = $(window).width();
    $("#mask_stop_quiz").css({"width":maskWidth, "height":maskHeight});
    $("#mask_stop_quiz").fadeTo("slow", 0.6);
    $(id).css("top", maskHeight / 2 - $(id).height() / 2);
    $(id).css("left", maskWidth / 2 - $(id).width() / 2);
    $(id).show();
    $(id).children().show();
    var date = new Date;
    var date_string = date.getFullYear().toString() + (date.getMonth() + 1).toString() + date.getDate().toString() + "_" + date.getHours().toString() + date.getMinutes().toString();
    $(id).find(".quiz_saved_session_name").val(date_string);
    $(id).fadeIn(2E3)
  };
  var _stopAndSaveQuiz = function() {
    var current_slide = VISH.Slides.getCurrentSlide();
    quizName = $("#stop_quiz_fancybox").find(".quiz_saved_session_name").val();
    var header = $("#" + tabQuizSessionContent).find(".quiz_session_header");
    var quizSessionActiveId = $("#" + tabQuizSessionContent).find("input.quiz_session_id").attr("value");
    if(!quizName) {
      quizName = "Unknown"
    }
    _hideStopQuizPopup();
    $.fancybox.close();
    $(current_slide).find("input." + optionsButtonClass).hide();
    $(current_slide).find("input." + startButtonClass).show();
    V.Quiz.API.deleteQuizSession(quizSessionActiveId, _onQuizSessionCloseReceived, _onQuizSessionCloseReceivedError, quizName);
    clearInterval(getResultsTimeOut);
    quizSessionStarted = false;
    if(isWaitingForwardOneSlide) {
      V.Slides.forwardOneSlide()
    }else {
      if(isWaitingBackwardOneSlide) {
        V.Slides.backwardOneSlide()
      }
    }
  };
  var _onQuizSessionCloseReceived = function(results) {
    V.Debugging.log("_onQuizSessionCloseReceived");
    var quizSessionActiveId = $("#" + tabQuizSessionContent).find("input.quiz_session_id").attr("value")
  };
  var _onQuizSessionCloseReceivedError = function(error) {
    var received = JSON.stringify(error);
    V.Debugging.log("_onQuizSessionCloseReceivedError, and value received is:  " + received)
  };
  var _stopAndDontSaveQuiz = function() {
    V.Debugging.log("_stopAndDontSaveQuiz detected");
    var current_slide = VISH.Slides.getCurrentSlide();
    var quizSessionActiveId = $("#" + tabQuizSessionContent).find("input.quiz_session_id").attr("value");
    _hideStopQuizPopup();
    $.fancybox.close();
    quizName = false;
    $(current_slide).find("input." + optionsButtonClass).hide();
    $(current_slide).find("input." + startButtonClass).show();
    V.Quiz.API.deleteQuizSession(quizSessionActiveId, _onQuizSessionCloseReceived, _onQuizSessionCloseReceivedError, quizName);
    clearInterval(getResultsTimeOut);
    quizSessionStarted = false;
    if(isWaitingForwardOneSlide) {
      V.Slides.forwardOneSlide()
    }else {
      if(isWaitingBackwardOneSlide) {
        V.Slides.backwardOneSlide()
      }
    }
  };
  var _loadAnswerEvents = function() {
    $(document).on("click", "." + startButtonClass, _sendVote)
  };
  var _sendVote = function(event) {
    var answer = $(VISH.Slides.getCurrentSlide()).find("input:radio[name='mc_radio']:checked'").val();
    if(typeof answer !== "undefined") {
      var quizSessionActiveId = VISH.SlideManager.getOptions()["quiz_active_session_id"];
      V.Quiz.API.putQuizSession(answer, quizSessionActiveId, _onQuizVotingSuccessReceived, _OnQuizVotingReceivedError);
      $("." + startButtonClass).hide()
    }
  };
  var _onQuizVotingSuccessReceived = function(data) {
    var quizSessionActiveId = VISH.SlideManager.getOptions()["quiz_active_session_id"];
    V.Debugging.log("_onQuizVotingSuccessReceived, and quizSessionActiveId is:  " + quizSessionActiveId);
    V.Quiz.API.getQuizSessionResults(quizSessionActiveId, _onQuizSessionResultsReceived, _onQuizSessionResultsReceivedError)
  };
  var _OnQuizVotingReceivedError = function(error) {
    var received = JSON.stringify(error);
    V.Debugging.log("_OnQuizVotingReceivedError, and value received is:  " + received)
  };
  var _onQuizSessionResultsReceived = function(data) {
    _displayResults(data.results)
  };
  var _onQuizSessionResultsReceivedError = function(error) {
    var received = JSON.stringify(error);
    V.Debugging.log("_onQuizSessionResultsReceivedError, and value received is:  " + received)
  };
  var _displayResults = function(data) {
    var url = "http://chart.apis.google.com/chart?cht=p3&chs=300x200&chd=t:";
    var lenght_array = 0;
    $.each(data, function(clave, valor) {
      lenght_array += 1
    });
    var counter = 0;
    $.each(data, function(clave, valor) {
      url += valor;
      counter++;
      if(counter == lenght_array) {
        url += "&chl="
      }else {
        url += ","
      }
    });
    var counter = 0;
    $.each(data, function(clave, valor) {
      url += clave;
      counter++;
      if(counter == lenght_array) {
        url += "&chtt=testedVish"
      }else {
        url += "|"
      }
    });
    V.Debugging.log("chart url :  " + url);
    $(".quiz_statistics_content").find(".img_chart").attr("src", url)
  };
  var _showResults = function(data) {
    var received = JSON.stringify(data);
    V.Debugging.log("_displayResults, and value received is:  " + received);
    var maxWidth = 70;
    var totalVotes = 0;
    for(option in data.results) {
      if(option in mcOptionsHash) {
        var votes = data.results[option];
        totalVotes += votes
      }
    }
    if(totalVotes > 0) {
      for(option in data.results) {
        if(option in mcOptionsHash) {
          var index = mcOptionsHash[option];
          var votes = data.results[option];
          var percent = votes / totalVotes * 100;
          var percentString = percent.toString() + "%";
          var roundedNumber = Math.round(percent * Math.pow(10, 2)) / Math.pow(10, 2);
          if(typeof $("#" + tabQuizStatsBarsContentId).find(".mc_meter")[index] != "undefined") {
            $("#" + tabQuizStatsBarsContentId).find(".mc_meter > span")[index].style.width = percentString;
            $($("#" + tabQuizStatsBarsContentId).find(".mcoption_label")[index]).text(roundedNumber + "%");
            $($("#" + tabQuizStatsBarsContentId).find(".mc_meter > span")[index]).addClass("mcoption_" + option)
          }
        }
      }
    }
    google.load("visualization", "1.0", {"packages":["corechart"]}, {"callback":VISH.Quiz.drawPieChart(data.results)})
  };
  var drawPieChart = function(data) {
    V.Debugging.log("drawPieChart called");
    var data_for_chart = new google.visualization.DataTable;
    data_for_chart.addColumn("string", "Question");
    data_for_chart.addColumn("number", "Slices");
    for(option in data) {
      if(option in mcOptionsHash) {
        var votes = data[option];
        data_for_chart.addRow([option, votes])
      }
    }
    var question = $(VISH.Slides.getCurrentSlide()).find(".question").text();
    var options = {"title":"", "width":400, "height":300};
    var chart = new google.visualization.PieChart(document.getElementById("quiz_chart_container_id"));
    chart.draw(data_for_chart, options)
  };
  var _hideStopQuizPopup = function() {
    $("#mask_stop_quiz").fadeTo("slow", 0);
    $("#mask_stop_quiz").hide();
    $("#stop_quiz_fancybox").hide()
  };
  var _hideQRCode = function() {
    if($("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > canvas")) {
      $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > canvas").hide();
      $("#" + tabQuizSessionContent).find(".hide_qrcode").hide();
      $("#" + tabQuizSessionContent).find(".show_qrcode").show();
      if($("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > img").attr("src")) {
        $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > img").show()
      }else {
        $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container").append(" <img class='qr_background' src='/vishEditor/images/VISH_frontpage.png' />")
      }
    }
  };
  var _showQRCode = function() {
    if($("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > img")) {
      $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > img").hide();
      $("#" + tabQuizSessionContent).find(".quiz_session_qrcode_container > canvas").show();
      $("#" + tabQuizSessionContent).find(".show_qrcode").hide();
      $("#" + tabQuizSessionContent).find(".hide_qrcode").show()
    }
  };
  var getIsQuizSessionStarted = function() {
    return quizSessionStarted
  };
  var setIsWaitingForwardOneSlide = function(val) {
    isWaitingForwardOneSlide = val
  };
  var setIsWaitingBackwardOneSlide = function(val) {
    isWaitingBackwardOneSlide = val
  };
  return{init:init, prepareQuiz:prepareQuiz, getQuizMode:getQuizMode, startMcQuizButtonClicked:startMcQuizButtonClicked, drawPieChart:drawPieChart, getIsQuizSessionStarted:getIsQuizSessionStarted, onStopMcQuizButtonClicked:onStopMcQuizButtonClicked, setIsWaitingForwardOneSlide:setIsWaitingForwardOneSlide, setIsWaitingBackwardOneSlide:setIsWaitingBackwardOneSlide}
}(VISH, jQuery);
VISH.Editor.Tools = function(V, $, undefined) {
  var toolbarEventsLoaded = false;
  var init = function() {
    cleanZoneTools();
    cleanToolbar();
    if(!toolbarEventsLoaded) {
      $.each($("img.toolbar_icon"), function(index, toolbarButton) {
        $(toolbarButton).on("click", function(event) {
          if(typeof VISH.Editor.Tools[$(toolbarButton).attr("action")] == "function") {
            VISH.Editor.Tools[$(toolbarButton).attr("action")](this)
          }
        })
      });
      $(document).on("keydown", ".tools_input_addUrl", _addUrlOnKeyDown);
      toolbarEventsLoaded = true
    }
    loadPresentationToolbar();
    VISH.Editor.Tools.Menu.init()
  };
  var loadToolsForZone = function(zone) {
    cleanZoneTools();
    var type = $(zone).attr("type");
    switch(type) {
      case "text":
        loadToolbarForElement(type);
        break;
      case "image":
        _showSlider($(zone).find("img").attr("id"));
        loadToolbarForElement(type);
        break;
      case "video":
        _showSlider($(zone).find("video").attr("id"));
        loadToolbarForElement(type);
        break;
      case "object":
        _showSlider($(zone).find(".object_wrapper").attr("id"));
        var object = $(zone).find(".object_wrapper").children()[0];
        loadToolbarForObject(object);
        break;
      case "snapshot":
        _showSlider($(zone).find(".snapshot_wrapper").attr("id"));
        loadToolbarForElement("snapshot");
        break;
      case "quiz":
        loadToolbarForElement("quiz");
        break;
      case undefined:
        $(zone).find(".menuselect_hide").show();
        return;
      default:
        break
    }
    $(zone).find(".delete_content").show()
  };
  var cleanZoneTools = function(zone) {
    $(".menuselect_hide").hide();
    $(".delete_content").hide();
    $(".theslider").hide();
    _cleanElementToolbar()
  };
  var cleanToolbar = function() {
    _cleanPresentationToolbar();
    _cleanElementToolbar()
  };
  var enableToolbar = function() {
    $("#toolbar_wrapper").show()
  };
  var disableToolbar = function() {
    $("#toolbar_wrapper").hide()
  };
  var loadPresentationToolbar = function() {
    var presentationType = VISH.Editor.getPresentationType();
    switch(presentationType) {
      case "presentation":
        $("#hidden_button_to_launch_theme_fancybox").fancybox({"autoDimensions":false, "width":600, "scrolling":"no", "height":400, "padding":0});
        $("#toolbar_presentation").find("img.toolbar_presentation").show();
        break;
      case "flashcard":
        $("#hidden_button_to_launch_picture_fancybox_for_flashcard").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
          V.Editor.Image.setAddContentMode(VISH.Constant.FLASHCARD);
          V.Utils.loadTab("tab_pic_from_url")
        }});
        $("#toolbar_presentation").find("img.toolbar_flashcard").show();
        break;
      case "game":
        $("#toolbar_presentation").find("img.toolbar_game").show();
        break;
      case "quiz_simple":
        disableToolbar();
        $("#menubarCarrousel").hide();
        break;
      default:
        disableToolbar();
        break
    }
  };
  var _cleanPresentationToolbar = function() {
    $("#toolbar_presentation").find("img").hide()
  };
  var loadToolbarForElement = function(type) {
    _cleanElementToolbar();
    if(type == "text" || type == "quiz") {
      _loadNiceEditorToolbar();
      return
    }
    var toolbarClass = "toolbar_" + type;
    $("#toolbar_element").find("img").hide();
    $("#toolbar_element").find("img." + toolbarClass).show()
  };
  var _loadNiceEditorToolbar = function() {
    $("#toolbar_element").find("img").hide();
    $(".nicEdit-panel").show()
  };
  var loadToolbarForObject = function(object) {
    var objectInfo = VISH.Object.getObjectInfo(object);
    switch(objectInfo.type) {
      case "web":
        loadToolbarForElement(objectInfo.type);
        break;
      default:
        loadToolbarForElement("object");
        break
    }
  };
  var _cleanElementToolbar = function() {
    $(".nicEdit-panel").hide();
    $("#toolbar_element").find("img").hide()
  };
  var _showSlider = function(id) {
    if(id) {
      id = id.substring(9);
      $("#sliderId" + id).show()
    }
  };
  var selectTheme = function() {
    $("#hidden_button_to_launch_theme_fancybox").trigger("click")
  };
  var changeFlashcardBackground = function() {
    $("#hidden_button_to_launch_picture_fancybox_for_flashcard").trigger("click")
  };
  var zoomMore = function() {
    _changeZoom("+")
  };
  var zoomLess = function() {
    _changeZoom("-")
  };
  var _changeZoom = function(action) {
    var area = VISH.Editor.getCurrentArea();
    var type = $(area).attr("type");
    switch(type) {
      case "object":
        var object = area.children()[0].children[0];
        var objectInfo = VISH.Object.getObjectInfo(object);
        if(objectInfo.type === "web") {
          var iframe = $(area).find("iframe");
          var zoom = VISH.Utils.getZoomFromStyle($(iframe).attr("style"));
          if(action == "+") {
            zoom = zoom + 0.1
          }else {
            zoom = zoom - 0.1
          }
          $(iframe).attr("style", VISH.Editor.Utils.addZoomToStyle($(iframe).attr("style"), zoom));
          VISH.Editor.Object.autofixWrapperedObjectAfterZoom(iframe, zoom)
        }
        break;
      case "snapshot":
        break;
      default:
        break
    }
  };
  var addLink = function() {
    $.fancybox($("#tools_addUrl").html(), {"autoDimensions":false, "scrolling":"no", "width":800, "height":215, "showCloseButton":true, "padding":0, "onStart":function() {
    }, "onComplete":function() {
      var area = VISH.Editor.getCurrentArea();
      var hyperlink = $(area).attr("hyperlink");
      if(hyperlink) {
        $(".tools_input_addUrl").val(hyperlink)
      }
    }, "onClosed":function() {
    }})
  };
  var _addUrlOnKeyDown = function(event) {
    switch(event.keyCode) {
      case 13:
        addUrl();
        break;
      default:
        break
    }
  };
  var addUrl = function() {
    var url;
    $(".tools_input_addUrl").each(function(index, input) {
      if($($(input).parent().parent()).attr("id") !== "tools_addUrl") {
        url = $(input).val()
      }
    });
    if(url) {
      url = VISH.Utils.autocompleteUrls(url);
      var area = VISH.Editor.getCurrentArea();
      switch($(area).attr("type")) {
        case "image":
          $(area).attr("hyperlink", url);
          break;
        default:
          break
      }
    }
    $.fancybox.close()
  };
  return{init:init, loadPresentationToolbar:loadPresentationToolbar, loadToolsForZone:loadToolsForZone, loadToolbarForObject:loadToolbarForObject, loadToolbarForElement:loadToolbarForElement, cleanZoneTools:cleanZoneTools, cleanToolbar:cleanToolbar, enableToolbar:enableToolbar, disableToolbar:disableToolbar, selectTheme:selectTheme, changeFlashcardBackground:changeFlashcardBackground, addLink:addLink, addUrl:addUrl, zoomMore:zoomMore, zoomLess:zoomLess}
}(VISH, jQuery);
VISH.Addons = function(V, undefined) {
  var init = function(addons) {
    if(typeof addons === "object") {
      for(var i = 0;i < addons.length;i++) {
        var targeted = VISH.Editing && addons[i].target === VISH.Constant.Edit || !VISH.Editing && addons[i].target === VISH.Constant.Viewer || addons[i].target === VISH.Constant.AnyMode;
        if(targeted) {
          if(typeof VISH.Addons[addons[i].id] !== "undefined" && typeof VISH.Addons[addons[i].id].init === "function") {
            VISH.Addons[addons[i].id].init(addons[i].config)
          }
        }
      }
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.VideoPlayer = function() {
  var init = function() {
    VISH.VideoPlayer.CustomPlayer.init();
    VISH.VideoPlayer.HTML5.init();
    VISH.VideoPlayer.Youtube.init()
  };
  var getTypeVideoWithId = function(videoId) {
    return getTypeVideo(document.getElementById(videoId))
  };
  var getTypeVideo = function(video) {
    if(!video) {
      return VISH.Constant.UNKNOWN
    }else {
      if(video.tagName === "VIDEO") {
        return VISH.Constant.Video.HTML5
      }else {
        if(video.tagName === "OBJECT") {
          return VISH.Constant.Video.Youtube
        }
      }
    }
    return VISH.Constant.UNKNOWN
  };
  var playVideo = function(videoId, currentTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case VISH.Constant.Video.HTML5:
        VISH.VideoPlayer.HTML5.playVideo(videoId, currentTime, triggeredByUser);
        break;
      case VISH.Constant.Video.Youtube:
        VISH.VideoPlayer.Youtube.playVideo(videoId, currentTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var pauseVideo = function(videoId, currentTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case VISH.Constant.Video.HTML5:
        VISH.VideoPlayer.HTML5.pauseVideo(videoId, currentTime, triggeredByUser);
        break;
      case VISH.Constant.Video.Youtube:
        VISH.VideoPlayer.Youtube.pauseVideo(videoId, currentTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var seekVideo = function(videoId, seekTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case VISH.Constant.Video.HTML5:
        VISH.VideoPlayer.HTML5.seekVideo(videoId, seekTime, triggeredByUser);
        break;
      case VISH.Constant.Video.Youtube:
        VISH.VideoPlayer.Youtube.seekVideo(videoId, seekTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var getDuration = function(video) {
    switch(getTypeVideo(video)) {
      case VISH.Constant.Video.HTML5:
        return video.getDuration();
        break;
      case VISH.Constant.Video.Youtube:
        return video.getDuration();
        break;
      default:
        break
    }
  };
  var getCurrentTime = function(video) {
    switch(getTypeVideo(video)) {
      case VISH.Constant.Video.HTML5:
        return video.getCurrentTime();
        break;
      case VISH.Constant.Video.Youtube:
        return video.getCurrentTime();
        break;
      default:
        break
    }
  };
  return{init:init, getTypeVideoWithId:getTypeVideoWithId, getTypeVideo:getTypeVideo, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, getDuration:getDuration, getCurrentTime:getCurrentTime}
}(VISH, jQuery);
VISH.Messenger = function(V, undefined) {
  var init = function() {
    VISH.Events.Notifier.registerCallback(VISH.Constant.Event.onGoToSlide, function(params) {
      notifyEventByMessage(VISH.Constant.Event.onGoToSlide, params)
    });
    VISH.Events.Notifier.registerCallback(VISH.Constant.Event.onPlayVideo, function(params) {
      notifyEventByMessage(VISH.Constant.Event.onPlayVideo, params)
    });
    VISH.Events.Notifier.registerCallback(VISH.Constant.Event.onPauseVideo, function(params) {
      notifyEventByMessage(VISH.Constant.Event.onPauseVideo, params)
    });
    VISH.Events.Notifier.registerCallback(VISH.Constant.Event.onSeekVideo, function(params) {
      notifyEventByMessage(VISH.Constant.Event.onSeekVideo, params)
    })
  };
  var notifyEventByMessage = function(event, params) {
    if(params.triggeredByUser === false) {
      return
    }
    var VEMessage = VISH.Messenger.Helper.createMessage(event, params);
    VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onMessage, VEMessage, true)
  };
  return{init:init, notifyEventByMessage:notifyEventByMessage}
}(VISH);
VISH.Addons.IframeMessenger = function(V, undefined) {
  var listenerInitialized = false;
  var init = function(config) {
    if(!config || !config.enable) {
      return
    }
    if(window.addEventListener) {
      window.addEventListener("message", _onWebAppMessage, false)
    }else {
      if(el.attachEvent) {
        window.attachEvent("message", _onWebAppMessage)
      }
    }
    VISH.Constant.Event.onIframeMessengerHello = "onIframeMessengerHello"
  };
  var _initListener = function() {
    VISH.Events.Notifier.registerCallback(VISH.Constant.Event.onMessage, _onVishEditorMessage);
    listenerInitialized = true
  };
  var _onVishEditorMessage = function(VEMessage) {
    _sendMessage(VEMessage)
  };
  var _onWebAppMessage = function(webAppMessage) {
    if(webAppMessage) {
      var VEMessage = webAppMessage.data;
      var processSelfMessages = VISH.Status.isPreventDefaultMode();
      if(VISH.Messenger.Helper.validateVEMessage(VEMessage, {allowSelfMessages:processSelfMessages})) {
        if(_isVEHelloMessage(VEMessage)) {
          if(!listenerInitialized) {
            _initListener();
            if(VISH.Status.getIsInIframe()) {
              var helloEcho = JSON.parse(VEMessage);
              helloEcho.origin = VISH.Status.getIframe().id;
              VEMessage = JSON.stringify(helloEcho)
            }
            _sendMessage(VEMessage)
          }
        }else {
          VISH.Messenger.Helper.processVEMessage(VEMessage)
        }
      }
    }
  };
  var _isVEHelloMessage = function(VEMessage) {
    var message = JSON.parse(VEMessage);
    return message.VEevent === VISH.Constant.Event.onIframeMessengerHello
  };
  var _validateWebAppMessage = function(webAppMessage) {
    if(!webAppMessage) {
      return false
    }
    return VISH.Messenger.Helper.validateVEMessage(webAppMessage.data)
  };
  var _sendMessage = function(VEMessage) {
    window.parent.postMessage(VEMessage, "*")
  };
  return{init:init}
}(VISH, jQuery);
VISH.AppletPlayer = function() {
  var loadApplet = function(element) {
    $.each(element.children(".appletelement"), function(index, value) {
      var toAppend = "<applet code='" + $(value).attr("code") + "' width='" + $(value).attr("width") + "' height='" + $(value).attr("height") + "' archive='" + $(value).attr("archive") + "'>" + $(value).attr("params") + "</applet>";
      $(value).html(toAppend)
    })
  };
  var unloadApplet = function(element) {
    $(".appletelement applet").remove()
  };
  return{loadApplet:loadApplet, unloadApplet:unloadApplet}
}(VISH, jQuery);
VISH.Configuration = function(V, $, undefined) {
  var configuration;
  var init = function(myConfiguration) {
    configuration = myConfiguration;
    _initPaths()
  };
  var _initPaths = function() {
    VISH.ImagesPath = configuration["ImagesPath"];
    VISH.StylesheetsPath = configuration["StylesheetsPath"];
    VISH.UploadImagePath = configuration["uploadImagePath"];
    VISH.UploadObjectPath = configuration["uploadObjectPath"];
    VISH.UploadPresentationPath = configuration["uploadPresentationPath"]
  };
  var applyConfiguration = function() {
    if(configuration["presentationSettings"]) {
      if(!configuration["presentationTags"]) {
        $(".tagBoxUpload").css("display", "none");
        $(".tagBoxIntro").css("display", "none")
      }
      if(!configuration["presentationThumbnails"]) {
        $("#thumbnails_in_excursion_details").css("display", "none")
      }
    }
    if(!configuration["VishLives"]) {
      $(".addLive").css("display", "none")
    }
    if(!configuration["VishRepo"]) {
      $("#tab_pic_repo").css("display", "none");
      $("#tab_object_repo").css("display", "none");
      $("#tab_video_repo").css("display", "none")
    }
    if(!configuration["Upload"]) {
      $("#tab_pic_upload").css("display", "none");
      $("#tab_object_upload").css("display", "none")
    }
    if(!configuration["Youtube"]) {
      $("#tab_video_youtube").css("display", "none")
    }
    if(!configuration["Vimeo"]) {
      $("#tab_video_vimeo").css("display", "none")
    }
    if(!configuration["Flickr"]) {
      $("#tab_pic_flikr").css("display", "none")
    }
  };
  var getConfiguration = function() {
    return configuration
  };
  return{init:init, applyConfiguration:applyConfiguration, getConfiguration:getConfiguration}
}(VISH, jQuery);
VISH.Debugging = function(V, $, undefined) {
  var developping = false;
  var settings;
  var presentationOptions;
  var init = function(options) {
    if(options) {
      if(typeof options["developping"] == "boolean") {
        developping = options["developping"];
        if(developping) {
          presentationOptions = options;
          if(options["developmentSettings"]) {
            settings = options["developmentSettings"]
          }
        }
      }else {
        developping = false;
        settings = null
      }
    }else {
      developping = false;
      settings = null
    }
  };
  var log = function(text) {
    if(window.console && window.console.log && developping) {
      console.log(text)
    }
  };
  var shuffleJson = function(json) {
    return _shuffle(json)
  };
  var _shuffle = function(o) {
    for(var j, x, i = o.length;i;j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x) {
    }
    return o
  };
  var enableDevelopingMode = function() {
    developping = true
  };
  var disableDevelopingMode = function() {
    developping = false
  };
  var isDevelopping = function() {
    return developping
  };
  var getActionSave = function() {
    if(settings) {
      return settings.actionSave
    }else {
      return"view"
    }
  };
  var getActionInit = function() {
    if(settings) {
      return settings.actionInit
    }else {
      return"nothing"
    }
  };
  var getPresentationSamples = function() {
    if(settings && settings.samples) {
      return settings.samples
    }else {
      log("VISH.Debugging Error: Please specify development settings");
      return null
    }
  };
  var initVishViewer = function() {
    var mypresentation = null;
    if(VISH.Editing) {
      if(!presentationOptions) {
        log("VISH.Debugging Error: Specify presentationOptions");
        return
      }
      mypresentation = VISH.Editor.savePresentation()
    }else {
      log("You are already in Vish Viewer");
      return
    }
    $("article").remove();
    $("#menubar").hide();
    $("#menubar_helpsection").hide();
    $("#menubar_helpsection2").hide();
    $("#joyride_help_button").hide();
    $("#preview_circle").hide();
    VISH.Editor.Tools.cleanZoneTools();
    VISH.Editor.Tools.disableToolbar();
    $("#menubar-viewer").show();
    log("Init Vish Viewer with presentation: " + JSON.stringify(mypresentation));
    VISH.SlideManager.init(presentationOptions, mypresentation)
  };
  var initVishEditor = function() {
    var mypresentation = null;
    if(VISH.Editing) {
      log("You are already in Vish Editor");
      return
    }else {
      if(!presentationOptions) {
        log("VISH.Debugging Error: Specify presentationOptions");
        return
      }
      mypresentation = VISH.Editor.getSavedPresentation()
    }
    $("article").remove();
    $("#menubar").show();
    $("#menubar_helpsection").show();
    $("#menubar_helpsection2").show();
    $("#joyride_help_button").show();
    $("#preview_circle").show();
    VISH.Editor.Tools.enableToolbar();
    $("#menubar-viewer").hide();
    VISH.Debugging.log("Init Vish Editor with presentation: " + JSON.stringify(mypresentation));
    VISH.Editor.init(presentationOptions, mypresentation)
  };
  return{init:init, log:log, shuffleJson:shuffleJson, enableDevelopingMode:enableDevelopingMode, disableDevelopingMode:disableDevelopingMode, isDevelopping:isDevelopping, getActionSave:getActionSave, getActionInit:getActionInit, getPresentationSamples:getPresentationSamples, initVishViewer:initVishViewer, initVishEditor:initVishEditor}
}(VISH, jQuery);
VISH.Dummies = function(VISH, undefined) {
  var nextDivId = 1;
  var nextArticleId = 1;
  var hashTypeQuiz = {"open":0, "multiplechoice":1, "truefalse":2};
  var dummies = [];
  var quizDummies = [];
  var init = function() {
    dummies = ["<article id='article_id_to_change' template='t1' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' size='large' class='t1_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='header' size='small' class='t1_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='subheader' size='small' class='t1_subheader editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t2' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' size='large' class='t2_left editable grey_background selectable'></div></article>", "<article id='article_id_to_change' template='t3' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + 
    VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t3_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='large'  class='t3_left editable grey_background selectable'></div></article>", "<article id='article_id_to_change' template='t4' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t4_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='large'  class='t4_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='right'  size='small'  class='t4_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t5' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t5_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t5_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='right'  size='medium' class='t5_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t6' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t6_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t6_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t6_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t6_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t7' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t7_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t7_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='large'  class='t7_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='subheader' size='small' class='t7_subheader editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t8' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t8_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='small'  class='t8_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='large'  class='t8_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='small'     class='t8_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t9' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='small' class='t9_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t9_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t9_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t9_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t10' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' size='large' class='t10_left editable grey_background selectable'></div></article>", "<article id='article_id_to_change' template='t11' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + 
    VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='medium' class='t11_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium'  class='t11_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='right'  size='medium'  class='t11_right editable grey_background selectable'></div></article>", "<article id='article_id_to_change' template='t12' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + 
    VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='medium' class='t12_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t12_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t12_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t12_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t13' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='medium' class='t13_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t13_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t13_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t13_right editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t14' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' size='medium' class='t14_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='medium' class='t14_right editable grey_background selectable'></div><div id='div_id_to_change' areaid='left1' size='medium'    class='t14_left1 editable grey_background selectable'></div><div id='div_id_to_change' areaid='right1' size='medium' class='t14_right1 editable grey_background selectable'></div><div id='div_id_to_change' areaid='left2' size='medium'    class='t14_left2 editable grey_background selectable'></div><div id='div_id_to_change' areaid='right2' size='medium' class='t14_right2 editable grey_background selectable'></div></article>", 
    "<article id='article_id_to_change' template='t15' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_template' id='help_template_image' src='" + VISH.ImagesPath + "helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header' size='medium' class='t15_header editable grey_background selectable'></div><div id='div_id_to_change' areaid='left' size='medium' class='t15_left editable grey_background selectable'></div><div id='div_id_to_change' areaid='center' size='medium' class='t15_center editable grey_background selectable'></div><div id='div_id_to_change' areaid='right' size='medium'    class='t15_right editable grey_background selectable'></div></article>"];
    quizDummies = ["<div class='openQuizContainer'><textarea class='value_open_question_in_zone'><div><font size=" + 4 + ">Write question here</font></div></textarea></div>", "<div class='multipleChoiceQuizContainer'><textarea class='value_multiplechoice_question_in_zone' placeholder='write question here' ><font size='4'>Write question here</font></textarea><ul class='ul_mch_options_in_zone'><li class='li_mch_options_in_zone '><span>a)</span><input class='multiplechoice_text_in_zone' type='text' placeholder='write quiz options here' /></li><li class='li_mch_options_in_zone '><span>b)</span><input class='multiplechoice_text_in_zone' type='text' placeholder='write quiz options here' /></li><li class='li_mch_options_in_zone '><span>c)</span><input class='multiplechoice_text_in_zone' type='text' placeholder='write quiz options here' /></li><li class='li_mch_options_in_zone '><span>d)</span><input class='multiplechoice_text_in_zone' type='text' placeholder='write quiz options here' /></li><li class='li_mch_options_in_zone '><span>e)</span><input class='multiplechoice_text_in_zone' type='text' placeholder='write quiz options here' /></li><li class='li_mch_options_in_zone '><span>f)</span><input class='multiplechoice_text_in_zone' type='text' placeholder='write quiz options here' /></li></ul></div></div>", 
    "<div class='trueFalseQuizContainer'><p> quiz dummy truefalse</p></div>"]
  };
  var getDummy = function(template, position, presentation_id, existing_slide) {
    var dum = dummies[parseInt(template, 10) - 1];
    return _replaceIds(dum, position, presentation_id, existing_slide)
  };
  var getQuizDummy = function(type_quiz, position) {
    return quizDummies[hashTypeQuiz[type_quiz]]
  };
  var _replaceIds = function(string, position, presentation_id, existing_slide) {
    var newString = string;
    while(newString.indexOf("div_id_to_change") != -1) {
      newString = newString.replace("div_id_to_change", "zone" + nextDivId);
      nextDivId++
    }
    while(newString.indexOf("article_id_to_change") != -1) {
      if(!presentation_id) {
        presentation_id = ""
      }
      newString = newString.replace("article_id_to_change", "article_" + presentation_id + "_" + position)
    }
    while(newString.indexOf("slidenumber_to_change") != -1) {
      newString = newString.replace("slidenumber_to_change", position)
    }
    if(existing_slide) {
      newString = newString.replace(/editable /g, "")
    }
    return newString
  };
  return{init:init, getDummy:getDummy, getQuizDummy:getQuizDummy}
}(VISH);
VISH.Editor.API = function(V, $, undefined) {
  var init = function() {
  };
  var requestVideos = function(text, successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = jQuery.extend({}, VISH.Samples.API.videoList);
        switch(text) {
          case "dummy":
            result["videos"] = VISH.Samples.API.videoListDummy["videos"];
            break;
          case "little":
            result["videos"] = VISH.Debugging.shuffleJson(VISH.Samples.API.videoListLittle["videos"]);
            break;
          default:
            result["videos"] = VISH.Debugging.shuffleJson(VISH.Samples.API.videoList["videos"])
        }
        successCallback(result)
      }
      return
    }
    _requestByType("video", text, successCallback, failCallback)
  };
  var requestRecomendedVideos = function(successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = VISH.Samples.API.videoList;
        result["videos"] = VISH.Debugging.shuffleJson(VISH.Samples.API.videoList["videos"]);
        successCallback(result)
      }
      return
    }
    _requestByType("video", "", successCallback, failCallback)
  };
  var requestFlashes = function(text, successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = jQuery.extend({}, VISH.Samples.API.flashList);
        switch(text) {
          case "dummy":
            result["flashes"] = VISH.Samples.API.flashListDummy["flashes"];
            break;
          case "little":
            result["flashes"] = VISH.Debugging.shuffleJson(VISH.Samples.API.flashListLittle["flashes"]);
            break;
          default:
            result["flashes"] = VISH.Debugging.shuffleJson(VISH.Samples.API.flashList["flashes"])
        }
        successCallback(result)
      }
      return
    }
    _requestByType("swfs", text, successCallback, failCallback)
  };
  var requestRecomendedFlashes = function(successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = VISH.Samples.API.flashList;
        result["flashes"] = VISH.Debugging.shuffleJson(VISH.Samples.API.flashList["flashes"]);
        successCallback(result)
      }
      return
    }else {
      _requestByType("swfs", "", successCallback, failCallback)
    }
  };
  var requestImages = function(text, successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = jQuery.extend({}, VISH.Samples.API.imageList);
        switch(text) {
          case "dummy":
            result["pictures"] = VISH.Samples.API.imageListDummy["pictures"];
            break;
          case "little":
            result["pictures"] = VISH.Debugging.shuffleJson(VISH.Samples.API.imageListLittle["pictures"]);
            break;
          default:
            result["pictures"] = VISH.Debugging.shuffleJson(VISH.Samples.API.imageList["pictures"])
        }
        successCallback(result)
      }
      return
    }
    _requestByType("picture", text, successCallback, failCallback)
  };
  var requestRecomendedImages = function(successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = VISH.Samples.API.imageList;
        result["pictures"] = VISH.Debugging.shuffleJson(VISH.Samples.API.imageList["pictures"]);
        successCallback(result)
      }
      return
    }
    _requestByType("picture", "", successCallback, failCallback)
  };
  var requestLives = function(text, successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = jQuery.extend({}, VISH.Samples.API.liveList);
        switch(text) {
          case "dummy":
            result = VISH.Samples.API.liveListDummy;
            break;
          case "little":
            result = VISH.Debugging.shuffleJson(VISH.Samples.API.liveListLittle);
            break;
          default:
            result = VISH.Debugging.shuffleJson(VISH.Samples.API.liveList)
        }
        successCallback(result)
      }
      return
    }
    _requestByType("live", text, successCallback, failCallback)
  };
  var requestRecomendedLives = function(successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = VISH.Debugging.shuffleJson(VISH.Samples.API.liveList);
        successCallback(result)
      }
      return
    }
    _requestByType("live", "", successCallback, failCallback)
  };
  var requestObjects = function(text, successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = jQuery.extend({}, VISH.Samples.API.objectList);
        switch(text) {
          case "dummy":
            result = VISH.Samples.API.objectListDummy;
            break;
          case "little":
            result = VISH.Debugging.shuffleJson(VISH.Samples.API.objectListLittle);
            break;
          default:
            result = VISH.Debugging.shuffleJson(VISH.Samples.API.objectList)
        }
        successCallback(result)
      }
      return
    }
    _requestByType("object", text, successCallback, failCallback)
  };
  var requestRecomendedObjects = function(successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        var result = VISH.Debugging.shuffleJson(VISH.Samples.API.objectList);
        successCallback(result)
      }
      return
    }
    _requestByType("object", "", successCallback, failCallback)
  };
  var _requestByType = function(type, query, successCallback, failCallback) {
    if(type == "live" || type == "object") {
      _requestResourceType(type, query, successCallback, failCallback);
      return
    }
    $.ajax({type:"GET", url:"/search.json?type=" + type + "&q=" + query, dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var resp = JSON.parse(response);
        successCallback(resp)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var _requestResourceType = function(type, query, successCallback, failCallback) {
    $.ajax({type:"GET", url:"/resources/search.json?" + type + "=1&q=" + query, dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var resp = JSON.parse(response);
        successCallback(resp)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var tags;
  var requestTags = function(successCallback, failCallback) {
    if(tags && typeof successCallback == "function") {
      successCallback(tags);
      return
    }
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        tags = VISH.Samples.API.tagsList["tags"];
        successCallback(VISH.Samples.API.tagsList["tags"])
      }
      return
    }
    $.ajax({type:"GET", url:"/tags.json?mode=popular&limit=100", dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var tagsJSON = JSON.parse(response);
        if(tagsJSON.length > 0) {
          tags = [];
          $.each(tagsJSON, function(index, tagJSON) {
            tags.push(tagJSON.value)
          });
          successCallback(tags)
        }
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var requestThumbnails = function(successCallback, failCallback) {
    if(VISH.Debugging.isDevelopping()) {
      if(typeof successCallback == "function") {
        successCallback(VISH.Samples.API.thumbnailsList)
      }
      return
    }
    $.ajax({async:false, type:"GET", url:"/excursion_thumbnails.json", dataType:"json", success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback(xhr, ajaxOptions, thrownError)
      }
    }})
  };
  return{init:init, requestVideos:requestVideos, requestRecomendedVideos:requestRecomendedVideos, requestImages:requestImages, requestRecomendedImages:requestRecomendedImages, requestFlashes:requestFlashes, requestRecomendedFlashes:requestRecomendedFlashes, requestObjects:requestObjects, requestRecomendedObjects:requestRecomendedObjects, requestLives:requestLives, requestRecomendedLives:requestRecomendedLives, requestTags:requestTags, requestThumbnails:requestThumbnails}
}(VISH, jQuery);
VISH.Editor.AvatarPicker = function(V, $, undefined) {
  var avatars = null;
  var selectedAvatar;
  var thumbnailsDetailsId = "thumbnails_in_presentation_details";
  var carrouselDivId = "avatars_carrousel";
  var init = function() {
    $("#hidden_button_to_uploadThumbnail").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      V.Editor.Image.setAddContentMode(VISH.Constant.THUMBNAIL);
      V.Utils.loadTab("tab_pic_from_url")
    }})
  };
  var onLoadPresentationDetails = function(mySelectedAvatar) {
    if(mySelectedAvatar) {
      selectedAvatar = mySelectedAvatar
    }
    if(avatars === null) {
      $("#" + thumbnailsDetailsId).hide();
      VISH.Editor.API.requestThumbnails(_onThumbnailsReceived, _onThumbnailsError)
    }else {
      _selectAvatarInCarrousel(selectedAvatar)
    }
  };
  var onCustomThumbnailSelected = function(thumbnail_url) {
    VISH.Editor.Tools.Menu.displaySettings();
    _addCustomThumbnail(thumbnail_url)
  };
  var _addCustomThumbnail = function(thumbnail_url) {
    var element = $("<div class='carrousel_element_single_row_thumbnails'><img class='carrousel_element_single_row_thumbnails carrousel_last_added_element' src='" + thumbnail_url + "'/></div>")[0];
    VISH.Editor.Carrousel.insertElement(carrouselDivId, element, 1);
    var element = $(".carrousel_last_added_element");
    $(element).click(function(event) {
      _onAvatarSelected(event)
    });
    VISH.Editor.Carrousel.goToElement(carrouselDivId, $(element)[0]);
    $(element).trigger("click");
    $(element).removeClass("carrousel_last_added_element")
  };
  var _onAvatarSelected = function(event) {
    if($(event.target)[0].tagName !== "IMG") {
      return
    }else {
      var avatar = $(event.target)
    }
    if($(avatar).hasClass("uploadThumbnail")) {
      $("#hidden_button_to_uploadThumbnail").trigger("click");
      return
    }
    $(".carrousel_element_single_row_thumbnails").removeClass("selectedThumbnail");
    $(avatar).addClass("selectedThumbnail");
    $("#presentation_avatar").val($(event.target).attr("src"))
  };
  var _selectRandom = function(max) {
    var randomnumber = Math.ceil(Math.random() * max);
    $("#" + carrouselDivId + " .carrousel_element_single_row_thumbnails:nth-child(" + randomnumber + ") img").addClass("selectedThumbnail");
    $("#presentation_avatar").val($("#" + carrouselDivId + " .carrousel_element_single_row_thumbnails:nth-child(" + randomnumber + ") img").attr("src"))
  };
  var _selectDefaultAvatarInCarrousel = function(avatar) {
    if(avatar) {
      var avatarName = avatar.split("/").pop();
      var avatarImages = $("#" + carrouselDivId).find("img.carrousel_element_single_row_thumbnails");
      $.each(avatarImages, function(i, image) {
        if($(image).attr("src").split("/").pop() === avatarName) {
          $(image).addClass("selectedThumbnail");
          VISH.Editor.Carrousel.goToElement(carrouselDivId, $(image))
        }
      })
    }
  };
  var _selectAvatarInCarrousel = function(avatar) {
    if(avatar) {
      var avatarImages = $("#" + carrouselDivId).find("img.carrousel_element_single_row_thumbnails");
      $.each(avatarImages, function(i, image) {
        if($(image).attr("src") === avatar) {
          $(image).addClass("selectedThumbnail");
          VISH.Editor.Carrousel.goToElement(carrouselDivId, $(image))
        }
      })
    }
  };
  var _onThumbnailsReceived = function(data) {
    avatars = data;
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    var content = "";
    var carrouselImages = [];
    carrouselImages.push($("<img class='uploadThumbnail' src='" + VISH.ImagesPath + "addThumbnail.png'/>")[0]);
    $.each(avatars.pictures, function(i, item) {
      var myImg = $("<img src=" + item.src + " />");
      carrouselImages.push($(myImg)[0])
    });
    VISH.Utils.loader.loadImagesOnCarrouselOrder(carrouselImages, _onImagesLoaded, carrouselDivId)
  };
  var _onThumbnailsError = function(xhr, ajaxOptions, thrownError) {
    VISH.Debugging.log("_onThumbnailsError");
    VISH.Debugging.log("status returned by server:" + xhr.status);
    VISH.Debugging.log("Error in client: " + thrownError);
    VISH.Debugging.log("ERROR!" + thrownError)
  };
  var _onImagesLoaded = function() {
    $("#" + thumbnailsDetailsId).show();
    var options = new Array;
    options["rows"] = 1;
    options["callback"] = _onAvatarSelected;
    options["rowItems"] = 5;
    options["styleClass"] = "thumbnails";
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options);
    $(".buttonintro").addClass("buttonintro_extramargin");
    if(selectedAvatar) {
      if(!_isDefaultAvatar(selectedAvatar)) {
        _addCustomThumbnail(selectedAvatar)
      }else {
        _selectDefaultAvatarInCarrousel(selectedAvatar)
      }
    }else {
      _selectRandom(5)
    }
  };
  var _isDefaultAvatar = function(avatar) {
    if(!avatar) {
      return false
    }
    var namePattern = "(^excursion-)";
    var avatarName = avatar.split("/").pop();
    if(avatarName.match(namePattern) === null) {
      return false
    }
    var pathPattern = "(^" + VISH.ImagesPath + ")";
    return avatar.match(pathPattern) !== null
  };
  return{init:init, onLoadPresentationDetails:onLoadPresentationDetails, onCustomThumbnailSelected:onCustomThumbnailSelected, _isDefaultAvatar:_isDefaultAvatar}
}(VISH, jQuery);
VISH.Editor.Carrousel = function(V, $, undefined) {
  var createCarrousel = function(containerId, options) {
    if(!containerId) {
      return
    }
    var rows = 1;
    var rowItems = 5;
    var scrollItems = null;
    var styleClass = "";
    var titleClass = "";
    var callback = null;
    var width = 750;
    var startAtLastElement = false;
    var pagination = true;
    var sortable = false;
    var afterCreateCarruselFunction = null;
    if(options) {
      if(options["rows"]) {
        rows = options["rows"]
      }
      if(options["rowItems"]) {
        rowItems = options["rowItems"]
      }
      if(options["scrollItems"]) {
        scrollItems = options["scrollItems"]
      }
      if(options["styleClass"]) {
        styleClass = options["styleClass"]
      }
      if(options["titleClass"]) {
        titleClass = options["titleClass"]
      }
      if(options["callback"]) {
        callback = options["callback"]
      }
      if(options["width"]) {
        width = options["width"]
      }
      if(options["startAtLastElement"]) {
        startAtLastElement = options["startAtLastElement"]
      }
      if(typeof options["pagination"] == "boolean") {
        pagination = options["pagination"]
      }
      if(typeof options["sortable"] == "boolean") {
        sortable = options["sortable"]
      }
      if(options["afterCreateCarruselFunction"]) {
        afterCreateCarruselFunction = options["afterCreateCarruselFunction"]
      }
    }
    var multipleRow = rows > 1;
    var carrouselClass = "";
    if(styleClass) {
      carrouselClass = "_" + styleClass
    }
    if(!scrollItems) {
      scrollItems = rowItems
    }
    if(multipleRow) {
      var rowClass = "multiple_row" + carrouselClass
    }else {
      var rowClass = "single_row" + carrouselClass
    }
    var wrapperDiv = $("#" + containerId);
    wrapperDiv.attr("class", "image_carousel image_carousel_" + rowClass);
    wrapperDiv.removeAttr("id");
    var mainDiv = document.createElement("div");
    $(mainDiv).html($(wrapperDiv).html());
    $(wrapperDiv).html("");
    mainDiv.setAttribute("id", containerId);
    var clearFix = document.createElement("div");
    clearFix.setAttribute("class", "clearfix");
    var button_prev = document.createElement("a");
    var button_next = document.createElement("a");
    button_prev.setAttribute("class", "prev");
    button_next.setAttribute("class", "next");
    $(button_prev).addClass("prev_" + rowClass);
    $(button_next).addClass("next_" + rowClass);
    button_prev.setAttribute("href", "#");
    button_next.setAttribute("href", "#");
    button_prev.setAttribute("id", "carrousel_prev" + containerId);
    button_next.setAttribute("id", "carrousel_next" + containerId);
    $(button_prev).html("<span>prev</span>");
    $(button_next).html("<span>next</span>");
    $(wrapperDiv).append(clearFix);
    $(wrapperDiv).append(button_prev);
    $(wrapperDiv).append(button_next);
    if(pagination) {
      var paginationDiv = document.createElement("div");
      paginationDiv.setAttribute("class", "pagination pagination_" + rowClass);
      paginationDiv.setAttribute("id", "carrousel_pag" + containerId);
      $(wrapperDiv).append(paginationDiv)
    }
    $(mainDiv).children().addClass("carrousel_element_" + rowClass);
    $(mainDiv).children().each(function(index, value) {
      $(value).children().addClass("carrousel_element_" + rowClass)
    });
    if(callback && typeof callback == "function") {
      $(mainDiv).children().click(function(event) {
        callback(event)
      })
    }
    if(multipleRow) {
      _applyMultipleRows(containerId, wrapperDiv, mainDiv, rows, rowItems, scrollItems, rowClass, width)
    }else {
      $(wrapperDiv).prepend(mainDiv);
      if(startAtLastElement) {
        var start = $(mainDiv).children().length - rowItems + 1
      }else {
        var start = 0
      }
      _setMainCarrousel(containerId, containerId, rows, [], rowItems, scrollItems, width, start, afterCreateCarruselFunction)
    }
    if(pagination) {
      _forceShowPagination(containerId)
    }
    if(sortable) {
      $("#" + containerId).sortable()
    }
    return"Done"
  };
  var _applyMultipleRows = function(containerId, wrapperDiv, mainDiv, rows, rowItems, scrollItems, rowClass, width) {
    var synchronizeIds = [];
    var i;
    for(i = 0;i < rows;i++) {
      window[mainDiv.id + "_row" + i] = document.createElement("div");
      window[mainDiv.id + "_row" + i].setAttribute("id", mainDiv.id + "_row" + i);
      window[mainDiv.id + "_row" + i].setAttribute("class", "carrousel_wrapper_" + rowClass);
      if(i != 0) {
        synchronizeIds.push(mainDiv.id + "_row" + i)
      }
    }
    $(mainDiv).children().each(function(index, value) {
      $(window[mainDiv.id + "_row" + index % rows]).append(value)
    });
    for(i = rows - 1;i >= 0;i--) {
      $(wrapperDiv).prepend(window[mainDiv.id + "_row" + i]);
      if(i == 0) {
        var newContainerId = mainDiv.id + "_row" + i;
        _setMainCarrousel(newContainerId, containerId, rows, synchronizeIds, rowItems, scrollItems, width)
      }else {
        _setRowCarrousel(mainDiv.id + "_row" + i, rowItems, scrollItems, width)
      }
    }
    $(".caroufredsel_wrapper").css("margin-bottom", "30px")
  };
  var _setRowCarrousel = function(id, rowItems, scrollItems, width) {
    $("#" + id).carouFredSel({auto:false, circular:false, infinite:false, width:width, scroll:{items:scrollItems, fx:"scroll", duration:1E3, pauseDuration:2E3}, items:{visible:{min:rowItems, max:rowItems}}})
  };
  var _setMainCarrousel = function(id, widgetsId, rows, synchronizeIds, rowItems, scrollItems, width, start, afterCreateCarruselFunction) {
    if(!start) {
      start = 0
    }
    $("#" + id).carouFredSel({circular:false, infinite:false, auto:false, width:width, scroll:{items:scrollItems, duration:1E3, pauseDuration:2E3}, items:{visible:{min:rowItems, max:rowItems}, start:start}, prev:{button:"#carrousel_prev" + widgetsId, key:"left"}, next:{button:"#carrousel_next" + widgetsId, key:"right"}, pagination:"#carrousel_pag" + widgetsId, onCreate:afterCreateCarruselFunction});
    if(synchronizeIds) {
      $(synchronizeIds).each(function(index, value) {
        $("#" + id).trigger("configuration", ["synchronise", "#" + value])
      })
    }
    $("#" + id).attr("rows", rows)
  };
  var cleanCarrousel = function(containerId) {
    $("#" + containerId).html("");
    var containderIdForMultiRow = containerId + "_row0";
    if($("#" + containderIdForMultiRow).attr("rows")) {
      var rows = $("#" + containderIdForMultiRow).attr("rows");
      var i;
      for(i = 0;i < rows;i++) {
        _cleanOneRowCarrousel(containerId + "_row" + i)
      }
      $("#" + containderIdForMultiRow).attr("id", containerId)
    }else {
      _cleanOneRowCarrousel(containerId)
    }
  };
  var _cleanOneRowCarrousel = function(containerId) {
    var carrouselWrapper = $("#" + containerId).parent().parent();
    if($(carrouselWrapper).hasClass("image_carousel")) {
      $(carrouselWrapper).removeClass();
      $(carrouselWrapper).html("");
      $(carrouselWrapper).attr("id", containerId)
    }
  };
  var _forceShowPagination = function(containerId) {
    var parent = $("#" + containerId).parent().parent();
    if($(parent).hasClass("image_carousel")) {
      $(parent).find(".pagination").attr("style", "")
    }
  };
  var goToElement = function(carrouselDivId, element) {
    if($(element).is("IMG")) {
      element = $(element).parent()
    }
    $("#" + carrouselDivId).trigger("slideTo", element)
  };
  var advanceCarrousel = function(carrouselDivId, no) {
    $("#" + carrouselDivId).trigger("next", no)
  };
  var backCarrousel = function(carrouselDivId, no) {
    $("#" + carrouselDivId).trigger("prev", no)
  };
  var insertElement = function(carrouselDivId, element, posc) {
    $("#" + carrouselDivId).trigger("insertItem", [element, posc])
  };
  return{createCarrousel:createCarrousel, cleanCarrousel:cleanCarrousel, goToElement:goToElement, advanceCarrousel:advanceCarrousel, backCarrousel:backCarrousel, insertElement:insertElement}
}(VISH, jQuery);
VISH.Editor.Filter = function(V, $, undefined) {
  var init = function() {
    var device = VISH.Status.getDevice();
    var browser = device.browser;
    switch(browser.name) {
      case VISH.Constant.IE:
        $("#tab_object_snapshot").hide();
        break;
      case VISH.Constant.UNKNOWN:
        $("#tab_object_snapshot").hide();
        break
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.Flashcard = function(V, $, undefined) {
  var loadFlashcard = function(presentation) {
    V.Editor.setPresentationType("flashcard");
    V.Editor.Utils.hideSlides();
    $("#flashcard-background").show();
    if(presentation) {
      $("#flashcard-background").css("background-image", presentation.background.src);
      $("#fc_change_bg_big").hide()
    }
    $("#flashcard-background").droppable()
  };
  var switchToFlashcard = function() {
    loadFlashcard();
    V.Editor.Thumbnails.redrawThumbnails();
    VISH.Editor.Tools.init()
  };
  var onBackgroundSelected = function(contentToAdd) {
    $("#flashcard-background").css("background-image", "url(" + contentToAdd + ")");
    $("#fc_change_bg_big").hide();
    $.fancybox.close()
  };
  var redrawPois = function() {
    $(".draggable_arrow_div").show();
    _applyStyleToPois();
    $(".draggable_arrow_div").draggable({revert:"invalid", stop:function(event, ui) {
      if($(event.target).offset().top > 50 && $(event.target).offset().top < 600 && $(event.target).offset().left > 55 && $(event.target).offset().left < 805) {
        $(event.target).attr("moved", "true");
        var old_pos = $(event.target).offset();
        $(event.target).css("position", "fixed");
        $(event.target).css("top", old_pos.top + 30 + "px");
        $(event.target).css("left", old_pos.left - 16 + "px")
      }else {
        $(event.target).attr("moved", "false");
        var old_pos = $(event.target).offset();
        $(event.target).css("top", old_pos.top + 30 + "px");
        $(event.target).css("left", old_pos.left - 16 + "px")
      }
    }});
    $(".carrousel_element_single_row_slides").droppable();
    $(".image_carousel").css("overflow", "visible");
    $("#menubar").css("z-index", "1075");
    $(".draggable_arrow_div").css("z-index", "1075")
  };
  var _applyStyleToPois = function() {
    var presentation = V.Editor.getPresentation();
    if(presentation && presentation.background && presentation.background.pois) {
      $.each(presentation.background.pois, function(index, val) {
        $("#" + val.id).css("position", "fixed");
        $("#" + val.id).offset({top:600 * parseInt(val.y) / 100 + 75, left:800 * parseInt(val.x) / 100 + 55});
        $("#" + val.id).attr("moved", "true")
      })
    }
  };
  var savePois = function() {
    var pois = [];
    $(".draggable_arrow_div[moved='true']").each(function(index, s) {
      pois[index] = {};
      pois[index].id = $(s).attr("id");
      pois[index].x = 100 * ($(s).offset().left - 55) / 800;
      pois[index].y = 100 * ($(s).offset().top - 75) / 600;
      pois[index].slide_id = $(s).attr("slide_id")
    });
    return pois
  };
  var removePois = function() {
    $(".draggable_arrow_div").hide()
  };
  var hasPoiInBackground = function() {
    return $(".draggable_arrow_div[moved='true']").length > 0
  };
  var hasChangedBackground = function() {
    if($("#flashcard-background").css("background-image").indexOf("flashcard_initial_background.jpg") != -1) {
      return false
    }else {
      return true
    }
  };
  return{hasChangedBackground:hasChangedBackground, hasPoiInBackground:hasPoiInBackground, loadFlashcard:loadFlashcard, redrawPois:redrawPois, removePois:removePois, savePois:savePois, switchToFlashcard:switchToFlashcard, onBackgroundSelected:onBackgroundSelected}
}(VISH, jQuery);
VISH.Editor.I18n = function(V, $, undefined) {
  var translations;
  var defaultTranslations;
  var language;
  var init = function(lang) {
    switch(VISH.Configuration.getConfiguration()["mode"]) {
      case VISH.Constant.NOSERVER:
        if(typeof i18n["vish"]["default"] !== "undefined") {
          defaultTranslations = i18n["vish"]["default"]
        }
        break;
      case VISH.Constant.VISH:
        if(typeof i18n["vish"]["default"] !== "undefined") {
          defaultTranslations = i18n["vish"]["default"]
        }
        break;
      case VISH.Constant.STANDALONE:
        if(typeof i18n["standalone"]["default"] !== "undefined") {
          defaultTranslations = i18n["standalone"]["default"]
        }
        break
    }
    if(typeof lang !== "undefined") {
      language = lang
    }else {
      return
    }
    switch(VISH.Configuration.getConfiguration()["mode"]) {
      case VISH.Constant.NOSERVER:
        if(typeof i18n["vish"][language] !== "undefined") {
          translations = i18n["vish"][language]
        }
        break;
      case VISH.Constant.VISH:
        if(typeof i18n["vish"][language] !== "undefined") {
          translations = i18n["vish"][language];
          defaultTranslations = i18n["vish"]["default"]
        }
        break;
      case VISH.Constant.STANDALONE:
        if(typeof i18n["standalone"][language] !== "undefined") {
          translations = i18n["standalone"][language];
          defaultTranslations = i18n["standalone"]["default"]
        }
        break
    }
    if(typeof translations === "undefined") {
      return
    }
    $("[i18n-key]").each(function(index, elem) {
      var translation = getTrans($(elem).attr("i18n-key"));
      if(translation != null) {
        switch(elem.tagName) {
          case "INPUT":
            _translateInput(elem, translation);
            break;
          case "TEXTAREA":
            _translateTextArea(elem, translation);
            break;
          case "DIV":
            _translateDiv(elem, translation);
            break;
          case "LI":
            _translateLI(elem, translation);
            break;
          default:
            _genericTranslate(elem, translation);
            break
        }
      }
    });
    _translateTutorialImage()
  };
  var _translateInput = function(input, translation) {
    if($(input).val() !== "") {
      $(input).val(translation)
    }
    if($(input).attr("placeholder")) {
      $(input).attr("placeholder", translation)
    }
  };
  var _translateDiv = function(div, translation) {
    if($(div).attr("title") != undefined) {
      $(div).attr("title", translation)
    }
    if($(div).attr("data-text") != undefined) {
      $(div).attr("data-text", translation)
    }
  };
  var _translateTextArea = function(textArea, translation) {
    $(textArea).attr("placeholder", translation)
  };
  var _translateLI = function(elem, translation) {
    if($(elem).attr("data-text") != undefined) {
      $(elem).attr("data-text", translation)
    }else {
      _genericTranslate(elem, translation)
    }
  };
  var _genericTranslate = function(elem, translation) {
    $(elem).text(translation)
  };
  var _translateTutorialImage = function() {
    if(typeof translations != "undefined" && typeof language !== "undefined") {
      var factor;
      if(language === "es") {
        factor = 2
      }
      var normal_pos = 360;
      var hover_pos = 480;
      $("#start_tutorial").css("background-position", "0px -" + normal_pos + "px");
      $("#start_tutorial").hover(function() {
        $("#start_tutorial").css("background-position", "0px -" + hover_pos + "px")
      }, function() {
        $("#start_tutorial").css("background-position", "0px -" + normal_pos + "px")
      });
      $("#contentusetut").attr("src", VISH.ImagesPath + "contentuse_" + language + ".png")
    }
  };
  var getTrans = function(s) {
    if(typeof translations !== "undefined" && translations[s]) {
      return translations[s]
    }
    if(typeof defaultTranslations !== "undefined" && defaultTranslations[s]) {
      return defaultTranslations[s]
    }
    var key_pattern = /^i\./g;
    if(key_pattern.exec(s) != null) {
      return null
    }else {
      return s
    }
  };
  return{getTrans:getTrans, init:init}
}(VISH, jQuery);
VISH.Editor.Image.Flikr = function(V, $, undefined) {
  var carrouselDivId = "tab_flikr_content_carrousel";
  var queryMaxNumberFlikrImages = 80;
  var init = function() {
    var myInput = $("#tab_pic_flikr_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        VISH.Editor.Image.Flikr.listImages($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function() {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    $("#tab_pic_flikr_content").find("input[type='search']").attr("value", "")
  };
  var listImages = function(text) {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    var url_flikr = "http://api.flickr.com/services/feeds/photos_public.gne?tags=" + text + "&tagmode=any&format=json&jsoncallback=?";
    var carrouselImages = [];
    $.getJSON(url_flikr, function(data) {
      if(!data.items.length > 0) {
        $("#" + carrouselDivId).show();
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'> No results found </p>");
        return
      }
      $.each(data.items, function(i, item) {
        var myImg = $("<img id=img_flkr" + i + " src=" + item.media.m + " imageFlikrId=" + i + "/>");
        carrouselImages.push(myImg)
      });
      VISH.Utils.loader.loadImagesOnCarrousel(carrouselImages, _onImagesLoaded, carrouselDivId)
    })
  };
  var addImage = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _onImagesLoaded = function() {
    $("#" + carrouselDivId).show();
    var options = new Array;
    options["rows"] = 2;
    options["callback"] = VISH.Editor.Image.Flikr.addImage;
    options["rowItems"] = 4;
    options["scrollItems"] = 4;
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options)
  };
  return{init:init, onLoadTab:onLoadTab, listImages:listImages, addImage:addImage}
}(VISH, jQuery);
VISH.Editor.Image.Repository = function(V, $, undefined) {
  var carrouselDivId = "tab_pic_repo_content_carrousel";
  var previewDivId = "tab_pic_repo_content_preview";
  var currentImages = new Array;
  var selectedImage = null;
  var init = function() {
    var myInput = $("#tab_pic_repo_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function() {
    var previousSearch = $("#tab_pic_repo_content").find("input[type='search']").val() != "";
    if(!previousSearch) {
      _requestInitialData()
    }
  };
  var _requestInitialData = function() {
    VISH.Editor.API.requestRecomendedImages(_onDataReceived, _onAPIError)
  };
  var _requestData = function(text) {
    VISH.Editor.API.requestImages(text, _onDataReceived, _onAPIError)
  };
  var _onDataReceived = function(data) {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    currentImages = new Array;
    var carrouselImages = [];
    var content = "";
    if(!data.pictures || data.pictures.length == 0) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'> No results found </p>");
      $("#" + carrouselDivId).show();
      return
    }
    $.each(data.pictures, function(index, image) {
      var myImg = $("<img src=" + image.src + " >");
      carrouselImages.push(myImg);
      currentImages[image.id] = image
    });
    VISH.Utils.loader.loadImagesOnCarrousel(carrouselImages, _onImagesLoaded, carrouselDivId)
  };
  var _onImagesLoaded = function() {
    $("#" + carrouselDivId).show();
    var options = new Array;
    options["rows"] = 2;
    options["callback"] = _onClickCarrouselElement;
    options["rowItems"] = 4;
    options["scrollItems"] = 4;
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options)
  };
  var _onAPIError = function() {
    VISH.Debugging.log("API error")
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  return{init:init, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.MenuTablet = function(V, $, undefined) {
  var init = function() {
    $(".menu_option_main").click(function(event) {
      if($("ul.menu_option_main").css("display") == "none") {
        $("ul.menu_option_main").show()
      }else {
        $("ul.menu_option_main").hide()
      }
    });
    $("a.menu_option").click(function(event) {
      if(!$(this).hasClass("menu_action") && $(this).parent()[0].tagName === "LI" && $(this).parent().find("ul").length == 1) {
        var subMenu = $(this).parent().find("ul")[0];
        event.preventDefault();
        event.stopPropagation();
        $(subMenu).show()
      }else {
      }
    })
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.Object.Flash = function(V, $, undefined) {
  var drawFlashObjectWithSource = function(src) {
    var current_area = VISH.Editor.getCurrentArea();
    var template = VISH.Editor.getTemplate();
    var nextFlashId = VISH.Utils.getId();
    var idToDrag = "draggable" + nextFlashId;
    var idToResize = "resizable" + nextFlashId;
    current_area.attr("type", "object");
    var embedDiv = document.createElement("div");
    embedDiv.setAttribute("id", idToDrag);
    $(embedDiv).addClass("object_wrapper");
    $(embedDiv).addClass(template + "_object");
    var embedTag = document.createElement("embed");
    embedTag.setAttribute("id", idToResize);
    embedTag.setAttribute("class", template + "_object");
    embedTag.setAttribute("src", src);
    embedTag.setAttribute("wmode", "opaque");
    $(embedDiv).append(embedTag);
    $(current_area).html("");
    $(current_area).append(embedDiv);
    VISH.Editor.addDeleteButton($(current_area));
    var value = 10;
    var mystep = $(current_area).width() / 10;
    $("#menubar").before("<div id='sliderId" + nextFlashId + "' class='theslider'><input id='imageSlider" + nextFlashId + "' type='slider' name='size' value='" + value + "' style='display: none; '></div>");
    $("#imageSlider" + nextFlashId).slider({from:1, to:10, step:0.2, round:1, dimension:"x", skin:"blue", onstatechange:function(value) {
      VISH.Editor.Object.resizeObject(idToResize, mystep * value)
    }});
    $("#" + idToDrag).draggable({cursor:"move"})
  };
  return{drawFlashObjectWithSource:drawFlashObjectWithSource}
}(VISH, jQuery);
VISH.Editor.Object.Live = function(V, $, undefined) {
  var carrouselDivId = "tab_live_webcam_content_carrousel";
  var previewDivId = "tab_live_webcam_content_preview";
  var footId = "tab_live_webcam_content_preview_foot";
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    var myInput = $("#tab_live_webcam_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function(tab) {
    if(tab != "webcam") {
      return
    }
    var previousSearch = $("#tab_live_webcam_content").find("input[type='search']").val() != "";
    if(!previousSearch) {
      _cleanObjectPreview();
      _requestInicialData()
    }
    $("#" + footId).find(".okButton").hide()
  };
  var _requestInicialData = function() {
    VISH.Editor.API.requestRecomendedLives(_onDataReceived, _onAPIError)
  };
  var _requestData = function(text) {
    VISH.Editor.API.requestLives(text, _onDataReceived, _onAPIError)
  };
  var _onDataReceived = function(data) {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    _cleanObjectPreview();
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    var content = "";
    if(!data || data.length == 0) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'> No results found </p>");
      $("#" + carrouselDivId).show();
      return
    }
    $.each(data, function(index, object) {
      var objectInfo = VISH.Object.getObjectInfo(object.fulltext);
      var imageSource = null;
      switch(objectInfo.type) {
        case "swf":
          imageSource = VISH.ImagesPath + "carrousel/swf.png";
          break;
        case "youtube":
          imageSource = VISH.ImagesPath + "carrousel/youtube.png";
          break;
        case "web":
          if(objectInfo.wrapper == "IFRAME") {
            imageSource = VISH.ImagesPath + "carrousel/iframe.png"
          }else {
            imageSource = VISH.ImagesPath + "carrousel/object.png"
          }
          break;
        default:
          imageSource = VISH.ImagesPath + "carrousel/object.png";
          break
      }
      var myImg = $("<img src='" + imageSource + "' objectId='" + object.id + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(object.title);
      currentObject[object.id] = object
    });
    VISH.Utils.loader.loadImagesOnCarrousel(carrouselImages, _onImagesLoaded, carrouselDivId, carrouselImagesTitles)
  };
  var _onImagesLoaded = function() {
    $("#" + carrouselDivId).show();
    var options = new Array;
    options["rows"] = 1;
    options["callback"] = _onClickCarrouselElement;
    options["rowItems"] = 5;
    options["styleClass"] = "title";
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options)
  };
  var _onAPIError = function() {
    VISH.Debugging.log("Error")
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = VISH.Editor.Object.renderObjectPreview(currentObject[objectId].fulltext);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#" + previewDivId).find("#tab_live_webcam_content_preview_live");
    var metadataArea = $("#" + previewDivId).find("#tab_live_webcam_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var table = VISH.Utils.generateTable(object.author, object.title, object.description);
      $(metadataArea).html(table);
      $("#" + footId).find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#" + previewDivId).find("#tab_live_webcam_content_preview_live");
    var metadataArea = $("#" + previewDivId).find("#tab_live_webcam_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#" + footId).find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      VISH.Editor.Object.drawObject(selectedObject.fulltext);
      $.fancybox.close()
    }
  };
  return{init:init, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.PDF = function(V, $, undefined) {
  var init = function() {
  };
  var generateWrapperForPdf = function(url) {
    return"<iframe src='http://docs.google.com/viewer?url=" + url + "&embedded=true'></iframe>"
  };
  var generatePreviewWrapperForPdf = function(url) {
    return"<iframe class='objectPreview' src='http://docs.google.com/viewer?url=" + url + "&embedded=true'></iframe>"
  };
  return{init:init, generatePreviewWrapperForPdf:generatePreviewWrapperForPdf, generateWrapperForPdf:generateWrapperForPdf}
}(VISH, jQuery);
VISH.Editor.Object.Repository = function(V, $, undefined) {
  var carrouselDivId = "tab_object_repo_content_carrousel";
  var previewDivId = "tab_object_repo_content_preview";
  var footId = "tab_object_repo_content_preview_foot";
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    var myInput = $("#tab_object_repo_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function() {
    var previousSearch = $("#tab_object_repo_content").find("input[type='search']").val() != "";
    if(!previousSearch) {
      _cleanObjectPreview();
      _requestInicialData()
    }
    $("#" + footId).find(".okButton").hide()
  };
  var _requestInicialData = function() {
    VISH.Editor.API.requestRecomendedObjects(_onDataReceived, _onAPIError)
  };
  var _requestData = function(text) {
    VISH.Editor.API.requestObjects(text, _onDataReceived, _onAPIError)
  };
  var _onDataReceived = function(data) {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    _cleanObjectPreview();
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    var content = "";
    if(!data || data.length == 0) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'> No results found </p>");
      $("#" + carrouselDivId).show();
      return
    }
    $.each(data, function(index, objectItem) {
      var objectInfo = VISH.Object.getObjectInfo(objectItem.object);
      var imageSource = null;
      switch(objectInfo.type) {
        case "swf":
          imageSource = VISH.ImagesPath + "carrousel/swf.png";
          break;
        case "youtube":
          imageSource = VISH.ImagesPath + "carrousel/youtube.png";
          break;
        case "web":
          if(objectInfo.wrapper == "IFRAME") {
            imageSource = VISH.ImagesPath + "carrousel/iframe.png"
          }else {
            imageSource = VISH.ImagesPath + "carrousel/object.png"
          }
          break;
        default:
          imageSource = VISH.ImagesPath + "carrousel/object.png";
          break
      }
      var myImg = $("<img src='" + imageSource + "' objectId='" + objectItem.id + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectItem.id] = objectItem
    });
    VISH.Utils.loader.loadImagesOnCarrousel(carrouselImages, _onImagesLoaded, carrouselDivId, carrouselImagesTitles)
  };
  var _onImagesLoaded = function() {
    $("#" + carrouselDivId).show();
    var options = new Array;
    options["rows"] = 1;
    options["callback"] = _onClickCarrouselElement;
    options["rowItems"] = 5;
    options["styleClass"] = "title";
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options)
  };
  var _onAPIError = function() {
    VISH.Debugging.log("Error")
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = VISH.Editor.Object.renderObjectPreview(currentObject[objectId].object);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_object");
    var metadataArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var table = VISH.Utils.generateTable(object.author, object.title, object.description);
      $(metadataArea).html(table);
      $("#" + footId).find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_object");
    var metadataArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#" + footId).find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      VISH.Editor.Object.drawObject(selectedObject.object);
      $.fancybox.close()
    }
  };
  return{init:init, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.Snapshot = function(V, $, undefined) {
  var contentToAdd = null;
  var urlDivId = "tab_object_snapshot_content";
  var urlInputId = "object_snapshot_code";
  var init = function() {
    var urlInput = $(urlDivId).find("input");
    $(urlInput).watermark("Paste website URL");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(VISH.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = VISH.Utils.autocompleteUrls($("#" + urlInputId).val());
        VISH.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    })
  };
  var onLoadTab = function(tab) {
    contentToAdd = null;
    VISH.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var drawPreviewElement = function() {
    if(_validateSnapShot(contentToAdd)) {
      drawSnapShot(_wrapperSnapShot(contentToAdd));
      $.fancybox.close()
    }
  };
  var _validateSnapShot = function(object) {
    var objectInfo = VISH.Object.getObjectInfo(object);
    switch(objectInfo.wrapper) {
      case null:
        return _validateUrl(object);
        break;
      case "IFRAME":
        return _validateUrl(objectInfo.source);
        break;
      default:
        return false;
        break
    }
  };
  var _validateUrl = function(url) {
    var http_urls_pattern = /(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    if(url.match(http_urls_pattern) != null) {
      return true
    }else {
      return false
    }
  };
  var _wrapperSnapShot = function(content) {
    var objectInfo = VISH.Object.getObjectInfo(content);
    if(objectInfo.wrapper === null) {
      return"<iframe src='" + content + "'></iframe>"
    }else {
      return content
    }
  };
  var drawSnapShot = function(wrapper, area, style, scrollTop, scrollLeft) {
    var current_area;
    var object_style = "";
    if(area) {
      current_area = area
    }else {
      current_area = VISH.Editor.getCurrentArea()
    }
    if(style) {
      object_style = style
    }
    var template = V.Editor.getTemplate(current_area);
    var nextWrapperId = V.Utils.getId();
    var idToDrag = "draggable" + nextWrapperId;
    var idToResize = "resizable" + nextWrapperId;
    current_area.attr("type", "snapshot");
    var wrapperDiv = document.createElement("div");
    wrapperDiv.setAttribute("id", idToDrag);
    if(style) {
      wrapperDiv.setAttribute("style", style)
    }
    $(wrapperDiv).addClass("snapshot_wrapper");
    var iframeTag = $(wrapper);
    $(iframeTag).attr("id", idToResize);
    $(iframeTag).attr("class", "snapshot_content");
    $(iframeTag).attr("scrolling", "no");
    $(iframeTag).attr("wmode", "opaque");
    $(iframeTag).css("pointer-events", "none");
    $(current_area).html("");
    $(current_area).append(wrapperDiv);
    VISH.Editor.addDeleteButton($(current_area));
    $(wrapperDiv).append(iframeTag);
    if(scrollTop) {
      $("#" + idToDrag).scrollTop(scrollTop)
    }
    if(scrollLeft) {
      $("#" + idToDrag).scrollLeft(scrollLeft)
    }
    var width, value;
    if(style) {
      width = V.Editor.Utils.getWidthFromStyle(style, current_area);
      value = 10 * width / $(current_area).width()
    }else {
      value = 10
    }
    var mystep = $(current_area).width() / 10;
    $("#menubar").before("<div id='sliderId" + nextWrapperId + "' class='theslider'><input id='imageSlider" + nextWrapperId + "' type='slider' name='size' value='" + value + "' style='display: none; '></div>");
    $("#imageSlider" + nextWrapperId).slider({from:1, to:10, step:0.2, round:1, dimension:"x", skin:"blue", onstatechange:function(value) {
      _resizeWebIframe(idToDrag, mystep * value)
    }});
    $("#" + idToDrag).bind("mousedown", function(event) {
      event.preventDefault()
    });
    $("#" + idToDrag).draggable({cursor:"move", disabled:false, start:function(event, ui) {
      if(!_isBorderClick(event, idToDrag)) {
        return false
      }
    }})
  };
  var _isBorderClick = function(event, idToDrag) {
    var accuracy = 6;
    var scrollAccuracy = -10;
    var width = $("#" + idToDrag).width();
    var height = $("#" + idToDrag).height();
    var offset = $("#" + idToDrag).offset();
    var dif1 = event.pageX - offset.left;
    if(dif1 < accuracy) {
      return true
    }
    var dif2 = event.pageY - offset.top;
    if(dif2 < accuracy) {
      return true
    }
    var dif3 = offset.left + width - event.pageX;
    if(dif3 < scrollAccuracy) {
      return true
    }
    var dif4 = offset.top + height - event.pageY;
    if(dif4 < scrollAccuracy) {
      return true
    }
    return false
  };
  var _resizeWebIframe = function(id, width) {
    var proportion = $("#" + id).height() / $("#" + id).width();
    $("#" + id).width(width);
    $("#" + id).height(width * proportion)
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement, drawSnapShot:drawSnapShot}
}(VISH, jQuery);
VISH.Editor.Object.Web = function(V, $, undefined) {
  var contentToAdd = null;
  var urlDivId = "tab_object_from_web_content";
  var urlInputId = "object_embedWeb_code";
  var init = function() {
    var urlInput = $(urlDivId).find("input");
    $(urlInput).watermark("Paste website URL");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(VISH.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = VISH.Utils.autocompleteUrls($("#" + urlInputId).val());
        VISH.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    })
  };
  var onLoadTab = function(tab) {
    contentToAdd = null;
    VISH.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var drawPreviewElement = function() {
    VISH.Editor.Object.drawPreviewObject(contentToAdd)
  };
  var generateWrapperForWeb = function(url) {
    return"<iframe src='" + url + "?wmode=transparent'></iframe>"
  };
  var generatePreviewWrapperForWeb = function(url) {
    return"<iframe class='objectPreview' src='" + url + "'></iframe>"
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement, generatePreviewWrapperForWeb:generatePreviewWrapperForWeb, generateWrapperForWeb:generateWrapperForWeb}
}(VISH, jQuery);
VISH.Editor.Preview = function(V, $, undefined) {
  var presentation_preview;
  var forcePresentation = false;
  var prepare = function(slideNumberToPreview) {
    if(!slideNumberToPreview) {
      slideNumberToPreview = V.Slides.getCurrentSlideNumber()
    }
    if(VISH.Configuration.getConfiguration()["mode"] == "vish") {
      $("#preview_circle").attr("href", "/excursions/preview#" + slideNumberToPreview)
    }else {
      if(VISH.Configuration.getConfiguration()["mode"] == "noserver") {
        $("#preview_circle").attr("href", "/vishEditor/viewer.html#" + slideNumberToPreview)
      }else {
        if(VISH.Configuration.getConfiguration()["mode"] == "node") {
        }
      }
    }
    presentation_preview = V.Editor.savePresentation(forcePresentation)
  };
  var setForcePresentation = function(force) {
    forcePresentation = force
  };
  var getPreview = function() {
    return presentation_preview
  };
  return{prepare:prepare, getPreview:getPreview, setForcePresentation:setForcePresentation}
}(VISH, jQuery);
VISH.Editor.Quiz = function(V, $, undefined) {
  var maxNumMultipleChoiceOptions = 6;
  var choicesLetters = ["a)", "b)", "c)", "d)", "e)", "f)"];
  var init = function() {
    $(document).on("click", ".add_quiz_option", _addMultipleChoiceOption);
    $(document).on("click", ".remove_quiz_option", _removeMultipleChoiceOption);
    $(document).on("keydown", ".multiplechoice_text", _onKeyDown)
  };
  var onLoadTab = function(tab) {
  };
  var addQuiz = function(quiz_type, area) {
    switch(quiz_type) {
      case "open":
        break;
      case "multiplechoice":
        _addMultipleChoiceQuiz(area);
        VISH.Utils.loadTab("tab_quizes");
        break;
      case "truefalse":
        break;
      default:
        break
    }
    $.fancybox.close()
  };
  var drawQuiz = function(quiz_type, zone_id, question, options) {
    var zone;
    if(zone_id) {
      zone = "#" + zone_id
    }else {
      zone = ".current"
    }
    switch(quiz_type) {
      case "multiplechoice":
        $(zone).find(".value_multiplechoice_question_in_zone").parent().find("div > div").children().remove();
        $(zone).find(".value_multiplechoice_question_in_zone").parent().find("div > div").append(question);
        var inputs = $(zone).find(".multiplechoice_text_in_zone");
        for(var i = 0;i <= options.length - 1;i++) {
          $(inputs[i]).val(options[i])
        }
        break;
      case "open":
        break;
      case "truefalse":
        break;
      default:
        break
    }
  };
  var _onKeyDown = function(event) {
    if(event.keyCode == 13) {
      var target = event.target;
      if($(target).val() != "" && $(target).val() != "write quiz options here") {
        _addMultipleChoiceOption(event)
      }
    }
  };
  var _addMultipleChoiceOption = function(event, myInput, myImg, optionText) {
    var img, input;
    var optionsLength = $(".current").find(".ul_mch_options > li").length;
    if(optionsLength >= maxNumMultipleChoiceOptions) {
      return
    }
    if(event) {
      if(event.target.tagName === "INPUT") {
        img = $(event.target).parent().find("img");
        input = event.target
      }else {
        if(event.target.tagName === "IMG") {
          img = event.target;
          input = $(event.target).parent().parent().find("input")
        }
      }
    }else {
      img = myImg;
      input = myInput;
      $(input).val(optionText)
    }
    var a = $(img).parent();
    var li = $(input).parent();
    var targetChoice = $(".current").find(".ul_mch_options > li").index(li);
    var isLastChoice = targetChoice === optionsLength - 1;
    if(!isLastChoice) {
      return
    }
    $(img).attr("src", VISH.ImagesPath + "delete.png");
    $(a).removeClass().addClass("remove_quiz_option");
    $(input).blur();
    var maxChoicesReached = optionsLength == maxNumMultipleChoiceOptions - 1;
    var newMultipleChoice = _renderDummyMultipleChoice(choicesLetters[optionsLength], !maxChoicesReached);
    $(".current").find(".ul_mch_options").append(newMultipleChoice);
    $(".current").find(".ul_mch_options > li").last().find("input").focus()
  };
  var _renderDummyMultipleChoice = function(text, addImage) {
    var li = $("<li class='li_mch_option'></li>");
    $(li).append("<span class='mcChoiceSpan'>" + text + "</span>");
    $(li).append("<input type='text' class='multiplechoice_text'></input>");
    if(addImage === true) {
      $(li).append(_renderAddImg())
    }
    return li
  };
  var _renderAddImg = function() {
    var a = $("<a class='add_quiz_option'></a>");
    var addImg = $("<img src='" + VISH.ImagesPath + "add_quiz_option.png'/>");
    $(a).append(addImg);
    return a
  };
  var _removeMultipleChoiceOption = function(id) {
    var li = $(event.target).parent().parent();
    $(li).remove();
    $(".current").find(".ul_mch_options > li").each(function(index, value) {
      var span = $(value).find("span");
      $(span).html(choicesLetters[index])
    });
    var lastLi = $(".current").find(".ul_mch_options > li").last();
    var lastA = $(lastLi).find("a");
    if($(lastA).length == 0 || $(lastA).hasClass("add_quiz_option") === false) {
      $(lastLi).append(_renderAddImg())
    }
  };
  var _addMultipleChoiceQuiz = function(area) {
    var quiz = VISH.Dummies.getQuizDummy("multiplechoice", V.Slides.getSlides().length);
    if(area) {
      var current_area = $("#" + area)
    }else {
      var current_area = VISH.Editor.getCurrentArea();
      current_area.find(".menuselect_hide").remove()
    }
    current_area.attr("type", "quiz");
    current_area.append(quiz);
    V.Editor.addDeleteButton(current_area);
    launchTextEditorInTextArea(current_area, "multiplechoice")
  };
  var launchTextEditorInTextArea = function(area, type) {
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    var textArea = $(current_area).find(".value_" + type + "_question_in_zone");
    var wysiwygId = "wysiwyg_" + current_area.attr("id");
    textArea.attr("id", wysiwygId);
    textArea.addClass("wysiwygInstance");
    V.Editor.Text.getNicEditor().addInstance(wysiwygId)
  };
  return{init:init, onLoadTab:onLoadTab, drawQuiz:drawQuiz, addQuiz:addQuiz}
}(VISH, jQuery);
VISH.Editor.Renderer = function(V, $, undefined) {
  var slides = null;
  var init = function(presentation) {
    $("#presentation_title").val(presentation.title);
    $("#presentation_description").val(presentation.description);
    $("#presentation_avatar").val(presentation.avatar);
    VISH.Themes.selectTheme(presentation.theme);
    slides = presentation.slides;
    for(var i = 0;i < slides.length;i++) {
      _renderSlide(slides[i], i, presentation.id)
    }
  };
  var _renderSlide = function(slide, position, presentation_id) {
    var template = slide.template.substring(1);
    var scaffold = V.Dummies.getDummy(template, position, presentation_id, true);
    V.Editor.Utils.addSlide(scaffold);
    V.Editor.Utils.redrawSlides();
    V.Slides.lastSlide();
    for(el in slide.elements) {
      var area = $("#article_" + presentation_id + "_" + position + " div[areaid='" + slide.elements[el].areaid + "']");
      if(area.length === 0) {
        continue
      }
      if(slide.elements[el].type === "text") {
        V.Editor.Text.launchTextEditor({}, area, slide.elements[el].body)
      }else {
        if(slide.elements[el].type === "image") {
          V.Editor.Image.drawImage(slide.elements[el].body, area, slide.elements[el].style, slide.elements[el].hyperlink)
        }else {
          if(slide.elements[el].type === "video") {
            var options = [];
            options["poster"] = slide.elements[el].poster;
            options["autoplay"] = slide.elements[el].autoplay;
            var sourcesArray = [];
            $.each(JSON.parse(slide.elements[el].sources), function(index, source) {
              sourcesArray.push([source.src, source.type])
            });
            V.Editor.Video.HTML5.drawVideo(sourcesArray, options, area)
          }else {
            if(slide.elements[el].type === "object") {
              V.Editor.Object.drawObject(slide.elements[el].body, area, slide.elements[el].style, slide.elements[el].zoomInStyle)
            }else {
              if(slide.elements[el].type === "snapshot") {
                V.Editor.Object.Snapshot.drawSnapShot(slide.elements[el].body, area, slide.elements[el].style, slide.elements[el].scrollTop, slide.elements[el].scrollLeft)
              }else {
                if(slide.elements[el].type === "quiz") {
                  V.Editor.Quiz.addQuiz(slide.elements[el].quiztype, slide.elements[el].id);
                  V.Editor.Quiz.drawQuiz(slide.elements[el].quiztype, slide.elements[el].id, slide.elements[el].question, slide.elements[el].options)
                }
              }
            }
          }
        }
      }
    }
    $("div.selectable:empty").addClass("editable")
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.Text = function(V, $, undefined) {
  var myNicEditor;
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $(document).on("click", ".textthumb", launchTextEditor);
      nicEditorInit();
      initialized = true
    }
  };
  var getNicEditor = function() {
    if(!myNicEditor) {
      myNicEditor = new nicEditor;
      myNicEditor.setPanel("slides_panel")
    }
    return myNicEditor
  };
  var launchTextEditor = function(event, area, initial_text) {
    init();
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = $(this).parents(".selectable");
      var fontSize;
      switch($(current_area).attr("size")) {
        case VISH.Constant.SMALL:
          fontSize = 4;
          break;
        case VISH.Constant.MEDIUM:
          fontSize = 5;
          break;
        case VISH.Constant.LARGE:
          fontSize = 7;
          break;
        default:
          break
      }
      initial_text = "<div class='initTextDiv'><font size='" + fontSize + "''>" + VISH.Editor.I18n.getTrans("i.WysiwygInit") + "</font></div>"
    }
    getNicEditor();
    current_area.attr("type", "text");
    var wysiwygId = "wysiwyg_" + current_area.attr("id");
    var wysiwygWidth = current_area.width() - 10;
    var wysiwygHeight = current_area.height() - 10;
    current_area.html("<div class='wysiwygInstance' id=" + wysiwygId + " style='width:" + wysiwygWidth + "px; height:" + wysiwygHeight + "px;'>" + initial_text + "</div>");
    myNicEditor.addInstance(wysiwygId);
    V.Editor.addDeleteButton(current_area);
    $(".initTextDiv").click(function(event) {
      if(event.target.tagName == "FONT") {
        var font = $(event.target);
        var div = $(event.target).parent()
      }else {
        if(event.target.tagName == "DIV") {
          var div = $(event.target);
          var font = $(event.target).find("font")
        }
      }
      if($(font).text() === VISH.Editor.I18n.getTrans("i.WysiwygInit")) {
        $(font).text("");
        $(div).removeClass("initTextDiv");
        $("#" + wysiwygId).trigger("click")
      }
    })
  };
  var changeFontPropertiesToSpan = function(zone) {
    _replaceFontTag(zone);
    $(zone).find("span[style*='font-size']").each(function(index, elem) {
      var style = $(elem).attr("style");
      $(elem).attr("style", style + ";line-height: 110%;")
    });
    if($(zone).css("font-style") !== "normal") {
      $(zone).children(":first-child").css("font-style", $(zone).css("font-style"))
    }
    if($(zone).css("font-weight") !== 400) {
      $(zone).children(":first-child").css("font-weight", $(zone).css("font-weight"))
    }
    if($(zone).css("text-decoration") !== "none") {
      $(zone).children(":first-child").css("text-decoration", $(zone).css("text-decoration"))
    }
    return $(zone).html()
  };
  var _replaceFontTag = function(zone) {
    _unnestFontTagsInZone(zone);
    $(zone).find("font").each(function(index, elem) {
      var size = $(elem).attr("size");
      var sel = {"arial":"arial", "comic sans ms":"comic", "courier new":"courier", "georgia":"georgia", "helvetica":"helvetica", "impact":"impact", "times new roman":"times", "trebuchet ms":"trebuchet", "verdana":"verdana"};
      var face = sel[$(elem).attr("face")] ? sel[$(elem).attr("face")] : "Helvetica";
      var style = "";
      if($(elem).attr("color") !== undefined) {
        style += "color:" + $(elem).attr("color") + ";"
      }
      if($(elem).attr("style") !== undefined) {
        var finalstyle = "";
        var tmpstyle = $(elem).attr("style");
        var tmpindex = tmpstyle.indexOf("font-size");
        if(tmpindex !== -1) {
          var tmpsemicolon = tmpstyle.indexOf(";", tmpindex);
          finalstyle = tmpstyle.substring(0, tmpindex) + tmpstyle.substring(tmpsemicolon + 1);
          var tmpfont = tmpstyle.substring(tmpindex + 10, tmpsemicolon);
          switch(tmpfont.trim()) {
            case "xxx-large":
              size = 7;
              break;
            case "xx-large":
              size = 6;
              break;
            case "x-large":
              size = 5;
              break;
            case "large":
              size = 4;
              break;
            case "medium":
              size = 3;
              break;
            case "small":
              size = 2;
              break;
            case "x-small":
              size = 1;
              break
          }
        }else {
          finalstyle = tmpstyle
        }
        style += finalstyle + ";"
      }
      $(elem).closest("div").addClass("vish-parent-font" + size);
      $(elem).replaceWith("<span class='vish-font" + size + " vish-font" + face + "' style='" + style + "'>" + $(elem).html() + "</span>")
    })
  };
  var _unnestFontTagsInZone = function(zone) {
    $(zone).find("font").each(function(index, elem) {
      if($(elem).find("font").length >= 0) {
        _unnestFontTags(elem)
      }
    })
  };
  var _unnestFontTags = function(element) {
    var myelem = element;
    $(myelem).contents().each(function(index, elem) {
      if($(elem).find("font").length > 0) {
        _unnestFontTags(elem)
      }else {
        if(!$(elem).is("font")) {
          $(elem).wrap("<font size='" + $(myelem).attr("size") + "' style='" + $(myelem).attr("style") + "' color='" + $(myelem).attr("color") + "' face='" + $(myelem).attr("face") + "'>")
        }
      }
    });
    $(myelem).children().unwrap()
  };
  return{init:init, launchTextEditor:launchTextEditor, changeFontPropertiesToSpan:changeFontPropertiesToSpan, getNicEditor:getNicEditor}
}(VISH, jQuery);
VISH.Editor.Thumbnails = function(V, $, undefined) {
  var carrouselDivId = "slides_carrousel";
  var init = function() {
  };
  var redrawThumbnails = function() {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    var carrouselElements = 0;
    $("article").each(function(index, s) {
      var template = $(s).attr("template");
      carrouselElements += 1;
      carrouselImages.push($("<img class='image_barbutton fill_slide_button' slideNumber='" + carrouselElements + "' action='goToSlide' src='" + VISH.ImagesPath + "templatesthumbs/" + template + ".png' />"));
      carrouselImagesTitles.push(carrouselElements)
    });
    carrouselImages.push($("<img class='image_barbutton add_slide_button' action='plus' id='addslidebutton' src='" + VISH.ImagesPath + "templatesthumbs/add_slide.png' />"));
    carrouselElements += 1;
    if(carrouselElements < 8) {
      var i;
      for(i = 0 + carrouselElements;i < 8;i++) {
        carrouselImages.push($("<img class='image_barbutton empty_slide_button' action='default' src='" + VISH.ImagesPath + "templatesthumbs/default.png' />"));
        carrouselElements += 1
      }
    }
    VISH.Utils.loader.loadImagesOnCarrouselOrder(carrouselImages, _onImagesLoaded, carrouselDivId, carrouselImagesTitles)
  };
  var _onImagesLoaded = function() {
    $(".add_slide_button").hover(function() {
      $(this).attr("src", VISH.ImagesPath + "hover/add_slide.png")
    }, function() {
      $(this).attr("src", VISH.ImagesPath + "templatesthumbs/add_slide.png")
    });
    $(".barbutton").css("background-color", "transparent");
    var options = new Array;
    options["rows"] = 1;
    if(V.Editor.getPresentationType() === "flashcard") {
      options["callback"] = _onClickCarrouselElementInFlashcard
    }else {
      options["callback"] = _onClickCarrouselElement
    }
    options["rowItems"] = 8;
    options["scrollItems"] = 1;
    options["styleClass"] = "slides";
    options["width"] = 900;
    options["startAtLastElement"] = true;
    options["pagination"] = false;
    if(V.Editor.getPresentationType() === "flashcard") {
      options["afterCreateCarruselFunction"] = VISH.Editor.Flashcard.redrawPois
    }
    $("#" + carrouselDivId).show();
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options);
    if(VISH.Slides.getCurrentSlideNumber() > 0) {
      selectThumbnail(VISH.Slides.getCurrentSlideNumber())
    }
    if(V.Editor.getPresentationType() === "presentation") {
      var firstCarrouselNumber;
      $("#" + carrouselDivId).sortable({items:'div.carrousel_element_single_row_slides:has(img[action="goToSlide"])', change:function(event, ui) {
      }, start:function(event, ui) {
        firstCarrouselNumber = parseInt($($("div.carrousel_element_single_row_slides")[0]).find("img.carrousel_element_single_row_slides[slidenumber]").attr("slidenumber"))
      }, stop:function(event, ui) {
        var dragElement = ui.item;
        var img = $(ui.item).find("img.carrousel_element_single_row_slides[slidenumber]");
        if(isNaN($(img).attr("slidenumber"))) {
          return
        }
        var orgPosition = parseInt($(img).attr("slidenumber"));
        var carrouselContainer = [];
        $.each($("div.carrousel_element_single_row_slides:has(img[slidenumber])"), function(index, value) {
          carrouselContainer.push(value)
        });
        var destPosition = firstCarrouselNumber + $(carrouselContainer).index($("div.carrousel_element_single_row_slides:has(img[slidenumber='" + orgPosition + "'])"));
        var movement = null;
        if(destPosition > orgPosition) {
          movement = "after"
        }else {
          if(destPosition < orgPosition) {
            movement = "before"
          }else {
            return
          }
        }
        var slideOrg = VISH.Slides.getSlideWithNumber(orgPosition);
        var slideDst = VISH.Slides.getSlideWithNumber(destPosition);
        if(slideOrg != null && slideDst != null && movement != null) {
          VISH.Slides.moveSlideTo(slideOrg, slideDst, movement);
          var carrouselVisibleElements = 8;
          $.each($("div.carrousel_element_single_row_slides:has(img[slidenumber])"), function(index, value) {
            var slideNumber = $(value).find("img.carrousel_element_single_row_slides").attr("slidenumber");
            if(slideNumber < firstCarrouselNumber || slideNumber > firstCarrouselNumber + carrouselVisibleElements - 1) {
              return
            }else {
              var slideNumber = firstCarrouselNumber + index;
              var p = $(value).find("p.carrousel_element_single_row_slides");
              $(p).html(slideNumber);
              var img = $(value).find("img.carrousel_element_single_row_slides");
              $(img).attr("slidenumber", slideNumber)
            }
          })
        }
      }})
    }
  };
  var _onClickCarrouselElement = function(event) {
    switch($(event.target).attr("action")) {
      case "plus":
        $("#addSlideFancybox").trigger("click");
        break;
      case "goToSlide":
        VISH.Slides.goToSlide($(event.target).attr("slideNumber"));
        break;
      default:
        break
    }
  };
  var _onClickCarrouselElementInFlashcard = function(event) {
    switch($(event.target).attr("action")) {
      case "plus":
        V.Debugging.log("Show message warning that we are changing to presentation and change");
        $.fancybox($("#message2_form").html(), {"autoDimensions":false, "scrolling":"no", "width":550, "height":200, "showCloseButton":false, "padding":5});
        break;
      case "goToSlide":
        V.Slides.setCurrentSlideNumber($(event.target).attr("slideNumber"));
        V.Editor.Preview.setForcePresentation(true);
        $("img#preview_circle").trigger("click");
        break;
      default:
        break
    }
  };
  var selectThumbnail = function(no) {
    $(".image_barbutton").removeClass("selectedSlideThumbnail");
    $(".image_barbutton[slideNumber=" + no + "]").addClass("selectedSlideThumbnail")
  };
  return{init:init, redrawThumbnails:redrawThumbnails, selectThumbnail:selectThumbnail}
}(VISH, jQuery);
VISH.Editor.Tools.Menu = function(V, $, undefined) {
  var menuEventsLoaded = false;
  var init = function() {
    $("#menu").hide();
    if(!VISH.Status.getDevice().desktop) {
      if(VISH.Status.getDevice().tablet) {
        VISH.Editor.MenuTablet.init()
      }else {
        disableMenu();
        return
      }
    }
    var presentationType = VISH.Editor.getPresentationType();
    $("ul.menu_option_main").find("li").hide();
    $("ul.menu_option_main").find("a.menu_all").parent().show();
    switch(presentationType) {
      case "presentation":
        $("ul.menu_option_main").find("a.menu_presentation").parent().show();
        if(V.Editor.isPresentationStandard()) {
          $("ul.menu_option_main").find("a.menu_standard_presentation").parent().show()
        }
        break;
      case "flashcard":
        $("ul.menu_option_main").find("a.menu_flashcard").parent().show();
        break;
      case "game":
        $("ul.menu_option_main").find("a.menu_game").parent().show();
        break;
      case "quiz_simple":
        break;
      default:
        break
    }
    var menus = $("ul.menu_option_main").find("ul");
    $.each($(menus), function(index, menu) {
      var lis = $(menu).find("li");
      var visibleLis = 0;
      var lastVisibleLi = null;
      $.each($(lis), function(index, li) {
        if($(li).css("display") != "none") {
          visibleLis = visibleLis + 1;
          lastVisibleLi = li
        }
      });
      if(visibleLis == 0) {
        var liContainer = $(menu).parent();
        if($(liContainer)[0].tagName == "LI") {
          $(liContainer).hide()
        }
      }else {
        if(visibleLis == 1) {
          $(lastVisibleLi).find("a").addClass("menu_single_element")
        }
      }
      visibleLis = 0
    });
    if(!menuEventsLoaded) {
      $.each($("#menu a.menu_action"), function(index, menuButton) {
        $(menuButton).on("click", function(event) {
          event.preventDefault();
          if(typeof VISH.Editor.Tools.Menu[$(menuButton).attr("action")] == "function") {
            VISH.Editor.Tools.Menu[$(menuButton).attr("action")](this)
          }
        })
      });
      menuEventsLoaded = true
    }
    $("#menu").show();
    _initSettings();
    _initPreview()
  };
  var disableMenu = function() {
    $("#menu").hide();
    $("#menu").attr("id", "menuDisabled")
  };
  var enableMenu = function() {
    $("#menuDisabled").show();
    $("#menuDisabled").attr("id", "menu")
  };
  var initializedSettings = false;
  var _initSettings = function() {
    if(VISH.Configuration.getConfiguration()["presentationSettings"] && !VISH.Editor.hasInitialPresentation() && !initializedSettings) {
      $("a#edit_presentation_details").fancybox({"autoDimensions":false, "scrolling":"no", "width":800, "height":660, "padding":0, "hideOnOverlayClick":false, "hideOnContentClick":false, "showCloseButton":false});
      displaySettings();
      initializedSettings = true
    }else {
      $("a#edit_presentation_details").fancybox({"autoDimensions":false, "scrolling":"no", "width":800, "height":660, "padding":0, "hideOnOverlayClick":false, "hideOnContentClick":false, "showCloseButton":true})
    }
  };
  var displaySettings = function() {
    $("a#edit_presentation_details").trigger("click")
  };
  var firstSettingsCall = true;
  var onSettings = function() {
    if(firstSettingsCall) {
      $("a#edit_presentation_details").fancybox({"autoDimensions":false, "scrolling":"no", "width":800, "height":660, "padding":0, "hideOnOverlayClick":false, "hideOnContentClick":false, "showCloseButton":true})
    }
    if(VISH.Configuration.getConfiguration()["presentationTags"] && firstSettingsCall) {
      VISH.Editor.API.requestTags(_onInitialTagsReceived);
      var draftPresentation = VISH.Editor.getPresentation();
      if(draftPresentation && draftPresentation.avatar) {
        VISH.Editor.AvatarPicker.onLoadPresentationDetails(draftPresentation.avatar)
      }else {
        VISH.Editor.AvatarPicker.onLoadPresentationDetails(null)
      }
    }
  };
  var _onInitialTagsReceived = function(data) {
    var tagList = $(".tagBoxIntro .tagList");
    var draftPresentation = VISH.Editor.getPresentation();
    if($(tagList).children().length == 0) {
      if(!draftPresentation) {
      }else {
        if(draftPresentation.tags) {
          $.each(draftPresentation.tags, function(index, tag) {
            $(tagList).append("<li>" + tag + "</li>")
          })
        }
      }
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:15, maxTags:6, watermarkAllowMessage:VISH.Editor.I18n.getTrans("i.AddTags"), watermarkDenyMessage:VISH.Editor.I18n.getTrans("i.limitReached")})
    }
  };
  var onSavePresentationDetailsButtonClicked = function(event) {
    if($("#presentation_title").val().length < 1) {
      $("#presentation_details_error").slideDown("slow");
      $("#presentation_details_error").show();
      return false
    }
    var draftPresentation = VISH.Editor.getPresentation();
    if(!draftPresentation) {
      draftPresentation = {}
    }
    draftPresentation.title = $("#presentation_title").val();
    draftPresentation.description = $("#presentation_description").val();
    draftPresentation.avatar = $("#presentation_avatar").val();
    draftPresentation.tags = VISH.Utils.convertToTagsArray($("#tagindex").tagit("tags"));
    VISH.Editor.setPresentation(draftPresentation);
    $("#presentation_details_error").hide();
    $.fancybox.close()
  };
  var onSaveButtonClicked = function() {
    if(VISH.Slides.getSlides().length === 0) {
      $.fancybox($("#message1_form").html(), {"autoDimensions":false, "scrolling":"no", "width":350, "height":200, "showCloseButton":false, "padding":5})
    }else {
      if(VISH.Editor.getPresentationType() === "flashcard" && !VISH.Editor.Flashcard.hasPoiInBackground()) {
        $.fancybox($("#message3_form").html(), {"autoDimensions":false, "scrolling":"no", "width":350, "height":250, "showCloseButton":false, "padding":5})
      }else {
        if(VISH.Editor.getPresentationType() === "flashcard" && !VISH.Editor.Flashcard.hasChangedBackground()) {
          $.fancybox($("#message4_form").html(), {"autoDimensions":false, "scrolling":"no", "width":350, "height":250, "showCloseButton":false, "padding":5})
        }else {
          switch(VISH.Configuration.getConfiguration()["mode"]) {
            case VISH.Constant.NOSERVER:
              $("a[save-option-id='save']").hide();
              break;
            case VISH.Constant.VISH:
              if(VISH.Editor.isPresentationDraft()) {
                $("a[save-option-id='save']").hide()
              }else {
                $("a[save-option-id='draft']").hide();
                $("a[save-option-id='publish']").hide()
              }
              break;
            case VISH.Constant.STANDALONE:
              $("a[save-option-id='publish']").hide();
              $("a[save-option-id='draft']").hide();
              break
          }
          $.fancybox($("#save_form").html(), {"autoDimensions":false, "width":350, "scrolling":"no", "height":150, "showCloseButton":false, "padding":0, "onClosed":function() {
            var response = $("#save_answer").val();
            if(response !== "cancel") {
              $("#save_answer").val("cancel");
              var presentation = VISH.Editor.savePresentation();
              VISH.Editor.afterSavePresentation(presentation, response)
            }else {
              return false
            }
          }})
        }
      }
    }
  };
  var preview = function() {
    $("img#preview_circle").trigger("click")
  };
  var _initPreview = function() {
    $("img#preview_circle").fancybox({"width":"8", "height":"6", "autoScale":false, "transitionIn":"none", "transitionOut":"none", "type":"iframe", "onStart":function() {
      VISH.Editor.Preview.prepare(V.Slides.getCurrentSlideNumber())
    }, "onClosed":function() {
      V.Editor.Preview.setForcePresentation(false)
    }})
  };
  var help = function() {
    $("#help_right").trigger("click")
  };
  var switchToFlashcard = function() {
    if(V.Slides.getSlides().length === 0) {
      $.fancybox($("#message5_form").html(), {"autoDimensions":false, "scrolling":"no", "width":450, "height":220, "showCloseButton":false, "padding":5})
    }else {
      V.Editor.Flashcard.switchToFlashcard()
    }
  };
  var switchToPresentation = function() {
    var presentation = V.Editor.savePresentation();
    V.Editor.setPresentation(presentation);
    V.Editor.setPresentationType("presentation");
    V.Editor.Utils.showSlides();
    $("#flashcard-background").hide();
    V.Editor.Thumbnails.redrawThumbnails();
    VISH.Editor.Tools.init()
  };
  return{init:init, disableMenu:disableMenu, enableMenu:enableMenu, displaySettings:displaySettings, onSettings:onSettings, onSavePresentationDetailsButtonClicked:onSavePresentationDetailsButtonClicked, onSaveButtonClicked:onSaveButtonClicked, preview:preview, help:help, switchToFlashcard:switchToFlashcard, switchToPresentation:switchToPresentation}
}(VISH, jQuery);
VISH.Editor.Tour = function(V, $, undefined) {
  var startTourWithId = function(helpid, tipLocation) {
    V.Debugging.log("startTourWithId with help id: " + helpid + " & tipLocation " + tipLocation);
    clear();
    var loc;
    if(tipLocation === undefined) {
      loc = "top"
    }else {
      loc = tipLocation
    }
    $(window).joyride({"tipLocation":loc, "tipContent":"#" + helpid, "postRideCallback":VISH.Editor.Tour.clear})
  };
  var clear = function() {
    $(".joyride-tip-guide").each(function() {
      $(this).remove()
    })
  };
  return{clear:clear, startTourWithId:startTourWithId}
}(VISH, jQuery);
VISH.Editor.Utils = function(V, $, undefined) {
  var redrawSlides = function() {
    $(document).trigger("OURDOMContentLoaded")
  };
  var hideSlides = function() {
    $(".slides > article").addClass("temp_hidden")
  };
  var showSlides = function() {
    $(".slides > article").removeClass("temp_hidden")
  };
  var dimentionToDraw = function(w_zone, h_zone, w_content, h_content) {
    var element_type;
    var dimentions_for_drawing = {width:350, height:195};
    var aspect_ratio_zone = w_zone / h_zone;
    var aspect_ratio_content = w_content / h_content;
    if(aspect_ratio_zone > aspect_ratio_content) {
      dimentions_for_drawing.width = aspect_ratio_content * h_zone;
      dimentions_for_drawing.height = h_zone;
      return dimentions_for_drawing
    }else {
      dimentions_for_drawing.width = w_zone;
      dimentions_for_drawing.height = w_zone / aspect_ratio_content;
      return dimentions_for_drawing
    }
  };
  var addSlide = function(slide) {
    $(".slides").append(slide)
  };
  var getWidthFromStyle = function(style, area) {
    return getPixelDimensionsFromStyle(style, area)[0]
  };
  var getHeightFromStyle = function(style, area) {
    return getPixelDimensionsFromStyle(style, area)[1]
  };
  var getPixelDimensionsFromStyle = function(style, area) {
    var dimensions = [];
    var width = null;
    var height = null;
    var width_percent_pattern = /width:\s?([0-9]+(\.[0-9]+)?)%/g;
    var width_px_pattern = /width:\s?([0-9]+(\.?[0-9]+)?)px/g;
    var height_percent_pattern = /height:\s?([0-9]+(\.[0-9]+)?)%/g;
    var height_px_pattern = /height:\s?([0-9]+(\.?[0-9]+)?)px/g;
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("width") !== -1) {
        if(property.match(width_px_pattern)) {
          var result = width_px_pattern.exec(property);
          if(result[1]) {
            width = result[1]
          }
        }else {
          if(property.match(width_percent_pattern)) {
            var result = width_percent_pattern.exec(property);
            if(result[1]) {
              var percent = result[1];
              if(area) {
                width = $(area).width() * percent / 100
              }
            }
          }
        }
      }else {
        if(property.indexOf("height") !== -1) {
          if(property.match(height_px_pattern)) {
            var result = height_px_pattern.exec(property);
            if(result[1]) {
              height = result[1]
            }
          }else {
            if(property.match(height_percent_pattern)) {
              var result = height_percent_pattern.exec(property);
              if(result[1]) {
                var percent = result[1];
                if(area) {
                  height = $(area).height() * percent / 100
                }
              }
            }
          }
        }
      }
    });
    dimensions.push(width);
    dimensions.push(height);
    return dimensions
  };
  var setStyleInPixels = function(style, area) {
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("width") === -1 && property.indexOf("height") === -1) {
        filterStyle = filterStyle + property + "; "
      }
    });
    var dimensions = getPixelDimensionsFromStyle(style, area);
    if(dimensions && dimensions[0]) {
      filterStyle = filterStyle + "width: " + dimensions[0] + "px; ";
      if(dimensions[1]) {
        filterStyle = filterStyle + "height: " + dimensions[1] + "px; "
      }
    }
    return filterStyle
  };
  var addZoomToStyle = function(style, zoom) {
    if(!style) {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("-ms-transform") === -1 && property.indexOf("-moz-transform") === -1 && property.indexOf("-o-transform") === -1 && property.indexOf("-webkit-transform") === -1 && property.indexOf("-moz-transform-origin") === -1 && property.indexOf("-webkit-transform-origin") === -1 && property.indexOf("-o-transform-origin") === -1 && property.indexOf("-ms-transform-origin") === -1) {
        filterStyle = filterStyle + property + "; "
      }
    });
    if(zoom) {
      filterStyle = filterStyle + "-ms-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-ms-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-moz-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-moz-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-o-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-o-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-webkit-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-webkit-transform-origin: 0 0; "
    }
    return filterStyle
  };
  var getStylesInPercentages = function(parent, element) {
    var WidthPercent = element.width() * 100 / parent.width();
    var HeightPercent = element.height() * 100 / parent.height();
    var TopPercent = element.position().top * 100 / parent.height();
    var LeftPercent = element.position().left * 100 / parent.width();
    return"position: relative; width:" + WidthPercent + "%; height:" + HeightPercent + "%; top:" + TopPercent + "%; left:" + LeftPercent + "%;"
  };
  return{getWidthFromStyle:getWidthFromStyle, getHeightFromStyle:getHeightFromStyle, getPixelDimensionsFromStyle:getPixelDimensionsFromStyle, hideSlides:hideSlides, setStyleInPixels:setStyleInPixels, addZoomToStyle:addZoomToStyle, getStylesInPercentages:getStylesInPercentages, addSlide:addSlide, redrawSlides:redrawSlides, dimentionToDraw:dimentionToDraw, showSlides:showSlides}
}(VISH, jQuery);
VISH.Editor.Video.HTML5 = function(V, $, undefined) {
  var init = function() {
  };
  var drawVideoWithUrl = function(url) {
    drawVideo([[url, _getVideoType(url)]])
  };
  var _getVideoType = function(url) {
    var source = VISH.Object.getObjectInfo(url).source;
    return"video/" + source.split(".").pop()
  };
  var drawVideo = function(sources, options, area, style) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = VISH.Editor.getCurrentArea()
    }
    var posterUrl = "https://github.com/ging/vish_editor/raw/master/images/example_poster_image.jpg";
    var autoplay = false;
    if(options) {
      if(options["poster"]) {
        posterUrl = options["poster"]
      }
      if(options["autoplay"]) {
        autoplay = options["autoplay"]
      }
    }
    var template = VISH.Editor.getTemplate(area);
    var nextVideoId = VISH.Utils.getId();
    var idToDragAndResize = "draggable" + nextVideoId;
    current_area.attr("type", "video");
    var videoTag = document.createElement("video");
    videoTag.setAttribute("id", idToDragAndResize);
    videoTag.setAttribute("class", template + "_video");
    videoTag.setAttribute("title", "Click to drag");
    videoTag.setAttribute("controls", "controls");
    videoTag.setAttribute("preload", "metadata");
    videoTag.setAttribute("poster", posterUrl);
    videoTag.setAttribute("autoplayonslideenter", autoplay);
    if(style) {
      videoTag.setAttribute("style", style)
    }
    $(sources).each(function(index, source) {
      var videoSource = document.createElement("source");
      videoSource.setAttribute("src", source[0]);
      if(source[1]) {
        videoSource.setAttribute("type", source[1])
      }
      $(videoTag).append(videoSource)
    });
    var fallbackText = document.createElement("p");
    $(fallbackText).html("Your browser does not support HTML5 video.");
    $(videoTag).append(fallbackText);
    $(current_area).html("");
    $(current_area).append(videoTag);
    VISH.Editor.addDeleteButton($(current_area));
    var width, value;
    if(style) {
      width = V.Editor.Utils.getWidthFromStyle(style);
      value = width / 80
    }else {
      value = 4
    }
    $("#menubar").before("<div id='sliderId" + nextVideoId + "' class='theslider'><input id='imageSlider" + nextVideoId + "' type='slider' name='size' value='" + value + "' style='display: none; '></div>");
    $("#imageSlider" + nextVideoId).slider({from:1, to:8, step:0.2, round:1, dimension:"x", skin:"blue", onstatechange:function(value) {
      $("#" + idToDragAndResize).width(80 * value)
    }});
    $("#" + idToDragAndResize).draggable({cursor:"move"})
  };
  var renderVideoFromSources = function(sources) {
    var posterUrl = "https://github.com/ging/vish_editor/raw/master/images/example_poster_image.jpg";
    var rendered = "<video class='objectPreview' preload='metadata' controls='controls' poster='" + posterUrl + "' >";
    $.each(sources, function(index, source) {
      rendered = rendered + "<source src='" + source + "' " + _getVideoType(source) + ">"
    });
    rendered = rendered + "</video>";
    return rendered
  };
  return{init:init, drawVideoWithUrl:drawVideoWithUrl, drawVideo:drawVideo, renderVideoFromSources:renderVideoFromSources}
}(VISH, jQuery);
VISH.Editor.Video.Repository = function(V, $, undefined) {
  var carrouselDivId = "tab_video_repo_content_carrousel";
  var previewDivId = "tab_video_repo_content_preview";
  var currentVideos = new Array;
  var selectedVideo = null;
  var init = function() {
    var myInput = $("#tab_video_repo_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function() {
    var previousSearch = $("#tab_video_repo_content").find("input[type='search']").val() != "";
    if(!previousSearch) {
      _cleanVideoPreview();
      _requestInitialData()
    }
  };
  var _requestInitialData = function() {
    VISH.Editor.API.requestRecomendedVideos(_onDataReceived, _onAPIError)
  };
  var _requestData = function(text) {
    VISH.Editor.API.requestVideos(text, _onDataReceived, _onAPIError)
  };
  var _onDataReceived = function(data) {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    _cleanVideoPreview();
    currentVideos = new Array;
    var carrouselImages = [];
    var content = "";
    if(!data.videos || data.videos.length == 0) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'> No results found </p>");
      $("#" + carrouselDivId).show();
      return
    }
    $.each(data.videos, function(index, video) {
      if(video) {
        var myImg = $("<img src='" + video.poster + "' videoId='" + video.id + "'/>");
        carrouselImages.push(myImg);
        currentVideos[video.id] = video
      }
    });
    VISH.Utils.loader.loadImagesOnCarrousel(carrouselImages, _onImagesLoaded, carrouselDivId)
  };
  var _onImagesLoaded = function() {
    $("#" + carrouselDivId).show();
    var options = new Array;
    options["rows"] = 1;
    options["callback"] = _onClickCarrouselElement;
    options["rowItems"] = 5;
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options)
  };
  var _onAPIError = function() {
  };
  var _onClickCarrouselElement = function(event) {
    var videoId = $(event.target).attr("videoid");
    var renderedVideo = VISH.Renderer.renderVideo(currentVideos[videoId], "preview");
    _renderVideoPreview(renderedVideo, currentVideos[videoId]);
    selectedVideo = currentVideos[videoId]
  };
  var _renderVideoPreview = function(renderedVideo, video) {
    var videoArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    if(renderedVideo && video) {
      $(videoArea).append(renderedVideo);
      var table = VISH.Utils.generateTable(video.author, video.title, video.description);
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanVideoPreview = function() {
    var videoArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var addSelectedVideo = function() {
    if(selectedVideo != null) {
      var sourcesArray = [];
      var options = new Array;
      options["poster"] = selectedVideo.poster;
      var sources = selectedVideo.sources;
      if(typeof sources == "string") {
        sources = JSON.parse(sources)
      }
      $.each(sources, function(index, source) {
        sourcesArray.push([source.src, source.type])
      });
      VISH.Editor.Video.HTML5.drawVideo(sourcesArray, options);
      $.fancybox.close()
    }
  };
  return{init:init, onLoadTab:onLoadTab, addSelectedVideo:addSelectedVideo}
}(VISH, jQuery);
VISH.Editor.Video.Vimeo = function(V, $, undefined) {
  var carrouselDivId = "tab_video_vimeo_content_carrousel";
  var previewDivId = "tab_video_vimeo_content_preview";
  var queryMaxMaxNumberVimeoVideo = 20;
  var currentVideos = new Array;
  var selectedVideo = null;
  var init = function() {
    var myInput = $("#tab_video_vimeo_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        VISH.Editor.Video.Vimeo.requestVimeoData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function() {
    $("#tab_video_vimeo_content").find("input[type='search']").val("");
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    _cleanVideoPreview()
  };
  var requestVimeoData = function(text) {
    VISH.Debugging.log("enter in requestVimeoData and text's value is:" + text);
    VISH.Debugging.log("url_vimeo is :" + url_vimeo);
    jQuery.getJSON(url_vimeo, function(data) {
      _onDataReceived(data)
    })
  };
  var _onDataReceived = function(data) {
    VISH.Debugging.log("enter in _onDataReceived and data value is: " + data)
  };
  var _onImagesLoaded = function() {
  };
  var vimeo_video_pattern_1 = /https?:\/\/?youtu.be\/([aA-zZ0-9]+)/g;
  var vimeo_video_pattern_2 = /(https?:\/\/)?(www.youtube.com\/watch\?v=|embed\/)([aA-z0-9Z]+)[&=.]*/g;
  var _getYoutubeIdFromURL = function(url) {
  };
  var addSelectedVideo = function() {
  };
  var onClickCarrouselElement = function(event) {
  };
  var _renderVideoPreview = function(renderedIframe, video) {
  };
  var _cleanVideoPreview = function() {
  };
  var _generateWrapper = function(videoId) {
  };
  var generateWrapperForYoutubeVideoUrl = function(url) {
  };
  return{init:init, onLoadTab:onLoadTab, requestVimeoData:requestVimeoData}
}(VISH, jQuery);
VISH.Editor.Video.Youtube = function(V, $, undefined) {
  var carrouselDivId = "tab_video_youtube_content_carrousel";
  var previewDivId = "tab_video_youtube_content_preview";
  var queryMaxMaxNumberYoutubeVideo = 20;
  var currentVideos = new Array;
  var selectedVideo = null;
  var init = function() {
    var myInput = $("#tab_video_youtube_content").find("input[type='search']");
    $(myInput).watermark(VISH.Editor.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        VISH.Editor.Video.Youtube.requestYoutubeData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var onLoadTab = function() {
    $("#tab_video_youtube_content").find("input[type='search']").val("");
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    _cleanVideoPreview()
  };
  var requestYoutubeData = function(text) {
    var url_youtube = "http://gdata.youtube.com/feeds/api/videos?q=" + text + "&alt=json-in-script&callback=?&max-results=" + queryMaxMaxNumberYoutubeVideo + "&start-index=1";
    jQuery.getJSON(url_youtube, function(data) {
      _onDataReceived(data)
    })
  };
  var _onDataReceived = function(data) {
    VISH.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide();
    _cleanVideoPreview();
    currentVideos = new Array;
    var carrouselImages = [];
    var content = "";
    if(!data.feed || data.feed.length == 0 || !data.feed.entry) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'> No results found </p>");
      $("#" + carrouselDivId).show();
      return
    }
    $.each(data.feed.entry, function(i, item) {
      var video = item["id"]["$t"];
      var title = item["title"]["$t"];
      var author = item.author[0].name.$t;
      var subtitle = item.media$group.media$description.$t;
      video = video.replace("http://gdata.youtube.com/feeds/api/videos/", "http://www.youtube.com/watch?v=");
      var videoID = video.replace("http://www.youtube.com/watch?v=", "");
      currentVideos[videoID] = new Object;
      currentVideos[videoID].id = videoID;
      currentVideos[videoID].title = title;
      currentVideos[videoID].author = author;
      currentVideos[videoID].subtitle = subtitle;
      var image_url = "http://img.youtube.com/vi/" + videoID + "/0.jpg";
      var myImg = $("<img videoID=" + videoID + " src=" + image_url + " />");
      carrouselImages.push(myImg)
    });
    VISH.Utils.loader.loadImagesOnCarrousel(carrouselImages, _onImagesLoaded, carrouselDivId)
  };
  var _onImagesLoaded = function() {
    $("#" + carrouselDivId).show();
    var options = new Array;
    options["rows"] = 1;
    options["callback"] = VISH.Editor.Video.Youtube.onClickCarrouselElement;
    options["rowItems"] = 5;
    VISH.Editor.Carrousel.createCarrousel(carrouselDivId, options)
  };
  var _getYoutubeIdFromURL = function(url) {
    var youtube_video_pattern_1 = /https?:\/\/?youtu.be\/([aA-zZ0-9]+)/g;
    var youtube_video_pattern_2 = /(https?:\/\/)?(www.youtube.com\/watch\?v=|embed\/)([aA-z0-9Z]+)[&=.]*/g;
    var id = null;
    if(url.match(youtube_video_pattern_1) != null) {
      var result = youtube_video_pattern_1.exec(url);
      if(result && result[1]) {
        id = result[1]
      }
      return id
    }
    if(url.match(youtube_video_pattern_2) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_2.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    return id
  };
  var addSelectedVideo = function() {
    if(selectedVideo != null) {
      VISH.Editor.Object.drawObject(_generateWrapper(selectedVideo.id));
      $.fancybox.close()
    }
  };
  var onClickCarrouselElement = function(event) {
    var videoId = $(event.target).attr("videoID");
    var renderedPreviewVideo = _generatePreviewWrapper(videoId);
    _renderVideoPreview(renderedPreviewVideo, currentVideos[videoId]);
    selectedVideo = currentVideos[videoId]
  };
  var _renderVideoPreview = function(renderedIframe, video) {
    var videoArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    if(renderedIframe && video) {
      $(videoArea).append(renderedIframe);
      var table = VISH.Utils.generateTable(video.author, video.title, video.description);
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanVideoPreview = function() {
    var videoArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var _generateWrapper = function(videoId) {
    var video_embedded = "http://www.youtube.com/embed/" + videoId;
    current_area = VISH.Editor.getCurrentArea();
    var width_height = VISH.Editor.Utils.dimentionToDraw(current_area.width(), current_area.height(), 325, 243);
    var wrapper = "<iframe src='" + video_embedded + "?wmode=opaque' frameborder='0' style='width:" + width_height.width + "px; height:" + width_height.height + "px;'></iframe>";
    return wrapper
  };
  var generateWrapperForYoutubeVideoUrl = function(url) {
    var videoId = _getYoutubeIdFromURL(url);
    if(videoId != null) {
      return _generateWrapper(videoId)
    }else {
      return"Youtube Video ID can't be founded."
    }
  };
  var _generatePreviewWrapper = function(videoId) {
    var video_embedded = "http://www.youtube.com/embed/" + videoId;
    var wrapper = '<iframe class="objectPreview" type="text/html" src="' + video_embedded + '?wmode=opaque" frameborder="0"></iframe>';
    return wrapper
  };
  var generatePreviewWrapperForYoutubeVideoUrl = function(url) {
    var videoId = _getYoutubeIdFromURL(url);
    if(videoId != null) {
      return _generatePreviewWrapper(videoId)
    }else {
      return"<p class='objectPreview'>Youtube Video ID can't be founded.</p>"
    }
  };
  return{init:init, onLoadTab:onLoadTab, onClickCarrouselElement:onClickCarrouselElement, requestYoutubeData:requestYoutubeData, addSelectedVideo:addSelectedVideo, generateWrapperForYoutubeVideoUrl:generateWrapperForYoutubeVideoUrl, generatePreviewWrapperForYoutubeVideoUrl:generatePreviewWrapperForYoutubeVideoUrl}
}(VISH, jQuery);
VISH.Events.Mashme = function(V, $, undefined) {
  var addedEventListeners = false;
  var MASHME_API_SCRIPT_URL = "https://mashme.tv/static/js/iframe/MashMe.API.iFrame.js";
  var MASHME_HELLO = "MASHMETV_HELLO";
  var GO_TO_SLIDE = "GO_TO_SLIDE";
  var FC_POI_CLICK = "FC_POI_CLICK";
  var FC_CLOSE_SLIDE = "FC_CLOSE_SLIDE";
  var onMashmeHello = function(message) {
    if(message.data === MASHME_HELLO) {
      window.removeEventListener("message", V.Slides.onMashmeHello, false);
      V.Events.unbindAllEventListeners();
      init()
    }else {
    }
  };
  var init = function() {
    $.getScript(MASHME_API_SCRIPT_URL).done(function(script, textStatus) {
      MASHME.API.iFrame.init("myappkey", "myappsecret", _onMashmeMessage)
    });
    addEventListeners()
  };
  var addEventListeners = function() {
    if(!addedEventListeners) {
      if(V.SlideManager.getPresentationType() === "presentation") {
        $(document).bind("keydown", handleBodyKeyDown);
        $(document).on("click", "#page-switcher-start", "back", _sendSlideNumber);
        $(document).on("click", "#page-switcher-end", "forward", _sendSlideNumber)
      }else {
        if(V.SlideManager.getPresentationType() === "flashcard") {
          var presentation = V.SlideManager.getCurrentPresentation();
          for(index in presentation.background.pois) {
            var poi = presentation.background.pois[index];
            $(document).on("click", "#" + poi.id, {slide_id:poi.slide_id}, _sendFlashcardPoiClicked)
          }
          $(document).on("click", ".close_slide", _sendFlashcardCloseSlideClicked)
        }
      }
      addedEventListeners = true
    }
  };
  var handleBodyKeyDown = function(event) {
    var click = {};
    switch(event.keyCode) {
      case 39:
      ;
      case 40:
        if(V.Slides.isSlideFocused()) {
          click.data = "forward";
          _sendSlideNumber(click);
          event.preventDefault()
        }
        break;
      case 37:
      ;
      case 38:
        if(V.Slides.isSlideFocused()) {
          click.data = "back";
          _sendSlideNumber(click);
          event.preventDefault()
        }
        break
    }
  };
  var _sendSlideNumber = function(click) {
    var slideNumber = VISH.Slides.getCurrentSlideNumber();
    if(click && click.data === "back") {
      slideNumber -= 1
    }else {
      slideNumber += 1
    }
    _sendMessage(GO_TO_SLIDE, slideNumber)
  };
  var _sendFlashcardPoiClicked = function(event) {
    V.Debugging.log("Show slide " + event.data.slide_id);
    _sendMessage(FC_POI_CLICK, event.data.slide_id)
  };
  var _sendFlashcardCloseSlideClicked = function(event) {
    var close_slide = event.target.id.substring(5);
    V.Debugging.log("Close slide " + close_slide);
    _sendMessage(FC_CLOSE_SLIDE, close_slide)
  };
  var _sendMessage = function(message, params) {
    V.Debugging.log("Enviando:" + message + " params:" + params);
    MASHME.API.iFrame.broadcast("MashMeAPIMessage:" + message + "//" + params)
  };
  var _onMashmeMessage = function(message) {
    var command = message.data.substring(message.data.indexOf(":") + 1, message.data.indexOf("//"));
    var data = message.data.substring(message.data.indexOf("//") + 2);
    switch(command) {
      case GO_TO_SLIDE:
        V.Debugging.log("Message GO_TO_SLIDE: " + data);
        V.Slides.goToSlide(data);
        break;
      case FC_POI_CLICK:
        V.Debugging.log("Message FC_POI_CLICK: " + data);
        V.Slides.closeAllSlides();
        V.Slides.showSlide(data);
        break;
      case FC_CLOSE_SLIDE:
        V.Debugging.log("Message FC_CLOSE_SLIDE: " + data);
        V.Slides.closeSlide(data);
        break;
      default:
        V.Debugging.log("WARNING: Message not known " + message)
    }
  };
  return{init:init, onMashmeHello:onMashmeHello}
}(VISH, jQuery);
VISH.Events.Notifier = function(V, $, undefined) {
  var listeners;
  var init = function() {
    listeners = new Array
  };
  var registerCallback = function(listenedEvent, callback) {
    if(listenedEvent in listeners) {
      listeners[listenedEvent].push(callback)
    }else {
      listeners[listenedEvent] = [];
      listeners[listenedEvent].push(callback);
      if(listenedEvent == VISH.Constant.Event.onMessage) {
        VISH.Messenger.init()
      }
    }
  };
  var unRegisterCallback = function(listenedEvent, callback) {
    if(listenedEvent in listeners) {
      if(listeners[listenedEvent].indexOf(callback) !== -1) {
        listeners[listenedEvent].splice(listeners[listenedEvent].indexOf(callback), 1)
      }
    }
  };
  var notifyEvent = function(triggeredEvent, params, triggeredByUser) {
    if(!listeners) {
      return
    }
    params = params || {};
    params.triggeredByUser = !(triggeredByUser === false);
    var eventListeners = listeners[triggeredEvent];
    if(eventListeners) {
      for(var i = 0;i < eventListeners.length;i++) {
        eventListeners[i](params)
      }
    }
  };
  return{init:init, notifyEvent:notifyEvent, registerCallback:registerCallback, unRegisterCallback:unRegisterCallback}
}(VISH, jQuery);
VISH.Flashcard.Arrow = function(V, $, undefined) {
  var FPS = 25;
  var TOTAL_FRAMES = 20;
  var FRAME_WIDTH = 50;
  var arrow_ids = [];
  var arrow_positions = [];
  var init = function() {
    setTimeout(_animateArrows, 1E3 / FPS)
  };
  var addArrow = function(poi, sync) {
    var flashcard_div = $("#flashcard-background");
    var div_to_add = "<div class='fc_poi' id='" + poi.id + "' style='position:absolute;left:" + poi.x + "%;top:" + poi.y + "%'></div>";
    flashcard_div.append(div_to_add);
    if(arrow_ids.indexOf(poi.id) == -1) {
      arrow_ids.push(poi.id);
      if(sync) {
        arrow_positions.push(0)
      }else {
        var rand_pos = Math.floor(Math.random() * TOTAL_FRAMES + 1) * FRAME_WIDTH;
        arrow_positions.push(rand_pos)
      }
    }
  };
  var _animateArrows = function() {
    for(index in arrow_ids) {
      var id = arrow_ids[index];
      var pos = arrow_positions[index];
      var new_pos = (pos + FRAME_WIDTH) % (TOTAL_FRAMES * FRAME_WIDTH);
      $("#" + id).css("background-position", new_pos + "px" + " 0px");
      arrow_positions[index] = new_pos
    }
    setTimeout(_animateArrows, 1E3 / FPS)
  };
  return{init:init, addArrow:addArrow}
}(VISH, jQuery);
VISH.Game = function(V, $, undefined) {
  var actions = {};
  var registerActions = function(presentation) {
    actions = presentation.game.actions
  };
  var raiseAction = function(action_name) {
    if(actions[action_name]) {
      V.Debugging.log("show slide " + actions[action_name].slide_id)
    }
  };
  return{raiseAction:raiseAction, registerActions:registerActions}
}(VISH, jQuery);
var VISH = VISH || {};
VISH.Constant = {};
VISH.Constant.Event = {};
VISH.Constant.Event.onMessage = "onMessage";
VISH.Constant.Event.onGoToSlide = "onGoToSlide";
VISH.Constant.Event.onPlayVideo = "onPlayVideo";
VISH.Constant.Event.onPauseVideo = "onPauseVideo";
VISH.Constant.Event.onSeekVideo = "onSeekVideo";
VISH.Constant.Event.onSetSlave = "onSetSlave";
VISH.Constant.Event.onPreventDefault = "onPreventDefault";
VISH.Constant.Event.onIframeMessengerHello = "onIframeMessengerHello";
VISH.IframeAPI = function(V, undefined) {
  var helloAttempts;
  var maxHelloAttempts = 15;
  var helloTimeout;
  var options;
  var listeners;
  var init = function(initOptions) {
    options = initOptions;
    if(window.addEventListener) {
      window.addEventListener("message", _onWrapperedVEMessage, false)
    }else {
      if(el.attachEvent) {
        window.attachEvent("message", _onWrapperedVEMessage)
      }
    }
    listeners = new Array;
    _startHelloExchange()
  };
  var _startHelloExchange = function() {
    registerCallback(VISH.Constant.Event.onIframeMessengerHello, function(origin) {
      if(helloTimeout) {
        clearTimeout(helloTimeout)
      }
      _applyOptions(origin);
      if(options && typeof options.callback === "function") {
        options.callback(origin)
      }
    });
    helloAttempts = 0;
    helloTimeout = setInterval(function() {
      _sayHello()
    }, 1E3);
    _sayHello()
  };
  var _sayHello = function() {
    var helloMessage = _createMessage(VISH.Constant.Event.onIframeMessengerHello);
    sendMessage(helloMessage, "*");
    helloAttempts++;
    if(helloAttempts >= maxHelloAttempts && helloTimeout) {
      clearTimeout(helloTimeout)
    }
  };
  var _sendPreventDefaults = function(preventDefaults, destination) {
    var params = {};
    params.preventDefaults = preventDefaults;
    var VEMessage = _createMessage(VISH.Constant.Event.onPreventDefault, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var _applyOptions = function(destination) {
    if(options) {
      if(options.preventDefault === true) {
        _sendPreventDefaults(true, destination)
      }
    }
  };
  var registerCallback = function(listenedEvent, callback) {
    if(callback) {
      listeners[listenedEvent] = callback
    }
  };
  var unRegisterCallback = function(listenedEvent) {
    if(listenedEvent in listeners) {
      listeners[listenedEvent] = null
    }
  };
  function message(VEevent, params, origin, destination) {
    this.vishEditor = true;
    this.VEevent = VEevent;
    if(params) {
      this.params = params
    }
    if(origin) {
      this.origin = origin
    }else {
      this.origin = "?"
    }
    if(destination) {
      this.destination = destination
    }else {
      this.destination = "*"
    }
  }
  var _createMessage = function(VEevent, params, origin, destination) {
    var VEMessage = new message(VEevent, params, origin, destination);
    return JSON.stringify(VEMessage)
  };
  var _validateVEMessage = function(VEMessage) {
    if(typeof VEMessage !== "string") {
      return false
    }
    try {
      var VEMessageObject = JSON.parse(VEMessage);
      if(typeof VEMessageObject !== "object") {
        return false
      }
      if(VEMessageObject.vishEditor !== true) {
        return false
      }
      if(!VEMessageObject.VEevent) {
        return false
      }
    }catch(e) {
      return false
    }
    return true
  };
  var sendMessage = function(VEMessage, destination) {
    if(typeof destination === "string") {
      if(destination === "*") {
        _broadcastMessage(VEMessage)
      }else {
        var iframe = document.getElementById(destination);
        if(iframe && iframe.contentWindow) {
          iframe.contentWindow.postMessage(VEMessage, "*")
        }
      }
    }else {
      if(_isArray(destination) && typeof destination[0] == "string") {
        for(var i = 0;i < destination.length;i++) {
          var iframe = document.getElementById(destination[i]);
          if(iframe && iframe.contentWindow) {
            iframe.contentWindow.postMessage(VEMessage, "*")
          }
        }
      }else {
        _broadcastMessage(VEMessage)
      }
    }
  };
  var _broadcastMessage = function(VEMessage) {
    var allVEIframes = document.querySelectorAll(".vishEditorIframe");
    for(var i = 0;i < allVEIframes.length;i++) {
      allVEIframes[i].contentWindow.postMessage(VEMessage, "*")
    }
  };
  var _onWrapperedVEMessage = function(wrapperedVEMessage) {
    if(wrapperedVEMessage) {
      if(_validateVEMessage(wrapperedVEMessage.data)) {
        _processVEMessage(wrapperedVEMessage.data)
      }
    }
  };
  var _processVEMessage = function(VEMessage) {
    var VEMessageObject = JSON.parse(VEMessage);
    if(listeners[VISH.Constant.Event.onMessage]) {
      listeners[VISH.Constant.Event.onMessage](VEMessage, VEMessageObject.origin)
    }
    var callback = listeners[VEMessageObject.VEevent];
    if(!callback) {
      return
    }
    switch(VEMessageObject.VEevent) {
      case VISH.Constant.Event.onGoToSlide:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onPlayVideo:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onPauseVideo:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onSeekVideo:
        if(VEMessageObject.params) {
          callback(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, VEMessageObject.params.slideNumber, VEMessageObject.origin)
        }
        break;
      case VISH.Constant.Event.onIframeMessengerHello:
        callback(VEMessageObject.origin);
        break;
      default:
        _print("VISH.Messenger.Proceesor Error: Unrecognized event: " + VEMessageObject.VEevent);
        break
    }
  };
  var goToSlide = function(slideNumber, destination) {
    var params = {};
    params.slideNumber = slideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onGoToSlide, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var playVideo = function(videoId, currentTime, videoSlideNumber, destination) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onPlayVideo, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var pauseVideo = function(videoId, currentTime, videoSlideNumber, destination) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onPauseVideo, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var seekVideo = function(videoId, currentTime, videoSlideNumber, destination) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createMessage(VISH.Constant.Event.onSeekVideo, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var setSlave = function(slave, destination) {
    var params = {};
    params.slave = slave;
    var VEMessage = _createMessage(VISH.Constant.Event.onSetSlave, params, null, destination);
    sendMessage(VEMessage, destination)
  };
  var setMaster = function(master) {
    var params = {};
    var allVEIframes = document.querySelectorAll(".vishEditorIframe");
    for(var i = 0;i < allVEIframes.length;i++) {
      if(allVEIframes[i].id !== master) {
        params.slave = true
      }else {
        params.slave = false
      }
      var destination = allVEIframes[i].id;
      var VEMessage = _createMessage(VISH.Constant.Event.onSetSlave, params, null, destination);
      sendMessage(VEMessage, destination)
    }
  };
  var _print = function(objectToPrint) {
    if(console && console.log) {
      console.log(objectToPrint)
    }
  };
  var _isArray = function(object) {
    if(typeof object !== "undefined") {
      return object.constructor === Array
    }
    return false
  };
  return{init:init, registerCallback:registerCallback, unRegisterCallback:unRegisterCallback, sendMessage:sendMessage, setSlave:setSlave, setMaster:setMaster, goToSlide:goToSlide, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo}
}(VISH);
VISH.LocalStorage = function(V, $, undefined) {
  var addPresentation = function(presentation) {
    if(typeof Storage !== "undefined") {
      var list = localStorage.getItem("presentation_list") ? JSON.parse(localStorage.getItem("presentation_list")) : new Array;
      if($.inArray(presentation.id, list) === -1) {
        list.push(presentation.id);
        localStorage.setItem("presentation_list", JSON.stringify(list))
      }
      localStorage.setItem("presentation_" + presentation.id, JSON.stringify(presentation))
    }else {
      V.Debugging.log("Sorry! No web storage support.")
    }
  };
  return{addPresentation:addPresentation}
}(VISH, jQuery);
VISH.Messenger.Helper = function(V, undefined) {
  function message(VEevent, params, origin, destination) {
    this.vishEditor = true;
    this.VEevent = VEevent;
    if(params) {
      this.params = params
    }
    if(origin) {
      this.origin = origin
    }else {
      this.origin = "?"
    }
    if(destination) {
      this.destination = destination
    }else {
      this.destination = "*"
    }
  }
  var createMessage = function(VEevent, params, origin, destination) {
    if(!origin) {
      if(VISH.Status.getIsInIframe()) {
        origin = VISH.Status.getIframe().id
      }
    }
    var VEMessage = new message(VEevent, params, origin, destination);
    return JSON.stringify(VEMessage)
  };
  var validateVEMessage = function(VEMessage, params) {
    if(typeof VEMessage !== "string") {
      return false
    }
    try {
      var VEMessageObject = JSON.parse(VEMessage);
      if(typeof VEMessageObject !== "object") {
        return false
      }
      if(VEMessageObject.vishEditor !== true) {
        return false
      }
      if(!VEMessageObject.VEevent) {
        return false
      }
      if(VISH.Status.getIsInIframe() && params && params.allowSelfMessages === false) {
        if(VEMessageObject.origin === VISH.Status.getIframe().id) {
          return false
        }
      }
    }catch(e) {
      return false
    }
    return true
  };
  var processVEMessage = function(VEMessage) {
    var VEMessageObject = JSON.parse(VEMessage);
    switch(VEMessageObject.VEevent) {
      case VISH.Constant.Event.onGoToSlide:
        if(VEMessageObject.params && VEMessageObject.params.slideNumber) {
          VISH.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
        }
        break;
      case VISH.Constant.Event.onPlayVideo:
        if(VEMessageObject.params && VEMessageObject.params.videoId) {
          if(VEMessageObject.params.slideNumber && VISH.Slides.getCurrentSlideNumber() != VEMessageObject.params.slideNumber) {
            VISH.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
          }
          VISH.VideoPlayer.playVideo(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, false)
        }
        break;
      case VISH.Constant.Event.onPauseVideo:
        if(VEMessageObject.params && VEMessageObject.params.videoId) {
          if(VEMessageObject.params.slideNumber && VISH.Slides.getCurrentSlideNumber() != VEMessageObject.params.slideNumber) {
            VISH.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
          }
          VISH.VideoPlayer.pauseVideo(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, false)
        }
        break;
      case VISH.Constant.Event.onSeekVideo:
        if(VEMessageObject.params && VEMessageObject.params.videoId) {
          if(VEMessageObject.params.slideNumber && VISH.Slides.getCurrentSlideNumber() != VEMessageObject.params.slideNumber) {
            VISH.Slides.goToSlide(VEMessageObject.params.slideNumber, false)
          }
          VISH.VideoPlayer.seekVideo(VEMessageObject.params.videoId, VEMessageObject.params.currentTime, false)
        }
        break;
      case VISH.Constant.Event.onSetSlave:
        if(VEMessageObject.params && typeof VEMessageObject.params.slave != "undefined") {
          VISH.Status.setSlaveMode(VEMessageObject.params.slave)
        }
        break;
      case VISH.Constant.Event.onPreventDefault:
        if(VEMessageObject.params && typeof VEMessageObject.params.preventDefaults != "undefined") {
          VISH.Status.setPreventDefaultMode(VEMessageObject.params.preventDefaults)
        }
        break;
      default:
        VISH.Debugging.log("VISH.Messenger.Proceesor Error: Unrecognized event: " + VEMessageObject.VEevent);
        break
    }
  };
  return{createMessage:createMessage, processVEMessage:processVEMessage, validateVEMessage:validateVEMessage}
}(VISH, jQuery);
VISH.Object = function(V, $, undefined) {
  var init = function() {
  };
  function objectInfo(wrapper, source, sourceType) {
    this.wrapper = wrapper;
    this.source = source;
    this.type = sourceType
  }
  var getObjectInfo = function(object) {
    var wrapper = null;
    var element = $(object)[0];
    if(typeof element != "undefined") {
      var wrapper = element.tagName
    }
    var source = _getSourceFromObject(object, wrapper);
    var type = _getTypeFromSource(source);
    return new objectInfo(wrapper, source, type)
  };
  var _getSourceFromObject = function(object, wrapper) {
    switch(wrapper) {
      case null:
        return object;
      case "EMBED":
        return $(object).attr("src");
      case "OBJECT":
        if(typeof $(object).attr("src") != "undefined") {
          return $(object).attr("src")
        }
        if(typeof $(object).attr("data") != "undefined") {
          return $(object).attr("data")
        }
        return"source not founded";
      case "IFRAME":
        return $(object).attr("src");
      default:
        VISH.Debugging.log("Unrecognized object wrapper: " + wrapper);
        return null;
        break
    }
  };
  var _getTypeFromSource = function(source) {
    var http_urls_pattern = /(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    var www_urls_pattern = /(www[.])([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    var youtube_video_pattern = /(http(s)?:\/\/)?(((youtu.be\/)([aA-zZ0-9]+))|((www.youtube.com\/((watch\?v=)|(embed\/)))([aA-z0-9Z&=.])+))/g;
    var html5VideoFormats = ["mp4", "webm", "ogg"];
    var imageFormats = ["jpg", "jpeg", "png", "gif", "bmp"];
    if(typeof source != "string") {
      return null
    }
    if(source.match(youtube_video_pattern) != null) {
      return"youtube"
    }
    source = source.split("?")[0];
    var extension = source.split(".").pop().toLowerCase();
    if(imageFormats.indexOf(extension) != "-1") {
      return"image"
    }
    if(extension == "swf") {
      return"swf"
    }
    if(extension == "pdf") {
      return"pdf"
    }
    if(html5VideoFormats.indexOf(extension) != "-1") {
      return"HTML5"
    }
    if(source.match(http_urls_pattern) != null || source.match(www_urls_pattern) != null) {
      return"web"
    }
    return extension
  };
  return{init:init, getObjectInfo:getObjectInfo}
}(VISH, jQuery);
VISH.ObjectPlayer = function() {
  var loadObject = function(element) {
    $.each(element.children(".objectelement"), function(index, value) {
      if($(value).hasClass("youtubeelement")) {
        VISH.VideoPlayer.Youtube.loadYoutubeObject(element, value);
        return
      }
      if($(value).attr("objectWrapper").match("^<iframe") !== null && VISH.Status.getOnline() === false) {
        $(value).html("<img src='" + VISH.ImagesPath + "/advert_new_grey.png'/>");
        return
      }
      var object = $($(value).attr("objectWrapper"));
      $(object).attr("style", $(value).attr("zoomInStyle"));
      $(value).html("<div style='" + $(value).attr("objectStyle") + "'>" + VISH.Utils.getOuterHTML(object) + "</div>");
      adjustDimensionsAfterZoom($($(value).children()[0]).children()[0])
    })
  };
  var unloadObject = function() {
    var element = $(".past, .next");
    $.each(element.children(".objectelement"), function(index, value) {
      $(value).html("")
    })
  };
  var aftersetupSize = function() {
    if($(".current").hasClass("object")) {
      loadObject($(".current"))
    }
  };
  var adjustDimensionsAfterZoom = function(objectWithZoom) {
    var parent = $(objectWithZoom).parent();
    var zoom = VISH.Utils.getZoomFromStyle($(objectWithZoom).attr("style"));
    $(objectWithZoom).height($(parent).height() / zoom);
    $(objectWithZoom).width($(parent).width() / zoom)
  };
  return{loadObject:loadObject, unloadObject:unloadObject, aftersetupSize:aftersetupSize, adjustDimensionsAfterZoom:adjustDimensionsAfterZoom}
}(VISH, jQuery);
VISH.Police = function(V, $, undefined) {
  var init = function() {
  };
  var valid_url_pattern = /((http(s)?:\/\/)|(www[.]))(.*)/g;
  var validateObject = function(object, callback) {
    if(!object) {
      return[false, "Object is null or undefined"]
    }
    if(typeof object == "string" && object.trim() == "") {
      return[false, "Object is an empty string"]
    }
    var objectInfo = VISH.Object.getObjectInfo(object);
    if(!objectInfo) {
      return[false, "Can't get Object info"]
    }
    if(!objectInfo.source || !objectInfo.type) {
      return[false, "Can't recognize object source"]
    }
    if(objectInfo.source.trim() == "") {
      return[false, "Object source is an empty string"]
    }
    if(typeof callback == "function") {
      _validateUrl(objectInfo.source, callback)
    }
    return[true, "Validation Ok"]
  };
  function _validateUrl(url, callback) {
    _checkUrl(url, function(status) {
      if(status === 404) {
        callback([false, "HTTP 404: Not found"])
      }else {
        callback([true, "Validation Ok"])
      }
    })
  }
  function _checkUrl(url, cb) {
    jQuery.ajax({url:url, dataType:"text", type:"GET", complete:function(xhr) {
      if(typeof cb === "function") {
        cb.apply(this, [xhr.status])
      }
    }})
  }
  var validateFileUpload = function(fileName) {
    if(!fileName) {
      return[false, "Name is null or undefined"]
    }
    if(fileName.trim() == "") {
      return[false, "Name is an empty string"]
    }
    return[true, "Validation Ok"]
  };
  return{init:init, validateObject:validateObject, validateFileUpload:validateFileUpload}
}(VISH, jQuery);
VISH.Presentation = function(V, undefined) {
  var mySlides = null;
  var init = function(slides) {
    mySlides = slides;
    V.Renderer.init();
    for(var i = 0;i < slides.length;i++) {
      V.Renderer.renderSlide(slides[i])
    }
    _finishRenderer()
  };
  var _finishRenderer = function() {
    V.VideoPlayer.HTML5.setVideoEvents();
    V.SlideManager.addEnterLeaveEvents();
    var evt = document.createEvent("Event");
    evt.initEvent("OURDOMContentLoaded", false, true);
    document.dispatchEvent(evt)
  };
  return{init:init}
}(VISH);
VISH.Quiz.API = function(V, $, undefined) {
  var init = function() {
  };
  var postStartQuizSession = function(quizId, successCallback, failCallback) {
    if(VISH.Configuration.getConfiguration()["mode"] == "vish") {
      var send_type = "POST";
      var params = {"quiz_id":quizId, "authenticity_token":V.User.getToken()};
      $.ajax({type:send_type, url:"http://" + window.location.host + "/quiz_sessions", data:params, success:function(data) {
        var quiz_session_id = data;
        if(typeof successCallback == "function") {
          successCallback(quiz_session_id)
        }
      }, error:function(error) {
        failCallback(error)
      }});
      return null
    }else {
      if(VISH.Configuration.getConfiguration()["mode"] == "noserver") {
        V.Debugging.log("No server case");
        if(quizId == 12) {
          var quiz_session_id = "98988"
        }else {
          if(quizId == 13) {
            var quiz_session_id = "98955"
          }
        }
        if(typeof successCallback == "function") {
          successCallback(quiz_session_id)
        }
      }
    }
  };
  var deleteQuizSession = function(quiz_session_id, successCallback, failCallback, quiz_name) {
    if(VISH.Configuration.getConfiguration()["mode"] == "vish") {
      V.Debugging.log("quiz_session_id to delete is: " + quiz_session_id);
      V.Debugging.log("quiz_name (if save) is: " + quiz_name);
      var quizName;
      if(quiz_name) {
        quizName = quiz_name
      }else {
        quizName = ""
      }
      var send_type = "DELETE";
      V.Debugging.log("token is: " + V.User.getToken());
      var params = {"id":quiz_session_id, "authenticity_token":V.User.getToken(), "name":quizName};
      $.ajax({type:send_type, url:"http://" + window.location.host + "/quiz_sessions/" + quiz_session_id, data:params, success:function(data) {
        var results = data;
        if(typeof successCallback == "function") {
          successCallback(results)
        }
      }, error:function(error) {
        failCallback(error)
      }});
      return null
    }else {
      if(VISH.Configuration.getConfiguration()["mode"] == "noserver") {
        V.Debugging.log("No server case");
        var results = {"quiz_session_id":19, "quiz_id":3, "results":{"b":4, "a":2, "c":1, "d":1}};
        if(typeof successCallback == "function") {
          successCallback(results)
        }
      }
    }
  };
  var putQuizSession = function(answer_selected, quiz_active_session_id, successCallback, failCallback) {
    if(VISH.Configuration.getConfiguration()["mode"] == "vish") {
      var send_type = "PUT";
      V.Debugging.log("token is: " + V.User.getToken());
      var params = {"id":quiz_active_session_id, "option":answer_selected, "authenticity_token":V.User.getToken()};
      $.ajax({type:send_type, url:"http://" + window.location.host + "/quiz_sessions/" + quiz_active_session_id, data:params, success:function(data) {
        var results = data;
        if(typeof successCallback == "function") {
          successCallback(results)
        }
      }, error:function(error) {
        failCallback(error)
      }});
      return null
    }else {
      if(VISH.Configuration.getConfiguration()["mode"] == "noserver") {
        V.Debugging.log("No server case");
        var quiz_session_id = "123";
        if(typeof successCallback == "function") {
          successCallback(quiz_session_id)
        }
      }
    }
  };
  var getQuizSessionResults = function(quiz_active_session_id, successCallback, failCallback) {
    if(VISH.Configuration.getConfiguration()["mode"] == "vish") {
      var send_type = "GET";
      var params = {"id":quiz_active_session_id, "authenticity_token":V.User.getToken()};
      $.ajax({type:send_type, url:"http://" + window.location.host + "/quiz_sessions/" + quiz_active_session_id + "/results.json", data:params, success:function(data) {
        var results = data;
        if(typeof successCallback == "function") {
          successCallback(results)
        }
      }, error:function(error) {
        failCallback(error)
      }});
      return null
    }else {
      if(VISH.Configuration.getConfiguration()["mode"] == "noserver") {
        V.Debugging.log("No server case: and quiz session get results: " + quiz_active_session_id);
        if(quiz_active_session_id == 98988) {
          var results = {"quiz_session_id":98988, "quiz_id":12, "results":{"b":4, "a":2, "c":1, "d":1}}
        }else {
          if(quiz_active_session_id == 98955) {
            var results = {"quiz_session_id":98955, "quiz_id":13, "results":{"b":8, "a":4, "c":4}}
          }
        }
        if(typeof successCallback == "function") {
          successCallback(results)
        }
      }
    }
  };
  return{init:init, postStartQuizSession:postStartQuizSession, deleteQuizSession:deleteQuizSession, putQuizSession:putQuizSession, getQuizSessionResults:getQuizSessionResults}
}(VISH, jQuery);
VISH.Quiz.Renderer = function(V, $, undefined) {
  var init = function() {
  };
  var renderQuiz = function(quizType, element, zone_class, slide, zone) {
    switch(quizType) {
      case "multiplechoice":
        return _renderMcQuestion(element, zone_class, slide, zone);
        break;
      case "openQuestion":
        return _renderOpenquestion(element, template);
        break;
      case "truefalsequestion":
        return _renderTrueFalseQuestion(element, template);
        break;
      default:
        break
    }
  };
  var _renderMcQuestion = function(element, zone_class, slide, zone) {
    var ret = "<div id='" + element["id"] + "' class='" + zone_class + " quiz'>";
    ret += "<div class='mcquestion_container'>";
    ret += "<div class='mcquestion_header'></div>";
    ret += "<div class='mcquestion_body'><h2 class='question'>" + element["question"] + "</h2>";
    ret += "<form class='mcquestion_form' action='" + element["posturl"] + "' method='post'>";
    for(var i = 0;i < element["options"].length;i++) {
      var next_index = String.fromCharCode("a".charCodeAt(0) + i);
      if(VISH.Quiz.getQuizMode() == "answer") {
        ret += "<label class='mc_answer'>" + next_index + ") <input class='mc_radio' type='radio' name='mc_radio' value='" + next_index + "'</input>" + element["options"][i] + "</label>"
      }else {
        ret += "<label class='mc_answer'>" + next_index + ") " + element["options"][i] + "</label>"
      }
      ret += "<div class='mc_meter'><span style='width:0%' >&nbsp;</span></div>";
      ret += "<label class='mcoption_label'></label>"
    }
    ret += "<input type='hidden' value='" + slide + "_" + zone + "' name='zone' />";
    ret += "<input type='hidden' value='" + element["quizid"] + "' name='quizid' class='quizId' />";
    ret += "</div>";
    ret += "<div class='mch_inputs_wrapper'>";
    ret += "<a href='#start_quiz_fancybox' class='quiz_session_start_link' id='launchQuizFancybox'><input type='button' class='quiz_session_start_button' value='Start Quiz'/></a>";
    ret += "<input type='button' class='quiz_session_options_button' value='Options'/>";
    ret += "</div>";
    ret += "</form>";
    ret += "</div>";
    return ret
  };
  var _renderOpenquestion = function(element, template) {
    var ret = "<form action='" + element["posturl"] + "' method='post' style='text-align:center;'>";
    ret += "<label class='question_name'>Name:  </label>";
    ret += "<textarea id='pupil_name' rows='1' cols='50' class='question_name_input' placeholder='Write your name here'></textarea>";
    ret += "<h2 class='question'> Question: " + element["question"] + "? </h2>";
    ret += "<label class='label_question'>Answer: </label>";
    ret += "<textarea id='question_answer' rows='5' cols='50' class='question_answer' placeholder='Write your answer here'></textarea>";
    ret += "<button type='button' class='question_button'>Send</button>";
    return ret
  };
  var _renderTrueFalseQuestion = function(element, template) {
    var next_num = 0;
    var answers = new Array;
    var ret = "<div id='" + element["id"] + "' class='truefalse_question'>";
    ret += "<div class='truefalse_question_container'>";
    ret += "<form class='truefalse_question_form' action='" + element["posturl"] + "' method='post'>";
    ret += "<table id='truefalse_quiz_table_1' class='truefalse_quiz_table'><tr><th>True</th><th>False</th><th> Question </th></tr>";
    for(var i = 0;i < element["questions"].length;i++) {
      answers[i] = element["questions"][i]["answer"];
      ret += "<tr id='tr_question_" + (i + 1) + "'>";
      ret += "<td id='td_true_" + (i + 1) + "' class='td_true'>";
      ret += "<input type='radio' name='tf_radio_" + (i + 1) + "' value='true' /></td>";
      ret += "<td id='td_false_" + (i + 1) + "' class='td_false' >";
      ret += "<input type='radio' name='tf_radio_" + (i + 1) + "' value='false'/></td>";
      ret += "<td id='td_question_" + (i + 1) + "' class='true_false_question_txt'><label>" + element["questions"][i]["text_question"] + "?</label></td>";
      ret += "</tr>"
    }
    ret += "</table>";
    ret += "<input type='button' class='tfquestion_button' value='Send'/>";
    ret += "</form>";
    ret += "</div>";
    trueFalseAnswers = answers;
    asnswers = [];
    VISH.Debugging.log("JSON object answer is: " + trueFalseAnswers);
    return ret
  };
  return{init:init, renderQuiz:renderQuiz}
}(VISH, jQuery);
VISH.Renderer.Filter = function(V, $, undefined) {
  var init = function() {
  };
  var allowElement = function(element) {
    var device = VISH.Status.getDevice();
    if(device.desktop) {
      switch(element.type) {
        case "applet":
          return false;
        default:
          return true
      }
    }else {
      if(device.mobile || device.tablet) {
        switch(element.type) {
          case "object":
            var objectInfo = VISH.Object.getObjectInfo(element.body);
            if(objectInfo.type == "swf") {
              return false
            }else {
              if(objectInfo.type == "youtube") {
                return true
              }
            }
            break;
          case "video":
            return true;
            break;
          case "snapshot":
            return true;
            break;
          case "applet":
            return false;
          default:
            return true
        }
      }
    }
    return true
  };
  var renderContentFiltered = function(element, template) {
    return"<div id='" + element["id"] + "' class='contentfiltered " + template + "_" + element["areaid"] + "'><img class='" + template + "_image' src='" + VISH.ImagesPath + "advert_new_grey.png'/></div>"
  };
  return{init:init, allowElement:allowElement, renderContentFiltered:renderContentFiltered}
}(VISH, jQuery);
VISH.SlideManager = function(V, $, undefined) {
  var initOptions;
  var mySlides = null;
  var slideStatus = {};
  var myDoc;
  var current_presentation;
  var presentationType = "presentation";
  var init = function(options, presentation) {
    VISH.Debugging.init(options);
    VISH.Editing = false;
    if(options) {
      initOptions = options
    }else {
      initOptions = {}
    }
    if(options && options["configuration"] && VISH.Configuration) {
      VISH.Configuration.init(options["configuration"])
    }
    if(VISH.Debugging.isDevelopping()) {
      if(options["configuration"]["mode"] == "noserver" && !presentation && VISH.Debugging.getPresentationSamples() != null) {
        presentation = VISH.Debugging.getPresentationSamples()
      }
    }
    current_presentation = presentation;
    V.Quiz.init(presentation);
    V.Slides.init();
    V.Status.init();
    V.Utils.loadDeviceCSS();
    V.User.init(options);
    applicationCache.addEventListener("cached", function() {
      VISH.LocalStorage.addPresentation(presentation)
    }, false);
    if(presentation.type === "game") {
      setPresentationType("game");
      VISH.ViewerAdapter.setupGame(presentation);
      VISH.Game.registerActions(presentation)
    }else {
      if(presentation.type === "flashcard") {
        setPresentationType("flashcard");
        VISH.Flashcard.init(presentation)
      }
    }
    V.Events.init();
    V.Events.Notifier.init();
    V.VideoPlayer.init();
    V.Themes.selectTheme(presentation.theme);
    mySlides = presentation.slides;
    V.Presentation.init(mySlides);
    V.ViewerAdapter.setupSize(false);
    $(window).on("orientationchange", function() {
      V.ViewerAdapter.setupSize()
    });
    if(V.Status.getDevice().features.fullscreen && V.Status.getDevice().desktop) {
      if(V.Status.getIsInIframe()) {
        myDoc = parent.document
      }else {
        myDoc = document
      }
      $(document).on("click", "#page-fullscreen", toggleFullScreen);
      $(myDoc).on("webkitfullscreenchange mozfullscreenchange fullscreenchange", function(event) {
        V.ViewerAdapter.setupElements();
        setTimeout(function() {
          VISH.ViewerAdapter.setupSize(true);
          VISH.ViewerAdapter.decideIfPageSwitcher()
        }, 400)
      })
    }else {
      $("#page-fullscreen").hide()
    }
    if(V.Status.getDevice().desktop) {
      $("#viewbar").show();
      updateSlideCounter()
    }else {
      window.addEventListener("load", function() {
        hideAddressBar()
      });
      window.addEventListener("orientationchange", hideAddressBar)
    }
    V.Quiz.prepareQuiz(presentation);
    if(options && options["preview"]) {
      $("div#viewerpreview").show()
    }
    if(!V.Status.getDevice().desktop && !VISH.Status.getIsInIframe() && options && options["comeBackUrl"]) {
      $("button#closeButton").show()
    }
    if(options.addons) {
      VISH.Addons.init(options.addons)
    }
  };
  var toggleFullScreen = function() {
    if(VISH.Status.isSlaveMode()) {
      return
    }
    if(VISH.Status.getIsInIframe()) {
      var myElem = VISH.Status.getIframe()
    }else {
      var myElem = myDoc.getElementById("presentation_iframe")
    }
    if(myDoc.fullScreenElement && myDoc.fullScreenElement !== null || !myDoc.mozFullScreen && !myDoc.webkitIsFullScreen) {
      if(myDoc.documentElement.requestFullScreen) {
        myElem.requestFullScreen()
      }else {
        if(myDoc.documentElement.mozRequestFullScreen) {
          myElem.mozRequestFullScreen()
        }else {
          if(myDoc.documentElement.webkitRequestFullScreen) {
            myElem.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)
          }
        }
      }
    }else {
      if(myDoc.cancelFullScreen) {
        myDoc.cancelFullScreen()
      }else {
        if(myDoc.mozCancelFullScreen) {
          myDoc.mozCancelFullScreen()
        }else {
          if(myDoc.webkitCancelFullScreen) {
            myDoc.webkitCancelFullScreen()
          }
        }
      }
    }
  };
  var addEnterLeaveEvents = function() {
    $("article").live("slideenter", _onslideenter);
    $("article").live("slideleave", _onslideleave)
  };
  var getStatus = function(slideid) {
    if(!slideStatus[slideid]) {
      slideStatus[slideid] = {id:slideid, poiFrameNumber:0, drawingPoi:0}
    }
    return slideStatus[slideid]
  };
  var updateStatus = function(slideid, newStatus) {
    slideStatus[slideid] = newStatus
  };
  var getOptions = function() {
    return initOptions
  };
  var _onslideenter = function(e) {
    V.ViewerAdapter.decideIfPageSwitcher();
    var fcElem, slideId;
    setTimeout(function() {
      if($(e.target).hasClass("object")) {
        V.ObjectPlayer.loadObject($(e.target))
      }else {
        if($(e.target).hasClass("applet")) {
          V.AppletPlayer.loadApplet($(e.target))
        }else {
          if($(e.target).hasClass("snapshot")) {
            V.SnapshotPlayer.loadSnapshot($(e.target))
          }
        }
      }
    }, 500);
    V.VideoPlayer.HTML5.playVideos(e.target)
  };
  var _onslideleave = function(e) {
    V.VideoPlayer.HTML5.stopVideos(e.target);
    V.ObjectPlayer.unloadObject();
    V.AppletPlayer.unloadApplet();
    if($(e.target).hasClass("flashcard")) {
      V.Mods.fc.player.clear()
    }
  };
  var updateSlideCounter = function() {
    var number_of_slides = V.Slides.getSlides().length;
    var slide_number = VISH.Slides.getCurrentSlideNumber();
    if(number_of_slides === 0) {
      slide_number = 0
    }
    $("#slide-counter").html(slide_number + "/" + number_of_slides)
  };
  var hideAddressBar = function() {
    VISH.Debugging.log("TODO method hideAddressBar in slides.js")
  };
  var getCurrentPresentation = function() {
    return current_presentation
  };
  var getPresentationType = function() {
    return presentationType
  };
  var setPresentationType = function(type) {
    presentationType = type
  };
  return{init:init, getStatus:getStatus, updateStatus:updateStatus, addEnterLeaveEvents:addEnterLeaveEvents, hideAddressBar:hideAddressBar, toggleFullScreen:toggleFullScreen, getOptions:getOptions, updateSlideCounter:updateSlideCounter, getCurrentPresentation:getCurrentPresentation, getPresentationType:getPresentationType, setPresentationType:setPresentationType}
}(VISH, jQuery);
VISH.SnapshotPlayer = function() {
  var loadSnapshot = function(element) {
    $.each(element.children(".snapshotelement"), function(index, value) {
      var wrapper_class = "snapshot_wrapper" + "_viewer";
      var content_class = "snapshot_content" + "_viewer";
      var content = $(value).attr("objectWrapper");
      if(VISH.Status.getOnline() === false) {
        $(value).html("<img src='" + VISH.ImagesPath + "/advert_new_grey.png'/>");
        return
      }
      var iframe = $(VISH.Utils.getOuterHTML($(content)));
      $(iframe).removeClass();
      $(iframe).addClass(content_class);
      var scrollTop = $(value).attr("scrollTop");
      var scrollLeft = $(value).attr("scrollLeft");
      $(value).html("<div class='" + wrapper_class + "' style='" + $(value).attr("objectStyle") + "'>" + VISH.Utils.getOuterHTML(iframe) + "</div>");
      if($(value).attr("zoom")) {
        $(value).find("." + content_class).attr("style", VISH.Utils.getZoomInStyle($(value).attr("zoom")))
      }
      $(value).find("." + wrapper_class).scrollTop(scrollTop);
      $(value).find("." + wrapper_class).scrollLeft(scrollLeft)
    })
  };
  var unloadSnapshot = function() {
    var element = $(".past, .next");
    $.each(element.children(".snapshotelement"), function(index, value) {
      $(value).html("")
    })
  };
  var aftersetupSize = function(increase) {
    $.each($(".snapshot_content_viewer"), function(index, iframe) {
      var area = $(iframe).parent().parent();
      var iframe_wrapper = $(iframe).parent();
      $(area).attr("zoom", increase);
      $(iframe).attr("style", VISH.Utils.getZoomInStyle(increase));
      var scrollLeft = $(area).attr("scrollLeftOrigin");
      var newScrollLeft = scrollLeft * increase;
      var scrollTop = $(area).attr("scrollTopOrigin");
      var newScrollTop = scrollTop * increase;
      $(area).attr("scrollLeft", newScrollLeft);
      $(area).attr("scrollTop", newScrollTop);
      $(iframe_wrapper).scrollLeft(newScrollLeft);
      $(iframe_wrapper).scrollTop(newScrollTop)
    })
  };
  return{loadSnapshot:loadSnapshot, unloadSnapshot:unloadSnapshot, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Themes = function(V, $, undefined) {
  var selectTheme = function(theme) {
    _loadTheme(theme);
    if(V.Editing) {
      var draftPresentation = VISH.Editor.getPresentation();
      if(!draftPresentation) {
        draftPresentation = {}
      }
      draftPresentation.theme = theme;
      VISH.Editor.setPresentation(draftPresentation);
      $.fancybox.close()
    }
  };
  var _loadTheme = function(theme) {
    if(!theme) {
      theme = "theme1"
    }
    _unloadAllThemes();
    V.Utils.loadCSS("themes/" + theme + ".css")
  };
  var _unloadAllThemes = function() {
    var theme_pattern = "(^" + VISH.StylesheetsPath + "themes/)";
    $("head").find("link[type='text/css']").each(function(index, link) {
      var href = $(link).attr("href");
      if(href) {
        if(href.match(theme_pattern) !== null) {
          $(link).remove()
        }
      }
    })
  };
  return{selectTheme:selectTheme}
}(VISH, jQuery);
VISH.User = function(V, $, undefined) {
  var user;
  var init = function(options) {
    user = new Object;
    if(options["username"]) {
      user.username = options["username"]
    }
    if(options["userId"]) {
      user.id = options["userId"]
    }
    if(options["token"]) {
      user.token = options["token"]
    }
  };
  var isLogged = function() {
    if(user && user.token) {
      return typeof user.token == "string"
    }else {
      return false
    }
  };
  var getUser = function() {
    if(user) {
      return user
    }else {
      return null
    }
  };
  var getName = function() {
    if(user && user.username) {
      return user.username
    }else {
      return null
    }
  };
  var getId = function() {
    if(user && user.id) {
      return user.id
    }else {
      return null
    }
  };
  var getToken = function() {
    if(user && user.token) {
      return user.token
    }else {
      return null
    }
  };
  return{init:init, isLogged:isLogged, getUser:getUser, getName:getName, getId:getId, getToken:getToken}
}(VISH, jQuery);
VISH.Utils.canvas = function(V, undefined) {
  var drawImageWithAspectRatio = function(ctx, content, dx, dy, dw, dh) {
    var ratio, tmpHeight, tmpWidth, finalx, finaly, finalw, finalh;
    if(content.constructor === Image || content.constructor == HTMLImageElement) {
      ratio = content.width / content.height;
      tmpHeight = dw * content.height / content.width;
      tmpWidth = dh * content.width / content.height
    }else {
      ratio = content.videoWidth / content.videoHeight;
      tmpHeight = dw * content.videoHeight / content.videoWidth;
      tmpWidth = dh * content.videoWidth / content.videoHeight
    }
    if(ratio > dw / dh) {
      finalx = dx;
      finaly = dy + dh / 2 - tmpHeight / 2;
      finalw = dw;
      finalh = tmpHeight
    }else {
      finalx = dx + dw / 2 - tmpWidth / 2;
      finaly = dy;
      finalw = tmpWidth;
      finalh = dh
    }
    ctx.drawImage(content, finalx, finaly, finalw, finalh)
  };
  var drawImageWithAspectRatioAndRoundedCorners = function(ctx, content, dx, dy, dw, dh) {
    var ratio, tmpHeight, tmpWidth, finalx, finaly, finalw, finalh;
    if(content.constructor === Image || content.constructor == HTMLImageElement) {
      ratio = content.width / content.height;
      tmpHeight = dw * content.height / content.width;
      tmpWidth = dh * content.width / content.height
    }else {
      ratio = content.videoWidth / content.videoHeight;
      tmpHeight = dw * content.videoHeight / content.videoWidth;
      tmpWidth = dh * content.videoWidth / content.videoHeight
    }
    if(ratio > dw / dh) {
      finalx = dx;
      finaly = dy + dh / 2 - tmpHeight / 2;
      finalw = dw;
      finalh = tmpHeight
    }else {
      finalx = dx + dw / 2 - tmpWidth / 2;
      finaly = dy;
      finalw = tmpWidth;
      finalh = dh
    }
    ctx.drawImage(content, finalx, finaly, finalw, finalh);
    drawRoundedCorners(ctx, finalx, finaly, finalw, finalh)
  };
  var drawRoundedCorners = function(ctx, dx, dy, dw, dh, type) {
    var cornerFile, finalx, finaly, finalw, finalh;
    finalx = dx - 1;
    finaly = dy - 1;
    finalw = dw + 2;
    finalh = dh + 2;
    if(type === "text") {
      cornerFile = V.Utils.loader.getImage(VISH.ImagesPath + "corner_small_text.png")
    }else {
      if(finalw > 300 && finalh > 300) {
        cornerFile = V.Utils.loader.getImage(VISH.ImagesPath + "corner.png")
      }else {
        cornerFile = V.Utils.loader.getImage(VISH.ImagesPath + "corner_small.png")
      }
    }
    ctx.save();
    ctx.drawImage(cornerFile, finalx, finaly);
    ctx.translate(finalx + finalw, finaly);
    ctx.rotate(Math.PI / 2);
    ctx.drawImage(cornerFile, 0, 0);
    ctx.restore();
    ctx.save();
    ctx.translate(finalx + finalw, finaly + finalh);
    ctx.rotate(Math.PI);
    ctx.drawImage(cornerFile, 0, 0);
    ctx.restore();
    ctx.save();
    ctx.translate(finalx, finaly + finalh);
    ctx.rotate(3 * Math.PI / 2);
    ctx.drawImage(cornerFile, 0, 0);
    ctx.restore()
  };
  return{drawImageWithAspectRatioAndRoundedCorners:drawImageWithAspectRatioAndRoundedCorners, drawImageWithAspectRatio:drawImageWithAspectRatio, drawRoundedCorners:drawRoundedCorners}
}(VISH);
VISH.Utils.loader = function(V, undefined) {
  var libVideos = {};
  var libImages = {};
  var getImage = function(imagePath) {
    if(libImages[imagePath]) {
      return libImages[imagePath]
    }else {
      VISH.Debugging.log("Error, Image with path " + imagePath + " was not preloaded");
      return null
    }
  };
  var getVideo = function(videoPath) {
    if(libVideos[videoPath]) {
      return libVideos[videoPath]
    }else {
      VISH.Debugging.log("Error, Video with path " + videoPath + " was not preloaded");
      return null
    }
  };
  var loadImage = function(src) {
    var deferred, img;
    deferred = $.Deferred();
    img = new Image;
    img.onload = function() {
      deferred.resolve()
    };
    img.src = src;
    libImages[src] = img;
    return deferred.promise()
  };
  var loadVideo = function(videoSrc, videoId) {
    var deferred, v;
    deferred = $.Deferred();
    v = document.createElement("video");
    v.setAttribute("id", "video" + videoId);
    v.setAttribute("style", "display:none");
    v.setAttribute("preload", "auto");
    v.setAttribute("src", videoSrc);
    document.body.appendChild(v);
    v.addEventListener("loadedmetadata", function() {
      deferred.resolve()
    }, false);
    libVideos[videoSrc] = v;
    return deferred.promise()
  };
  var loadImagesOnCarrousel = function(imagesArray, callback, carrouselDivId, titleArray) {
    var imagesLength = imagesArray.length;
    var imagesLoaded = 0;
    $.each(imagesArray, function(i, image) {
      $(image).load(function(response) {
        if(titleArray && titleArray[imagesArray.indexOf(image)]) {
          $("#" + carrouselDivId).append("<div><p>" + titleArray[imagesArray.indexOf(image)] + "</p>" + VISH.Utils.getOuterHTML(image) + "</div>")
        }else {
          $("#" + carrouselDivId).append("<div>" + VISH.Utils.getOuterHTML(image) + "</div>")
        }
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength) {
          callback()
        }
      });
      $(image).error(function(response) {
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength) {
          callback()
        }
      })
    })
  };
  var loadImagesOnCarrouselOrder = function(imagesArray, callback, carrouselDivId, titleArray) {
    var validImagesArray = imagesArray;
    var imagesLength = imagesArray.length;
    var imagesLoaded = 0;
    $.each(imagesArray, function(i, image) {
      $(image).load(function(response) {
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength) {
          _insertElementsWithOrder(validImagesArray, carrouselDivId, titleArray);
          callback()
        }
      });
      $(image).error(function(response) {
        imagesLoaded = imagesLoaded + 1;
        validImagesArray.splice(validImagesArray.indexOf(image), 1);
        if(imagesLoaded == imagesLength) {
          _insertElementsWithOrder(validImagesArray, carrouselDivId, titleArray);
          callback()
        }
      })
    })
  };
  var _insertElementsWithOrder = function(imagesArray, carrouselDivId, titleArray) {
    $.each(imagesArray, function(i, image) {
      if(titleArray && titleArray[imagesArray.indexOf(image)]) {
        $("#" + carrouselDivId).append("<div><div class='draggable_arrow_div' slide_id='" + titleArray[imagesArray.indexOf(image)] + "' id='poi" + titleArray[imagesArray.indexOf(image)] + "'><img src='" + VISH.ImagesPath + "flashcard_button.png'  class='fc_draggable_arrow'/><p class='draggable_number'>" + titleArray[imagesArray.indexOf(image)] + "</p></div><p slidenumber='" + titleArray[imagesArray.indexOf(image)] + "' action='goToSlide'>" + titleArray[imagesArray.indexOf(image)] + "</p>" + VISH.Utils.getOuterHTML(image) + 
        "</div>")
      }else {
        $("#" + carrouselDivId).append("<div>" + VISH.Utils.getOuterHTML(image) + "</div>")
      }
    })
  };
  return{getImage:getImage, getVideo:getVideo, loadImage:loadImage, loadVideo:loadVideo, loadImagesOnCarrousel:loadImagesOnCarrousel, loadImagesOnCarrouselOrder:loadImagesOnCarrouselOrder}
}(VISH);
VISH.Utils.text = function(V, undefined) {
  var getLines = function(ctx, phrase, maxPxLength, textStyle) {
    var wa = phrase.split(" "), phraseArray = [], lastPhrase = "", l = maxPxLength, measure = 0, i = 0, w = 0;
    ctx.font = textStyle;
    for(i = 0;i < wa.length;i++) {
      w = wa[i];
      measure = ctx.measureText(lastPhrase + w).width;
      if(measure < l) {
        lastPhrase += " " + w
      }else {
        phraseArray.push(lastPhrase);
        lastPhrase = w
      }
      if(i === wa.length - 1) {
        phraseArray.push(lastPhrase);
        break
      }
    }
    return phraseArray
  };
  return{getLines:getLines}
}(VISH);
VISH.VideoPlayer.CustomPlayer = function() {
  var progressBarTimer;
  var init = function() {
  };
  var addCustomPlayerControls = function(videoId, loadEvents) {
    var video = document.getElementById(videoId);
    var customPlayerContainer = $("<div class='customPlayerContainer'>");
    $(video).parent().append(customPlayerContainer);
    $(video).remove();
    $(customPlayerContainer).append(video);
    $(customPlayerContainer).append($("<div class='customPlayerControls'><div class='customPlayerPlay'></div></div>"));
    $(customPlayerContainer).append($("<div class='customPlayerProgressBar'><div class='progressBarElapsed'></div></div>"));
    var customPlayerControls = $(customPlayerContainer).find("div.customPlayerControls");
    $(customPlayerContainer).attr("style", $(video).attr("style"));
    $(video).attr("style", "width:98%; height:98%;");
    $(customPlayerControls).attr("style", "width: 100%; height:100%;");
    $(video).attr("customPlayerStatus", "ready");
    if(loadEvents) {
      loadCustomPlayerControlEvents(video)
    }
  };
  var loadCustomPlayerControlEvents = function(video) {
    var customPlayerContainer = $(video).parent();
    var customPlayerControls = $(customPlayerContainer).find("div.customPlayerControls");
    var progressBar = $(customPlayerContainer).parent().find("div.customPlayerProgressBar");
    $(customPlayerControls).bind("click", _onClickCustomPlayerControls);
    $(customPlayerContainer).bind("mouseenter", _onEnterCustomPlayer);
    $(customPlayerContainer).bind("mouseleave", _onLeaveCustomPlayer);
    $(progressBar).bind("click", _onClickProgressBar)
  };
  var _onClickCustomPlayerControls = function(event) {
    event.preventDefault();
    var video = $(this).parent().find("object")[0];
    onClickVideo(video)
  };
  var _onEnterCustomPlayer = function(event) {
    var video = $(event.target).parent().find("object")[0];
    if($(video).attr("customPlayerStatus") !== "ready") {
      var progressBar = $(video).parent().find("div.customPlayerProgressBar");
      $(progressBar).show()
    }
  };
  var _onLeaveCustomPlayer = function(event) {
    var progressBar = $(event.target).parent().find("div.customPlayerProgressBar");
    $(progressBar).hide()
  };
  var _startProgressBar = function(video) {
    var progressBar = $(video).parent().find("div.progressBarElapsed");
    var timer = progressBarTimer = setInterval(function() {
      try {
        var ratio = VISH.VideoPlayer.getCurrentTime(video) / VISH.VideoPlayer.getDuration(video) * 100;
        $(progressBar).width(ratio + "%");
        if(ratio === 100) {
          clearTimeout(timer)
        }
      }catch(e) {
        clearTimeout(timer)
      }
    }, 400)
  };
  var _onClickProgressBar = function(event) {
    if(VISH.Status.isSlaveMode()) {
      return
    }
    if($(event.target).hasClass("customPlayerProgressBar")) {
      var progressBar = event.target;
      var elapsed = $(progressBar).find("div.progressBarElapsed")[0]
    }else {
      if($(event.target).hasClass("progressBarElapsed")) {
        var elapsed = event.target;
        var progressBar = $(elapsed).parent()
      }else {
        return
      }
    }
    event.preventDefault();
    event.stopPropagation();
    var video = $(progressBar).parent().find("object")[0];
    var ratio = (event.pageX - $(progressBar).offset().left) / $(progressBar).outerWidth();
    if(!VISH.Status.isPreventDefaultMode()) {
      $(elapsed).width(ratio * 100 + "%")
    }
    var seekToPos = Math.round(VISH.VideoPlayer.getDuration(video) * ratio);
    VISH.VideoPlayer.seekVideo(video.id, seekToPos, true)
  };
  var onClickVideo = function(video) {
    if(VISH.Status.isSlaveMode()) {
      return
    }
    switch($(video).attr("customPlayerStatus")) {
      case "ready":
      ;
      case "pause":
        if(!VISH.Status.isPreventDefaultMode()) {
          onPlayVideo(video)
        }
        VISH.VideoPlayer.playVideo(video.id, null, true);
        break;
      case "playing":
        if(!VISH.Status.isPreventDefaultMode()) {
          onPauseVideo(video)
        }
        VISH.VideoPlayer.pauseVideo(video.id, null, true);
        break;
      default:
        break
    }
  };
  var onPlayVideo = function(video) {
    _startProgressBar(video);
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    var progressBar = $(video).parent().find("div.customPlayerProgressBar");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerPause");
    $(customPlayerControlsButton).hide();
    $(video).attr("customPlayerStatus", "playing");
    $(progressBar).show()
  };
  var onPauseVideo = function(video) {
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerPlay");
    $(customPlayerControlsButton).show();
    $(video).attr("customPlayerStatus", "pause")
  };
  var onEndVideo = function(video) {
    $(video).attr("customPlayerStatus", "pause");
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerReplay");
    $(customPlayerControlsButton).show()
  };
  return{init:init, addCustomPlayerControls:addCustomPlayerControls, loadCustomPlayerControlEvents:loadCustomPlayerControlEvents, onPlayVideo:onPlayVideo, onPauseVideo:onPauseVideo, onEndVideo:onEndVideo}
}(VISH, jQuery);
VISH.VideoPlayer.HTML5 = function() {
  var playTriggeredByUser = true;
  var pauseTriggeredByUser = true;
  var seekTriggeredByUser = true;
  var init = function() {
  };
  var setVideoEvents = function() {
    var videos = $("video");
    $.each(videos, function(index, video) {
      video.addEventListener("play", function() {
        var params = new Object;
        params.type = "HTML5";
        params.videoId = video.id;
        params.currentTime = video.currentTime;
        params.slideNumber = VISH.Slides.getCurrentSlideNumber();
        VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onPlayVideo, params, playTriggeredByUser);
        playTriggeredByUser = true
      }, false);
      video.addEventListener("pause", function() {
        var params = new Object;
        params.type = "HTML5";
        params.videoId = video.id;
        params.currentTime = video.currentTime;
        params.slideNumber = VISH.Slides.getCurrentSlideNumber();
        VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onPauseVideo, params, pauseTriggeredByUser);
        pauseTriggeredByUser = true
      }, false);
      video.addEventListener("ended", function() {
      }, false);
      video.addEventListener("error", function(err) {
      }, false);
      video.addEventListener("seeked", function(err) {
        var params = new Object;
        params.type = "HTML5";
        params.videoId = video.id;
        params.currentTime = video.currentTime;
        params.slideNumber = VISH.Slides.getCurrentSlideNumber();
        VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onSeekVideo, params, seekTriggeredByUser);
        seekTriggeredByUser = true
      }, false);
      $(video).focus(function(event) {
        this.blur()
      })
    })
  };
  var playVideos = function(element) {
    var currentVideos = $(element).find("video");
    $.each(currentVideos, function(index, video) {
      if($(video).attr("wasplayingonslideleave") == "true") {
        video.play()
      }else {
        if($(video).attr("wasplayingonslideleave") == "false") {
        }else {
          if(typeof $(video).attr("wasplayingonslideleave") == "undefined") {
            if($(video).attr("autoplayonslideenter") == "true") {
              video.play()
            }
          }
        }
      }
    })
  };
  var stopVideos = function(element) {
    var currentVideos = $(element).find("video");
    $.each(currentVideos, function(index, video) {
      var playing = !video.paused;
      $(video).attr("wasplayingonslideleave", playing);
      if(playing) {
        video.pause()
      }
    })
  };
  var playVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
    if(video.paused) {
      playTriggeredByUser = false;
      video.play()
    }
  };
  var pauseVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
    if(!video.paused) {
      pauseTriggeredByUser = false;
      video.pause()
    }
  };
  var seekVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
  };
  var showControls = function(showControls) {
    var videos = $("video");
    $.each(videos, function(index, video) {
      if(!showControls) {
        $(video).removeAttr("controls")
      }else {
        $(video).attr("controls", true)
      }
    })
  };
  return{init:init, setVideoEvents:setVideoEvents, playVideos:playVideos, stopVideos:stopVideos, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, showControls:showControls}
}(VISH, jQuery);
VISH.VideoPlayer.Youtube = function() {
  var init = function() {
  };
  var loadYoutubeObject = function(element, value) {
    if(VISH.Status.getOnline() === false) {
      $(value).html("<img src='" + VISH.ImagesPath + "/advert_new_grey.png'/>");
      return
    }
    var source = $(value).attr("source");
    var ytVideoId = $(value).attr("ytVideoId");
    $(value).html("<div id='" + ytVideoId + "' style='" + $(value).attr("objectStyle") + "'></div>");
    var newYtVideoId = VISH.Utils.getId();
    var params = {allowScriptAccess:"always"};
    var atts = {id:newYtVideoId, wmode:"transparent"};
    source = source.split("?")[0];
    source = source + "?enablejsapi=1&controls=0&showinfo=0&rel=0&modestbranding=1&wmodetransparent=true&playerapiid=" + newYtVideoId;
    swfobject.embedSWF(source, ytVideoId, "100%", "100%", "8", null, null, params, atts);
    $("#" + newYtVideoId).attr("style", $(value).attr("objectStyle"));
    VISH.VideoPlayer.CustomPlayer.addCustomPlayerControls(newYtVideoId, false)
  };
  var onytplayerStateChange = function(playerId, newState) {
    var player = document.getElementById(playerId);
    switch(newState) {
      case -1:
        VISH.VideoPlayer.CustomPlayer.loadCustomPlayerControlEvents(player);
        break;
      case 0:
        VISH.VideoPlayer.CustomPlayer.onEndVideo(player);
        break;
      case 1:
        VISH.VideoPlayer.CustomPlayer.onPlayVideo(player);
        break;
      case 2:
        VISH.VideoPlayer.CustomPlayer.onPauseVideo(player);
        break;
      case 3:
        break;
      case 4:
        break;
      case 5:
        break;
      default:
        break
    }
  };
  var onytplayerError = function(playerId, error) {
  };
  var playVideo = function(videoId, currentTime, triggeredByUser) {
    var ytPlayer = document.getElementById(videoId);
    if(ytPlayer && ytPlayer.getPlayerState) {
      var params = new Object;
      params.videoId = videoId;
      params.currentTime = ytPlayer.getCurrentTime();
      params.slideNumber = VISH.Slides.getCurrentSlideNumber();
      if(triggeredByUser && VISH.Status.isPreventDefaultMode()) {
        VISH.Messenger.notifyEventByMessage(VISH.Constant.Event.onPlayVideo, params);
        return
      }
      VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onPlayVideo, params, triggeredByUser);
      _seekVideo(ytPlayer, currentTime, false);
      if(ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING) {
        ytPlayer.playVideo()
      }
    }
  };
  var pauseVideo = function(videoId, currentTime, triggeredByUser) {
    var ytPlayer = document.getElementById(videoId);
    if(ytPlayer && ytPlayer.getPlayerState) {
      var params = new Object;
      params.videoId = videoId;
      params.currentTime = ytPlayer.getCurrentTime();
      params.slideNumber = VISH.Slides.getCurrentSlideNumber();
      if(triggeredByUser && VISH.Status.isPreventDefaultMode()) {
        VISH.Messenger.notifyEventByMessage(VISH.Constant.Event.onPauseVideo, params);
        return
      }
      VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onPauseVideo, params, triggeredByUser);
      if(ytPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
        ytPlayer.pauseVideo()
      }
      _seekVideo(ytPlayer, currentTime, false)
    }
  };
  var seekVideo = function(videoId, seekTime, triggeredByUser) {
    var ytPlayer = document.getElementById(videoId);
    if(ytPlayer && ytPlayer.getPlayerState) {
      _seekVideo(ytPlayer, seekTime, triggeredByUser)
    }
  };
  var _seekVideo = function(video, seekTime, triggeredByUser) {
    var changeCurrentTime = typeof seekTime === "number" && video.getCurrentTime() !== seekTime;
    if(changeCurrentTime) {
      var params = new Object;
      params.videoId = video.id;
      params.currentTime = seekTime;
      params.slideNumber = VISH.Slides.getCurrentSlideNumber();
      if(triggeredByUser && VISH.Status.isPreventDefaultMode()) {
        VISH.Messenger.notifyEventByMessage(VISH.Constant.Event.onSeekVideo, params);
        return
      }
      VISH.Events.Notifier.notifyEvent(VISH.Constant.Event.onSeekVideo, params, triggeredByUser);
      video.seekTo(seekTime)
    }
  };
  return{init:init, loadYoutubeObject:loadYoutubeObject, onytplayerStateChange:onytplayerStateChange, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo}
}(VISH, jQuery);
var youtubePlayers = {};
var YT = YT || {};
YT.PlayerState = YT.PlayerState || {};
YT.PlayerState.UNSTARTED = -1;
YT.PlayerState.ENDED = 0;
YT.PlayerState.PLAYING = 1;
YT.PlayerState.PAUSED = 2;
YT.PlayerState.BUFFERING = 3;
YT.PlayerState.CUED = 5;
function onYouTubePlayerReady(playerId) {
  var ytPlayer = document.getElementById(playerId);
  var idPlayerParams = "yt_" + playerId;
  youtubePlayers[idPlayerParams] = {playerId:playerId, onStateChanged:function(state) {
    VISH.VideoPlayer.Youtube.onytplayerStateChange(playerId, state)
  }, onError:function(err) {
    VISH.VideoPlayer.Youtube.onytplayerError(playerId, err)
  }};
  ytPlayer.addEventListener("onStateChange", "youtubePlayers." + idPlayerParams + ".onStateChanged");
  ytPlayer.addEventListener("onError", "youtubePlayers." + idPlayerParams + ".onError")
}
;VISH.ViewerAdapter = function(V, $, undefined) {
  var page_is_fullscreen = false;
  var setupSize = function(fullscreen) {
    var reserved_px_for_menubar;
    var margin_height;
    var margin_width;
    if(V.Status.getDevice().mobile) {
      reserved_px_for_menubar = 0;
      margin_height = 0;
      margin_width = 0
    }else {
      if(fullscreen && !page_is_fullscreen) {
        page_is_fullscreen = true;
        reserved_px_for_menubar = 0;
        margin_height = 0;
        margin_width = 0
      }else {
        page_is_fullscreen = false;
        if(V.SlideManager.getPresentationType() === "presentation") {
          reserved_px_for_menubar = 40
        }else {
          reserved_px_for_menubar = 0
        }
        margin_height = 40;
        margin_width = 30
      }
    }
    var height = $(window).height() - reserved_px_for_menubar;
    var width = $(window).width();
    var finalW = 800;
    var finalH = 600;
    var aspectRatio = width / height;
    var slidesRatio = 4 / 3;
    if(aspectRatio > slidesRatio) {
      finalH = height - margin_height;
      finalW = finalH * slidesRatio
    }else {
      finalW = width - margin_width;
      finalH = finalW / slidesRatio
    }
    $(".slides > article").css("height", finalH);
    $(".slides > article").css("width", finalW);
    $("#flashcard-background").css("height", finalH);
    $("#flashcard-background").css("width", finalW);
    $("#flashcard-background").css("background-size", "" + finalW + "px " + finalH + "px");
    var marginTop = finalH / 2 + reserved_px_for_menubar / 2;
    var marginLeft = finalW / 2;
    $(".slides > article").css("margin-top", "-" + marginTop + "px");
    $(".slides > article").css("margin-left", "-" + marginLeft + "px");
    $("#flashcard-background").css("margin-top", "-" + marginTop + "px");
    $("#flashcard-background").css("margin-left", "-" + marginLeft + "px");
    var increase = finalH / 600;
    var font_size = V.Status.getDevice().mobile ? 15 : 16;
    $(".slides > article").css("font-size", font_size * increase + "px");
    $(".slides > article").css("line-height", font_size * increase + "px");
    $(".fc_poi img").css("width", 50 * increase + "px");
    $(".fc_poi img").css("height", 50 * increase + "px");
    VISH.SnapshotPlayer.aftersetupSize(increase);
    VISH.ObjectPlayer.aftersetupSize(increase)
  };
  var setupElements = function() {
    if(page_is_fullscreen) {
      $("#page-fullscreen").css("background-position", "0px 0px");
      $("#page-fullscreen").hover(function() {
        $("#page-fullscreen").css("background-position", "0px -40px")
      }, function() {
        $("#page-fullscreen").css("background-position", "0px 0px")
      });
      if(V.SlideManager.getPresentationType() === "presentation") {
        $("#viewbar").show();
        $(".vish_arrow").hide()
      }
    }else {
      $("#page-fullscreen").css("background-position", "-45px 0px");
      $("#page-fullscreen").hover(function() {
        $("#page-fullscreen").css("background-position", "-45px -40px")
      }, function() {
        $("#page-fullscreen").css("background-position", "-45px 0px")
      });
      if(V.SlideManager.getPresentationType() === "presentation") {
        $("#viewbar").hide();
        $(".vish_arrow").show()
      }
    }
  };
  var setupGame = function(presentation) {
    $("#my_game_iframe").attr("src", presentation.game.src);
    var fileref = document.createElement("link");
    fileref.setAttribute("rel", "stylesheet");
    fileref.setAttribute("type", "text/css");
    fileref.setAttribute("href", "stylesheets/game/game.css");
    document.getElementsByTagName("body")[0].appendChild(fileref)
  };
  var decideIfPageSwitcher = function() {
    if(V.SlideManager.getPresentationType() === "presentation") {
      if(!page_is_fullscreen && !V.Status.getDevice().mobile) {
        if(VISH.Slides.isCurrentFirstSlide()) {
          $("#page-switcher-start").hide()
        }else {
          $("#page-switcher-start").show()
        }
        if(VISH.Slides.isCurrentLastSlide()) {
          $("#page-switcher-end").hide()
        }else {
          $("#page-switcher-end").show()
        }
      }else {
        if(VISH.Slides.isCurrentFirstSlide()) {
          $("#mobile_back_arrow").hide()
        }else {
          $("#mobile_back_arrow").show()
        }
        if(VISH.Slides.isCurrentLastSlide()) {
          $("#mobile_forward_arrow").hide()
        }else {
          $("#mobile_forward_arrow").show()
        }
      }
    }
  };
  return{decideIfPageSwitcher:decideIfPageSwitcher, setupElements:setupElements, setupGame:setupGame, setupSize:setupSize}
}(VISH, jQuery);

