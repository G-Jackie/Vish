<% profile_subject ||= current_subject %>

<% content_for :title do %>
  <%= "#{ profile_subject && profile_subject.name + ': ' }#{ t('repository.title') }" %>
<% end %>

<% sidebar %>

<% if profile_subject %>
  <%= location(
    link_to(profile_subject.name, polymorphic_path(profile_subject),:remote => true),
    link_to(t('repository.title'), polymorphic_path([profile_subject, controller.controller_name]),:remote => true)
    ) %>
<% else %>
  <%= location(
    link_to(t('repository.title'), polymorphic_path(controller.controller_name),:remote => true)
    ) %>
<% end %>

<% if profile_subject %>
  <% toolbar :profile, :subject => profile_subject %>
<% elsif user_signed_in? %>
  <% toolbar %>
<% end %>

<div class="boxy_gray" id="new_file_only">
  <% d = Document.new %>
  <% d.owner_id = Actor.normalize_id(current_user) %>
  <%= form_for d, :namespace => 'new_file_only', :remote => false  do |f| %>
    <%= f.hidden_field :owner_id %>
    <%= f.file_field :file %>

    <div id="new_file_only_info_wrapper">
      <%= f.label :title %> <%= f.text_field :title %>
      <%= f.text_field :description, :size => 85, :class => "row-fluid-90" %>
    </div>
  
    <div id="new_file_only_share_btn" class="inline">
        <%= f.submit(t('share'), :class => "button submitActivity") %>
    </div>

    <%= javascript_tag do %>
      $(function() {
        $('#new_file_only_info_wrapper').hide();
        $("#new_file_only_document_description").watermark(I18n.t('document.input'), "#666");

        $('#new_file_only_document_file').change(function(){
          $('#new_file_only_info_wrapper').show();
          $("#new_file_only_document_title").val($(this).val().replace(/C:\\fakepath\\/i, ''));
        });

        $('#new_file_only_document_file').trigger('click');
      });
    <% end %>
  <% end %>
</div>

