<ul class="thumbnails">
  <li class="span3">
    <a data-toggle="modal" href="#video-modal-<%= video.id.to_s%>" class="video-modal-button-<%= video.id.to_s%>"><%= thumb_for(video, 75) %></a>
  </li>
  <li class="span9">
    <div class="title">
      <h4 class="bold ellipsis w190px">
        <a data-toggle="modal" href="#video-modal-<%= video.id.to_s%>" class="video-modal-button-<%= video.id.to_s%>"><%= video.title %></a>
      </h4>
    </div>
    <p><%= simple_format video.description %></p>
    <p><%= link_to t('details.msg'), video, :class => "attachment_text_link" %></p>
    <div class="video-format-links">
      <%= link_to "WebM", video_path(video, :format => :webm), :class => "video-webm" %>
      <%= link_to "FLV",  video_path(video, :format => :flv),  :class => "video-flv" %>
      <%= link_to "MP4",  video_path(video, :format => :mp4),  :class => "video-mp4" %>
    </div>
  </li>
</ul>

<%= javascript_tag do %>
  $(".video-modal-button-<%= video.id.to_s%>").on("click", function(){
    <%= modal_for(video) %>
    $("#jpId<%=video.id%>").jPlayer( {
      ready: function () {
        $(this).jPlayer("setMedia", {
          webmv: "<%= video_url(video, :format => 'webm' ) %>", // Defines the webm url
          flv:   "<%= video_url(video, :format => 'flv') %>",
          mp4:   "<%= video_url(video, :format => 'mp4') %>"
        });
      },
      solution:"flash, html",
      preload: "none",
      supplied: "webmv, flv, mp4",
      swfPath: "assets",
      cssSelectorAncestor: "#jp_interface_<%=video.id%>"
    });
    $("#video-modal-<%= video.id.to_s%>").on("hidden", function(){
      $("#jpId<%=video.id%>").jPlayer('stop');
    });
  });
<% end %>


