<%
  excursionsRecommended = RecommenderSystem.resource_suggestions(current_subject, nil, {:n => 15, :models => [Excursion]})
  excursionsRecent = Excursion.getRecent(15,{:subject => current_subject, :ids_to_avoid => excursionsRecommended.map{|e| e.id}})
  excursionsPopular = RecommenderSystem.search({:n => 16, :order => "ranking DESC", :ids_to_avoid => (excursionsRecommended+excursionsRecent).map{|e| e.id}, :page => 1, :models=> [Excursion]})
%>

<section id="excursions_tab_ready3 " class="excursions recent_excursions">
  <ul class="first_excursions">
    <%= render partial: 'excursions/excursion-add' %>
    <%= render partial: 'home_row', :locals => { :excursions => excursionsRecent, :prefix_id=>"home" } %>
  </ul>
  <div id="last_content_shown" style="display:none"><%=t('search.end')%></div>
</section>

<section id="excursions_tab_ready2 " class="excursions foryou_excursions">
  <ul class="items">
    <h3> <%= t("home.foryou")%> </h3>
  <%= render partial: 'home_row', :locals => {:excursions => excursionsRecommended, :prefix_id=>"home"} %>
  </ul>
</section>
 
<section id="home_tab_ready" class="excursions">
  <ul class="">
    <h3> <%= t("home.populars")%> </h3>
    <%= render partial: 'home_popular', :locals => {:excursions => excursionsPopular, :ids_to_avoid => (excursionsRecommended+excursionsRecent+excursionsPopular).map{|e| e.id}, :prefix_id=>"home"} %>
  </ul>
</section>
