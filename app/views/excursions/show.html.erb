<%= content_for :title do %><%= @excursion.title %> - <%= !@excursion.author.nil? ? @excursion.author.slug : "" %><% end %>
<%= content_for :description do %><%= @excursion.description %><% end %>
<%= content_for :keywords do %><%= @excursion.tag_list %><% end %>
<%= content_for :og_type do %>website<% end %>
<% #shortURL = short_url ( request.env['HTTP_HOST'].sub(/^(m|www)\./, '') + excursion_path(@excursion) ) %>
<% shortURL = "http://" + request.env['HTTP_HOST'].sub(/^(m|www)\./, '') + excursion_path(@excursion) %>
<%= content_for :og_url do %><%= shortURL %><% end %>
<%= content_for :og_image do %>
  <%= @excursion.thumbnail_url || "http://" + request.env['HTTP_HOST'] + "/assets/logos/original/excursion-vish.png" %>
<% end %>

<%=javascript_include_tag "RegaddiChart" %>
<%=javascript_include_tag "jquery.rating" %>
<%=javascript_include_tag "jquery.zclip.min" %>


<%= content_for :javascript do %> 
    if(window.location.search.indexOf("recent") !=-1){
      $("#congratulations-button").click();
    }

//Get the context of the canvas element we want to select
var ctx = document.getElementById("evalChart").getContext("2d");

var data = {
labels : ["<%=t('evaluation.label0')%>","<%=t('evaluation.label1')%>","<%=t('evaluation.label2')%>","<%=t('evaluation.label3')%>","<%=t('evaluation.label4')%>","<%=t('evaluation.label5')%>"],
datasets : [
{
  fillColor : "rgba(151,187,205,0.5)",
  strokeColor : "rgba(151,187,205,1)",
  pointColor : "rgba(151,187,205,1)",
  pointStrokeColor : "#fff",
  data : <%=@evaluations%>
}
]
};

var options = { 
scaleOverlay : false,
scaleOverride : true,

//** Required if scaleOverride is true **
//Number - The number of steps in a hard coded scale
scaleSteps : 4,
//Number - The value jump in the hard coded scale
scaleStepWidth : 1,
//Number - The centre starting value
scaleStartValue : 1,

//Boolean - Whether to show lines for each scale point
scaleShowLine : true,

//String - Colour of the scale line 
scaleLineColor : "rgba(0,0,0,.1)",
pointDotRadius : 5,
pointLabelFontSize : 14

};

var myNewChart = new Chart(ctx).Radar(data,options);

triggerEvaluation = function(){
$("#evaluation-button-id").trigger("click");
};

/*
//LEARNING EVALUATION
//Get the context of the canvas element we want to select
var learning_ctx = document.getElementById("evalLearningChart").getContext("2d");

var learning_data = {
labels : ["<%=t('evaluation.qlabel0')%>","<%=t('evaluation.qlabel1')%>","<%=t('evaluation.qlabel2')%>","<%=t('evaluation.qlabel3')%>","<%=t('evaluation.qlabel4')%>","<%=t('evaluation.qlabel5')%>"],
datasets : [
{
  fillColor : "rgba(151,187,205,0.5)",
  strokeColor : "rgba(151,187,205,1)",
  pointColor : "rgba(151,187,205,1)",
  pointStrokeColor : "#fff",
  data : <%=@learningEvaluations%>
}
]
};

var myLearningChart = new Chart(learning_ctx).Radar(learning_data,options);
*/
<%end%>

<% unless @excursion.author.nil? %>
  <%= render :partial => 'objects/show', :locals  => { :object => @excursion } %>
<% end %>

<!--div class="page-header"><%= @excursion.title %></div-->
<section id="show_items">

  <div class="box-show">
    <!--visor-->
    <div class="container-visor">
      <div class="elemento-visor"></div>
      <div class="caja-visor">
        <%if @excursion.is_mostvaluable? %>
          <div class="badge-excursion-active"></div>
        <%end%>
        <iframe class="vishEditorIframe" id="presentation_iframe" src="<%=excursion_path(@excursion, :format => :full)%>" width="100%" height="100%" style="border:0" iframeborder="0" frameborder="0" iframeElement.frameBorder = 0; webkitAllowFullScreen="true" allowfullscreen="true" mozallowfullscreen="true">
        </iframe>
      </div>
    </div>
  </div>

  <!--recomended-->
  <%= render :partial => 'recommender/sidebar', :locals  => { :resources => RecommenderSystem.resource_suggestions(current_subject,@excursion,{:n=>16, :models => ["Excursion"]})} %>

  <!--owner-profile-->
  <div class="description-activity">
    <div class="box_description">
      <!--tool-->
      <div class="excursion_tool">
        <%= render :partial => 'excursions/excursion-tool-tab', :locals => { :shortURL => shortURL} %>
      </div>     
    </div>
    
    <!--activity-->
    <div class="activity-box">
      <%= render :partial => 'excursions/evaluate-activity'%>
    </div>
  </div>
</section>

<a id="congratulations-button" href="#CongratModal" role="button" class="" style="display:none" data-toggle="modal"></a>
<div id="CongratModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myCongratLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="myCongratLabel"><%= t('excursion.modal.title') %></h3>
  </div>
  <div class="modal-body evaluation_body">
    <p><i class="icon-ok"></i>  <%=t("excursion.modal.normal_body")%></p>
    <p><%=raw t("excursion.modal.survey")%></p>
    <p class="thank"><i class="icon-smile"></i>  <%=raw t("excursion.modal.thank")%></p>
  </div>
</div>

<script type="text/javascript">
  //VE extra vars
  var options = {};
  options["readHashFromParent"] = true;
  function re_apply_backstrech_on_recommended(){
                  $("div[bs-img]").each(function() {
                    $(this).backstretch( $(this).attr("bs-img") );
                  });
                }
                re_apply_backstrech_on_recommended();

</script>