<%= content_for :title do %><%= @excursion.title %> - <%= @excursion.author.slug %><% end %>
<%= content_for :description do %><%= @excursion.description %><% end %>
<%= content_for :keywords do %><%= @excursion.tag_list %><% end %>
<%= content_for :og_type do %>excursion<% end %>
<% shortURL = short_url ( request.env['HTTP_HOST'].sub(/^(m|www)\./, '') + excursion_path(@excursion) ) %>
<%= content_for :og_url do %><%= shortURL %><% end %>
<%= content_for :og_image do %><%= @excursion.thumbnail_url || "http://" + request.env['HTTP_HOST'] + "/assets/logos/original/excursion-vish.png" %><% end %>

<%=javascript_include_tag "RegaddiChart" %>
<%=javascript_include_tag "jquery.rating" %>
<%=javascript_include_tag "jquery.zclip.min" %>


<%= content_for :javascript do %> 
  //Get the context of the canvas element we want to select
  var ctx = document.getElementById("evalChart").getContext("2d");

  var data = {
    labels : ["<%=t('evaluation.label0')%>","<%=t('evaluation.label1')%>","<%=t('evaluation.label2')%>","<%=t('evaluation.label3')%>","<%=t('evaluation.label4')%>","<%=t('evaluation.label5')%>"],
    datasets : [
      {
        fillColor : "rgba(151,187,205,0.5)",
        strokeColor : "rgba(151,187,205,1)",
        pointColor : "rgba(151,187,205,1)",
        pointStrokeColor : "#fff",
        data : <%=@evaluations%>
      }
    ]
  };

  var options = { 
    scaleOverlay : false,
    scaleOverride : true,
  
    //** Required if scaleOverride is true **
    //Number - The number of steps in a hard coded scale
    scaleSteps : 4,
    //Number - The value jump in the hard coded scale
    scaleStepWidth : 1,
    //Number - The centre starting value
    scaleStartValue : 1,
    
    //Boolean - Whether to show lines for each scale point
    scaleShowLine : true,

    //String - Colour of the scale line 
    scaleLineColor : "rgba(0,0,0,.1)",
    pointDotRadius : 5,
    pointLabelFontSize : 14

  };

  var myNewChart = new Chart(ctx).Radar(data,options);

  triggerEvaluation = function(){
    $("#evaluation-button-id").trigger("click");
  };

  //LEARNING EVALUATION
  //Get the context of the canvas element we want to select
  var learning_ctx = document.getElementById("evalLearningChart").getContext("2d");

  var learning_data = {
    labels : ["<%=t('evaluation.qlabel0')%>","<%=t('evaluation.qlabel1')%>","<%=t('evaluation.qlabel2')%>","<%=t('evaluation.qlabel3')%>","<%=t('evaluation.qlabel4')%>","<%=t('evaluation.qlabel5')%>"],
    datasets : [
      {
        fillColor : "rgba(151,187,205,0.5)",
        strokeColor : "rgba(151,187,205,1)",
        pointColor : "rgba(151,187,205,1)",
        pointStrokeColor : "#fff",
        data : <%=@learningEvaluations%>
      }
    ]
  };

  var myLearningChart = new Chart(learning_ctx).Radar(learning_data,options);

<%end%>

<%= render :partial => 'objects/show',
           :locals  => { :object => @excursion } %>

<!--div class="page-header"><%= @excursion.title %></div-->
<section id="show_excursions">

  <div class="box-show">
<!--visor-->
    <div class="container-visor">
      <div class="elemento-visor"></div>
      <div class="caja-visor">
        <iframe id="presentation_iframe2" src="<%=excursion_path(@excursion, :format => :full)%>" width="100%" height="100%" style="border:0" iframeborder="0" frameborder="0" iframeElement.frameBorder = 0; webkitAllowFullScreen="true" allowfullscreen="true" mozallowfullscreen="true">
        </iframe>
      </div>
    </div>
<!--owner-profile-->
    <div class="box_description">
      <%= render :partial => 'excursions/items-owner-profile', :locals => { :shortURL => shortURL} %>
    </div>
<!--tool-->
    <div class="excursion_tool">
    <%= render :partial => 'excursions/excursion-tool-tab', :locals => { :shortURL => shortURL} %>
    </div>

  </div>


  <!--recomended-->
  <div class="recomended-items">
    <div class="recomended_excursion">
      <ul class="small-box">
        <% Excursion.first(10).each do |excursion| %>
          <%= render :partial => 'excursions/excursion', :locals => { :excursion => excursion } %>
        <% end %>
      </ul>
    </div>
  </div>

  <div class="description-activity">
<!--description-->
    <div class="box_description">
      <%= render :partial => 'excursions/excursion-info' %>
    </div>
<!--activity-->
    <div class="activity">
      <div class="tabbable">

        <ul class="nav nav-tabs">      
          <li class="active"><a href="#tab1" data-toggle="tab"><%=t('comment.other')%></a></li>
          <li><a href="#tab2" data-toggle="tab"><%=t('evaluation.teaching')%></a></li>
          <li><a href="#tab3" data-toggle="tab"><%=t('evaluation.learning')%></a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="tab1">
              <div id="comments" class="comments">
                <div class="new-comments-box">
                  <%= render :partial => 'comments/new', :locals => { :activity => @excursion.post_activity } %>
                </div>
                <%= render :partial => 'activities/comments', :locals => { :activity => @excursion.post_activity } %>
              </div>
            </div>
            <div class="tab-pane" id="tab2">              
                <div class="btn-evalue">
                  <%= t('evaluation.contribute', :count => @numberOfEvaluations) %>
                  <!-- Button to trigger modal -->
                  <a id="evaluation-button-id" href="#myTeachingModal" role="button" class="btn-view-all" data-toggle="modal"><%= t('evaluation.evaluation') %></a>
                </div>
                <div class="excursion-eval-results">
                  <canvas id="evalChart" width="600" height="600"></canvas>
                </div>
            </div>
            <div class="tab-pane" id="tab3">              
                <div class="btn-evalue">
                  <%= t('evaluation.contribute', :count => @numberOfLearningEvaluations) %>
                  <!-- Button to trigger modal -->
                  <a id="learning_evaluation-button-id" href="#myLearningModal" role="button" class="btn-view-all" data-toggle="modal"><%= t('evaluation.evaluation') %></a>
                </div>
                <div class="excursion-eval-results">
                  <canvas id="evalLearningChart" width="600" height="600"></canvas>
                </div>
            </div>
          </div>
        </div>       
      </div>
    </div>

  <!-- Modal -->
  <%= render :partial => "excursions/excursion_evaluate" %>
  <%= render :partial => "excursions/excursion_learning_evaluate" %>


</section>

