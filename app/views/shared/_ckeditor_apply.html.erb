<script type="text/javascript">

    //instructions to add ckeditor to a textarea
    //render this file anywhere with:
    //render :partial => "shared/ckeditor_apply", :locals => {:the_id=> "writing_fulltext"} 
    //if you have a hidden field to save the plain text (without html tags), when you are saving the form call the function:
    //set_ckeditor_content_full_and_plaintext("fulltext_id","plaintext_id");


    $(document).ready(function() {    

        function apply_ckeditor(id){
            //Specified CKEditor configuration
            var config = {};

            //Select the features of the toolbar
            config.toolbar = 'Full';
            config.toolbar_Full =
            [
              { name: 'first', items : ['Bold','Italic','Underline','-','Subscript','Superscript','Font','FontSize','TextColor','BGColor'] },
              '/',
              { name: 'lists', items : ['NumberedList','BulletedList','Table'] },
              { name: 'alignment', items : ['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock'] },
              { name: 'link', items : ['Link'] },
              { name: 'Objects', items : ['Image','MediaEmbed'] },
              { name: 'symbols', items : ['SpecialChar'] }
            ];

            //Disable toolbar expansion
            config.toolbarCanCollapse = false;
            //Disable resizing
            config.resize_enabled = false;
            //Disable bottom tags
            config.removePlugins = 'elementspath';
            //Enable table resize and autogrow
            config.extraPlugins = 'tableresize,autogrow,specialchar,mediaembed';

            config.autoGrow_minHeight = 34;
            config.autoGrow_maxHeight = 800;

            //Fit the current area
            config.width = '100%';
            //The height value defines the height of CKEditor editing area and can be given in pixels or em. Percent values are not supported. 
            //http://docs.cksource.com/CKEditor_3.x/Howto/Editor_Size_On_The_Fly
            config.height = "300px";

            //Toolbar defaults
            config.fontSize_defaultLabel = '12';


            //Apply vEditor skin
            //var ckeditorBasePath = CKEDITOR.basePath.substr(0, CKEDITOR.basePath.indexOf("editor/"));
            //config.skin = 'office2003,' + CKEDITOR.basePath + '/skins/office2003/';

            //Add ckeditor wysiwyg instance
            var ckeditor = CKEDITOR.replace(id, config);

        };

        set_ckeditor_content_full_and_plaintext = function(id_fulltext, id_plaintext){
            var plaintext = CKEDITOR.instances[id_fulltext].document.getBody().getText();
            var fulltext = CKEDITOR.instances[id_fulltext].getData();

            $("#"+id_plaintext).val(plaintext);
            $("#"+id_fulltext).val(fulltext);
        };

        apply_ckeditor("<%=the_id%>");

    });
</script>

