<div class="boxy_white_edit block document_menu" id="document_edit"  >
  <%= form_for(document, :html => { :method => :put }) do |f| %>
  <% if document and document.errors.any? %>
  <%= javascript_tag do %>
    $(document).ready(function(){
      toggleDocumentEdit();
    });
  <% end %>
  <div class="error">
    <ul>
      <% document.errors.full_messages.each do |msg| %>
      <li>
        <%= msg %>
      </li>
      <% end %>
    </ul>
  </div>
  <% end %>
  <div class="form_row">
    <div class="form_label">
      <%= f.label t('document.info.title.title') %>
    </div>
    <div class="form_field">
      <%= f.text_field :title, :class => "form_tag" %>
    </div>
  </div>
  <div class="form_row">
    <div class="form_label">
      <%= f.label t('document.info.description.title') %>
    </div>
    <div class="form_field">
      <%= f.text_area :description, :class => "form_tag" %>
    </div>
  </div>
  <div class="form_row">
    <div class="form_label">
      <%= f.label t('document.info.tags.title') %>
    </div>
    <div class="form_field">
      <%= f.select :tag_list, [], :class => "form_tag" %>
    </div>
  </div>
  <!-- 
  <div class="form_row">
    <div class="form_label">
      <%#= f.label t('document.info.file.title') %>
    </div>
    <div class="form_field">
      <%#= f.file_field :file, :class => "form_tag" %>
    </div>
  </div>  
  -->
  <div class="actions center">
    <%= f.submit t('button.save'), :class => "button" %>
  </div>
  <% end %>
</div>

<%= content_for :javascript do %>
  <% doc_type = if document.type.nil?; "document"; else document.type.downcase; end%>
  $("#<%= doc_type %>_tag_list").fcbkcomplete({
    json_url: "<%= tags_path(:format => :json) %>",
    cache: false,
    filter_case: true,
    filter_hide: true,
    newel: false,
    height: 6 
  });
  <% document.tag_list.each do |tag| %> $("#document_tag_list").trigger("addItem",{"title":"<%= tag %>","value":"<%= tag %>"});
  <% end %>
<% end %>

<% if params[:editing].present? and params[:editing].eql?"true" and document.post_activity.edit_object_by?(current_subject) %>
  <%= javascript_tag do %>
    $(document).ready(function(){
      SocialStream.Repository.toggleDocumentMenu('edit');
    });
  <% end %>
<% end %>
